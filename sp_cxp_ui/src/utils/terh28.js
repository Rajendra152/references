var tc={};tc.seal=false;tc.VERSION="28.0.3.7";tc.ClsTehData=function(){this.x=20;this.y=100;this.msg="Hello World again!";this.ReturnXYZ=function(t){return this.x+this.y+t};this.init=function(){return Object.seal(this)};this.copy=function(){return tc.clone(this)}};tc.Color=function(t,e,r){if(t!=undefined&&e==undefined&&r==undefined){if(typeof t=="number"){clr=t;t=clr&255;clr=clr>>8;e=clr&255;clr=clr>>8;r=clr&255}else if(typeof t=="string"&&t.length==7&&t.charAt(0)=="#"){clr=t.toLowerCase();t=parseInt("0x"+clr.substr(1,2));e=parseInt("0x"+clr.substr(3,2));r=parseInt("0x"+clr.substr(5,2))}else if(typeof t=="object"&&t.ObjType=="Color")return t;else if(t==null)return null;else t=e=r=0}if(t==undefined)t=0;if(e==undefined)e=0;if(r==undefined)r=0;this.ObjType="Color";this.red=t;this.green=e;this.blue=r;var i=this;function f(){return Object.seal(i)}this.getRed=function(){return i.red};this.getGreen=function(){return i.green};this.getBlue=function(){return i.blue};this.toString=function(){var t=i.red<=15?"0"+i.red.toString(16):i.red.toString(16);var e=i.green<=15?"0"+i.green.toString(16):i.green.toString(16);var r=i.blue<=15?"0"+i.blue.toString(16):i.blue.toString(16);return"#"+t+e+r};this.copy=function(){var t=new tc.Color;tc.clone2(i,t);return t};f()};tc.Color.white=new tc.Color(255,255,255);tc.Color.black=new tc.Color(0,0,0);tc.Color.blue=new tc.Color(0,0,255);tc.Color.red=new tc.Color(255,0,0);tc.Color.green=new tc.Color(0,255,0);tc.Color.yellow=new tc.Color(255,255,0);tc.Color.lightGray=new tc.Color(211,211,211);tc.Color.gray=new tc.Color(128,128,128);tc.Color.darkGray=new tc.Color(169,169,169);tc.clone=function(t,e){if(e==undefined)e=true;var r;if(!t||"object"!=typeof t)return t;if(t instanceof Date){r=new Date;r.setTime(t.getTime());return r}if(t instanceof Array){var i=t.length;if(i>0){if(!t[0]||typeof t[0]!="object")return t.slice(0);else{r=[];for(var f=0;f<i;f++){r[f]=tc.clone(t[f],e)}return r}}else return[]}if(t instanceof Object){if(!e)return t;r={};for(var l in t){if(t.hasOwnProperty(l))r[l]=tc.clone(t[l]);else if(typeof t[l]!="function")r[l]=t[l]}return r}throw new Error("Unable to copy obj! Its type isn't supported.")};tc.clone2=function(t,e){for(var r in t){var i=t[r];if(typeof i!="function"){e[r]=tc.clone(i,false)}}};tc.arg_list=function(){this.x=0;this.y=0;this.width=0;this.height=0;this.LineLimit=0;this.WordWrap=true;this.PrintView=false;this.PageMode=false;this.FittedView=false;this.ShowStatus=true;this.ShowMenu=false;this.ShowHorBar=false;this.ShowVerBar=false;this.ruler=false;this.ToolBar=false;this.UserCanClose=false;this.BorderMargin=true;this.ReadOnly=false;this.InitLine=0;this.InputType=tc.CHAR_F;this.file="";this.hBuffer="";this.BufferLen=0;this.delim=13;this.DocX=[];this.SaveFormat=0;this.style=0;this.FontTypeFace="";this.PointSize=0;this.open=false;this.modified=false;var e=this;function t(){return Object.seal(e)}this.copy=function(){var t=new tc.arg_list;tc.clone2(e,t);return t};t()};tc.CR_LINE=1;tc.CR_COL=2;tc.CR_ABS_POS=3;tc.CR_ERROR=-12345678;tc.CF_TEXT=1;tc.CF_BITMAP=2;tc.CF_METAFILEPICT=3;tc.CF_DIB=8;tc.CF_UNICODETEXT=13;tc.CF_ENHMETAFILE=14;tc.CF_MAX=17;tc.DNS_DELETE=1;tc.DNS_INSERT=2;tc.CROP_LEFT=1;tc.CROP_RIGHT=2;tc.CROP_TOP=3;tc.CROP_BOT=4;tc.TOC_HEADINGS=0;tc.TOC_OUTLINES=1;tc.TOC_CUSTOM=2;tc.TOC_FIELD=3;tc.TOC_USER=4;tc.TOC_LAST=4;tc.REP_TOP=1;tc.REP_BOT=2;tc.REP_CENTER=4;tc.REP_RIGHT=8;tc.REP_NO_PAGE=16;tc.MAX_WIDTH=1e3;tc.TE_MAX_TAB_STOPS=20;tc.CELL_MARGIN=60;tc.MAX_AUTO_COMPS=20;tc.TEXT_HANDLE_WIDTH=20;tc.TEXT_HANDLE_HEIGHT=24;tc.CURSOR_HANDLE_IDX=0;tc.SEL_BEG_HANDLE_IDX=1;tc.SEL_END_HANDLE_IDX=2;tc.MAX_TEXT_HANDLES=3;tc.LRE_CHAR=8234;tc.RLE_CHAR=8235;tc.OVR_POP_CHAR=8236;tc.OVR_LTRCH_CHAR=8237;tc.OVR_RTLCH_CHAR=8238;tc.LRM_CHAR=8206;tc.RLM_CHAR=8207;tc.MTYPE_EQU=0;tc.MTYPE_RUN=1;tc.MTYPE_FRAC=2;tc.MTYPE_NUM=3;tc.MTYPE_DEN=4;tc.MTYPE_RAD=5;tc.MTYPE_DEG=6;tc.MTYPE_BASE=7;tc.MTYPE_SUP_OBJ=8;tc.MTYPE_SUP_ARG=9;tc.MTYPE_FUNC=10;tc.MTYPE_FUNC_NAME=11;tc.MTYPE_DELIM_OBJ=12;tc.MTYPE_SUB_OBJ=13;tc.MTYPE_SUB_ARG=14;tc.MTYPE_NARY=15;tc.MFLAG_HIDE_DEG=1;tc.MFLAG_GROW=2;tc.MFLAG_NO_BAR=4;tc.THMCLR_DARK1=0;tc.THMCLR_LIGHT1=1;tc.THMCLR_DARK2=2;tc.THMCLR_LIGHT2=3;tc.THMCLR_ACCENT1=4;tc.THMCLR_ACCENT2=5;tc.THMCLR_ACCENT3=6;tc.THMCLR_ACCENT4=7;tc.THMCLR_ACCENT5=8;tc.THMCLR_ACCENT6=9;tc.THMCLR_HLINK=10;tc.THMCLR_FOLLOWED_HLINK=11;tc.THMCLR_NONE=12;tc.THMCLR_BKND1=13;tc.THMCLR_BKND2=14;tc.THMCLR_TEXT1=15;tc.THMCLR_TEXT2=16;tc.MAX_THEME_COLORS=17;tc.OLEPTR_OBJECT=0;tc.OLEPTR_STORAGE=1;tc.HILIGHT_OFF=0;tc.HILIGHT_LINE=1;tc.HILIGHT_CHAR=2;tc.FLOW_DEF=0;tc.FLOW_LTR=1;tc.FLOW_RTL=2;tc.UNDO_INSERT="I".charCodeAt(0);tc.UNDO_OBJECT_INSERT="O".charCodeAt(0);tc.UNDO_DELETE="D".charCodeAt(0);tc.UNDO_FONT=tc.CHAR_F;tc.UNDO_PARA="P".charCodeAt(0);tc.UNDO_REPLACE=tc.CHAR_R;tc.UNDO_ROW_DEL="T".charCodeAt(0);tc.UNDO_ROW_INS=tc.CHAR_S;tc.UNDO_CELL_DEL="U".charCodeAt(0);tc.UNDO_CELL_INS="V".charCodeAt(0);tc.UNDO_FRAME="1".charCodeAt(0);tc.UNDO_FRAME_LIMITED="2".charCodeAt(0);tc.UNDO_PICT_SIZE="3".charCodeAt(0);tc.UNDO_TABLE_ATTRIB="4".charCodeAt(0);tc.UNDO_TAG_INSERT="5".charCodeAt(0);tc.UNDO_TAG_DELETE="6".charCodeAt(0);tc.UNDO_LIST_LEVEL="7".charCodeAt(0);tc.FONTINFO_UCBASE=1;tc.FONTINFO_CHARSET=2;tc.FONTINFO_PICT_WIDTH=3;tc.FONTINFO_PICT_HEIGHT=4;tc.FONTINFO_ULINE_COLOR=5;tc.FONTINFO_AUX_ID=6;tc.FONTINFO_FLAGS=7;tc.FONTINFO_FRAME_TYPE=8;tc.FONTINFO_FRAME_ID=9;tc.FONTINFO_OFFSET=10;tc.FONTINFO_IS_PICT=11;tc.FONTINFO_IS_CTL=12;tc.FONTINFO_FIELD_ID=14;tc.FONTINFO_INS_REV_ID=15;tc.FONTINFO_DEL_REV_ID=16;tc.FONTINFO_CHAR_SCALEX=17;tc.FONTINFO_CHAR_SPACE=18;tc.FONTINFO_IS_RTL=19;tc.FONTINFO_SIZE=20;tc.FONTINFO_STYLE=21;tc.FONTINFO_COLOR=22;tc.FONTINFO_BK_COLOR=23;tc.FONTINFO_WLINE_COLOR=24;tc.FONTINFO_FLOW=25;tc.FONTINFO_HAS_COMMENTS=26;tc.FONTINFO_HILIGHT_COLOR=27;tc.FONTINFO_FMT_REV_ID=28;tc.FONTINFO_ERROR=new tc.Color(12,34,56);tc.PARAINFO_TEXT_FLOW=1;tc.PARAINFO_BORDER_COLOR=2;tc.PARAINFO_BK_COLOR=3;tc.PARAINFO_SPC_BEF=4;tc.PARAINFO_SPC_AFT=5;tc.PARAINFO_SPC_BET=6;tc.PARAINFO_LINE_SPACE=7;tc.PARAINFO_FLAGS=8;tc.PARAINFO_HEADING_LEVEL=9;tc.PARAINFO_ERROR=-999999;tc.SSINFO_NAME=1;tc.SSINFO_CHAR_SPACE=2;tc.SSINFO_CHAR_OFFSET=3;tc.SSINFO_NEXT=4;tc.SSINFO_OUTLINE_LEVEL=5;tc.SSINFO_BASED_ON=6;tc.SWRAP_NO_WRAP=1;tc.SWRAP_AROUND=2;tc.SWRAP_IGNORE=3;tc.SWRAP_TIGHT=4;tc.SWRAP_THRU=5;tc.SHPTYPE_NONE=-1;tc.SHPTYPE_ROUND_RECT=2;tc.SHPTYPE_ELLIPSE=3;tc.SHPTYPE_DIAMOND=4;tc.SHPTYPE_ARROW=13;tc.SHPTYPE_LINE=20;tc.SHPTYPE_RECT=1;tc.SHPTYPE_PICT_FRAME=75;tc.SHPTYPE_LBRACKET=85;tc.SHPTYPE_RBRACKET=86;tc.SHPTYPE_CHART_DECISION=110;tc.SHPTYPE_RR_CALLOUT=62;tc.SHPTYPE_CROSSED_CIRCLE=123;tc.SHPTYPE_CHART_ALT_PROCESS=176;tc.SHPTYPE_CHART_ONLINE_STORAGE=130;tc.SHPTYPE_CHART_MAG_DRUM=133;tc.SHPTYPE_CHART_PUNCHED_CARD=121;tc.SHPTYPE_CHART_PUNCHED_CARD=121;tc.SHPTYPE_CHART_PUNCHED_CARD=121;tc.SHPTYPE_OCX=201;tc.SHPTYPE_TEXT_BOX=202;tc.ANSI_CHARSET=0;tc.DEFAULT_CHARSET=1;tc.SYMBOL_CHARSET=2;tc.MAC_CHARSET=77;tc.BALTIC_CHARSET=186;tc.JOHAB_CHARSET=130;tc.CHINESEBIG5_CHARSET=136;tc.EASTEUROPE_CHARSET=238;tc.GB2312_CHARSET=134;tc.GREEK_CHARSET=161;tc.HANGUL_CHARSET=129;tc.OEM_CHARSET=255;tc.RUSSIAN_CHARSET=204;tc.SHIFTJIS_CHARSET=128;tc.TURKISH_CHARSET=162;tc.VIETNAMESE_CHARSET=163;tc.HEBREW_CHARSET=177;tc.ARABIC_CHARSET=178;tc.THAI_CHARSET=222;tc.INFO_TITLE=0;tc.INFO_SUBJECT=1;tc.INFO_AUTHOR=2;tc.INFO_MANAGER=3;tc.INFO_COMPANY=4;tc.INFO_OPERATOR=5;tc.INFO_CATEGORY=6;tc.INFO_KEYWORDS=7;tc.INFO_COMMENT=8;tc.INFO_PWHASH=9;tc.INFO_HLINKBASE=10;tc.INFO_SSUSER=11;tc.INFO_MAX=12;tc.TEXT_HORZ=0;tc.TEXT_TOP_TO_BOT=1;tc.TEXT_BOT_TO_TOP=2;tc.TEXT_HANDLE_COUNT=3;tc.TP_TOTAL_LINES=1;tc.TP_TOTAL_PFMTS=2;tc.TP_TOTAL_FONTS=3;tc.TP_TOTAL_STYLES=4;tc.TP_TOTAL_PAGES=5;tc.TP_TOTAL_PARA_FRAMES=6;tc.TP_TOTAL_CHAR_TAGS=7;tc.TP_TOTAL_IMAGE_MAPS=8;tc.TP_TOTAL_BLTS=9;tc.TP_TOTAL_LISTS=10;tc.TP_TOTAL_LIST_OR=11;tc.TP_TOTAL_TABS=12;tc.TP_TOTAL_TABLE_ROWS=13;tc.TP_TOTAL_CELLS=14;tc.TP_TOTAL_SECTS=15;tc.TP_CUR_LINE=16;tc.TP_CUR_COL=17;tc.TP_CUR_SECT=18;tc.TP_SELECTION_TYPE=19;tc.TP_SELECTION_START_LINE=20;tc.TP_SELECTION_START_COL=21;tc.TP_SELECTION_END_LINE=22;tc.TP_SELECTION_END_COL=23;tc.TP_WATERMARK_WASH=24;tc.TP_WATERMARK_PICT=25;tc.TP_PAGE_BK_COLOR=26;tc.TP_TOTAL_REVIEWERS=27;tc.TP_MOUSE_ON_TEXT_LINE=28;tc.TP_IS_ASIAN_SYS=29;tc.TP_WIN_ORG_Y=30;tc.TP_MOUSE_FIRST=31;tc.TP_MOUSE_X=31;tc.TP_MOUSE_Y=32;tc.TP_MOUSE_LINE=33;tc.TP_MOUSE_COL=34;tc.TP_MOUSE_FONT_ID=35;tc.TP_MOUSE_PICT_ID=36;tc.TP_MOUSE_FIELD_ID=37;tc.TP_MOUSE_FRAME_ID=38;tc.TP_MOUSE_COMMENT_ID=39;tc.TP_MOUSE_LAST=39;tc.BUTTON_LEFT=0;tc.BUTTON_MIDDLE=1;tc.BUTTON_RIGHT=2;tc.TP_TOTAL_CHARS=61;tc.TP_PREVIEW_ZOOM_PCT=62;tc.TP_TABLE_COLS_SELECTED=63;tc.TP_TABLE_ROWS_SELECTED=64;tc.TP_HAS_TRACK_CHANGES=65;tc.TP_CUR_REV_ID=66;tc.TP_INIT_LIST_INDENT=67;tc.TP_FIXED_BULLET_SIZE=68;tc.TP_DRAGGING_TEXT=69;tc.TP_SHOW_HIDDEN_TEXT=70;tc.TP_JUST_LINE_BREAK_LINE=72;tc.TP_UNDO_REF=73;tc.TP_LINK_STYLE=74;tc.TP_LINK_COLOR=75;tc.TP_USE_W2016_FEATURES=76;tc.TPS_INIT_LIST_INDENT=1;tc.TPS_FIXED_BULLET_SIZE=2;tc.TPS_JUST_LINE_BREAK_LINE=3;tc.TPS_PAGE_NUM_FORMAT=4;tc.TPS_TABLE_GRID_COLOR=5;tc.TPS_LINK_STYLE=6;tc.TPS_LINK_COLOR=7;tc.TPS_USE_W2016_FEATURES=8;tc.CP_FIX_WIDTH=0;tc.CP_PARENT_CELL=1;tc.CP_LEVEL=2;tc.CP_TEXT_ROTATION=3;tc.CP_WIDTH=4;tc.CP_ROW=5;tc.CP_ID=6;tc.CP_NEXT=7;tc.CP_PREV=8;tc.CP_ROW_WIDTH=9;tc.CP_PAD_LEFT=10;tc.CP_PAD_RIGHT=11;tc.CP_PAD_TOP=12;tc.CP_PAD_BOT=13;tc.CP_TABLE_PICT=14;tc.CP_CELL_PICT=15;tc.CP_TEXT_ANGLE=16;tc.CP_FLAGS=17;tc.CP_MARGIN=18;tc.CP_ROW_SPAN=19;tc.CP_COL_SPAN=20;tc.CP_ERROR=-999999;tc.RP_FIRST_CELL=0;tc.RP_LAST_CELL=1;tc.RP_TOP_ROW_HT=2;tc.RP_BOT_ROW_HT=3;tc.RP_FLAGS=4;tc.RP_ROW_ID=5;tc.RP_INDENT=6;tc.RP_CELL_MARGIN=7;tc.RP_MIN_HEIGHT=8;tc.RP_FLOW=9;tc.RP_LEFT_PAD=10;tc.RP_RIGHT_PAD=11;tc.RP_TOP_PAD=12;tc.RP_BOT_PAD=13;tc.RP_PREV_ROW=14;tc.RP_NEXT_ROW=15;tc.FP_TEXT_ROTATION=1;tc.FP_WRAP_STYLE=2;tc.FP_YBASE=3;tc.FP_FILL_PATTERN=4;tc.FP_TEXT_DIST=5;tc.FP_ARROW_TYPE=6;tc.FP_X=7;tc.FP_Y=8;tc.FP_ZORDER=9;tc.FP_PICT=10;tc.FP_SHAPE_TYPE=11;tc.FP_FLAGS=12;tc.FP_FLAGS2=13;tc.FP_PAGE_NO=14;tc.FP_LINE_THICKNESS=15;tc.FP_LINE_COLOR=16;tc.FP_FILL_COLOR=17;tc.FP_WIDTH=18;tc.FP_HEIGHT=19;tc.FP_LINE_TYPE=20;tc.FP_CANVAS=21;tc.FP_SIDE_MARGIN=22;tc.FP_TOP_MARGIN=23;tc.FP_BOT_MARGIN=24;tc.FP_ERROR=9999;tc.LP_LINE_FLAGS=1;tc.LP_LINE_FLAGS2=2;tc.LP_LINE_LEN=3;tc.LP_LIST_NBR=4;tc.LP_LIST_FONT=5;tc.LP_CELL_ID=6;tc.LP_PARA_FRAME_ID=7;tc.LP_LIST_ID=8;tc.LP_LIST_OR_ID=9;tc.LP_LIST_LEVEL=10;tc.LP_LINE_NUM=11;tc.LP_PARA_MARK=12;tc.LP_LIST_TEXT_WIDTH=13;tc.LP_HEIGHT=14;tc.LP_LIST_BULLET_SYM=15;tc.LP_LIST_TEXT=16;tc.LP_PARA_FIRST_LINE=17;tc.LP_PARA_LAST_LINE=18;tc.LP_SECT_ID=19;tc.LP_PARA_ID=20;tc.LP_ERROR=9999;tc.STP_AUTHOR=1;tc.STP_AUTH_INIT=2;tc.STP_TEXT=3;tc.STP_DATE=4;tc.STP_RTF_ID=5;tc.WRAP_OFF=0;tc.WRAP_MIN=1;tc.WRAP_PARA=2;tc.WRAP_WIN=3;tc.WRAP_PAGE=4;tc.APPLY_IGNORE=0;tc.APPLY_MOD_CUR_LINE=1;tc.APPLY_BEF_CUR_LINE=2;tc.APPLY_AFT_CUR_LINE=3;tc.SAVE_TEXT=0;tc.SAVE_TEXT_LINES=1;tc.SAVE_RTF=2;tc.SAVE_DEFAULT=3;tc.SAVE_HTML=4;tc.SAVE_UTEXT=5;tc.SAVE_UTF7TEXT=6;tc.SAVE_UTF8TEXT=7;tc.SAVE_DOCX=8;tc.SAVE_DOC=9;tc.MENU_FILE=0;tc.MENU_EDIT=1;tc.MENU_VIEW=2;tc.MENU_INSERT=3;tc.MENU_FONT=4;tc.MENU_PARAGRAPH=5;tc.MENU_TABLE=6;tc.MENU_OTHER=7;tc.MENU_HELP=8;tc.ULINE=1;tc.BOLD=2;tc.ITALIC=4;tc.STRIKE=8;tc.SUPSCR=16;tc.SUBSCR=32;tc.HIDDEN=64;tc.PICT=128;tc.ULINED=256;tc.PROTECT=512;tc.FNOTE=1024;tc.FNOTETEXT=2048;tc.FNOTEREST=4096;tc.CHAR_BOX=8192;tc.HLINK=16384;tc.ENOTETEXT=32768;tc.CAPS=65536;tc.SCAPS=131072;tc.LEFT_LINE=262144;tc.DOUBLE_STRIKE=524288;tc.ULINE_DOTTED=1048576;tc.EMBOSS=4194304;tc.FNOTEAUTO=8388608;tc.STYLE_DEL=536870912;tc.STYLE_INS=1073741824;tc.HYPER_CODE=tc.HIDDEN;tc.FIELD_NAME_STYLE=tc.ULINED;tc.SID_NORMAL=-9999;tc.SID_CUR=-9998;tc.FNOTEALL=tc.FNOTE|tc.FNOTETEXT|tc.FNOTEREST|tc.ENOTETEXT;tc.FNOTENONE=~tc.FNOTEALL;tc.DEFAULT_PFMT=0;tc.CENTER=1;tc.RIGHT_JUSTIFY=2;tc.DOUBLE_SPACE=4;tc.BULLET=8;tc.PARA_BOX_TOP=16;tc.PARA_BOX_BOT=32;tc.PARA_BOX_LEFT=64;tc.PARA_BOX_RIGHT=128;tc.PARA_BOX_DOUBLE=256;tc.PARA_BOX_THICK=512;tc.PARA_BOX_ATTRIB=1008;tc.LEFT=1024;tc.JUSTIFY=2048;tc.PAGE_HDR=4096;tc.PAGE_FTR=8192;tc.PAGE_HDR_FTR=12288;tc.PARA_KEEP=16384;tc.PARA_KEEP_NEXT=32768;tc.PARA_BOX_BETWEEN=65536;tc.AUTO_SPACE_BEFORE=131072;tc.AUTO_SPACE_AFTER=262144;tc.HTML_TEMP_PARA=524288;tc.PARA_CONTEXTUAL_SPACE=1048576;tc.JUSTIFY_DIST=2097152;tc.TEXT_VALIGN_BASE=0;tc.TEXT_VALIGN_TOP=1;tc.TEXT_VALIGN_BOT=2;tc.TEXT_VALIGN_CENTER=3;tc.ROWFLAG_HDR=4;tc.ROWFLAG_HAS_SUBTABLE=8;tc.ROWFLAG_SPLIT=16;tc.ROWFLAG_KEEP=8192;tc.ROWFLAG_PREEXIST=16384;tc.ROWFLAG_NEW_TABLE=32768;tc.ROWFLAG_RTL=65536;tc.ROWFLAG_KEEP_CALC=262144;tc.ROWFLAG_AUTO_FIT=524288;tc.ROWFLAG_AUTO_WIDTH_RTF=1048576;tc.ROWFLAG_TWIPS_WIDTH=2097152;tc.ROWFLAG_LAST_ROW=4194304;tc.ROWFLAG_LAYOUT_FIXED=8388608;tc.ROWFLAG_HTML_TABLE=16777216;tc.ROWFLAG_PCT_WIDTH=33554432;tc.ROWFLAG_HAD_ZERO_WIDTH_CELL=67108864;tc.ROWFLAG_NO_PREF_WIDTH=134217728;tc.ROWFLAG_TFOOT=268435456;tc.PARA_BOX=240|tc.PARA_BOX_BETWEEN;tc.PFLAG_FRAME=1;tc.PFLAG_CELL=2;tc.PFLAG_RESERVED1=4;tc.PFLAG_RESERVED2=4;tc.PFLAG_NO_WRAP=16;tc.PFLAG_WIDOW=32;tc.PFLAG_PAGE_BREAK=64;tc.PFLAG_ENDNOTE=128;tc.PFLAG_NO_NUM_LIST=256;tc.PFLAG_NO_SNAP_TO_GRID=512;tc.FFLAG_ITALIC_OH=1;tc.FFLAG_OCX_SRV_ERROR=2;tc.FFLAG_CTL_VISIBLE=4;tc.FFLAG_CTL_DRAWN=8;tc.FFLAG_DRAW_PENDING=16;tc.FFLAG_SEL=32;tc.FFLAG_PICT_DRAWN=64;tc.FFLAG_HIDDEN_INFO=128;tc.FFLAG_USER=256;tc.FFLAG_SCAPS=512;tc.FFLAG_AUTO_SPELL=1024;tc.FFLAG_EQ_OBJECT=2048;tc.FFLAG_RESIZED=4096;tc.FFLAG_CHECKED=8192;tc.FFLAG_FIELD_LOCKED=32768;tc.FFLAG_FORCE_RTLCH=65536;tc.FFLAG_FORCE_LTRCH=131072;tc.FFLAG_PREEXIST=524288;tc.FFLAG_SET_PICT_SIZE=1048576;tc.FFLAG_MASK=tc.FFLAG_SCAPS|tc.FFLAG_AUTO_SPELL|tc.FFLAG_FIELD_LOCKED|tc.FFLAG_FORCE_RTLCH|tc.FFLAG_FORCE_LTRCH;tc.TAB_LEFT=0;tc.TAB_RIGHT=1;tc.TAB_CENTER=2;tc.TAB_DECIMAL=3;tc.TAB_CLEAR=4;tc.TAB_NONE=0;tc.TAB_DOT=1;tc.TAB_HYPH=2;tc.TAB_ULINE=4;tc.CLR_WHITE=tc.Color.white;tc.CLR_WHITE_FORCE=new tc.Color(254,254,254);tc.CLR_BLACK=tc.Color.black;tc.CLR_AUTO=new tc.Color(1,1,1);tc.CLR_ERROR=new tc.Color(2,3,4,1);tc.TER_WORD_WRAP=1;tc.TER_PRINT_VIEW=2;tc.TER_HSCROLL=4;tc.TER_VSCROLL=8;tc.TER_SHOW_STATUS=16;tc.TER_SHOW_RULER=32;tc.TER_BORDER_MARGIN=64;tc.TER_OUTPUT_RTF=128;tc.TER_USE_PARAMS=256;tc.TER_READ_ONLY=512;tc.TER_PAGE_MODE=1024;tc.TER_SHOW_TOOLBAR=2048;tc.TER_INVISIBLE=4096;tc.TER_FITTED_VIEW=8192;tc.TER_NUM_STYLES=14;tc.SRCH_SCROLL=1;tc.SRCH_SEARCH=2;tc.SRCH_REPLACE=4;tc.SRCH_RETRIEVE=8;tc.SRCH_CASE=16;tc.SRCH_WORD=32;tc.SRCH_SKIP_HIDDEN_TEXT=64;tc.SRCH_BACK=128;tc.SRCH_NO_REPLACE_PROT_TEXT=256;tc.ALIGN_BOT=0;tc.ALIGN_MIDDLE=1;tc.ALIGN_TOP=2;tc.PFRAME_NONE=0;tc.PFRAME_LEFT=1;tc.PFRAME_RIGHT=2;tc.PFRAME_FLOAT=3;tc.POS_BEG=0;tc.POS_END=1;tc.DOB_TEXT_BOX=1;tc.DOB_RECT=2;tc.DOB_LINE=3;tc.DOB_LINE_NONE=0;tc.DOB_LINE_SOLID=1;tc.DOB_LINE_DOTTED=2;tc.SSTYPE_CHAR=1;tc.SSTYPE_PARA=2;tc.BASE_PAGE=0;tc.BASE_MARG=1;tc.BASE_PARA=2;tc.WINDOW_EXT=250;tc.SEL_CELLS=1;tc.SEL_COLS=2;tc.SEL_ROWS=3;tc.SEL_ALL=4;tc.BKPICT_STRETCH=1;tc.BKPICT_TILE=2;tc.XPT_TOP_LEFT=0;tc.XPT_STRETCH=1;tc.XPT_TILE_X_TOP=2;tc.XPT_TILE_Y_LEFT=3;tc.XPT_TILE_BOTH=4;tc.XPT_TOP_RIGHT=5;tc.XPT_BOT_LEFT=6;tc.XPT_BOT_RIGHT=7;tc.XPT_CENTER=8;tc.XPT_TOP_CENTER=9;tc.XPT_CENTER_LEFT=10;tc.XPT_CENTER_RIGHT=11;tc.XPT_BOT_CENTER=12;tc.XPT_TILE_X_CENTER=13;tc.XPT_TILE_X_BOT=14;tc.XPT_TILE_Y_CENTER=15;tc.XPT_TILE_Y_RIGHT=16;tc.RHDR_CHAR=2;tc.RFTR_CHAR=3;tc.ZWNJ_CHAR=4;tc.HPARA_CHAR=5;tc.HYPH_CHAR=6;tc.LHDR_CHAR=7;tc.LFTR_CHAR=8;tc.PAGE_CHAR=12;tc.NBSPACE_CHAR=14;tc.LINE_CHAR=15;tc.FTR_CHAR=16;tc.HDR_CHAR=17;tc.ROW_CHAR=18;tc.CELL_CHAR=19;tc.SECT_CHAR=20;tc.PARA_CHAR=21;tc.COL_CHAR=22;tc.NBDASH_CHAR=23;tc.PICT_CHAR=24;tc.FHDR_CHAR=25;tc.FFTR_CHAR=26;tc.HIDDEN_CHAR=28;tc.LAST_CTRL_CHAR=28;tc.LEFT_PARAN_CHAR=8220;tc.CHARID_CLEAR_LEFT=1;tc.CHARID_CLEAR_RIGHT=2;tc.CHARID_CLEAR_ALL=3;tc.BRDRTYPE_SINGLE=0;tc.BRDRTYPE_DBL=1;tc.BRDRTYPE_TRIPLE=2;tc.BRDRTYPE_SHADOW=3;tc.BRDRTYPE_THICK_THIN=4;tc.BRDRTYPE_THICK_THIN_THICK=5;tc.BRDRTYPE_THIN_THICK=6;tc.BRDRTYPE_THIN_THICK_THIN=7;tc.BRDRTYPE_NONE=8;tc.BRDRTYPE_THICK=9;tc.BRDRTYPE_LAST=9;tc.MSGTYPE_ALERT=0;tc.MSGTYPE_OK_CANCEL=1;tc.MSGRESULT_NONE=0;tc.MSGRESULT_OK=1;tc.MSGRESULT_CANCEL=2;tc.TFLAG_RESIZE_BITMAP=1;tc.TFLAG_METRIC=2;tc.TFLAG_RETURN_MSG_ID=4;tc.TFLAG_APPLY_PRT_ORIENT=8;tc.TFLAG_APPLY_PRT_PROPS=8;tc.TFLAG_IGNORE_PICT_LINK=16;tc.TFLAG_DISABLE_ACCEL=32;tc.TFLAG_USE_NEXT_ID=64;tc.TFLAG_SHOW_CARET=128;tc.TFLAG_UNPROTECTED_DEL=256;tc.TFLAG_NO_HOUR_GLASS=512;tc.TFLAG_NO_CHILD_TOP=1024;tc.TFLAG_NO_WRAP=2048;tc.TFLAG_ACTIVATE_MDI_CHILD=4096;tc.TFLAG_COMP_WORD97=8192;tc.TFLAG_EXCLUDE_HIDDEN_SEL=16384;tc.TFLAG_AUTO_VSCROLL_BAR=32768;tc.TFLAG_NO_PALETTE=65536;tc.TFLAG_KEEP_PICT_ASPECT=131072;tc.TFLAG_KEEP_FRAME_ASPECT=262144;tc.TFLAG_PICT_IN_FRAME=524288;tc.TFLAG_NO_PRINTER=1048576;tc.TFLAG_NO_DRAG_TEXT=2097152;tc.TFLAG_NO_EDIT_OLE=4194304;tc.TFLAG_SWAP_DECIMAL=8388608;tc.TFLAG_NO_EDIT_PICT=16777216;tc.TFLAG_SHOW_BREAKS=33554432;tc.TFLAG_SELECT_FULL_HLINK=67108864;tc.TFLAG_BUF_DISP=134217728;tc.TFLAG_NO_OLE=268435456;tc.TFLAG_ROW_PASTE=536870912;tc.TFLAG_NO_AUTO_FULL_CELL_SEL=1073741824;tc.TFLAG2_COMP_WPF=1;tc.TFLAG2_RETAIN_BKND=2;tc.TFLAG2_USE_PAL_FOR_TEXT=4;tc.TFLAG2_CAN_MERGE_PROT_TEXT=8;tc.TFLAG2_BKPICT_OVER_PAGE_BORDER=16;tc.TFLAG2_XPARENT_WRITE=32;tc.TFLAG2_NO_CARET=64;tc.TFLAG2_SHOW_SECT_PAGE_NO=128;tc.TFLAG2_NO_CURSOR_CHANGE=256;tc.TFLAG2_VERT_THUMB_TRACK=512;tc.TFLAG2_NO_AUTO_REPAGE=1024;tc.TFLAG2_NO_BKP_FILE=2048;tc.TFLAG2_SELECT_FRAME_PICT=4096;tc.TFLAG2_HIDE_PAGE_BREAK=8192;tc.TFLAG2_PROTECT_FORMAT=16384;tc.TFLAG2_NO_HIDDEN_RTF_TEXT=32768;tc.TFLAG2_NO_SHADE_FIELD_TEXT=65536;tc.TFLAG2_IGNORE_TIMER=131072;tc.TFLAG2_NO_AUTO_HDR_FTR=262144;tc.TFLAG2_WRITE_FIRST_RTF_COLOR=524288;tc.TFLAG2_FULL_REPAINT=1048576;tc.TFLAG2_KEEP_PRINTER_OPEN=2097152;tc.TFLAG2_ALT_PARA_SYM=4194304;tc.TFLAG2_ALT_LINE_SYM=8388608;tc.TFLAG2_NO_LINE_FITTING=16777216;tc.TFLAG2_NO_PRT_CANCEL_DLG=33554432;tc.TFLAG2_INDENT_FRAMES=67108864;tc.TFLAG2_INDENT_TABLES=134217728;tc.TFLAG2_NO_ADJUST_CURSOR=268435456;tc.TFLAG2_CURSOR_BEF_HIDDEN=536870912;tc.TFLAG2_NO_CURSOR_ON_PROTECT=1073741824;tc.TFLAG3_WRAP_SPACES=1;tc.TFLAG3_NO_EDIT_TABLE_COL=2;tc.TFLAG3_TABLE_STATUS_LINE=4;tc.TFLAG3_PLAIN_TABLE_BORDER=8;tc.TFLAG3_GRAY_READ_ONLY=16;tc.TFLAG3_CURSOR_IN_CELL=32;tc.TFLAG3_EXACT_CELL_WIDTH=64;tc.TFLAG3_NO_SCROLL=128;tc.TFLAG3_NO_FULL_CELL_COPY=256;tc.TFLAG3_HTML_CONT_TABLE=512;tc.TFLAG3_SELECT_FIRST_FIELD=1024;tc.TFLAG3_MULTIPLE_RTF_GROUPS=2048;tc.TFLAG3_OLD_WORD_FORMAT=4096;tc.TFLAG3_EMBEDDED_TABLES=8192;tc.TFLAG3_DATA_FIELD_INPUT=16384;tc.TFLAG3_GET_BUF_HDR_FTR=32768;tc.TFLAG3_HTML_READ=65536;tc.TFLAG3_NO_RTF_BKND_COLOR=131072;tc.TFLAG3_NO_SAVE_UNDO=262144;tc.TFLAG3_LARGE_PARA_BORDER=524288;tc.TFLAG3_STYLES_ON_TOOLBAR=1048576;tc.TFLAG3_SHOW_FRAMES=2097152;tc.TFLAG3_LINE_SCROLL=4194304;tc.TFLAG3_PRINT_BKND_PICT=8388608;tc.TFLAG3_PASTE_RTF_CODE=16777216;tc.TFLAG3_CLIP_CELL_OVERFLOW=33554432;tc.TFLAG3_EXACT_SCREEN_FONT=67108864;tc.TFLAG3_ZERO_CELL_HEIGHT=134217728;tc.TFLAG3_READ_PNG=268435456;tc.TFLAG3_NO_TEXT_COLOR_ADJ=536870912;tc.TFLAG3_NO_MOUSE_SEL=1073741824;tc.TFLAG4_COUNT_PCHAR_AS_CRLF=1;tc.TFLAG4_SKIP_PROT_TEXT=2;tc.TFLAG4_HIDE_HIDDEN_PARA_MARK=4;tc.TFLAG4_READONLY_CONTROLS=8;tc.TFLAG4_NO_REPAGINATE=16;tc.TFLAG4_SMOOTH_SCROLL=32;tc.TFLAG4_NO_BUFFERED_SCROLL=64;tc.TFLAG4_TEXT_HIDDEN=128;tc.TFLAG4_AUTO_SPELL=256;tc.TFLAG4_BINARY_RTF_PICT=512;tc.TFLAG4_UNDO_WINDOW_OVERFLOW=1024;tc.TFLAG4_IME_UNICODE=2048;tc.TFLAG4_MOD_END_MARK_FONT=4096;tc.TFLAG4_ONE_ROW_TOOLBAR=8192;tc.TFLAG4_NO_OLE_DROP=16384;tc.TFLAG4_REPORT_EASE_MODE=32768;tc.TFLAG4_ALWAYS_INVOKE_OLE=65536;tc.TFLAG4_DISABLE_DATE_UPDATE=131072;tc.TFLAG4_SAVE_BMP_AS_PNG=262144;tc.TFLAG4_SAVE_SHAPE_WITH_DRAW_OBJECT=524288;tc.TFLAG4_HTML_INPUT=1048576;tc.TFLAG4_NO_DRAG_PROT_TEXT=2097152;tc.TFLAG4_FULL_DRAG_PROT_TEXT=4194304;tc.TFLAG4_NO_MERGE_TABLE=8388608;tc.TFLAG4_NO_TOC_UPDATE=16777216;tc.TFLAG4_NO_RESET_DC=33554432;tc.TFLAG4_NO_SHARE_BORDER=67108864;tc.TFLAG4_ADJ_LEFT_TABLE_COL=134217728;tc.TFLAG4_DONT_FIX_NEG_INDENT=268435456;tc.TFLAG4_PRINT_EMF_AS_BMP=536870912;tc.TFLAG5_NO_EXT_DROP=1;tc.TFLAG5_SET_FORM_TITLE=2;tc.TFLAG5_NO_KB_SEL=16;tc.TFLAG5_WRITE_DOB=32;tc.TFLAG5_NO_NORMALIZE_FNOTE=256;tc.TFLAG5_NO_NORMALIZE_FIELD=1024;tc.TFLAG5_BEF_AND_AFT_HIDDEN=2048;tc.TFLAG5_GROUP_UNDO=4096;tc.TFLAG5_NO_CLEAR_SPL_HIST=8192;tc.TFLAG5_FULL_REPAGINATE=16384;tc.TFLAG5_NO_SHOW_SPACE_SYM=32768;tc.TFLAG5_OLD_HLINK=65536;tc.TFLAG5_NO_DRAG_ROW_LINE=131072;tc.TFLAG5_SHOW_PAGE_BREAK=262144;tc.TFLAG5_VARIABLE_PAGE_SIZE=524288;tc.TFLAG5_NO_DRAG_CELL_LINE=1048576;tc.TFLAG5_PRINT_PREVIEW_DLG=2097152;tc.TFLAG5_RULER_INDENT_FIXED=4194304;tc.TFLAG5_TOP_ROW_TOOLBAR=8388608;tc.TFLAG5_XP_TOOLBAR=16777216;tc.TFLAG5_NO_ADJ_FOR_TABLE=33554432;tc.TFLAG5_OLD_RULER=67108864;tc.TFLAG5_NO_SHARE=134217728;tc.TFLAG5_FRAME_TEXT_ONLY=268435456;tc.TFLAG5_PROTECT_DATA_FIELD=536870912;tc.TFLAG5_NO_SPELLTIME=1073741824;tc.TFLAG6_USE_PEN_FOR_BORDER=1;tc.TFLAG6_WRITE_DEFAULT_COLOR=4;tc.TFLAG6_EXPAND_TEXT_BOX=8;tc.TFLAG6_DONT_WRITE_PICT_PATH=16;tc.TFLAG6_DONT_PROCESS_BULLET_KEYS=32;tc.TFLAG6_WORDPAD_COMPATIBLE_PICT=64;tc.TFLAG6_DONT_USE_SPELLTIME=128;tc.TFLAG6_SHOW_PICT_IN_PIXEL_SIZE=256;tc.TFLAG6_IN_TEST_MODE=512;tc.TFLAG6_ALLOW_CELL_OVERFLOW=2048;tc.TFLAG6_INSERT_DROP_PICT_AS_LINK=4096;tc.TFLAG6_WRAP_AT_WINDOW_WIDTH=8192;tc.TFLAG6_SAVE_TEXT_BK_COLOR=16384;tc.TFLAG6_LIST_TO_TEXT_IN_HTML=32768;tc.TFLAG6_NO_NATIVE_LIBS=65536;tc.TFLAG6_NO_LINK_MSG=131072;tc.TFLAG6_NO_TRACK_MSG=262144;tc.TFLAG6_OLE_DROP_SOURCE=524288;tc.TFLAG6_CENTER_DLGS_ON_SCR=1048576;tc.TFLAG6_TRACK_API=2097152;tc.TFLAG6_WRITE_PNTEXT=4194304;tc.TFLAG6_MBCS_HTML_OUTPUT=33554432;tc.TFLAG6_SWAP_CR_LINE_BREAK=67108864;tc.TFLAG6_DEL_CELL_TEXT=536870912;tc.TFLAG6_RIGHT_JUST_RTL=1073741824;tc.TFLAG7_NO_RTL_FONT=1;tc.TFLAG7_NO_SPELLER_POPUP=2;tc.TFLAG7_AUTO_NEW_ROW=16;tc.TFLAG7_HIDE_TC_FIELD=32;tc.TFLAG7_SKIP_WORD_WRAP=64;tc.TFLAG7_DRAW_OLD_VSCROLL=128;tc.TFLAG7_FORCE_RTL_TABLE=256;tc.TFLAG7_OLD_PICT_IN_FRAME=512;tc.TFLAG7_NO_TRACK_CHANGE_LINE=1024;tc.TFLAG7_SHRINK_PICT_TO_PAGE=2048;tc.TFLAG7_DONT_LOAD_CONTROLS=4096;tc.TFLAG7_AUTO_PARA_RTL=8192;tc.TFLAG7_SHOW_SPACES_AT_PARA_END=16384;tc.TFLAG7_DISABLE_RULER=32768;tc.TFLAG7_AUTO_SET_RTL=65536;tc.TFLAG7_ALWAYS_FIRE_MODIFY=131072;tc.TFLAG7_WRITE_LISTTEXT=262144;tc.TFLAG7_EXT_DROP_COPY=524288;tc.TFLAG7_INT_DROP_MOVE=1048576;tc.TFLAG7_SET_BOX_CLIPPING=2097152;tc.TFLAG7_NO_IME_CHAR=4194304;tc.TFLAG7_NO_SPELLCHECK_FIELDS=8388608;tc.TFLAG7_ISOLATE_UNICODE=16777216;tc.TFLAG7_RECORD_CUR_PARA_PROPS=33554432;tc.TFLAG7_RECORD_CUR_CHAR_PROPS=67108864;tc.TFLAG7_NO_INTERNET=268435456;tc.TFLAG7_NO_TABLE_AUTO_WIDTH=536870912;tc.TFLAG7_LOAD_EMPTY_TEXT_FIELD=1073741824;tc.TFLAG8_AUTO_REFORMAT_TABLES=1;tc.TFLAG8_HIDE_EMPTY_CELLS_ON_PRINT=2;tc.TFLAG8_DONT_SELECT_LAST_CHAR=4;tc.TFLAG8_OVERRIDE_LOOK_AND_FEEL=8;tc.TFLAG8_SKIP_FINAL_SAVE=16;tc.TFLAG8_FIX_NEG_INDENT=32;tc.TFLAG8_IGNORE_LASTROW=64;tc.TFLAG8_HIDE_PAGE_BLANK_AREA=128;tc.TFLAG8_HTML_TEXT=256;tc.TFLAG8_NO_BOX_CLIPPING=512;tc.TFLAG8_WRAP_ON_HYPHEN=1024;tc.TFLAG8_MERGE_TABLES_ON_PASTE=2048;tc.TFLAG8_INSERT_ROWS_ON_PASTE=4096;tc.TFLAG8_COMP_V14=8192;tc.TFLAG8_NO_TWIPS=16384;tc.TFLAG8_HTML_RTF_CONV=32768;tc.TFLAG8_WRITE_HTML_BULLET_CHAR=131072;tc.TFLAG8_WRITE_DOC_RTF=262144;tc.TFLAG8_DISABLE_ALT_RTF_FONT=524288;tc.TFLAG8_ALLOW_NARROW_PAGE=2097152;tc.TFLAG8_IN_HIN=4194304;tc.TFLAG8_WRITE_MERGE_TAG=8388608;tc.TFLAG8_DONT_HIDE_HIDDEN_CHAR=16777216;tc.TFLAG8_DONT_SPELL_CHECK_HDR_FTR=33554432;tc.TFLAG8_GET_TRACKING_CODES=67108864;tc.TFLAG8_OUTPUT_UNICODE_HTML=134217728;tc.TFLAG8_HIDE_PPV_EDIT_BUTTON=268435456;tc.TFLAG8_ALLOW_TEXT_BEF_PROT_FIELD=536870912;tc.TFLAG8_DONT_USE_KB_LANG=1073741824;tc.TFLAG9_SKIP_STRIKE_TEXT=1;tc.TFLAG9_SAVE_FILE_FOLDER=2;tc.TFLAG9_NO_NESTED_TABLE_WIDTH_ADJ=4;tc.TFLAG9_WRAP_LONG_HTML_WORD=8;tc.TFLAG9_TREAT_DATA_FIELD_AS_ATOM=16;tc.TFLAG9_NO_COMMENTS=32;tc.TFLAG9_SHRINK_LIST_TABLE=128;tc.TFLAG9_ALWAYS_WRITE_ROW_PROPS=256;tc.TFLAG9_NO_SHADE_DYNAMIC_FIELDS=512;tc.TFLAG9_SAME_CURSOR_POS_AFTER_ZOOM=1024;tc.TFLAG9_ALWAYS_FIRE_STATUS_EVENT=2048;tc.TFLAG9_ALWAYS_EMBED_TABLES=4096;tc.TFLAG9_NEW_RTF_LISTS=8192;tc.TFLAG9_TOC_TO_TEXT=16384;tc.TFLAG9_CONVERT_COMBO_BOX=32768;tc.TFLAG9_DONT_PASTE_TAGS=65536;tc.TFLAG9_ENABLE_POPUP_MENU=131072;tc.TFLAG9_USE_ORIG_JPG_FOR_PDF=262144;tc.TFLAG9_RETAIN_PROTECT_STYLE=524288;tc.TFLAG9_DONT_COLOR_PARA_SPACING=1048576;tc.TFLAG9_WORD2007_PAGE_BREAK=2097152;tc.TFLAG9_FORCE_STYLE=4194304;tc.TFLAG9_SHOW_FIELD=8388608;tc.TFLAG9_RTL_UNICODE_FILE=16777216;tc.TFLAG9_DONT_COUNT_LAST_BLANK_PAGE=67108864;tc.TFLAG9_DONT_PROTECT_PARA_BEF_TABLE=134217728;tc.TFLAG9_HIDE_PRINT_BUTTON=536870912;tc.TFLAG9_INVOKE_HYPERLINK=1073741824;tc.TFLAG10_DONT_MARK_WITH_SEL_COL=1;tc.TFLAG10_DONT_USE_BKSP_FONT=2;tc.TFLAG10_DONT_PAD_TABLE_HEIGHT=4;tc.TFLAG10_MERGE_NESTED_RTF_PROPS=8;tc.TFLAG10_EXTEND_AUTO_VSCROLL=16;tc.TFLAG10_NO_HLINK_BOOKMARK=32;tc.TFLAG10_NO_LAST_PARA_MARKER=64;tc.TFLAG10_DONT_COMBINE_UNDOS=128;tc.TFLAG10_AUTO_HSCROLL_BAR=256;tc.TFLAG10_DOTTED_GRID_LINES=512;tc.TFLAG10_NO_CRLF=1024;tc.TFLAG10_WRITE_FIX_WIDTH_TABLE=2048;tc.TFLAG10_USE_LAST_PARA_PROPS=4096;tc.TFLAG10_WRITE_RANDOM_LIST_TMPL_ID=16384;tc.TFLAG10_DST=32768;tc.TFLAG10_LOCK_DATA_FIELD=65536;tc.TFLAG10_SHRINK_RTF_IMAGES=262144;tc.TFLAG10_PREFER_PLACEHOLDER_PICT=524288;tc.TFLAG10_BOOKMARK_TO_PDF=2097152;tc.TFLAG10_INSERT_AT_FIELD_DATA_BEGIN=4194304;tc.TFLAG10_APPEND_TO_FIELD_DATA=16777216;tc.TFLAG10_NO_EQ_SUPPORT=33554432;tc.TFLAG10_HIDDEN_IN_GROUP=67108864;tc.TFLAG10_SHOW_HIDDEN_PARA=134217728;tc.TFLAG10_UPRIGHT_CHARS=268435456;tc.TFLAG11_NO_AUTO_PARA_STYLE_ON_TEXT=1;tc.TFLAG11_DONT_SHRINK_FONT_TABLE=2;tc.TFLAG11_NO_SHPPICT=4;tc.TFLAG11_NO_EXACT_LINE_SPACING=8;tc.TFLAG11_NO_CHAR_BKND=16;tc.TFLAG11_NO_PASTE_PAPER_PROPS=64;tc.TFLAG11_NO_ALTERNATING_BULLETS=128;tc.TFLAG11_ALWAYS_ENABLE_NEW_CMD=256;tc.TFLAG11_DONT_KEEP_TOGETHER_LONG_TABLES=512;tc.TFLAG11_DONT_BALANCE_FAR_EAST_TEXT=1024;tc.TFLAG11_WRITE_RTF_UNICODE_VAL=2048;tc.TFLAG11_NO_PREF_WIDTH_CALC=4096;tc.TFLAG11_PASTE_RTF_SHPTXT_IN_TABLE=65536;tc.TFLAG11_FRAME_BEF_TABLE=131072;tc.TFLAG11_NO_DEFAULT_SHPTXT=1048576;tc.TFLAG11_CONTEXTUAL_FONT_WIDTH=2097152;tc.TFLAG11_SHRINK_SUBTABLE_TO_FIT=4194304;tc.TFLAG11_NO_RIGHT_INDENT_TABLES=8388608;tc.TFLAG11_DISABLE_TOUCH_SCROLL=16777216;tc.TFLAG11_NO_REPAGE_IN_SHRINK_IMAGES=33554432;tc.CFLAG_SEL1=1;tc.CFLAG_SEL2=2;tc.CFLAG_MERGED=4;tc.CFLAG_AUTO_WIDTH=8;tc.CFLAG_ROW_SPANNED=16;tc.CFLAG_HTML=32;tc.CFLAG_COL_SPANNED=64;tc.CFLAG_HTML_HDR=128;tc.CFLAG_FIX_WIDTH=256;tc.CFLAG_FIX_WIDTH_PCT=512;tc.CFLAG_PREEXIST=1024;tc.CFLAG_RTF_SEL=2048;tc.CFLAG_VALIGN_CTR=4096;tc.CFLAG_VALIGN_BOT=8192;tc.CFLAG_FORCE_BKND_CLR=16384;tc.CFLAG_MARGIN_OVERRIDE=32768;tc.CFLAG_VALIGN_BASE=65536;tc.CFLAG_3D=131072;tc.CFLAG_AUTO_WIDTH_RTF=262144;tc.CFLAG_HAS_NESTED_TABLES=524288;tc.CFLAG_ROW_SPANNED_LAST=1048576;tc.CFLAG_ADDED_CELL=2097152;tc.CFLAG_HIDDEN=4194304;tc.CFLAG_HAS_FRAMES=8388608;tc.CFLAG_NO_WRAP=16777216;tc.CFLAG_WRAP_ON_CHAR=33554432;tc.LFLAG_PARA=1;tc.LFLAG_BREAK=2;tc.LFLAG_PARA_FIRST=4;tc.LFLAG_CONTROL=8;tc.LFLAG_FNOTE=16;tc.LFLAG_SOFT_COL=32;tc.LFLAG_NBSPACE=64;tc.LFLAG_LINE=128;tc.LFLAG_HTML_RULE=256;tc.LFLAG_BOX_TOP=512;tc.LFLAG_BOX_BOT=1024;tc.LFLAG_SECT=2048;tc.LFLAG_RHDR=4096;tc.LFLAG_NBDASH=8192;tc.LFLAG_PICT=16384;tc.LFLAG_RFTR=32768;tc.LFLAG_FNOTETEXT=65536;tc.LFLAG_FHDR=131072;tc.LFLAG_FFTR=262144;tc.LFLAG_HDR=524288;tc.LFLAG_FTR=1048576;tc.LFLAG_HYPH=2097152;tc.LFLAG_LHDR=4194304;tc.LFLAG_LFTR=8388608;tc.LFLAG_TOC=16777216;tc.LFLAG_LIST=33554432;tc.LFLAG_HPARA=67108864;tc.LFLAG_LISTNUM=134217728;tc.LFLAG_SELECTED=268435456;tc.LFLAG_ASSUMED_TAB=536870912;tc.LFLAG_AUTONUMLGL=1073741824;tc.LFLAG_HDR_FTR=tc.LFLAG_HDR|tc.LFLAG_FTR;tc.LFLAG_LHDR_LFTR=tc.LFLAG_LHDR|tc.LFLAG_LFTR;tc.LFLAG_RHDR_RFTR=tc.LFLAG_RHDR|tc.LFLAG_RFTR;tc.LFLAG_FHDR_FFTR=tc.LFLAG_FHDR|tc.LFLAG_FFTR;tc.LFLAG_HDRS_FTRS=tc.LFLAG_HDR|tc.LFLAG_FTR|tc.LFLAG_LHDR|tc.LFLAG_LFTR|tc.LFLAG_RHDR|tc.LFLAG_RFTR|tc.LFLAG_FHDR|tc.LFLAG_FFTR;tc.LFLAG_HDRS=tc.LFLAG_HDR|tc.LFLAG_LHDR|tc.LFLAG_RHDR|tc.LFLAG_FHDR;tc.LFLAG_FTRS=tc.LFLAG_FTR|tc.LFLAG_LFTR|tc.LFLAG_RFTR|tc.LFLAG_FFTR;tc.LFLAG2_SPELL_CHECKED=1;tc.LFLAG2_ENOTETEXT=2;tc.LFLAG2_TC=4;tc.LFLAG2_HIDDEN_CHAR=8;tc.LFLAG2_BOX_BETWEEN=16;tc.LFLAG2_RTL=32;tc.LFLAG2_DEL_REV=64;tc.LFLAG2_INS_REV=128;tc.LFLAG2_PARA_RTL=256;tc.LFLAG2_TEMP_HYPH=512;tc.LFLAG2_PICT_TEXT=1024;tc.LFLAG2_LEFT_LINE=2048;tc.LFLAG2_FRAME_TOP=4096;tc.LFLAG2_SHADE_BEGIN=8192;tc.LFLAG2_SHADE_END=16384;tc.LFLAG2_SPACE_TAKING_FRAME=32768;tc.LFLAG2_SEQ=65536;tc.LFLAG2_HAS_LINKED_STYLE=262144;tc.LFLAG2_HAS_ASIAN=524288;tc.INFO_TAB=1;tc.INFO_SECT=2;tc.INFO_PAGE=4;tc.INFO_COL=8;tc.INFO_CELL=16;tc.INFO_ROW=32;tc.INFO_TABLE=64;tc.INFO_JUST=128;tc.INFO_FRAME=1024;tc.INFO_SPACE_LINE=2048;tc.INFO_PAGE_NUMBER=4096;tc.INFO_FRM_SPC_BEF=8192;tc.INFO_DYN_FIELD=16384;tc.INFO_ALT_JUST=32768;tc.INFO_NEG_JUST=65536;tc.PARA_FRAME_HPAGE=1;tc.PARA_FRAME_USED=2;tc.PARA_FRAME_RIGHT_JUST=4;tc.PARA_FRAME_CENTER=8;tc.PARA_FRAME_SET_WIDTH=16;tc.PARA_FRAME_VPAGE=32;tc.PARA_FRAME_VMARG=64;tc.PARA_FRAME_TEXT_BOX=128;tc.PARA_FRAME_LINE=256;tc.PARA_FRAME_RECT=512;tc.PARA_FRAME_BOXED=1024;tc.PARA_FRAME_DOTTED=2048;tc.PARA_FRAME_SELECT=4096;tc.PARA_FRAME_NO_WRAP=8192;tc.PARA_FRAME_WRAP_IGNORE=16384;tc.PARA_FRAME_POSITIONED=32768;tc.PARA_FRAME_PAGE_BREAK=65536;tc.PARA_FRAME_CONV=131072;tc.PARA_FRAME_NO_LINE=262144;tc.PARA_FRAME_IGNORE_X=524288;tc.PARA_FRAME_IGNORE_Y=1048576;tc.PARA_FRAME_SHPGRP=2097152;tc.PARA_FRAME_WATERMARK=4194304;tc.PARA_FRAME_FILL_PICT=8388608;tc.PARA_FRAME_IN_CELL=16777216;tc.PARA_FRAME_VCENTER=33554432;tc.PARA_FRAME_FIXED_HEIGHT=67108864;tc.PARA_FRAME_BEHIND_TEXT=134217728;tc.PARA_FRAME_VLINE=268435456;tc.PARA_FRAME_HCHAR=536870912;tc.PARA_FRAME_HCOL=1073741824;tc.PARA_FRAME_OBJECT=tc.PARA_FRAME_TEXT_BOX|tc.PARA_FRAME_LINE|tc.PARA_FRAME_RECT;tc.PF2_END_ARROW=1;tc.PF2_START_ARROW=2;tc.PF2_FLIPH=4;tc.PF2_FLIPV=8;tc.PF2_VBOTTOM=16;tc.PF2_PVPARA=32;tc.PF2_CANVAS=64;tc.PF2_INLINE=128;tc.PF2_HTML_RULE=256;tc.PF2_ANCHOR_IN_CELL=512;tc.PF2_SET_HEIGHT=1024;tc.PF2_HIDDEN=2048;tc.PF2_LEFT=4096;tc.PF2_NO_DELETE=8192;tc.PF2_NO_MOVE=16384;tc.PF2_NO_SIZE=32768;tc.PF2_HTML=65536;tc.PF2_POLYLINE=131072;tc.PF2_TABLE_FRAME=262144;tc.PF2_NO_OVERLAP=524288;tc.PF2_SIZE_TO_TEXT=1048576;tc.PF2_EMPTY_TEXT_BOX=2097152;tc.PF2_WRAP_AROUND=4194304;tc.PF2_VTOP=8388608;tc.PF2_WRAP_TIGHT=16777216;tc.PF2_BEHIND_DOC=33554432;tc.PF2_CALCX_SET=67108864;tc.PF2_RIGHT_MARG=134217728;tc.PF2_OVERLAY=268435456;tc.PF2_VBOT_MARG=536870912;tc.REL_WINDOW=1;tc.REL_TEXT_BOX=2;tc.ACTION_COMMAND=1;tc.ACTION_VSCROLL=2;tc.ACTION_HSCROLL=3;tc.ACTION_CHAR=4;tc.ACTION_LBUTTONDOWN=5;tc.ACTION_RBUTTONDOWN=6;tc.ACTION_LBUTTONUP=7;tc.ACTION_RBUTTONUP=8;tc.ACTION_LBUTTONDBLCLK=9;tc.ACTION_RBUTTONDBLCLK=10;tc.ACTION_SIZE=11;tc.ACTION_SETFOCUS=12;tc.ACTION_KILLFOCUS=13;tc.ACTION_MOUSEMOVE=14;tc.ACTION_STYLE=15;tc.ACTION_ROW_INDENT=21;tc.ACTION_ROW_HEIGHT=22;tc.ACTION_CELL_WIDTH=23;tc.ACTION_PICT_SIZE=24;tc.ACTION_FRAME_SIZE=25;tc.ACTION_DRAG_DEL=27;tc.ACTION_KEYDOWN=28;tc.ACTION_KEYUP=29;tc.ACTION_LONG_PRESS=30;tc.ACTION_TOUCH_MOVE=31;tc.BLT_ROUND=1;tc.BLT_DIAMOND=2;tc.BLT_SQUARE=3;tc.BLT_HOLLOW_SQUARE=4;tc.BLT_4_DIAMONDS=5;tc.BLT_ARROW=6;tc.BLT_CHECK=7;tc.BLTFLAG_HIDDEN=1;tc.BLTFLAG_USED=2;tc.NBR_DEC=0;tc.NBR_UPR_ALPHA=1;tc.NBR_LWR_ALPHA=2;tc.NBR_UPR_ROMAN=3;tc.NBR_LWR_ROMAN=4;tc.NBR_DEFAULT=5;tc.LIST_DEC=0;tc.LIST_UPR_ROMAN=1;tc.LIST_LWR_ROMAN=2;tc.LIST_UPR_ALPHA=3;tc.LIST_LWR_ALPHA=4;tc.LIST_ORDINAL=5;tc.LIST_CARDINAL=6;tc.LIST_ORDINAL_TEXT=7;tc.LIST_KANJI_DBNUM2=11;tc.LIST_KANJI_NUM=16;tc.LIST_KANJI_NUM_LAST=17;tc.LIST_KOREAN2=24;tc.LIST_HEBREW=45;tc.LIST_CHINESE_NUM=26;tc.LIST_CHINESE_NUM_LAST=29;tc.LIST_CHINESE_ZOD=30;tc.LIST_CHINESE_ZOD_LAST=35;tc.LIST_CHINESE_DBL=37;tc.LIST_CHINESE_DBL_LAST=40;tc.LIST_DEC_PAD=22;tc.LIST_BLT=23;tc.LIST_NO_NUM=255;tc.LISTFLAG_RESTART_SEC=1;tc.LISTFLAG_NEW_LIST=2;tc.LISTAFT_TAB=0;tc.LISTAFT_SPACE=1;tc.LISTAFT_NONE=2;tc.LISTLEVEL_RESTART=1;tc.LISTLEVEL_OLD=2;tc.LISTLEVEL_RESTARTED=4;tc.LISTLEVEL_LEGAL=8;tc.LISTLEVEL_REFORMAT=16;tc.LISTLEVEL_NO_RESET=32;tc.LISTLEVEL_CENTER=64;tc.LISTLEVEL_RIGHT=128;tc.LISTOR_FOUND=1;tc.PID_LINE=0;tc.PID_PARA=1;tc.PID_BULLET=2;tc.PID_TAB=3;tc.PID_STYLE=4;tc.TER_FILE=1;tc.TER_BUF=2;tc.SCOPE_BEGIN=0;tc.SCOPE_FORWARD=1;tc.SCOPE_BACKWARD=2;tc.SCOPE_ANY=3;tc.ANIM_CONTINUOUS=-2;tc.SECT_ALL=-1;tc.SECT_CUR=-2;tc.PARAM_IGNORE=-31234;tc.FIELD_PAGE_NUMBER=1;tc.FIELD_TEXTBOX=2;tc.FIELD_CHECKBOX=3;tc.FIELD_LISTBOX=4;tc.FIELD_COMBOBOX=4;tc.FIELD_PAGE_COUNT=5;tc.FIELD_NAME=6;tc.FIELD_DATA=7;tc.FIELD_DATE=8;tc.FIELD_TOC=9;tc.FIELD_PRINTDATE=10;tc.FIELD_LISTNUM=11;tc.FIELD_AUTONUMLGL=12;tc.FIELD_TC=13;tc.FIELD_HLINK=14;tc.FIELD_XE=15;tc.FIELD_PAGE_REF=16;tc.FIELD_SECT_PAGE_COUNT=17;tc.FIELD_USER1=18;tc.FIELD_REF=19;tc.FIELD_INCLUDEPICTURE=20;tc.FIELD_SEQ=21;tc.FIELD_FILE_NAME=22;tc.FIELD_FORMULA=23;tc.FIELD_DOC_PROP=24;tc.FIELD_TIME=25;tc.SECT_NEW_PAGE=1;tc.SECT_RESTART_PAGE_NO=2;tc.SECT_HAS_TITLE_PAGE=4;tc.SECT_EXACT_MARGT=8;tc.SECT_EXACT_MARGB=16;tc.SECT_BRDR_HEADER=32;tc.SECT_BRDR_FOOTER=64;tc.SECT_VALIGN_CTR=128;tc.SECT_VALIGN_BOT=256;tc.SECT_LINE=512;tc.SECT_SNAP_LINE_GRID=1024;tc.SECT_LINE_BET_COL=2048;tc.SECT_HAS_FACING_PAGES=4096;tc.SECT_VAR_COL_WIDTH=8192;tc.SECT_START_ON_EVEN_PAGE=16384;tc.SECT_START_ON_ODD_PAGE=32768;tc.SECT_GUTTER_ADDED=65536;tc.SECT_UNLOCKED=131072;tc.SP_FLAGS=1;tc.SP_LINE_STEP=2;tc.SP_BORDER_TYPE=3;tc.SP_BORDER_WIDTH=4;tc.SP_BORDER_SPACE=5;tc.SP_BORDER_COLOR=6;tc.SP_FIRST_PAGE_HDR_HT=7;tc.SP_FIRST_PAGE_BODY_HT=8;tc.SP_IN_USE=10;tc.SP_PREV_SECT=11;tc.SP_NEXT_SECT=12;tc.SP_LINE_BET_COL=14;tc.SP_LEFT_MARG=15;tc.SP_RIGHT_MARG=16;tc.SP_TOP_MARG=17;tc.SP_BOT_MARG=18;tc.SP_HDR_MARG=19;tc.SP_FTR_MARG=20;tc.SP_GUTTER_MARG=21;tc.SP_NUM_COLS=22;tc.SP_COL_SPACE=23;tc.PP_PAGE_HDR_HT=1;tc.PP_PAGE_BODY_HT=2;tc.PP_PAGE_FTR_HT=3;tc.PP_DISP_NO=4;tc.PP_NO=5;tc.PP_TOP_SECT=6;tc.PP_FIRST_LINE=7;tc.PP_LAST_LINE=8;tc.PP_FLAGS=9;tc.PP_PAGE_BODY_AVAIL_HT=10;tc.PP_HDR_CHAR=11;tc.PP_FTR_CHAR=12;tc.PARA_BOX_SPACE=20;tc.PARA_BORDER_WIDTH=30;tc.TER_FIRST=0;tc.TER_LAST=1;tc.TER_NEXT=2;tc.TER_PREV=4;tc.TER_CUR=5;tc.WC_SELECTION=1;tc.WC_INCLUDE_HDR_FTR=2;tc.WC_INCLUDE_HIDDEN=4;tc.TERTAG_USER=0;tc.TERTAG_BKM=1;tc.TERTAG_TOC=2;tc.TERTAG_HEADING=3;tc.TERTAG_SECT=4;tc.TERTAG_HPARA=5;tc.TERTAG_HPARA2=6;tc.OCX_METHOD=0;tc.OCX_SET_PROP=1;tc.OCX_GET_PROP=2;tc.OCX_SET_PROP_REF=3;tc.OCX_NONE=0;tc.OCX_BOOL=1;tc.OCX_LONG=2;tc.OCX_STRING=3;tc.OCX_DISPATCH=4;tc.TLB_LINE=1;tc.TLB_TYPEFACE=2;tc.TLB_POINTSIZE=3;tc.TLB_BOLD=4;tc.TLB_ITALIC=5;tc.TLB_ULINE=6;tc.TLB_ALIGN_LEFT=7;tc.TLB_ALIGN_RIGHT=8;tc.TLB_ALIGN_CENTER=9;tc.TLB_ALIGN_JUSTIFY=10;tc.TLB_INC_INDENT=11;tc.TLB_DEC_INDENT=12;tc.TLB_STYLE=13;tc.TLB_ZOOM=14;tc.TLB_CUT=15;tc.TLB_COPY=16;tc.TLB_PASTE=17;tc.TLB_SPACER=18;tc.TLB_NEW=19;tc.TLB_OPEN=20;tc.TLB_SAVE=21;tc.TLB_PRINT=22;tc.TLB_HELP=23;tc.TLB_PAR=24;tc.TLB_PREVIEW=25;tc.TLB_NUMBER=26;tc.TLB_BULLET=27;tc.TLB_UNDO=28;tc.TLB_REDO=29;tc.TLB_FIND=30;tc.TLB_DATE=31;tc.TLB_PAGE_NUM=32;tc.TLB_PAGE_COUNT=33;tc.TLB_PAINT_FORMAT=34;tc.TLB_BULLET_DROPDOWN=35;tc.MAX_TLB=36;tc.PBPOS_LEFT=-1;tc.PBPOS_TOP=-1;tc.PBPOS_CENTER=-2;tc.PBPOS_MIDDLE=-2;tc.PBPOS_RIGHT=-3;tc.PBPOS_BOT=-3;tc.PBPOS_DEFAULT=-4;tc.WM_USER=1024;tc.TER_CLOSE=tc.WM_USER+1700;tc.TER_MODIFIED=tc.WM_USER+1701;tc.TER_LINK=tc.WM_USER+1702;tc.TER_MERGE=tc.WM_USER+1703;tc.TER_NOT_SAVED=tc.WM_USER+1704;tc.TER_UPDATE_TOOLBAR=tc.WM_USER+1705;tc.TER_UPDATE_STATUSBAR=tc.WM_USER+1706;tc.TER_ACTION=tc.WM_USER+1707;tc.TER_PREPROCESS=tc.WM_USER+1708;tc.TER_XLATE_PICT=tc.WM_USER+1709;tc.TER_HTML_SIZE=tc.WM_USER+1710;tc.TER_ANIM_PICT=tc.WM_USER+1711;tc.TER_REPAINT=tc.WM_USER+1712;tc.TER_WM_COMMAND=tc.WM_USER+1713;tc.TER_PAGE_SIZE_CHANGING=tc.WM_USER+1714;tc.TER_USER_FIELD1=tc.WM_USER+1715;tc.TER_IDLE=tc.WM_USER+10;tc.TER_POPUP=tc.WM_USER+11;tc.API_FIRST=tc.WM_USER+2e3;tc.API_InsertTerText=tc.WM_USER+2e3;tc.API_TerCommand=tc.WM_USER+2001;tc.API_TerAbsToRowCol=tc.WM_USER+2002;tc.API_SetTerCursorPos=tc.WM_USER+2003;tc.API_SelectTerText=tc.WM_USER+2004;tc.API_GetTerLine=tc.WM_USER+2005;tc.API_GetTerFields=tc.WM_USER+2006;tc.API_DeselectTerText=tc.WM_USER+2007;tc.API_TerGetCaretPos=tc.WM_USER+2008;tc.API_TerRowColToAbs=tc.WM_USER+2009;tc.API_TerPixToTextPos=tc.WM_USER+2010;tc.API_TerInsertText=tc.WM_USER+2011;tc.API_TerSearchReplace=tc.WM_USER+2012;tc.API_TerTextPosToPix=tc.WM_USER+2013;tc.API_TerGetLine=tc.WM_USER+2014;tc.API_GetFontInfo=tc.WM_USER+2015;tc.API_TerGetCurFont=tc.WM_USER+2016;tc.API_TerGetEffectiveFont=tc.WM_USER+2017;tc.API_TerDeleteBlock=tc.WM_USER+2018;tc.API_TerLocateStyleChar=tc.WM_USER+2019;tc.API_TerGetReadOnly=tc.WM_USER+2020;tc.API_TerGetParam=tc.WM_USER+2021;tc.API_TerGetLineParam=tc.WM_USER+2022;tc.API_LAST=tc.WM_USER+2022;tc.ID_PGUP=600;tc.ID_PGDN=601;tc.ID_UP=602;tc.ID_DOWN=603;tc.ID_LEFT=604;tc.ID_RIGHT=605;tc.ID_DEL=606;tc.ID_BACK_SPACE=607;tc.ID_TAB=608;tc.ID_BACK_TAB=609;tc.ID_LINE_BEGIN=610;tc.ID_LINE_END=611;tc.ID_FILE_BEGIN=612;tc.ID_FILE_END=613;tc.ID_CTRL_TAB=614;tc.ID_INS_AFT=615;tc.ID_INS_BEF=616;tc.ID_DEL_LINE=617;tc.ID_SPLIT_LINE=618;tc.ID_JOIN_LINE=619;tc.ID_NEXT_WORD=620;tc.ID_PREV_WORD=621;tc.ID_HILIGHT_LINE=622;tc.ID_BLOCK_COPY=623;tc.ID_BLOCK_MOVE=624;tc.ID_SELECT_ALL=625;tc.ID_NEW=626;tc.ID_OPEN=627;tc.ID_CUT=628;tc.ID_COPY=629;tc.ID_PASTE=630;tc.ID_PASTE_SPEC=631;tc.ID_PICT_FROM_FILE=632;tc.ID_EMBED_PICT=632;tc.ID_SEARCH=633;tc.ID_SEARCH_FOR=634;tc.ID_SEARCH_BACK=635;tc.ID_REPLACE=636;tc.ID_TER_HELP=637;tc.ID_UNDO=638;tc.ID_INSERT=639;tc.ID_SAVE=640;tc.ID_SAVEAS=641;tc.ID_QUIT=642;tc.ID_PRINT=643;tc.ID_PAGE_OPTIONS=644;tc.ID_PRINT_OPTIONS=645;tc.ID_JUMP=646;tc.ID_CHAR_NORMAL=647;tc.ID_BOLD_ON=648;tc.ID_ULINE_ON=649;tc.ID_ITALIC_ON=650;tc.ID_STRIKE_ON=651;tc.ID_SUPSCR_ON=652;tc.ID_SUBSCR_ON=653;tc.ID_COLOR=654;tc.ID_FONTS=655;tc.ID_PARA_NORMAL=656;tc.ID_CENTER=657;tc.ID_RIGHT_JUSTIFY=658;tc.ID_LEFT_INDENT=659;tc.ID_RIGHT_INDENT=660;tc.ID_DOUBLE_SPACE=661;tc.ID_HANGING_INDENT=662;tc.ID_JUSTIFY=663;tc.ID_TAB_CLEAR=666;tc.ID_TAB_CLEAR_ALL=667;tc.ID_PAGE_BREAK=670;tc.ID_REPAGINATE=671;tc.ID_SECT_BREAK=672;tc.ID_SECT_OPTIONS=673;tc.ID_PAGE_MODE=674;tc.ID_COL_BREAK=675;tc.ID_VIEW_HDR_FTR=676;tc.ID_EDIT_HDR_FTR=677;tc.ID_RULER=680;tc.ID_TOOL_BAR=681;tc.ID_STATUS_RIBBON=682;tc.ID_EDIT_PICT=685;tc.ID_SHOW_HIDDEN=686;tc.ID_HIDDEN_ON=687;tc.ID_ULINED_ON=688;tc.ID_PROTECT_ON=689;tc.ID_PROTECTION_LOCK=690;tc.ID_PARA_BORDER=691;tc.ID_SHOW_PARA_MARK=692;tc.ID_INSERT_OBJECT=693;tc.ID_TABLE_INSERT=694;tc.ID_TABLE_INSERT_ROW=695;tc.ID_TABLE_SPLIT_CELL=696;tc.ID_TABLE_MERGE_CELLS=697;tc.ID_TABLE_DEL_CELLS=698;tc.ID_TABLE_SHOW_GRID=699;tc.ID_TABLE_ROW_POS=700;tc.ID_TABLE_CELL_BORDER=701;tc.ID_TABLE_CELL_SHADE=702;tc.ID_TABLE_ROW_HEIGHT=703;tc.ID_TABLE_INSERT_COL=704;tc.ID_TABLE_SPLIT_CELL_VERT=705;tc.ID_SHOW_HYPERLINK_CURSOR=710;tc.ID_BK_COLOR=711;tc.ID_CTRL_UP=715;tc.ID_CTRL_DOWN=716;tc.ID_PRINT_PREVIEW=717;tc.ID_INSERT_PARA_FRAME=718;tc.ID_INSERT_PAGE_NUMBER=719;tc.ID_PARA_SPACING=720;tc.ID_INSERT_FNOTE=721;tc.ID_EDIT_FNOTE=722;tc.ID_PARA_KEEP=723;tc.ID_PARA_KEEP_NEXT=724;tc.ID_BOX_ON=725;tc.ID_INSERT_DRAW_OBJECT=726;tc.ID_EDIT_OLE=727;tc.ID_SNAP_TO_GRID=728;tc.ID_BULLET=729;tc.ID_EDIT_STYLE=730;tc.ID_CHAR_STYLE=731;tc.ID_PARA_STYLE=732;tc.ID_ZOOM=733;tc.ID_TAB_SET=734;tc.ID_FRAME_YBASE=735;tc.ID_EDIT_DOB=736;tc.ID_BKND_PICT=737;tc.ID_LINK_PICT=738;tc.ID_FITTED_VIEW=739;tc.ID_INSERT_NBSPACE=740;tc.ID_SPELL=741;tc.ID_HLINK_ON=742;tc.ID_WIDOW_ORPHAN=743;tc.ID_SHOW_PAGE_BORDER=744;tc.ID_SHOW_PAGE_LAYOUT=744;tc.ID_DEL_PREV_WORD=745;tc.ID_INSERT_NBDASH=746;tc.ID_REDO=747;tc.ID_PARA_NBR=748;tc.ID_PARA_BK_COLOR=749;tc.ID_TABLE_CELL_VALIGN=750;tc.ID_TABLE_SEL_COL=751;tc.ID_INSERT_PAGE_COUNT=752;tc.ID_INSERT_BOOKMARK=753;tc.ID_CREATE_FIRST_HDR=754;tc.ID_CREATE_FIRST_FTR=755;tc.ID_DELETE_FIRST_HDR=756;tc.ID_DELETE_FIRST_FTR=757;tc.ID_SHOW_FIELD_NAMES=758;tc.ID_INSERT_HYPH=759;tc.ID_CHAR_SPACE=760;tc.ID_INLINE_IME=761;tc.ID_TABLE_HDR_ROW=762;tc.ID_RETURN=763;tc.ID_TABLE_ROW_KEEP=764;tc.ID_TABLE_CELL_COLOR=765;tc.ID_INSERT_DATA_FIELD=766;tc.ID_INSERT_INPUT_FIELD=767;tc.ID_INSERT_CHECKBOX=768;tc.ID_EDIT_INPUT_FIELD=769;tc.ID_INSERT_DATE_TIME=770;tc.ID_INSERT_TOC=771;tc.ID_LEFT_JUSTIFY=772;tc.ID_PAGE_BREAK_BEFORE=773;tc.ID_CAPS_ON=774;tc.ID_SCAPS_ON=775;tc.ID_AUTO_SPELL=776;tc.ID_INSERT_ENOTE=777;tc.ID_EDIT_ENOTE=778;tc.ID_CREATE_LIST=779;tc.ID_EDIT_LIST=780;tc.ID_CREATE_LIST_OR=781;tc.ID_EDIT_LIST_OR=782;tc.ID_EDIT_LIST_LEVEL=783;tc.ID_PARA_LIST=784;tc.ID_LEFT_INDENT_DEC=785;tc.ID_TABLE_CELL_BORDER_COLOR=786;tc.ID_PASTE_TEXT=787;tc.ID_TABLE_CELL_WIDTH=788;tc.ID_FRAME_ROTATE_TEXT=789;tc.ID_PARA_RTL=790;tc.ID_TABLE_ROW_RTL=791;tc.ID_SECT_RTL=792;tc.ID_DOC_RTL=793;tc.ID_INSERT_HLINK=794;tc.ID_TRACK_CHANGES=795;tc.ID_ULINE_COLOR=796;tc.ID_LIST_LEVEL_INC=797;tc.ID_LIST_LEVEL_DEC=798;tc.ID_RESET=799;tc.ID_BORDER_MARGIN=800;tc.ID_PROTECT_FORM=801;tc.ID_WATERMARK=802;tc.ID_TABLE_CELL_VTEXT=803;tc.ID_NEXT_CHANGE=804;tc.ID_PREV_CHANGE=805;tc.ID_ACCEPT_CHANGE=806;tc.ID_ACCEPT_ALL_CHANGES=807;tc.ID_USER1=808;tc.ID_USER2=809;tc.ID_USER3=810;tc.ID_USER4=811;tc.ID_USER5=812;tc.ID_USER6=813;tc.ID_USER7=814;tc.ID_USER8=815;tc.ID_USER9=816;tc.ID_DEL_NEXT_WORD=817;tc.ID_CHAR_SCALEX=818;tc.ID_REJECT_CHANGE=819;tc.ID_REJECT_ALL_CHANGES=820;tc.ID_VRULER=821;tc.ID_PARA_RTL_KEY=822;tc.ID_PARA_LTR_KEY=823;tc.ID_CREATE_RIGHT_HDR=824;tc.ID_CREATE_RIGHT_FTR=825;tc.ID_DELETE_RIGHT_HDR=826;tc.ID_DELETE_RIGHT_FTR=827;tc.ID_CREATE_LEFT_HDR=828;tc.ID_CREATE_LEFT_FTR=829;tc.ID_DELETE_LEFT_HDR=830;tc.ID_DELETE_LEFT_FTR=831;tc.ID_DOUBLE_STRIKE_ON=832;tc.ID_HIDE_CHANGES=833;tc.ID_INSERT_COMBOBOX=834;tc.ID_APPLY_COMMENT=835;tc.ID_NUM_TO_CHAR=836;tc.ID_PAINT_FORMAT=837;tc.ID_HILIGHT_TEXT=838;tc.ID_RESET_CHAR_STYLES=839;tc.ID_TABLE_SPLIT=840;tc.ID_BULLET_DROPDOWN=841;tc.ID_SPACE=842;tc.ID_HAS_TOUCH_SCREEN=843;tc.ID_TOOLBAR_MENU=844;tc.ID_MENU=845;tc.ID_FIRST_USER_CMD=1e3;tc.ID_LAST_USER_CMD=1100;tc.MSG_NO_ERROR=0;tc.MSG_BAD_BMP_FILE=1;tc.MSG_BAD_FNOTE_MARKER=2;tc.MSG_BAD_OBJ_SIZE=3;tc.MSG_BAD_PRINTER_DRV=4;tc.MSG_CELL_DATA_MISSING=5;tc.MSG_CELL_WITHOUT_ROW=6;tc.MSG_CHARSTYLE_IN_USE=7;tc.MSG_CHAR_FMT_MISSING=8;tc.MSG_CLIPBOARD_BUSY=9;tc.MSG_CLIPBOARD_NO_DATA=10;tc.MSG_CLIPBOARD_NO_FMT=11;tc.MSG_COUNT_MISMATCH=12;tc.MSG_CREATE_NEW_FILE=13;tc.MSG_END_BACKWARD_SEARCH=14;tc.MSG_END_FORWARD_SEARCH=15;tc.MSG_ERR_ADDING_STRING=16;tc.MSG_ERR_ADDING_VALUE=17;tc.MSG_ERR_ADVISE_CONNECT=18;tc.MSG_ERR_ADV_CREATE=19;tc.MSG_ERR_BLOCK_SIZE=20;tc.MSG_ERR_BMP_CREATE=21;tc.MSG_ERR_CTL_CREATE=22;tc.MSG_ERR_DATA_RETRIEVE=23;tc.MSG_ERR_DIB_CREATE=24;tc.MSG_ERR_END_PAGE=25;tc.MSG_ERR_END_PRINTER=26;tc.MSG_ERR_FILE_LENGTH=27;tc.MSG_ERR_FILE_OPEN=28;tc.MSG_ERR_FILE_READ=29;tc.MSG_ERR_FILE_SEEK=30;tc.MSG_ERR_FILE_WRITE=31;tc.MSG_SEL_PROTECTED=32;tc.MSG_SPELL_OVER=33;tc.MSG_STYLESHEET_MISSING=34;tc.MSG_TAB_TBL_MISSING=35;tc.MSG_TBL_DATA_MISSING=36;tc.MSG_TYPE_STYLE_NAME=37;tc.MSG_UNDO_EMPTY=38;tc.MSG_UNEXPECTED_EOF=39;tc.MSG_SEL_SPAN_HDRFTR=40;tc.MSG_SECT_TBL_MISSING=41;tc.MSG_ERR_FONT_CREATE=42;tc.MSG_ERR_FONT_SELECT=43;tc.MSG_ERR_INIT_BMP=44;tc.MSG_ERR_INIT_OLE=45;tc.MSG_ERR_INIT_PRINTER=46;tc.MSG_ERR_INSTANCE=47;tc.MSG_ERR_LOAD_ACCEL=48;tc.MSG_ERR_MAIL_MERGE=49;tc.MSG_ERR_MEM_LOCK=50;tc.MSG_ERR_META_ACCESS=51;tc.MSG_ERR_META_BAD_FILE=52;tc.MSG_ERR_META_COPY=53;tc.MSG_ERR_META_CREATE=54;tc.MSG_ERR_META_READ=55;tc.MSG_ERR_META_RECREATE=56;tc.MSG_ERR_OBJ_DATA=57;tc.MSG_ERR_OBJ_SAVE=58;tc.MSG_ERR_OBJ_SIZE=59;tc.MSG_ERR_OLE_CLSID=60;tc.MSG_ERR_OLE_DATA_CONV=61;tc.MSG_ERR_OLE_LOAD=62;tc.MSG_ERR_OLE_SAVE=63;tc.MSG_ERR_OLE_USER=64;tc.MSG_ERR_OLE_VERSION=65;tc.MSG_ERR_PEN=66;tc.MSG_ERR_PICT_FILE_FMT=67;tc.MSG_ERR_PICT_FILE_OPEN=68;tc.MSG_ERR_PICT_FILE_READ=69;tc.MSG_ERR_PRESENT_DATA=70;tc.MSG_ERR_SITE_CREATE=71;tc.MSG_ERR_START_PRINTER=72;tc.MSG_ERR_STORAGE_CREATE=73;tc.MSG_ERR_STORAGE_RETRIEVE=74;tc.MSG_ERR_TEXT_METRIC=75;tc.MSG_ERR_VIEW_RETRIEVE=76;tc.MSG_FILE_INFO_MISSING=77;tc.MSG_FILE_SIGN_MISSING=78;tc.MSG_FONT_TBL_INCOMPL=79;tc.MSG_INVALID_NUMBER=80;tc.MSG_INVALID_PRINT_RECT=81;tc.MSG_INVALID_SECT_DATA=82;tc.MSG_INVALID_SELECT=83;tc.MSG_KEEP_HDRFTR_LINE=84;tc.MSG_LINE_TOO_LONG=85;tc.MSG_LINE_TRUNCATED=86;tc.MSG_MARGIN_TOO_LARGE=87;tc.MSG_MAX_LINES_EXCEEDED=88;tc.MSG_MERGE_DATA_TOO_LONG=89;tc.MSG_MISSING_ROW_MARKER=90;tc.MSG_NODEL_HDRFTR_BODY=91;tc.MSG_NOT_TE_FILE=92;tc.MSG_NO_HILIGHT=93;tc.MSG_NO_OLE_CLASS=94;tc.MSG_NO_RANGE_PRINTING=95;tc.MSG_NO_SERVER=96;tc.MSG_NO_STRING=97;tc.MSG_NULL_FIELD=98;tc.MSG_OLEERR_NEED_SHARE=99;tc.MSG_OLEERR_NO_CLASS=100;tc.MSG_OUT_OF_CELL_SLOT=101;tc.MSG_OUT_OF_CHAR_STACK=102;tc.MSG_OUT_OF_COMP_DC=103;tc.MSG_OUT_OF_DC=104;tc.MSG_OUT_OF_DRAG_OBJ=105;tc.MSG_OUT_OF_FONT_SLOT=106;tc.MSG_OUT_OF_GROUP=107;tc.MSG_OUT_OF_MEM=108;tc.MSG_OUT_OF_PARA_SLOT=109;tc.MSG_OUT_OF_PARAFID_SLOT=110;tc.MSG_OUT_OF_RANGE=111;tc.MSG_OUT_OF_ROW_SLOT=112;tc.MSG_OUT_OF_STYLESHEET=113;tc.MSG_OUT_OF_TAB_POS=114;tc.MSG_OUT_OF_TAB_TABLE=115;tc.MSG_OUT_OF_TASK=116;tc.MSG_OUT_OF_WIN_SLOTS=117;tc.MSG_PARASTYLE_IN_USE=118;tc.MSG_PARA_FMT_MISSING=119;tc.MSG_PARA_TBL_INCOMPL=120;tc.MSG_PFRAME_DATA_MISSING=121;tc.MSG_PRINT_AREA_SMALL=122;tc.MSG_PROTECTED=123;tc.MSG_READ_ABORTED=124;tc.MSG_REPLACE_STRING=125;tc.MSG_SAVE_INCOMPL=126;tc.MSG_SAVE_MODS=127;tc.MSG_SECTION_FULL=128;tc.MSG_BAD_WIN_HANDLE=129;tc.MSG_BAD_VERSION=130;tc.MSG_NODEL_MIX_HTML=131;tc.MSG_ERR_TOO_MANY_FILES=132;tc.MSG_ERR_FILE_ACCESS=133;tc.MSG_REDO_EMPTY=134;tc.MSG_OUT_OF_BLT_TABLE=135;tc.MSG_BULLET_MISSING=136;tc.MSG_BAD_JPG_FILE=137;tc.MSG_ERR_JPG_HUFF=138;tc.MSG_ERR_JPG_MARKER=139;tc.MSG_ERR_JPG_NO_HUFF=140;tc.MSG_TAG_TABLE_MISSING=141;tc.MSG_ERR_ENH_META_HDR=142;tc.MSG_GET_ENH_META=143;tc.MSG_MAX_WIN_LINES=144;tc.MSG_SOFT_PAGE_BREAK=145;tc.MSG_SECT_BREAK=146;tc.MSG_PAGE_BREAK=147;tc.MSG_COL_BREAK=148;tc.MSG_PAGE_HDR=149;tc.MSG_PAGE_FTR=150;tc.MSG_ROW_BREAK=151;tc.MSG_DEL_DRAW_OBJ=152;tc.MSG_DEL_FRAME=153;tc.MSG_IRREVERSIBLE_DEL=154;tc.MSG_ERR_PRINT=155;tc.MSG_FIRST_HDR=156;tc.MSG_FIRST_FTR=157;tc.MSG_DEL_FIRST_HDR=158;tc.MSG_DEL_FIRST_FTR=159;tc.MSG_BAD_PNG_DATA=160;tc.MSG_PRINTING_CANCELLED=161;tc.MSG_SMALL_CELL_MARGIN=162;tc.MSG_READ_ONLY=163;tc.MSG_NO_PRINTER=164;tc.MSG_DEL_TOC=165;tc.MSG_NO_RTF_INFO_BLOCK=166;tc.MSG_NO_LIST_BLOCK=167;tc.MSG_NO_LIST_OR_BLOCK=168;tc.MSG_DEL_HDR=169;tc.MSG_DEL_FTR=170;tc.MSG_ERR_JPG_MCU=171;tc.MSG_OUT_OF_IMAGE_MAP_TABLE=172;tc.MSG_COLUMNS=173;tc.MSG_GIF_FILES=174;tc.MSG_ENH_METAFILES=175;tc.MSG_BMP_FILES=176;tc.MSG_METAFILES=177;tc.MSG_JPG_FILES=178;tc.MSG_PNG_FILES=179;tc.MSG_PICTURE_SIZE=180;tc.MSG_SINGLE=181;tc.MSG_15LINES=182;tc.MSG_DBL_LINE=183;tc.MSG_EXACTLY=184;tc.MSG_MULTIPLE=185;tc.MSG_LINES=186;tc.MSG_POINTS=187;tc.MSG_TAB_POS=188;tc.MSG_MARGIN=189;tc.MSG_PNG_ABORT=190;tc.MSG_FATAL_ERROR=191;tc.MSG_FILE_OPEN=192;tc.MSG_ERROR=193;tc.MSG_SPL_CHECKED=194;tc.MSG_BAD_RTF=195;tc.MSG_UNKNOWN=196;tc.MSG_ATLEAST=197;tc.MSG_ICO_FILES=198;tc.MSG_TIF_FILES=199;tc.MSG_INTERNAL_ERROR=200;tc.MSG_SPL_INCORRECT=201;tc.MSG_CANT_SET_PROP=202;tc.MSG_PAGE_BOX=203;tc.MSG_IGNORE_ALL=204;tc.MSG_ADD=205;tc.MSG_SB_INS=206;tc.MSG_SB_OT=207;tc.MSG_SB_PAGE=208;tc.MSG_SB_LINE=209;tc.MSG_SB_ROW=210;tc.MSG_SB_COL=211;tc.MSG_PP_ONE_PAGE=212;tc.MSG_PP_TWO_PAGES=213;tc.MSG_PP_PRINT=214;tc.MSG_PP_EDIT=215;tc.MSG_PP_PG=216;tc.MSG_PP_FITTED=217;tc.MSG_SB_PRINTING_PAGE=218;tc.MSG_PP_CLOSE=219;tc.MSG_NO_HELP=220;tc.MSG_INVOKE_TEXT_LINK=221;tc.MSG_INSERTED_BY=222;tc.MSG_DELETED_BY=223;tc.MSG_NO_CHANGED_TEXT=224;tc.MSG_ACCEPT_CHANGES=225;tc.MSG_CHANGES_COUNT=226;tc.MSG_REJECT_CHANGES=227;tc.MSG_REJECT_COUNT=228;tc.MSG_DATA_TOO_BIG=229;tc.MSG_PAGE_LHDR=230;tc.MSG_PAGE_LFTR=231;tc.MSG_PAGE_RHDR=232;tc.MSG_PAGE_RFTR=233;tc.MSG_XML_READER=234;tc.MSG_FMT_BY=239;tc.MSG_EXPIRED=240;tc.MSG_PARA_FMT_BY=241;tc.MSG_ALL_PICT_FILES=244;tc.MSG_EXIT_WITHOUT_SAVING=245;tc.MSG_INVALID_FILE_SELECTION=246;tc.MSG_SELECT_FILE_TYPES=247;tc.MSG_ALLOW_POPUP=248;tc.MAX_MSGS=250;tc.MAX_TYPES=300;tc.MAX_POINTS=16;tc.MAX_FONTS=320;tc.MAX_GLB_FONTS=500;tc.MAX_GLB_DC=100;tc.MAX_SEGS=100;tc.INITIAL_MAX_LINES=200;tc.MAX_RTF_FONTS=5e3;tc.MAX_RTF_SEQ_FONTS=500;tc.MAX_RTF_GROUPS=1e4;tc.MAX_TABS=600;tc.MAX_SPACES=20;tc.MAX_SECTS=1100;tc.MAX_FRAMES=1500;tc.MAX_PARA_FRAMES=2e3;tc.MAX_FIELDS=100;tc.MAX_WIN_PTRS=200;tc.MAX_TASKS=50;tc.MAX_DRAG_OBJS=850;tc.MAX_SPEED_KEYS=300;tc.MAX_PAGES=1e5;tc.MAX_PREVIEW_PAGES=2;tc.MAX_ZOOMS=8;tc.MAX_RGB=236;tc.MAX_INIT_UNDOS=40;tc.MAX_UNDOS=100;tc.MAX_SS_NAME_WIDTH=63;tc.MAX_SS_IDS=225;tc.MAX_LINE_PTRS=150;tc.MAX_PFMT=2e3;tc.MAX_SELECT_PRINT_LINES=1e3;tc.MAX_PAL_COLORS=100;tc.MAX_BLTS=1500;tc.MAX_JPEG_HUFF_TBLS=8;tc.MAX_JPEG_IN_BUF=3;tc.MAX_CHAR_TAGS=2e3;tc.MAX_ANIM_GIFS=100;tc.MAX_EXPAND=4320;tc.MAX_NUM_TEXT_LEN=13;tc.MAX_FONT_HANDLES=10;tc.MAX_TBL_LEVELS=30;tc.MAX_TBL_COLS=300;tc.MAX_LISTS=1200;tc.MAX_LIST_OR=5e3;tc.MAX_RTF_LS=5e3;tc.MAX_RTF_LS_BIG=500;tc.MAX_TLB_LINES=2;tc.MAX_TLB_PER_LINE=200;tc.MAX_IMAGE_MAPS=50;tc.MAX_PAPERS=11;tc.MAX_DP_GROUPS=10;tc.MAX_CUST_ICONS=200;tc.MAX_REVIEWERS=3;tc.MAX_EXT_FONTS=100;tc.MAX_PICT_TEXT=10;tc.MAX_RETURN_PARAMS=20;tc.MAX_STR_RETURN_PARAMS=2;tc.MIN_AUTO_CELL_WIDTH=60;tc.MAX_SECT_COLS=20;tc.MAX_TEXT_COMPRESSION_PCT=5;tc.MODE_DRAW=1;tc.MODE_FILL=2;tc.MODE_DRAW_FILL=3;tc.SGM_REL_RIGHT=1;tc.SGM_REL_BOT=2;tc.SGM_GROUP_RIGHT=4;tc.SGM_GROUP_BOT=8;tc.SM_REL_RIGHT=1;tc.SM_REL_BOT=2;tc.SM_GEO_RIGHT=4;tc.SM_GEO_BOT=8;tc.SM_FILLED=16;tc.SM_FLINE=32;tc.XMFLAG_IN_TEXT=1;tc.XMGFLAG_IN_RUN=1;tc.XMGFLAG_IN_PARA=2;tc.XMGFLAG_IN_RUN_PROP=4;tc.XMGFLAG_IN_PARA_PROP=8;tc.XMGFLAG_IN_FONTS=16;tc.XMGFLAG_IN_FONT=32;tc.XMGFLAG_IN_PARA_BORDER=64;tc.XMGFLAG_IN_PARA_TAB=128;tc.XMGFLAG_USE_PARA_FONT=256;tc.XMGFLAG_IN_STYLESHEET=512;tc.XMGFLAG_IN_STYLEITEM=1024;tc.XMGFLAG_SKIP_GROUP=2048;tc.XMGFLAG_IN_FIELD_INST=4096;tc.XMGFLAG_IN_LISTS=8192;tc.XMGFLAG_IN_LIST_DEF=16384;tc.XMGFLAG_IN_LIST_OR=32768;tc.XMGFLAG_IN_LIST_LEVEL=65536;tc.XMGFLAG_IN_LIST_OR_LEVEL=131072;tc.XMGFLAG_PARA_FONT_SET=262144;tc.XMGFLAG_IN_PICT=524288;tc.XMGFLAG_IN_PICT_DATA=1048576;tc.XMGFLAG_IN_BODY=2097152;tc.XMGFLAG_IN_SECT_PROP=4194304;tc.XMGFLAG_IS_SECT_BREAK=8388608;tc.XMGFLAG_IN_HDR_FTR=16777216;tc.XMGFLAG_IN_DRAWING=33554432;tc.XMGFLAG_IN_POSH=134217728;tc.XMGFLAG_IN_POSV=268435456;tc.XMGFLAG_IN_POS_OFF=536870912;tc.XMGFLAG_IN_TEXT_BOX=1073741824;tc.XMGFLAG2_IN_OBJECT=1;tc.XMGFLAG2_IN_PAGE_BORDER=2;tc.XMGFLAG2_IN_FONT_SCHEME=4;tc.XMGFLAG2_IN_MAJOR_FONT=8;tc.XMGFLAG2_IN_MINOR_FONT=16;tc.XMGFLAG2_IN_CELL_TEXT=32;tc.XMGFLAG2_IN_CELL=64;tc.XMGFLAG2_IN_ROW=128;tc.XMGFLAG2_IN_TABLE=256;tc.XMGFLAG2_IN_TABLE_PROP=512;tc.XMGFLAG2_IN_ROW_PROP=1024;tc.XMGFLAG2_IN_MARGIN=2048;tc.XMGFLAG2_IN_TABLE_GRID=4096;tc.XMGFLAG2_IN_CELL_PROP=8192;tc.XMGFLAG2_IN_BORDER=16384;tc.XMGFLAG2_IN_TABLE_STYLE=32768;tc.XMGFLAG2_IN_ENDNOTE_PROP=65536;tc.XMGFLAG2_IN_FORM_DATA=131072;tc.XMGFLAG2_IN_GROUP=262144;tc.XMGFLAG2_IN_SDT=524288;tc.XMGFLAG2_SDT_TEXT_FOUND=1048576;tc.XMGFLAG2_IN_SDTPR=2097152;tc.XMGFLAG2_SDT_FONT_SET=4194304;tc.XMGFLAG2_IN_POSITIONED_TABLE=8388608;tc.XMGFLAG2_PICT_IN_TEXT_BOX=16777216;tc.XMGFLAG2_IN_COMMENT=33554432;tc.XMGFLAG2_IN_CLR_FROM=67108864;tc.XMGFLAG2_IN_CLR_TO=134217728;tc.XMGFLAG2_SDT_CONTROL_FOUND=268435456;tc.XMLERROR_SIMPLE=1;tc.XMLERROR_FATAL=2;tc.XMLERROR_WARNING=3;tc.XMFILE_DOC=1;tc.XMFILE_FONT=2;tc.XMFILE_STYLE=3;tc.XMFILE_CORE=4;tc.XMFILE_DOC_RELS=5;tc.XMFILE_DOC_ACTIVEX=6;tc.XMFILE_SETTINGS=7;tc.XMFILE_THEME=8;tc.XMFILE_LIST=9;tc.XMFILE_FNOTE=10;tc.XMFILE_COMMENTS=11;tc.ZIP_STORED=0;tc.ZIP_SHRUNK=1;tc.ZIP_DEFLATE=8;tc.CNF_FIRST_ROW=1;tc.CNF_LAST_ROW=2;tc.CNF_FIRST_COL=3;tc.CNF_LAST_COL=4;tc.CNF_ODD_COL=5;tc.CNF_EVEN_COL=6;tc.CNF_ODD_ROW=7;tc.CNF_EVEN_ROW=8;tc.CNF_NE_CELL=9;tc.CNF_NW_CELL=10;tc.CNF_SE_CELL=11;tc.CNF_SW_CELL=12;tc.CNFTYPE_CHAR=1;tc.CNFTYPE_PARA=2;tc.CNFTYPE_CELL=4;tc.CNFTYPE_ROW=8;tc.CMASK_FONT_LATIN=1;tc.CMASK_SIZE=2;tc.CMASK_EXPAND=4;tc.CMASK_TEXT_COLOR=8;tc.CMASK_TEXT_BK_COLOR=16;tc.CMASK_OFFSET=32;tc.CMASK_AUX=64;tc.CMASK_ULINE_COLOR=128;tc.CMASK_FLOW=256;tc.CMASK_SCALE_X=512;tc.CMASK_FONT_DB=1024;tc.CMASK_FONT_RTL=2048;tc.CMASK_FONT_HI=4096;tc.CMASK_LANG=8192;tc.CMASK_HILIGHT_COLOR=16384;tc.CMASK_FONT_DEFAULT=32768;tc.CMASK_FONT=tc.CMASK_FONT_LATIN|tc.CMASK_FONT_DB|tc.CMASK_FONT_RTL|tc.CMASK_FONT_HI;tc.CMASK_STYLE=-1;tc.CMASK_TEMP_STYLE=-2;tc.CMASK_FONT_ETC=-3;tc.CMASK_CHAR_STYLE=-5;tc.CMASK_FIELD=-6;tc.CMASK_STORY=-7;tc.CMASK_PROPS=-8;tc.CMASK_SIZE_PERCENT=-9;tc.PMASK_LS=1;tc.PMASK_LVL=2;tc.PMASK_OLVL=4;tc.PMASK_ALIGN=8;tc.PMASK_KEEP=16;tc.PMASK_KEEP_NEXT=32;tc.PMASK_WIDOW=64;tc.PMASK_PAGE_BREAK=128;tc.PMASK_BORDER=256;tc.PMASK_SHADING=512;tc.PMASK_BK_COLOR=1024;tc.PMASK_TAB=2048;tc.PMASK_SPACING=4096;tc.PMASK_INDENT_LEFT=8192;tc.PMASK_BULLET=16384;tc.PMASK_BORDER_COLOR=32768;tc.PMASK_FLOW=65536;tc.PMASK_CONTEXTUAL_SPACE=131072;tc.PMASK_INDENT_RIGHT=262144;tc.PMASK_INDENT_FIRST=524288;tc.PMASK_FRAME=1048576;tc.PMASK_SPACING_BEF=2097152;tc.PMASK_SPACING_AFT=4194304;tc.PMASK_SPACING_BET=8388608;tc.PMASK_SPACING_LINE=16777216;tc.PMASK_NO_SNAP_TO_GRID=33554432;tc.PMASK_TEXT_VALIGN=67108864;tc.PMASK_INDENT_LEFT_NOLIST=134217728;tc.PMASK_INDENT_FIRST_NOLIST=268435456;tc.PMASK_INDENT=tc.PMASK_INDENT_LEFT|tc.PMASK_INDENT_RIGHT|tc.PMASK_INDENT_FIRST;tc.PMASK2_BORDER_LEFT=1;tc.PMASK2_BORDER_RIGHT=2;tc.PMASK2_BORDER_TOP=4;tc.PMASK2_BORDER_BOT=8;tc.PMASK2_BORDER_BET=16;tc.CLMASK_WIDTH=1;tc.CLMASK_ROW_SPAN=2;tc.CLMASK_COL_SPAN=4;tc.CLMASK_BORDERS=8;tc.CLMASK_SHADING=16;tc.CLMASK_FILL=32;tc.CLMASK_TEXT_ANGLE=64;tc.CLMASK_ROW_SPANNED=128;tc.CLMASK_MERGED=256;tc.CLMASK_MARGINS=512;tc.ROMASK_WIDTH=1;tc.ROMASK_MARGIN=2;tc.ROMASK_LAYOUT=4;tc.ROMASK_JUST=8;tc.ROMASK_INDENT=16;tc.ROMASK_BORDER=32;tc.ROMASK_HDR=64;tc.ROMASK_KEEP=128;tc.ROMASK_RTL=256;tc.ROMASK_HEIGHT=512;tc.ROMASK_INDENT_TBL_EXP_PROP=1024;tc.DSEG_LINE_TO=0;tc.DSEG_BEZ_TO=8192;tc.DSEG_MOVE_TO=16384;tc.DSEG_CLOSE=24576;tc.DSEG_END=32768;tc.FILE_OPEN_IN_IE=99999;tc.AUTO_SPACE=270;tc.TRACK_NONE=0;tc.TRACK_INS=1;tc.TRACK_DEL=2;tc.TRACK_NO_DEL=3;tc.TRACK_FMT=4;tc.TRACK_NO_FMT=5;tc.SECT_LINE_DIST=360;tc.MIN_VTEXT_CELL_HEIGHT=720;tc.PICT_DIBITMAP=0;tc.PICT_IMAGE=0;tc.PICT_METAFILE=1;tc.PICT_CONTROL=2;tc.PICT_META7=3;tc.PICT_BITMAP=4;tc.PICT_JPEG=5;tc.PICT_FORM=6;tc.PICT_GIF=7;tc.PICT_TIFF=8;tc.PICT_ENHMETAFILE=9;tc.PICT_PNG=10;tc.PICT_SHAPE=11;tc.PICT_TIF=12;tc.UNDO_LAST_LINE_FIRST_COL=1;tc.UNDO_TEXT_TO_TABLE=2;tc.UNDO_DEL_PARA_BEF_TABLE=4;tc.UNDO_DEL_ALL=8;tc.UNDO_SHOW_HDR_FTR=16;tc.UNDO_LINE_LIMIT=5e3;tc.PDF_RES_X=1440;tc.PDF_RES_Y=1440;tc.PDFLINK_EXT=0;tc.PDFLINK_INT=1;tc.PDFLINK_DEST=2;tc.IDC_INSERT=0;tc.IDC_DELETE=1;tc.IDC_GOTO=2;tc.IDC_RANGE_ALL=773;tc.IDC_RANGE_SELECTED=774;tc.IDC_RANGE_PAGES=955;tc.IDC_PAGE_REF=956;tc.SCROLL_LINE_DELTA=1;tc.SCROLL_PAGE_DELTA=2;tc.PPARAM_LEFT_INDENT=0;tc.PPARAM_RIGHT_INDENT=1;tc.PPARAM_FIRST_INDENT=2;tc.PPARAM_TAB=3;tc.PPARAM_BLT=4;tc.PPARAM_AUX=5;tc.PPARAM_AUX1=6;tc.PPARAM_STY=7;tc.PPARAM_SHADING=8;tc.PPARAM_PFLAGS=9;tc.PPARAM_SPACE_BEF=10;tc.PPARAM_SPACE_AFT=11;tc.PPARAM_SPACE_BET=12;tc.PPARAM_LINE_SPACING=13;tc.PPARAM_BK_COLOR=14;tc.PPARAM_BORDER_SPACE=15;tc.PPARAM_FLOW=16;tc.PPARAM_FLAGS=17;tc.ENGLISH=1033;tc.TER_LEFT=0;tc.TER_CENTER=1;tc.TER_RIGHT=2;tc.CWIDTH_WIDTH=1073741823;tc.CWIDTH_USED=1073741824;tc.CWIDTH_RTL=2147483648;tc.CWIDTH_FACTOR=1e5;tc.WMTER_MOUSEWHEEL=522;tc.WMTER_MOUSEHOVER=673;tc.SMTER_MOUSEWHEELPRESENT=75;tc.WHEEL_RADIUS=14;tc.TLBFLAG_MOUSE=1;tc.TLBFLAG_ENABLED=2;tc.TLBFLAG_CHECKED=4;tc.TLBFLAG_HILIGHTED=8;tc.TLBFLAG_COMBO=16;tc.TLBFLAG_EDITABLE=32;tc.TLBFLAG_DROPDOWN=64;tc.TEXTFLOW_T2B=1;tc.TEXTFLOW_T2B_NON_ANSII=3;tc.TEXTFLOW_B2T=2;tc.PNGCMP_NONE=0;tc.PNGCMP_FIXED=1;tc.PNGCMP_DYNAMIC=2;tc.PNGCMP_ERROR=3;tc.PNGCLR_GRAY=0;tc.PNGCLR_TRUE=2;tc.PNGCLR_PAL=3;tc.PNGCLR_GRAY_ALPHA=4;tc.PNGCLR_TRUE_ALPHA=6;tc.PNG_CIRC_BUF_LO=500;tc.PNG_CIRC_BUF_HI=1e3;tc.PNG_MAX_RUN_LEN=258;tc.CHAR_WIDTH_CACHE_SIZE=131072;tc.OASPECT_NONE=0;tc.OASPECT_CONTENT=1;tc.OASPECT_ICON=2;tc.PARA_BLOCKQUOTE=1;tc.PARA_ADDRESS=2;tc.PARA_HR=3;tc.PARA_PRE=4;tc.PASS_HDR=1;tc.PASS_TBL_HDR=2;tc.PASS_BODY=3;tc.PASS_FTR=4;tc.MAX_PASSES=4;tc.PASS_PICT_TEXT=4;tc.PSPACE_SINGLE=0;tc.PSPACE_15=1;tc.PSPACE_20=2;tc.PSPACE_ATLEAST=3;tc.PSPACE_EXACTLY=4;tc.PSPACE_MULTIPLE=5;tc.HTML_MISC_FLAG_MASK=3584;tc.SSFLAG_ADD=1;tc.SSFLAG_ADDED=2;tc.SSFLAG_BASED=4;tc.SSFLAG_NO_SPACE=8;tc.SSFLAG_DONE=16;tc.SSFLAG_NUM=32;tc.PFLAG_STYLES=65520;tc.SMALL_FILE=5e3;tc.TSTYLE_IME=1;tc.TSTYLE_ULINEF=2;tc.PI=Math.PI;tc.FITTED_VIEW_DISP_PAGES=20;tc.TOFLAG_DEL_CELL=1;tc.TOFLAG_CURS_ON_TABLE_TOP=2;tc.TOFLAG_INSERT_CHAR=4;tc.TOFLAG_IN_MERGE_PRINT=8;tc.TOFLAG_IME_DISABLE=16;tc.TOFLAG_WRITING_BKND=32;tc.TOFLAG_NO_RESET_FONT=64;tc.TOFLAG_FULL_PAINT=128;tc.TOFLAG_WRAPPING=256;tc.TOFLAG_DRAWING_FRAME_PICT=512;tc.TOFLAG_FNOTE_FRAME=1024;tc.TOFLAG_PAINT_WAITING=2048;tc.TOFLAG_DEBUG=4096;tc.TOFLAG_HILIGHT_OFF=8192;tc.TOFLAG_NO_TOL=16384;tc.TOFLAG_NO_FIELD_ADJ=32768;tc.TOFLAG_NO_ADJUST_POS=65536;tc.TOFLAG_MERGE_PRINT_RECT=131072;tc.TOFLAG_SET_FOCUS=262144;tc.TOFLAG_X_BEYOND_LINE=524288;tc.TOFLAG_BREAK_CHAR=1048576;tc.TOFLAG_REPAINT_MSG=2097152;tc.TOFLAG_SET_MOUSE_ON_TEXT_LINE=4194304;tc.TOFLAG_SEL_CELL_CONTENT=8388608;tc.TOFLAG_NO_RECOVE_ID=16777216;tc.TOFLAG_CONTINUOUS_SCROLL=33554432;tc.TOFLAG_NO_MORE_TAB_MSG=67108864;tc.TOFLAG_X_BEFORE_LINE=134217728;tc.TOFLAG_EXT_SPELLER=268435456;tc.TOFLAG_CLEAR_EOL=536870912;tc.TOFLAG_UPDATE_ENOTE=1073741824;tc.TOFLAG2_NO_WRAP=1;tc.TOFLAG2_NO_NORMALIZE_FNOTE=2;tc.TOFLAG2_REPOS_PICT_FRAMES=4;tc.TOFLAG2_DRAW_FNOTE=8;tc.TOFLAG2_SSE_READ=16;tc.TOFLAG2_USE_PEN_FOR_BORDER=32;tc.TOFLAG2_FROM_CB=64;tc.TOFLAG2_PDF=128;tc.TOFLAG2_NO_COMPRESS_CFMT=256;tc.TOFLAG2_CHECK_DISABLED_FRAMES=512;tc.TOFLAG2_NO_SET_LANG=1024;tc.TOFLAG2_DEL_CELL_TEXT=2048;tc.TOFLAG2_NO_NORMALIZE=4096;tc.TOFLAG2_NO_SAVE_UNDO=8192;tc.TOFLAG2_PRINTING_TO_EMF=16384;tc.TOFLAG2_USE_UNDO_FRAME=65536;tc.TOFLAG2_FULL_REPAGE=131072;tc.TOFLAG2_TEXT_TO_TABLE=262144;tc.TOFLAG2_FRAME_REFRESH=524288;tc.TOFLAG2_IN_SET_CHARSET=1048576;tc.TOFLAG2_SET_TRACK_FONT=2097152;tc.TOFLAG2_ABS_POS_BEYOND=4194304;tc.TOFLAG2_NO_TEXT_CLIP=8388608;tc.TOFLAG2_USE_FRAME_POS=16777216;tc.TOFLAG2_DONT_ULINE_TRAIL_SPC=33554432;tc.TOFLAG2_DONT_CALC_CHAR_WIDTH=67108864;tc.TOFLAG2_DONT_DELETE_LAST_CHAR=134217728;tc.TOFLAG2_ADJUST_FONT_BEF_DRAW=268435456;tc.TOFLAG2_TABLE_EMBEDDED=536870912;tc.TOFLAG2_TRACK_DELETION=1073741824;tc.TOFLAG3_TEXT_BKND_ONLY=1;tc.TOFLAG3_NO_TEXT_BKND=2;tc.TOFLAG3_NO_CRLF_FLAG=8;tc.TOFLAG3_FORCE_CHAR_STYLES=16;tc.TOFLAG3_IN_DATA_FIELD=32;tc.TOFLAG3_SET_COL_SPAN=64;tc.TOFLAG3_REPAGINATE=128;tc.TOFLAG3_USE_PREV_PFMT=256;tc.TOFLAG3_IN_VIRT_INPUT=512;tc.TOFLAG3_DONT_UPDATE_PARA_FONT=1024;tc.WRAPSIDE_BOTH=0;tc.WRAPSIDE_LEFT=1;tc.WRAPSIDE_RIGHT=2;tc.WRAPSIDE_LARGEST=3;tc.PAGE_BOX_WIDTH=1100;tc.NUM_WIDTH_CHARS=256;tc.BORDER_MARGIN=75;tc.PARA_BORDER_MARGIN=50;tc.FNOTE_MARGIN=50;tc.PAGE_BORDER_MARGIN=360;tc.ID_FIRST_COMMAND=600;tc.MIN_CELL_WIDTH=180;tc.DEF_LINE_WIDTH=15;tc.SIGN_EOF16=188;tc.SIGN_EOF32=186;tc.DIB_TO_METAFILE=true;tc.IDC_TABLE_SEL_COLS=887;tc.IDC_TABLE_SEL_ROWS=888;tc.IDC_TABLE_SEL_CELLS=889;tc.IDC_TABLE_CUR_ROW=890;tc.IDC_TABLE_ALL_ROWS=891;tc.IDC_TABLE_ALL=942;tc.IDC_TABLE_SEL_COLS2=943;tc.IDC_TABLE_SEL_COLS_DEL=1055;tc.VKIND_NONE=0;tc.VKIND_PAGE_LAYOUT=1;tc.VKIND_OUTLINE=2;tc.VKIND_MASTER=3;tc.VKIND_NORMAL=4;tc.VKIND_OUTLINE_LAYOUT=5;tc.FTYPE_NONE=0;tc.FTYPE_DIB=1;tc.FTYPE_METAFILE=2;tc.FTYPE_JPEG=3;tc.FTYPE_GIF=4;tc.FTYPE_ENHMETAFILE=5;tc.FTYPE_PNG=6;tc.FTYPE_OTHER=7;tc.OBJ_NONE=0;tc.OBJ_EMBED=1;tc.OBJ_LINK=2;tc.OBJ_EMBED_TEMP=3;tc.OBJ_EMBED_INSERT=4;tc.OBJ_OCX=5;tc.OBJ_OCX_EXT=6;tc.DEFAULT_CFMT=0;tc.BOLD_WEIGHT=700;tc.NORM_WEIGHT=400;tc.UNIFORM=65535;tc.EACH_INDENT=720;tc.MAX_INDENT=8640;tc.MAX_PARA_PER_WIN=30;tc.MAX_PARA_PER_PAGE=100;tc.REDUCTION=2;tc.MIN_FRAME_MARGIN=40;tc.FRAME_BORDER_WIDTH=15;tc.BOX_BORDER_WIDTH=40;tc.PAINT_MIN=1;tc.PAINT_LINE=2;tc.PAINT_RANGE=3;tc.PAINT_WIN=4;tc.PAINT_PARTIAL_WIN=5;tc.PAINT_WIN_RESET=6;tc.PAINT_DIRECT=1;tc.PAINT_MEM=2;tc.SCROLL_RANGE=1e4;tc.STATUS_ROW=-1;tc.RTF_BUF_LEN=4096;tc.RTF_LINE_LEN=80;tc.RTF_BEGIN=1;tc.RTF_END=2;tc.RTF_CONTROL=3;tc.RTF_TEXT=4;tc.RTF_PROPERTY=5;tc.RTF_PICT=6;tc.RTF_SECT=7;tc.RTF_OBJECT=8;tc.RTF_FILE_INCOMPLETE=1;tc.RTF_SYNTAX_ERROR=2;tc.RTF_END_FILE=3;tc.RTF_FILE=0;tc.RTF_BUF=1;tc.RTF_CB=2;tc.RTF_CB_BUF=3;tc.RTF_FRAME_BUF=4;tc.RTF_CB_APPEND=5;tc.PARAM_NONE=0;tc.PARAM_INT=1;tc.PARAM_DBL=2;tc.TAB=9;tc.ESCAPE=27;tc.ENTER=13;tc.QUOTE=34;tc.CHAR_QUOTE=34;tc.SQUOTE=39;tc.SPACE=32;tc.CHAR_SPACE=32;tc.COMMA=",".charCodeAt(0);tc.COLON=":".charCodeAt(0);tc.SEMI_COLON=";".charCodeAt(0);tc.PERIOD=".".charCodeAt(0);tc.HYPH="-".charCodeAt(0);tc.UNDERSCORE="_".charCodeAt(0);tc.LEFT_BRACE="{".charCodeAt(0);tc.RIGHT_BRACE="}".charCodeAt(0);tc.LEFT_PAREN="(".charCodeAt(0);tc.RIGHT_PAREN=")".charCodeAt(0);tc.LEFT_BRACKET="[".charCodeAt(0);tc.RIGHT_BRACKET="]".charCodeAt(0);tc.BACK_SLASH="\\".charCodeAt(0);tc.SLASH="/".charCodeAt(0);tc.CHAR_0="0".charCodeAt(0);tc.CHAR_1="1".charCodeAt(0);tc.CHAR_9="9".charCodeAt(0);tc.CHAR_A="A".charCodeAt(0);tc.CHAR_a="a".charCodeAt(0);tc.CHAR_B="B".charCodeAt(0);tc.CHAR_b="b".charCodeAt(0);tc.CHAR_C="C".charCodeAt(0);tc.CHAR_c="c".charCodeAt(0);tc.CHAR_D="D".charCodeAt(0);tc.CHAR_d="d".charCodeAt(0);tc.CHAR_E="E".charCodeAt(0);tc.CHAR_e="e".charCodeAt(0);tc.CHAR_F="F".charCodeAt(0);tc.CHAR_f="f".charCodeAt(0);tc.CHAR_G="G".charCodeAt(0);tc.CHAR_g="g".charCodeAt(0);tc.CHAR_H="H".charCodeAt(0);tc.CHAR_h="h".charCodeAt(0);tc.CHAR_I="I".charCodeAt(0);tc.CHAR_i="i".charCodeAt(0);tc.CHAR_J="J".charCodeAt(0);tc.CHAR_j="j".charCodeAt(0);tc.CHAR_K="K".charCodeAt(0);tc.CHAR_k="k".charCodeAt(0);tc.CHAR_L="L".charCodeAt(0);tc.CHAR_l="l".charCodeAt(0);tc.CHAR_M="M".charCodeAt(0);tc.CHAR_m="m".charCodeAt(0);tc.CHAR_N="N".charCodeAt(0);tc.CHAR_n="n".charCodeAt(0);tc.CHAR_O="O".charCodeAt(0);tc.CHAR_o="o".charCodeAt(0);tc.CHAR_P="P".charCodeAt(0);tc.CHAR_p="p".charCodeAt(0);tc.CHAR_Q="Q".charCodeAt(0);tc.CHAR_q="q".charCodeAt(0);tc.CHAR_R="R".charCodeAt(0);tc.CHAR_r="r".charCodeAt(0);tc.CHAR_S="S".charCodeAt(0);tc.CHAR_s="s".charCodeAt(0);tc.CHAR_T="T".charCodeAt(0);tc.CHAR_t="t".charCodeAt(0);tc.CHAR_U="U".charCodeAt(0);tc.CHAR_u="u".charCodeAt(0);tc.CHAR_V="V".charCodeAt(0);tc.CHAR_v="v".charCodeAt(0);tc.CHAR_W="W".charCodeAt(0);tc.CHAR_w="w".charCodeAt(0);tc.CHAR_X="X".charCodeAt(0);tc.CHAR_x="x".charCodeAt(0);tc.CHAR_Y="Y".charCodeAt(0);tc.CHAR_y="y".charCodeAt(0);tc.CHAR_Z="Z".charCodeAt(0);tc.CHAR_z="z".charCodeAt(0);tc.RULER_TOLERANCE=60;tc.DEF_TAB_WIDTH=720;tc.DISP_PARA_CHAR=182;tc.DISP_CELL_CHAR=164;tc.DISP_LINE_CHAR=171;tc.DISP_HYPH_CHAR=172;tc.DISP_HIDDEN_CHAR=149;tc.DISP_PARA_CHAR_ALT=191;tc.DISP_LINE_CHAR_ALT=175;tc.BULLET_CHAR=183;tc.BFONT_DEF=0;tc.BFONT_SYMBOL=1;tc.BFONT_WINGDINGS=2;tc.MIN_LINES_PER_PAGE=20;tc.TIMER_REPAGE=9182;tc.TIMER_HILIGHT=9183;tc.TIMER_EVAL=9184;tc.TIMER_TLB_HILIGHT=9185;tc.TIMER_TLB_BALLOON=9186;tc.TIMER_TLB_BALLOON_OFF=9187;tc.TIMER_WHEEL_UP=9188;tc.TIMER_WHEEL_DOWN=9189;tc.TIMER_MOUSE_STOP=9190;tc.TIMER_ANIM=9199;tc.BORDER_TOP=1;tc.BORDER_BOT=2;tc.BORDER_LEFT=4;tc.BORDER_RIGHT=8;tc.BORDER_VINSIDE=16;tc.BORDER_HINSIDE=32;tc.BORDER_ALL=15;tc.PAD_TOP=1;tc.PAD_BOT=2;tc.PAD_LEFT=4;tc.PAD_RIGHT=8;tc.BORDER_INDEX_TOP=0;tc.BORDER_INDEX_BOT=1;tc.BORDER_INDEX_LEFT=2;tc.BORDER_INDEX_RIGHT=3;tc.BORDER_INDEX_VINSIDE=4;tc.BORDER_INDEX_HINSIDE=5;tc.BORDER_PARA_TOP=0;tc.BORDER_PARA_BOT=1;tc.BORDER_PARA_LEFT=2;tc.BORDER_PARA_RIGHT=3;tc.BORDER_CELL_TOP=4;tc.BORDER_CELL_BOT=5;tc.BORDER_CELL_LEFT=6;tc.BORDER_CELL_RIGHT=7;tc.BORDER_ROW_TOP=8;tc.BORDER_ROW_BOT=9;tc.BORDER_ROW_LEFT=10;tc.BORDER_ROW_RIGHT=11;tc.BORDER_PARA_ALL=12;tc.BORDER_CHAR=13;tc.BORDER_SECT_TOP=14;tc.BORDER_SECT_BOT=15;tc.BORDER_SECT_LEFT=16;tc.BORDER_SECT_RIGHT=17;tc.BORDER_PARA_BETWEEN=18;tc.BORDER_DIAG_UL2LR=19;tc.BORDER_DIAG_UR2LL=20;tc.MAX_BORDERS=21;tc.BOX_TOP=16;tc.BOX_BOT=32;tc.BOX_LEFT=64;tc.BOX_RIGHT=128;tc.BOX_DOUBLE=256;tc.BOX_THICK=512;tc.BOX_BETWEEN=65536;tc.PROTECT_COLOR=new tc.Color(79,79,79);tc.BM_UNCHECKED=0;tc.BM_CHECKED=1;tc.BM_NONE=2;tc.MAX_DATA_LEN=100;tc.MAX_PASTE_FORMATS=6;tc.PASTE_OBJECT=0;tc.PASTE_RTF=1;tc.PASTE_TEXT=2;tc.PASTE_PICT=3;tc.PASTE_BM=4;tc.PASTE_DIB=5;tc.PASTE_DESC_OBJECT="Object";tc.PASTE_DESC_RTF="Formatted Text (RTF)";tc.PASTE_DESC_TEXT="Unformatted Text";tc.PASTE_DESC_PICT="Picture";tc.PASTE_DESC_BM="Bitmap";tc.PASTE_DESC_DIB="Device Independent Bitmap";tc.OLENOT_CHANGED=1;tc.OLENOT_SAVED=2;tc.OLENOT_CLOSED=4;tc.MSDRAW_CLASS="MSDraw";tc.FRAME_DIST_FROM_TEXT=180;tc.FRAME_DIST_FROM_MARGIN=1440;tc.DRAG_TYPE_SCR_FIRST=1;tc.DRAG_TYPE_PICT_SIZE=1;tc.DRAG_TYPE_FRAME_SIZE=2;tc.DRAG_TYPE_FRAME_MOVE=3;tc.DRAG_TYPE_SCR_LAST=3;tc.DRAG_TYPE_RULER_BEGIN=5;tc.DRAG_TYPE_RULER_LEFT=5;tc.DRAG_TYPE_RULER_RIGHT=6;tc.DRAG_TYPE_RULER_FIRST=7;tc.DRAG_TYPE_RULER_TAB=8;tc.DRAG_TYPE_TAB_TYPE=9;tc.DRAG_TYPE_RULER_END=9;tc.DRAG_TYPE_CELL=10;tc.DRAG_TYPE_ROW_INDENT=11;tc.DRAG_TYPE_ROW=12;tc.DRAG_TYPE_CTL_SIZE=13;tc.DRAG_TYPE_TEXT_HANDLE=14;tc.DRAG_HOT_LEFT=0;tc.DRAG_HOT_RIGHT=1;tc.DRAG_HOT_TOP=2;tc.DRAG_HOT_BOT=3;tc.DRAG_HOT_CORNER_START=4;tc.DRAG_HOT_TL=4;tc.DRAG_HOT_TR=5;tc.DRAG_HOT_BL=6;tc.DRAG_HOT_BR=7;tc.DRAG_HOT_CORNER_END=7;tc.DRAG_TAB_WIDTH=100;tc.FMFLAG_ACTIVE=1;tc.FMFLAG_SSFLDW_FOUND=2;tc.RFLAG_CELL_MERGED=1;tc.RFLAG_END_TABLE=2;tc.RFLAG_CURS_IN_TABLE=4;tc.RFLAG_OUT_OF_TABLE_ROW=8;tc.RFLAG_OUT_OF_TABLE_CELL=16;tc.RFLAG_HDRFTR_TEXT_FOUND=32;tc.RFLAG_NEW_FRAME=64;tc.RFLAG_HDR_FTR_FOUND=128;tc.RFLAG_SECT_HDR_FOUND=1024;tc.RFLAG_SECT_FTR_FOUND=2048;tc.RFLAG_PARA_FRAME_FOUND=4096;tc.RFLAG_IGNORE_SLASH=8192;tc.RFLAG_READ_SHAPE_PICT=16384;tc.RFLAG_INSERT_BEF_PARA=32768;tc.RFLAG1_TROWD_FOUND=1;tc.RFLAG1_TEXT_FOUND=2;tc.RFLAG1_PNG_FOUND=4;tc.RFLAG1_SECT_FHDR_FOUND=8;tc.RFLAG1_SECT_FFTR_FOUND=16;tc.RFLAG1_PARA_ENDED=32;tc.RFLAG1_FIRST_TABLE=64;tc.RFLAG1_SSSUBTABLE_USED=128;tc.RFLAG1_ROW_SPANNED=4096;tc.RFLAG1_IGNORE_SPACE=8192;tc.RFLAG1_PASTING_IN_PARA_FRAME=16384;tc.RFLAG1_NEW_HDR_FTR=32768;tc.RFLAG1_SECT_FACING_PAGES=65536;tc.RFLAG1_SECT_RHDR_FOUND=131072;tc.RFLAG1_SECT_RFTR_FOUND=262144;tc.RFLAG1_SECT_LHDR_FOUND=524288;tc.RFLAG1_SECT_LFTR_FOUND=1048576;tc.RFLAG2_LEFT_MARG_FOUND=1;tc.RFLAG2_CHFTN_FOUND=2;tc.RFLAG2_PAPER_DIM_FOUND=4;tc.RFLAG2_PICT_FRAME_INSERTED=8;tc.RFLAG2_UNDO_IN_EMPTY_FILE=16;tc.RFLAG2_WRITING_CHFTN=32;tc.RFLAG2_HAS_FNOTE=64;tc.RFLAG2_NEW_FRAME_CREATED=128;tc.RFLAG2_INSERT_BEF_TABLE=256;tc.RFLAG2_RESTART_FNOTE_ON_SECT_BREAK=512;tc.RFLAG2_FIELD_HAS_TEXT=1024;tc.RFLAG2_CAN_EXPAND_GROUP_TABLE=2048;tc.RFLAG2_NO_VAL=4096;tc.ROFLAG_IGNORE_SLASH=2;tc.ROFLAG_WRITE_TROWD=16;tc.ROFLAG_NO_FLUSH=32;tc.ROFLAG_IN_ANIM=64;tc.ROFLAG_NO_ANIM=128;tc.ROFLAG_HIDDEN_TEXT=256;tc.ROFLAG_IN_FIELD_NAME=512;tc.ROFLAG_CELL_CLOSED=1024;tc.ROFLAG_NO_CRLF=2048;tc.ROFLAG_IN_FIELD_TC=4096;tc.ROFLAG_IN_FIELD_XE=8192;tc.ROFLAG_IN_MERGE_FIELD=16384;tc.ROFLAG_WRITE_FONT=32768;tc.ROFLAG_IN_STYLESHEET=65536;tc.ROFLAG_ORIG_PICT_WRITTEN=131072;tc.ROFLAG_IS_FNOTEAUTO=262144;tc.ROFLAG_IN_HIDDEN_GROUP=1048576;tc.ROFLAG_WRITE_PARA_PROPS=2097152;tc.ROGFLAG_WRITE_FONT=1;tc.FRAME_RIGHTMOST=1;tc.FRAME_DIVIDER_LINE=2;tc.FRAME_ON_SCREEN=4;tc.FRAME_NON_TEXT_DO=8;tc.FRAME_TRANSPARENT=16;tc.FRAME_BORDER_LEFT=32;tc.FRAME_BORDER_RIGHT=64;tc.FRAME_BORDER_TOP=128;tc.FRAME_BORDER_BOT=256;tc.FRAME_LAST_COL=512;tc.FRAME_FORCE_BKND_CLR=1024;tc.FRAME_PICT=2048;tc.FRAME_DISABLED=4096;tc.FRAME_FNOTE=8192;tc.FRAME_GRAY=16384;tc.FRAME_TOP_SPAN=32768;tc.FRAME_PAGE_BOX=65536;tc.FRAME_RTL=131072;tc.FRAME_RTL_CHECKED=262144;tc.FRAME_FIRST_ROW_FRAME=524288;tc.FRAME_LAST_ROW_FRAME=1048576;tc.FRAME_WATERMARK=2097152;tc.FRAME_LINE_BET_COL=4194304;tc.FRAME_LAST_FRAME_OF_BOX_FRAME=8388608;tc.FRAME_BORDER=tc.FRAME_BORDER_LEFT|tc.FRAME_BORDER_RIGHT|tc.FRAME_BORDER_TOP|tc.FRAME_BORDER_BOT;tc.FRAME1_PART_EMPTY_CELL=1;tc.FRAME1_PARA_FRAME_BOX=2;tc.FRAME1_RECT=4;tc.FRAME1_OVERFLOWS_BOX=8;tc.CURS_RESET=0;tc.CURS_FORWARD=1;tc.CURS_BACKWARD=2;tc.CURS_UP=3;tc.CURS_DOWN=4;tc.PV_PAGE_DIST=1;tc.PARA_FRAME_MIN_WIDTH=360;tc.WIN_BOT_MARGIN=0;tc.BFLAG_BOX_FIRST=1;tc.BFLAG_BOX_LAST=2;tc.BFLAG_JUST_SPACE=4;tc.STORY_COMMENT=1;tc.FSTORY_BEGINS=1;tc.FSTORY_ENDS=2;tc.FSTORY_VERT=4;tc.FSTORY_SKIP=8;tc.FSTORY_FORMATTED=16;tc.FSTORY_OVERFLOW=32;tc.FSTORY_TEXT_POS_SET=64;tc.FSTORY_DRAWN=128;tc.FSTORY_OPENED=256;tc.FSTORY_CLOSED=512;tc.ANNOT_AUTH_ID=1;tc.ANNOT_AUTH_NAME=2;tc.ANNOT_TEXT=3;tc.SPILL_LEFT=1;tc.SPILL_RIGHT=2;tc.SPILL_TOP=4;tc.SPILL_BOT=8;tc.SPILL_NO_RULER=16;tc.SPILL_NO_STATUS_BAR=18;tc.MSG_MAX_DRAG=1;tc.MSG_MAX_PFMT=2;tc.GFLAG_DRAW_OBJECT=1;tc.GFLAG_DO_TEXT_READ=4;tc.GFLAG_CHAR_STYLE=8;tc.GFLAG_IN_STYLESHEET=16;tc.GFLAG_IN_STYLE_ITEM=32;tc.GFLAG_NEW_FRAME=64;tc.GFLAG_IN_FRAME=128;tc.GFLAG_IN_SHPRSLT=256;tc.GFLAG_DPLINEHOLLOW=512;tc.GFLAG_ANIM_SEQ=1024;tc.GFLAG_ANIM_INFO=2048;tc.GFLAG_CAPS=4096;tc.GFLAG_IN_FIELD=8192;tc.GFLAG_INSERT_BEF_PARA=16384;tc.GFLAG_INPUT_FIELD=32768;tc.GFLAG_BACKGROUND=65536;tc.GFLAG_IN_MERGE_FIELD=131072;tc.GFLAG_IN_TOC_FIELD=262144;tc.GFLAG_IN_NESTTABLEPROPS=524288;tc.GFLAG_CELL_MARGIN_OVERRIDE=1048576;tc.GFLAG_GOT_WIDTH=2097152;tc.GFLAG_GOT_HEIGHT=4194304;tc.GFLAG_USE_SHP_INFO=8388608;tc.GFLAG_IN_LIST_OR=16777216;tc.GFLAG_IN_SHP=33554432;tc.GFLAG_IN_DPGROUP=67108864;tc.GFLAG_IN_LEVELTEXT=134217728;tc.GFLAG_IN_LEVELNUM=268435456;tc.GFLAG_IN_SHPGRP=536870912;tc.GFLAG_IN_LIST=1073741824;tc.GFLAG2_PICT_SHAPE=1;tc.GFLAG2_DEF_FONT_XLATED=2;tc.GFLAG2_IN_HDR_FTR=8;tc.GFLAG2_HAS_LEAD=16;tc.GFLAG2_UNSUPPORTED_STYLE=32;tc.GFLAG2_NESTPROP_BEF_NESTCELL=64;tc.GFLAG2_IN_ALT_FONT=128;tc.GFLAG2_CONTEXTUAL_SPACE=256;tc.GFLAG2_IN_OLDCPROPS=512;tc.GFLAG2_IN_UPR=1024;tc.GFLAG2_IN_UD=2048;tc.GFLAG2_IN_OLDPPROPS=4096;tc.GFLAG2_INCLUDEPICTURE_READ=8192;tc.GFLAG2_IN_MATH=16384;tc.GFLAG2_IN_MATH_PICT=32768;tc.GFLAG2_IN_MATH_PARA=65536;tc.GFLAG2_NUM_STYLE=131072;tc.GFLAG2_IN_DOC_PARA_PROPS=262144;tc.GFLAG2_GET_CR_LF=524288;tc.CHAR_NORMAL=0;tc.CHAR_LO=1;tc.CHAR_HI=2;tc.CHAR_DB=3;tc.DOL_HORZ=0;tc.DOL_VERT=1;tc.DOL_DIAG=2;tc.DOL_BDIAG=3;tc.SNAP_DIST=90;tc.SNAP_DIST_METRIC=71;tc.MIN_TEXT_WIDTH=.5;tc.MIN_TEXT_HEIGHT=.05;tc.PAGE_HARD=1;tc.PAGE_FIRST_SECT_PAGE=2;tc.PAGE_REPAGE=4;tc.PAGE_BOXED=8;tc.PAGE_LINKED_FRAMES=16;tc.PAGE_PRINT_BLANK_PAGE_BEF=32;tc.PAGE_REPAGE_PREV=64;tc.CAUX_PAGINATION_DONE=1;tc.CAUX_SET_TOP_SPACE=2;tc.CAUX_CELLX_WAITING=4;tc.CAUX_CLOSED=8;tc.CAUX_HIDDEN=16;tc.CAUX_EMPTY_CELL=32;tc.CAUX_IN_FRAME=64;tc.CAUX_PAGE_OVERFLOW=128;tc.CAUX_ADD_TOP_SPANNING_CELL_HT=256;tc.CAUX_HAS_LARGE_PICTURE=512;tc.TAUX_TROWD_DONE=1;tc.TAUX_REUSE_CELL_CHAIN=2;tc.TAUX_RTF_DEL=4;tc.TAUX_HAS_NEW_TEXT=16;tc.TAUX_COPIED=32;tc.TAUX_CALC_DONE=64;tc.TAUX_IN_FRAME=128;tc.TAUX_PAGE_OVERFLOW=256;tc.TAUX_IN_HDR_FTR=512;tc.TAUX_SAME_ROW_SPAN=1024;tc.TAUX_ALL_SPANNED=2048;tc.TAUX_SAME_SPANNING_ROW=4096;tc.TAUX_HEIGHT_ADDED=8192;tc.TAUX_INIT_ROW=16384;tc.TAUX_HAS_EMPTY_CELL=32768;tc.TAUX_PAGE_BREAK_AFTER=65536;tc.TAUX_IGNORE_EXACT_HEIGHT=131072;tc.TAUX_MIN_HEIGHT_USED=262144;tc.TAUX_PAGE_BREAK=524288;tc.PAT_NONE=0;tc.PAT_SOLID=1;tc.PAT_OTHER=2;tc.IDP_FIRST_POPUP=2500;tc.IDP_FIRST_SPELL=2500;tc.IDP_FIRST_WORD=2500;tc.IDP_WORD1=2500;tc.IDP_WORD2=2501;tc.IDP_WORD3=2502;tc.IDP_WORD4=2503;tc.IDP_WORD5=2504;tc.IDP_WORD6=2505;tc.IDP_LAST_WORD=2505;tc.IDP_IGNORE=2510;tc.IDP_ADD=2511;tc.IDP_LAST_SPELL=2511;tc.IDP_LAST_POPUP=2511;tc.ClsTimer=function(t,e,r,i){this.ms=t;this.CallbackMethod=e;this.CallbackThis=r;this.args=i;var f;var l=this;this.init=function(){return Object.seal(this)};this.start=function(){f=window.setInterval(function(){l.CallbackMethod.apply(l.CallbackThis,l.args)},this.ms)};this.stop=function(){clearInterval(f)}};tc.ClsCaret=function(t){var f=t;var l=0;var a=0;var r=0;var i=0;this.CurX=0;this.CurY=0;var n=0;var c=0;this.visible=false;this.CaretBlinking=false;this.owner="none";this.cvs=null;this.cvsX=0;this.cvsY=0;this.timer=null;this.div=document.createElement("div");this.div.style.position="absolute";this.div.style.left="100px";this.div.style.top="15px";this.div.style.width="1px";this.div.style.height="20px";this.div.style.backgroundColor="#000";this.div.style.zIndex="1000";this.div.style.visibility="hidden";var s=this;this.setCanvas=function(t){this.cvs=t;var e=document.body||document.documentElement;e.appendChild(this.div);var r=tc.GetElementPosition(t);s.cvsX=r.x;s.cvsY=r.y};this.getX=function(){return n};this.getY=function(){return c};this.position=function(t,e,r){if(r==undefined)r=true;var i=tc.GetElementPosition(this.cvs);s.cvsX=i.x;s.cvsY=i.y;n=t;c=e;s.CurX=t;s.CurY=e;l=f.TerDeviceToCss(t);a=f.TerDeviceToCss(e);l+=s.cvsX;a+=s.cvsY;s.div.style.left=l+"px";s.div.style.top=a+"px";if(r)s.show()};this.getWidth=function(){return r};this.getHeight=function(){return i};this.CreateCaret=function(t,e){s.hide();r=t;i=e;s.div.style.width=f.TerDeviceToCss(t)+"px";s.div.style.height=f.TerDeviceToCss(e)+"px"};this.destroy=function(){this.hide()};this.isCaretHidden=function(){return!s.CaretBlinking};this.killTimer=function(){if(s.timer){clearInterval(s.timer);s.timer=null}};this.hide=function(){if(false&&s.timer){clearInterval(s.timer);s.timer=null}if(this.visible)this.paint(this);s.CaretBlinking=false};this.show=function(){if(false&&this.timer){clearInterval(s.timer);s.timer=null}this.visible=false;if(!this.visible)this.paint(this);if(s.timer==null)s.timer=setInterval(s.OnTimer,500);s.CaretBlinking=true};this.OnTimer=function(){s.paint(s)};this.paint=function(t){t.visible=!t.visible;if(s.CaretBlinking){var e=t.visible;if(t.visible)s.position(n,c,false);if(e){var r;for(r=this.cvs.parentElement;r!=null&&r!=undefined;r=r.parentElement){if(/body|html/i.test(r.tagName.toLowerCase()))break;if(/absolute|relative|fixed|sticky/i.test(r.style.position))break;if(r.offsetWidth==0||r.clientHeight==0)break;var i=tc.GetElementPosition(r);if(l<i.x)e=false;else if(l>i.x+r.offsetWidth)e=false;else if(a<i.y)e=false;else if(a>i.y+r.clientHeight)e=false;if(!e)break}}if(e)t.div.style.visibility="visible";else t.div.style.visibility="hidden"}else t.div.style.visibility="hidden"}};tc.GetElementPosition=function(t,e){if(e==undefined)e=false;var r=t.getBoundingClientRect();var i=r.top;var f=r.left;if(!e){var l=document.body;var a=document.documentElement;var n=window.pageYOffset||a.scrollTop||l.scrollTop;var c=window.pageXOffset||a.scrollLeft||l.scrollLeft;var s=a.clientTop||l.clientTop||0;var _=a.clientLeft||l.clientLeft||0;i=i+n-s;f=f+c-_}return{x:Math.round(f),y:Math.round(i)}};tc.GetElementPositionOld=function(t,e){var r=0;var i=0;var f=t.style.position.toLowerCase();var l=f=="absolute"||f=="relative"||f=="fixed";while(t){if(t.tagName=="BODY"){if(e){var a=t.scrollLeft||document.documentElement.scrollLeft;var n=t.scrollTop||document.documentElement.scrollTop;r+=t.offsetLeft-a+t.clientLeft;i+=t.offsetTop-n+t.clientTop}}else{var c=0,s=0;var _=t.style.position.toLowerCase();var o=_=="absolute"||_=="relative"||_=="fixed";if(l||o){var u=t.style.top?t.style.top:"";var T=t.style.left?t.style.left:"";var A=u.toLowerCase().indexOf("px");if(A>0)s+=parseInt(u.substr(0,A));A=T.toLowerCase().indexOf("px");if(A>0)c+=parseInt(T.substr(0,A))}if(l){r=c;i=s;break}if(o)break;r+=t.offsetLeft-t.scrollLeft+t.clientLeft;i+=t.offsetTop-t.scrollTop+t.clientTop}t=t.offsetParent}return{x:r,y:i}};tc.ClsFrameSet=function(){this.y=0;this.CurColHeight=0;this.MaxColHeight=0;this.ColumnX=0;this.ColumnWidth=0;this.ColumnSpace=0;this.CellX=0;this.FrameHt=0;this.TopSect=0;this.sect=0;this.TopLeftMargin=0;this.HiddenY=0;this.HdrMargin=0;this.HdrHeight=0;this.FtrMargin=0;this.FtrHeight=0;var e=this;function t(){return Object.seal(e)}this.init=function(){return e};this.copy=function(){var t=new tc.ClsFrameSet;tc.clone2(e,t);return t};t()};tc.ClsZOrder=function(){this.ZOrder=0;this.level=0;this.FrameId=0;this.line=0;this.ParaFID=0;this.TextPos=0;this.ParaId=0;this.BehindText=false;var t=this;function e(){return Object.seal(t)}this.init=function(){return t};e()};tc.ClsFontMetrics=function(){this.ObjType="ClsFontMetrics";this.height=0;this.ascent=0;this.descent=0;this.getAscent=function(){return this.ascent};this.getDescent=function(){return this.descent};this.getHeight=function(){return this.height};this.getLeading=function(){return 0};var e=this;function t(){return Object.seal(e)}this.init=function(){return e};this.copy=function(){var t=new tc.ClsShpGrp;tc.clone2(e,t);return t};t()};tc.Locale=function(){};tc.ClsLocale=function(t,e,r,i,f){this.locale=e;this.CharSet=i;this.lcid=r;this.CodePage=f;this.AvailFamilies=[];var l=this;function a(){return Object.seal(l)}a()};tc.ClsCharset=function(t,e,r){this.name=t;this.AltName=e.split(",");this.AllAltNames=e;this.CodePage=r;var i=this;function f(){return Object.seal(i)}f()};tc.ClsOrd=function(){this.FrameId=0;this.ZOrder=0;this.IsBkndFrame=false;var t=this;function e(){return Object.seal(t)}e()};tc.ClsExp=function(){this.InUse=false;this.type=0;this.style=0;this.script=0;this.FontId=0;this.flags=0;this.exp=[];this.ExpCount=0;this.MaxExpCount=0;this.text="";this.mark="";this.parent=null;this.RtfGroup=0;var t=this;function e(){return Object.seal(t)}e()};tc.ClsCustomFontProp=function(){this.IsSizeProp=false;this.typeface="";this.value="";var t=this;function e(){return Object.seal(t)}e()};tc.ClsUserProp=function(){this.name="";this.type=0;this.StaticVal="";this.LinkVal="";var t=this;function e(){return Object.seal(t)}e()};tc.ClsFrameBorder=function(){this.frm=0;this.x=0;this.y=0;this.TopMargin=0;this.border=0;this.width=0;this.CellHilighted=false;var t=this;function e(){return Object.seal(t)}var r=function(){return tc.clone(t)};e()};tc.ClsLineSeg=function(){this.InUse=false;this.col=0;this.count=0;this.x=0;this.width=0;this.rtl=false;this.ForceRtl=false;this.ForceLtr=false;this.ForceDrawLtr=false;this.RtlFont=false;this.rtlch=false;this.flow=0;this.IsNumeric=false;this.IsPunct=false;this.IsTab=false;this.IsParen=false;this.IsObj=false;this.AllSpaces=false;this.lang=0;this.pFirstSeg=[];this.idx=0;this.ParaRtl=false;this.TotalLineSeg=0;this.MirrorChar="";this.LineNo=0;this.NoMerge=false;this.IsDate=false;var e=this;function t(){return Object.seal(e)}this.copy=function(){var t=new tc.ClsLineSeg;tc.clone2(e,t);return t};t()};tc.ClsSeg=function(){this.col=0;this.count=0;this.type=0;this.FirstChar="";var t=this;function e(){return Object.seal(t)}e()};tc.ClsHlSeg=function(){this.x=0;this.y=0;this.width=0;this.height=0;this.LineNo=0;this.ScrFrameAngle=0;var t=this;function e(){return Object.seal(t)}this.init=function(){return t};e()};tc.ClsScrCtl=function(){this.InUse=false;this.x=0;this.y=0;this.width=0;this.height=0;this.DrawX=0;this.pict=0;this.ctl=null;this.LineNo=0;this.PaintId=0;var t=this;function e(){return Object.seal(t)}this.init=function(){return t};e()};tc.ClsPendPict=function(){this.pict=0;this.x=0;this.y=0;this.width=0;this.height=0;this.count=0;this.LineNo=0;var t=this;function e(){return Object.seal(t)}this.init=function(){return t};e()};tc.ClsImageMapRect=function(){this.name="";this.LinkInfo="";this.target="";this.rect=new tc.RECT;var t=this;function e(){return Object.seal(t)}this.init=function(){return t};e()};tc.ClsStResult=function(){this.code=0;this.replace="";this.TotalAltWords=0;this.AltWord=[];var t=this;function e(){return Object.seal(t)}this.init=function(){return t};e()};tc.ClsHdnFont=function(){this.height=0;this.BaseHeight=0;this.BaseHeightAdj=0;this.ExtLead=0;this.CharWidth=[];var e=this;function t(){return Object.seal(e)}this.init=function(){return e};this.copy=function(){var t=new tc.ClsHdnFont;tc.clone2(e,t);return t};t()};tc.ClsHdrFtr=function(){this.FirstLine=0;this.LastLine=0;this.height=0;this.TextHeight=0;this.LimitFtrLine=0;this.used=false;var e=this;function t(){return Object.seal(e)}this.init=function(){return e};this.copy=function(){var t=new tc.ClsHdrFtr;tc.clone2(e,t);return t};t()};tc.ClsShape=function(){this.mask=0;this.x=0;this.y=0;this.width=0;this.height=0;this.RelLeft=0;this.RelTop=0;this.RelRight=0;this.RelBot=0;this.RelWidth=0;this.RelHeight=0;this.GeoLeft=0;this.GeoTop=0;this.GeoRight=0;this.GeoBot=0;this.FrmFlags=0;this.FrmFlags2=0;this.WrapType=0;this.WrapSide=0;this.type=0;this.OrigType=0;this.align=0;this.ZOrder=0;this.LineColor=new tc.Color;this.BackColor=new tc.Color;this.FillPattern=0;this.LineWdth=0;this.DistFromTextLeft=0;this.DistFromTextRight=0;this.DistFromTextTop=0;this.DistFromTextBot=0;this.FillPict=0;this.ShapeId=0;this.NextShapeId=0;this.FillOpacity=0;this.LineOpacity=0;this.AdjVal1=0;this.AdjVal2=0;this.WidthFactor=0;this.HeightFactor=0;var e=this;function t(){return Object.seal(e)}this.init=function(){return e};this.copy=function(){var t=new tc.ClsShape;tc.clone2(e,t);return t};t()};tc.ClsShpGrp=function(){this.mask=0;this.left=0;this.top=0;this.right=0;this.bot=0;this.width=0;this.height=0;this.GroupLeft=0;this.GroupTop=0;this.GroupRight=0;this.GroupBot=0;this.GroupWidth=0;this.GroupHeight=0;var e=this;function t(){return Object.seal(e)}this.init=function(){return e};this.copy=function(){var t=new tc.ClsShpGrp;tc.clone2(e,t);return t};t()};tc.ClsRtfParaFrameInfo=function(){this.x=0;this.y=0;this.width=0;this.height=0;this.DistFromTextLeft=0;this.DistFromTextRight=0;this.DistFromTextTop=0;this.DistFromTextBot=0;this.ZOrder=0;var e=this;function t(){return Object.seal(e)}this.init=function(){return e};this.copy=function(){var t=new tc.ClsRtfParaFrameInfo;tc.clone2(e,t);return t};t()};tc.ClsRgb=function(){this.red=0;this.green=0;this.blue=0;this.count=0;var e=this;function t(){return Object.seal(e)}this.init=function(){return e};this.copy=function(){var t=new tc.ClsRgb;tc.clone2(e,t);return t};t()};tc.ClsListnum=function(){this.text="";this.ListNbr=0;this.ls=0;this.lvl=0;this.RestartAt=0;this.IsHPARA=false;this.HasLevelSpec=false;var t=this;function e(){return Object.seal(t)}this.init=function(){return t};e()};tc.TejHyperlink=function(){this.ObjType="TejHyperlink";this.code="";this.text="";this.DoubleClick=false;this.used=false;var i=this;function t(){i.init();return Object.seal(i)}this.init=function(){return i};this.SetSize=function(t){};this.copy=function(){var t,e;var r=new tc.TejHyperlink;tc.clone2(i,r);return r};t()};tc.TejTab=function(){this.ObjType="TejTab";this.count=0;this.pos=[];this.type=[];this.flags=[];var i=this;function t(){i.init();return Object.seal(i)}this.init=function(){tc.FillArray(i.pos,tc.TE_MAX_TAB_STOPS,0);tc.FillArray(i.type,tc.TE_MAX_TAB_STOPS,0);tc.FillArray(i.flags,tc.TE_MAX_TAB_STOPS,0);return i};this.SetSize=function(t){i.count=t;tc.FillArray(i.pos,tc.TE_MAX_TAB_STOPS,0);tc.FillArray(i.type,tc.TE_MAX_TAB_STOPS,0);tc.FillArray(i.flags,tc.TE_MAX_TAB_STOPS,0)};this.copy=function(){var t,e;var r=new tc.TejTab;tc.clone2(i,r);return r};t()};tc.TejTabw=function(){this.type=0;this.count=0;this.width=[];this.section=0;this.JustCount=0;this.JustAdj=0;this.JustSpaceCount=0;this.JustSpaceIgnore=0;this.FrameCharPos=0;this.FrameX=0;this.FrameWidth=0;this.FrameSpaceWidth=0;this.FrameScrWidth=0;this.height=0;this.CharFlagsLen=0;this.CharFlags=null;this.ListText="";this.ListTextWidth=0;this.ListFontId=0;this.ListNbr=0;this.ListnumCount=0;this.pListnum=[];this.pAutoNumLgl="";var i=this;function t(){return Object.seal(i)}this.init=function(){return i};this.copy=function(){var t=new tc.TejTabw;tc.clone2(i,t);var e,r=0;if(i.width&&(r=i.width.length)>0){t.width=[r];for(e=0;e<r;e++)t.width[e]=i.width[e]}if(i.CharFlags&&(r=i.CharFlags.length)>0){t.CharFlags=[r];for(e=0;e<r;e++)t.CharFlags[e]=i.CharFlags[e]}if(i.pListnum&&(r=i.pListnum.length)>0){t.pListnum=[r];for(e=0;e<r;e++)t.pListnum[e]=i.pListnum[e]}return t};if(tc.seal)t()};tc.ClsAnim=function(){this.FirstPict=0;this.NextPict=0;this.LoopCount=0;this.OrigLoopCount=0;this.delay=0;this.CurAnim=0;this.NextAnim=0;this.TimerId=0;var e=this;function t(){return Object.seal(e)}this.init=function(){return e};this.copy=function(){var t=new tc.ClsAnim;tc.clone2(e,t);return t};t()};tc.ClsGifAnim=function(){this.hDIB=[];this.AnimLoops=0;this.AnimPicts=0;this.delay=[];this.InitDelay=0;var e=this;function t(){return Object.seal(e)}this.init=function(){return e};this.copy=function(){var t=new tc.ClsGifAnim;tc.clone2(e,t);return t};t()};tc.ClsLinePtr=function(){this.txt=[];this.fmt=[];this.UniFmt=0;this.len=0;this.tabw=new tc.TejTabw;this.pfmt=0;this.height=0;this.BaseHt=0;this.ScrHt=0;this.TextHt=0;this.OrgY=0;this.y=0;this.x=0;this.cid=0;this.fid=0;this.page=0;this.flags=0;this.flags2=0;this.JustAdjX=0;this.tag=[];this.cwidth=[];this.frame=0;this.HeightAfter=0;this.col=0;this.GridSpace=0;this.BaseHeightAdj=0;var i=this;function t(){return Object.seal(i)}this.init=function(){return i};this.copy=function(){var t=new tc.ClsLinePtr;tc.clone2(i,t);var e,r;if(i.txt&&(r=i.txt.length)>0){t.txt=[r];for(e=0;e<r;e++)t.txt[e]=i.txt[e]}if(i.fmt&&(r=i.fmt.length)>0){t.fmt=[r];for(e=0;e<r;e++)t.fmt[e]=i.fmt[e]}if(i.tag&&(r=i.tag.length)>0){t.tag=[r];for(e=0;e<r;e++)t.tag[e]=i.tag[e]}if(i.cwidth&&(r=i.cwidth.length)>0){t.cwidth=[r];for(e=0;e<r;e++)t.cwidth[e]=i.cwidth[e]}if(i.tabw)t.tabw=i.tabw.copy();return t};t()};tc.ClsFrame=function(){this.empty=false;this.PageFirstLine=0;this.PageLastLine=0;this.ScrFirstLine=0;this.ScrLastLine=0;this.x=0;this.y=0;this.ScrX=0;this.ScrY=0;this.width=0;this.height=0;this.TextHeight=0;this.ScrWidth=0;this.ScrHeight=0;this.RowOffset=0;this.sect=0;this.border=0;this.BorderWidth=[];this.BorderColor=[];this.LastColumnFrame=false;this.RowId=0;this.CellId=0;this.SpaceTop=0;this.SpaceBot=0;this.SpaceLeft=0;this.SpaceRight=0;this.shading=0;this.ParaFrameId=0;this.flags=0;this.flags1=0;this.BackColor=new tc.Color;this.LeftBorderWdth=0;this.ZOrder=0;this.DispFrame=0;this.DispOrder=0;this.level=0;this.BoxFrame=0;this.ParentFrame=0;this.OrigX=0;this.CellSpacing=0;this.TextPos=0;this.PageNo=0;this.LimitY=0;this.AddedBorderSpace=0;var i=this;function t(){if(tc.seal)return Object.seal(i);else return i}this.init=function(){return i};this.copy=function(){var t=new tc.ClsFrame;tc.clone2(i,t);var e,r;if(i.BorderWidth&&(r=i.BorderWidth.length)>0){t.BorderWidth=[r];for(e=0;e<r;e++)t.BorderWidth[e]=i.BorderWidth[e]}if(i.BorderColor&&(r=i.BorderColor.length)>0){t.BorderColor=[r];for(e=0;e<r;e++)t.BorderColor[e]=i.BorderColor[e]}return t};t()};tc.ClsParaFrame=function(){this.InUse=false;this.x=0;this.y=0;this.ParaY=0;this.width=0;this.margin=0;this.height=0;this.MinHeight=0;this.DistFromTextLeft=0;this.DistFromTextRight=0;this.DistFromTextTop=0;this.DistFromTextBot=0;this.PageNo=0;this.flags=0;this.TextLine=0;this.LineType=0;this.BackColor=new tc.Color;this.FillPattern=0;this.LineWdth=0;this.PageY=0;this.LineColor=new tc.Color;this.pict=0;this.ZOrder=0;this.CellId=0;this.TextAngle=0;this.GroupX=0;this.GroupY=0;this.ShapeType=0;this.FillPict=0;this.OrgX=0;this.OrgY=0;this.flags2=0;this.AdjVal1=0;this.AdjVal2=0;this.FirstLine=0;this.LastLine=0;this.AnchorX=0;this.AnchorY=0;this.canvas=0;this.PctWidth=0;this.TopMarg=0;this.BotMarg=0;this.PointCount=0;this.pPoint=[];this.CalcX=0;this.FramePageY=0;this.ShapeId=0;this.NextShapeId=0;this.NextId=0;this.PrevId=0;this.rotation=0;this.SegmentCount=0;this.pSegment=[];this.OrigShapeType=0;this.AnchorLine=0;this.FillOpacity=0;this.LineOpacity=0;this.GroupId=0;this.GrpRelX=0;this.GrpRelY=0;this.GrpWidth=0;this.GrpHeight=0;this.OverlapAddedX=0;this.OverlapAddedY=0;this.RepageAnchorY=0;this.InHdrFtr=0;this.WidthFactor=0;this.HeightFactor=0;var e=this;function t(){return Object.seal(e)}this.init=function(){return e};this.copy=function(){var t=new tc.ClsParaFrame;tc.clone2(e,t);return t};t()};tc.ClsDate=function(t){if(t==undefined)t=new Date;this.ObjType="ClsDate";this.dt=t;var e=this;function r(){return Object.seal(e)}this.init=function(){return e};this.copy=function(){var t=new tc.ClsDate;tc.clone2(e,t);return t};r()};tc.ClsReviewer=function(){this.name="";this.InsColor=new tc.Color;this.InsStyle=0;this.DelColor=new tc.Color;this.DelStyle=0;this.FmtColor=new tc.Color;this.FmtStyle=0;this.RtfId=0;var e=this;function t(){return Object.seal(e)}this.init=function(){return e};this.copy=function(){var t=new tc.ClsReviewer;tc.clone2(e,t);return t};t()};tc.ClsStory=function(){this.InUse=false;this.type=0;this.RtfId=0;this.flags=0;this.author="";this.AuthorInit="";this.time=new tc.ClsDate;this.text=null;this.x=0;this.y=0;this.width=0;this.height=0;this.height2=0;this.TextWidth=0;this.TextHeight=0;this.x1=0;this.y1=0;this.RightMargX=0;this.page=0;this.StyId=0;this.FontId=0;this.line=0;this.col=0;this.num=0;this.NumPixLen=0;this.sect=0;this.AvailSpace=0;this.StoryLines=[];this.StoryLineHt=0;this.InPrinting=false;var e=this;function t(){return Object.seal(e)}this.init=function(){return e};this.copy=function(){var t=new tc.ClsStory;tc.clone2(e,t);return t};t()};tc.ClsCharTag=function(){this.InUse=false;this.name="";this.type=0;this.HtmlInfo="";this.AuxText="";this.AuxInt=0;this.obj=null;this.line=0;this.col=0;this.next=0;var e=this;function t(){return Object.seal(e)}this.init=function(){return e};this.copy=function(){var t=new tc.ClsCharTag;tc.clone2(e,t);return t};t()};tc.ClsPfmt=function(){this.LeftIndent=0;this.RightIndent=0;this.FirstIndent=0;this.LeftIndentTwips=0;this.RightIndentTwips=0;this.FirstIndentTwips=0;this.flags=0;this.TabId=0;this.BltId=0;this.StyId=0;this.shading=0;this.pflags=0;this.SpaceBefore=0;this.SpaceAfter=0;this.SpaceBetween=0;this.AuxId=0;this.Aux1Id=0;this.BkColor=new tc.Color;this.BorderSpaceLeft=0;this.BorderSpaceRight=0;this.BorderSpaceTop=0;this.BorderSpaceBot=0;this.BorderWidth=0;this.LineSpacing=0;this.flow=0;this.BorderColor=new tc.Color;this.width=0;this.height=0;this.DivId=0;this.FmtRev=0;this.FmtTime=new tc.ClsDate;this.FmtOrigPara=0;this.OutlineLevel=0;this.mask=0;this.mask2=0;this.TextVAlign=0;var e=this;function t(){return Object.seal(e)}this.init=function(){e.OutlineLevel=-1;return e};this.copy=function(){var t=new tc.ClsPfmt;tc.clone2(e,t);return t};t()};tc.ClsDiv=function(){this.height=0;this.parent=0;this.level=0;this.LeftMarg=0;this.RightMarg=0;this.BkColor=new tc.Color;this.ParaFlags=0;var e=this;function t(){return Object.seal(e)}this.init=function(){e.BkColor=tc.CLR_WHITE;return e};this.copy=function(){var t=new tc.ClsDiv;tc.clone2(e,t);return t};t()};tc.ClsBlt=function(){this.IsBullet=false;this.flags=0;this.start=0;this.level=0;this.NumberType=0;this.font=0;this.BulletChar="";this.BefChar="";this.AftChar="";this.BefText="";this.ls=0;this.lvl=0;var e=this;function t(){return Object.seal(e)}this.init=function(){e.BefText="";return e};this.copy=function(){var t=new tc.ClsBlt;tc.clone2(e,t);return t};t()};tc.ClsCustBlt=function(){this.unicode=0;this.typeface="";this.CharSet=0;this.IsBullet=false;this.TwipsSize=0;this.AutoSize=false;this.FontId=0;var e=this;function t(){return Object.seal(e)}this.init=function(){e.BefText="";return e};this.copy=function(){var t=new tc.ClsCustBlt;tc.clone2(e,t);return t};t()};tc.ClsList=function(){this.InUse=false;this.id=0;this.TmplId=0;this.FontId=0;this.LevelCount=0;this.flags=0;this.name="";this.level=[];this.RtfId=0;this.ListStyleName="";this.StyleName="";var i=this;function t(){return Object.seal(i)}this.init=function(){return i};this.copy=function(){var t=new tc.ClsList;tc.clone2(i,t);if(i.level){var e=i.level.length;t.level=[e];for(var r=0;r<e;r++)t.level[r]=i.level[r].copy()}return t};t()};tc.ClsListOr=function(){this.InUse=false;this.ListIdx=0;this.LevelCount=0;this.level=[];this.RtfLs=0;this.flags=0;var i=this;function t(){return Object.seal(i)}this.init=function(){return i};this.copy=function(){var t=new tc.ClsListOr;tc.clone2(i,t);if(i.level){var e=i.level.length;t.level=[e];for(var r=0;r<e;r++)t.level[r]=i.level[r].copy()}return t};t()};tc.ClsListLevel=function(){this.start=0;this.NumType=0;this.CharAft=0;this.LeftIndent=0;this.RightIndent=0;this.FirstIndent=0;this.ParaFlags=0;this.FontStyles=0;this.FontId=0;this.txt=[];this.flags=0;this.MinIndent=0;this.FontStylesOff=0;this.StyleMask=0;this.CharMask=0;this.TabId=0;this.ParaMask=0;this.ParaStyId=0;var i=this;function t(){return Object.seal(i)}this.init=function(){i.txt=[50];i.txt[0]=0;return i};this.copy=function(){var t=new tc.ClsListLevel;tc.clone2(i,t);if(i.txt){var e=50;if(i.txt.length>50)e=i.txt.length;t.txt=[e];for(var r=0;r<i.txt.length;r++)t.txt[r]=i.txt[r]}return t};t()};tc.ClsDefListLevel=function(){this.NumType=0;this.txt=null;var e=this;function t(){return Object.seal(e)}this.init=function(){e.txt=[];e.txt[0]=0;return e};this.copy=function(){var t=new tc.ClsDefListLevel;tc.clone2(e,t);return t};t()};tc.ClsStyleId=function(){this.InUse=false;this.name="";this.type=0;this.FontFamily=0;this.TwipsSize=0;this.style=0;this.TextColor=new tc.Color;this.TextBkColor=new tc.Color;this.lang=0;this.LeftIndentTwips=0;this.RightIndentTwips=0;this.FirstIndentTwips=0;this.ParaFlags=0;this.shading=0;this.SpaceBefore=0;this.SpaceAfter=0;this.SpaceBetween=0;this.TabId=0;this.OutlineLevel=0;this.flags=0;this.LineSpacing=0;this.next=0;this.RtfIndex=0;this.pflags=0;this.BltId=0;this.ParaBkColor=new tc.Color;this.expand=0;this.TypeFace="";this.UlineColor=new tc.Color;this.HeadingNo=0;this.ParaBorderColor=new tc.Color;this.offset=0;this.CharScaleX=0;this.RtfLs=0;this.lvl=0;this.StyleMask=0;this.CharMask=0;this.ParaMask=0;this.ParaMask2=0;this.BasedOn=0;this.forward=0;this.ParaFlow=0;this.x=0;this.y=0;this.width=0;this.height=0;this.DistFromTextLeft=0;this.DistFromTextRight=0;this.DistFromTextTop=0;this.DistFromTextBot=0;this.ZOrder=0;this.FrmFlags=0;this.FrmFlags2=0;this.TypeFaceDB="";this.TypeFaceHi="";this.TypeFaceCs="";this.link=0;this.LeftIndentNoList=0;this.FirstIndentNoList=0;var e=this;function t(){return Object.seal(e)}this.init=function(){return e};this.copy=function(){var t=new tc.ClsStyleId;tc.clone2(e,t);return t};t()};tc.ClsTableStyleItem=function(){this.InUse=false;this.CharMask=0;this.ParaMask=0;this.CellMask=0;this.RowMask=0;this.TblFont=new tc.ClsFont;this.RtfLs=0;this.lvl=0;this.TblPara=new tc.ClsPfmt;this.clwWidth=0;this.clftsWidth=0;this.TblCell=new tc.ClsCell;this.TblRow=new tc.ClsTableRow;var e=this;function t(){return Object.seal(e)}this.init=function(){e.TblPara=(new tc.ClsPfmt).init();e.TblCell=(new tc.ClsCell).init();e.TblRow=(new tc.ClsTableRow).init();return e};this.copy=function(){var t=new tc.ClsTableStyleItem;tc.clone2(e,t);t.init();t.TblPara=e.TblPara.copy();t.TblCell=e.TblCell.copy();t.TblRow=e.TblRow.copy();return t}};tc.ClsTableStyle=function(){this.id="";this.name="";this.based="";this.BasedOn=0;this.NextId=0;this.item=[];var i=this;function t(){return Object.seal(i)}this.init=function(){i.item=[13];for(var t=0;t<13;t++)i.item[t]=(new tc.ClsTableStyleItem).init();return i};this.copy=function(){var t=new tc.ClsTableStyle;tc.clone2(i,t);t.init();var e,r;if(i.item&&(r=i.item.length)>0){for(e=0;e<r;e++)t.item[e]=i.item[e].copy()}return t};t()};tc.ClsSect=function(){this.InUse=false;this.LeftMargin=0;this.RightMargin=0;this.TopMargin=0;this.BotMargin=0;this.columns=0;this.ColumnSpace=0;this.FirstLine=0;this.LastLine=0;this.IsPortrait=false;this.flags=0;this.LastPage=0;this.PageNumFmt=0;this.FirstPageNo=0;this.HdrMargin=0;this.FtrMargin=0;this.FirstPageBin=null;this.bin=null;this.border=0;this.BorderWidth=[];this.BorderSpace=[];this.BorderOpts=0;this.BorderColor=new tc.Color;this.BorderType=0;this.PprKind=null;this.PprWidth=0;this.PprHeight=0;this.flow=0;this.LineSpace=0;this.LineStep=0;this.ColWidth=[];this.ColSpace=[];this.gutter=0;var i=this;function t(){return Object.seal(i)}this.init=function(){i.BorderWidth=[4];i.BorderSpace=[4];tc.FillArray(i.ColWidth,tc.MAX_SECT_COLS,0);tc.FillArray(i.ColSpace,tc.MAX_SECT_COLS,0);return i};this.copy=function(){var t=new tc.ClsSect;tc.clone2(i,t);t.init();var e,r;if(i.BorderWidth&&(r=i.BorderWidth.length)>0){for(e=0;e<r;e++)t.BorderWidth[e]=i.BorderWidth[e]}if(i.BorderSpace&&(r=i.BorderSpace.length)>0){for(e=0;e<r;e++)t.BorderSpace[e]=i.BorderSpace[e]}if(i.ColWidth&&(r=i.ColWidth.length)>0){for(e=0;e<r;e++)t.ColWidth[e]=i.ColWidth[e]}if(i.ColSpace&&(r=i.ColSpace.length)>0){for(e=0;e<r;e++)t.ColSpace[e]=i.ColSpace[e]}return t};t()};tc.ClsSect1=function(){this.PrevSect=0;this.NextSect=0;this.hdr=new tc.ClsHdrFtr;this.ftr=new tc.ClsHdrFtr;this.lhdr=new tc.ClsHdrFtr;this.lftr=new tc.ClsHdrFtr;this.rhdr=new tc.ClsHdrFtr;this.rftr=new tc.ClsHdrFtr;this.fhdr=new tc.ClsHdrFtr;this.fftr=new tc.ClsHdrFtr;this.HiddenX=0;this.HiddenY=0;this.PgHeight=0;this.PgWidth=0;this.LastPageHeight=0;var e=this;function t(){return Object.seal(e)}this.init=function(){return e};this.copy=function(){var t=new tc.ClsSect1;tc.clone2(e,t);t.init();t.hdr=e.hdr.copy();t.ftr=e.ftr.copy();t.lhdr=e.lhdr.copy();t.lftr=e.lftr.copy();t.rhdr=e.rhdr.copy();t.rftr=e.rftr.copy();t.fhdr=e.fhdr.copy();t.fftr=e.fftr.copy();return t};t()};tc.ClsPage=function(){this.FirstLine=0;this.LastLine=0;this.BodyFirstLine=0;this.FirstRow=0;this.LastRow=0;this.LastRowEndY=0;this.DispNbr=0;this.ScrHt=0;this.TextHt=0;this.BodyHt=0;this.BodyTextHt=0;this.FnoteHt=0;this.flags=0;this.TopSect=0;this.TblHdrHt=0;this.TblHdrFirstLine=0;this.TblHdrLastLine=0;this.FrameCount=0;this.HdrSect=0;this.FtrSect=0;this.PagesPrinted=0;this.PhyPageNo=0;var e=this;function t(){return Object.seal(e)}this.init=function(){return e};this.copy=function(){var t=new tc.ClsPage;tc.clone2(e,t);return t};t()};tc.ClsPhyPage=function(){this.ObjType="ClsPhyPage";this.TextPageNo=0;this.IsBlank=false;var e=this;function t(){return Object.seal(e)}this.init=function(){return e};this.copy=function(){var t=new tc.ClsPage;tc.clone2(e,t);return t};t()};tc.ClsUndo=function(){this.ObjType="ClsUndo";this.txt=[];this.fmt=[];this.pfmt=[];this.beg=0;this.end=0;this.curs=0;this.flags=0;this.type="";this.id=0;this.TblLevel=0;this.EmbTable=false;this.ObjId=0;this.width=0;this.height=0;this.pFrame=new tc.ClsParaFrame;this.LinePtrU=[];this.TotalLinesU=0;this.MaxLinesU=0;this.CursPos=0;this.RowCount=0;this.CellCount=0;this.RowId=[];this.CellId=[];this.pRow=[];this.pCell=[];this.TagType=0;this.TagName="";this.TagInt=0;this.TagText="";this.ListLevel=null;var e=this;function t(){return Object.seal(e)}this.init=function(){return e};this.copy=function(){var t=new tc.ClsUndo;tc.clone2(e,t);return t};t()};tc.ClsDragObj=function(){this.InUse=false;this.drawn=false;this.type=0;this.id1=0;this.id2=0;this.id3=0;this.ObjPoint=[];this.ObjPointCount=0;this.ObjRect=new tc.RECT;this.HotRect=[];this.HotRectCount=0;this.IsHotPolygon=false;this.TextHilighted=false;this.AspectRatio=0;var e=this;function t(){return Object.seal(e)}this.init=function(){return e};this.copy=function(){var t=new tc.ClsDragObj;tc.clone2(e,t);return t};t()};tc.ClsTableRow=function(){this.InUse=false;this.FixWidth=0;this.PrefWidth=0;this.FirstCell=0;this.LastCell=0;this.FrmSpcBef=0;this.height=0;this.PrevRow=0;this.NextRow=0;this.indent=0;this.TblIndType=0;this.TblInd=0;this.RowSpaceBefType=0;this.RowSpaceBef=0;this.flags=0;this.CellMargin=0;this.border=0;this.BorderWidth=[];this.FirstFrame=0;this.LastFrame=0;this.AddedIndent=0;this.MinHeight=0;this.CurIndent=0;this.MinPictHeight=0;this.PageNo=0;this.id=0;this.flow=0;this.CellSpacing=0;this.LeftPad=0;this.RightPad=0;this.TopPad=0;this.BotPad=0;this.TblPictId=0;this.BorderColor=[];var i=this;function t(){return Object.seal(i)}this.init=function(t){if(typeof t=="undefined")t=true;i.BorderWidth=[];i.BorderColor=[];if(t){i.TopPad=i.BotPad=i.LeftPad=i.RightPad=-1}return i};this.copy=function(){var t=new tc.ClsTableRow;tc.clone2(i,t);t.init(false);var e,r;if(i.BorderWidth&&(r=i.BorderWidth.length)>0){for(e=0;e<r;e++)t.BorderWidth[e]=i.BorderWidth[e]}if(i.BorderColor&&(r=i.BorderColor.length)>0){for(e=0;e<r;e++)t.BorderColor[e]=i.BorderColor[e]}return t};t()};tc.ClsRowPageCol=function(){this.page=0;this.col=0;this.height=-1;var e=this;function t(){return Object.seal(e)}this.init=function(){e.height=-1;return e};this.copy=function(){var t=new tc.ClsPageRowCol;tc.clone2(e,t);return t.init()};t()};tc.ClsTableAux=function(){this.BotRowHt=0;this.TopRowHt=0;this.FirstPageHt=0;this.FirstPage=0;this.LastPage=0;this.FirstCol=0;this.LastCol=0;this.flags=0;this.FrmBegX=0;this.FrmEndX=0;this.RowBand=0;this.RtfRowIndent=0;this.height=0;this.CurPgHeight=0;this.PageColHeight=0;this.EndPgHeight=0;this.EndPageColHeight=0;this.TableInFrame=false;this.ParaFID=0;this.PageNo=0;this.MinEndY=0;this.PageCol=[];this.TotalPageCols=0;this.MaxPageCols=0;var i=this;function t(){return Object.seal(i)}this.init=function(){i.RowBand=-2;i.PageCol=[];return i};this.copy=function(){var t=new tc.ClsTableAux;tc.clone2(i,t);t.init();var e,r;if(i.PageCol&&(r=i.PageCol.length)>0){for(e=0;e<r;e++)t.PageCol[e]=i.PageCol[e]}return t};t()};tc.ClsCell=function(){this.InUse=false;this.row=0;this.NextCell=0;this.PrevCell=0;this.x=0;this.width=0;this.border=0;this.BorderWidth=[];this.margin=0;this.height=0;this.FirstLine=0;this.LastLine=0;this.shading=0;this.flags=0;this.RowSpan=0;this.ColSpan=0;this.BackColor=new tc.Color;this.FixWidth=0;this.level=0;this.ParentCell=0;this.BorderColor=[];this.TextAngle=0;this.SpaceTopUnused=0;this.SpaceBotUnused=0;this.LeftPad=0;this.RightPad=0;this.TopPad=0;this.BotPad=0;this.PictId=0;var i=this;function t(){return Object.seal(i)}this.init=function(t){if(typeof t=="undefined")t=false;i.BorderWidth=[4];i.BorderColor=[4];if(t){i.TopPad=i.BotPad=i.LeftPad=i.RightPad=-1}return i};this.copy=function(){var t=new tc.ClsCell;tc.clone2(i,t);t.init(false);var e,r;if(i.BorderWidth&&(r=i.BorderWidth.length)>0){for(e=0;e<r;e++)t.BorderWidth[e]=i.BorderWidth[e]}if(i.BorderColor&&(r=i.BorderColor.length)>0){for(e=0;e<r;e++)t.BorderColor[e]=i.BorderColor[e]}return t};t()};tc.ClsCellAux=function(){this.PrevColCell=0;this.NextColCell=0;this.SpanningCell=0;this.LastSpannedCell=0;this.height=0;this.MinHeight=0;this.MinHeightWithBotPad=0;this.flags=0;this.FirstPage=0;this.LastPage=0;this.FirstPageHt=0;this.LastPageHt=0;this.BaseHeight=0;this.SpaceBefore=0;this.FrameId=0;this.TempPfmt=0;this.TempFont=0;this.HtmlHeight=0;this.MinTextWidth=0;this.LeftOlSpace=0;this.RightOlSpace=0;this.TopOlSpace=0;this.BotOlSpace=0;this.clwWidth=0;this.clftsWidth=0;this.XWidth=0;this.FrameTopWidth=0;this.FrameBotWidth=0;this.FrameY=0;this.PageFrameHt=0;this.NestedRowHeightNotYetAdded=0;this.CurCellHeight=0;this.CurCellHeightPage=0;var e=this;function t(){return Object.seal(e)}this.init=function(){return e};this.copy=function(){var t=new tc.ClsCellAux;tc.clone2(e,t);return t};t()};tc.TlbToolBar=function(){this.ObjType="TlbToolBar";this.x=0;this.y=0;this.width=0;this.height=0;this.BkColor=null;var e=this;function t(){return Object.seal(e)}this.init=function(){return e};this.copy=function(){var t=new tc.TlbToolBar;tc.clone2(e,t);return t};t()};tc.ClsTlb=function(){this.ObjType="ClsTlb";this.id=0;this.BarIdx=0;this.CmdId=0;this.ctl=null;this.pBalloon="";this.flags=0;this.x=0;this.y=0;this.width=0;this.height=0;this.IconX=0;this.IconY=0;this.IconWidth=0;this.IconHeight=0;this.image=null;this.GrayedImage=null;this.CheckedImage=null;this.GrayedCheckedImage=null;this.CurImage=null;this.ConnectedTlb=null;var e=this;function t(){return Object.seal(e)}this.init=function(){return e};this.copy=function(){var t=new tc.ClsTlb;tc.clone2(e,t);return t};t()};tc.ClsTlbStat=function(t){this.ObjType="ClsTlbStat";te=t;this.FontId=-1;this.ParaId=-1;this.editable=false;this.CellId=-1;this.enabled=[];this.selected=[];var r=this;function e(){return Object.seal()}this.init=function(){this.FontId=te.TerGetEffectiveFont();this.ParaId=te.TerGetLineParam(-1,tc.LP_PARA_ID);this.editable=te.TerCanEdit();this.CellId=te.TerGetLineParam(-1,tc.LP_CELL_ID);var t,e=te.ExtTlbCmds.length;for(t=0;t<e;t++){this.enabled.push(te.TerMenuEnable2(te.ExtTlbCmds[t]));this.selected.push(te.TerMenuSelect2(te.ExtTlbCmds[t]))}return r};this.copy=function(){var t=new tc.ClsTlb;tc.clone2(r,t);return t};this.IsSame=function(t){if(t==null)return false;var e,r;if(this.FontId!=t.FontId)return false;if(this.ParaId!=t.ParaId)return false;if(this.editable!=t.editable)return false;if(this.CellId!=t.CellId)return false;e=this.enabled.length;if(t.enabled.length!=e)return false;for(r=0;r<e;r++)if(this.enabled[r]!=t.enabled[r])return false;e=this.selected.length;if(t.selected.length!=e)return false;for(r=0;r<e;r++)if(this.selected[r]!=t.selected[r])return false;return true};e()};tc.ClsTlbCustId=function(){this.InUse=false;this.id=0;this.image=null;this.line=0;this.pBalloon="";this.CmdId=0};tc.ClsImageMap=function(){this.name="";this.TotalRects=0;this.pMapRect=[]};tc.ClsGlbPrtDC=function(){this.UseCount=0;this.hDC=0;this.name="";this.drv="";this.port=""};tc.ClsGlbFont=function(){this.UseCount=0;this.font=new tc.Font;this.hFont=0;this.hDC=0;this.IsScrDC=false;this.met=null};tc.ClsInstFont=function(){this.UseCount=0;this.font=new tc.Font;this.hFont=0;this.hDC=0;this.IsScrDC=false};tc.ClsWinPtr=function(){this.InUse=false;this.hWnd=0;this.e=null};tc.ClsMergeData=function(){this.pName="";this.pData="";var e=this;function t(){return Object.seal(e)}this.init=function(){return e};this.copy=function(){var t=new tc.ClsMergeData;tc.clone2(e,t);return t};t()};tc.ClsTextBuf=function(){this.pBuf=[];this.lead=[];this.pFmt=[];this.len=0;this.index=0;this.eof=false;this.eol=false;this.CrFound=false;this.MaxLineLen=0;this.ParaCharFound=false;this.IsLatin=false};tc.ClsEnumFonts=function(){this.GetMultiple=false;this.EnumTypeFace=false;this.result=false;this.CharSet=0;this.PitchAndFamily=0;this.TypeCount=0;this.TypeNames=[];this.PointCount=0;this.height=[];this.TrueType=false};tc.ClsDlgParam=function(){this.data=[]};tc.ClsMetaFileHdr=function(){this.sign=0;this.hmf=0;this.left=0;this.top=0;this.right=0;this.bottom=0;this.UnitsPerInch=0;this.reserved=0;this.CheckSum=0};tc.ClsComponent=function(){this.CtlClass="";this.style=0;this.id=0};tc.ClsForm=function(){this.CtlClass="";this.style=0;this.id=0;this.TextType=0;this.CheckBoxType=0;this.IsProtected=false;this.MaxLen=0;this.CheckBoxSize=0;this.name="";this.InitText="";this.InitNum=0;this.typeface="";this.family="";this.TwipsSize=0;this.FontStyle=0;this.CharSet=0;this.TextColor=new tc.Color;this.TextBkColor=new tc.Color;this.FontId=0;this.flags=0;this.ListCount=0;this.ListItems="";this.border=false;var e=this;function t(){return Object.seal(e)}this.init=function(){return e};this.copy=function(){var t=new tc.ClsForm;tc.clone2(e,t);return t};t()};tc.ClsRtfTableLevel=function(){this.CurRowId=0;this.CurCellId=0;this.LastCellX=0;this.OpenRowId=0;this.OpenCellId=0;this.OpenLastCellX=0;this.level=0;this.InitTblCol=0;this.PastingColumn=false};tc.ClsRtf=function(){this.iFile=null;this.buf=[];this.BufLen=0;this.BufIndex=0;this.OutBuf="";this.OutBufLen=0;this.OutBufHasUnicode=false;this.HasIncompleteAsianChar=false;this.text=[];this.TextLen=0;this.TextIndex=0;this.CurChar="";this.HdrFtrChar="";this.stack=[];this.StackLen=0;this.CurWord="";this.CurHash=0;this.WordHasHex=false;this.WordLen=0;this.GroupBegin=false;this.PrevGroupBegin=false;this.GroupEnd=false;this.IsControlWord=false;this.IgnoreText=false;this.SubEntry=false;this.eof=false;this.IgnoreCrLfInControlWord=false;this.param="";this.IntParam=0;this.GroupLevel=0;this.InstGroup=0;this.group=[];this.TotalColors=0;this.InitialCell=0;this.InitialParaFID=0;this.OpenRowId=0;this.OpenCellId=0;this.OpenLastCellX=0;this.SetWidowOrphan=false;this.TopColorGroup=0;this.StoryIds="";this.StoryId=0;this.PictWidth=0;this.PictHeight=0;this.flags=0;this.flags1=0;this.flags2=0;this.sect=new tc.ClsSect;this.SectColNo=0;this.PaperWidth=0;this.PaperHeight=0;this.ApplyPaperSize=false;this.FirstLine=0;this.FirstLineParaId=0;this.FootnoteNo=0;this.EndnoteNo=0;this.InsLine=0;this.InitSect=0;this.InitTblCol=0;this.InsertBefCell=0;this.InsertAftCell=0;this.TextBoxBefCell=0;this.PrevCellX=0;this.OrigPrevCellX=0;this.SomeTextRead=false;this.TableRead=false;this.TableTextFound=false;this.SuspendReading=false;this.PastingColumn=false;this.EmbedTable=false;this.EmptyDoc=false;this.CurTabType=0;this.CurTabFlags=0;this.FirstAnimPict=0;this.PrevChar="";this.ShpGroup=0;this.TagId=0;this.pict=0;this.InitFieldId=0;this.InitStyle=0;this.InitAuxId=0;this.lang=0;this.FieldName="";this.FieldCode="";this.FieldAuxId=0;this.PrevField=0;this.TextFieldLen=0;this.TblLevel=[];this.CurTblLevel=0;this.TableInFrame=false;this.XlateLs=[];this.XlateLs2=[];this.XlateLsOr2=[];this.TotalXlateLs2=0;this.DocFlow=0;this.SectFlow=0;this.CellFlow=0;this.ProtExId=0;this.PictFID=0;this.PictFrameLine=0;this.PictFrameCol=0;this.FilePos=0;this.mac=false;this.EnableTracking=false;this.ListRead=false;this.SectGroup=0;this.TextBoxParaFID=0;this.TextBoxParentFID=0;this.TextBoxParentCellId=0;this.TextBoxParentRowId=0;this.TextBoxParentInTable=false;this.TextBoxParentItapLevel=0;this.InTextBox=false;this.FirstTbLine=false;this.SkipSpaces=false;this.TeVersion=0;this.ExistingHdrFtr=false;this.InContainer=false;this.exp=new tc.ClsExp;this.MathGroup=0;this.InXml=false;this.TextLine=0;this.NameSpace="";this.NameSpaceLen=0;this.XmFlags=0;this.XmFile=0;this.file="";this.InputType=0;this.TypeFace="";this.TypeFaceDB="";this.TypeFaceHi="";this.TypeFaceCs="";this.font=[];this.TotalRtfFonts=0;this.MaxRtfFonts=0;this.style=[];this.TotalXmlStyles=0;this.MaxXmlStyles=0;this.rels=[];this.TotalXmlRels=0;this.MaxXmlRels=0;this.shape=[];this.TotalXmlShapeIds=0;this.MaxXmlShapeIds=0;this.FieldCount=0;this.InFieldResult=false;this.FieldId=0;this.FieldResultTextFound=false;this.FieldInstTextFound=false;this.FieldLocked=false;this.RtfList=new tc.ClsList;this.RtfListOr=new tc.ClsListOr;this.pListLevel=new tc.ClsListLevel;this.CurListLevel=0;this.TagMsgDisplayed=false;this.RtfPict=new tc.ClsRtfPict;this.OcxPictId=0;this.OcxName="";this.XmlInFile="";this.MajorFont=new tc.ClsXmlFont;this.MinorFont=new tc.ClsXmlFont;this.CurTblStyle=0;this.CurTblStyleItem=0;this.InTableDef=false;this.DocDefaultGroup=0;this.XmlBuf=[];this.SkipNode="";this.SkipNodeStack=0;this.InnerFile="";this.RelFile="";this.IgnoreFrames=false;this.DocParaProps=new tc.ClsPfmt;this.DocParaMask=0;this.OvrStoryRtfId=0;this.OptiCurWord=[];this.OptiLine=[];var e=this;function t(){return Object.seal(e)}this.init=function(){e.InitArray();return e};this.copy=function(){var t=new tc.ClsRtf;tc.clone2(e,t);return t};this.InitArray=function(){tc.FillArray(e.XlateLs,tc.MAX_RTF_LS,0);tc.FillArray(e.XlateLs2,tc.MAX_RTF_LS_BIG,0);tc.FillArray(e.XlateLsOr2,tc.MAX_RTF_LS_BIG,0);e.text=[tc.MAX_WIDTH+1];e.stack=[tc.MAX_WIDTH+1];e.OptiCurWord=[2*tc.MAX_WIDTH+1];e.OptiLine=[tc.MAX_WIDTH+1];e.DocParaProps=new tc.ClsPfmt};t()};tc.ClsZip=function(){this.sign=0;this.version=0;this.flags=0;this.method=0;this.time=0;this.date=0;this.crc=0;this.CmpSize=0;this.UncmpSize=0;this.FileNameLen=0;this.ExtraLen=0;this.i=0;this.size=this.length;this.buf=[this.size]};tc.ClsXmlScript=function(){this.script="";this.TypeFace=""};tc.ClsXmlFont=function(){this.TypeFace="";this.TypeFaceEA="";this.TypeFaceCS="";this.TotalScripts=0;this.MaxScripts=0;this.script=[]};tc.ClsXmlRels=function(){this.ResId="";this.target="";this.StoreItemId="";this.external=false;this.CustomXML=false};tc.ClsXmlStyle=function(){this.id="";this.name="";this.based="";this.link="";this.BaseId=0;this.next="";this.NextId=0;this.RtfLs=0};tc.ClsRtfFont=function(){this.InUse=false;this.FontId=0;this.CharSet=0;this.family="";this.name="";this.name2="";this.IsHiThemeFont=false;var e=this;function t(){return Object.seal(e)}this.init=function(){e.family=e.name=e.name2="";return e};this.copy=function(){var t=new tc.ClsRtfFont;tc.clone2(e,t);return t};t()};tc.ClsXmlShapeId=function(){this.PictId=0;this.ShapeId=""};tc.ClsXmlShape=function(){this.x=0;this.y=0;this.width=0;this.height=0;this.DistFromTextLeft=0;this.DistFromTextRight=0;this.DistFromTextTop=0;this.DistFromTextBot=0;this.BorderMargin=0;this.FirstLine=0;this.LastLine=0;this.IsInline=false;this.SimplePos=false;this.ZOrder=0;this.ShapeType=0;this.OrigShapeType=0;this.TypeFound=false;this.WrapSide=0;this.flags=0;this.flags2=0;this.LineWdth=0;this.LineColor=new tc.Color;this.BackColor=new tc.Color;this.FillPattern=0;this.canvas=0;this.count=0;this.ShapeId="";this.pic=new tc.ClsRtfPict;this.parent=0;this.CordX=0;this.CordY=0;this.CordWidth=0;this.CordHeight=0;this.AdjVal1=0;this.AdjVal2=0;this.IsWatermark=false;var e=this;function t(){return Object.seal(e)}this.init=function(){return e};this.copy=function(){var t=new tc.ClsXmlShape;tc.clone2(e,t);return t.init()};t()};tc.ClsRtfColor=function(){this.color=0;this.UsesThemeColor=false;var e=this;function t(){return Object.seal(e)}this.init=function(){return e};this.copy=function(){var t=new tc.ClsRtfColor;tc.clone2(e,t);return t};t()};tc.ClsRtfGroup=function(){this.ObjType="ClsRtfGroup";this.rtf=null;this.font=[];this.MaxRtfFonts=0;this.color=[];this.TotalRtfColors=0;this.RtfSID=[];this.MaxRtfSID=0;this.RtfGroup=0;this.FieldGroup=0;this.DefFont=0;this.FontFamily="";this.TypeFace="";this.CharSet=0;this.FontFamilyDB="";this.TypeFaceDB="";this.CharSetDB=0;this.FontFamilyHi="";this.TypeFaceHi="";this.CharSetHi=0;this.rtlch=false;this.CharFlow=0;this.SaRun=false;this.PrevCharSet=0;this.StoryIds="";this.PointSize2=0;this.LtrchPointSize2=0;this.TextColor=new tc.Color;this.TextColorUsesThemeColor=false;this.TextBkColor=new tc.Color;this.UlineColor=new tc.Color;this.HilightColor=new tc.Color;this.style=0;this.StyleOff=0;this.LtrchStyle=0;this.LtrchStyleOff=0;this.LtrchStyleMask=0;this.CharStyId=0;this.FieldId=0;this.PictId=0;this.IncludePictId=0;this.AuxId=0;this.CharId=0;this.CharType=0;this.expand=0;this.CharScaleX=0;this.lang=0;this.offset=0;this.caps=false;this.CharBorderWidth=0;this.EndnoteMarker="";this.StyleMask=0;this.CharMask=0;this.UseAsianTextFont=0;this.LeftIndent=0;this.RightIndent=0;this.LeftIndentFlow=0;this.RightIndentFlow=0;this.FirstIndent=0;this.LeftIndentNoList=0;this.FirstIndentNoList=0;this.flags=0;this.pflags=0;this.tab=new tc.TejTab;this.blt=new tc.ClsBlt;this.ParShading=0;this.SpaceBefore=0;this.SpaceAfter=0;this.SpaceBetween=0;this.OutlineLevel=0;this.LineSpacing=0;this.ParaStyId=0;this.ParaBkColor=new tc.Color;this.ParaBorderColor=new tc.Color;this.flow=0;this.CellFlags=0;this.NextStyId=0;this.ParaAuxId=0;this.ParaGroup=0;this.TextVAlign=0;this.InTable=false;this.RowColStyle=false;this.RowBand=0;this.BorderType=0;this.BorderWidth=[];this.BorderSpace=[];this.BorderColor=[];this.BorderMargin=0;this.CellShading=0;this.CellMargin=0;this.CellColSpan=0;this.CellPatFC=new tc.Color;this.CellPatBC=new tc.Color;this.clwWidth=0;this.clftsWidth=0;this.ClLeftPad=0;this.ClRightPad=0;this.ClTopPad=0;this.ClBotPad=0;this.ClPadFlags=0;this.CellBorderType=0;this.TblInd=0;this.TblIndType=0;this.RowSpaceBefType=0;this.RowSpaceBef=0;this.ParaFrameInfo=new tc.ClsRtfParaFrameInfo;this.FrmFlags=0;this.FrmFlags2=0;this.TextBoxMargin=0;this.TextBoxTopMarg=0;this.TextBoxBotMarg=0;this.ParaFID=0;this.TextAngle=0;this.gflags=0;this.gflags2=0;this.ControlWord="";this.IgnoreText=false;this.ControlCount=0;this.sect=new tc.ClsSect;this.AnimLoops=0;this.AnimDelay=0;this.LinkPictWidth=0;this.LinkPictHeight=0;this.shape=new tc.ClsShape;this.ShpGrp=new tc.ClsShpGrp;this.level=0;this.RtfLs=0;this.ListLvl=0;this.CharBkPat=0;this.CharPatFC=new tc.Color;this.CharPatBC=new tc.Color;this.IgnoreCount=0;this.UcIgnoreCount=0;this.HPageGroup=0;this.FieldLevel=0;this.FieldInstLevel=0;this.DpGroupCount=0;this.DpGroupX=[];this.DpGroupY=[];this.InsRev=0;this.InsTime=new tc.ClsDate;this.DelRev=0;this.DelTime=new tc.ClsDate;this.FmtRev=0;this.FmtTime=new tc.ClsDate;this.FmtOrigFont=0;this.revised=false;this.deleted=false;this.FontChanged=false;this.ParaChanged=false;this.ParaFmtRev=0;this.ParaFmtTime=new tc.ClsDate;this.FmtOrigPara=0;this.ShapeId=0;this.ExpId=0;this.XmgFlags=0;this.XmgFlags2=0;this.FontFamilyCs="";this.TypeFaceCs="";this.CharSetCs=0;this.ParaFontId=0;this.PrevParaFontId=0;this.ParaMask=0;this.ParaMask2=0;this.XmlShape=new tc.ClsXmlShape;this.ShapeGroup=0;this.TblGroup=0;this.RowId=0;this.PrevRow=0;this.row=new tc.ClsTableRow;this.CellId=0;this.PrevCell=0;this.PrevCellX=0;this.GridColWidth=[];this.TotalGridColWidth=0;this.MaxGridColWidth=0;this.CurGridCol=0;this.CellLevel=0;this.ParentCell=0;this.RowSpan=0;this.ColSpan=0;this.CellMask=0;this.RowMask=0;this.CellBorder=0;this.CurTblStyle=0;this.NoteTextStyle=0;this.NoteId="";this.InFNoteId=false;this.SaveCellId=0;this.SaveRowId=0;this.SaveLastCellX=0;this.SaveTblLevel=0;this.SaveInTable=false;this.pSdtText="";this.SdtTextLen=0;this.SdtLevel=0;this.SdtFontId=0;this.RowGroup=0;this.ShpgrpId=0;var f=this;function t(){return Object.seal(f)}this.init=function(){f.tab=new tc.TejTab;f.blt=new tc.ClsBlt;f.ParaFrameInfo=new tc.ClsRtfParaFrameInfo;f.shape=new tc.ClsShape;f.ShpGrp=new tc.ClsShpGrp;f.InsTime=new tc.ClsDate;f.DelTime=new tc.ClsDate;f.FmtTime=new tc.ClsDate;f.ParaFmtTime=new tc.ClsDate;f.XmlShape=new tc.ClsXmlShape;f.row=new tc.ClsTableRow;tc.FillArray(f.BorderWidth,tc.MAX_BORDERS,0);tc.FillArray(f.BorderSpace,tc.MAX_BORDERS,0);tc.FillArray(f.BorderColor,tc.MAX_BORDERS,0);tc.FillArray(f.DpGroupX,tc.MAX_DP_GROUPS,0);tc.FillArray(f.DpGroupY,tc.MAX_DP_GROUPS,0);f.ClLeftPad=f.ClRightPad=f.ClTopPad=f.ClBotPad=-1;f.tab=new tc.TejTab;f.tab.SetSize(0);return f};this.copy=function(){var t=new tc.ClsRtfGroup;var e=f.rtf;f.rtf=null;tc.clone2(f,t);f.rtf=e;t.rtf=e;if(false){t.init();var r,i;if(f.BorderWidth&&(i=f.BorderWidth.length)>0){for(r=0;r<i;r++)t.BorderWidth[r]=f.BorderWidth[r]}if(f.BorderSpace&&(i=f.BorderSpace.length)>0){for(r=0;r<i;r++)t.BorderSpace[r]=f.BorderSpace[r]}if(f.BorderColor&&(i=f.BorderColor.length)>0){for(r=0;r<i;r++)t.BorderColor[r]=f.BorderColor[r]}if(f.DpGroupX&&(i=f.DpGroupX.length)>0){for(r=0;r<i;r++)t.DpGroupX[r]=f.DpGroupX[r]}if(f.DpGroupY&&(i=f.DpGroupY.length)>0){for(r=0;r<i;r++)t.DpGroupY[r]=f.DpGroupY[r]}if(f.GridColWidth&&(i=f.GridColWidth.length)>0){t.GridColWidth=[i];for(r=0;r<i;r++)t.GridColWidth[r]=f.GridColWidth[r]}}if(f.tab)t.tab=f.tab.copy();if(f.blt)t.blt=f.blt.copy();if(f.row)t.row=f.row.copy();if(f.XmlShape)t.XmlShape=f.XmlShape.copy();if(f.sect)t.sect=f.sect.copy();if(f.ParaFrameInfo)t.ParaFrameInfo=f.ParaFrameInfo.copy();if(f.shape)t.shape=f.shape.copy();if(f.ShpGrp)t.ShpGrp=f.ShpGrp.copy();if(f.InsTime)t.InsTime=f.InsTime.copy();if(f.DelTime)t.DelTime=f.DelTime.copy();if(f.FmtTime)t.FmtTime=f.FmtTime.copy();if(f.ParaFmtTime)t.ParaFmtTime=f.ParaFmtTime.copy();return t};t()};tc.CopyClsRtfGroup=function(t){var e=0;var r=t.rtf;t.rtf=null;var f=JSON.parse(JSON.stringify(t));t.rtf=r;f.rtf=r;if(t.BorderColor&&(e=t.BorderColor.length)>0){for(i=0;i<e;i++)f.BorderColor[i]=t.BorderColor[i].copy()}if(t.color&&(e=t.color.length)>0){for(i=0;i<e;i++)f.color[i]=t.color[i].copy()}if(t.TextColor!=null)f.TextColor=t.TextColor.copy();if(t.TextBkColor!=null)f.TextBkColor=t.TextBkColor.copy();if(t.UlineColor!=null)f.UlineColor=t.UlineColor.copy();if(t.HilightColor!=null)f.HilightColor=t.HilightColor.copy();if(t.ParaBkColor!=null)f.ParaBkColor=t.ParaBkColor.copy();if(t.ParaBorderColor!=null)f.ParaBorderColor=t.ParaBorderColor.copy();if(t.CharPatFC!=null)f.CharPatFC=t.CharPatFC.copy();if(t.CharPatBC!=null)f.CharPatBC=t.CharPatBC.copy();if(t.CellPatFC!=null)f.CellPatFC=t.CellPatFC.copy();if(t.CellPatBC!=null)f.CellPatBC=t.CellPatBC.copy();this.CharPatFC=0;this.CharPatBC=0;if(t.tab)f.tab=t.tab.copy();if(t.blt)f.blt=t.blt.copy();if(t.row)f.row=t.row.copy();if(t.XmlShape)f.XmlShape=t.XmlShape.copy();if(t.sect)f.sect=t.sect.copy();if(t.ParaFrameInfo)f.ParaFrameInfo=t.ParaFrameInfo.copy();if(t.shape)f.shape=t.shape.copy();if(t.ShpGrp)f.ShpGrp=t.ShpGrp.copy();if(t.InsTime)f.InsTime=t.InsTime.copy();if(t.DelTime)f.DelTime=t.DelTime.copy();if(t.FmtTime)f.FmtTime=t.FmtTime.copy();if(t.ParaFmtTime)f.ParaFmtTime=t.ParaFmtTime.copy();return f};tc.FillArray=function(t,e,r){if(t.fill==undefined){var i;for(i=0;i<e;i++)t[i]=r}else{t.length=e;t.fill(r)}};tc.ClsRtfPict=function(){this.type=0;this.MetaType=0;this.ImageType=0;this.data="";this.DataSize=0;this.image=null;this.icon=null;this.OrigHeight=0;this.OrigWidth=0;this.height=0;this.width=0;this.CropLeft=0;this.CropRight=0;this.CropTop=0;this.CropBot=0;this.ScaleX=0;this.ScaleY=0;this.PictType=0;this.OrigPictType=0;this.align=0;this.PictId=0;this.BitsPerPixel=0;this.planes=0;this.WidthBytes=0;this.FormId=0;this.form=new tc.ClsForm;this.IsHRule=false;this.hMeta=0;this.pMem=0;var e=this;function t(){return Object.seal(e)}this.init=function(){return e};this.copy=function(){var t=new tc.ClsRtfPict;tc.clone2(e,t);return t};t()};tc.ClsRtfObject=function(){this.ObjectType=0;this.data=[];this.ObjectSize=0;this.ObjectAspect=0;this.ObjectUpdate=false;this.pict=0};tc.ClsRtfOut=function(){this.output=0;this.oFile=null;this.buf=[];this.BufLen=0;this.BufIndex=0;this.text=[];this.TextLen=0;this.SpacePending=false;this.WritingControl=false;this.color=[];this.TotalColors=0;this.GroupLevel=0;this.group=[];this.flags=0;this.sect=0;this.TblHilight=false;this.XlateLs=[];this.FieldHasPara=false;this.ParaFmtOnParaEnd=false;this.WatermarkWritten=0;this.line=0;this.DelRevCount=0;this.PrevPfmt=0;this.PrevCell=0;this.PrevFID=0;this.PrevProtExId=0};tc.ClsRtfOutGroup=function(){this.FontId=0;this.style=0;this.FieldId=0;this.FieldCode="";this.flags=0};tc.ClsCharFont=function(){this.typeface=[];this.CharSet=[];this.lang=[]};tc.Paper=function(){this.width=0;this.height=0;var e=this;function t(){return Object.seal(e)}this.init=function(){return e};this.copy=function(){var t=new tc.Font;tc.clone2(e,t);return t};this.setSize=function(t,e){width=t;height=e};t()};tc.JMenu=function(){this.ObjType="JMenu";this.x=0;this.margin=0;this.width=0;this.title="";this.id=0;this.MouseOver=false;this.item=[];this.IsToolbarMenu=false;var e=this;function t(){return Object.seal(e)}this.init=function(){return e};this.copy=function(){var t=new tc.JMenu;tc.clone2(e,t);return t};t()};tc.JMenuItem=function(t){this.ObjType="JMenuItem";this.y=0;this.xmargin=0;this.ymargin=0;this.height=0;this.width=0;this.title=t;this.KeyText="";this.KeyTextWidth=0;this.CmdId=0;this.MouseOver=false;this.IsSepLine=false;this.HasSubMenu=false;this.IsGrayed=false;this.IsChecked=false;this.IsToolbarMenu=false;this.item=[];var e=this;function r(){return Object.seal(e)}this.init=function(){return e};this.copy=function(){var t=new tc.JMenuItem;tc.clone2(e,t);return t};r()};tc.ClsSubMenu=function(){this.ObjType="ClsSubMenu";this.x=0;this.y=0;this.width=0;this.height=0;this.level=0;this.item=[];this.IsContextMenu=false;this.MouseEntered=false;this.div=null;this.canvas=null;this.gr=null;var e=this;function t(){return Object.seal(e)}this.init=function(){return e};this.copy=function(){var t=new tc.ClsSubMenu;tc.clone2(e,t);return t};t()};tc.Font=function(t,e,r){if(t==undefined)t="Arial";if(e==undefined)e=0;if(r==undefined)r=12;this.typeface=t;this.style=e;this.PixSize=r;this.FontString="";if(this.style&tc.ITALIC)this.FontString+="Italic ";if(this.style&tc.BOLD)this.FontString+="Bold ";if(this.style&tc.SCAPS)this.FontString+="Small-caps ";this.CssFontString=this.FontString;this.FontString+=this.PixSize.toString()+"px '"+this.typeface+"'";var i=this;function f(){return Object.seal(i)}this.init=function(){return i};this.copy=function(){var t=new tc.Font;tc.clone2(i,t);return t};this.equals=function(t){return i.FontString==t.FontString};this.canDisplay=function(t){return true};this.GetCssFontString=function(t){var e="";if(this.style&tc.ITALIC)e+="Italic ";if(this.style&tc.BOLD)e+="Bold ";if(this.style&tc.SCAPS)e+="Small-caps ";this.CssFontString=e+(t.TerDeviceToCss(this.PixSize).toString()+"px '"+this.typeface+"'");return this.CssFontString};f()};tc.ClsFont=function(){this.gr=null;this.font=new tc.Font;this.hFont=0;this.GlbFontId=0;this.TypeFace="";this.FontFamily=0;this.family="";this.CharSet=0;this.TwipsSize=0;this.TextColor=new tc.Color;this.TextBkColor=new tc.Color;this.UlineColor=new tc.Color;this.WlineColor=new tc.Color;this.HilightColor=new tc.Color;this.CharStyId=0;this.ParaStyId=0;this.expand=0;this.lang=0;this.offset=0;this.OffsetVal=0;this.FieldCode="";this.TextAngle=0;this.ScaleX=0;this.ObjectType=0;this.ObjectSize=0;this.OleNotice=0;this.ObjectAspect=0;this.ObjectUpdate=false;this.ctl=null;this.PictType=0;this.MetaType=0;this.ImageType=0;this.hMeta=0;this.image=null;this.icon=null;this.BlurImage=null;this.PictFile="";this.form=new tc.ClsForm;this.bmHeight=0;this.bmWidth=0;this.PictHeight=0;this.PictWidth=0;this.ColorsUsed=0;this.PictAlign=0;this.FrameType=0;this.ParaFID=0;this.PictX=0;this.PictY=0;this.rgb=[];this.LinkFile="";this.PictAlt="";this.TotalRgbs=0;this.PctWidth=0;this.PctHeight=0;this.anim=new tc.ClsAnim;this.DispFrame=0;this.MapId=0;this.PictData="";this.CropLeft=0;this.CropRight=0;this.CropTop=0;this.CropBot=0;this.CropLeftFixed=0;this.CropRightFixed=0;this.CropTopFixed=0;this.CropBotFixed=0;this.OrigPictWidth=0;this.OrigPictHeight=0;this.OrigPictType=0;this.pMem=0;this.InCellId=0;this.InParaFID=0;this.InLine=0;this.InFrame=0;this.ImageAttr=null;this.PictXparent=false;this.PictXparentColor=new tc.Color;this.rotation=0;this.ExpId=0;this.InsRev=0;this.InsTime=new tc.ClsDate;this.DelRev=0;this.DelTime=new tc.ClsDate;this.FmtRev=0;this.FmtTime=new tc.ClsDate;this.FmtOrigFont=0;this.height=0;this.BaseHeight=0;this.BaseHeightAdj=0;this.YAdj=0;this.style=0;this.TempStyle=0;this.InUse=false;this.CharWidth=[];this.MetCharWidth=[];this.FieldId=0;this.AuxId=0;this.Aux1Id=0;this.flags=0;this.ExtLead=0;this.RtfIndex=0;this.hidden=new tc.ClsHdnFont;this.VarWidth=false;this.rtl=false;this.CharId=0;this.rtlch=false;this.flow=0;this.UcBase="";this.StoryIds="";this.ProtExId=0;var e=this;function t(){return Object.seal(e)}this.init=function(){return e};this.copy=function(){var t=new tc.ClsFont;tc.clone2(e,t);return t};this.ShallowCopy=function(){return e.copy()};t()};tc.ClsPrtFont=function(){this.gr=null;this.font=new tc.Font;this.hFont=0;this.GlbFontId=0;this.height=0;this.BaseHeight=0;this.BaseHeightAdj=0;this.YAdj=0;this.CharWidth=[];this.MetCharWidth=[];this.ExtLead=0;this.OffsetVal=0;this.hidden=new tc.ClsHdnFont;var e=this;function t(){return Object.seal(e)}this.init=function(){return e};this.copy=function(){var t=new tc.ClsPrtFont;tc.clone2(e,t);return t};this.ShallowCopy=function(){return e.copy()};t()};tc.ClsExtFont=function(){this.InUse=false;this.typeface="";this.url="";this.options=""};tc.ClsPdfParaInfo=function(){this.sign=[];this.LeftIndent=0;this.RightIndent=0;this.FirstIndent=0;this.flags=0;this.pflags=0;this.SpaceBefore=0;this.SpaceAfter=0;this.SpaceBetween=0;this.flow=0;this.BkColor=new tc.Color;this.BorderColor=new tc.Color;this.reserved=[];var e=this;function t(){return Object.seal(e)}this.init=function(){e.sign=[2];e.sign[0]="P".charCodeAt(0);e.sign[1]="I".charCodeAt(0);e.reserved=[40];for(var t=0;t<40;t++)e.reserved[t]=0;return e};this.copy=function(){var t=new tc.ClsPdfParaInfo;tc.clone2(e,t);return t};t()};tc.ClsPdfBkm=function(){this.sign=[];this.level=0;this.page=0;this.y=0;this.name=""};tc.ClsPdfHlink=function(){this.sign=[];this.page=0;this.x=0;this.y=0;this.width=0;this.height=0;this.type=0;this.obj=0;this.url=""};tc.Point=function(t,e){if(typeof t=="object"&&t.ObjType=="Point"){e=t.y;t=t.x}else{if(typeof t!="number")t=0;if(typeof e!="number")e=0}this.ObjType="Point";this.x=t;this.y=e;var r=this;function i(){return Object.seal(r)}this.init=function(){return r};this.copy=function(){var t=new tc.Point;tc.clone2(r,t);return t};i()};tc.OP_POINT=function(t,e){if(typeof t!="number")t=0;if(typeof e!="number")e=0;this.ObjType="OP_POINT";this.x=t;this.y=e;var r=this;function i(){return Object.seal(r)}this.init=function(){return r};this.copy=function(){var t=new tc.OP_POINT;tc.clone2(r,t);return t};i()};tc.Pen=function(t,e){this.ObjType="Pen";this.thick=0;this.color=tc.Color.black;this.DottedLine=false;this.LightDottedLine=false;this.DarkDottedLine=false;this.StartCapRound=false;this.EndCapRound=false;if(typeof t=="number"){this.thick=t;if(typeof e=="object"&&e.ObjType=="Color")this.color=e}else if(t!=null&&typeof t=="object"&&t.ObjType=="Color"){this.color=t;if(typeof e=="number")this.thick=e}var r=this;function i(){return Object.seal(r)}this.init=function(){return r};this.copy=function(){var t=new tc.Pen;tc.clone2(r,t);return t};this.setDotted=function(){r.DottedLine=true;return r};this.setLightDotted=function(){r.LightDottedLine=true;return r};this.setDarkDotted=function(){r.DarkDottedLine=true;return r};this.setStartCapRound=function(){r.StartCapRound=true;return r};this.setEndCapRound=function(){r.EndCapRound=true;return r};this.setStartCapRound=function(t){r.StartCapRound=t;return r};this.setEndCapRound=function(t){r.EndCapRound=t;return r};this.Dispose=function(){};i()};tc.Brush=function(t){if(t==undefined)t=tc.Color.black;this.ObjType="Brush";this.color=t;var e=this;function r(){return Object.seal(e)}this.init=function(){return e};this.copy=function(){var t=new tc.Brush;tc.clone2(e,t);return t};this.Dispose=function(){};r()};tc.RECT=function(t,e,r,i){this.ObjType="RECT";this.left=0;this.top=0;this.right=0;this.bottom=0;var f=arguments.length;if(f==4){this.left=t;this.top=e;this.right=t+r;this.bottom=e+i}else if(f==2){this.right=t;this.bottom=e}var l=this;function a(){return Object.seal(l)}this.init=function(){return l};this.adjust=function(t,e){l.left+=t;l.right+=t;l.top+=e;l.bottom+=e};this.copy=function(){var t=new tc.RECT;t.left=l.left;t.right=l.right;t.top=l.top;t.bottom=l.bottom;return t};this.toString=function(){return tc.toString("l/r:",l.left,l.right,", t/b:",l.top,l.bottom)};if(tc.seal)a()};tc.Rectangle=function(t,e,r,i){this.ObjType="Recangle";this.left=t;this.top=e;this.width=r;this.height=i;var f=this;function l(){return Object.seal(f)}this.init=function(){return f};this.copy=function(){var t=new tc.Rectangle;tc.clone2(f,t);return t};this.widthHeight=function(t,e){f.left=0;f.top=0;f.width=t;f.height=e;return f};this.right=function(){return f.left+f.width};this.bottom=function(){return f.top+f.height};this.toString=function(){return tc.toString("l/t:",f.left,f.top,", w/h:",f.width,f.height)};if(tc.seal)l()};tc.SIZE=function(t,e){if(typeof t!="number")t=0;if(typeof e!="number")e=0;this.ObjType="SIZE";this.cx=t;this.cy=e;var r=this;function i(){return Object.seal(r)}this.init=function(){return r};this.copy=function(){var t=new tc.SIZE;tc.clone2(r,t);return t};i()};tc.ClsBox=function(t,e,r,i){this.item=t;this.value=e;this.TextValue=r;this.ObjectValue=i;var f=this;this.toString=function(){return f.item};function l(){return Object.seal(f)}l()};tc.ClsClipInfo=function(){this.size=0;this.TblLevel=0;this.EmbTable=false;this.CellsCopied=0;this.RowsCopied=0;this.RowsInCol=0;var e=this;function t(){return Object.seal(e)}this.copy=function(){var t=new tc.ClsClipInfo;tc.clone2(e,t);return t};this.toString=function(){var t=[];t.push(this.size);t.push(this.TblLevel);t.push(this.EmbTable);t.push(this.CellsCopied);t.push(this.RowsCopied);t.push(this.RowsInCol);return t.join()};this.fromString=function(t){var e=new tc.ClsClipInfo;var r=t.split();e.size=parseInt(r[0]);e.TblLevel=parseInt(r[1]);e.EmbTable=r[2]=="true"||r[2]=="TRUE"||r[2]=="yes"||r[2]=="Yes"||r[2]=="1";e.CellsCopied=parseInt(r[3]);e.RowsCopied=parseInt(r[4]);e.RowsInCol=parseInt(r[5]);return e};t()};tc.toString=function(){var t=arguments.length;var e="";for(var r=0;r<t;r++){var i=arguments[r]+" ";e+=i}return e};tc.ETO_OPAQUE=2;tc.ETO_CLIPPED=4;tc.ETO_GLYPH_INDEX=16;tc.ETO_RTLREADING=128;tc.MF_ENABLED=0;tc.MF_GRAYED=1;tc.MF_DISABLED=2;tc.MF_UNCHECKED=0;tc.MF_CHECKED=8;tc.DT_TOP=0;tc.DT_LEFT=0;tc.DT_CENTER=1;tc.DT_RIGHT=2;tc.DT_VCENTER=4;tc.DT_BOTTOM=8;tc.DT_WORDBREAK=16;tc.DT_SINGLELINE=32;tc.DT_EXPANDTABS=64;tc.DT_TABSTOP=128;tc.DT_NOCLIP=256;tc.DT_EXTERNALLEADING=512;tc.DT_CALCRECT=1024;tc.DT_NOPREFIX=2048;tc.DT_INTERNAL=4096;tc.DT_EDITCONTROL=8192;tc.DT_PATH_ELLIPSIS=16384;tc.DT_END_ELLIPSIS=32768;tc.DT_MODIFYSTRING=65536;tc.DT_RTLREADING=131072;tc.DT_WORD_ELLIPSIS=262144;tc.MM_TWIPS=6;tc.MM_ISOTROPIC=7;tc.MM_ANISOTROPIC=8;tc.GETPRINTINGOFFSET=13;tc.FF_DONTCARE=0<<4;tc.FF_ROMAN=1<<4;tc.FF_SWISS=2<<4;tc.FF_MODERN=3<<4;tc.FF_SCRIPT=4<<4;tc.FF_DECORATIVE=5<<4;tc.MAC_CHARSET=77;tc.BALTIC_CHARSET=186;tc.JOHAB_CHARSET=130;tc.CHINESEBIG5_CHARSET=136;tc.EASTEUROPE_CHARSET=238;tc.GB2312_CHARSET=134;tc.GREEK_CHARSET=161;tc.HANGUL_CHARSET=129;tc.OEM_CHARSET=255;tc.RUSSIAN_CHARSET=204;tc.SHIFTJIS_CHARSET=128;tc.TURKISH_CHARSET=162;tc.VIETNAMESE_CHARSET=163;tc.HEBREW_CHARSET=177;tc.ARABIC_CHARSET=178;tc.THAI_CHARSET=222;tc.LANG_ENG=1033;tc.LANG_es_ES=2058;tc.LANG_ru_RU=1049;tc.LANG_ar_SA=1025;tc.WS_OVERLAPPED=0;tc.WS_POPUP=2147483648;tc.WS_CHILD=1073741824;tc.WS_MINIMIZE=536870912;tc.WS_VISIBLE=268435456;tc.WS_DISABLED=134217728;tc.WS_CLIPSIBLINGS=67108864;tc.WS_CLIPCHILDREN=33554432;tc.WS_MAXIMIZE=16777216;tc.WS_CAPTION=12582912;tc.WS_BORDER=8388608;tc.WS_DLGFRAME=4194304;tc.WS_VSCROLL=2097152;tc.WS_HSCROLL=1048576;tc.WS_SYSMENU=524288;tc.WS_THICKFRAME=262144;tc.WS_GROUP=131072;tc.WS_TABSTOP=65536;tc.WS_MINIMIZEBOX=131072;tc.WS_MAXIMIZEBOX=65536;tc.WS_EX_CLIENTEDGE=512;tc.SWP_NOSIZE=1;tc.SWP_NOMOVE=2;tc.SWP_NOZORDER=4;tc.SWP_NOREDRAW=8;tc.SWP_NOACTIVATE=16;tc.SWP_FRAMECHANGED=32;tc.SWP_SHOWWINDOW=64;tc.SWP_HIDEWINDOW=128;tc.SWP_NOCOPYBITS=256;tc.SWP_NOOWNERZORDER=512;tc.SWP_NOSENDCHANGING=1024;tc.SWP_DRAWFRAME=tc.SWP_FRAMECHANGED;tc.GWL_STYLE=-16;tc.GWL_EXSTYLE=-20;tc.GWL_USERDATA=-21;tc.GWL_ID=-12;tc.MAX_DEFAULTCHAR=2;tc.MAX_LEADBYTES=12;tc.MB_PRECOMPOSED=1;tc.MB_COMPOSITE=2;tc.MB_USEGLYPHCHARS=4;tc.PS_SOLID=0;tc.PS_DASH=1;tc.PS_DOT=2;tc.PS_DASHDOT=3;tc.PS_DASHDOTDOT=4;tc.PS_ENDCAP_ROUND=0;tc.PS_ENDCAP_SQUARE=256;tc.PS_ENDCAP_FLAT=512;tc.PS_ENDCAP_MASK=3840;tc.PS_JOIN_ROUND=0;tc.PS_JOIN_BEVEL=4096;tc.PS_JOIN_MITER=8192;tc.PS_JOIN_MASK=61440;tc.PS_COSMETIC=0;tc.PS_GEOMETRIC=65536;tc.PS_TYPE_MASK=983040;tc.BS_SOLID=0;tc.BS_NULL=1;tc.BS_HOLLOW=tc.BS_NULL;tc.BS_HATCHED=2;tc.BS_PATTERN=3;tc.BS_INDEXED=4;tc.BS_DIBPATTERN=5;tc.BS_DIBPATTERNPT=6;tc.BS_PATTERN8X8=7;tc.BS_DIBPATTERN8X8=8;tc.BS_MONOPATTERN=9;tc.HS_HORIZONTAL=0;tc.HS_VERTICAL=1;tc.HS_FDIAGONAL=2;tc.HS_BDIAGONAL=3;tc.HS_CROSS=4;tc.HS_DIAGCROSS=5;tc.NULL_BRUSH=5;tc.NULL_PEN=8;tc.SYSTEM_FONT=13;tc.TRANSPARENT=1;tc.OPAQUE=2;tc.DT_RASDISPLAY=1;tc.DT_RASPRINTER=2;tc.DT_METAFILE=5;tc.TECHNOLOGY=2;tc.VERTSIZE=6;tc.HORZRES=8;tc.VERTRES=10;tc.BITSPIXEL=12;tc.ASPECTX=40;tc.ASPECTY=42;tc.ASPECTXY=44;tc.LOGPIXELSX=88;tc.LOGPIXELSY=90;tc.DMPAPER_LETTER=1;tc.DMPAPER_LETTERSMALL=2;tc.DMPAPER_TABLOID=3;tc.DMPAPER_LEDGER=4;tc.DMPAPER_LEGAL=5;tc.DMPAPER_STATEMENT=6;tc.DMPAPER_EXECUTIVE=7;tc.DMPAPER_A3=8;tc.DMPAPER_A4=9;tc.DMPAPER_A4SMALL=10;tc.DMPAPER_A5=11;tc.DMPAPER_B4=12;tc.DMPAPER_B5=13;tc.DMPAPER_FOLIO=14;tc.DMPAPER_QUARTO=15;tc.DMPAPER_10X14=16;tc.DMPAPER_11X17=17;tc.DMPAPER_NOTE=18;tc.DMPAPER_ENV_9=19;tc.DMPAPER_ENV_10=20;tc.DMPAPER_ENV_11=21;tc.DMPAPER_ENV_12=22;tc.DMPAPER_ENV_14=23;tc.DMPAPER_CSHEET=24;tc.DMPAPER_DSHEET=25;tc.DMPAPER_ESHEET=26;tc.DMPAPER_ENV_DL=27;tc.DMPAPER_ENV_C5=28;tc.DMPAPER_ENV_C3=29;tc.DMPAPER_ENV_C4=30;tc.DMPAPER_ENV_C6=31;tc.DMPAPER_ENV_C65=32;tc.DMPAPER_ENV_B4=33;tc.DMPAPER_ENV_B5=34;tc.DMPAPER_ENV_B6=35;tc.DMPAPER_ENV_ITALY=36;tc.DMPAPER_ENV_MONARCH=37;tc.DMPAPER_ENV_PERSONAL=38;tc.DMPAPER_FANFOLD_US=39;tc.DMPAPER_FANFOLD_STD_GERMAN=40;tc.DMPAPER_FANFOLD_LGL_GERMAN=41;tc.DMBIN_UPPER=1;tc.DMBIN_ONLYONE=1;tc.DMBIN_LOWER=2;tc.DMBIN_MIDDLE=3;tc.DMBIN_MANUAL=4;tc.DMBIN_ENVELOPE=5;tc.DMBIN_ENVMANUAL=6;tc.DMBIN_AUTO=7;tc.DMBIN_TRACTOR=8;tc.DMBIN_SMALLFMT=9;tc.DMBIN_LARGEFMT=10;tc.DMBIN_LARGECAPACITY=11;tc.DMBIN_CASSETTE=14;tc.DMBIN_FORMSOURCE=15;tc.DMBIN_USER=256;tc.GW_CHILD=5;tc.EM_SETSEL=177;tc.EM_SCROLLCARET=183;tc.EM_REPLACESEL=194;tc.GCP_DBCS=1;tc.GCP_REORDER=2;tc.GCP_USEKERNING=8;tc.GCP_GLYPHSHAPE=16;tc.GCP_LIGATE=32;tc.GCP_DIACRITIC=256;tc.GCP_KASHIDA=1024;tc.GCP_ERROR=32768;tc.FLI_MASK=4155;tc.GCP_JUSTIFY=65536;tc.FLI_GLYPHS=262144;tc.GCP_CLASSIN=524288;tc.GCP_MAXEXTENT=1048576;tc.GCP_JUSTIFYIN=2097152;tc.GCP_DISPLAYZWG=4194304;tc.STANDARD_RIGHTS_REQUIRED=983040;tc.SECTION_QUERY=1;tc.SECTION_MAP_WRITE=2;tc.SECTION_MAP_READ=4;tc.SECTION_MAP_EXECUTE=8;tc.SECTION_EXTEND_SIZE=16;tc.SECTION_ALL_ACCESS=tc.STANDARD_RIGHTS_REQUIRED|tc.SECTION_QUERY|tc.SECTION_MAP_WRITE|tc.SECTION_MAP_READ|tc.SECTION_MAP_EXECUTE|tc.SECTION_EXTEND_SIZE;tc.FILE_MAP_ALL_ACCESS=tc.SECTION_ALL_ACCESS;tc.TMPF_TRUETYPE=4;tc.DEFAULT_PITCH=0;tc.DRAFT_QUALITY=0;tc.OUT_TT_ONLY_PRECIS=7;tc.OUT_DEFAULT_PRECIS=0;tc.CLIP_DEFAULT_PRECIS=0;tc.FW_REGULAR=400;tc.FW_BOLD=700;tc.SM_CYVTHUMB=9;tc.SM_CYVSCROLL=20;tc.SRCCOPY=13369376;tc.PATINVERT=5898313;tc.DSTINVERT=5570569;tc.R2_BLACK=1;tc.R2_NOTMERGEPEN=2;tc.R2_MASKNOTPEN=3;tc.R2_NOTCOPYPEN=4;tc.R2_MASKPENNOT=5;tc.R2_NOT=6;tc.R2_XORPEN=7;tc.R2_NOTMASKPEN=8;tc.R2_MASKPEN=9;tc.R2_NOTXORPEN=10;tc.R2_NOP=11;tc.R2_MERGENOTPEN=12;tc.R2_COPYPEN=13;tc.R2_MERGEPENNOT=14;tc.R2_MERGEPEN=15;tc.R2_WHITE=16;tc.R2_LAST=16;tc.TCI_SRCCHARSET=1;tc.TCI_SRCCODEPAGE=2;tc.WM_KEYFIRST=256;tc.WM_KEYDOWN=256;tc.WM_KEYUP=257;tc.WM_CHAR=258;tc.WM_DEADCHAR=259;tc.WM_SYSKEYDOWN=260;tc.WM_SYSKEYUP=261;tc.WM_SYSCHAR=262;tc.WM_SYSDEADCHAR=263;tc.WM_KEYLAST=264;tc.WM_IME_CHAR=646;tc.WM_IME_STARTCOMPOSITION=269;tc.WM_IME_ENDCOMPOSITION=270;tc.WM_IME_COMPOSITION=271;tc.WM_IME_KEYLAST=271;tc.WM_IME_NOTIFY=642;tc.IMN_OPENCANDIDATE=5;tc.CFS_CANDIDATEPOS=64;tc.GCS_COMPREADSTR=1;tc.GCS_COMPREADATTR=2;tc.GCS_COMPREADCLAUSE=4;tc.GCS_COMPSTR=8;tc.GCS_COMPATTR=16;tc.GCS_COMPCLAUSE=32;tc.GCS_CURSORPOS=128;tc.GCS_DELTASTART=256;tc.GCS_RESULTREADSTR=512;tc.GCS_RESULTREADCLAUSE=1024;tc.GCS_RESULTSTR=2048;tc.GCS_RESULTCLAUSE=4096;tc.CS_INSERTCHAR=8192;tc.CS_NOMOVECARET=16384;tc.WM_INITDIALOG=272;tc.WM_COMMAND=273;tc.WM_SYSCOMMAND=274;tc.WM_TIMER=275;tc.WM_HSCROLL=276;tc.WM_VSCROLL=277;tc.WM_INITMENU=278;tc.WM_CREATE=1;tc.WM_DESTROY=2;tc.WM_MOVE=3;tc.WM_SIZE=5;tc.WM_ACTIVATE=6;tc.WM_SETFOCUS=7;tc.WM_KILLFOCUS=8;tc.WM_ENABLE=10;tc.WM_SETREDRAW=11;tc.WM_SETTEXT=12;tc.WM_GETTEXT=13;tc.WM_GETTEXTLENGTH=14;tc.WM_PAINT=15;tc.WM_CLOSE=16;tc.WM_QUERYENDSESSION=17;tc.WM_QUIT=18;tc.WM_QUERYOPEN=19;tc.WM_ERASEBKGND=20;tc.WM_SYSCOLORCHANGE=21;tc.WM_ENDSESSION=22;tc.WM_SHOWWINDOW=24;tc.WM_WININICHANGE=26;tc.WM_DEVMODECHANGE=27;tc.WM_ACTIVATEAPP=28;tc.WM_FONTCHANGE=29;tc.WM_TIMECHANGE=30;tc.WM_CANCELMODE=31;tc.WM_SETCURSOR=32;tc.WM_MOUSEACTIVATE=33;tc.WM_CHILDACTIVATE=34;tc.WM_QUEUESYNC=35;tc.WM_DROPFILES=563;tc.WM_MOUSEFIRST=512;tc.WM_MOUSEMOVE=512;tc.WM_LBUTTONDOWN=513;tc.WM_LBUTTONUP=514;tc.WM_LBUTTONDBLCLK=515;tc.WM_RBUTTONDOWN=516;tc.WM_RBUTTONUP=517;tc.WM_RBUTTONDBLCLK=518;tc.WM_MBUTTONDOWN=519;tc.WM_MBUTTONUP=520;tc.WM_MBUTTONDBLCLK=521;tc.WM_MOUSEWHEEL=522;tc.WM_MOUSELAST=522;tc.WM_NCHITTEST=132;tc.WM_NCMOUSEMOVE=160;tc.WM_TERN=tc.WM_USER+2712;tc.WM_TERN_VERSION=tc.WM_USER+2713;tc.VK_BACK=8;tc.VK_RETURN=13;tc.VK_ESCAPE=27;tc.VK_SHIFT=16;tc.VK_CONTROL=17;tc.VK_LSHIFT=160;tc.VK_RSHIFT=161;tc.VK_LCONTROL=162;tc.VK_RCONTROL=163;tc.VK_LMENU=164;tc.VK_RMENU=165;tc.VK_CAPITAL=20;tc.VK_BACK_SPACE=8;tc.VK_DELETE=46;tc.VK_UP=38;tc.VK_DOWN=40;tc.VK_LEFT=37;tc.VK_RIGHT=39;tc.VK_END=35;tc.VK_ENTER=13;tc.VK_HOME=36;tc.VK_INSERT=45;tc.VK_PAGE_UP=33;tc.VK_PAGE_DOWN=34;tc.VK_SPACE=32;tc.VK_TAB=9;tc.VK_F1=112;tc.VK_F2=113;tc.VK_F3=114;tc.VK_F4=115;tc.VK_F5=116;tc.VK_F6=117;tc.VK_F7=118;tc.VK_F8=119;tc.VK_F9=120;tc.VK_F10=121;tc.VK_0=48;tc.VK_1=49;tc.VK_2=50;tc.VK_3=51;tc.VK_4=52;tc.VK_5=53;tc.VK_6=54;tc.VK_7=55;tc.VK_8=56;tc.VK_9=57;tc.VK_A=65;tc.VK_B=66;tc.VK_C=67;tc.VK_D=68;tc.VK_E=69;tc.VK_F=70;tc.VK_G=71;tc.VK_H=72;tc.VK_I=73;tc.VK_J=74;tc.VK_K=75;tc.VK_L=75;tc.VK_M=77;tc.VK_N=78;tc.VK_O=78;tc.VK_P=80;tc.VK_Q=81;tc.VK_R=82;tc.VK_S=83;tc.VK_T=84;tc.VK_U=85;tc.VK_V=86;tc.VK_W=87;tc.VK_X=86;tc.VK_Y=89;tc.VK_Z=90;tc.SHIFT_MASK=1;tc.CTRL_MASK=2;tc.ALT_MASK=4;tc.SB_LINEUP=0;tc.SB_LINELEFT=0;tc.SB_LINEDOWN=1;tc.SB_LINERIGHT=1;tc.SB_PAGEUP=2;tc.SB_PAGELEFT=2;tc.SB_PAGEDOWN=3;tc.SB_PAGERIGHT=3;tc.SB_THUMBPOSITION=4;tc.SB_THUMBTRACK=5;tc.SB_TOP=6;tc.SB_LEFT=6;tc.SB_BOTTOM=7;tc.SB_RIGHT=7;tc.SB_ENDSCROLL=8;tc.SB_HORZ=0;tc.SB_VERT=1;tc.SB_CTL=2;tc.SB_BOTH=3;tc.SIF_RANGE=1;tc.SIF_PAGE=2;tc.SIF_POS=4;tc.SIF_DISABLENOSCROLL=8;tc.SIF_TRACKPOS=16;tc.SIF_ALL=tc.SIF_RANGE|tc.SIF_PAGE|tc.SIF_POS|tc.SIF_TRACKPOS;tc.PM_NOREMOVE=0;tc.PM_REMOVE=1;tc.PM_NOYIELD=2;tc.GCPCLASS_LATIN=1;tc.GCPCLASS_HEBREW=2;tc.GCPCLASS_ARABIC=2;tc.GCPCLASS_NEUTRAL=3;tc.CT_CTYPE1=1;tc.CT_CTYPE2=2;tc.CT_CTYPE3=4;tc.C1_UPPER=1;tc.C1_LOWER=2;tc.C1_DIGIT=4;tc.C1_SPACE=8;tc.C1_PUNCT=16;tc.C1_CNTRL=32;tc.C1_BLANK=64;tc.C1_XDIGIT=128;tc.C1_ALPHA=256;tc.C2_LEFTTORIGHT=1;tc.C2_RIGHTTOLEFT=2;tc.C2_EUROPENUMBER=3;tc.C2_EUROPESEPARATOR=4;tc.C2_EUROPETERMINATOR=5;tc.C2_ARABICNUMBER=6;tc.C2_COMMONSEPARATOR=7;tc.C2_BLOCKSEPARATOR=8;tc.C2_SEGMENTSEPARATOR=9;tc.C2_WHITESPACE=10;tc.C2_OTHERNEUTRAL=11;tc.C2_NOTAPPLICABLE=0;tc.C3_NONSPACING=1;tc.C3_DIACRITIC=2;tc.C3_VOWELMARK=4;tc.C3_SYMBOL=8;tc.C3_KATAKANA=16;tc.C3_HIRAGANA=32;tc.C3_HALFWIDTH=64;tc.C3_FULLWIDTH=128;tc.C3_IDEOGRAPH=256;tc.C3_KASHIDA=512;tc.C3_LEXICAL=1024;tc.C3_ALPHA=32768;tc.C3_NOTAPPLICABLE=0;Object.seal(tc);Object.freeze(tc);var tg={};tg.UNITS_PER_INCH=96;tg.MENU_HEIGHT=18;tg.MENU_MARGIN=10;tg.MENU_XMARGIN=25;tg.TLB_ICON_HEIGHT=26;tg.TLB_MARGIN=3;tg.TLB_SPACER_WIDTH=3;tg.InIE=true;tg.InFireFox=false;tg.InServer=false;tg.DoClassCleanup=false;tg.FromText=[];tg.ToText=[];tg.ansi=[];tg.mac=[];tg.oem=[];tg.baltic=[];tg.easteurope=[];tg.greek=[];tg.russian=[];tg.turkish=[];tg.viet=[];tg.hebrew=[];tg.arabic=[];tg.thai=[];tg.ClipDataText="";tg.ClipDataRtf="";tg.ClipInfo=null;tg.ClipDataTime="";tg.GlbPrtDC=[];tg.GlbFont=[];tg.UserNameStorageFile="TehUserName";tg.TotalGlbFonts=0;tg.GlbPrtDCCount=0;tg.MeasureTextStr=[];tg.MeasureTextObj=[];tg.MergeDelim="|".charCodeAt(0);tg.SpoolJob=null;tg.SpoolJobStarted=false;tg.SpoolJobEnded=false;tg.TerOpenCount=0;tg.TotalWinPtrs=0;tg.DefPrt=null;tg.DefPrtPage=null;tg.ToolbarBM=null;tg.ToolbarBMLoaded=false;tg.ToolbarBMLoadError=false;tg.WinPtr=[tc.MAX_WIN_PTRS];tg.PaperList=null;tg.TrayList=null;tg.StSearched=false;tg.stj=null;tg.StDictUrlPrefix="dict35";tg.StDictExt=".txt";tg.StKey="";tg.ST_MAX_WORD_LEN=0;tg.ST_MAX_SUG_WORDS=0;tg.ST_ERROR=0;tg.ST_INTERACTIVE=0;tg.ST_IGNORE=0;tg.ST_REPLACE=0;tg.ST_ADD=0;tg.ST_INPUT=0;tg.ST_EXIT=0;tg.HtnSearched=false;tg.HtnLicenseKey="";tg.hHts=null;tg.SspSearched=false;tg.WininetSearched=false;tg.WrsFound=false;tg.TerInitFlags=tc.TFLAG_BUF_DISP|tc.TFLAG_NO_AUTO_FULL_CELL_SEL;tg.TerInitFlags2=tc.TFLAG2_XPARENT_WRITE;tg.TerInitFlags3=tc.TFLAG3_EMBEDDED_TABLES|tc.TFLAG3_STYLES_ON_TOOLBAR|tc.TFLAG3_READ_PNG;tg.TerInitFlags4=tc.TFLAG4_NO_BUFFERED_SCROLL;tg.TerInitFlags5=tc.TFLAG5_XP_TOOLBAR;tg.TerInitFlags6=tc.TFLAG6_OLE_DROP_SOURCE|tc.TFLAG6_DEL_CELL_TEXT|tc.TFLAG6_TRACK_API;tg.TerInitFlags7=tc.TFLAG7_AUTO_NEW_ROW|tc.TFLAG7_AUTO_SET_RTL|tc.TFLAG7_WRITE_LISTTEXT;tg.TerInitFlags8=tc.TFLAG8_NO_TWIPS;tg.TerInitFlags9=tc.TFLAG9_ENABLE_POPUP_MENU;tg.TerInitFlags10=0;tg.TerInitFlags11=0;tg.TotalBaseColors=0;tg.TotalPalColors=0;tg.TerStyles=0;tg.InitMbcs=false;tg.InitPageWidth=0;tg.InitPageHeight=0;tg.InitFontFace="";tg.eval=true;tg.expired=false;tg.reset=false;tg.EvalMsgShown=false;tg.EvalDaysRemaining=15;tg.EvalDaysUsed=0;tg.LicenseYYMM=0;tg.disable=false;tg.HomeKey=false;tg.ky1="X8RU311X";tg.ky2="XK2U622X";tg.ky3="X872533X";tg.ServerLicense=true;tg.LicKey="";tg.ResourceUrl="";tg.extended=false;tg.UserKey="";tg.StnKey="";tg.DateFieldText=[30];tg.TotalDateFmts=0;tg.WeekDays=[7];tg.MonthNames=[12];tg.DebugMode=false;tg.TlbClass="";tg.IsWinNT2000=false;tg.OSCanRotate=false;tg.IsWindows=true;tg.DefPaperName=[tc.MAX_PAPERS];tg.DefPaperSize=[tc.MAX_PAPERS];tg.DefPaperKind=[tc.MAX_PAPERS];tg.DefPaperWidth=[tc.MAX_PAPERS];tg.DefPaperHeight=[tc.MAX_PAPERS];tg.DefPaperCount=0;tg.MsgString=[];tg.MsgString[tc.MSG_NO_ERROR]="No User error.";tg.MsgString[tc.MSG_BAD_BMP_FILE]="Invalid bitmap file.";tg.MsgString[tc.MSG_BAD_FNOTE_MARKER]="A space or an invalid character in the footnote marker";tg.MsgString[tc.MSG_BAD_OBJ_SIZE]="Object size rror.";tg.MsgString[tc.MSG_BAD_PRINTER_DRV]="Invalid printer driver.";tg.MsgString[tc.MSG_CELL_DATA_MISSING]="Cell table data missing or cell table allocation error.";tg.MsgString[tc.MSG_CELL_WITHOUT_ROW]="Table cell found without table row.";tg.MsgString[tc.MSG_CHARSTYLE_IN_USE]="This name is already in use by a character style. Select new name.";tg.MsgString[tc.MSG_CHAR_FMT_MISSING]="Some character formatting data missing.";tg.MsgString[tc.MSG_CLIPBOARD_BUSY]="Clipboard in use by another application.";tg.MsgString[tc.MSG_CLIPBOARD_NO_DATA]="Error retrieving the clipboard data.";tg.MsgString[tc.MSG_CLIPBOARD_NO_FMT]="Clipboard does not contain specified formatted data.";tg.MsgString[tc.MSG_COUNT_MISMATCH]="Field name count not equal field data count, or too many fields. Mail Merge error.";tg.MsgString[tc.MSG_CREATE_NEW_FILE]="File does not exist, Create a new file?";tg.MsgString[tc.MSG_END_BACKWARD_SEARCH]="End of Backward search.";tg.MsgString[tc.MSG_END_FORWARD_SEARCH]="End of Forward search.";tg.MsgString[tc.MSG_ERR_ADDING_STRING]="Error adding String to listbox.";tg.MsgString[tc.MSG_ERR_ADDING_VALUE]="Error adding value to listbox.";tg.MsgString[tc.MSG_ERR_ADVISE_CONNECT]="Error setting the data advise connection.";tg.MsgString[tc.MSG_ERR_ADV_CREATE]="AdviseSink Creation error.";tg.MsgString[tc.MSG_ERR_BLOCK_SIZE]="Block Size error.";tg.MsgString[tc.MSG_ERR_BMP_CREATE]="Error creating the bitmap.";tg.MsgString[tc.MSG_ERR_CTL_CREATE]="Error creating the control window.";tg.MsgString[tc.MSG_ERR_DATA_RETRIEVE]="Error retrieving data object.";tg.MsgString[tc.MSG_ERR_DIB_CREATE]="Error creating Device Independent Bitmap.";tg.MsgString[tc.MSG_ERR_END_PAGE]="Error finishing the page.";tg.MsgString[tc.MSG_ERR_END_PRINTER]="Error finishing printing.";tg.MsgString[tc.MSG_ERR_FILE_LENGTH]="Error getting FILE_LENGTH.";tg.MsgString[tc.MSG_ERR_FILE_OPEN]="Could not open the file.";tg.MsgString[tc.MSG_ERR_FILE_READ]="File read error.";tg.MsgString[tc.MSG_ERR_FILE_SEEK]="Error in file seek.";tg.MsgString[tc.MSG_ERR_FILE_WRITE]="Error writing to file.";tg.MsgString[tc.MSG_ERR_FONT_CREATE]="Error creating font.";tg.MsgString[tc.MSG_ERR_FONT_SELECT]="Unable to select the font.";tg.MsgString[tc.MSG_ERR_INIT_BMP]="Error initializing the bitmap.";tg.MsgString[tc.MSG_ERR_INIT_OLE]="Error initializing OLE.";tg.MsgString[tc.MSG_ERR_INIT_PRINTER]="Error initializing the printer.";tg.MsgString[tc.MSG_ERR_INSTANCE]="Can not create proc instance.";tg.MsgString[tc.MSG_ERR_LOAD_ACCEL]="Unable to load the accelerator table.";tg.MsgString[tc.MSG_ERR_MAIL_MERGE]="Error during mail merge.";tg.MsgString[tc.MSG_ERR_MEM_LOCK]="Could not obtain buffer lock.";tg.MsgString[tc.MSG_ERR_META_ACCESS]="Error accessing meta file data.";tg.MsgString[tc.MSG_ERR_META_BAD_FILE]="Invalid Windows Metafile File.";tg.MsgString[tc.MSG_ERR_META_COPY]="Error copying metafile.";tg.MsgString[tc.MSG_ERR_META_CREATE]="Error creating metafile DC.";tg.MsgString[tc.MSG_ERR_META_READ]="Can not read the Metafile.";tg.MsgString[tc.MSG_ERR_META_RECREATE]="Error recreating Metafile.";tg.MsgString[tc.MSG_ERR_OBJ_DATA]="Error getting OLE storage data.";tg.MsgString[tc.MSG_ERR_OBJ_SAVE]="Error getting Object size. File save incomplete.";tg.MsgString[tc.MSG_ERR_OBJ_SIZE]="Error getting Object size.";tg.MsgString[tc.MSG_ERR_OLE_CLSID]="Error writing class id.";tg.MsgString[tc.MSG_ERR_OLE_DATA_CONV]="OLE data conversion error.";tg.MsgString[tc.MSG_ERR_OLE_LOAD]="OLE load error.";tg.MsgString[tc.MSG_ERR_OLE_SAVE]="Error saving the OLE object.";tg.MsgString[tc.MSG_ERR_OLE_USER]="Error writing user type.";tg.MsgString[tc.MSG_ERR_OLE_VERSION]="Invalid OLE version.";tg.MsgString[tc.MSG_ERR_PEN]="Unable to create control pens.";tg.MsgString[tc.MSG_ERR_PICT_FILE_FMT]="Invalid Picture File Format.";tg.MsgString[tc.MSG_ERR_PICT_FILE_OPEN]="Cannot open the picture file.";tg.MsgString[tc.MSG_ERR_PICT_FILE_READ]="Error reading the picture file.";tg.MsgString[tc.MSG_ERR_PRESENT_DATA]="Error retrieving presentation data.";tg.MsgString[tc.MSG_ERR_SITE_CREATE]="Error creating client site.";tg.MsgString[tc.MSG_ERR_START_PRINTER]="Unable to Start the Print Job.";tg.MsgString[tc.MSG_ERR_STORAGE_CREATE]="Error creating OLE storage.";tg.MsgString[tc.MSG_ERR_STORAGE_RETRIEVE]="Error retrieving the OLE storage.";tg.MsgString[tc.MSG_ERR_TEXT_METRIC]="Unable to get text metric for the font.";tg.MsgString[tc.MSG_ERR_VIEW_RETRIEVE]="Error retrieving view object.";tg.MsgString[tc.MSG_FILE_INFO_MISSING]="File information data missing.";tg.MsgString[tc.MSG_FILE_SIGN_MISSING]="File information signature missing.";tg.MsgString[tc.MSG_FONT_TBL_INCOMPL]="Font table incomplete.";tg.MsgString[tc.MSG_INVALID_NUMBER]="Must enter a valid number.";tg.MsgString[tc.MSG_INVALID_PRINT_RECT]="The 'rect' variable may not be NULL when printing to a Windows' device context.";tg.MsgString[tc.MSG_INVALID_SECT_DATA]="Invalid Section Data encountered.";tg.MsgString[tc.MSG_INVALID_SELECT]="Invalid selection.";tg.MsgString[tc.MSG_KEEP_HDRFTR_LINE]="Must keep at least one header/footer line.";tg.MsgString[tc.MSG_LINE_TOO_LONG]="Line too long.";tg.MsgString[tc.MSG_LINE_TRUNCATED]="Line(s) truncated.";tg.MsgString[tc.MSG_MARGIN_TOO_LARGE]="Margin(s) or Header/Footer distance too large.";tg.MsgString[tc.MSG_MAX_LINES_EXCEEDED]="Max Line exceeded.";tg.MsgString[tc.MSG_MERGE_DATA_TOO_LONG]="Data too long. Data Merge error.";tg.MsgString[tc.MSG_MISSING_ROW_MARKER]="Row marker not found. Cannot split the cell.";tg.MsgString[tc.MSG_NODEL_HDRFTR_BODY]="Cannot delete the header text with the body text.";tg.MsgString[tc.MSG_NOT_TE_FILE]="Not a valid TE document. Formatting data ignored.";tg.MsgString[tc.MSG_NO_HILIGHT]="No highlighted block found.";tg.MsgString[tc.MSG_NO_OLE_CLASS]="OLE class not found in the Registration Database.";tg.MsgString[tc.MSG_NO_RANGE_PRINTING]="Range printing not available in page header/footer editing mode.";tg.MsgString[tc.MSG_NO_SERVER]="The server application not found.";tg.MsgString[tc.MSG_NO_STRING]="Text not found.";tg.MsgString[tc.MSG_NULL_FIELD]="Zero.length field name not allowed. Mail Merge error.";tg.MsgString[tc.MSG_OLEERR_NEED_SHARE]="Share Utility required.";tg.MsgString[tc.MSG_OLEERR_NO_CLASS]="Class not registered.";tg.MsgString[tc.MSG_OUT_OF_CELL_SLOT]="Ran out of cell table.";tg.MsgString[tc.MSG_OUT_OF_CHAR_STACK]="Out of character stack.";tg.MsgString[tc.MSG_OUT_OF_COMP_DC]="Unable to create compatible DC.";tg.MsgString[tc.MSG_OUT_OF_DC]="Unable to allocate a Display Context.";tg.MsgString[tc.MSG_OUT_OF_DRAG_OBJ]="Ran out of Drag Object Table.";tg.MsgString[tc.MSG_OUT_OF_FONT_SLOT]="Ran out of Font/Picture/Object Table.";tg.MsgString[tc.MSG_OUT_OF_GROUP]="Ran out of Group Table for RTF data.";tg.MsgString[tc.MSG_OUT_OF_MEM]="Ran out of memory.";tg.MsgString[tc.MSG_OUT_OF_PARA_SLOT]="Paragraph Table exhausted.";tg.MsgString[tc.MSG_OUT_OF_PARAFID_SLOT]="Paragraph Frame Table exhausted.";tg.MsgString[tc.MSG_OUT_OF_RANGE]="Value out of range.";tg.MsgString[tc.MSG_OUT_OF_ROW_SLOT]="Ran out of row table.";tg.MsgString[tc.MSG_OUT_OF_STYLESHEET]="Ran out of memory for the Style Sheet Table.";tg.MsgString[tc.MSG_OUT_OF_TAB_POS]="No more tab settings allowed.";tg.MsgString[tc.MSG_OUT_OF_TAB_TABLE]="Tab Table Exhausted.";tg.MsgString[tc.MSG_OUT_OF_TASK]="Ran out of Task Table.";tg.MsgString[tc.MSG_OUT_OF_WIN_SLOTS]="Ran out of non-standard window slots.";tg.MsgString[tc.MSG_PARASTYLE_IN_USE]="This name is already in use by a Paragraph style. Select new name.";tg.MsgString[tc.MSG_PARA_FMT_MISSING]="Some Paragraph Formatting data missing.";tg.MsgString[tc.MSG_PARA_TBL_INCOMPL]="Paragraph Table data missing.";tg.MsgString[tc.MSG_PFRAME_DATA_MISSING]="Paragraph Frame Table data missing.";tg.MsgString[tc.MSG_PRINT_AREA_SMALL]="Printing area too small.";tg.MsgString[tc.MSG_PROTECTED]="Text Protection error.";tg.MsgString[tc.MSG_READ_ABORTED]="Read aborted.";tg.MsgString[tc.MSG_REPLACE_STRING]="Replace this string?";tg.MsgString[tc.MSG_SAVE_INCOMPL]="Save not complete.";tg.MsgString[tc.MSG_SAVE_MODS]="File modified. Do you wish to save the modifications? \nClick OK to Save, or click Cancel to discard the modifications.";tg.MsgString[tc.MSG_SECTION_FULL]="Section Table full.";tg.MsgString[tc.MSG_SECT_TBL_MISSING]="Section Table data missing.";tg.MsgString[tc.MSG_SEL_PROTECTED]="This selection contains protected text.";tg.MsgString[tc.MSG_SEL_SPAN_HDRFTR]="Selection may not extend across header/footer and page text.";tg.MsgString[tc.MSG_SPELL_OVER]="Spell checking session over.";tg.MsgString[tc.MSG_TAB_TBL_MISSING]="Tab Table data missing.";tg.MsgString[tc.MSG_TBL_DATA_MISSING]="Table array data missing or table allocation error.";tg.MsgString[tc.MSG_TYPE_STYLE_NAME]="Specify a name for the new style.";tg.MsgString[tc.MSG_UNDO_EMPTY]="Undo buffer empty. Undo not available.";tg.MsgString[tc.MSG_UNEXPECTED_EOF]="Unexpected end of file.";tg.MsgString[tc.MSG_BAD_WIN_HANDLE]="Invalid window handle.";tg.MsgString[tc.MSG_BAD_VERSION]="Invalid TER DLL version.";tg.MsgString[tc.MSG_NODEL_MIX_HTML]="This deletion joins dissimilar HTML paragraphs. Invalid action.";tg.MsgString[tc.MSG_ERR_TOO_MANY_FILES]="Not enough file handles available.";tg.MsgString[tc.MSG_ERR_FILE_ACCESS]="Unable to access the file.";tg.MsgString[tc.MSG_REDO_EMPTY]="Redo buffer empty. Redo not available.";tg.MsgString[tc.MSG_OUT_OF_BLT_TABLE]="Bullet Table exhausted.";tg.MsgString[tc.MSG_BULLET_MISSING]="Bullet Table data missing or bullet allocation error.";tg.MsgString[tc.MSG_BAD_JPG_FILE]="Invalid JPEG file.";tg.MsgString[tc.MSG_ERR_JPG_HUFF]="Too many Huffman tables in the JPEG image.";tg.MsgString[tc.MSG_ERR_JPG_MARKER]="Misplaced restart marker found in JPEG file.";tg.MsgString[tc.MSG_ERR_JPG_NO_HUFF]="Huffman symbol not found in JPEG read.";tg.MsgString[tc.MSG_TAG_TABLE_MISSING]="Tag Table data missing or tag table allocation error.";tg.MsgString[tc.MSG_ERR_ENH_META_HDR]="Error accessing enhanced metafile header.";tg.MsgString[tc.MSG_GET_ENH_META]="Error retrieving enhanced metafile data.";tg.MsgString[tc.MSG_MAX_WIN_LINES]="Exceeded max lines per window limit.";tg.MsgString[tc.MSG_SOFT_PAGE_BREAK]="Soft Page Break";tg.MsgString[tc.MSG_SECT_BREAK]="Section Break";tg.MsgString[tc.MSG_PAGE_BREAK]="Page Break";tg.MsgString[tc.MSG_COL_BREAK]="Column Break";tg.MsgString[tc.MSG_PAGE_HDR]="Page Header";tg.MsgString[tc.MSG_PAGE_FTR]="Page Footer";tg.MsgString[tc.MSG_ROW_BREAK]="Row Break";tg.MsgString[tc.MSG_DEL_DRAW_OBJ]="Delete current drawing object?";tg.MsgString[tc.MSG_DEL_FRAME]="Delete current frame and its contents?";tg.MsgString[tc.MSG_IRREVERSIBLE_DEL]="Irreversible Delete?";tg.MsgString[tc.MSG_ERR_PRINT]="Printer error.";tg.MsgString[tc.MSG_FIRST_HDR]="First Page Header";tg.MsgString[tc.MSG_FIRST_FTR]="First Page Footer";tg.MsgString[tc.MSG_DEL_FIRST_HDR]="Delete First Page Header?";tg.MsgString[tc.MSG_DEL_FIRST_FTR]="Delete First Page Footer?";tg.MsgString[tc.MSG_BAD_PNG_DATA]="Invalid PNG Data.";tg.MsgString[tc.MSG_PRINTING_CANCELLED]="Printing cancelled.";tg.MsgString[tc.MSG_SMALL_CELL_MARGIN]="Cell margin should be atleast as large as the cell border width.";tg.MsgString[tc.MSG_READ_ONLY]="Read only file. Can not save.";tg.MsgString[tc.MSG_NO_PRINTER]="Printer not available.";tg.MsgString[tc.MSG_DEL_TOC]="Delete current table-of-content?";tg.MsgString[tc.MSG_NO_RTF_INFO_BLOCK]="RTF Information block missing";tg.MsgString[tc.MSG_NO_LIST_BLOCK]="List table missing";tg.MsgString[tc.MSG_NO_LIST_OR_BLOCK]="List override table missing";tg.MsgString[tc.MSG_DEL_HDR]="Delete Page Header?";tg.MsgString[tc.MSG_DEL_FTR]="Delete Page Footer?";tg.MsgString[tc.MSG_ERR_JPG_MCU]="Max MCU exceeded in Jpeg read.";tg.MsgString[tc.MSG_OUT_OF_IMAGE_MAP_TABLE]="Ran out of Image Map table.";tg.MsgString[tc.MSG_COLUMNS]="Space Between the Columns (cm)";tg.MsgString[tc.MSG_GIF_FILES]="Gif Files (*.GIF)|*.GIF|";tg.MsgString[tc.MSG_ENH_METAFILES]="Enhanced Metafiles(*.EMF)|*.EMF|";tg.MsgString[tc.MSG_BMP_FILES]="Bitmap Files(*.BMP)|*.BMP|";tg.MsgString[tc.MSG_METAFILES]="Windows Metafiles(*.WMF)|*.WMF|";tg.MsgString[tc.MSG_JPG_FILES]="Jpeg Files(*.JPG)|*.JPG|";tg.MsgString[tc.MSG_PNG_FILES]="PNG Files(*.PNG)|*.PNG|";tg.MsgString[tc.MSG_PICTURE_SIZE]="Picture Size (cm)";tg.MsgString[tc.MSG_SINGLE]="Single";tg.MsgString[tc.MSG_15LINES]="1.5 Lines";tg.MsgString[tc.MSG_DBL_LINE]="Double Line";tg.MsgString[tc.MSG_ATLEAST]="At least";tg.MsgString[tc.MSG_EXACTLY]="Exactly";tg.MsgString[tc.MSG_MULTIPLE]="Multiple";tg.MsgString[tc.MSG_LINES]="Lines";tg.MsgString[tc.MSG_POINTS]="Points";tg.MsgString[tc.MSG_TAB_POS]="Tab Positions (cm)";tg.MsgString[tc.MSG_MARGIN]="Margin (cm)";tg.MsgString[tc.MSG_PNG_ABORT]="PNG File Read aborted";tg.MsgString[tc.MSG_FATAL_ERROR]="Fatal Error";tg.MsgString[tc.MSG_FILE_OPEN]="File Open Error!";tg.MsgString[tc.MSG_ERROR]="Error";tg.MsgString[tc.MSG_SPL_CHECKED]="Words Checked: ";tg.MsgString[tc.MSG_SPL_INCORRECT]="Incorrect Words: ";tg.MsgString[tc.MSG_BAD_RTF]="Cannot understand this RTF syntax!";tg.MsgString[tc.MSG_UNKNOWN]="Unknown";tg.MsgString[tc.MSG_ICO_FILES]="Windows Icon Files(*.ICO)|*.ICO|";tg.MsgString[tc.MSG_TIF_FILES]="Tag Image Format Files(*.TIF)|*.TIF|";tg.MsgString[tc.MSG_INTERNAL_ERROR]="Internal Error";tg.MsgString[tc.MSG_CANT_SET_PROP]="Property assignment Failed! This is a Component Initializing Property.  Most Tern methods and also some properties such as the 'Parent' property can force the creation of the Component Handle. These methods and properties should not be called before setting this Component Initializing Property.";tg.MsgString[tc.MSG_PAGE_BOX]="Page: ";tg.MsgString[tc.MSG_IGNORE_ALL]="&Ignore All";tg.MsgString[tc.MSG_ADD]="&Add";tg.MsgString[tc.MSG_SB_INS]="INS";tg.MsgString[tc.MSG_SB_OT]="OT ";tg.MsgString[tc.MSG_SB_PAGE]="Page: ";tg.MsgString[tc.MSG_SB_LINE]="Line: ";tg.MsgString[tc.MSG_SB_ROW]="Row: ";tg.MsgString[tc.MSG_SB_COL]="Col: ";tg.MsgString[tc.MSG_PP_ONE_PAGE]="One Page";tg.MsgString[tc.MSG_PP_TWO_PAGES]="Two Pages";tg.MsgString[tc.MSG_PP_PRINT]="Print";tg.MsgString[tc.MSG_PP_EDIT]="Edit";tg.MsgString[tc.MSG_PP_PG]="Pg: ";tg.MsgString[tc.MSG_PP_FITTED]="Fitted";tg.MsgString[tc.MSG_SB_PRINTING_PAGE]="Printing page: ";tg.MsgString[tc.MSG_PP_CLOSE]="Close";tg.MsgString[tc.MSG_NO_HELP]="Help file not found!";tg.MsgString[tc.MSG_INVOKE_TEXT_LINK]="CTRL + click to follow link.";tg.MsgString[tc.MSG_INSERTED_BY]="Inserted by: ";tg.MsgString[tc.MSG_DELETED_BY]="Deleted by: ";tg.MsgString[tc.MSG_NO_CHANGED_TEXT]="No more changed text found.";tg.MsgString[tc.MSG_ACCEPT_CHANGES]="Accept all changes?";tg.MsgString[tc.MSG_CHANGES_COUNT]="Number of changes accepted: ";tg.MsgString[tc.MSG_REJECT_CHANGES]="Reject all changes?";tg.MsgString[tc.MSG_REJECT_COUNT]="Number of changes rejected: ";tg.MsgString[tc.MSG_DATA_TOO_BIG]="Max size exceeded. ";tg.MsgString[tc.MSG_PAGE_LHDR]="Page Left Header";tg.MsgString[tc.MSG_PAGE_LFTR]="Page Left Footer";tg.MsgString[tc.MSG_PAGE_RHDR]="Page Right Header";tg.MsgString[tc.MSG_PAGE_RFTR]="Page Right Footer";tg.MsgString[tc.MSG_XML_READER]="XML Processing Error";tg.MsgString[tc.MSG_FMT_BY]="Font changed by: ";tg.MsgString[tc.MSG_EXPIRED]="Eval expired!";tg.MsgString[tc.MSG_PARA_FMT_BY]="Paragraph changed by: ";tg.MsgString[tc.MSG_ALL_PICT_FILES]="All Picture Files|*.BMP;*.WMF;*.EMF;*.JPG;*.JPEG;*.PNG;*.GIF;*.TIF;*.TIFF|";tg.MsgString[tc.MSG_EXIT_WITHOUT_SAVING]="Click OK to Exit Without Saving, otherwise click Cancel";tg.MsgString[tc.MSG_INVALID_FILE_SELECTION]="Invalid File Type Selection";tg.MsgString[tc.MSG_SELECT_FILE_TYPES]="Please select an RTF or text file (file extension .rtf or .txt)";tg.MsgString[tc.MSG_ALLOW_POPUP]="Please allow popup for this site to use the printing feature";tg.TerXlateString=function(t,e){tg.FromText.push(t);tg.ToText.push(e)};function TerInit(t,e){var r=new ClsTer;Object.seal(r);r.TerInitInst(t,e);return r}function TerGetInst(t){var e=document.getElementById(t);if(e==null)return null;return e.terdata}var ClsTer=function(){this.ObjType="ClsTer";var _i=this;var $t=this;var te="";this.cvs=null;var ee=null;var I=1;this.TerCvsScale=1;this.caret=new tc.ClsCaret(_i);this.textarea=null;this.clipdiv=null;this.MouseX=0;this.MouseY=0;this.HasFocus=false;this.DlgLevel=0;this.DlgKeyListener=null;this.DlgCBListener=null;this.dialog=null;this.DlgFont="12pt Arial";this.DlgCompHeight=25;this.ForgetMouseUp=false;this.VirtTextarea=null;this.DlgTextarea=null;this.DlgTextareaListener=null;this.DlgImeStartPos=-1;this.UseVirtKeyboard=false;this.IsMobileOS=false;this.InIPad=false;this.InIPhone=false;this.InSafari=false;this.HasTouchScreen=false;this.InAdroid=false;this.ExtTlbCmds=[tc.ID_CUT,tc.ID_PASTE,tc.ID_COPY,tc.UNDO,tc.REDO,tc.ID_OPEN,tc.ID_SAVE,tc.ID_NEW,tc.ID_PRINT,tc.ID_PRINT_PREVIEW];var a=new tc.arg_list;var oi=new tc.arg_list;var t=true,e=true;var ui;var n=[tc.MAX_LINE_PTRS+1];var f=0;var S=0;var Ti=null,re=null,et=null,c=null;var r=null;var s=null;var F=null,V=null,W=null,P=null,O=null,h=null;var A=null;var C="",_="",o="",u="",T="";var E=0,R=0,L=0,d=0,g=0;var v=null;var U=null;var K=null,rt=null,k=null,X=null;var it=null,p=null,N=null,D=null,M=null;var G=null,B=null;var w=null,b=null;var Y=0;var H;var J=0,z=0,Z=0;var jt=0,Q=0,q=0,$=0,tt=0,Dt=0,ft=0,Br=0,lt=0,at=0,nt=0,ct=0,st=0,_t=0,ot=0,ut=0,je=0,Mt=0,Tt=0,At=0,Et=0,Rt=0,ie=0,fe=0,Lt=0,Ct=0,It=0,dt=0,Ft=0,Gt=0,Bt=0,Ht=0,mt=0,gt=0,Pt=0,St=0,Hr=0,ht=0,Ot=0,vt=0,pt=0,Nt=0,wt=0,bt=0,xt=0,yt=0,Wt=0,Ut=0,kt=0,Ai=0,Ei=0,Xt=0,Je=0,ze=0,Kt=0,Ze=0,Qe=0,qe=0,$e=0,Yt=0,tr=0,Vt=0,Jt=0,zt=0,Zt=0,Qt=0,qt=0,le=0,ae=0,ne=0,er=0,rr=0,ir=0,ce=0,se=0,_e=0,oe=0,ue=0,Te=0,Ae=0,Ee=0,Re=0,Le=0,Ce=0,Ie=0,de=0,mr=0,Fe=0,wr=0,ge=0,Pe=0,Se=0,he=0,Oe=0,ve=0,pe=0,Ne=0,De=0,Me=0,Ge=0,Be=0,He=50,me=500;var we=0,br=0,be=0,fr=0,Ri=0,xe=0,ye=0,We=0,Ue=0,ke=0,Xe=0,Ke=0,Ye=0,Ve=0,lr=0,ar=0,nr=0,cr=0,sr=0,_r=0,or=0;var ur=0;var Tr=false,Ar=false,Er=false,Rr=false,Lr=false,Cr=false,Ir=false,dr=false,Fr=false,Pr=false,Sr=false,hr=false,Or=false,Li=false,vr=false,pr=false,Nr=false,Dr=false,Mr=false,Gr=false,Ci=false,xr=false,yr=false,Wr=false,Ur=false,kr=false,Xr=false,Kr=false,Yr=false,Vr=false,jr=false,Jr=false,zr=false,Zr=false,Qr=false,qr=false,$r=false,ti=false,ei=false,ri=false,ii=false,fi=false,li=false,ai=false,ni=false,ci=false,si=false,Ii=false,di=false,Fi=false,gi=false,Pi=false,Si=false,hi=false,Oi=false,vi=true,pi=false,Ni=false,Di=false,Mi=false,Gi=false,Bi=false,Hi=false,mi=false,wi=false,bi=false,xi=false,yi=true,Wi=false,Ui=false,ki=false,Xi=true,Ki=false,Yi=false,Vi=false,ji=false,Ji=false,zi=false,Zi=false,Qi=false,qi=false,$i=false,tf=false,ef=false,rf=false,ff=false,lf=false,af=false,nf=true,cf=false;var sf=0;var _f=0,of=0;var uf=0;var Tf=0;var Af=false;var Ef=null;var Rf=null;var Lf=null;var Cf=null;var If=null;var df=0;var Ff=0,gf=0,Pf=0;var Sf=null;var hf=[];var Of=0;var vf=[];var pf=0,Nf=0;var Df=false;var Mf="",Gf="";var Bf=false;var Hf=false;var mf=null;var wf=null;var bf=null;var xf=null;var yf="default",Wf="default",Uf="default",kf="default",Xf="default",Kf="default",Yf="default",Vf="default",jf="default",Jf="default",zf="default",Zf="default",Qf="text",qf="default",$f="default";var tl=null,el=null,rl=null,il=null,fl=null,ll=null,al=null,nl=null,sl=null;var _l=true;var ol=false;var ul=[];var Tl=0,Al=0;var El=false;var Rl=0,Ll=tc.MAX_AUTO_COMPS;var Cl=0;var Il=[tc.MAX_AUTO_COMPS+1];var dl=[tc.MAX_AUTO_COMPS+1];var Fl=0;var gl=0,Pl=0,Sl=0,hl=0,Ol=0;var vl=null;var pl=null;var Nl=0,Dl=0,Ml=0,Gl=0,Bl=0,Hl=0,ml=0;var wl=false;var bl=false;var xl=0,yl=0;var Wl=[];var Ul=0;var kl=[];var Xl=0,Kl=0,Yl=0,Vl=0;var jl=false,Jl=false,zl=false;var Zl=[];var Ql=0,ql=0;var $l=0;var ta=null;var ea=false;var ra=[],ia=[],fa=[];var la=0;var aa=false;var na=0,ca=0,sa=0;var _a=false,oa=false,ua=false;var Ta=0,Aa=0,Ea=0,Ra=0;var La=0;var Ca=null,Ia=null;var da=0,Fa=0,ga=0,Pa=0;var Sa=null;var ha=null;var Oa=0;var va=0;var pa=100;var Na=100;var Da=0;var Ma=0,Ga=0,Ba=0,Ha=0;var ma=0,wa=0,ba=0,xa=0;var ya=0;var Wa=0;var Ua=false,ka=false,Xa=false;var Ka=false,Ya=false,Va=false;var ja=0,Ja=0;var za=null;var Za=0,Qa=0,qa=0,$a=0;var tn=false,en=false,rn=false;var fn=0,ln=0,an=0,nn=0,cn=0,sn=0,_n=0,on=0,un=0,Tn=0,An=0,En=0,Rn=0,Ln=0,Cn=0,In=0,dn=-1,Fn=0,gn=0;var Pn=[];var Sn=[];var hn=false,On=false,vn=false;var pn=0,Nn=0;var Dn=0,Mn=0;var Gn=0;var Bn=0;var Hn=0;var mn="";var wn=[];var bn=0,xn=0;var yn=0;var Wn=0,Un=0;var kn=0,Xn=0;var Kn=false;var Yn=[];var Vn=0,jn=0,Jn=0;var zn=null,Zn=null;var Qn=false,qn=false,$n=false;var ec=0,rc=0,ic=0,fc=0;var lc=[tc.MAX_THEME_COLORS];var ac=[];var nc=[];var cc=[];var _c=[];var oc=[];var uc=[];var Tc=[];var Ac=0,Ec=0,Rc=0;var Lc=false,Cc=false;var Ic="";var dc=[];var Fc=[];var gc=[];var Pc=[];var Sc=[];var hc=0;var Oc=0;var vc=false;var pc=[];var Nc=[];var Dc=0,Mc=0;var Gc=0;var Bc=0;var Hc=0;var mc=[];var wc=0,bc=0;var xc=[];var yc=0,Wc=0;var Uc=[];var kc=0,Xc=0;var Kc=[];var Yc=[];var Vc=0,jc=0;var Jc=[];var zc=0,Zc=0;var Qc=0,qc=0;var $c=0,ts=0;var es=0,rs=0;var is=null,fs,ls,as;var ns="",cs="",ss="",_s="",os="",us="";var Ts=0,As=0;var Es=null;var Rs=null;var Ls=0,Cs=0,Is=0,ds=0,Fs=0,gs=0;var Ps=false,Ss=false;var hs=0;var Os=false;var vs=[];var ps=[];var Ns=0;var Ds=0,Ms=0,Gs=0,Bs=0;var Hs;var ms=0,ws=0;var bs=[];var xs=[];var ys=[];var Ws=[];var Us="";var ks=tc.DEFAULT_CHARSET;var Xs=[];var Ks=[];var Ys=0,Vs=0,js=0,Js=0;var zs="";var Zs=0;var Qs=0,qs=0,$s=0;var t_=false,e_=false,r_=false;var i_=0,f_=0;var l_=0;var a_=0;var n_="",c_="";var s_=0;var __=10;var o_=[];var u_="";var T_="";var A_=null;var E_="";var R_=0;var L_="";var C_="";var I_=0;var d_=[];var F_=0;var g_=0;var P_=[];var S_=0;var h_=0;var O_=[];var v_=[];var p_=0;var N_="image/*";var D_=[];var M_=0,G_=0;var B_=[];var H_=0,m_=0,w_=0;var b_=0;var x_=0;var y_=0;var W_=[];var U_=null;var k_=0,X_=0,K_=0;var Y_=false,V_=false;var j_=[];var J_=0;var z_=0;var Z_=false,Q_=false;var q_=0;var $_=null;var to=[];var eo=[];var ro=0,io=0,fo=0;var lo=false;var ao=0;var no=0,co=0;var so=0;var _o=[];var oo=false;var uo=0;var To=0,Ao=0,Eo=0,Ro=0,Lo=0,Co=0,Io=0;var Fo=0,go=0;var Po=false,So=false,ho=false,Oo=false;var vo="";var po=[];var No=false;var Do=0;var Mo=null;var Go=null;var Bo=0,Ho=0;var mo="";var wo=0;var bo=null;var xo=0,yo=0,Wo=0,Uo=0;var ko=0,Xo=0,Ko=0,Yo=0,Vo=0,jo=0,Jo=0,zo=0,Zo=0,Qo=0,qo=0,$o=0,tu=0,eu=0,ru=0,iu=0,fu=0;var lu=0,au=0,nu=0,cu=0,su=0,_u=0,ou=0,uu=0;var Tu=null;var Au=false,Eu=false,Ru=false,Lu=false,Cu=false,Iu=false,du=false,Fu=false,gu=false;var Pu=null;var Su=false;var hu=0;var Ou=null;var vu=null;var pu=null;var Nu=0,Du=0;var Mu=false;var Gu=0;var Bu=0;var Hu=0,mu=0,wu=0;var bu=false,xu=false,yu=false,Wu=false,Uu=false,ku=false,Xu=false,Ku=false,Yu=false,Vu=false,ju=false,Ju=false,zu=false;var Zu=0,Qu=0,qu=0;var $u=0,tT=0;var eT=0;var rT=0;var iT=0;var fT=0;var lT=false;var aT=null;var nT=null;var cT=["","200%","150%","100%","75%","50%","25%","10%"];var sT=null;var _T=null;var oT=null;var uT=false;var TT=0,AT=0,ET=0;var RT=0;var LT=false;var CT=null;var IT=null;var dT=null;var FT=null;var gT=0;var PT=0,ST=0;var hT=[];var OT=0;var vT=0;var pT=0,NT=0,DT=0,MT=0;var GT=0,BT=0,HT=0;var mT=false;var wT=[];var bT=0;var xT=0,yT=0,WT=0;var UT=null,kT=null,XT=null,KT=null;var YT=[];var VT=null;var jT=null,JT=null,zT=null,ZT=null,QT=null,qT=null,$T=null,tA=null,eA=null,rA=null,iA=null,fA=null;var lA=0;var aA=0;var nA=null;var cA=null;var sA=0,_A=0,oA=0;var uA=0,TA=0,AA=0,EA=0,RA=0,LA=400,CA=0,IA=0,dA=800,FA=0,gA=0,PA=0,SA=0;var hA=null;var OA=false,vA=false,pA=false,NA=false,DA=false,MA=false,GA=false;var BA=0;var HA=10;var mA=[];var wA=0;var bA=[];var xA=false;var yA=false;var WA=null;var UA=null;var kA=0;var XA=0;var KA=0;var YA=false;var VA=false;var jA=13;var JA="13px Arial";var zA=[];var ZA=[];var QA=[];var qA=[];var $A=false,tE=false;var eE=null;var rE="",iE="",fE="";var lE="";var aE=false,nE=false;var cE=0;var sE=0;var _E=0;var oE=0;var uE=0;var TE=false;var AE=false;var EE=0;var RE=0;var LE=0;var CE=0;var IE=0;var dE=0;var FE=0;var gE=0;var PE=null;var SE=0;var hE="";var OE="";var vE=0;var pE=false,NE=false,DE=false,ME=false,GE=false,BE=false;var HE="";var mE=0;var wE=0;var bE=0;var xE=false,yE=false;var WE=0;var UE=10;var kE=[];var XE=[];var KE=0;var YE=0;var VE=0;var jE=0;var JE=false;var zE=false;var ZE=false;var QE=false;var qE=false;var $E=[];var tR=[];var eR=[];var rR=[];var iR=0,fR=0,lR=0,aR=0,nR=0,cR=0,sR=0;var _R=null;var oR=0,uR=0;var TR=0;var AR=0;var ER=false;var RR=false;var LR=0,CR=0,IR=0,dR=0;var FR=false;var gR=0;var PR=0;var SR=0;var hR=0;var OR=0;var vR=0;var pR=0;var NR=0;var DR=false;var MR=false;var GR=0;var BR=0;var HR;var mR=0;var wR=0;var bR=null;var xR=null;var yR=false,WR=false,UR=false;var kR=0,XR=0,KR=0,YR=0;var VR=false,jR=false,JR=false,zR=false,ZR=false,QR=false,qR=false,$R=false,tL=false,eL=false;var rL=0,iL=0,fL=0;var lL=0;var aL=-1;var nL=-1;var cL=-1;var sL=0;var _L=0;var oL="";var uL=false,TL=false,AL=false,EL=false;var RL=0;var LL=0,CL=0;var IL=[];var dL=0;var FL=0;var gL=[];var PL=[];var SL=80;var hL=-1;var OL=0;var vL=null;var pL=null;var NL=null;var DL=null;var ML=null;var GL=null;var BL=null;var HL=null;var mL=0;var wL=0;var bL=null;var xL=[];var yL=0,WL=0,UL=0,kL=0;var XL=0;var KL=false;var YL="",VL="",jL="";var JL=0;var zL=0;var ZL=false,QL=false,qL=false,$L=false;var tC=0,eC=0;var rC="",iC="",fC="";var lC=[];var aC=null;var nC=null;var cC=null;var sC=null;var _C=null;var oC=null;var uC=null;var TC=null;var AC=null;var EC=null;var RC=null;var LC=null;var CC=null;var IC=null;var dC=null;var FC=null;var gC=null;var PC=0,SC=0,hC=0,OC=0,vC=0,pC=0,NC=0,DC=0,MC=0,GC=0,BC=0,HC=0,mC=0,wC=0,bC=0,xC=0,yC=0,WC=0,UC=0,kC=0,XC=0,KC=0,YC=0,VC=0,jC=0,JC=0,zC=0,ZC=0,QC=0,qC=0,$C=0,tI=0,eI=0,rI=0,iI=0,fI=0,lI=0,aI=0,nI=0,cI=0,sI=0,_I=0,oI=0,uI=0,TI=0,AI=0,EI=0,RI=0,LI=0,CI=0,II=0,dI=0,FI=0,gI=0,PI=0,SI=0,hI=0,OI=0,vI=0,pI=0,NI=0,DI=0,MI=0,GI=0,BI=0,HI=0,mI=0,wI=0,bI=0,xI=0,yI=0,WI=0,UI=0,kI=0,XI=0,KI=0,YI=0,VI=0,jI=0,JI=0,zI=0,ZI=0,QI=0,qI=0,$I=0,td=0,ed=0,rd=0,id=0,fd=0,ld=0,ad=0,nd=0,cd=0,sd=0,_d=0,od=0,ud=0,Td=0,Ad=0,Ed=0,Rd=0,Ld=0,Cd=0,Id=0,dd=0,Fd=0,gd=0,Pd=0,Sd=0,hd=0,Od=0,vd=0,pd=0,Nd=0,Dd=0,Md=0,Gd=0,Bd=0,Hd=0,md=0,wd=0,bd=0,xd=0,yd=0,Wd=0,Ud=0,kd=0,Xd=0,Kd=0,Yd=0,Vd=0,jd=0;var Jd=[];var zd=[];var Zd=[];var Qd=0;var qd=0;var $d=null;var tF=null;var eF=0,rF=0;var iF=null;var fF=false,lF=false,aF=false,nF=false,cF=false,sF=false,_F=false,oF=false,uF=false,TF=false,AF=false,EF=false;var RF=null;var LF,CF=null;var IF=0,dF=0,FF=0,gF=0,PF=0,SF=0,hF=0;var OF=0,vF=0,pF=0,NF=0,DF=0,MF=0,GF=0,BF=0,HF=0,mF=0,wF=0;var bF=null,xF=null,yF=null,WF=null;var UF=0,kF=0;var XF=false;var KF=false,YF=false;var VF=0;var jF=null;var JF=0,zF=0,ZF=0,QF=0,qF=0,$F=0,eg=0,rg=0,ig=0;var fg=0,lg=0,ag=0,ng=0,cg=0,sg=0,_g=0,og=0,ug=0,Tg=0;var Ag=null;var Eg=0,Rg=0,Lg=0,Cg=0;var Ig=0,dg=0,Fg=0,gg=0,Pg=0,Sg=0,hg=0,Og=0,vg=0,pg=0,Ng=0,Dg=0;var Mg=false;var Gg=null,Bg=null;var Hg=null,mg=null,wg=null,bg=null;var xg=0,yg=0,Wg=0;var Ug=0,kg=0,Xg=0,Kg=0;var Yg;var Vg=[],jg=[],Jg=[],zg=[];var Zg=[],Qg=[];var qg=false,$g=false;var tP=0,eP=0,rP=0,iP=0,fP=0,lP=0;var aP=false,nP=false,cP=false,sP=false;var _P=null;var oP=[];var uP=[];var TP="";var AP="";var EP="";var RP="";var LP="",CP="",IP="",dP="",FP="",gP="",PP="",SP="",hP="",OP="",vP="",pP="",NP="",DP="",MP="",GP="",BP="",HP="",mP="";var wP=null;var bP=null;var xP=null;var yP=null,WP=null,UP=null;var kP=0;var XP=null;var KP=null;var YP=null;var VP=null;var jP=null;var JP=null;var zP=null;var ZP=null;var QP=null;var qP=null;var $P=null;var tS=null;var eS=null;var rS=null;var iS=null;var fS=null;var lS=null;var aS=null;var nS=null;var cS=null;var sS=null;var _S=null;var oS=null;var uS=null;var TS=null,AS=null;var ES=false,RS=false,LS=false,CS=false,IS=false,dS=false,FS=false,gS=false,PS=false,SS=false,hS=false,OS=false,vS=false,pS=false,NS=false;var DS=[];var MS=[];var GS=null;var BS=null;var HS=false;var mS=[];var wS=false;var bS=null;var xS=0,yS=[],WS=[],US=[],kS=[];TextHandleEvents=[];var XS="M/d/yyyy";var KS="";var YS=null;var VS=null;var jS=null;var JS=null;var zS=0;var ZS=0;var QS="";var qS=[];var $S=0;var th=0;var eh=null;var rh=false;var ih="";var fh="";var lh=0,ah=0,nh=0,ch=0,sh=0,_h=0,oh=0,uh=0;var Th=false,Ah=false;var Eh=null;var Rh=20;var Lh=20;var Ch=[];var Ih=[];var dh=[];var Fh=[];var gh=[];var Ph=[];var Sh=[];var hh=0;var Oh=tc.MAX_SPEED_KEYS;var vh=false,ph=false,Nh=false,Dh=false,Mh=false,Gh=false,Bh=false,Hh=false,mh=false;var wh=0;var bh=null;var xh=0,yh=0,Wh=0,Uh=0;var kh=false,Xh=false,Kh=false,Yh=false;var Vh=0;var jh=0;var Jh=0;var zh=0;var Zh=0;var Qh=0;var qh=0;var $h=0;var tO=0;var eO=0;var rO=0;var iO=0;var fO=0;var lO=0;var aO=0,nO=0,cO=0;var sO=null,_O=null;var oO=null;var uO=null;var TO="";var AO=[];var EO=0,RO=0;var LO=[];var CO=[];var IO=[];var dO=0;var FO=0;var gO="";var PO=0;var SO=false;var hO="";var OO="";var vO=0;var pO=null;var NO=null;var DO="";var MO=0;var GO=0;var BO=null;var HO=[];var mO=[];var wO=null;var bO=0;var xO=0;var yO=0;var WO=new tc.Color(16185078);var UO=false;var kO=null;var XO=null;var KO="";var YO="";var VO=[];var jO=[];var JO="",zO="";var ZO=[];var QO=0;var qO="";var $O="";var tv="";var rv=null;var iv=null;var fv="";var lv=true;this.TerInitInst=function(t,e){te=t;var r=document.getElementById(t);r.terdata=_i;r.caret=_i.caret;r.id=t;_i.cvs=r;ee=r;Ti=et=ee.getContext("2d");zv();Gy();vv();_i.caret.setCanvas(_i.cvs);$v(e)};var av=null;var nv=null;var cv=null;var sv=null;var _v=null;var ov=null;var uv=null;var Tv=null;var Av=null;var Ev=null;var Rv=null;var Lv=null;var Cv=null;var Iv=null;var dv=null;var Fv=null;var gv=null;var Pv=null;var Sv=null;var hv=[];var Ov=[];function vv(){_i.clipdiv=document.createElement("div");_i.clipdiv.style.position="absolute";_i.clipdiv.style.left="-100px";_i.clipdiv.style.top="15px";_i.clipdiv.style.width="1px";_i.clipdiv.style.height="1px";_i.clipdiv.style.backgroundColor="#000";_i.clipdiv.style.zIndex="-1";_i.cvs.parentElement.appendChild(_i.clipdiv);_i.textarea=document.createElement("textarea");_i.textarea.style.border="none";_i.textarea.value=" ";_i.textarea.id="textareafor"+te;_i.textarea.style.top=_i.cvs.style.top;_i.textarea.style.left=_i.cvs.style.left;_i.textarea.style.width="1px";_i.textarea.style.height="20px";_i.clipdiv.appendChild(_i.textarea);_i.VirtTextarea=document.createElement("textarea");_i.VirtTextarea.style.border="none";_i.VirtTextarea.value="";_i.VirtTextarea.id="virttextareafor"+te;_i.VirtTextarea.style.top=_i.cvs.style.top;_i.VirtTextarea.style.left=_i.cvs.style.left;_i.VirtTextarea.style.width="1px";_i.VirtTextarea.style.height="20px";_i.clipdiv.appendChild(_i.VirtTextarea);_i.VirtTextarea.addEventListener("focus",av=function(t){xv(t,te);jD(t,te)});_i.VirtTextarea.addEventListener("input",nv=function(t){zD(t,te)});_i.VirtTextarea.addEventListener("blur",av=function(t){JD(t,te)});window.addEventListener("keydown",aC=function(t){if(t.which==8||t.which==9||t.which==17||t.which==32||t.ctrlKey&&t.keyCode==tc.CHAR_A||vS&&t.metaKey&&t.keyCode==tc.CHAR_A){if(t.target.tagName.toUpperCase()=="CANVAS"){t.preventDefault();t.stopPropagation()}}});window.addEventListener("keypress",nC=function(t){if(t.which==32){if(t.target.tagName.toUpperCase()=="CANVAS"){t.preventDefault()}}});window.addEventListener("keyup",cC=function(t){if(t.which==32){if(t.target.tagName.toUpperCase()=="CANVAS"){t.preventDefault()}}});window.addEventListener("resize",sC=function(t){if(Ti!=null)lG(Ti)});window.addEventListener("touchmove",gC=function(t){if(Dj(lO&tc.TFLAG11_DISABLE_TOUCH_SCROLL)&&QU()&&_i.DlgLevel==0&&af)t.preventDefault()},{passive:false});document.addEventListener("contextmenu",_C=function(t){var e=t.clientX;var r=t.clientY;var i;var f=document.getElementById(te);if(f==null)return;i=f.getBoundingClientRect();if(WH(e,r,i.left,i.top,i.width,i.height))t.preventDefault()});document.addEventListener("click",oC=function(t){wv(t,te)});document.addEventListener("dblclick",uC=function(t){wv(t,te)});_i.cvs.addEventListener("click",cv=function(t){bv(t,te)});_i.cvs.addEventListener("dblclick",sv=function(t){bv(t,te)});_i.cvs.addEventListener("mousedown",_v=function(t){bv(t,te)});_i.cvs.addEventListener("mouseenter",ov=function(t){bv(t,te)});_i.cvs.addEventListener("mouseleave",uv=function(t){bv(t,te)});_i.cvs.addEventListener("mousemove",Tv=function(t){bv(t,te)});_i.cvs.addEventListener("mouseover",Av=function(t){bv(t,te)});_i.cvs.addEventListener("mouseout",Ev=function(t){bv(t,te)});_i.cvs.addEventListener("mouseup",Rv=function(t){bv(t,te)});_i.cvs.addEventListener("wheel",Lv=function(t){bv(t,te)});_i.cvs.addEventListener("touchstart",Fv=function(t){bv(t,te)});_i.cvs.addEventListener("touchend",gv=function(t){bv(t,te)});_i.cvs.addEventListener("touchcancel",Pv=function(t){bv(t,te)});_i.cvs.addEventListener("touchmove",Sv=function(t){bv(t,te)});_i.cvs.addEventListener("focus",Cv=function(t){xv(t,te)});_i.cvs.addEventListener("focusout",Iv=function(t){yv(t,te)});_i.cvs.addEventListener("blur",dv=function(t){Wv(t,te)});var t;hv=[];Ov=[];var e=0;for(t=_i.cvs.parentElement;t!=null&&t!=undefined;t=t.parentElement){if(/body|html/i.test(t.tagName.toLowerCase()))break;if(/absolute|relative|fixed|sticky/i.test(t.style.position))break;Ov[e]=t;t.addEventListener("scroll",hv[e]=function(t){Yv(t,te)});e++}if(!_i.cvs.tabIndex)_i.cvs.tabIndex=0;document.addEventListener("keydown",TC=function(t){Uv(t,te)});document.addEventListener("keyup",AC=function(t){Uv(t,te)});document.addEventListener("keypress",EC=function(t){Uv(t,te)});document.addEventListener("cut",RC=function(t){kv(t,te)});document.addEventListener("copy",LC=function(t){kv(t,te)});document.addEventListener("paste",CC=function(t){kv(t,te)});document.addEventListener("beforecut",IC=function(t){kv(t,te)});document.addEventListener("beforecopy",dC=function(t){kv(t,te)});document.addEventListener("beforepaste",FC=function(t){kv(t,te)});_i.cvs.addEventListener("contextmenu",function(t){if(t.button===tc.BUTTON_RIGHT){t.preventDefault();return false}},false)}function pv(){_i.VirtTextarea.removeEventListener("focus",av);_i.VirtTextarea.removeEventListener("input",nv);window.removeEventListener("keydown",aC);window.removeEventListener("keypress",nC);window.removeEventListener("keyup",cC);window.removeEventListener("keyup",sC);window.removeEventListener("touchmove",gC);document.removeEventListener("contextmenu",_C);document.removeEventListener("click",oC);document.removeEventListener("dblclick",uC);document.removeEventListener("keydown",TC);document.removeEventListener("keyup",AC);document.removeEventListener("keypress",EC);document.removeEventListener("cut",RC);document.removeEventListener("copy",LC);document.removeEventListener("paste",CC);document.removeEventListener("beforecut",IC);document.removeEventListener("beforecopy",dC);document.removeEventListener("beforepaste",FC);_i.cvs.removeEventListener("click",cv);_i.cvs.removeEventListener("dblclick",sv);_i.cvs.removeEventListener("mousedown",_v);_i.cvs.removeEventListener("mouseenter",ov);_i.cvs.removeEventListener("mouseleave",uv);_i.cvs.removeEventListener("mousemove",Tv);_i.cvs.removeEventListener("mouseover",Av);_i.cvs.removeEventListener("mouseout",Ev);_i.cvs.removeEventListener("mouseup",Rv);_i.cvs.removeEventListener("wheel",Lv);_i.cvs.removeEventListener("touchstart",Fv);_i.cvs.removeEventListener("touchend",gv);_i.cvs.removeEventListener("touchcancel",Pv);_i.cvs.removeEventListener("touchmove",Sv);_i.cvs.removeEventListener("focus",Cv);_i.cvs.removeEventListener("focusout",Iv);_i.cvs.removeEventListener("blur",dv);var t=0;for(t=0;t<hv.length;t++)Ov[t].removeEventListener("scroll",hv[t]);VQ(tc.CURSOR_HANDLE_IDX);VQ(tc.SEL_BEG_HANDLE_IDX);VQ(tc.SEL_END_HANDLE_IDX)}_i.TerCreateControl=function(){return true};function Nv(){var t=Ti}function Dv(t,e,r){e=Math.round(e);var i=e<<16;if(DX(tc.WM_VSCROLL,e,0))return;if(t=="up")YD(i|tc.SB_LINEUP);else if(t=="down")YD(i|tc.SB_LINEDOWN);else if(t=="pageup")YD(i|tc.SB_PAGEUP);else if(t=="pagedown")YD(i|tc.SB_PAGEDOWN);else if(t=="thumbmoved")YD(i|tc.SB_THUMBPOSITION);else if(t=="thumbmoving")YD(i|tc.SB_THUMBTRACK);NX(tc.WM_VSCROLL,e,0)}function Mv(t,e,r){e=Math.round(e);var i=e<<16;if(DX(tc.WM_HSCROLL,e,0))return;if(t=="up")VD(i|tc.SB_LINELEFT);else if(t=="down")VD(i|tc.SB_LINERIGHT);else if(t=="pageup")VD(i|tc.SB_PAGELEFT);else if(t=="pagedown")VD(i|tc.SB_PAGERIGHT);else if(t=="thumbmoved")VD(i|tc.SB_THUMBPOSITION);else if(t=="thumbmoving")VD(i|tc.SB_THUMBTRACK);NX(tc.WM_HSCROLL,e,0)}function Gv(t,e,r){}function Bv(t,e,r){}function Hv(t,e,r){}function mv(t,e,r){var i=null;if(t=="enter"||t=="click"){var f="12pt Arial";var l=25;var a="#000000";var n="#ffffff";var c="#ff0000";i=new $t.DialogBox(r,"Test Dialog",f,true,function(t,e,r){F(t,e,r)});var s=i.cvs;var _=new $t.Label(s,0,0,f,"File Name");i.addComp(_,0,0,1,1,"Left","bottom");var o=new $t.TextBox(s,0,0,400,l,"test.jpg",f,_i.caret,false,true,null);i.addComp(o,1,0,1,3,"left","top");var u=new $t.Button(s,0,0,100,l,f,"Browse..",true,function(t,e){vU("Open File",true,"test.jpg",".","",function(t,e){console.log("selected: ",t[0].name,e);if(e.length>0)o.setText(e)})});i.addComp(u,0,2,1,1,"right","bottom",0,-2);i.addGroupBox(2,0,2,1,"","",0,-5);var T=new $t.CheckBox(s,0,0,15,16,f,"Read only",true,null);i.addComp(T,2,0,1,1,"left","middle");var A=new $t.CheckBox(s,0,0,15,16,f,"Is RTF file",true,null);i.addComp(A,3,0,1,1,"Left","top");i.addGroupBox(2,2,3,1,"Font size","10pt Arial",0,+3);var E=new $t.RadioButton(s,0,0,15,f,"Small",false,null,null);i.addComp(E,2,2,1,1,"left","bottom");var R=new $t.RadioButton(s,0,0,15,f,"Medium",true,E,null);i.addComp(R,3,2,1,1,"left","middle");var L=new $t.RadioButton(s,0,0,15,f,"Big",false,R,null);i.addComp(L,4,2,1,1,"left","top");i.addGroupBox(6,0,1,3,"","",0,-3);var C=new $t.Button(s,0,0,100,l,f,"Text Color..",true,function(t,e){Dy("Text Color","text",a,function(t){a=t})});i.addComp(C,6,0,1,1,"left","middle",0,-2);var I=new $t.Button(s,0,0,100,l,f,"Background..",true,function(t,e){Dy("Background Color","bknd",n,function(t){n=t})});i.addComp(I,6,1,1,1,"left","middle",0,-2);var d=new $t.Button(s,0,0,100,l,f,"Line Color..",true,function(t,e){Dy("Border Color","line",c,function(t){c=t})});i.addComp(d,6,2,1,1,"left","middle",0,-2);i.show()}function F(t,e,r){i.hide()}}function wv(t,e){if(Nr)return false;var r=document.getElementById(e);if(r==null)return;if(t.type=="click"||t.type=="dblclick"){var i=t.clientX;var f=t.clientY;var l;l=r.getBoundingClientRect();if(WH(i,f,l.left,l.top,l.width,l.height))_i.HasFocus=true;if(!_i.HasFocus&&_i.caret)_i.caret.hide();if(!_i.HasFocus&&_i.dialog){l=_i.dialog.cvs.getBoundingClientRect();_i.HasFocus=WH(i,f,l.left,l.top,l.width,l.height)}}}function bv(t,e){var r,i;if(Nr)return false;ha.altKey=t.altKey;ha.button=t.button;ha.buttons=t.buttons;ha.clientX=t.clientX;ha.clientY=t.clientY;ha.ctrlKey=t.ctrlKey;ha.movementX=t.movementX;ha.movementY=t.movementY;ha.offsetX=t.offsetX;ha.offsetY=t.offsetY;ha.screenX=t.screenX;ha.screenY=t.screenY;ha.shiftKey=t.shiftKey;ha.which=t.which;var f=document.getElementById(e);if(f==null)return;var l=$t.GetTerData(e);if(!l)return;if(l.DlgLevel>0)return;if(!oi.open)return;if(!Lk(t.type,"touch"))t.preventDefault();if(l.ForgetMouseUp&&(t.type=="mouseup"||t.type=="mousedown")){l.ForgetMouseUp=false;if(t.type=="mouseup")return}if(t.type=="mousedown")fN();if(f.comps){if(f.comps.OnMouseEvent(t))return}if(t.type=="mousedown"){if(DX(tc.WM_LBUTTONDOWN,t,0))return;if(GS!=null){document.body.removeChild(GS);GS=null}aM(t);NX(tc.WM_LBUTTONDOWN,t,0)}else if(t.type=="mouseup"){if(DX(tc.WM_LBUTTONUP,t,0))return;var a=t.timeStamp;if(a-CA<LA&&!l.IsMobileOS){sM(t)}else nM(t);CA=a;NX(tc.WM_LBUTTONUP,t,0)}else if(t.type=="mouseout"){if(uA!=tc.HILIGHT_OFF&&OA)nM(t)}else if(t.type=="mousemove"){if(DX(tc.WM_MOUSEMOVE,t,0))return;if(l.HasTouchScreen&&(new Date).getTime()-xS<50){if(l.UseVirtKeyboard)l.VirtTextarea.focus({preventScroll:true});else l.cvs.focus({preventScroll:true});if(uA!=tc.HILIGHT_OFF)cG()}else cM(t);NX(tc.WM_MOUSEMOVE,t,0)}else if(t.type=="dblclick"){if(uA!=tc.HILIGHT_OFF)OA=false}else if(t.type=="wheel")_M(t);else if(t.type=="click"){if(l.caret){l.caret.setCanvas(l.cvs);if(!QU())l.cvs.focus({preventScroll:true});else if(zR&&!ZR&&_l&&l.dialog==null){if(!l.caret.visible)l.caret.position(l.caret.CurX,l.caret.CurY)}if(l.dialog==null&&QU())rM(t)}}else if(t.type=="touchstart"){IA=t.timeStamp;hA=t;var n=t.touches;var c=n.item(0);PA=c.pageX;SA=c.pageY;pos=tc.GetElementPosition(f);r=PA-pos.x;i=SA-pos.y;af=false;if(r>=rt.left&&r<=rt.left+je&&i>=rt.top&&i<=rt.top+Mt)af=true}else if(t.type=="touchend"){if(t.timeStamp-IA>dA){pos=tc.GetElementPosition(f);r=PA-pos.x;i=SA-pos.y;var s=PA+(SA<<16);var _=r+(i<<16);if(DX(-tc.ACTION_LONG_PRESS,hA,0))return;if(NX(-tc.ACTION_LONG_PRESS,hA,0))return}af=false}else if(t.type=="touchcancel"){af=false}else if(t.type=="touchmove"){if(DX(-tc.ACTION_TOUCH_MOVE,t,0))return;if(Dj(lO&tc.TFLAG11_DISABLE_TOUCH_SCROLL)&&af){if(Kv(t))t.preventDefault()}if(NX(-tc.ACTION_TOUCH_MOVE,t,0))return}}function xv(t,e){if(Nr)return false;if(oi.open&&_i.dialog==null){_i.HasFocus=true;rM(t)}}function yv(t,e){}function Wv(t,e){if(Nr)return false;if(_i.UseVirtKeyboard&&document.activeElement===_i.VirtTextarea)return;if(Sa.which==17)return;if(_i.cvs==null)return;if(DX(tc.WM_KILLFOCUS,t,0))return;_i.HasFocus=false;if(!zR&&sq())_q();if(zR&&!ZR&&_i.dialog==null&&_i.caret!=null)_i.caret.hide();NX(tc.WM_KILLFOCUS,t,0)}function Uv(t,e){if(Nr||!nf)return false;var r=document.getElementById(e);if(r==null)return;var i=$t.GetTerData(e);if(t.ctrlKey){if(t.charCode==tc.CHAR_c||t.charCode==tc.CHAR_C)return false;if(t.charCode==tc.CHAR_x||t.charCode==tc.CHAR_X)return false;if(t.charCode==tc.CHAR_v||t.charCode==tc.CHAR_V)return false}else if(vS&&t.metaKey){if(t.charCode==tc.CHAR_c||t.charCode==tc.CHAR_C)return false;if(t.charCode==tc.CHAR_x||t.charCode==tc.CHAR_X)return false;if(t.charCode==tc.CHAR_v||t.charCode==tc.CHAR_V)return false}if(!i.HasFocus)return false;Sa=tc.clone(t,true);if(i.UseVirtKeyboard&&document.activeElement===i.VirtTextarea){Sa.shiftKey=Sa.ctrlKey=Sa.ctrlKey=false}va=(new Date).getTime();if(t.ctrlKey&&!vS){if(t.type=="keydown"){r.terdata.textarea.value=" ";r.terdata.textarea.select()}else if(t.type=="keyup"){r.terdata.textarea.value=""}}if(i.DlgLevel>0&&i.DlgKeyListener)return i.DlgKeyListener(t,e);if(r.comps){if(r.comps.OnKeyEvent(t))return true}if(t.type=="keypress"){if(!i.UseVirtKeyboard)$D(t)}else if(t.type=="keyup")tM(t);else if(t.type=="keydown")eM(t);if(DS.length>0&&t.type=="keydown"){var f;for(f=0;f<DS.length;f++){if(t.which==DS[f]){if(MS[f].length==1)jH(MS[f].charCodeAt(0));else if(MS[f].length>1)i.InsertTerText(MS[f]);break}}if(f<DS.length)t.preventDefault()}else if(t.which==191&&tg.InFireFox){if(t.type=="keydown"){jH("/".charCodeAt(0));t.preventDefault()}}return false}function kv(t,e){if(Nr)return false;var r=document.getElementById(e);if(r==null)return;var i=$t.GetTerData(e);if(!i.HasFocus)return false;t.preventDefault();if(i.DlgLevel>0&&i.DlgCBListener)return i.DlgCBListener(t,e);if(r.comps){if(r.comps.OnCBEvent(t))return true}return KN(t)}function Xv(t,e){if(Nr)return false;var r=$t.GetTerData(e);if(r.cvs==null)return;if(r.DlgLevel>0)return;r.MouseX=t.clientX;r.MouseY=t.clientY;r.MouseX=r.MouseX-r.cvs.getBoundingClientRect().left-r.cvs.clientLeft+r.cvs.scrollLeft;r.MouseY=r.MouseY-r.cvs.getBoundingClientRect().top-r.cvs.clientTop+r.cvs.scrollTop;r.caret.position(r.MouseX,r.MouseY);var i=r.cvs.getContext("2d");i.save();i.setTransform(1,0,0,1,0,0);i.font="20px Arial";i.fillText("Clicky",r.MouseX,r.MouseY);i.restore()}function Kv(t){var e=2;var r=false;var i=false;var f=0;if(Nr)return false;if(_i.DlgLevel>0)return false;var l=t.touches;if(t.touches.length>1)return false;var a=l.item(0);var n=a.pageX;var c=a.pageY;if(Math.abs(SA-c)>e||Math.abs(PA-n)>e){if(VR)cq();if(Ka)HB();if(QE){uA=tc.HILIGHT_OFF;QE=false;cG()}if(mS[tc.CURSOR_HANDLE_IDX]!=null)mS[tc.CURSOR_HANDLE_IDX].style.visibility="hidden"}if(Math.abs(SA-c)>e){if(c>SA){if(Gt>0){Gt+=SA-c;if(Gt<0)Gt=0;SA=c;BG();cG()}else Qz()}else{f=SA-c;if(Gt+f<ze){Gt+=f;SA=c;i=true}else qz()}}if(Math.abs(PA-n)>e){f=PA-n;Ft+=f;if(Ft<0)Ft=0;PA=n;i=true}if(i){BG();ai=ni=$R=true;OA=ci=CanPostpone=false;cG()}return true}function Yv(t,e){if(Nr)return false;var r=document.getElementById(e);if(r==null)return;if(mS[tc.CURSOR_HANDLE_IDX]!=null)mS[tc.CURSOR_HANDLE_IDX].style.visibility="hidden";if(zR&&!ZR&&_l&&_i.dialog==null){_i.caret.hide();_i.caret.position(_i.caret.CurX,_i.caret.CurY)}Vv(false);return true}function Vv(t){var e;var r;Tt=Mt;At=je;CssWinHeight=e=zV(Mt);CssWinWidth=r=zV(je);CssWinRectTop=zV(rt.top);CssWinRectLeft=zV(rt.left);var i=tc.GetElementPosition(ee);var f=i.x;var l=i.y;fe=fG();var a=fe;if(t){if(fe/window.devicePixelRatio>700)a=a*2/3;else a=a/2}if(_i.InIPhone)a=fe;if(l+CssWinHeight+CssWinRectTop>a){e=a-l-CssWinRectTop;var n=e;if(_i.InSafari)e-=zV(xs[0].height);if(ui[br]!=null&&e<zV(ui[br].height))e=zV(ui[br].height);if(e>n)e=n;if(e<=0)e=zV(xs[0].height);if(e>CssWinHeight)e=CssWinHeight}if(f+CssWinWidth+CssWinRectLeft>Lt){r=Lt-f-CssWinRectLeft;r=r*9/10;if(r>CssWinWidth)r=CssWinWidth}Tt=JV(e);At=JV(r);return true}_i.TerSwapKeyCode=function(t,e){if(t<=0){DS=[];MS=[]}else{DS.push(t);MS.push(e)}return DS.length};_i.TerIgnoreEvents=function(t){PrevSuspendEvents=Nr;Nr=t;return PrevSuspendEvents};_i.TerGetCanvasX=function(){var t=tc.GetElementPosition(_i.cvs);return t.x};_i.TerGetCanvasY=function(){var t=tc.GetElementPosition(_i.cvs);return t.y};$t.GetTerData=function(t){var e=document.getElementById(t);if(e==null)return null;return e.terdata};function jv(t){var e=document.getElementById(t);var r=e.getContext("2d");r.font="30px Arial";var i=new tc.ClsTehData;i.msg="after waking up";i.y+=50;Jv(i,r)}function Jv(t,e){e.fillText(t.msg,t.x,t.y)}function zv(){if(tg.TerOpenCount==0)Zv();a=new tc.arg_list;oi=new tc.arg_list;a.WordWrap=true;a.PageMode=true;a.PrintView=true;a.FittedView=false;a.ShowHorBar=false;a.ShowVerBar=true;a.ruler=false;a.ToolBar=false;a.BorderMargin=true;a.ReadOnly=false;a.SaveFormat=tc.SAVE_RTF;a.delim=13;$A=false;_l=true;ve=1;a.FontTypeFace="Arial";a.PointSize=12;a.file="";a.hBuffer="";a.BufferLen=0;a.InputType=tc.CHAR_B;zh=tg.TerInitFlags;Zh=tg.TerInitFlags2;Qh=tg.TerInitFlags3;qh=tg.TerInitFlags4;$h=tg.TerInitFlags5;tO=tg.TerInitFlags6;eO=tg.TerInitFlags7;rO=tg.TerInitFlags8;iO=tg.TerInitFlags9;fO=tg.TerInitFlags10;lO=tg.TerInitFlags11;jT=tc.CLR_WHITE;tA=tc.CLR_WHITE;S=0;gN();return true}function Zv(){var t,e,r;var i,f;tg.InitMbcs=false;tg.InFireFox=typeof InstallTrigger!=="undefined";if(tg.InFireFox)tg.InIE=false;mf=null;wf=null;tg.TotalWinPtrs=0;tg.GlbPrtDC=null;tg.GlbPrtDCCount=0;tg.IsWinNT2000=false;tg.OSCanRotate=false;tg.IsWindows=false;t=-1;t++;tg.DateFieldText[t]=XS;t++;tg.DateFieldText[t]="www, MMM d, yyyy";t++;tg.DateFieldText[t]=!nV(XS,"M/d/yyyy")?"M/d/yyyy":"d/M/yyyy";t++;tg.DateFieldText[t]="yyyy-MM-dd";t++;tg.DateFieldText[t]="d-MMM-yy";t++;tg.DateFieldText[t]=nV(XS,"M/d/yyyy")?"M.d.yy":"d.M.yy";t++;tg.DateFieldText[t]="MMM. d, yy";t++;tg.DateFieldText[t]="d MMMM, yyyy";t++;tg.DateFieldText[t]="MMMM, yy";t++;tg.DateFieldText[t]="MMM-yy";t++;tg.DateFieldText[t]=nV(XS,"M/d/yyyy")?"M/d/yy h:mm am/pm":"d/M/yy h:mm am/pm";t++;tg.DateFieldText[t]=nV(XS,"M/d/yyyy")?"M/d/yy h:mm:ss am/pm":"d/M/yy h:mm:ss am/pm";t++;tg.DateFieldText[t]="h:mm am/pm";t++;tg.DateFieldText[t]="h:mm:ss am/pm";t++;tg.DateFieldText[t]="HH:mm";t++;tg.DateFieldText[t]="HH:mm:ss";tg.TotalDateFmts=t+1;tg.WeekDays[0]="Sunday";tg.WeekDays[1]="Monday";tg.WeekDays[2]="Tuesday";tg.WeekDays[3]="Wednesday";tg.WeekDays[4]="Thursday";tg.WeekDays[5]="Friday";tg.WeekDays[6]="Saturday";tg.MonthNames[0]="January";tg.MonthNames[1]="February";tg.MonthNames[2]="March";tg.MonthNames[3]="April";tg.MonthNames[4]="May";tg.MonthNames[5]="June";tg.MonthNames[6]="July";tg.MonthNames[7]="August";tg.MonthNames[8]="September";tg.MonthNames[9]="October";tg.MonthNames[10]="November";tg.MonthNames[11]="December";t=0;tg.DefPaperSize[t]=tc.DMPAPER_LETTER;tg.DefPaperName[t]="Letter";tg.DefPaperWidth[t]=8.5;tg.DefPaperHeight[t]=11;t=1;tg.DefPaperSize[t]=tc.DMPAPER_LEGAL;tg.DefPaperName[t]="Legal";tg.DefPaperWidth[t]=8.5;tg.DefPaperHeight[t]=14;t=2;tg.DefPaperSize[t]=tc.DMPAPER_LEDGER;tg.DefPaperName[t]="Ledger";tg.DefPaperWidth[t]=17;tg.DefPaperHeight[t]=11;t=3;tg.DefPaperSize[t]=tc.DMPAPER_TABLOID;tg.DefPaperName[t]="Tabloid";tg.DefPaperWidth[t]=11;tg.DefPaperHeight[t]=17;t=4;tg.DefPaperSize[t]=tc.DMPAPER_STATEMENT;tg.DefPaperName[t]="Statement";tg.DefPaperWidth[t]=5.5;tg.DefPaperHeight[t]=8.5;t=5;tg.DefPaperSize[t]=tc.DMPAPER_EXECUTIVE;tg.DefPaperName[t]="Executive";tg.DefPaperWidth[t]=7.25;tg.DefPaperHeight[t]=10.5;t=6;tg.DefPaperSize[t]=tc.DMPAPER_A3;tg.DefPaperName[t]="A3";tg.DefPaperWidth[t]=rj(297);tg.DefPaperHeight[t]=rj(420);t=7;tg.DefPaperSize[t]=tc.DMPAPER_A4;tg.DefPaperName[t]="A4";tg.DefPaperWidth[t]=VV(11907);tg.DefPaperHeight[t]=VV(16840);t=8;tg.DefPaperSize[t]=tc.DMPAPER_A5;tg.DefPaperName[t]="A5";tg.DefPaperWidth[t]=rj(148);tg.DefPaperHeight[t]=rj(210);t=9;tg.DefPaperSize[t]=tc.DMPAPER_B4;tg.DefPaperName[t]="B4";tg.DefPaperWidth[t]=rj(250);tg.DefPaperHeight[t]=rj(354);t=10;tg.DefPaperSize[t]=tc.DMPAPER_B5;tg.DefPaperName[t]="B5";tg.DefPaperWidth[t]=rj(182);tg.DefPaperHeight[t]=rj(257);t=11;tg.DefPaperSize[t]=0;tg.DefPaperName[t]="Custom";tg.DefPaperWidth[t]=-1;tg.DefPaperHeight[t]=-1;tg.DefPaperCount=t+1;tg.StSearched=false;tg.stj=null;tg.SspSearched=false;tg.WininetSearched=false;return true}function Qv(){var t;var e;Vi=false;hi=false;we=0;jt=0;br=0;Xt=0;fr=0;Ri=1;xe=tc.INITIAL_MAX_LINES;Ft=0;Gt=0;iL=0;fL=0;vT=0;pT=0;NT=0;DT=0;Vt=-1;MT=tc.CURS_RESET;Br=tc.PAINT_WIN;zt=0;Ue=-1;it=null;p=null;N=null;D=null;M=null;et=null;ne=0;ur=0;fi=false;li=false;Li=false;aO=0;f=0;Uh=-1;ce=0;se=0;_e=0;oe=0;sO=null;_O=null;aA=200;fo=100;Yh=false;Xr=false;Kr=false;Yr=false;Vr=false;jr=false;DA=false;Zr=false;Qr=true;qr=true;ct=0;st=0;ut=0;gc=null;CR=tc.CELL_MARGIN;gO="";PO=0;SO=false;Re=0;wE=tc.NBR_DEC;bE=tc.NBR_LWR_ROMAN;ao=-1;Ie=0;de=tc.FRAME_DIST_FROM_MARGIN;mr=tc.FLOW_DEF;ii=false;Ha=-1;oO=null;Uh=0;ih="";Tu=null;WE=0;Se=0;vi=false;ih="";kO=null;Kt=0;$l=0;zr=false;so=-1;$T=tc.CLR_WHITE;tn=false;en=false;rn=false;HR=false;mR=0;Bf=false;Hf=false;Gi=true;Hi=true;sr=-1;pe=1;Ji=false;qi=true;$i=false;uo=-1;Qc=-1;tf=false;_h=-1;oh=-1;ha=document.createEvent("MouseEvent");Sa=document.createEvent("KeyboardEvent");for(t=0;t<tc.MAX_THEME_COLORS;t++)lc[t]=tc.CLR_AUTO;vS=navigator!=null&&navigator.platform.toUpperCase().indexOf("MAC")>=0;pS=false;mS[tc.CURSOR_HANDLE_IDX]=null;mS[tc.SEL_BEG_HANDLE_IDX]=null;mS[tc.SEL_END_HANDLE_IDX]=null;TextHandleEvents[tc.CURSOR_HANDLE_IDX]=[];TextHandleEvents[tc.SEL_BEG_HANDLE_IDX]=[];TextHandleEvents[tc.SEL_END_HANDLE_IDX]=[];if(/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)){_i.UseVirtKeyboard=_i.IsMobileOS=_i.HasTouchScreen=true}else if(/Macintosh/i.test(navigator.userAgent)){if(navigator.maxTouchPoints&&navigator.maxTouchPoints>2){_i.InIPad=_i.UseVirtKeyboard=_i.IsMobileOS=_i.HasTouchScreen=true}}if(/iPad/i.test(navigator.userAgent))_i.InIPad=true;if(/iPhone/i.test(navigator.userAgent))_i.InIPhone=true;if(/Safari|webOS|iPhone|iPad|Apple/i.test(navigator.userAgent))_i.InSafari=true;if(/Android/i.test(navigator.userAgent))_i.InAdroid=true;ma=-1;wa=-1;ba=0;xa=0;rh=false;Z_=false;q_=0;$_=null;Tl=tc.MAX_REVIEWERS;v=null;WL=0;UL=0;kL=0;F=null;V=null;W=null;O=null;E=0;d=0;P=null;R=0;h=null;L=0;uL=false;EL=false;TL=false;AL=true;LL=tc.TAB_RIGHT;CL=tc.TAB_DOT;ti=false;ei=false;Q=-1;BO=null;hO="";vO=tc.SAVE_RTF;aL=-1;MO=1033;GO=MO;th=MO;ol=false;er=0;rr=0;oi.modified=0;uA=tc.HILIGHT_OFF;OA=false;pA=false;Ua=true;Xa=true;lr=0;LE=tc.MAX_UNDOS;RE=tc.MAX_INIT_UNDOS;_E=0;oE=0;uE=0;CE=-1;TE=false;Lr=false;lo=false;Xe=0;Ka=false;Ya=false;Va=false;za=null;Sf=null;b_=-1;x_=-1;y_=0;To=1;Eo=1;Ao=0;Lo=0;Ro=-1;Fo=0;ho=false;qe=$e=0;Po=false;Hl=-1;ml=-1;wl=false;Gl=2160;Bl=1440;po=null;W_=null;pl=null;xs=null;bs=null;Xs=null;B_=null;xc=null;mc=null;to=null;eo=null;Ys=0;H_=0;i_=-1;l_=0;a_=0;m_=tc.DEF_TAB_WIDTH;w_=tc.TAB_LEFT;ro=0;dr=false;GR=false;Vh=0;jh=0;Nc=null;Mc=200;Gc=0;Oc=-1;LS=false;Fr=false;Pr=false;Sr=false;hr=false;CS=true;IS=true;dS=false;FS=false;zR=false;ZR=true;VR=true;lL=0;QR=true;ph=true;wh=tc.ULINE;bh=tc.Color.blue;Nh=false;gS=Nj(oi.style&tc.TER_INVISIBLE);PS=false;NA=false;Te=1;gi=true;SS=false;zn=new tc.Color(255,213,213);Zn=new tc.Color(255,0,0);fc=1440*5/4;Gn=0;nc=null;_o=null;cc=null;_c=null;oc=null;uc=null;Tc=null;yn=tc.WRAP_WIN;Mn=1;f_=25;Ec=5;Rc=0;jn=5;Jn=0;kn=0;Xn=0;la=2e3;Wc=50;jc=10;Zc=10;lh=tc.SAVE_RTF;k_=-1;X_=0;K_=5;Y_=false;Nt=wt=Ut=kt=0;nh=100;ch=tc.PAGE_BORDER_MARGIN;xh=yh=0;wA=0;UA=null;kA=-1;XA=-1;KA=-1;Ca=tc.CLR_WHITE;Ia=tc.CLR_WHITE;da=tc.PARA_BOX_SPACE;Fa=tc.PARA_BOX_SPACE;JT=tc.CLR_BLACK;if(nA!=null)nA.Dispose();nA=null;ZT=new tc.Color(8,8,8);zT=new tc.Color(192,192,192);rA=new tc.Color(202,226,255);QT=new tc.Color(143,143,143);qT=tc.CLR_BLACK;iA=new tc.Color(0,0,0);fA=new tc.Color(0,0,0);lA=0;ca=0;sa=0;_a=false;CT=tc.CLR_WHITE;IT=tc.CLR_WHITE;dT=tc.CLR_WHITE;aa=true;na=0;$c=0;ts=0;St=1;ft=tc.MAX_WIDTH-2;lt=4;Tr=true;Ar=true;Er=true;Rr=true;pr=false;Gr=true;Ci=false;pn=55555;Nn=256;Bn=tc.PARA_CHAR;Hn=182;mn=".DOC";re=null;xo=8.5;yo=11;ES=true;RA=200;rE="";iE="";fE="";cE=tc.SRCH_CASE;RS=false;QS="ter_hlp.hlp";Ic="~`!@#$%^&*()-+|=-TeCfMt";ms=191;ws=190;Eu=false;Iu=false;du=false;Su=true;Ru=false;Lu=false;Cu=false;t_=false;e_=false;Bu=1;Hu=0;Ju=true;Pt=0;ai=true;si=true;Ii=true;pE=false;NE=false;DE=false;ME=false;BE=true;GE=false;vh=false;Dh=true;Mh=false;Gh=true;Bh=false;pu=null;mT=false;KE=-1;VE=0;jE=50;JE=false;zE=false;ZE=false;QE=false;qE=false;nR=0;cR=0;iR=0;fR=0;lR=100;aR=200;Yl=50;TR=tc.CELL_CHAR;AR=164;Ta=0;Aa=0;ER=true;yR=false;WR=false;UR=false;Qb(MO);yL=1;if(pS){t=Ws.indexOf(arial);if(t<0){Us="DejaVu Sans";e=Us.toLowerCase();t=Ws.indexOf(e)}if(t<0){Us="Droid Sans";e=Us.toLowerCase();t=Ws.indexOf(e)}if(t<0)Us=""}for(t=0;t<tc.MAX_TLB;t++)qA[t]=0;t=-1;t++;qS[t]=tc.PAGE_CHAR;t++;qS[t]=tc.SECT_CHAR;t++;qS[t]=tc.COL_CHAR;t++;qS[t]=tc.ROW_CHAR;t++;qS[t]=tc.HDR_CHAR;t++;qS[t]=tc.FTR_CHAR;t++;qS[t]=tc.FHDR_CHAR;t++;qS[t]=tc.FFTR_CHAR;t++;qS[t]=tc.RHDR_CHAR;t++;qS[t]=tc.RFTR_CHAR;t++;qS[t]=tc.LHDR_CHAR;t++;qS[t]=tc.LFTR_CHAR;t++;qS[t]=0;LO[tc.INFO_TITLE]="title";LO[tc.INFO_SUBJECT]="subject";LO[tc.INFO_AUTHOR]="author";LO[tc.INFO_MANAGER]="manager";LO[tc.INFO_COMPANY]="company";LO[tc.INFO_OPERATOR]="operator";LO[tc.INFO_CATEGORY]="category";LO[tc.INFO_KEYWORDS]="keywords";LO[tc.INFO_COMMENT]="doccomm";LO[tc.INFO_PWHASH]="passwordhash";LO[tc.INFO_HLINKBASE]="hlinkbase";LO[tc.INFO_SSUSER]="ssuser";for(t=0;t<tc.INFO_MAX;t++)CO[t]=null;hh=t=0;var r=tc.CTRL_MASK;t=qv(t,tc.ID_PGUP,tc.VK_PAGE_UP,0);t=qv(t,tc.ID_PGUP,tc.VK_PAGE_UP,tc.SHIFT_MASK);t=qv(t,tc.ID_PGDN,tc.VK_PAGE_DOWN,0);t=qv(t,tc.ID_PGDN,tc.VK_PAGE_DOWN,tc.SHIFT_MASK);t=qv(t,tc.ID_UP,tc.VK_UP,0);t=qv(t,tc.ID_UP,tc.VK_UP,tc.SHIFT_MASK);t=qv(t,tc.ID_DOWN,tc.VK_DOWN,0);t=qv(t,tc.ID_DOWN,tc.VK_DOWN,tc.SHIFT_MASK);t=qv(t,tc.ID_LEFT,tc.VK_LEFT,0);t=qv(t,tc.ID_LEFT,tc.VK_LEFT,tc.SHIFT_MASK);t=qv(t,tc.ID_RIGHT,tc.VK_RIGHT,0);t=qv(t,tc.ID_RIGHT,tc.VK_RIGHT,tc.SHIFT_MASK);t=qv(t,tc.ID_LINE_BEGIN,tc.VK_HOME,0);t=qv(t,tc.ID_LINE_BEGIN,tc.VK_HOME,tc.SHIFT_MASK);t=qv(t,tc.ID_LINE_END,tc.VK_END,0);t=qv(t,tc.ID_LINE_END,tc.VK_END,tc.SHIFT_MASK);t=qv(t,tc.ID_CTRL_UP,tc.VK_UP,r);t=qv(t,tc.ID_CTRL_UP,tc.VK_UP,r|tc.SHIFT_MASK);t=qv(t,tc.ID_CTRL_DOWN,tc.VK_DOWN,r);t=qv(t,tc.ID_CTRL_DOWN,tc.VK_DOWN,r|tc.SHIFT_MASK);t=qv(t,tc.ID_FILE_BEGIN,tc.VK_PAGE_UP,r);t=qv(t,tc.ID_FILE_BEGIN,tc.VK_HOME,r);t=qv(t,tc.ID_FILE_BEGIN,tc.VK_HOME,r|tc.SHIFT_MASK);t=qv(t,tc.ID_FILE_END,tc.VK_PAGE_DOWN,r);t=qv(t,tc.ID_FILE_END,tc.VK_END,r);t=qv(t,tc.ID_FILE_END,tc.VK_END,r|tc.SHIFT_MASK);t=qv(t,tc.ID_NEXT_WORD,tc.VK_RIGHT,r);t=qv(t,tc.ID_NEXT_WORD,tc.VK_RIGHT,r|tc.SHIFT_MASK);t=qv(t,tc.ID_PREV_WORD,tc.VK_LEFT,r);t=qv(t,tc.ID_PREV_WORD,tc.VK_LEFT,r|tc.SHIFT_MASK);t=qv(t,tc.ID_DEL_PREV_WORD,tc.VK_BACK_SPACE,r);t=qv(t,tc.ID_DEL_NEXT_WORD,tc.VK_DELETE,r);t=qv(t,tc.ID_DEL,tc.VK_DELETE,0);t=qv(t,tc.ID_BACK_SPACE,tc.VK_BACK_SPACE,0);t=qv(t,tc.ID_BACK_TAB,tc.VK_TAB,r|tc.SHIFT_MASK);t=qv(t,tc.ID_BACK_TAB,tc.VK_TAB,tc.SHIFT_MASK);t=qv(t,tc.ID_CTRL_TAB,tc.VK_TAB,r);t=qv(t,tc.ID_TAB,tc.VK_TAB,0);t=qv(t,tc.ID_TAB,tc.VK_T,r);t=qv(t,tc.ID_INS_AFT,tc.VK_F9,0);t=qv(t,tc.ID_INS_BEF,tc.VK_F5,r);t=qv(t,tc.ID_DEL_LINE,tc.VK_F9,tc.SHIFT_MASK);t=qv(t,tc.ID_JOIN_LINE,tc.VK_J,tc.ALT_MASK);t=qv(t,tc.ID_HILIGHT_LINE,tc.VK_F8,0);t=qv(t,tc.ID_SELECT_ALL,tc.VK_A,r);t=qv(t,tc.ID_CUT,tc.VK_X,r);t=qv(t,tc.ID_CUT,tc.VK_DELETE,tc.SHIFT_MASK);t=qv(t,tc.ID_COPY,tc.VK_C,r);t=qv(t,tc.ID_COPY,tc.VK_INSERT,r);t=qv(t,tc.ID_PASTE,tc.VK_V,r);t=qv(t,tc.ID_PASTE,tc.VK_INSERT,tc.SHIFT_MASK);t=qv(t,tc.ID_PASTE,tc.VK_V,r|tc.ALT_MASK);t=qv(t,tc.ID_PASTE,tc.VK_INSERT,tc.SHIFT_MASK|tc.ALT_MASK);t=qv(t,tc.ID_PICT_FROM_FILE,tc.VK_F8,tc.ALT_MASK);t=qv(t,tc.ID_BLOCK_COPY,tc.VK_C,tc.ALT_MASK);t=qv(t,tc.ID_BLOCK_MOVE,tc.VK_M,tc.ALT_MASK);t=qv(t,tc.ID_SEARCH,tc.VK_F,r);t=qv(t,tc.ID_SEARCH_FOR,tc.VK_F3,0);t=qv(t,tc.ID_SEARCH_BACK,tc.VK_F3,r);t=qv(t,tc.ID_REPLACE,tc.VK_H,r);t=qv(t,tc.ID_TER_HELP,tc.VK_F1,0);t=qv(t,tc.ID_SPELL,tc.VK_F7,0);t=qv(t,tc.ID_UNDO,tc.VK_F8,tc.SHIFT_MASK);t=qv(t,tc.ID_UNDO,tc.VK_BACK_SPACE,tc.ALT_MASK);t=qv(t,tc.ID_UNDO,tc.VK_Z,r);t=qv(t,tc.ID_REDO,tc.VK_Y,r);t=qv(t,tc.ID_INSERT,tc.VK_INSERT,0);t=qv(t,tc.ID_PRINT,tc.VK_F4,0);t=qv(t,tc.ID_PRINT_OPTIONS,tc.VK_F4,tc.SHIFT_MASK);t=qv(t,tc.ID_JUMP,tc.VK_F10,0);t=qv(t,tc.ID_CHAR_NORMAL,tc.VK_0,tc.ALT_MASK);t=qv(t,tc.ID_BOLD_ON,tc.VK_B,r);t=qv(t,tc.ID_ULINE_ON,tc.VK_U,r);t=qv(t,tc.ID_ULINED_ON,tc.VK_D,r);t=qv(t,tc.ID_ITALIC_ON,tc.VK_I,r);t=qv(t,tc.ID_HLINK_ON,tc.VK_H,tc.ALT_MASK);t=qv(t,tc.ID_PROTECT_ON,tc.VK_3,tc.ALT_MASK);t=qv(t,tc.ID_SUPSCR_ON,tc.VK_4,tc.ALT_MASK);t=qv(t,tc.ID_SUBSCR_ON,tc.VK_5,tc.ALT_MASK);t=qv(t,tc.ID_STRIKE_ON,tc.VK_6,tc.ALT_MASK);t=qv(t,tc.ID_COLOR,tc.VK_7,tc.ALT_MASK);t=qv(t,tc.ID_FONTS,tc.VK_F10,tc.ALT_MASK);t=qv(t,tc.ID_CENTER,tc.VK_8,tc.ALT_MASK);t=qv(t,tc.ID_RIGHT_JUSTIFY,tc.VK_9,tc.ALT_MASK);t=qv(t,tc.ID_LEFT_INDENT,tc.VK_L,tc.ALT_MASK);t=qv(t,tc.ID_RIGHT_INDENT,tc.VK_R,tc.ALT_MASK);t=qv(t,tc.ID_HANGING_INDENT,tc.VK_T,tc.ALT_MASK);t=qv(t,tc.ID_BULLET,tc.VK_B,tc.ALT_MASK);t=qv(t,tc.ID_PARA_NBR,tc.VK_N,tc.ALT_MASK);t=qv(t,tc.ID_EDIT_STYLE,tc.VK_S,tc.ALT_MASK);t=qv(t,tc.ID_CHAR_STYLE,tc.VK_1,tc.ALT_MASK);t=qv(t,tc.ID_PARA_STYLE,tc.VK_2,tc.ALT_MASK);t=qv(t,tc.ID_NUM_TO_CHAR,tc.VK_X,tc.ALT_MASK);t=qv(t,tc.ID_PAGE_BREAK,tc.VK_ENTER,r);t=qv(t,tc.ID_RETURN,tc.VK_ENTER,0);t=qv(t,tc.ID_RETURN,tc.VK_ENTER,tc.SHIFT_MASK);t=qv(t,tc.ID_NEXT_CHANGE,tc.VK_N,r);t=qv(t,tc.ID_PREV_CHANGE,tc.VK_P,r);t=qv(t,tc.ID_SAVE,tc.VK_S,r);t=qv(t,tc.ID_SPACE,tc.VK_SPACE,0);t=qv(t,tc.ID_SPACE,tc.VK_SPACE,tc.SHIFT_MASK);t=qv(t,tc.ID_RESET_CHAR_STYLES,tc.VK_SPACE,r);t=qv(t,tc.ID_RESET,tc.VK_R,r);hh=t;return true}function qv(t,e,r,i){if(t+1>=Oh){Oh+=10;Fh=fV(Fh,Oh);gh=fV(gh,Oh);Ph=fV(Ph,Oh);Ch=fV(Ch,Oh)}Fh[t]=r;gh[t]=i;Ph[t]=e;Ch[t]=true;t++;return t}function $v(t){var e;var r,i=ee.width,f=ee.height;var l=false;tg.TerOpenCount++;LS=true;S=0;a.ShowHorBar=false;a.ShowVerBar=false;a.ruler=false;a.ToolBar=false;a.BorderMargin=false;a.ShowStatus=false;a.SaveFormat=tc.SAVE_RTF;if(ee.dataset!=undefined&&ee.dataset!=null){if(ee.dataset.wordWrap!=undefined)a.WordWrap=tp(ee.dataset.wordWrap);if(ee.dataset.pageMode!=undefined)a.PageMode=tp(ee.dataset.pageMode);if(ee.dataset.printViewMode!=undefined)a.PrintView=tp(ee.dataset.printViewMode);if(ee.dataset.fittedView!=undefined)a.FittedView=tp(ee.dataset.fittedView);if(ee.dataset.showMenu!=undefined)a.ShowMenu=tp(ee.dataset.showMenu);if(ee.dataset.showStatusBar!=undefined)a.ShowStatus=tp(ee.dataset.showStatusBar);if(ee.dataset.showRuler!=undefined)a.ruler=tp(ee.dataset.showRuler);if(ee.dataset.showVertRuler!=undefined)$A=tp(ee.dataset.showVertRuler);if(ee.dataset.showToolBar!=undefined)a.ToolBar=tp(ee.dataset.showToolBar);if(ee.dataset.borderMargin!=undefined)a.BorderMargin=tp(ee.dataset.borderMargin);if(ee.dataset.rtfOutput!=undefined)a.SaveFormat=tp(ee.dataset.rtfOutput)?tc.SAVE_RTF:tc.SAVE_TEXT;if(ee.dataset.readOnlyMode!=undefined)a.ReadOnly=tp(ee.dataset.readOnlyMode);if(ee.dataset.vertScrollBar!=undefined)a.ShowVerBar=tp(ee.dataset.vertScrollBar);if(ee.dataset.horzScrollBar!=undefined)a.ShowHorBar=tp(ee.dataset.horzScrollBar);if(ee.dataset.licKey!=undefined)tg.LicKey=tp(ee.dataset.licKey,"string");if(ee.dataset.dictUrlPrefix!=undefined)tg.StDictUrlPrefix=tp(ee.dataset.dictUrlPrefix,"string");if(ee.dataset.dictExt!=undefined)tg.StDictExt=tp(ee.dataset.dictExt,"string");if(ee.dataset.stKey!=undefined)tg.StKey=tp(ee.dataset.stKey,"string");if(ee.dataset.resourceUrl!=undefined)tg.ResourceUrl=tp(ee.dataset.resourceUrl,"string");if(ee.dataset.highRes!=undefined)r=tp(ee.dataset.highRes)}else{if(ee.getAttribute("data-word-wrap")!=null)a.WordWrap=tp(ee.getAttribute("data-word-wrap"));if(ee.getAttribute("data-page-mode")!=null)a.PageMode=tp(ee.getAttribute("data-page-mode"));if(ee.getAttribute("data-print-view-mode")!=null)a.PrintView=tp(ee.getAttribute("data-print-view-mode"));if(ee.getAttribute("data-fitted-view")!=null)a.FittedView=tp(ee.getAttribute("data-fitted-view"));if(ee.getAttribute("data-show-menu")!=null)a.ShowMenu=tp(ee.getAttribute("data-show-menu"));if(ee.getAttribute("data-show-status-bar")!=null)a.ShowStatus=tp(ee.getAttribute("data-show-status-bar"));if(ee.getAttribute("data-show-ruler")!=null)a.ruler=tp(ee.getAttribute("data-show-ruler"));if(ee.getAttribute("data-show-vert-ruler")!=null)$A=tp(ee.getAttribute("data-show-vert-ruler"));if(ee.getAttribute("data-show-tool-bar")!=null)a.ToolBar=tp(ee.getAttribute("data-show-tool-bar"));if(ee.getAttribute("data-border-margin")!=null)a.BorderMargin=tp(ee.getAttribute("data-border-margin"));if(ee.getAttribute("data-rtf-output")!=null)a.SaveFormat=tp(ee.getAttribute("data-rtf-output"))?tc.SAVE_RTF:tc.SAVE_TEXT;if(ee.getAttribute("data-read-only-mode")!=null)a.ReadOnly=tp(ee.getAttribute("data-read-only-mode"));if(ee.getAttribute("data-vert-scroll-bar")!=null)a.ShowVerBar=tp(ee.getAttribute("data-vert-scroll-bar"));if(ee.getAttribute("data-horz-scroll-bar")!=null)a.ShowHorBar=tp(ee.getAttribute("data-horz-scroll-bar"));if(ee.getAttribute("data-lic-key")!=null)tg.LicKey=tp(ee.getAttribute("data-lic-key"),"string");if(ee.getAttribute("data-dict-url-prefix")!=null)tg.StDictUrlPrefix=tp(ee.getAttribute("data-dict-url-prefix"),"string");if(ee.getAttribute("data-dict-ext")!=null)tg.StDictExt=tp(ee.getAttribute("data-dict-ext"),"string");if(ee.getAttribute("data-st-key")!=null)tg.StKey=tp(ee.getAttribute("data-st-key"),"string");if(ee.getAttribute("data-resource-url")!=null)tg.ResourceUrl=tp(ee.getAttribute("data-resource-url"),"string");if(ee.getAttribute("data-high-res")!=null)r=tp(ee.getAttribute("data-high-res"))}if(t!=undefined&&t!=null){if(t.WordWrap!=undefined)a.WordWrap=t.WordWrap;if(t.PageMode!=undefined)a.PageMode=t.PageMode;if(t.PrintView!=undefined)a.PrintView=t.PrintView;if(t.FittedView!=undefined)a.FittedView=t.FittedView;if(t.ShowMenu!=undefined)a.ShowMenu=t.ShowMenu;if(t.ShowStatusBar!=undefined)a.ShowStatus=t.ShowStatusBar;if(t.ShowRuler!=undefined)a.ruler=t.ShowRuler;if(t.ShowVertRuler!=undefined)$A=t.ShowVertRuler;if(t.ShowToolBar!=undefined)a.ToolBar=t.ShowToolBar;if(t.BorderMargin!=undefined)a.BorderMargin=t.BorderMargin;if(t.RtfOutput!=undefined)a.SaveFormat=t.RtfOutput;if(t.ReadOnlyMode!=undefined)a.ReadOnly=t.ReadOnlyMode;if(t.VertScrollBar!=undefined)a.ShowVerBar=t.VertScrollBar;if(t.HorzScrollBar!=undefined)a.ShowHorBar=t.HorzScrollBar;if(t.LicKey!=undefined)tg.LicKey=t.LicKey;if(t.DictUrlPrefix!=undefined)tg.StDictUrlPrefix=t.DictUrlPrefix;if(t.DictExt!=undefined)tg.StDictExt=t.DictExt;if(t.StKey!=undefined)tg.StKey=t.StKey;if(t.ResourceUrl!=undefined)tg.ResourceUrl=t.ResourceUrl;if(t.HighRes!=undefined)r=t.HighRes}if(tg.ResourceUrl.length>0&&Ck(tg.ResourceUrl,"/"))tg.ResourceUrl=cV(tg.ResourceUrl,0,tg.ResourceUrl.length-1);if(r){if(window.devicePixelRatio>1){if(_i.IsMobileOS)I=window.devicePixelRatio;else{I=3;l=true}}else{I=3;l=true}}else I=1;_i.TerCvsScale=I;if(I>1){ee.width=Math.floor(I*ee.width);ee.height=Math.floor(I*ee.height);tg.MENU_HEIGHT*=I;tg.MENU_MARGIN*=I;tg.MENU_XMARGIN*=I;tg.TLB_ICON_HEIGHT*=I;tg.TLB_MARGIN*=I;tg.TLB_SPACER_WIDTH*=I;_i.DlgFont=12*I+"pt Arial";_i.DlgCompHeight=25*I;JA=jA*I+"px Arial"}xE=true;K=new tc.RECT(ee.width,ee.height);if(ve>0){if(K.right>K.left+3){K.left++;K.right--}if(K.bottom>K.top+3){K.top++;K.bottom--}}rt=K.copy();oi=a.copy();a.hBuffer="";a.BufferLen=a.hBuffer.length;if(oi.FontTypeFace.length==0)Ep();if(Nj(tg.TerStyles))np();if(!oi.WordWrap)oi.PrintView=oi.PageMode=oi.FittedView=false;if(oi.FittedView)oi.PageMode=true;if(oi.PageMode)oi.PrintView=true;if(oi.PageMode&&!oi.FittedView)Wr=true;else Wr=false;if(!Qv())return false;if(!ap())return false;Ip(0);ui[0].pfmt=0;po[0]=new tc.ClsPage;po[0].FirstLine=0;po[0].DispNbr=1;po[0].ScrHt=100;po[0].flags=tc.PAGE_FIRST_SECT_PAGE;ro=1;w5(0);H_=1;B_[0]=new tc.TejTab;B_[0].SetSize(0);Dc=1;Nc[0]=new tc.ClsPfmt;Nc[0].flags=tc.LEFT;Nc[0].BkColor=tc.CLR_WHITE;Nc[0].BorderColor=tc.CLR_AUTO;Nc[0].OutlineLevel=-1;wc=1;mc[0]=new tc.ClsDiv;yc=1;xc[0]=(new tc.ClsBlt).init();xc[0].IsBullet=true;xc[0].BulletChar=tc.BULLET_CHAR;xc[0].font=tc.BFONT_SYMBOL;Vc=1;Kc[0]=new tc.ClsList;Kc[0].InUse=true;zc=1;Jc[0]=new tc.ClsListOr;Jc[0].InUse=true;X_=2;W_[0]=new tc.ClsStyleId;W_[0].InUse=true;W_[0].type=tc.SSTYPE_PARA;W_[0].TextBkColor=tc.CLR_WHITE;W_[0].ParaBkColor=tc.CLR_WHITE;W_[0].TwipsSize=oi.PointSize*20;W_[0].TypeFace=oi.FontTypeFace;W_[0].name="Normal";W_[0].OutlineLevel=-1;W_[0].CharMask=tc.CMASK_FONT|tc.CMASK_SIZE;W_[0].StyleMask=0;W_[1]=new tc.ClsStyleId;W_[1].InUse=true;W_[1].type=tc.SSTYPE_CHAR;W_[1].TextBkColor=tc.CLR_WHITE;W_[1].ParaBkColor=tc.CLR_WHITE;W_[1].TypeFace=oi.FontTypeFace;W_[1].name="Default Paragraph Font";W_[1].OutlineLevel=-1;W_[1].StyleMask=W_[1].CharMask=0;Lo=0;po[0].FirstLine=0;Dl=1;lW(0);$E[0]=new tc.ClsTableRow;tR[0]=new tc.ClsTableAux;$E[0].InUse=true;iR=1;eR[0]=(new tc.ClsCell).init();rR[0]=new tc.ClsCellAux;eR[0].InUse=true;fR=1;Kl=1;kl[0]=new tc.ClsParaFrame;kl[0].InUse=true;X_=2;W_[0]=new tc.ClsStyleId;W_[0].InUse=true;W_[0].type=tc.SSTYPE_PARA;W_[0].TextBkColor=tc.CLR_WHITE;W_[0].ParaBkColor=tc.CLR_WHITE;W_[0].TwipsSize=oi.PointSize*20;W_[0].TypeFace=oi.FontTypeFace;W_[0].name="Normal";W_[0].OutlineLevel=-1;W_[0].CharMask=tc.CMASK_FONT|tc.CMASK_SIZE;W_[0].StyleMask=0;W_[1]=new tc.ClsStyleId;W_[1].InUse=true;W_[1].type=tc.SSTYPE_CHAR;W_[1].TextBkColor=tc.CLR_WHITE;W_[1].ParaBkColor=tc.CLR_WHITE;W_[1].TypeFace=oi.FontTypeFace;W_[1].name="Default Paragraph Font";W_[1].OutlineLevel=-1;W_[1].StyleMask=W_[1].CharMask=0;ac[0]=new tc.ClsCharTag;Ac=1;ac[0].InUse=true;Yn[0]=new tc.ClsStory;Vn=1;Yn[0].InUse=true;qU();if(!tg.StSearched)c4();if(tg.stj!=null)_i.TerInitSpellTime(null);if(!y$())return false;if(!ep())return false;if(oi.WordWrap)lp(0);hb();ih=oi.file;if(ee.dataset!=null&&ee.dataset.data!=undefined)_i.SetData(ee.dataset.data);else if(ee.getAttribute("data-data")!=null)_i.SetData(ee.getAttribute("data-data"));else _i.TerRewrap();oi.hBuffer="";oi.BufferLen=0;oi.open=true;oi.modified=0;LS=false;if(l)_i.TerApplySize(i,f);_i.TerRepaint(true);xD(_i);return true}function tp(t,e){var r;if(t==undefined)return t;if(e==undefined)e="boolean";if(e=="boolean"){r=t.toLowerCase().charAt(0);return r=="t"}else return t}function ep(){var t;Es=null;var e=document.createElement("div");e.style.position="absolute";e.style.left="0px";e.style.top="0px";e.style.width="1in";e.style.height="1in";e.style.backgroundColor="#fff";e.style.zIndex="1000";e.style.visibility="true";var r=_i.cvs.parentElement;r.appendChild(e);yt=e.offsetWidth*I;Wt=e.offsetHeight*I;r.removeChild(e);Nt=yt;wt=Wt;Ut=Ai=tg.UNITS_PER_INCH=yt;kt=Ei=Wt;yh=dV(tc.BOX_BORDER_WIDTH);xh=DV(tc.BOX_BORDER_WIDTH);vt=hV(tc.DEF_LINE_WIDTH);if(vt<1)vt=1;for(t=0;t<f_;t++)xs[t].InUse=false;Ys=1;Fb(0);xs[0].InUse=true;xs[0].TypeFace=oi.FontTypeFace;xs[0].TwipsSize=8*20;xs[0].style=0;nO|=tc.TOFLAG2_DONT_CALC_CHAR_WIDTH;if(!Rx(Ti,0,true)){nO=cj(nO,tc.TOFLAG2_DONT_CALC_CHAR_WIDTH);return QY(tc.MSG_ERR_FONT_CREATE,"InitWinProp")}nO=cj(nO,tc.TOFLAG2_DONT_CALC_CHAR_WIDTH);W=xs[0].font;C=W.FontString;E=xs[0].hFont;Hr=xs[0].height-1;if(oi.PageMode&&xs[0].GlbFontId==-1){}Fb(0);xs[0].InUse=true;xs[0].TypeFace=oi.FontTypeFace;xs[0].TwipsSize=8*20;xs[0].style=tc.BOLD;nO|=tc.TOFLAG2_DONT_CALC_CHAR_WIDTH;if(!Rx(Ti,0,true)){nO=cj(nO,tc.TOFLAG2_DONT_CALC_CHAR_WIDTH);return QY(tc.MSG_ERR_FONT_CREATE,"InitWinProp")}nO=cj(nO,tc.TOFLAG2_DONT_CALC_CHAR_WIDTH);P=xs[0].font;_=xs[0].FontString;R=xs[0].hFont;if(oi.PageMode&&xs[0].GlbFontId==-1){}Fb(0);xs[0].InUse=true;xs[0].TypeFace="Arial";xs[0].TwipsSize=9*20;xs[0].style=0;nO|=tc.TOFLAG2_DONT_CALC_CHAR_WIDTH;if(!Rx(Ti,0,true)){nO=cj(nO,tc.TOFLAG2_DONT_CALC_CHAR_WIDTH);return QY(tc.MSG_ERR_FONT_CREATE,"InitWinProp")}nO=cj(nO,tc.TOFLAG2_DONT_CALC_CHAR_WIDTH);O=xs[0].font;u=xs[0].FontString;d=xs[0].hFont;ht=xs[0].height;yO=ht*3/2;if(oi.PageMode&&xs[0].GlbFontId==-1){}Fb(0);xs[0].InUse=true;xs[0].TypeFace=oi.FontTypeFace;xs[0].TwipsSize=9*20;xs[0].style=0;nO|=tc.TOFLAG2_DONT_CALC_CHAR_WIDTH;if(!Rx(Ti,0,true)){nO=cj(nO,tc.TOFLAG2_DONT_CALC_CHAR_WIDTH);return QY(tc.MSG_ERR_FONT_CREATE,"InitWinProp(a)")}nO=cj(nO,tc.TOFLAG2_DONT_CALC_CHAR_WIDTH);h=xs[0].font;o=xs[0].FontString;L=xs[0].hFont;Ot=xs[0].height;if(oi.PageMode&&xs[0].GlbFontId==-1){}Fb(0);xs[0].InUse=true;xs[0].TypeFace=oi.FontTypeFace;xs[0].TwipsSize=oi.PointSize*20;xs[0].style=0;Qb(0);xs[0].CharSet=$S;xs[0].lang=th;if(!Rx(Ti,0,true)){return QY(tc.MSG_ERR_FONT_CREATE,"InitWinProp(c)")}F=V=xs[0].font;v=My(ee,F.FontString);F.met=v.copy();if(oi.ShowMenu){xO=yO;_i.TerBuildMenu()}else xO=0;U="wait";if(hS||!_l)oi.ToolBar=false;else if(tg.ToolbarBM==null){if(tg.ToolbarBMLoadError)oi.ToolBar=false;else{tg.ToolbarBM=new Image;tg.ToolbarBM.onload=function(){tg.ToolbarBMLoaded=true;if(oi.ToolBar){_i.TerRecreateToolbar(true);ZQ()}};tg.ToolbarBM.onerror=function(){tg.ToolbarBMLoaded=false;tg.ToolbarBMLoadError=true;tg.ToolbarBM=null;oi.ToolBar=false};if(tg.ResourceUrl!="")tg.ToolbarBM.src=tg.ResourceUrl+"/ter_tlb.gif";else tg.ToolbarBM.src=OU("ter_tlb.gif")}}yf="col-resize";Wf=wp("Table2Cur");qf=wp("PaintCur");$f=wp("PenCur");Uf="row-resize";Xf="pointer";s=document.createElement("canvas");c=s.getContext("2d");bf=tc.Color.black;mf=new tc.Pen(1,bf);mf.setDotted();xf=tc.Color.black;wf=new tc.Pen(1,xf);wf.setLightDotted();Y=JV(16);jp();if(oi.ToolBar&&tg.ToolbarBM.complete)tN();iG();if(oi.ShowHorBar){w=op(false);at=0;iG()}if(oi.ShowVerBar){oi.ShowVerBar=false;sp(true)}xT=tc.CF_MAX+1;yT=tc.CF_MAX+2;GT=tc.CF_MAX+3;HT=tc.CF_MAX+4;BT=tc.CF_MAX+5;WT=tc.CF_ENHMETAFILE;kT="Text";if(oi.ShowStatus)tB();if(Nj(Zh&tc.TFLAG2_RETAIN_BKND))cp();if(!hS&&Dj($h&tc.TFLAG5_NO_EXT_DROP)){}Op(false,"");if(rp()){il=window.setInterval(Wp,3e5)}return true}function rp(){return tg.eval}function ip(t){S=t;if(oi.ToolBar)tN();iG();return true}_i.TerResetInitVariables=function(){if(_l&&!lv)return false;return fp()};function fp(){var t;Ua=true;Da=0;Ma=0;qa=-1;ma=-1;wa=-1;ba=0;xa=0;Ri=1;Dc=1;iR=1;fR=1;Kl=1;H_=1;To=1;X_=2;yc=1;wc=1;br=we=fr=0;jt=0;VR=true;yR=WR=UR=false;uA=tc.HILIGHT_OFF;Xr=false;Vr=false;oi.modified=Ro=0;Su=true;lr=0;kA=-1;XA=-1;KA=-1;uL=false;EL=false;TL=false;Re=0;wE=tc.NBR_DEC;mr=tc.FLOW_DEF;oO=null;Uh=0;BA=0;WE=0;vi=false;ih="";$l=0;ta=null;zr=false;El=false;$T=tc.CLR_WHITE;Di=false;HR=false;mR=0;Oe=tc.FLOW_DEF;uo=-1;$i=false;L_="";if(mh){mh=false;oi.ReadOnly=false}b_=-1;x_=-1;y_=0;WL=0;UL=0;kL=0;ro=1;w5(0);Ip(0);ui[0].pfmt=0;if(_E>0)n9();for(t=1;t<Ys;t++){if(xs[t].InUse)gb(t)}Ys=1;Oc=-1;hk(false);M_=1;Gk();Dl=1;lW(0);for(t=1;t<Ac;t++)kx(t);Ac=1;for(t=1;t<Vn;t++)Xx(t);Vn=1;DQ();Vc=1;zc=1;Pp();Gk();FU();for(t=1;t<Al;t++)J4(t);Al=1;Z_=false;ri=false;return true}function lp(t){if(t==0){var e,r;e=100;r=300;Dn=e+5;Gn=(r+2)*(e+2);if(Gn<0)Gn=2e4;if(Gn<1e4)Gn=1e4}else{if(Nj(wn)){wn=null;dc=null;nc=null;_o=null;cc=null;_c=null;oc=null;uc=null;Tc=null}Gn=t}wn=[Gn];dc=[Gn];nc=[Gn];_o=[Gn];return true}function ap(){var t;var e;Ao=5;bc=10;if(oi.PrintView||oi.PageMode)Ml=50;else Ml=1;ui=[xe];for(e=0;e<xe;e++)ui[e]=null;xs=[f_+1];Xs=[f_+1];for(t=0;t<f_;t++){xs[t]=new tc.ClsFont;Xs[t]=new tc.ClsPrtFont}po=[Ao+1];for(t=0;t<Ao+1;t++)po[t]=new tc.ClsPage;xc=[Wc+1];for(t=0;t<Wc+1;t++)xc[t]=new tc.ClsBlt;mc=[bc+1];for(t=0;t<bc+1;t++)mc[t]=new tc.ClsDiv;Kc=[jc+1];for(t=0;t<jc+1;t++)Kc[t]=new tc.ClsList;Jc=[Zc+1];for(t=0;t<Zc+1;t++)Jc[t]=new tc.ClsListOr;to=[fo+1];for(t=0;t<fo+1;t++)to[t]=(new tc.ClsSect).init();eo=[fo+1];for(t=0;t<fo+1;t++)eo[t]=(new tc.ClsSect1).init();tR=[lR+1];for(t=0;t<lR+1;t++)tR[t]=new tc.ClsTableAux;rR=[aR+1];for(t=0;t<aR+1;t++)rR[t]=new tc.ClsCellAux;ac=[Ec+1];for(t=0;t<Ec+1;t++)ac[t]=new tc.ClsCharTag;Yn=[jn+1];for(t=0;t<jn+1;t++)Yn[t]=new tc.ClsStory;fa=[la+1];ra=[la+1];ia=[la+1];sE=[RE+1];for(t=0;t<RE+1;t++)sE[t]=new tc.ClsUndo;mA=[HA+1];for(t=0;t<HA+1;t++)mA[t]=new tc.ClsHlSeg;kE=[UE+1];for(t=0;t<UE+1;t++)kE[t]=new tc.ClsScrCtl;o_=[__+1];for(t=0;t<__+1;t++)o_[t]=new tc.ClsPendPict;ul=[];for(t=0;t<Tl+1;t++)ul[t]=new tc.ClsReviewer;if(tg.GlbPrtDC==null)tg.GlbPrtDC=[tc.MAX_GLB_DC];B_=[tc.MAX_TABS];for(t=0;t<tc.MAX_TABS;t++)B_[t]=new tc.TejTab;Nc=[Mc+1];for(t=0;t<Mc+1;t++)Nc[t]=new tc.ClsPfmt;W_=[K_+1];for(t=0;t<K_;t++)W_[t]=new tc.ClsStyleId;pl=[Ml+1];for(t=0;t<Ml+1;t++)pl[t]=new tc.ClsFrame;kl=[Yl+1];for(t=0;t<Yl+1;t++)kl[t]=new tc.ClsParaFrame;XE=[jE+1];for(t=0;t<jE+1;t++)XE[t]=new tc.ClsDragObj;$E=[lR+1];for(t=0;t<lR+1;t++)$E[t]=new tc.ClsTableRow;eR=[aR+1];for(t=0;t<aR+1;t++)eR[t]=new tc.ClsCell;xL=[tc.MAX_IMAGE_MAPS];for(t=0;t<tc.MAX_IMAGE_MAPS;t++)xL[t]=new tc.ClsImageMap;if(tg.GlbFont==null){tg.GlbFont=[tc.MAX_GLB_FONTS];tg.TotalGlbFonts=0}if(Nj($h&tc.TFLAG5_NO_SHARE)){v_=[tc.MAX_GLB_FONTS];p_=0}for(t=0;t<f_;t++)xs[t].CharWidth=Xs[t].CharWidth=null;for(t=0;t<la;t++){fa[t]=ra[t]=ia[t]=0}ul[0]=new tc.ClsReviewer;ul[0].name="";Al=1;bs=[256];return true}function np(){oi.WordWrap=Nj(TerStyles&tc.TER_WORD_WRAP);oi.PrintView=Nj(TerStyles&tc.TER_PRINT_VIEW);oi.ShowHorBar=Nj(TerStyles&tc.TER_HSCROLL);oi.ShowVerBar=Nj(TerStyles&tc.TER_VSCROLL);oi.ShowStatus=Nj(TerStyles&tc.TER_SHOW_STATUS);oi.ruler=Nj(TerStyles&tc.TER_SHOW_RULER);oi.BorderMargin=Nj(TerStyles&tc.TER_BORDER_MARGIN);oi.ReadOnly=Nj(TerStyles&tc.TER_READ_ONLY);oi.PageMode=Nj(TerStyles&tc.TER_PAGE_MODE);oi.ToolBar=Nj(TerStyles&tc.TER_SHOW_TOOLBAR);oi.FittedView=Nj(TerStyles&tc.TER_FITTED_VIEW);if(Nj(TerStyles&tc.TER_OUTPUT_RTF))oi.SaveFormat=tc.SAVE_RTF;return true}function cp(){return true}_i.TerEnableScrollBar=function(t,e){if(t)return sp(e);else return _p(e)};function sp(t){if(oi.ShowVerBar==t)return true;oi.ShowVerBar=t;if(t){b=op(true);iG()}else{if(b!=null)b.delete();b=null;ZQ()}return true}function _p(t){if(oi.ShowHorBar==t)return true;oi.ShowHorBar=t;if(t){w=op(false);iG()}else{if(w!=null)w.delete();w=null;ZQ()}return true}function op(t){var e=JV(20);var r=30;var i;if(t){if(Ru)r=xO+wA;else{r=rt.top;if(oi.BorderMargin)r-=hV(tc.BORDER_MARGIN)}if(b!=null)b.delete();b=new $t.VScrollBar(ee,r,Y,oi.ShowHorBar,tc.SCROLL_RANGE,0,e,false,function(t,e){Dv(t,e,te)});b.refresh();ct=e;Lh=Y;i=b}else{if(w!=null)w.delete();w=new $t.HScrollBar(ee,0,Y,true,tc.SCROLL_RANGE,0,e,false,function(t,e){Mv(t,e,te)});w.refresh();st=e;Rh=Y;i=w}return i}function up(t){return op(t)}function Tp(t,e){if(t&&b!=null)op(true);if(e&&w!=null)op(false);return true}function Ap(t,e){var r,i,f,l;return true}function Ep(){oi.FontTypeFace="Arial";return true}function Rp(){var t;var e;e=[xe+1];for(t=0;t<Ri;t++){e[t]=Cp(t);if(e[t]==null)return null}return e}function Lp(t,e){var r;for(r=0;r<e;r++)t[r]=null;t=null;return true}function Cp(t){return ui[t].copy()}function Ip(t){var e,r,i;Fp(t);ui[t].txt=null;ui[t].fmt=null;ui[t].UniFmt=0;ui[t].cwidth=null;ui[t].tag=null;ui[t].len=0;ui[t].height=kt*12/72;ui[t].ScrHt=wt*12/72;ui[t].GridSpace=0;ui[t].flags=0;ui[t].flags2=0;ui[t].tabw=null;ui[t].BaseHeightAdj=0;ui[t].y=0;ui[t].x=0;if(t>0)e=ui[t-1].pfmt;else e=0;if(e<Dc)ui[t].pfmt=e;else ui[t].pfmt=0;if(t>0)r=ui[t-1].cid;else r=0;if(r<fR)ui[t].cid=r;else ui[t].cid=0;if(t>0)i=ui[t-1].fid;else i=0;if(i<Kl)ui[t].fid=i;else ui[t].fid=0;if(t>0&&ui[t].fid==ui[t-1].fid){ui[t].y=ui[t-1].y+ui[t-1].height;ui[t].x=ui[t-1].x}ui[t].JustAdjX=0;if(t>0)ui[t].page=ui[t-1].page;else ui[t].page=0;ui[t].col=0;return true}function dp(t){if(ui[t]==null)return true;if(ui[t].tabw!=null&&(ui[t].tabw.type&tc.INFO_SECT)!=0)lo=UR=true;gp(t);return true}function Fp(t){if(n!=null&&f>0){f--;ui[t]=n[f]}else ui[t]=new tc.ClsLinePtr;return true}function gp(t){if(n!=null&&f<tc.MAX_LINE_PTRS){n[f]=ui[t];f++}ui[t]=null;return true}function Pp(){var t;for(t=0;t<tc.INFO_MAX;t++){CO[t]=null}return true}_i.CloseTer=function(t){var e;var r;var i;var f=null;if(_l&&!lv)return false;if(S==null)return false;if(oi.InputType==tc.CHAR_F&&!hS){if(t){if(Nj(oi.modified)&&(!oi.ReadOnly||mh)){if(!BU(ih,false))return false}}else{if(Nj(oi.modified)&&(!oi.ReadOnly||mh)){if(qk(tg.MsgString[tc.MSG_SAVE_MODS],"",tc.MSGTYPE_OK_CANCEL)==tc.MSGRESULT_OK){if(!BU(ih,false))return false}else{if(qk(tg.MsgString[tc.MSG_EXIT_WITHOUT_SAVING],"",tc.MSGTYPE_OK_CANCEL)==tc.MSGRESULT_CANCEL)return false;else UD(tc.TER_NOT_SAVED,S,0,false)}}}}UD(tc.TER_CLOSE,S,0,false);if(Dj(zh&tc.TFLAG_NO_HOUR_GLASS)){f=XQ(U)}oi.open=false;for(i=0;i<Ri;i++)dp(i);if(f!=null)XQ(f);oi.InitLine=br+1;pv();pr=true;oi.hBuffer=null;_i.VirtTextarea=null;if(WA!=null)SN();oi.ToolBar=false;PN();for(r=0;r<wL;r++){if(!PL[r].InUse)continue;PL[r].image=null;PL[r].pBalloon=null}wL=0;hk(true);if(Nj(wn)){wn=null;dc=null;nc=null;_o=null;cc=null;_c=null;oc=null;uc=null;Tc=null}if(_E>0)n9();sE=null;Pp();Gk();bG(false);FU();zh=Aj(tc.TFLAG_BUF_DISP);for(r=0;r<Ys;r++){if(xs[r].InUse)gb(r)}eJ();if(PS)clearInterval(tl);if(tn)clearInterval(fl);if(eval)clearInterval(il);NB();if(it!=null)it=null;if(p!=null)mk();if(M!=null)M=null;if(tg.ToolbarBM!=null)tg.ToolbarBM=null;if(w!=null){w.delete();w=null}if(b!=null){b.delete();b=null}Nr=true;_i.caret.killTimer();_i.caret.destroy();nG();Ti=null;c=null;_O=null;sO=null;if(!Fr){Fr=true}if(Wf!=null)Wf=null;if(kf!=null)kf=null;if(Kf!=null)Kf=null;if(Yf!=null)Yf=null;if(Vf!=null)Vf=null;if(jf!=null)jf=null;if(Qf!=null)Qf=null;if(qf!=null)qf=null;if($f!=null)$f=null;yf=Wf=Uf=kf=Xf=Kf=Yf=Vf=jf=null;Jf=zf=Zf=Qf=qf=$f=null;if(Nj(v_)){for(r=0;r<p_;r++){if(v_[r].font!=null)v_[r].font=null;v_[r].font=null}v_=null;p_=0}if(Dj(lO&tc.TFLAG11_DONT_SHRINK_FONT_TABLE))_i.TerShrinkFontTable();n=null;pl=null;kl=null;xc=null;mc=null;xs=null;Xs=null;B_=null;to=null;eo=null;po=null;Nc=null;W_=null;XE=null;$E=null;tR=null;eR=null;rR=null;for(r=0;r<Ac;r++)kx(r);ac=null;for(r=0;r<Vn;r++)Xx(r);Yn=null;for(r=0;r<Al;r++)J4(r);ul=null;DQ();Kc=null;Jc=null;fa=null;ra=null;ia=null;S=0;return true};_i.TerClosePrinter=function(){return true};function Sp(){}function hp(){if(!tg.expired)return false;var t=_i.DlgCompHeight;var e=_i.DlgFont;var s=new $t.DialogBox(te,"Reset Eval",e,true,function(t,e,r){f(t,e,r)});var r=s.cvs;var i=new $t.Label(r,0,0,e,"Enter Code");s.addComp(i,0,0,1,1,"Left","bottom");var _=new $t.TextBox(r,0,0,JV(200),t,"",e,_i.caret,false,true,null);s.addComp(_,1,0,1,2,"left","middle");s.show();_.setFocus();function f(t,e,r){var i="";var f=[" ","J","F","M","A","M","J","J","A","S","O","N","D"];var l=false;if(t=="Cancel"){s.hide();return}else if(t=="OK"){i=_.getText();if(i==""){_.setFocus();return}s.hide()}else return;i=i.toUpperCase();if(i.length==5){var a=i.substring(2);if(a=="QMC"||a=="RPL"||a=="PMR"||a=="ZQB"){var n=(new Date).getMonth()+1;var c=n+1;if(c>12)c=1;if(i.charAt(0)==f[n]&&i.charAt(1)==f[c]){tg.reset=true;Op();cG();if(!tg.expired)qk("Eval Reset!")}}}}return true}function Op(){var e="";var t="";var r="TehKey28";if(!tg.eval)return true;e+=cV(tg.ky1,1,5)+"-";e+=cV(tg.ky2,1,5)+"-";e+=cV(tg.ky3,1,5);tg.HomeKey=window.location.href.indexOf("www.subsystems.com")>=0||window.location.href.indexOf("/teh/")>=0;if(tg.ResourceUrl!="")r=tg.ResourceUrl+"/"+r;if(tg.HomeKey)t=e;else if(tg.LicKey!="")t=tg.LicKey;else{t=gU(r+".txt");if(t==null||t.length>30)t="";if(t.length==0){t=gU(r+".htm");if(t==null||t.length>30)t=""}if(t.length==0){t=gU(r+".html");if(t==null||t.length>30)t=""}if(t.length>0){if(t.length>e.length)t=cV(t,0,23)}}if(t.length>0)return vp(e,t);gU(r+".txt",true,i);gU(r+".htm",true,i);gU(r+".html",true,i);function i(t){if(t!=null&&t.length>0)vp(e,t)}}function vp(t,e){var r=15;t:{if(e.length<t.length)break t;if(e.length>=23){var i=e.charAt(18);if(i=="K"||i=="V"||i=="E"){var f=parseInt(cV(e,19,2));var l=parseInt(cV(e,21,2));var a=(new Date).getYear()-100;var n=(new Date).getMonth()+1;if(a>f||n>l)break t}}if(cV(e,0,4)!=cV(t,0,4))break t;if(cV(e,5,5)!=cV(t,5,5))break t;if(cV(e,11,5)!=cV(t,11,5))break t;var c=Uk(e);if(!tg.HomeKey&&c[16]!="Z"){if(e.length<23)break t;if(e.length>=23)pp(e)}tg.eval=false;tg.expired=false;tg.disable=false;tg.ServerLicense=true;return true}var s="Teh28_Eval";var _=new Date;var o=new Date;var u=o.getTime();var T=-1;var A=0;var E=false;var R=Bp(s);if(R!=null){T=parseInt(R);E=true}if(tg.reset){mp(s,R);E=false;tg.reset=false}else if(T>0){A=(u-T)/1e3/60/60/24;A=Math.floor(A);if(A>30){mp(s,R);E=false}}if(!E){R=mY(u);Hp(s,R,60);T=u}tg.EvalDaysUsed=Math.floor((u-T)/1e3/60/60/24);tg.EvalDaysRemaining=r-tg.EvalDaysUsed;tg.expired=tg.EvalDaysRemaining<=0;tg.disable=tg.eval&&tg.expired;return false}function pp(t){var e="",r="";var i,f,l,a,n,c,s;LicenseYYMM=0;var _=Uk(t);if(_[16]>=tc.CHAR_0&&_[16]<=tc.CHAR_9){r="smo"+cV(t,16,1)+cV(t,18)}else{r="srab"+cV(t,18)}r+=".htm";e="https://www.subsystems-us.com/lic_exp/";e+=r;var o=new XMLHttpRequest;o.open("GET",e);o.onreadystatechange=function(){if(o.readyState===4&&o.status===200){r=o.responseText;if(r.length<4||r.length>10)return true;if(r.length>4)r=cV(r,0,4);i=LX(r);f=Math.round(i/100);l=i-f*100;a=f*12+l+3;var t=new Date;n=t.getFullYear()-2e3;c=t.getMonth()+1;s=n*12+c;if(s<a)return true;tg.LicenseYYMM=f*100+l;tg.eval=tg.expired=tg.disable=true}};o.send();return true}function Np(){var t=Mp("TehClipDataTime");if(t==tg.ClipDataTime)return true;tg.ClipDataTime=t;tg.ClipDataRtf=Mp("TehClipDataRtf");tg.ClipDataText=Mp("TehClipDataText");var e=Mp("TehClipInfo");if(e!=null){var r=new tc.ClsClipInfo;tg.ClipInfo=r.fromString(e)}return true}function Dp(){if(tg.ClipDataRtf!=null)Gp("TehClipDataRtf",tg.ClipDataRtf);if(tg.ClipDataText!=null)Gp("TehClipDataText",tg.ClipDataText);if(tg.ClipInfo!=null)Gp("TehClipInfo",tg.ClipInfo.toString());var t=new Date;var e=t.getTime();tg.ClipDataTime=e.toString();Gp("TehClipDataTime",tg.ClipDataTime);return true}function Mp(t){if(localStorage){var e=localStorage.getItem(t);if(e==null)return e;else return unescape(e)}else return Bp(t)}function Gp(t,e){if(localStorage){if(e.length==0)localStorage.removeItem(t);else localStorage.setItem(t,escape(e))}else{if(e.length==0){var r=Bp(t);mp(t,r)}else Hp(t,e)}}function Bp(t){var e=document.cookie;var r="";if(e.length>0){var i=e.split(";");for(var f=0;f<i.length;f++){var l=i[f].split("=")[0];if(l.trim()==t){r=i[f].split("=")[1];return unescape(r)}}}return null}function Hp(t,e,r){if(typeof r==undefined)r=5e3;var i=new Date(Date.now()+r*1e3*60*60*24);document.cookie=t+"="+escape(e)+"; expires= "+i.toUTCString()}function mp(t,e){var r=new Date;r.setMonth(r.getMonth()-1);document.cookie=t+"="+escape(e);document.cookie="expires="+r.toUTCString()+";"}function wp(t){if(t=="Table2Cur"){return"Table2Cur"}else if(t=="PaintCur"||t=="PenCur"){return t}return"default"}function bp(){EM(tc.TIMER_REPAGE,0);KD()}function xp(){var t=(new Date).getTime();if(t-va>me||Oo){vX(0,0,0);KD();clearInterval(el)}}function yp(){_i.TerRepaint(true);KD();clearInterval(rl)}function Wp(){EM(tc.TIMER_EVAL,0);KD()}function Up(){EM(tc.TIMER_HILIGHT,0);KD()}function kp(){EM(tc.TIMER_WHEEL_UP,0);KD()}function Xp(){EM(tc.TIMER_WHEEL_DOWN,0);KD()}function Kp(){EM(tc.TIMER_MOUSE_STOP,0);KD()}_i.TerRecreateToolbar=function(t){if(!lv||!QD())_i.TerCreateControl();PN();jp();if(t)Vp();return true};function Yp(t){var e,r;var i;var f;for(e=0;e<tc.MAX_TLB_LINES;e++){for(r=0;r<IL[e];r++){f=gL[e][r];i=f.ctl;if(i!=null&&(t||f.id!=tc.TLB_ZOOM)){if(t)i.setEnable(true);else i.setEnable(false)}}}return true}_i.TerEditTooltip=function(t,e){var r,i;var f;if(t<=0||t>=tc.MAX_TLB)return false;zA[t]=e;if(!lv||!QD())return true;for(r=0;r<tc.MAX_TLB_LINES;r++){for(i=0;i<IL[r];i++){f=gL[r][i];if(f.id!=t)continue;f.pBalloon=e;gL[r][i]=f}}return true};_i.TerSetToolbarComboWidth=function(t,e,r){if(!lv||!QD())_i.TerCreateControl();if(t<0||t>=tc.MAX_TLB)return false;if(e<0)return false;qA[t]=e;if(r)_i.TerRecreateToolbar(true);return true};_i.TerHideCustomToolbarIcon=function(t){var e;if(!lv||!QD())_i.TerCreateControl();for(e=0;e<wL;e++){if(PL[e].CmdId==t)PL[e].InUse=false}return true};_i.TerHideToolbarIcon=function(t,e){var r,i;if(!lv||!QD())_i.TerCreateControl();if(t<=0||t>=tc.MAX_TLB)return false;for(r=0;r<tc.MAX_TLB_LINES;r++){for(i=0;i<tc.MAX_TLB_PER_LINE;i++){if(ZA[r][i]==t){QA[r][i]=e;if(i+1==tc.MAX_TLB_PER_LINE&&ZA[r][i+1]==tc.TLB_SPACER){QA[r][i+1]=e}}}}return false};function Vp(){if(!_l||hS)return true;oi.ToolBar=!oi.ToolBar;if(oi.ToolBar)tN();else SN();_i.TerRepaint(true);return true}function jp(){var t,e,r,i=tc.MAX_TLB_LINES-1;var f,l,a;if(kc==0)nN();FL=r=Nj(qh&tc.TFLAG4_ONE_ROW_TOOLBAR)?1:0;if(Nj($h&tc.TFLAG5_TOP_ROW_TOOLBAR))FL=r=i=0;gL=[];for(t=0;t<tc.MAX_TLB_LINES;t++){gL[t]=[];IL[t]=0}for(t=r;t<=i;t++){f=0;l=0;a=0;for(e=0;e<tc.MAX_TLB_PER_LINE;e++){if(ZA[t][e]==tc.TLB_LINE){if(e>0&&ZA[t][e-1]!=0){if(f==0){if(e+1<tc.MAX_TLB_PER_LINE&&ZA[t][e]==tc.TLB_SPACER)e++;continue}}f=0}if(ZA[t][e]==tc.TLB_STYLE&&Dj(Qh&tc.TFLAG3_STYLES_ON_TOOLBAR))continue;if(ZA[t][e]==tc.TLB_BOLD&&Nj($s&tc.BOLD))continue;if(ZA[t][e]==tc.TLB_ITALIC&&Nj($s&tc.ITALIC))continue;if(ZA[t][e]==tc.TLB_ULINE&&Nj($s&tc.ULINE))continue;if(ZA[t][e]==tc.TLB_BULLET_DROPDOWN&&kc==0)continue;if(QA[t][e])continue;if(ZA[t][e]==tc.TLB_SPACER&&e>0&&QA[t][e-1])continue;if(ZA[t][e]==tc.TLB_SPACER&&e>1&&ZA[t][e-1]==tc.TLB_SPACER&&QA[t][e-2])continue;if(ZA[t][e]==tc.TLB_SPACER&&a==0&&l>=2)continue;if(ZA[t][e]>0&&ZA[t][e]<tc.MAX_TLB)_i.TerAddToolbarItem(t,ZA[t][e],null,null,-1);if(ZA[t][e]!=tc.TLB_LINE&&ZA[t][e]!=tc.TLB_SPACER)f++;if(ZA[t][e]==tc.TLB_SPACER)l++;else a++}}for(t=0;t<wL;t++){if(!PL[t].InUse)continue;if(Nj($h&tc.TFLAG5_TOP_ROW_TOOLBAR)&&PL[t].line!=0)continue;if(PL[t].id>0)_i.TerAddToolbarItem(PL[t].line,PL[t].id,PL[t].pBalloon,null,-1);else{if(PL[t].image!=null)_i.TerAddToolbarItem(PL[t].line,0,PL[t].pBalloon,PL[t].image,PL[t].CmdId)}}Jp(tc.ID_BULLET,tc.ID_BULLET_DROPDOWN);xA=false;yA=false;return true}function Jp(t,e){var r=null,i=null;var f,l;var a=null;for(f=0;f<tc.MAX_TLB_LINES;f++){if(IL[f]==0)continue;for(l=0;l<IL[f];l++){a=gL[f][l];if(a.CmdId==t){r=a;break}}if(r!=null)break}if(r==null)return;for(f=0;f<tc.MAX_TLB_LINES;f++){if(IL[f]==0)continue;for(l=0;l<IL[f];l++){a=gL[f][l];if(a.CmdId==e){i=a;break}}if(i!=null)break}if(i==null)return;r.ConnectedTlb=i;i.ConnectedTlb=r}_i.TerAddToolbarIcon=function(t,e,r,i,f){return zp(t,e,r,i,null,f)};_i.TerAddToolbarIcon3=function(t,e,r,i,f){return zp(t,e,r,"",i,f)};function zp(t,e,r,i,f,l){var a=new tc.ClsTlbCustId;var n;if(wL==0)PL=[];if(wL>=tc.MAX_CUST_ICONS)return false;if(t<0)t=0;if(t>1)t=1;for(n=0;n<wL;n++){if(!PL[n].InUse)break}if(n==wL)wL++;a=new tc.ClsTlbCustId;a.InUse=true;a.line=t;if(l==null)l="";a.pBalloon=l;PL[n]=a;if(e>0){if(e>=tc.MAX_TLB)return false;a.id=e;a.image=null}else{a.image=null;if(r==tc.ID_TOOLBAR_MENU&&f==null)f=Zp();if(f==null){var c=null;if(i.length==0)return false;nD(i,false,s,-(n+1))}else PL[n].image=f;PL[n].CmdId=r}function s(t,e){e=-e-1;var r;PL[e].image=t;for(r=0;r<wL;r++)if(PL[r].InUse&&PL[r].image==null&&PL[r].id==0)break;if(r==wL)_i.TerRecreateToolbar(true)}return true}function Zp(){var t=tg.TLB_ICON_HEIGHT;var e=tg.TLB_ICON_HEIGHT;var r=t/8;if(r<JV(2))r=JV(2);var i=r;var f=t/3;if(f<JV(2))f=JV(2);var l=r;var a=(e-(r+l)*3)/2;var n=new tc.Color(9408399);canvas=document.createElement("canvas");canvas.width=t;canvas.height=e;gr=canvas.getContext("2d");var c=tc.CLR_WHITE;if(nA==null)c=WO;else c=cA;HH(gr,c,new tc.RECT(0,0,t,e));MH(gr,new tc.Pen(c),0,0,t,e);HH(gr,n,new tc.RECT(f,a,i,r));MH(gr,new tc.Pen(n),f,a,i,r);HH(gr,n,new tc.RECT(f,a+r+l,i,r));MH(gr,new tc.Pen(n),f,a+r+l,i,r);HH(gr,n,new tc.RECT(f,a+2*r+2*l,i,r));MH(gr,new tc.Pen(n),f,a+2*r+2*l,i,r);return gr.getImageData(0,0,t,e)}_i.TerChangeCustomIcon=function(t,e,r,i,f,l){var a=new tc.ClsTlbCustId;var n;if(wL==0)return false;for(n=0;n<wL;n++){if(e>0&&PL[n].CmdId==e)break;else if(t>0&&PL[n].id==t)break}if(n==wL)return false;a=PL[n];if(f!=null&&f!="")a.pBalloon=f;if(l>=0)a.CmdId=l;if(i==null){var c=null;if(r.length==0)return false;nD(r,false,s,-(n+1))}else PL[n].image=i;function s(t,e){e=-e-1;var r;PL[e].image=t;for(r=0;r<wL;r++)if(PL[r].InUse&&PL[r].image==null&&PL[r].id==0)break;if(r==wL)_i.TerRecreateToolbar(true)}return true};_i.TerAddToolbarItem=function(t,e,r,i,f){var l=new tc.ClsTlb;var a,n,c;var s=null;var _=null;var o=null;var u=0,T=0;if(!lv||!QD())_i.TerCreateControl();if(t<0||t>=tc.MAX_TLB_LINES)return false;if(IL[t]>=tc.MAX_TLB_PER_LINE)return false;if(e<0||e>=tc.MAX_TLB)return false;c=IL[t];IL[t]++;l.id=e;if(Dj(r))r=zA[e];l.pBalloon=r;l.IconWidth=tg.TLB_ICON_HEIGHT;l.IconHeight=tg.TLB_ICON_HEIGHT;l.height=tg.TLB_ICON_HEIGHT;l.width=tg.TLB_ICON_HEIGHT+2;if(e==tc.TLB_SPACER||e==tc.TLB_LINE){l.width=tg.TLB_SPACER_WIDTH}else if(e==tc.TLB_TYPEFACE){if(qA[e]>0)l.width=qA[e];else l.width=7*tg.TLB_ICON_HEIGHT;l.height=tg.TLB_ICON_HEIGHT;l.flags|=tc.TLBFLAG_COMBO;l.flags|=tc.TLBFLAG_EDITABLE}else if(e==tc.TLB_POINTSIZE){if(qA[e]>0)l.width=qA[e];else l.width=2*tg.TLB_ICON_HEIGHT;l.height=tg.TLB_ICON_HEIGHT;l.flags|=tc.TLBFLAG_COMBO;l.flags|=tc.TLBFLAG_EDITABLE}else if(e==tc.TLB_STYLE){if(qA[e]>0)l.width=qA[e];else l.width=6*tg.TLB_ICON_HEIGHT;l.height=tg.TLB_ICON_HEIGHT;l.flags|=tc.TLBFLAG_COMBO}else if(e==tc.TLB_ZOOM){if(qA[e]>0)l.width=qA[e];else l.width=11*tg.TLB_ICON_HEIGHT/4;l.height=tg.TLB_ICON_HEIGHT;l.flags|=tc.TLBFLAG_COMBO;l.flags|=tc.TLBFLAG_EDITABLE}else if(e==tc.TLB_BOLD){l.CmdId=tc.ID_BOLD_ON;l.flags|=tc.TLBFLAG_MOUSE;l.IconX=99;l.IconY=120}else if(e==tc.TLB_ITALIC){l.CmdId=tc.ID_ITALIC_ON;l.flags|=tc.TLBFLAG_MOUSE;l.IconX=128;l.IconY=120}else if(e==tc.TLB_ULINE){l.CmdId=tc.ID_ULINE_ON;l.flags|=tc.TLBFLAG_MOUSE;l.IconX=160;l.IconY=116}else if(e==tc.TLB_ALIGN_LEFT){l.CmdId=tc.ID_LEFT_JUSTIFY;l.flags|=tc.TLBFLAG_MOUSE;l.IconX=29;l.IconY=62}else if(e==tc.TLB_ALIGN_CENTER){l.CmdId=tc.ID_CENTER;l.flags|=tc.TLBFLAG_MOUSE;l.IconX=2;l.IconY=63}else if(e==tc.TLB_ALIGN_RIGHT){l.CmdId=tc.ID_RIGHT_JUSTIFY;l.flags|=tc.TLBFLAG_MOUSE;l.IconX=55;l.IconY=62}else if(e==tc.TLB_ALIGN_JUSTIFY){l.CmdId=tc.ID_JUSTIFY;l.flags|=tc.TLBFLAG_MOUSE;l.IconX=1;l.IconY=90}else if(e==tc.TLB_INC_INDENT){l.CmdId=tc.ID_LEFT_INDENT;l.flags|=tc.TLBFLAG_MOUSE;l.IconX=62;l.IconY=152}else if(e==tc.TLB_DEC_INDENT){l.CmdId=tc.ID_LEFT_INDENT_DEC;l.flags|=tc.TLBFLAG_MOUSE;l.IconX=245;l.IconY=147}else if(e==tc.TLB_CUT){l.CmdId=tc.ID_CUT;l.flags|=tc.TLBFLAG_MOUSE;l.IconX=157;l.IconY=86}else if(e==tc.TLB_COPY){l.CmdId=tc.ID_COPY;l.flags|=tc.TLBFLAG_MOUSE;l.IconX=189;l.IconY=88}else if(e==tc.TLB_PASTE){l.CmdId=tc.ID_PASTE;l.flags|=tc.TLBFLAG_MOUSE;l.IconX=219;l.IconY=88}else if(e==tc.TLB_PAINT_FORMAT){l.CmdId=tc.ID_PAINT_FORMAT;l.flags|=tc.TLBFLAG_MOUSE;l.IconX=196;l.IconY=148}else if(e==tc.TLB_NEW){l.CmdId=tc.ID_NEW;l.flags|=tc.TLBFLAG_MOUSE;l.IconX=218;l.IconY=58}else if(e==tc.TLB_OPEN){l.CmdId=tc.ID_OPEN;l.flags|=tc.TLBFLAG_MOUSE;l.IconX=158;l.IconY=150}else if(e==tc.TLB_SAVE){l.CmdId=tc.ID_SAVE;l.flags|=tc.TLBFLAG_MOUSE;l.IconX=189;l.IconY=59}else if(e==tc.TLB_PRINT){l.CmdId=tc.ID_PRINT;l.flags|=tc.TLBFLAG_MOUSE;l.IconX=247;l.IconY=57}else if(e==tc.TLB_PREVIEW){l.CmdId=tc.ID_PRINT_PREVIEW;l.flags|=tc.TLBFLAG_MOUSE;l.IconX=124;l.IconY=87}else if(e==tc.TLB_HELP){l.CmdId=tc.ID_TER_HELP;l.flags|=tc.TLBFLAG_MOUSE;l.IconX=253;l.IconY=29}else if(e==tc.TLB_PAR){l.CmdId=tc.ID_SHOW_PARA_MARK;l.flags|=tc.TLBFLAG_MOUSE;l.IconX=252;l.IconY=86}else if(e==tc.TLB_NUMBER){l.CmdId=tc.ID_PARA_NBR;l.flags|=tc.TLBFLAG_MOUSE;l.IconX=34;l.IconY=152}else if(e==tc.TLB_BULLET){l.CmdId=tc.ID_BULLET;l.flags|=tc.TLBFLAG_MOUSE;l.IconX=5;l.IconY=152}else if(e==tc.TLB_BULLET_DROPDOWN){l.CmdId=tc.ID_BULLET_DROPDOWN;l.flags|=tc.TLBFLAG_MOUSE|tc.TLBFLAG_DROPDOWN;l.IconX=0;l.IconY=0;l.width=l.width/2;l.IconWidth=l.width}else if(e==tc.TLB_UNDO){l.CmdId=tc.ID_UNDO;l.flags|=tc.TLBFLAG_MOUSE;l.IconX=92;l.IconY=33}else if(e==tc.TLB_REDO){l.CmdId=tc.ID_REDO;l.flags|=tc.TLBFLAG_MOUSE;l.IconX=124;l.IconY=33}else if(e==tc.TLB_FIND){l.CmdId=tc.ID_SEARCH;l.flags|=tc.TLBFLAG_MOUSE;l.IconX=192;l.IconY=30}else if(e==tc.TLB_DATE){l.CmdId=tc.ID_INSERT_DATE_TIME;l.flags|=tc.TLBFLAG_MOUSE;l.IconX=222;l.IconY=31}else if(e==tc.TLB_PAGE_NUM){l.CmdId=tc.ID_INSERT_PAGE_NUMBER;l.flags|=tc.TLBFLAG_MOUSE;l.IconX=167;l.IconY=1}else if(e==tc.TLB_PAGE_COUNT){l.CmdId=tc.ID_INSERT_PAGE_COUNT;l.flags|=tc.TLBFLAG_MOUSE;l.IconX=192;l.IconY=1}else if(e==0){l.CmdId=f;l.flags|=tc.TLBFLAG_MOUSE;l.image=i;l.id=tc.MAX_TLB;for(a=0;a<tc.MAX_TLB_LINES;a++){for(n=0;n<IL[a];n++){if(a==t&&n==c)continue;var A=gL[a][n];if(A.id>=l.id)l.id=A.id+1}}}gL[t][c]=l;return true};function Qp(t){var e,r,i;var f;var l;var a,n,c;if(t==undefined)t=0;if(xA&&t==0)return;for(e=0;e<tc.MAX_TLB_LINES;e++){for(r=0;r<IL[e];r++){pTlb=gL[e][r];if(t>0&&pTlb.CmdId!=t)continue;i=pTlb.id;if(i>=tc.MAX_TLB)i=0;if(i<tc.MAX_TLB&&Nj(pTlb.flags&tc.TLBFLAG_MOUSE)){if(Nj(pTlb.flags&tc.TLBFLAG_DROPDOWN)){width=pTlb.IconWidth;height=pTlb.IconHeight;var s=width/2+4;var _=width/2-2;var o=width/2-1;var u=(height-_)/2;f=document.createElement("canvas");f.width=pTlb.IconWidth;f.height=pTlb.IconHeight;gr=f.getContext("2d");if(nA==null)BkColor=WO;else BkColor=cA;a=BkColor.red;n=BkColor.green;c=BkColor.blue;HH(gr,BkColor,new tc.RECT(0,0,width,height));MH(gr,new tc.Pen(BkColor),0,0,width,height);var T=[3];T[0]=new tc.Point(o-s/2,u);T[1]=new tc.Point(o+s/2,u);T[2]=new tc.Point(o,u+_);EJ(gr,new tc.Brush(tc.Color.darkGray),T);pTlb.image=gr.getImageData(0,0,pTlb.IconWidth,pTlb.IconHeight);l=pTlb.image.data;pTlb.CheckedImage=qp(gr,l,width,height,a,n,c);pTlb.GrayedImage=$p(gr,l,width,height,a,n,c);pTlb.GrayedCheckedImage=qp(gr,pTlb.GrayedImage.data,width,height,a,n,c);pTlb.CurImage=pTlb.image}else{f=document.createElement("canvas");f.width=pTlb.IconWidth;f.height=pTlb.IconHeight;gr=f.getContext("2d");gr.clearRect(0,0,f.width,f.height);if(i==0){if(pTlb.image!=null){var A=false;try{if(I==1)gr.drawImage(pTlb.image,0,0,pTlb.IconWidth,pTlb.IconHeight);else gr.drawImage(pTlb.image,0,0,Math.round(pTlb.IconWidth/I),Math.round(pTlb.IconHeight/I),0,0,pTlb.IconWidth,pTlb.IconHeight);A=true}catch(t){}if(!A){try{gr.putImageData(pTlb.image,0,0)}catch(t){}}}}else{if(I==1)gr.drawImage(tg.ToolbarBM,pTlb.IconX,pTlb.IconY,pTlb.IconWidth,pTlb.IconHeight,0,0,pTlb.IconWidth,pTlb.IconHeight);else gr.drawImage(tg.ToolbarBM,pTlb.IconX,pTlb.IconY,Math.round(pTlb.IconWidth/I),Math.round(pTlb.IconHeight/I),0,0,pTlb.IconWidth,pTlb.IconHeight)}pTlb.image=gr.getImageData(0,0,pTlb.IconWidth,pTlb.IconHeight);if(nA==null)BkColor=WO;else BkColor=cA;l=pTlb.image.data;var E=0,R,L;width=pTlb.IconWidth;height=pTlb.IconHeight;a=BkColor.red;n=BkColor.green;c=BkColor.blue;var C=8*I;for(R=0;R<height;R++){E=R*(width*4);for(L=0;L<width;L++){if(l[E]==189&&l[E+1]==189&&l[E+2]==189||l[E]==198&&l[E+1]==198&&l[E+2]==198||Math.abs(l[E]-l[E+1])<C&&Math.abs(l[E]-l[E+2])<C&&l[E]>=189){l[E]=a;l[E+1]=n;l[E+2]=c}E+=4}}pTlb.image.data=l;pTlb.CheckedImage=qp(gr,l,width,height,a,n,c);pTlb.GrayedImage=$p(gr,l,width,height,a,n,c);pTlb.GrayedCheckedImage=qp(gr,pTlb.GrayedImage.data,width,height,a,n,c);pTlb.CurImage=pTlb.image}}}}xA=true}function qp(t,e,r,i,f,l,a){var n=[];try{n=new Uint8ClampedArray(e)}catch(t){var c,s=r*i*4;for(c=0;c<s;c++)n[c]=e[c]}var _=255;var o=216;var u=107;var T=48;var A=41;var E=194;var R=136;var L=107;var C=t.createImageData(r,i);for(row=0;row<i;row++){idx=row*(r*4);for(col=0;col<r;col++){if(col==0||row==0||col+1==r||row+1==i){var I=col==0&&row==0||col==0&&row+1==i||col+1==r&&row==0||col+1==r&&row+1==i;if(!I){n[idx]=E;n[idx+1]=R;n[idx+2]=L}}else if(col==1&&row==1||row==1&&col+1==r-1||col==1&&row+1==i-1||col+1==r-1&&row+1==i-1){n[idx]=E;n[idx+1]=R;n[idx+2]=L}else if(n[idx]==f&&n[idx+1]==l&&n[idx+2]==a){n[idx]=_;n[idx+1]=o+Math.floor(T*row/i);n[idx+2]=u+Math.floor(A*row/i)}C.data[idx]=n[idx];C.data[idx+1]=n[idx+1];C.data[idx+2]=n[idx+2];C.data[idx+3]=n[idx+3];idx+=4}}return C}function $p(t,e,r,i,f,l,a){var n=[];try{n=new Uint8ClampedArray(e)}catch(t){var c,s=r*i*4;for(c=0;c<s;c++)n[c]=e[c]}var _=t.createImageData(r,i);for(row=0;row<i;row++){idx=row*(r*4);for(col=0;col<r;col++){var o=Math.floor((n[idx]+n[idx+1]+n[idx+2])/3);_.data[idx]=o;_.data[idx+1]=o;_.data[idx+2]=o;_.data[idx+3]=128;idx+=4}}return _}function tN(){var t,e,r,i,f,l,a,n;var c;var s=false;var _=false;if(!oi.ToolBar)return true;Qp();if(hL>=0){if(wO!=null&&wO.item.length>=hL+OL)wO.item.splice(hL,OL);hL=-1}wA=0;dL=0;n=tg.TLB_ICON_HEIGHT+2*tg.TLB_MARGIN;l=tg.TLB_MARGIN;for(t=FL;t<tc.MAX_TLB_LINES;t++){if(IL[t]>0){l+=wA;wA+=n;dL++}f=tg.TLB_MARGIN;for(r=0;r<IL[t];r++){var o=false;c=gL[t][r];e=c.id;a=c.width;if(c.id==tc.TLB_LINE||c.id==tc.TLB_SPACER)a=tg.TLB_ICON_HEIGHT;o=f+a<_i.cvs.width*SL/100;if(SL>=100)o=true;if(c.CmdId==tc.ID_TOOLBAR_MENU&&!s){o=true;s=true}if(o){c.x=f;if(c.CmdId==tc.ID_TOOLBAR_MENU)c.x=_i.cvs.width-c.width;c.y=l;if(Dj(c.flags&tc.TLBFLAG_COMBO))c.y++;if(tg.TLB_ICON_HEIGHT>JV(20)&&Nj(c.flags&tc.TLBFLAG_COMBO))c.y+=(tg.TLB_ICON_HEIGHT-JV(20))/2;if(c.CmdId!=tc.ID_TOOLBAR_MENU)f+=c.width}else{c.x=_i.cvs.width;var u=false;if(c.CmdId>0){_i.TerAddToolbarMenuItem(null,c.CmdId,c.pBalloon);u=true}else if(c.id==tc.TLB_LINE){_i.TerAddToolbarMenuItem(null,c.CmdId,"");u=true}else if(c.id==tc.TLB_ZOOM){_i.TerAddToolbarMenuItem(null,tc.ID_ZOOM,"Zoom");u=true}else if(c.id==tc.TLB_TYPEFACE||c.id==tc.TLB_POINTSIZE){if(!_){_i.TerAddToolbarMenuItem(null,tc.ID_FONTS,"Font...");u=true;_=true}}else if(c.id==tc.TLB_STYLE){_i.TerAddToolbarMenuItem(null,tc.ID_PARA_STYLE,"Paragraph Style...");u=true}if(u){if(hL<0){hL=wO.item.length-1;OL=0}OL++}AddOptionIcon=true}gL[t][r]=c}}var T=wO!=null&&wO.item.length>0;var A=-1;for(r=0;r<IL[0];r++){if(gL[FL][r].CmdId==tc.ID_TOOLBAR_MENU)A=r}if(!s&&T){var E=gL[FL].length;if(A>=0)c.x=_i.cvs.width-c.width;else{gL[FL][E]=c=new tc.ClsTlb;IL[FL]++;c.CmdId=tc.ID_TOOLBAR_MENU;c.IconWidth=tg.TLB_ICON_HEIGHT;c.IconHeight=tg.TLB_ICON_HEIGHT;c.height=tg.TLB_ICON_HEIGHT;c.width=tg.TLB_ICON_HEIGHT+2;c.x=_i.cvs.width-c.width;c.y=tg.TLB_MARGIN;c.pBalloon=nk("Options");c.flags=tc.TLBFLAG_MOUSE|tc.TLBFLAG_ENABLED;c.image=Zp();Qp(tc.ID_TOOLBAR_MENU)}}if(s&&!T){for(t=0;t<tc.MAX_TLB_LINES;t++){for(r=0;r<IL[t];r++){if(gL[t][r].CmdId==tc.ID_TOOLBAR_MENU){gL[t][r].x=_i.cvs.width}}}}WA=[];bA=[];var R=0;if(oi.ShowMenu)R+=tg.MENU_HEIGHT;var L=0;for(t=FL;t<FL+dL;t++){WA[t]=new tc.TlbToolBar;bA[t]=wA/dL;if(t>0&&t==dL-1)bA[t]=wA-bA[0]*(dL-1);if(nA==null)WA[t].BkColor=WO;else WA[t].BkColor=cA;WA[t].x=K.left;WA[t].y=R;WA[t].width=_i.cvs.width;WA[t].height=bA[t];R+=bA[t]}TlbPointSizeCB=null;for(t=FL;t<FL+dL;t++){for(r=0;r<IL[t];r++){c=gL[t][r];c.BarIdx=t;e=c.id;if(c.x>=_i.cvs.width)continue;if(e==tc.TLB_LINE){}else if(Nj(c.flags&tc.TLBFLAG_COMBO)){var C=true;var I=WA[t].y+tg.TLB_MARGIN;var d=new $t.ComboBox(_i.cvs,c.x,I,c.width,c.height,true,200,Dj(c.flags&tc.TLBFLAG_EDITABLE),JA,true,true,function(t,e){aN(t,e)});d.num1=t;d.num2=r;c.ctl=d;if(e==tc.TLB_TYPEFACE){nX(false,d,null);d.setName("typeface")}else if(e==tc.TLB_POINTSIZE){var F=$w();aX(false,d,null,xs[F].TypeFace,xs[F].TwipsSize);TlbPointSizeCB=d;d.setName("pointsize")}else if(e==tc.TLB_ZOOM){var g=7;var P=["200%","150%","100%","75%","50%","25%","10%"];d.setItems(P,null,2,false);d.setMaximumRowCount(P.length);d.setName("zoom")}else if(e==tc.TLB_STYLE){XZ(d,0,true,false);d.setName("style")}}else if(Nj(c.flags&tc.TLBFLAG_MOUSE)){}}}if(oi.ReadOnly)Yp(false);kA=-1;XA=-1;if(tg.ToolbarBMLoaded)yA=true;FN(true);return true}function eN(t,e,r){var i,f,l;if(!oi.ToolBar)return false;t=JV(t);e=JV(e);if(e<xO)return false;if(e>xO+wA)return false;if(!r)return true;for(i=FL;i<FL+dL;i++){for(f=0;f<IL[i];f++){var a=gL[i][f];if(Dj(a.flags&tc.TLBFLAG_MOUSE)||a.CmdId<=0)continue;var n=a.BarIdx;var c=WA[n].x+a.x;var s=WA[FL].y+a.y;if(WH(t,e,c,s,a.width,a.height)){_i.TerSetFocus();_i.TerCommand(a.CmdId);_i.ForgetMouseUp=true;return true}}}return true}function rN(t,e){var r,i,f;if(!oi.ToolBar)return false;t=JV(t);e=JV(e);if(_i.cvs.comps!=null&&_i.cvs.comps.hasFocus()){fN();return true}if(e<xO||e>xO+wA){if(eE!=null){Ti.save();Ti.setTransform(1,0,0,1,0,0);eE.flags=cj(eE.flags,tc.TLBFLAG_HILIGHTED);LN(eE);Ti.restore();eE=null}fN();return false}for(r=FL;r<FL+dL;r++){for(i=0;i<IL[r];i++){var l=gL[r][i];if(Dj(l.flags&tc.TLBFLAG_MOUSE)||l.CmdId<=0)continue;var a=l.BarIdx;var n=WA[a].x+l.x;var c=WA[FL].y+l.y;if(WH(t,e,n,c,l.width,l.height)){if(eE!=null&&l.CmdId==eE.CmdId)return true;Ti.save();Ti.setTransform(1,0,0,1,0,0);if(eE!=null){eE.flags=cj(eE.flags,tc.TLBFLAG_HILIGHTED);LN(eE)}l.flags|=tc.TLBFLAG_HILIGHTED;eE=l;LN(eE);Ti.restore();pL=l;if(ML!=null&&ML.style.visibility=="visible")iN();else{fN();BL=setInterval(iN,1e3)}return true}}}return true}function iN(){if(!oi.ToolBar)return;fN();if(pL==null)return true;lN();if(ML==null||GL==null)return true;GL.innerHTML=pL.pBalloon;var t=tc.GetElementPosition(_i.cvs);var e=pL.BarIdx;var r=t.x+zV(WA[e].x+pL.x)+5;var i=t.y+zV(WA[FL].y+pL.y+pL.IconHeight)+5;ML.style.left=r+"px";ML.style.top=i+"px";ML.style.visibility="visible";HL=setInterval(fN,1e4)}function fN(){if(BL!=null){clearInterval(BL);BL=null}if(HL!=null){clearInterval(HL);HL=null}if(ML!=null)ML.style.visibility="hidden"}function lN(){if(ML!=null)return true;ML=document.createElement("div");ML.style.position="absolute";ML.style.left="100px";ML.style.top="15px";ML.style.minWidth="1px";ML.style.minHeight="1px";ML.style.backgroundColor=new tc.Color(184,207,229).toString();ML.style.zIndex="1000";ML.style.visibility="hidden";ML.style.border="thin solid "+new tc.Color(99,130,191).toString();GL=document.createElement("span");GL.style.backgroundColor=new tc.Color(184,207,229).toString();GL.style.minWidth="1px";GL.style.minHeight="1px";GL.style.margin="5px";ML.appendChild(GL);var t=document.body||document.documentElement;t.appendChild(ML)}function aN(t,e){var r;if(t=="beforehidinglistbox")si=true;if(t=="BeforeListBoxShow")si=false;if(t!="selected"&&t!="BeforeListBoxShow")return;var i=gL[e.num1][e.num2];var f=i.id;var l=e.getSelectedItem();if(f==tc.TLB_TYPEFACE){if(k_<0&&uA==tc.HILIGHT_OFF&&ui[br].len==1){sA=_A=br;TA=0;AA=1;uA=tc.HILIGHT_CHAR;_i.SetTerFont(l,false);uA=tc.HILIGHT_OFF}_i.SetTerFont(l,true);if(t=="selected"&&EO>0&&TlbPointSizeCB!=null){r=$w();r=Ly(r);aX(false,TlbPointSizeCB,null,xs[r].TypeFace,xs[r].TwipsSize)}Iy(l);UD(tc.TER_ACTION,tc.ACTION_COMMAND,tc.ID_FONTS,false)}else if(f==tc.TLB_POINTSIZE){var a=CX(l)*20;if(t=="BeforeListBoxShow"&&EO>0){r=$w();aX(false,e,null,xs[r].TypeFace,xs[r].TwipsSize);return}if(k_<0&&uA==tc.HILIGHT_OFF&&ui[br].len==1){sA=_A=br;TA=0;AA=1;uA=tc.HILIGHT_CHAR;_i.SetTerPointSize(-a,false);uA=tc.HILIGHT_OFF}_i.SetTerPointSize(-a,true);UD(tc.TER_ACTION,tc.ACTION_COMMAND,tc.ID_FONTS,false)}else if(f==tc.TLB_STYLE){var n=e.getSelectedItemIdx();var c=e.getValueAt(n);if(c>=0&&W_[c].InUse){if(!DX(-tc.ACTION_STYLE,c,0)){if(W_[c].type==tc.SSTYPE_CHAR)_i.TerSelectCharStyle(c,true);else return _i.TerSelectParaStyle(c,true);NX(-tc.ACTION_STYLE,c,0)}}}else if(f==tc.TLB_ZOOM){var s=l.length;var _=Uk(l);if(s>0&&_[s-1]==gk("%"))l=cV(l,0,s-1);var o=LX(l);_i.TerSetZoom(o);UD(tc.TER_ACTION,tc.ACTION_COMMAND,tc.ID_ZOOM,false)}if(_i.caret){_i.TerSetFocus()}zQ()}function nN(){_i.TerAddBullet(9679,"Arial",false);_i.TerAddBullet(tc.CHAR_o,"Courier New",false);_i.TerAddBullet(9670,"Arial",false);_i.TerAddBullet(9632,"Arial",false);_i.TerAddBullet(9678,"Arial",false);_i.TerAddBullet(9723,"Arial",false);_i.TerAddBullet(9658,"Arial",false);_i.TerAddBullet(9744,"Arial",false);_i.TerAddBullet(10003,"Arial",false);_i.TerAddBullet(9755,"Arial",false);_i.TerAddBullet(9746,"Arial",false);_i.TerAddBullet(9745,"Arial",false);_i.TerAddBullet("-".charCodeAt(0),"Courier New",false);return true}_i.TerRemoveAllBullets=function(t){kc=0;if(t)_i.TerRecreateToolbar(true);return true};_i.TerAddBullet=function(t,e,r){return _i.TerAddBullet2(t,e,0,r)};_i.TerAddBullet2=function(t,e,r,i){var f=0;if(kc>=Xc){Xc=kc+5;if(Uc==null)Uc=[];if(Pn==null)Pn=[]}if(kc==0){Uc[kc]=new tc.ClsCustBlt;Uc[kc].unicode=0;kc++}Uc[kc]=new tc.ClsCustBlt;Uc[kc].unicode=t;Uc[kc].typeface=e;Uc[kc].TwipsSize=r>0?r:12*20;Uc[kc].AutoSize=r==0;if(e.toLowerCase().indexOf("wingdings")>=0)f=tc.SYMBOL_CHARSET;else if(e.toLowerCase().indexOf("webdings")>=0)f=tc.SYMBOL_CHARSET;else if(e.toLowerCase().indexOf("symbol")>=0)f=tc.SYMBOL_CHARSET;Uc[kc].CharSet=f;kc++;if(i)_i.TerRecreateToolbar(true);return true};function cN(t,e){var r=fn-rt.left+Ft;var i=Gt+ln;var f,l,a,n;if(!hn)return false;t=JV(t);e=JV(e);t=t-rt.left+Ft;e=e-rt.top+Gt;if(t<r||t>r+an)return false;if(e<i||e>i+nn)return false;var c=Cn;var s;Cn=-1;for(s=0;s<kc;s++){f=Pn[s].left-rt.left+Ft;l=Pn[s].top+Gt;a=f+Pn[s].right-Pn[s].left;n=l+Pn[s].bottom-Pn[s].top;if(t>=f&&t<=a&&e>=l&&e<=n){Cn=s;break}}var _=dn;dn=-1;if(!vn){for(s=0;s<Sn.length;s++){f=Sn[s].left-rt.left+Ft;l=Sn[s].top+Gt;a=f+Sn[s].right-Sn[s].left;n=l+Sn[s].bottom-Sn[s].top;if(t>=f&&t<=a&&e>=l&&e<=n){dn=s;break}}}if(c!=Cn||_!=dn)cG();return true}function sN(t,e){var r=fn-rt.left+Ft;var i=Gt+ln;var f,l,a,n;if(!hn)return false;t=JV(t);e=JV(e);t=t-rt.left+Ft;e=e-rt.top+Gt;if(t<r||t>r+an||e<i||e>i+nn){hn=false;cG();return false}var c,s=-1;for(c=0;c<kc;c++){f=Pn[c].left-rt.left+Ft;l=Pn[c].top+Gt;a=f+Pn[c].right-Pn[c].left;n=l+Pn[c].bottom-Pn[c].top;if(t>=f&&t<=a&&e>=l&&e<=n){s=c;break}}if(s>=0){hn=false;if(An==tc.ID_BULLET_DROPDOWN){if(s!=Ln||s==0)oN(s)}cG()}if(!vn){s=-1;for(c=0;c<Sn.length;c++){f=Sn[c].left-rt.left+Ft;l=Sn[c].top+Gt;a=f+Sn[c].right-Sn[c].left;n=l+Sn[c].bottom-Sn[c].top;if(t>=f&&t<=a&&e>=l&&e<=n){s=c;break}}if(s>=0){hn=false;if(An==tc.ID_BULLET_DROPDOWN){_N(s)}}}return true}function _N(t){if(t==0)In+=10;else if(t==1)In-=10;uN();return true}function oN(t){var e=ui[br].pfmt;var r=Nc[e].BltId;var i=false;if(t==0){if(_i.TerMenuSelect2(tc.ID_BULLET))_i.TerSetListBullet(false,tc.LIST_BLT,-1,1,"","",false);if(_i.TerMenuSelect2(tc.ID_PARA_NBR))_i.TerSetListBullet(false,tc.LIST_DEC,-1,1,"",".",false);return true}i=Uc[t].AutoSize;if(i&&In!=0)i=false;if((r==0||xc[r].ls==0)&&!_i.TerMenuSelect2(tc.ID_PARA_NBR)){if(t==1&&kc>=3)_i.TerCommand(tc.ID_BULLET);else{if(_i.TerMenuSelect2(tc.ID_PARA_NBR))_i.TerSetListBullet(false,tc.LIST_DEC,-1,1,"",".",false);_i.TerSetCustBullet(Uc[t].unicode,Uc[t].FontId,i)}}else if(r>0){var f=xc[r].ls;var l=Jc[f].ListIdx;var a=xc[r].lvl;var n=null;if(Kc[l].LevelCount>a)n=Kc[l].level;if(Jc[f].LevelCount>a)n=Jc[f].level;if(n!=null){var c=n[a].txt[0]!=1||n[a].txt[1]!=Uc[t].unicode||n[a].FontId!=Uc[t].FontId||n[a].NumType!=tc.LIST_BLT;if(c){V8(br,0,br,0,tc.UNDO_LIST_LEVEL);n[a].txt[0]=1;n[a].txt[1]=Uc[t].unicode;n[a].FontId=Uc[t].FontId;n[a].NumType=tc.LIST_BLT;n[a].CharMask=cj(n[a].CharMask,tc.CMASK_SIZE);n[a].CharMask|=tc.CMASK_FONT;if(!i)n[a].CharMask|=tc.CMASK_SIZE;_i.TerRepaginate(true)}}}return true}_i.TerSetPopupBoxParam=function(t,e,r){if(t!=tc.PBPOS_DEFAULT||e!=tc.PBPOS_DEFAULT){Fn=t;gn=e;On=true}vn=r;return true};function uN(){var t,e,r=-9999;var i=4,f;var l=JV(50),a=JV(50),n=JV(7);var c=kc;if(hn){hn=false;cG();return true}if(kc<=0)return true;if(kc>0){for(t=FL;t<FL+dL;t++){for(e=0;e<IL[t];e++){var s=gL[t][e];if(s.CmdId==tc.ID_BULLET_DROPDOWN){r=s.x+s.IconWidth/2;break}}}}else r=rt.left+je;if(On){if(Fn>=0)r=rt.left+Fn;else if(Fn==tc.PBPOS_LEFT)r=rt.left;else if(Fn==tc.PBPOS_CENTER)r=rt.left+je/2;else if(Fn==tc.PBPOS_RIGHT)r=rt.left+je}f=0;for(t=1;t<kc;t++){var _=Uc[t].TwipsSize+In;if(_<JV(10))_=JV(10);Uc[t].FontId=Rb(Ti,0,Uc[t].typeface,_,0,xs[0].TextColor,xs[0].TextBkColor,xs[0].UlineColor,0,0,0,1,0,0,0,0,null,0,Uc[t].CharSet,0,xs[0].TextAngle);if(_>f)f=_}if(dV(f)>l)l=dV(f);if(hV(f)>a)a=hV(f);_n=5;on=5;un=Hr*3/2;Tn=5;while(i>1){Rn=Math.floor(Math.sqrt(c));if(Rn<i)Rn=i;En=Math.floor(c/Rn);if(Rn*En<c)En++;an=l*Rn+_n+on;nn=a*En+un+Tn;fn=r-an/2;if(fn+an>rt.left+je)fn=rt.left+je-an;if(fn<rt.left)fn=rt.left;if(an>je&&nn<Mt){if(i>1)i--;else break}else break}ln=0;cn=l;sn=a;if(On){if(gn>=0)ln=gn-nn/2;else if(gn==tc.PBPOS_MIDDLE)ln=(Mt-nn)/2;else if(gn==tc.PBPOS_BOT)ln=Mt-nn;if(ln<0)ln=0}for(t=0;t<kc;t++){var o=fn+_n;var u=ln+un;var T=Math.floor(t/Rn);var A=t-T*Rn;Pn[t]=new tc.RECT(o+A*l+n,u+T*a+n,l-2*n,a-2*n)}if(!vn){Sn=[2];Sn[0]=new tc.RECT;Sn[0].left=fn+an-3*Hr;Sn[0].right=Sn[0].left+Hr;Sn[0].top=ln+(un-Hr)/2;Sn[0].bottom=Sn[0].top+Hr;Sn[1]=new tc.RECT;Sn[1].left=Sn[0].right+Hr/2;Sn[1].right=Sn[1].left+Hr;Sn[1].top=Sn[0].top;Sn[1].bottom=Sn[0].bottom}Ln=-1;var E=ui[br].pfmt;var R=Nc[E].BltId;if(R>0&&xc[R].ls>0){var L=xc[R].ls;var C=xc[R].lvl;var I=sQ(L,C);if(I!=null&&I.NumType==tc.LIST_BLT&&I.txt[0]==1){var d=I.FontId;var F=I.txt[1];if(d>=0&&d<Ys){for(t=1;t<kc;t++){var g=Uc[t].FontId;if(g>=0&&g<Ys){if(Uc[t].unicode==F&&Tk(xs[g].TypeFace,xs[d].TypeFace)==0&&xs[g].TwipsSize==xs[d].TwipsSize){Ln=t;break}}}}}}else Ln=0;Cn=-1;hn=true;An=tc.ID_BULLET_DROPDOWN;cG();return true}function TN(t){if(An==tc.ID_BULLET_DROPDOWN)return AN(t);return true}function AN(t){var e,r,i,f,l,a,n;var c=fn-rt.left+Ft;var s=Gt+ln;var _=false;HH(t,new tc.Color(251,251,251),new tc.RECT(c,s,an,nn));HH(t,new tc.Color(240,240,240),new tc.RECT(c,s,an,un));MH(t,new tc.Pen(new tc.Color(204,204,204)),c+1,s+1,an-2,nn-2);var o=s+(un-Hr)/2;var u=c+_n;SH(t,"Bullet Library",P,new tc.Color(48,48,48),new tc.Rectangle(u,o,an-_n,Hr));if(In==0){for(e=1;e<kc;e++)if(!Uc[e].AutoSize)break;if(e==kc)_=true}if(!vn){var T=dn==0?new tc.Color(128,208,128):new tc.Color(48,48,48);if(_)T=new tc.Color(96,160,96);n=dn==0?2:1;a=Hr/6;if(dn==0)a--;r=Sn[0].left-rt.left+Ft+a;i=Sn[0].top+Gt+a;f=l=Hr-2*a;OH(t,new tc.Pen(n,T),r,i+l/2,r+f,i+l/2);OH(t,new tc.Pen(n,T),r+f/2,i,r+f/2,i+l);T=dn==1?new tc.Color(128,208,128):new tc.Color(48,48,48);if(_)T=new tc.Color(96,160,96);n=dn==1?2:1;a=Hr/6;if(dn==1)a--;r=Sn[1].left-rt.left+Ft+a;i=Sn[0].top+Gt+a;f=l=Hr-2*a;OH(t,new tc.Pen(n,T),r,i+l/2,r+f,i+l/2)}for(e=0;e<kc;e++){var A=Pn[e].left-rt.left+Ft;var E=Pn[e].top+Gt;f=Pn[e].right-Pn[e].left;l=Pn[e].bottom-Pn[e].top;var R=wY(Uc[e].unicode);var L=Uc[e].FontId;var C=xs[L].font;var I,d;if(Uc[e].unicode==0){R="None";C=W}I=gJ(t,C,R);u=A+(f-I)/2;if(Uc[e].unicode==0)d=Hr;else d=xs[L].height;o=E+(l-d)/2;SH(t,R,C,tc.CLR_BLACK,new tc.Rectangle(u,o,I,d));MH(t,new tc.Pen(new tc.Color(160,160,160)),A,E,f,l);if(e==Ln||e==Cn){var F=3;var g=new tc.Color(96,160,96);if(e==Cn)g=new tc.Color(128,208,128);MH(t,new tc.Pen(F,g),A-F,E-F,f+2*F,l+2*F)}}return true}function EN(t){if(t==undefined)t=false;var e,r,i;var f;var l=null;var a=oi.modified;VA=true;for(e=FL;e<FL+dL;e++){var n=_i.cvs.width;WA[e].width=n;WA[e].height=bA[e]}i=$w();if(i<0)i=0;Ti.save();Ti.setTransform(1,0,0,1,0,0);var c=Ti.fillStyle;Ti.fillStyle=WA[FL].BkColor.toString();Ti.fillRect(WA[FL].x,WA[FL].y,WA[FL].width,wA);Ti.fillStyle=c;Ti.restore();RN(false);oi.modified=a;VA=false;MouseTLb=null;return true}function RN(t){var e,r,i,f,l,a;var n;var c=oi.modified;var s=!t;var _;var o=null;l=$w();if(l<0)l=0;Ti.save();Ti.setTransform(1,0,0,1,0,0);f=0;for(e=FL;e<FL+dL;e++){for(r=0;r<IL[e];r++){n=gL[e][r];i=n.id;if(i==tc.TLB_TYPEFACE){o=n.ctl;if(tE){nX(false,o,null);tE=false}if(k_>=0){if(Nj(W_[k_].CharMask&tc.CMASK_FONT))_=W_[k_].TypeFace;else _=xs[0].TypeFace}else _=xs[l].TypeFace;if(o!=null){if(t&&nV(_,o.getSelectedItem()))return D(true);if(s){o.locked=true;o.setSelectedItem(_);o.locked=false}if(o.isHidden())o.setHidden(false);else o.refresh()}}else if(i==tc.TLB_POINTSIZE){o=n.ctl;if(k_>=0){if(Nj(W_[k_].CharMask&tc.CMASK_SIZE))a=W_[k_].TwipsSize;else a=xs[0].TwipsSize}else a=xs[l].TwipsSize;var u=a;var T=u/20;var A=T.toString();if(u>T*20)A+=".5";if(o!=null){if(t&&nV(A,o.getSelectedItem()))return D(true);if(s){o.locked=true;o.setSelectedItem(A);o.locked=false}if(o.isHidden())o.setHidden(false);else o.refresh()}}else if(i==tc.TLB_ZOOM){o=n.ctl;var E=nh;if(o!=null){_=mY(E)+"%";if(t){var R=o.getSelectedItem();if(nV(_,R))return D(true)}if(s){o.locked=true;o.setSelectedItem(_)}if(o.isHidden())o.setHidden(false);else o.refresh()}}else if(i==tc.TLB_STYLE){o=n.ctl;var L,C;if(Nj(Nc[ui[br].pfmt].StyId))L=Nc[ui[br].pfmt].StyId;else{var I=xs[l].CharStyId;if(I!=1&&W_[I].InUse)L=I;else L=0}if(o!=null){C=o.FindStringExact(W_[L].name);if(C==-1||YA){o.locked=true;XZ(o,0,true,false);o.locked=false;C=o.FindStringExact(W_[L].name);YA=false}if(t){var d=o.getSelectedItem();if(nV(d.item,W_[L].name))return D(true)}if(s){o.locked=true;o.setSelectedIndex(C);o.locked=false}if(o.isHidden())o.setHidden(false);else o.refresh()}}else if(i==tc.TLB_LINE){var F=new tc.Color(13684944);var g=new tc.Pen(F);var P=WA[e].x+n.x;f=WA[FL].y+n.y;var S=0;var h=8;CH(Ti,P,f+S,P,f+WA[e].height-S-h,F)}if(n.CmdId>0){var O=n.CmdId;var v=n.flags;var p=n.flags;var N=tc.TLBFLAG_ENABLED|tc.TLBFLAG_CHECKED|tc.TLBFLAG_HILIGHTED;p=cj(p,tc.TLBFLAG_ENABLED);Sh[n.CmdId-tc.ID_FIRST_COMMAND]=false;p=cj(p,tc.TLBFLAG_CHECKED);if(_i.TerMenuEnable(MX(O))==tc.MF_ENABLED){p|=tc.TLBFLAG_ENABLED;Sh[n.CmdId-tc.ID_FIRST_COMMAND]=true}if(i==mL&&i>0||_i.TerMenuSelect(MX(O))==tc.MF_CHECKED)p|=tc.TLBFLAG_CHECKED;if(t&&(v&N)!=(p&N))return D(true);if(s){n.flags=p;LN(n)}}gL[e][r]=n}f+=tg.TLB_ICON_HEIGHT+2*tg.TLB_MARGIN}return D(!t);function D(t){Ti.restore();oi.modified=c;MouseTLb=null;return t}}function LN(t){var e;var r;var i,f=false;var l=false;var a=false;var n,c,s,_;if(t.x>=_i.cvs.width)return true;if(Nj(t.flags&tc.TLBFLAG_CHECKED))f=true;r=t.image;if(Dj(t.flags&tc.TLBFLAG_ENABLED)){if(f)r=t.GrayedCheckedImage;else r=t.GrayedImage}else if(f)r=t.CheckedImage;var o=t.BarIdx;var u=WA[o].x+t.x;var T=WA[FL].y+t.y;Ti.putImageData(r,u,T);if(Nj(t.flags&tc.TLBFLAG_HILIGHTED)){var A=tc.Color.gray;var E=tc.Color.white;var R=t.IconWidth-JV(2);var L=t.IconHeight-JV(2);CH(Ti,u,T,u+R,T,E,false);CH(Ti,u,T,u,T+L,E,false);CH(Ti,u,T+L,u+R,T+L,A,false);CH(Ti,u+R,T,u+R,T+L,A,false)}return true}function CN(t,e,r,i,f){var l,a;var n=e+i-1;var c=r+f-1;var s,_=tc.Color.lightGray;var o=false;for(l=e;l<=n;l++){for(a=r;a<=c;a++){s=new tc.Color(t.getRGB(l,a));if(!o){_=s;o=true}if(s==_)t.setRGB(l,a,pJ(zT))}}return true}function IN(t,e,r,i,f){var l,a;var n=e+i-Math.floor(JV(1));var c=r+f-Math.floor(JV(1));var s,_;var o=8421504;var u=pJ(tc.CLR_WHITE);var T=pJ(Color.lightGray);var A,E,R;for(l=e;l<=n;l++){for(a=r;a<=c;a++){T=t.getRGB(l,a);break}}A=T&255;E=T>>8&255;R=T>>16&255;e++;r++;n--;c--;for(l=e;l<=n;l+=2){for(a=r;a<=c;a+=2){s=t.getRGB(l,a);var L=(s&255)-A;var C=(s>>8&255)-E;var I=(s>>16&255)-R;if(L<0)L=-L;if(C<0)C=-C;if(I<0)I=-I;if(L>16||C>16||I>16){t.setRGB(l,a,16777215)}}}return true}function dN(t,e,r,i,f){var l,a;var n=e+i-Math.floor(JV(1));var c=r+f-Math.floor(JV(1));var s;var _=8421504;var o=pJ(Color.lightGray);var u=pJ(Color.white);var T=14737632;var A;var E;var R=false;for(l=e;l<=n;l++){for(a=r;a<=c;a++){o=t.getRGB(l,a);break}}if(R){_=u=pJ(Color.blue);T=pJ(Color.blue)}for(l=e;l<=n;l++){t.setRGB(l,r,_);if(l>e)t.setRGB(l,c,u)}for(l=r;l<=c;l++){t.setRGB(e,l,_);if(l>r)t.setRGB(n,l,u)}e++;r++;n--;c--;A=true;for(l=e;l<=n;l++){E=A?r:r+1;for(a=E;a<=c;a++){s=t.getRGB(l,a);if(s==o)t.setRGB(l,a,T);if(R)a=a+2}A=!A}return true}_i.TerSetToolbarLimitPercent=function(t){if(!lv||!QD())_i.TerCreateControl();if(IsNaN(t))return false;if(t<0||t>100)return false;SL=t;return true};_i.TerExtTlbCmds=function(t){if(!lv||!QD())_i.TerCreateControl();_i.ExtTlbCmds=t};_i.TerUpdateToolbar=function(){if(!lv||!QD())_i.TerCreateControl();YA=true;return FN(true)};function FN(t){var e;var r=true;if(!VR&&!t)return false;if(VA)return false;if(hn)return false;var i=true;if(uA!=tc.HILIGHT_OFF&&!Sh[tc.ID_CUT-tc.ID_FIRST_COMMAND]&&_i.TerMenuEnable2(tc.ID_CUT))i=false;if(t)i=false;if(i&&(Qt==tc.WM_NCHITTEST||Qt==tc.WM_SETCURSOR||Qt==tc.WM_NCMOUSEMOVE))return true;e=QU();if(WA!=null){if(!t&&!RN(true))r=false;if(r)EN()}if(tS!=null){var f=new tc.ClsTlbStat(_i).init();if(!f.IsSame(vL))UD(tc.TER_UPDATE_TOOLBAR,S,0,false);vL=f}if(e&&!eL&&document.activeElement!=_i.VirtTextarea)_i.TerSetFocus();return true}function gN(){var t,e;zA[tc.TLB_LINE]="";zA[tc.TLB_TYPEFACE]="Font";zA[tc.TLB_POINTSIZE]="Font Size";zA[tc.TLB_BOLD]="Bold";zA[tc.TLB_ITALIC]="Italic";zA[tc.TLB_ULINE]="Underline";zA[tc.TLB_ALIGN_LEFT]="Align Left";zA[tc.TLB_ALIGN_RIGHT]="Align Right";zA[tc.TLB_ALIGN_CENTER]="Center";zA[tc.TLB_ALIGN_JUSTIFY]="Justify";zA[tc.TLB_INC_INDENT]="Increase Indent";zA[tc.TLB_DEC_INDENT]="Decrease Indent";zA[tc.TLB_STYLE]="Style";zA[tc.TLB_ZOOM]="Zoom";zA[tc.TLB_CUT]="Cut";zA[tc.TLB_COPY]="Copy";zA[tc.TLB_PASTE]="Paste";zA[tc.TLB_PAINT_FORMAT]="Format Painter";zA[tc.TLB_SPACER]="";zA[tc.TLB_NEW]="New";zA[tc.TLB_OPEN]="Open";zA[tc.TLB_SAVE]="Save";zA[tc.TLB_PRINT]="Print";zA[tc.TLB_HELP]="Help";zA[tc.TLB_PAR]="Show Markers";zA[tc.TLB_PREVIEW]="Print Preview";zA[tc.TLB_NUMBER]="Numbering";zA[tc.TLB_BULLET]="Bullets";zA[tc.TLB_BULLET_DROPDOWN]="Bullet Dropdown";zA[tc.TLB_UNDO]="Undo";zA[tc.TLB_REDO]="Redo";zA[tc.TLB_FIND]="Find";zA[tc.TLB_DATE]="Insert Date/Time";zA[tc.TLB_PAGE_NUM]="Insert Page Number";zA[tc.TLB_PAGE_COUNT]="Insert Page Count";for(t=0;t<tc.MAX_TLB_LINES;t++){ZA[t]=[tc.MAX_TLB_PER_LINE+1];QA[t]=[tc.MAX_TLB_PER_LINE+1];for(e=0;e<tc.MAX_TLB_PER_LINE;e++){ZA[t][e]=0;QA[t][e]=false}}t=-1;t++;ZA[0][t]=tc.TLB_SPACER;t++;ZA[0][t]=tc.TLB_LINE;t++;ZA[0][t]=tc.TLB_LINE;t++;ZA[0][t]=tc.TLB_NEW;t++;ZA[0][t]=tc.TLB_SPACER;t++;ZA[0][t]=tc.TLB_OPEN;t++;ZA[0][t]=tc.TLB_SPACER;t++;ZA[0][t]=tc.TLB_SAVE;t++;ZA[0][t]=tc.TLB_SPACER;t++;ZA[0][t]=tc.TLB_PRINT;t++;ZA[0][t]=tc.TLB_SPACER;t++;ZA[0][t]=tc.TLB_PREVIEW;t++;ZA[0][t]=tc.TLB_SPACER;t++;ZA[0][t]=tc.TLB_SPACER;t++;ZA[0][t]=tc.TLB_LINE;t++;ZA[0][t]=tc.TLB_SPACER;t++;ZA[0][t]=tc.TLB_CUT;t++;ZA[0][t]=tc.TLB_SPACER;t++;ZA[0][t]=tc.TLB_COPY;t++;ZA[0][t]=tc.TLB_SPACER;t++;ZA[0][t]=tc.TLB_PASTE;t++;ZA[0][t]=tc.TLB_SPACER;t++;ZA[0][t]=tc.TLB_PAINT_FORMAT;t++;ZA[0][t]=tc.TLB_SPACER;t++;ZA[0][t]=tc.TLB_SPACER;t++;ZA[0][t]=tc.TLB_LINE;t++;ZA[0][t]=tc.TLB_SPACER;t++;ZA[0][t]=tc.TLB_UNDO;t++;ZA[0][t]=tc.TLB_SPACER;t++;ZA[0][t]=tc.TLB_REDO;t++;ZA[0][t]=tc.TLB_SPACER;t++;ZA[0][t]=tc.TLB_SPACER;t++;ZA[0][t]=tc.TLB_LINE;t++;ZA[0][t]=tc.TLB_SPACER;t++;ZA[0][t]=tc.TLB_FIND;t++;ZA[0][t]=tc.TLB_SPACER;t++;ZA[0][t]=tc.TLB_SPACER;t++;ZA[0][t]=tc.TLB_LINE;t++;ZA[0][t]=tc.TLB_SPACER;t++;ZA[0][t]=tc.TLB_DATE;t++;ZA[0][t]=tc.TLB_SPACER;t++;ZA[0][t]=tc.TLB_PAGE_NUM;t++;ZA[0][t]=tc.TLB_SPACER;t++;ZA[0][t]=tc.TLB_PAGE_COUNT;t++;ZA[0][t]=tc.TLB_SPACER;t++;ZA[0][t]=tc.TLB_PAR;t++;ZA[0][t]=tc.TLB_SPACER;t++;ZA[0][t]=tc.TLB_SPACER;t++;ZA[0][t]=tc.TLB_LINE;t++;ZA[0][t]=tc.TLB_SPACER;t++;ZA[0][t]=tc.TLB_HELP;t++;ZA[0][t]=tc.TLB_SPACER;t++;ZA[0][t]=tc.TLB_SPACER;t++;ZA[0][t]=tc.TLB_ZOOM;t++;ZA[0][t]=tc.TLB_SPACER;t++;ZA[0][t]=tc.TLB_LINE;t++;ZA[0][t]=tc.TLB_SPACER;t=-1;t++;ZA[1][t]=tc.TLB_SPACER;t++;ZA[1][t]=tc.TLB_LINE;t++;ZA[1][t]=tc.TLB_LINE;t++;ZA[1][t]=tc.TLB_SPACER;t++;ZA[1][t]=tc.TLB_STYLE;t++;ZA[1][t]=tc.TLB_SPACER;t++;ZA[1][t]=tc.TLB_TYPEFACE;t++;ZA[1][t]=tc.TLB_SPACER;t++;ZA[1][t]=tc.TLB_POINTSIZE;t++;ZA[1][t]=tc.TLB_SPACER;t++;ZA[1][t]=tc.TLB_SPACER;t++;ZA[1][t]=tc.TLB_BOLD;t++;ZA[1][t]=tc.TLB_ITALIC;t++;ZA[1][t]=tc.TLB_ULINE;t++;ZA[1][t]=tc.TLB_SPACER;t++;ZA[1][t]=tc.TLB_LINE;t++;ZA[1][t]=tc.TLB_SPACER;t++;ZA[1][t]=tc.TLB_ALIGN_LEFT;t++;ZA[1][t]=tc.TLB_ALIGN_CENTER;t++;ZA[1][t]=tc.TLB_ALIGN_RIGHT;t++;ZA[1][t]=tc.TLB_ALIGN_JUSTIFY;t++;ZA[1][t]=tc.TLB_SPACER;t++;ZA[1][t]=tc.TLB_LINE;t++;ZA[1][t]=tc.TLB_SPACER;t++;ZA[1][t]=tc.TLB_NUMBER;t++;ZA[1][t]=tc.TLB_BULLET;t++;ZA[1][t]=tc.TLB_BULLET_DROPDOWN;t++;ZA[1][t]=tc.TLB_SPACER;t++;ZA[1][t]=tc.TLB_INC_INDENT;t++;ZA[1][t]=tc.TLB_DEC_INDENT;return true}function PN(){var t,e;if(oi.ToolBar)Vp();for(t=0;t<tc.MAX_TLB_LINES;t++){for(e=0;e<IL[t];e++){gL[t][e].pBalloon=null}IL[t]=0}return true}function SN(){var t,e;for(t=0;t<tc.MAX_TLB_LINES;t++){for(e=0;e<IL[t];e++){var r=gL[t][e];if(r.ctl!=null){r.ctl.delete()}}}if(oi.open&&yA){Ti.save();Ti.setTransform(1,0,0,1,0,0);var i=Ti.fillStyle;var f=Mt+rt.top-xO;Ti.fillStyle=WA[FL].BkColor.toString();Ti.fillRect(WA[FL].x,WA[FL].y,WA[FL].width,f);Ti.fillStyle=i;Ti.restore()}WA=null;wA=0;dL=0;if(oi.open){iG();op(true);cG()}return true}function hN(t,e,r){if(!eL)_i.TerSetFocus();if(e==tc.TLB_TYPEFACE){if(k_<0&&uA==tc.HILIGHT_OFF&&r[br].len==1){sA=_A=br;TA=0;AA=1;uA=tc.HILIGHT_CHAR;_i.SetTerFont(r,false);uA=tc.HILIGHT_OFF}_i.SetTerFont(r,true);UD(tc.TER_ACTION,tc.ACTION_COMMAND,tc.ID_FONTS,false)}else if(e==tc.TLB_POINTSIZE){var i=CX(r)*20;if(k_<0&&uA==tc.HILIGHT_OFF&&r[br].len==1){sA=_A=br;TA=0;AA=1;uA=tc.HILIGHT_CHAR;_i.SetTerPointSize(-i,false);uA=tc.HILIGHT_OFF}_i.SetTerPointSize(-i,true);UD(tc.TER_ACTION,tc.ACTION_COMMAND,tc.ID_FONTS,false)}else if(e==tc.TLB_STYLE){var f=t.getSelectedItem();var l=f.value;if(l>=0&&W_[l].InUse){if(!DX(-tc.ACTION_STYLE,l,0)){if(W_[l].type==tc.SSTYPE_CHAR)_i.TerSelectCharStyle(l,true);else return _i.TerSelectParaStyle(l,true);NX(-tc.ACTION_STYLE,l,0)}}}else if(e==tc.TLB_ZOOM){var a=r.length;var n=Uk(r);if(a>0&&n[a-1]==gk("%"))r=cV(r,0,a-1);var c=LX(r);_i.TerSetZoom(c);UD(tc.TER_ACTION,tc.ACTION_COMMAND,tc.ID_ZOOM,false)}zQ()}_i.TerReverseSelection=function(){if(!lv||!QD())_i.TerCreateControl();var t=sA;sA=_A;_A=t;var e=TA;TA=AA;AA=e;return true};_i.TerNormalizeBlock=function(){if(!lv||!QD())_i.TerCreateControl();return ON()};function ON(){var t,e;var r,i,f,l;var a,n,c,s,_,o;var u;var T,A;if(uA==tc.HILIGHT_OFF)return true;OA=false;if(uA==tc.HILIGHT_CHAR){if(sA<0)sA=0;if(_A<0)_A=0;if(sA>=Ri)sA=Ri-1;if(_A>=Ri)_A=Ri-1;if(sA==_A&&TA==AA){uA=tc.HILIGHT_OFF;return false}if(sA>_A){i=_A;_A=sA;sA=i;t=AA;AA=TA;TA=t;if(GA&&AA+1==ui[_A].len)AA=ui[_A].len}if(sA==_A&&TA>AA){t=AA;AA=TA;TA=t;if(GA&&AA+1==ui[_A].len)AA=ui[_A].len}if(oi.WordWrap&&TA>=ui[sA].len)TA=ui[sA].len-1;if(!oi.WordWrap&&TA>ui[sA].len)TA=ui[sA].len;if(TA<0)TA=0;if(AA>ui[_A].len)AA=ui[_A].len;if(AA<0)AA=0;if(yN())return true;if(!TE&&Dj($h&tc.TFLAG5_NO_ADJ_FOR_TABLE))r6(true)}else{if(sA>_A){i=_A;_A=sA;sA=i}if(TA>AA){t=AA;AA=TA;TA=t}if(yN())return true}if(sA>=Ri)sA=Ri-1;if(_A>=Ri)_A=Ri-1;if(Nj(zh&tc.TFLAG_EXCLUDE_HIDDEN_SEL)&&!pE){f=sA;e=TA;u=f==br&&e==jt?true:false;s=ib(f,e);if(Nj(xs[s].style&tc.HIDDEN)){if(_i.TerLocateStyleChar(tc.HIDDEN,false,f,e,true)){f=zC;e=ZC;if(f<_A||f==_A&&e<=AA-1){sA=f;TA=e;if(u){br=f;jt=e}}}}f=_A;e=AA-1;u=f==br&&e+1==jt?true:false;if(e<0&&f>0){f--;e=ui[f].len-1}if(e<0)e=0;s=ib(f,e);if(Nj(xs[s].style&tc.HIDDEN)){if(_i.TerLocateStyleChar(tc.HIDDEN,false,f,e,false)){f=zC;e=ZC;if(f>sA||f==sA&&e>=TA){_A=f;AA=e+1;if(u){br=f;jt=e+1}}}}MT=tc.CURS_FORWARD}if(Xr&&Nj(qh&tc.TFLAG4_FULL_DRAG_PROT_TEXT)){_=ib(sA,TA);o=fb(_A,AA);T=xs[_].FieldId;A=xs[o].FieldId;if(Nj(xs[_].style&tc.PROTECT)&&T==0){f=sA;e=TA;if(_i.TerLocateStyleChar(tc.PROTECT,false,f,e,false)){f=zC;e=ZC;Rm(f,e);f=PC;e=SC}sA=f;TA=e}if(Nj(xs[o].style&tc.PROTECT)&&A==0){f=_A;e=AA;_i.TerLocateStyleChar(tc.PROTECT,false,f,e,true);f=zC;e=ZC;_A=f;AA=e}}if(Xr||Dj(aO&tc.TOFLAG_NO_FIELD_ADJ)&&Dj($h&tc.TFLAG5_NO_NORMALIZE_FIELD)){var E=false,R,L;_=ib(sA,TA);o=fb(_A,AA);T=xs[_].FieldId;A=xs[o].FieldId;if(T==tc.FIELD_NAME||T==tc.FIELD_DATA||T==tc.FIELD_TOC)E=true;if(A==tc.FIELD_NAME||A==tc.FIELD_DATA||A==tc.FIELD_TOC)E=true;if(E&&xs[_].FieldId==xs[o].FieldId&&Dj(iO&tc.TFLAG9_TREAT_DATA_FIELD_AS_ATOM)){var C=xs[_].FieldId;var I=fb(sA,TA);var d=ib(_A,AA);R=xs[I].FieldId!=C&&xs[d].FieldId!=C;if(!R){L=false;for(r=sA;r<=_A;r++){n=r==sA?TA:0;c=r==_A?AA:ui[r].len;for(a=n;a<c;a++){s=ib(r,a);if(xs[s].FieldId!=C){L=true;break}}if(L)break}if(!L)E=false}}if(T==tc.FIELD_TOC||A==tc.FIELD_TOC||Xr)E=true;if(E){var F=_A;var g=AA;var P=sA;var S=TA;if(T!=tc.FIELD_NAME&&T!=tc.FIELD_DATA&&A==tc.FIELD_NAME&&!NE){f=F;e=g-1;Am(f,e);f=PC;e=SC;Pw(f,e,tc.FIELD_NAME);F=rI;g=$C}else{s=ib(P,S);if(xs[s].FieldId==tc.FIELD_NAME||xs[s].FieldId==tc.FIELD_DATA){Pw(P,S,tc.FIELD_NAME);P=rI;S=$C}else if(xs[s].FieldId==tc.FIELD_TOC){hw(P,S,true);P=PC;S=SC}f=F;e=g-1;Am(f,e);f=PC;e=SC;s=ib(f,e);if(xs[s].FieldId==tc.FIELD_NAME||xs[s].FieldId==tc.FIELD_DATA){var h=Pw(f,e,tc.FIELD_DATA);F=iI;g=eI;if(!h){Pw(f,e,tc.FIELD_NAME);F=iI;g=eI}}else if(xs[s].FieldId==tc.FIELD_TOC){hw(f,e,false);F=PC;g=SC}}_A=F;AA=g;sA=P;TA=S}}vN();return true}function vN(){var t,e;if($H(sA,TA)){var r=sA;var i=TA;while(true){if(i==0&&r==0)break;t=r;e=i;Em(r,i);r=PC;i=SC;if(t==r&&e==i)break;if(tm(r,i)){Rm(r,i);r=PC;i=SC;break}}sA=r;TA=i}if(AA>=ui[_A].len)return true;if($H(_A,AA)){var f=_A;var l=AA;Em(f,l);f=PC;l=SC;if(tm(f,l))return true;f=_A;l=AA;while(true){if(tm(f,l)){Rm(f,l);f=PC;l=SC;break}t=f;e=l;Rm(f,l);f=PC;l=SC;if(t==f&&e==l)break}_A=f;AA=l;MT=tc.CURS_FORWARD}return true}function pN(){var t,e;var r;var i,f;if(uA!=tc.HILIGHT_CHAR)return false;if(Nj(nO&tc.TOFLAG2_NO_NORMALIZE_FNOTE))return true;if(Nj($h&tc.TFLAG5_NO_NORMALIZE_FNOTE))return true;if(TE)return true;r=sA;e=TA;t=ib(r,e);if(Nj(xs[t].style&(tc.FNOTETEXT|tc.FNOTEREST))){if(!_i.TerLocateStyleChar(tc.FNOTE,true,r,e,false))return false;r=zC;e=ZC;t=ib(r,e)}f=r==0&&e==0;if(Nj(xs[t].style&tc.FNOTE)&&!f){if(!_i.TerLocateStyleChar(tc.FNOTE,false,r,e,false))return false;r=zC;e=ZC;e++;if(e+1>ui[r].len){r++;e=0}}sA=r;TA=e;r=_A;e=AA-1;if(e<0){r--;if(r<0)r=0;e=ui[r].len-1;if(e<0)e=0}i=false;t=ib(r,e);if(Nj(xs[t].style&tc.FNOTE)){if(!_i.TerLocateStyleChar(tc.FNOTE,false,r,e,true))return false;r=zC;e=ZC;t=ib(r,e);i=true}if(Nj(xs[t].style&tc.FNOTETEXT)){if(!_i.TerLocateStyleChar(tc.FNOTETEXT,false,r,e,true))return false;r=zC;e=ZC;t=ib(r,e);i=true}if(Nj(xs[t].style&tc.FNOTEREST)){if(!_i.TerLocateStyleChar(tc.FNOTEREST,false,r,e,true))return false;r=zC;e=ZC;i=true}if(i){_A=r;AA=e;aO|=tc.TOFLAG_UPDATE_ENOTE}return true}function NN(){var t,e,r;var i;var f;if(uA!=tc.HILIGHT_CHAR)return false;if(TE)return true;i=_A;t=AA;Em(i,t);i=PC;t=SC;if(i+1<Ri){e=ui[i+1].pfmt;if(Dj(Nc[e].flags&tc.PAGE_HDR_FTR))return true}t:{f=ui[i].txt;if(f[t]==tc.SECT_CHAR)break t;e=ui[sA].pfmt;r=ui[_A].pfmt;if(Dj(Nc[e].flags&tc.PAGE_HDR_FTR)&&Nj(Nc[r].flags&tc.PAGE_HDR_FTR))break t;return true}i++;for(;i<Ri;i++){var l=ui[i].pfmt;if(Dj(Nc[l].flags&tc.PAGE_HDR_FTR))break}if(i>0){_A=i-1;AA=ui[i-1].len}return true}function DN(t){var e=br;var r=jt;var i;if(t){Em(e,r);e=PC;r=SC}i=ui[e].txt;if(i[r]!=tc.SECT_CHAR)return false;uA=tc.HILIGHT_CHAR;sA=_A=e;TA=r;AA=r+1;OA=false;NN();_i.TerDeleteBlock(true);B5();_i.TerRepaginate(true);return true}_i.TerDeleteBlock=function(t){if(!lv||!QD())_i.TerCreateControl();if(wN(true,true))return false;if(uA==tc.HILIGHT_LINE)return MN(t);else if(uA==tc.HILIGHT_CHAR)return GN(true,t);else return false};function MN(t){if(Ri<=1){uA=tc.HILIGHT_OFF;OA=false;return true}if(!ON())return true;V8(sA,0,_A,ui[_A].len,tc.CHAR_D);iw(sA,_A-sA+1,tc.CHAR_D);if(Ri==0){Ri=1;Ip(0)}if(Ri==1)WR=yR=false;if(!t)return true;br=sA;if(br>=Ri)br--;if(br-fr>=Dt||br-fr<0){fr=br-Dt/2;if(fr<0)fr=0}we=br-fr;uA=tc.HILIGHT_OFF;OA=false;Br=tc.PAINT_WIN;cG();return true}function GN(t,e){var r,i,f,l;var a=false,n=false;var c=0,s=0,_=uE;var o=false;var u;var T;if(uA==tc.HILIGHT_OFF)return true;t:{e:{if(Nj(aO&tc.TOFLAG_IN_MERGE_PRINT))break e;if(oi.WordWrap&&Ri==1&&ui[0].len==1&&ui[0].pfmt==0){if(ib(0,0)==0)return true}if(Dj(zh&tc.TFLAG_UNPROTECTED_DEL)){var A=ib(sA,TA);var E=fb(_A,AA);if(xs[A].FieldId==tc.FIELD_TOC&&xs[E].FieldId==tc.FIELD_TOC){if(tc.MSGRESULT_CANCEL==qk(tg.MsgString[tc.MSG_DEL_TOC]," ",tc.MSGTYPE_OK_CANCEL))return false}}if(Dj(nO&tc.TOFLAG2_NO_NORMALIZE)){if(!ON())return true;if(!pN())return true;if(!NN())return true}if(Dj(iO&tc.TFLAG9_DONT_PROTECT_PARA_BEF_TABLE)&&!TE&&AA>0&&AA==ui[_A].len&&_A+1<Ri){u=ui[_A].txt;if(u[AA-1]==Bn){if(ui[_A].cid==0&&ui[_A+1].cid>0||ui[_A+1].cid>ui[_A].cid){AA--;if(_A==sA&&AA==TA)return true}}}f=C6(sA,_A);if(Nj(Qh&tc.TFLAG3_NO_FULL_CELL_COPY)&&ui[sA].cid>0&&E6(f,sA)==E6(f,_A)&&GY(_A,tc.INFO_CELL)&&AA>=ui[_A].len&&AA>0)AA--;a=WN();n=_F;if(!a&&!TE&&n&&(_A==0||Nj(nO&tc.TOFLAG2_DONT_DELETE_LAST_CHAR))&&_A==Ri-1&&AA>0&&oi.WordWrap)AA--;else if(a&&Z_&&_A==Ri-1&&AA>0&&n)AA--;o=BN(sA,TA,_A,AA);if(T6()){var R=k8(sA,_A);if(Nj(tO&tc.TFLAG6_DEL_CELL_TEXT)&&(Zt!=tc.ID_CUT||!R))_i.TerDeleteCellText(tc.SEL_CELLS,false);else _i.TerDeleteCells(tc.SEL_CELLS,false);break t}if(sA==_A&&AA<=TA)return true;if(Z_&&U4(sA,TA,_A,AA,true,e))return true;if(mh){s=ib(sA,TA);c=xs[s].FieldId}V8(sA,TA,_A,AA-1,tc.CHAR_D)}if(sA==_A){if(ui[sA].len==0)break t;if(TA>=ui[_A].len)break t;if(AA>ui[_A].len)AA=ui[_A].len;i=AA-TA;if(AA==ui[_A].len&&AA>TA){if(Nj(ui[_A].flags&(tc.LFLAG_PARA|tc.LFLAG_BREAK))){for(l=_A+1;l<Ri;l++){ui[l].pfmt=ui[_A].pfmt;if(Nj(ui[l].flags&(tc.LFLAG_PARA|tc.LFLAG_BREAK)))break}}ui[_A].flags=cj(ui[_A].flags,tc.LFLAG_PARA|tc.LFLAG_BREAK)}fw(sA,TA,i,tc.CHAR_D);if(ui[sA].len==0&&(oi.WordWrap||Dj(aO&tc.TOFLAG_INSERT_CHAR))){var L=oi.WordWrap||!TE;if(L){iw(sA,1,tc.CHAR_D);if(br>sA)br--}}if(Ri==1&&ui[0].len==0){_b(0);ui[0].fmt=null;ui[0].UniFmt=tc.DEFAULT_CFMT}break t}i=ui[_A].len-AA;if(i<0)i=0;r=TA+i;Tm(sA,ui[sA].len,r);if(r>0&&i>0){lw(_A,AA,sA,TA,i);ui[sA].pfmt=ui[_A].pfmt;ui[sA].cid=ui[_A].cid;ui[sA].fid=ui[_A].fid;ui[sA].flags=ui[_A].flags;yX(sA);ui[sA].tabw=ui[_A].tabw;ui[_A].tabw=null}else if(r==0){ui[sA].fmt=null;ui[sA].UniFmt=tc.DEFAULT_CFMT}iw(sA+1,_A-sA,tc.CHAR_D);if(!oi.WordWrap&&!TE&&TA==0&&ui[sA].len==0){iw(sA,1,tc.CHAR_D);if(br>sA)br--}if(Ri==0){Ri=1;Ip(0)}}if(sA>=Ri){sA=Ri-1;TA=ui[sA].len-1;if(TA<0)TA=0}if(_A>=Ri){_A=Ri-1;AA=ui[_A].len}if(br>=Ri){if(!oi.WordWrap&&(Zt==tc.ID_PASTE||Zt==tc.ID_PASTE_TEXT)){br=Ri;jt=0;Ri++;MY(Ri);Ip(br);t=false}else br=Ri-1}if(jt>=ui[br].len)jt=ui[br].len-1;if(jt<0)jt=0;if(a){var C=ui[0].pfmt;WR=yR=false;Oc=-1;br=0;jt=0;Ip(0);ui[0].pfmt=n?sZ():C;if(oi.WordWrap){Tm(br,0,1);u=ui[br].txt;T=nb(br);u[0]=Bn;T[0]=tc.DEFAULT_CFMT;sb(br)}if(Zt==tc.ID_DEL)FN(true)}if(mh&&c==tc.FIELD_TEXTBOX)bw(s,_,sA,TA);if(t){br=sA;if(br>=Ri){br--;jt=ui[br].len-1;if(jt<0)jt=0}else jt=TA;if(br-fr>=Dt||br-fr<0){fr=br-Dt/2;if(fr<0)fr=0}we=br-fr;jt=TA}if(br>=Ri){br=Ri-1;jt=ui[br].len-1;if(jt<0)jt=0;fr=br-Dt/2;if(fr<0)fr=0;we=br-fr}uA=tc.HILIGHT_OFF;OA=false;if(!e){if(o)_i.TerRepaint(false);return true}Br=tc.PAINT_WIN;cG();return true}function BN(t,e,r,i){var f=ui[t].cid,l=ui[t].fid;var a;for(a=t;a<=r;a++){if(ui[a].cid!=f||ui[a].fid!=l)return true}if(i>=ui[r].len){if(GY(r,tc.INFO_CELL|tc.INFO_ROW))return true;if(ui[r].fid>0)return true}return false}function HN(t,e,r,i){var f;if(um(t)){xs[t].height=xs[t].BaseHeight=0;for(f=0;f<256;f++)xs[t].CharWidth[f]=0;return true}if(i&&xs[t].FrameType!=tc.PFRAME_NONE&&oi.PageMode){var l=xs[t].ParaFID;if(Dj(kl[l].flags&tc.PARA_FRAME_WATERMARK)&&Dj(kl[l].flags2&tc.PF2_INLINE)){e=xs[0].height*3/4;r=dS?Gx(0,true,tc.CHAR_W):10}}if(e==0)e=1;if(r==0&&!i&&xs[t].TextAngle==0)r=1;if(xs[t].TextAngle>0){e=WY(e,r);r=JC}xs[t].height=xs[t].BaseHeight=e;if(xs[t].FieldId==tc.FIELD_TEXTBOX){var a=xs[t].form;if(Nj(a)&&a.FontId>=0){xs[t].BaseHeight=xs[a.FontId].BaseHeight;xs[t].BaseHeight+=(xs[t].height-xs[a.FontId].height)/2}else xs[t].BaseHeight=xs[t].height*2/3}else if(xs[t].FieldId==tc.FIELD_CHECKBOX){xs[t].BaseHeight=xs[t].height*7/8}else{if(xs[t].offset!=0){var n=Eu?mV(xs[t].offset):hV(xs[t].offset);xs[t].BaseHeight=e+n;if(xs[t].BaseHeight<0)xs[t].BaseHeight=0}else{if(xs[t].PictAlign==tc.ALIGN_MIDDLE)xs[t].BaseHeight=e/2+xs[0].BaseHeight/2;if(xs[t].PictAlign==tc.ALIGN_TOP)xs[t].BaseHeight=xs[0].height;if(xs[t].PictAlign!=tc.ALIGN_BOT&&xs[t].BaseHeight>e){xs[t].BaseHeight=xs[0].BaseHeight;if(xs[t].BaseHeight>e)xs[t].BaseHeight=e}}}xs[t].CharWidth[0]=0;for(f=1;f<256;f++)xs[t].CharWidth[f]=r;return true}function mN(t){var e;if(!oi.PrintView)return true;if(hV(xs[t].PictHeight)==xs[t].height)Xs[t].height=mV(xs[t].PictHeight);else if(hV(xs[t].PictHeight)==xs[t].CharWidth[tc.PICT_CHAR])Xs[t].height=mV(xs[t].PictWidth);else Xs[t].height=Mj(xs[t].height,Ei,wt);if(dV(xs[t].PictWidth)==xs[t].CharWidth[tc.PICT_CHAR])Xs[t].CharWidth[tc.PICT_CHAR]=DV(xs[t].PictWidth);else if(dV(xs[t].PictHeight)==xs[t].height)Xs[t].CharWidth[tc.PICT_CHAR]=DV(xs[t].PictHeight);else Xs[t].CharWidth[tc.PICT_CHAR]=xs[t].CharWidth[tc.PICT_CHAR]*Ai/Nt;for(e=0;e<256;e++)Xs[t].CharWidth[e]=Xs[t].CharWidth[tc.PICT_CHAR];Xs[t].BaseHeight=Mj(xs[t].BaseHeight,Ei,wt);Xs[t].ExtLead=Mj(xs[t].ExtLead,Ei,wt);return true}function wN(t,e){var r=false,i=false;if(uA==tc.HILIGHT_OFF)return false;if(!ON())return false;if(Nj(zh&tc.TFLAG_UNPROTECTED_DEL))return false;r=yN();if(e&&!r&&sA>0&&TA==0&&AA==ui[_A].len&&Nj(Nc[ui[sA-1].pfmt].flags&tc.PAGE_HDR_FTR)&&Dj(Nc[ui[_A].pfmt].flags&tc.PAGE_HDR_FTR)&&(_A>=Ri-1||GY(_A+1,tc.INFO_SECT))){if(e&&(sA<_A||TA<AA-1))AA--;else{if(t)QY(tc.MSG_KEEP_HDRFTR_LINE,tg.MsgString[tc.MSG_PROTECTED]);return true}}if(Li){if(e&&TA>0&&Nc[ui[sA].pfmt].AuxId!=Nc[ui[_A].pfmt].AuxId){if(t)QY(tc.MSG_NODEL_MIX_HTML,tg.MsgString[tc.MSG_PROTECTED]);return true}}if(!r&&Nj(Nc[ui[sA].pfmt].flags&tc.PAGE_HDR_FTR)!=Nj(Nc[ui[_A].pfmt].flags&tc.PAGE_HDR_FTR)){var f=false;if(Nj(Nc[ui[sA].pfmt].flags&tc.PAGE_HDR_FTR))f=true;else{var l=_A,a;if(e){for(a=_A;a<Ri;a++)if(Nj(Nc[ui[a].pfmt].flags&tc.PAGE_HDR_FTR))break;_A=a-1;AA=ui[_A].len;i=true}else{if(AA==0&&l>sA)l--;if(Nj(Nc[ui[l].pfmt].flags&tc.PAGE_HDR_FTR)){if(Nj(ui[l].flags&(tc.LFLAG_HDR|tc.LFLAG_FHDR))&&l>sA&&Dj(Nc[ui[l-1].pfmt].flags&tc.PAGE_HDR_FTR)){_A=l-1;AA=ui[_A].len}else f=true}}}if(f){if(t)QY(tc.MSG_SEL_SPAN_HDRFTR,tg.MsgString[tc.MSG_INVALID_SELECT]);return true}}if(e&&!r&&!i&&AA>=ui[_A].len&&_A+1<Ri&&Nj(ui[_A+1].flags&tc.LFLAG_HDRS_FTRS)){if(e&&(sA<_A||TA<AA-1))AA--;else{if(t)QY(tc.MSG_PROTECTED,tg.MsgString[tc.MSG_INVALID_SELECT]);return true}}if(e&&Nj(aO&tc.TOFLAG_INSERT_CHAR)&&ui[_A].fid>0&&AA>=ui[_A].len)return true;if(e&&(ui[sA].fid>0||ui[_A].fid>0)&&ui[sA].fid!=ui[_A].fid){if(t)QY(tc.MSG_INVALID_SELECT,"");return true}return e&&bN(t,true)}function bN(t,e){var r=sA,i=_A;var f=TA,l=AA;if(TE)return false;if(uA!=tc.HILIGHT_CHAR){f=0;l=ui[i].len}return xN(r,f,i,l,t,e)}function xN(t,e,r,i,f,l){var a;var n,c,s,_;var o;var u;for(a=t;a<=r;a++){if(Nj(Nc[ui[a].pfmt].pflags&tc.PFLAG_ENDNOTE))continue;if(ui[a].fmt==null&&a!=r){c=ui[a].UniFmt;if(xs[c].FieldId==0){if(Nj(xs[c].style&tc.PROTECT)){if(Nj(xs[c].style&tc.FNOTEALL)&&i<ui[r].len){u=ib(r,i);if(Dj(xs[u].style&tc.FNOTEALL))continue}if(f)QY(tc.MSG_SEL_PROTECTED,tg.MsgString[tc.MSG_PROTECTED]);return true}continue}}s=0;_=ui[a].len;if(a==t&&e<ui[a].len)s=e;if(a==r&&i<=ui[a].len)_=i;o=nb(a);for(n=s;n<_;n++){c=o[n];if(l&&xs[c].FieldId==tc.FIELD_NAME){var T=ui[a].txt[n];if(T==tc.LEFT_BRACE||T==tc.RIGHT_BRACE)continue}if(Nj(xs[c].style&tc.PROTECT)||Nj($h&tc.TFLAG5_PROTECT_DATA_FIELD)&&(xs[c].FieldId==tc.FIELD_NAME||xs[c].FieldId==tc.FIELD_DATA)){sb(a);if(Nj(xs[c].style&tc.FNOTEALL)&&i<ui[r].len){u=ib(r,i);if(Dj(xs[u].style&tc.FNOTEALL))continue}if(f)QY(tc.MSG_SEL_PROTECTED,tg.MsgString[tc.MSG_PROTECTED]);return true}}sb(a)}return false}function yN(){var t;return WN()}function WN(){_F=AA>=ui[_A].len;if(sA==0&&_A==Ri-1){if(uA==tc.HILIGHT_LINE||TA==0&&AA>=ui[_A].len-1)return true}if(uA==tc.HILIGHT_CHAR&&sA==0&&TA==0&&Ri>0&&ui[Ri-1].len==1&&_A==Ri-2&&AA>=ui[_A].len){if(ui[sA].cid==0||ui[_A].cid==0)return true}return false}function UN(){var t,e=0;for(t=0;t<Ri;t++)e+=$q(t,true);return e}function kN(){var t=UN();if(t>=Xe&&t>Mt&&_E>0&&sE[_E-1].type!=tc.CHAR_D){oV();mm(false);if(_l)QQ(tc.ID_UNDO);else $j(tc.ID_UNDO)}return true}_i.TerFileToMem=function(t){var e=gU(t,true);return Uk(e)};_i.TerFileToMemBytes=function(t){return $t.TerFileToMem(t)};_i.TerMemToFileBytes=function(t,e){var r=Wk(e);SU(t,r);return true};function XN(){var t,e;var r,i;var f,l,a,n;f=l=a=n=0;rI=f;$C=l;iI=a;eI=n;if(uA==tc.HILIGHT_LINE){ON();t=sA;r=0;e=_A;i=ui[e].len;if(i<0)i=0}else if(uA==tc.HILIGHT_CHAR){ON();t=sA;r=TA;if(r>=ui[t].len)r=ui[t].len-1;if(r<0)r=0;e=_A;i=AA;if(i>ui[e].len)i=ui[e].len;if(i<0)i=0;if(t==e&&r>i)r=i}else{t=0;r=0;e=Ri-1;if(e<0)e=0;i=ui[e].len;if(i<0)i=0}rI=t;iI=e;$C=r;eI=i;return true}function KN(t){var e=false,r=false,i=false,f;var l=!oi.ReadOnly;if(l||ww(false,false))i=true;if(uA!=tc.HILIGHT_OFF&&(l||ww(false,false)))e=true;if(uA!=tc.HILIGHT_OFF)r=true;if(t.type=="cut"&&e)return JN(true,t,true);else if(t.type=="copy"&&r)return JN(false,t,true);else if(t.type=="paste"&&i){if(YN(null,t)){Dp();return true}else return false}else return false}function YN(t,e){var r="";var i=false,f=false;var l="";var a=uE;var n,c;var s=false;var _=false;var o;JH(tc.CHAR_a);qD();if(!Lm(br,jt)){oV();return false}if(t==null&&!vS&&VN(e))return true;if(e!=null&&e.clipboardData!=null){r=e.clipboardData.getData("text/rtf");if(r!=null&&r.indexOf("{\\rtf")>=0){i=true;tg.ClipDataRtf=r;tg.ClipDataText=e.clipboardData.getData("text");tg.ClipInfo=new tc.ClsClipInfo;Dp()}else{r=e.clipboardData.getData("text");if(r!=tg.ClipDataText){tg.ClipDataText=r;tg.ClipDataRtf="{\\rtf1 "+r+"}";tg.ClipInfo=new tc.ClsClipInfo;Dp()}}if(vS&&(r==null||r=="")&&VN(e))return true}else if(window.clipboardData){try{r=window.clipboardData.getData("text");_=true}catch(t){r=null}if(r!=null&&r.indexOf("{\\rtf")>=0)i=true;else r=window.clipboardData.getData("text")}if(t!=null&&t.length>0){if(Tk(t,"external plain text")==0&&r.length>0){t="text"}else if(Tk(t,"internal plain text")==0&&tg.ClipDataText!=null&&tg.ClipDataText!=""){r=tg.ClipDataText;t="text"}else if(tg.ClipDataRtf!=null&&tg.ClipDataRtf.length>0){r=tg.ClipDataRtf;t="OurRtf";i=true}else t=""}if(t==""||t==null){t="text";for(n=0;n<Ys;n++){if(xs[n].InUse&&Nj(xs[n].style&tc.PICT))xs[n].flags|=tc.FFLAG_PREEXIST}if((r==tg.ClipDataText||r=="")&&tg.ClipDataRtf!=null&&tg.ClipDataRtf!=""){r=tg.ClipDataRtf;t="OurRtf";i=true}}if(r==""||r==null){QY(tc.MSG_CLIPBOARD_NO_FMT,"");return false}if(uA==tc.HILIGHT_CHAR){if(!Vr){nO|=tc.TOFLAG2_DONT_DELETE_LAST_CHAR;_i.TerDeleteBlock(true);uE--;Oc=-1;nO=_j(nO,tc.TOFLAG2_DONT_DELETE_LAST_CHAR)}}var u=$w();Te=-1;gi=false;if(Nj(ui[br].cid))Te=eR[ui[br].cid].level;if(t=="OurRtf"){Te=tg.ClipInfo.TblLevel;gi=tg.ClipInfo.EmbTable;Ae=tg.ClipInfo.RowsCopied;Ee=tg.ClipInfo.RowsInCol;s=true}else s=false;if(!s)Te=-1;if(jt>=ui[br].len)jt=ui[br].len;if(jt<0)jt=0;if(i&&Dj(Qh&tc.TFLAG3_PASTE_RTF_CODE)){nO|=tc.TOFLAG2_FROM_CB;uA=tc.HILIGHT_OFF;_i.InsertRtfBuf(r,br,jt,false);uj(tc.TOFLAG2_FROM_CB);if(Dj(rO&tc.TFLAG8_INSERT_ROWS_ON_PASTE)&&s&&(tg.ClipInfo.CellsCopied>1||tg.ClipInfo.RowsCopied>0)&&uA==tc.HILIGHT_OFF&&ui[br].cid>0&&Dj(nO&tc.TOFLAG2_TABLE_EMBEDDED)){var T=0;sA=c=br;TA=0;if(tg.ClipInfo.CellsCopied>1){for(c=br;c<Ri&&!GY(c,tc.INFO_ROW)&&T<tg.ClipInfo.CellsCopied;c++)if(GY(c,tc.INFO_CELL))T++}else if(tg.ClipInfo.RowsCopied>0){for(c=br;c<Ri&&T<tg.ClipInfo.RowsCopied&&ui[c].cid>0;c++)if(GY(c,tc.INFO_ROW))T++}if(c>sA){if(c<Ri&&GY(c,tc.INFO_ROW))_A=c;else _A=c-1;AA=0;uA=tc.HILIGHT_CHAR;uE=a;_i.TerDeleteCells(tc.SEL_CELLS,false);uA=tc.HILIGHT_OFF}}}else{nO|=tc.TOFLAG2_NO_SET_LANG;Oc=$w();var A=ib(br,jt);if(xs[A].FieldId>0){if(xs[A].FieldId==tc.FIELD_TEXTBOX&&mh)Oc=A;else{o=fb(br,jt);if(xs[o].FieldId==xs[A].FieldId)Oc=A}}if(xs[Oc].FieldId==tc.FIELD_TEXTBOX){var E=true;if(xs[A].FieldId==tc.FIELD_TEXTBOX&&xs[A].AuxId==xs[Oc].AuxId)E=false;if(E){o=fb(br,jt);if(xs[o].FieldId==tc.FIELD_TEXTBOX&&xs[o].AuxId==xs[Oc].AuxId)E=false}if(E)Oc=rb(Oc,false)}qN(Uk(r),null,null,false);nO=_j(nO,tc.TOFLAG2_NO_SET_LANG);_z(true)}Te=1;gi=true;if(br>=Ri)br--;if(br-fr>=Dt||br-fr<0){fr=Math.floor(br-Dt/2);if(fr<0)fr=0}we=br-fr;uA=tc.HILIGHT_OFF;OA=false;_i.TerSetEffectiveFont(u);Br=tc.PAINT_WIN;cG();return true}function VN(t){if(!t.clipboardData)return false;t.clipboardData=t.clipboardData||t.originalEvent.clipboardData;var e=t.clipboardData.types;for(var r=0;r<e.length;r++){var i=e[r];if(i!="Files")continue;var f=(t.clipboardData||t.originalEvent.clipboardData).items;for(var l=0;l<f.length;l++){var a=t.clipboardData.items[l];if(a.kind!="file")continue;var n=null;try{n=a.getAsFile()}catch(t){n=null}if(n==null)continue;if(n.type.match("image*")){var c=new FileReader;c.readAsDataURL(n);c.onloadend=function(t){var e=c.result.replace(/^data:image\/(png|jpg);base64,/,"");var r=atob(e);cD(r,true,i);function i(t,e,r){var i=_i.TerInsertImage(null,t,r,true,0,true)}};c.onerror=function(t){qk(tg.MsgString[tc.MSG_CLIPBOARD_NO_DATA],null,tc.MSGTYPE_ALERT)};c.onabort=function(t){qk(tg.MsgString[tc.MSG_CLIPBOARD_NO_DATA],null,tc.MSGTYPE_ALERT)};return true}}}return false}function jN(){if(_h>=0){_h=oh=-1;Th=false;eq(ha,true);FN(true)}else{_h=ib(br,jt);if(Nj(xs[_h].style&tc.PICT))_h=0;oh=ui[br].pfmt;eq(ha,false)}return true}_i.TerPaintFormat=function(t,e,r){var i;var f;if(!lv||!QD())_i.TerCreateControl();f=uE;if(t>=0){var l=false;if(uA==tc.HILIGHT_OFF){oK();l=true}f=uE;_i.TerSetFontProps(t,-1,false);if(l)_i.DeselectTerText(false)}if(e>=0){var a=uA==tc.HILIGHT_OFF;if(!a){ON();for(i=sA;i<=_A;i++){var n=ui[i].len;if(i==_A){n=AA;if(n==0)break}if(Nj(ui[i].flags&tc.LFLAG_PARA)&&n==ui[i].len){a=true;break}}}if(a){uE=f;_i.TerSetParaProps(e,-1,false)}}if(r&&(t>=0||e>=0))cG();return true};function JN(t,e,r){var i,f=0,l=0,a;var n;var c;if(wN(true,t))return false;if(uA==tc.HILIGHT_OFF)return false;if(!ON())return false;if(!pN())return false;if(uA==tc.HILIGHT_LINE){TA=0;AA=ui[_A].len;if(AA<0)AA=0}if(!oi.WordWrap){if(_A+1<Ri&&AA==ui[_A].len){_A++;AA=0}}for(i=sA;i<=_A;i++){f=f+ui[i].len+2}f++;n=[];t:{if(sA==_A){zN(sA,TA,AA-1,n,l);l=XC;break t}zN(sA,TA,ui[sA].len-1,n,l);l=XC;a=sA;for(i=sA+1;i<_A;i++){if(!pm(i))continue;if(Nj(ui[i].cid)&&Nj(ui[a].cid)){var s=ui[a].cid;var _=ui[i].cid;if(eR[_].row!=eR[s].row&&!GY(a,tc.INFO_ROW))l=xk(l,n,null)}zN(i,0,ui[i].len-1,n,l);l=XC;a=i}zN(_A,0,AA-1,n,l);l=XC}if(!oi.WordWrap){if(l>=2&&n[l-2]==13&&n[l-1]==10){l-=2;n[l]=0}}n[l]=0;if(r){l3(tc.RTF_CB,"");var o=Wk(YT);var u=Wk(n,0,l);if(e!=null&&e.clipboardData!=null){if(e.clipboardData.setData){try{if(!tg.InFireFox)e.clipboardData.setData("text/rtf",o)}catch(t){}e.clipboardData.setData("text",u)}}if(window.clipboardData){try{window.clipboardData.setData("text/rtf",o)}catch(t){}window.clipboardData.setData("text",u)}tg.ClipDataRtf=o;tg.ClipDataText=u;if(t){Zt=tc.ID_CUT;var T=VT.copy();_i.TerDeleteBlock(true);VT=T.copy();Zt=0}tg.ClipInfo=VT.copy();Dp();Br=tc.PAINT_WIN;cG()}else{vs=fV(n,l)}return true}function zN(t,e,r,i,f){var l;var a;var n,c,s;var _=f,o;var u=false;var T;var A=Nj(iO&tc.TFLAG9_SKIP_STRIKE_TEXT);XC=f;if(GY(t,tc.INFO_ROW))return true;if(ui[t].fmt==null){s=ui[t].UniFmt;if(!um(s)&&(!A||Dj(xs[s].style&(tc.STRIKE|tc.DOUBLE_STRIKE))))u=true}l=ui[t].txt;if(u){c=r-e+1;if(c>0){qY(l,e,i,_,c)}}else{a=nb(t);c=0;s=0;for(n=e;n<=r&&n<ui[t].len;n++){if(a[n]==s||!um(a[n])&&Dj(xs[a[n]].style&tc.PICT)&&(!A||Dj(xs[a[n]].style&(tc.STRIKE|tc.DOUBLE_STRIKE)))){T=l[n];if(T==tc.NBSPACE_CHAR)T=tc.SPACE;i[_+c]=T;c++;s=a[n]}}sb(t)}_=_+c;if(oi.WordWrap){o=_;if(_>0&&i[_-1]==tc.SECT_CHAR)_--;if(_>0){if(i[_-1]==tc.HDR_CHAR||i[_-1]==tc.FHDR_CHAR||i[_-1]==tc.RHDR_CHAR||i[_-1]==tc.LHDR_CHAR||i[_-1]==tc.FTR_CHAR||i[_-1]==tc.FFTR_CHAR||i[_-1]==tc.RFTR_CHAR||i[_-1]==tc.LFTR_CHAR)_--}if(_>0&&(i[_-1]==Bn||i[_-1]==TR||i[_-1]==tc.LINE_CHAR)){_--;if(i[_]==TR&&t+1<Ri&&!GY(t+1,tc.INFO_ROW)){i[_]=tc.TAB;_++}}if(_<o)_=xk(_,i,null)}else _=xk(_,i,null);i[_]=0;f=_;XC=f;return true}function ZN(){if(window.clipboardData){try{var t=window.clipboardData.getData("text");if(t.length>0)return true}catch(t){}}if(tg.ClipDataText!=null&&tg.ClipDataText!="")return true;if(tg.ClipDataRtf!=null&&tg.ClipDataRtf.length>0)return true;return false}function QN(){var t=[],e=[];var r;if(window.clipboardData){try{var i=window.clipboardData.getData("text");if(i.length>0){t.push("External clipboard plain text");e.push("external plain text")}}catch(t){}}if(tg.ClipDataText!=null&&tg.ClipDataText!=""){t.push("Internal clipboard plain text");e.push("internal plain text")}if(tg.ClipDataRtf!=null&&tg.ClipDataRtf.length>0){t.push("Internal clipboard Rich Text");e.push("internal rich text")}var f=_i.DlgCompHeight;var l=_i.DlgFont;var a=new $t.DialogBox(te,"Paste Special",l,true,function(t,e,r){_(t,e,r)});var n=a.cvs;var c=new $t.Label(n,0,0,l,"Select Clipboard data to paste");a.addComp(c,0,0,1,1,"Left","bottom");var s=new $t.ListBox(n,0,0,JV(250),JV(110),l,true,true,function(t,e){o(t,e,te)});s.setItems(t,e,0,false);a.addComp(s,1,0,1,1,"Left","middle");a.show();s.setFocus();function _(t,e,r){if(t=="Cancel"){a.hide();return}else if(t=="OK"){u();a.hide()}}function o(t,e,r){if(t=="dblclick"||t=="enter"){u();a.hide()}}function u(){var t=s.getSelectedItemData();YN(t,null)}return true}_i.TerStrToUnicode=function(t,e){var r,i,f,l,a=0;var n;var c;var s;var _="";if(e==2)return t;i=t.length;var o=Uk(t);OutChr=[];for(f=l=0;f<=i;f++){var u=false;var T;if(f==i){_=Wk(OutChr,0,l);break}c=o[f];if(e==0&&c>=128&&c<=161)u=true;else if(e>2&&c<=255)u=true;if(u){var A=eY(c,e);if(A<0)A=c;OutChr[l]=A;l++}else{OutChr[l]=c;l++}}return _};_i.InsertTerText=function(t,e){var r;var i,f;var l;var a=false;if(!lv||!QD())_i.TerCreateControl();l=nO;a=$S==tc.HEBREW_CHARSET||$S==tc.ARABIC_CHARSET;if(!a&&Oc>=0&&xs[Oc].rtlch)a=true;if(!a&&Oc>=0&&xs[Oc].rtl)a=true;if(a){i=t.length;var n=Uk(t);for(f=0;f<i;f++)if(n[f]>=128)break;if(f==i){if(Oc>=0&&xs[Oc].rtlch)Oc=Jb(Oc,false);nO|=tc.TOFLAG2_NO_SET_LANG}}r=br;t=t+String.fromCharCode(0);qN(Uk(t),null,null,false);nO=l;if(e){Dt=Mt/xs[0].height;cG()}else if(oi.WordWrap)T9(r,br-r+1);return true};function qN(t,e,r,i){var f,l,a,n,c=-1;var s,_;var o=new tc.ClsTextBuf;var u;var T,A;var E;var R,L,C,I;var d,F,g;var P=false;if(typeof t=="string"){var S=t+String.fromCharCode(0);t=Uk(S)}L=Lq(br,jt);if(br<Fo)Fo=br;if(Nj(r)&&r[1]==-1){c=r[0];r=null}u=ui[br].txt;for(f=ui[br].len-1;f>=0;f--)if(u[f]==Bn)break;if(f>=0&&jt>f){_m(br,jt,0);br++;jt=0}o.pBuf=t;o.pFmt=e;o.index=0;o.len=0;o.eol=false;o.eof=false;o.ParaCharFound=false;s=_=br;while(!o.eof){if(oi.WordWrap)o.MaxLineLen=3*ft/4-ui[br].len-1;else o.MaxLineLen=ft-ui[br].len-1;if(o.MaxLineLen<=0)o.MaxLineLen=10;$N(o);if(o.eof&&o.len==0)break;a=ui[br].len;l=ui[br].len+o.len;Tm(br,ui[br].len,l);if(jt<a)lw(br,jt,br,jt+o.len,a-jt);u=ui[br].txt;ab(br);T=uP;A=oP;qY(o.pBuf,o.index,u,jt,o.len);if(o.pFmt==null){if(Oc>=0)E=Oc;else if(jt>0)E=T[jt-1];else E=fb(br,jt);if(Nj(xs[E].style&tc.PICT)&&Oc<0)E=tc.DEFAULT_CFMT;if(Oc==-1&&xs[E].FieldId>0&&E!=T[jt])E=T[jt];if(Dj(nO&tc.TOFLAG2_NO_SET_LANG)&&Dj(rO&tc.TFLAG8_DONT_USE_KB_LANG)){E=zb(E);if(o.IsLatin&&xs[E].CharSet>2)E=yb(E,0,-1)}if(Nj(aO&tc.TOFLAG_INSERT_CHAR)){if(o.pBuf[o.index]<128){var h=xs[E].CharSet;if(h==tc.CHINESEBIG5_CHARSET||h==tc.GB2312_CHARSET||h==tc.HANGUL_CHARSET){E=yb(E,0,tc.ENGLISH)}}}for(f=0;f<o.len;f++){if(false&&Nj(rO&tc.TFLAG8_DONT_USE_KB_LANG)){var O=P;var v=u[jt+f];if(!P&&Yq(v))O=true;else if(P&&!Yq(v)&&v!=tc.SPACE&&!pos.IsPunct(v,E)){if(v>=tc.CHAR_a&&v<=gk("z"))O=false;else if(v>=tc.CHAR_A&&v<=gk("Z"))O=false;else if(v>=tc.CHAR_0&&v<=tc.CHAR_9)O=false}if(P==O&&f>0)T[jt+f]=T[jt+f-1];else if(O&&(!xs[E].rtlch||xs[E].flow!=tc.FLOW_RTL))T[jt+f]=Jb(E,true);else if(!O&&(xs[E].rtlch||xs[E].flow==tc.FLOW_RTL))T[jt+f]=Jb(E,false);else T[jt+f]=E;P=O}else T[jt+f]=E}}else qY(o.pFmt,o.index,T,jt,o.len);if(Z_&&Nj(tO&tc.TFLAG6_TRACK_API)){for(f=0;f<o.len;f++)T[jt+f]=V4(T[jt+f],tc.TRACK_INS)}for(f=0;f<o.len;f++)T[jt+f]=vy(T[jt+f],u[jt+f]);for(f=0;f<o.len;f++)A[jt+f]=0;cb(br);g=ui[br].pfmt;if(Nj(r))ui[br].pfmt=r[br-s];else if(c>=0)ui[br].pfmt=c;if(ui[br].pfmt>=Dc)ui[br].pfmt=0;jt=jt+o.len;if(o.eol||o.MaxLineLen==0||o.ParaCharFound){if(!MY(Ri+1)){QY(tc.MSG_MAX_LINES_EXCEEDED,tg.MsgString[tc.MSG_ERR_BLOCK_SIZE]);break}iw(br,1,tc.CHAR_A);ui[br+1].pfmt=g;ui[br+1].tabw=ui[br].tabw;ui[br].tabw=null;_++;l=ui[br].len-jt;if(l<0)l=0;Tm(br+1,0,l);if(l>0){lw(br,jt,br+1,0,l);l=ui[br].len-l;if(l<0)l=0;Tm(br,ui[br].len,l)}if(!i&&oi.WordWrap&&o.eol){n=ui[br].len;u=ui[br].txt;if(n==0||(u[n-1]!=Bn||u[n-1]!=TR)){Tm(br,n,n+1);u=ui[br].txt;u[n]=Bn;ui[br].flags|=tc.LFLAG_PARA;ab(br);T=uP;A=oP;if(Oc>=0)T[n]=Oc;else if(n>0)T[n]=T[n-1];else T[n]=fb(br,n);if(Oc==-1&&xs[T[n]].FieldId>0){var p=lb(br,n);if(p!=T[n])T[n]=0}if(Nj(xs[T[n]].style&tc.PICT))T[n]=0;A[n]=0;cb(br)}}if(Zt==tc.ID_PASTE)jb(br);if(o.ParaCharFound)ui[br].flags|=tc.LFLAG_PARA;br++;if(br>=Ri)br=Ri-1;jt=0}}if(Nj(nO&tc.TOFLAG2_NO_SET_LANG)||Nj(rO&tc.TFLAG8_DONT_USE_KB_LANG)){var N=0,D=0;var M=false;Cq(L);N=PC;D=SC;M=Nc[ui[N].pfmt].flow==tc.FLOW_RTL||mr==tc.FLOW_RTL;Kb(N,D,br,jt,M)}Cq(L);R=PC;d=SC;I=Lq(br,jt);Cq(I-1);C=PC;F=SC;V8(R,d,C,F,tc.CHAR_I);oi.modified++}function $N(t){var e;var r;var i;var f=false;t.index=t.index+t.len;if(t.eol)t.index++;if(t.eol&&t.CrFound)t.index++;t.len=0;t.eol=t.eof=false;t.ParaCharFound=false;t.CrFound=false;t.IsLatin=false;i=t.pBuf.length;do{if(t.index+t.len>=i){t.eof=true;return true}e=t.pBuf[t.index+t.len];f=e>=128&&e<=161;if(t.IsLatin!=f&&t.len>0)break;else t.IsLatin=f;if(e==tc.SECT_CHAR){if(t.len==0){t.index++;continue}break}if(Nj(t.pFmt)){r=t.pFmt[t.index+t.len];if(r>Ys||Dj(xs[r].InUse))t.pFmt[t.index+t.len]=tc.DEFAULT_CFMT}if(e==0){t.eof=true;return true}if(e==10){if(t.CrFound)t.len--;t.eol=true;return true}if(e==13)t.CrFound=true;else t.CrFound=false;if((e==Bn||e==TR)&&oi.WordWrap){if(t.index+t.len+1<i&&t.pBuf[t.index+t.len+1]!=13)t.ParaCharFound=true;t.len++;return true}if(t.len>=t.MaxLineLen){t.MaxLineLen=0;return true}t.len++}while(true);return true}_i.TerInsertPictureFileXY=function(t,e,r,i,f,l,a){var n;var c,s;var _,o;var u;if(!_i.TerCreateControl())return 0;u=zh;zh|=tc.TFLAG_PICT_IN_FRAME;var T=ha;$Q(T,false);br=Da;jt=Ma;if(oi.PageMode&&Nj(zh&tc.TFLAG_PICT_IN_FRAME)&&ui[br].fid==0){Hl=gV(f-rt.left+Ft);if(Ci)Hl-=MV(dW(Lo));_=l-rt.top+Gt;if(wl)ml=_W(vV(_));else{c=WW(br);s=c;while(s<Ri){if(ui[s].fid==0)break;s++}if(s==Ri)s--;o=Pq(s);ml=_-o;ml=vV(ml)}}var A=_i.TerInsertPictureFile(t,e,r,i,E);function E(t,e){zh=u;if(a)a(t,e)}return A};_i.TerInsertPictureFileXY2=function(t,e,r,i,f,l,a,n){var c,s;var _,o;var u;if(!_i.TerCreateControl())return 0;if(Nj(eO&tc.TFLAG7_OLD_PICT_IN_FRAME))return 0;c=zh;zh|=tc.TFLAG_PICT_IN_FRAME;s=nO;nO|=tc.TOFLAG2_USE_FRAME_POS;u=wl;_=Hl;o=ml;wl=f;Hl=l;ml=a;var T=_i.TerInsertPictureFile(t,e,r,i,A);function A(t,e){nO=s;wl=u;Hl=_;ml=o;zh=c;if(n)n(t,e)}return T};_i.TerInsertPictureFile=function(f,l,a,n,c){if(!_i.TerCreateControl())return 0;if(f!=null&&f.length==0)f=null;if(f!=null&&(f.indexOf("http:")==0||f.indexOf("https:")==0)){PU(f,true,e)}else{if(f==null){vU("Select Picture File",true,"test.jpg","",N_,t)}else t(f,"unknown")}function t(t,e){if(t.length==0){QY(tc.MSG_ERR_PICT_FILE_READ,"e.TerInsertPictureFile");if(c)c(null,0);return 0}var r=t[0];e=r.name;if(e.length==0){QY(tc.MSG_ERR_PICT_FILE_READ,"e.TerInsertPictureFile");if(c)c(null,0);return 0}f=e;if(!pU(r,"binary",i))return}function e(t){if(t==null)r(null,"");else cD(t,true,r)}function i(t){ImageData=t;cD(t,true,r)}function r(t,e,r){var i=_i.TerInsertImage(f,t,r,l,a,n);if(c)c(t,i)}return 0};_i.TerInsertImage=function(t,e,r,i,f,l){if(!i&&(t==null||t.length==0))return 0;var a=t;if((e==null||r==null)&&!i&&T_.length>0){if(A_!=null&&E_!=null&&E_.length>0){a=T_;UsingPlaceHolderPict=true;e=A_;r=E_}}if(i_>=0)SaveFont=xs[i_];ReplacePicture=i_>=0?true:false;var n=ib(br,jt);if(!Lm(br,jt)&&l&&!ReplacePicture){oV();return 0}nO|=tc.TOFLAG2_DONT_DELETE_LAST_CHAR;if(uA==tc.HILIGHT_CHAR&&l&&_i.TerDeleteBlock(true))uE--;nO=_j(nO,tc.TOFLAG2_DONT_DELETE_LAST_CHAR);pict=eD(e,f,i,t);if(pict==0)return 0;xs[pict].PictFile=null;if(true||i||Nj(zh&tc.TFLAG_IGNORE_PICT_LINK)){xs[pict].PictData=r;var c=xs[pict].PictData;if(c[0]==137&&c[1]==tc.CHAR_P&&c[2]==gk("N")&&c[3]==gk("G"))xs[pict].OrigPictType=tc.PICT_PNG;else if(c[0]==255&&c[1]==216)xs[pict].OrigPictType=tc.PICT_JPEG}if(l&&!ReplacePicture){_i.TerInsertObjectId(pict,false)}else if(ReplacePicture){tD(pict,SaveFont);_z(true);nW(br,false)}if(i)xs[pict].LinkFile=null;else xs[pict].LinkFile=a;oi.modified++;Br=tc.PAINT_WIN;if(l||ReplacePicture)cG();return pict};function tD(t,e){if(Dj(e.style&tc.PICT))return true;xs[t].style=e.style;xs[t].FrameType=e.FrameType;xs[t].ParaFID=e.ParaFID;xs[t].FieldId=e.FieldId;xs[t].FieldCode=e.FieldCode;xs[t].AuxId=e.AuxId;xs[t].Aux1Id=e.Aux1Id;xs[t].MapId=e.MapId;xs[t].DispFrame=e.DispFrame;return true}_i.TerPictFromImage=function(t,e,r,i){return eD(t,e,r,i)};function eD(t,e,r,i){var f;if((f=Nx())==-1)return 0;if(t==null)return 0;xs[f].InUse=true;xs[f].image=t;xs[f].PictType=tc.PICT_IMAGE;if(i!=null){var l=i.toLowerCase();if(Ck(l,".png"))xs[f].OrigPictType=tc.PICT_PNG;else if(Ck(l,".jpeg"))xs[f].OrigPictType=tc.PICT_JPEG;else if(Ck(l,".jpg"))xs[f].OrigPictType=tc.PICT_JPEG;else if(Ck(l,".tiff"))xs[f].OrigPictType=tc.PICT_TIF;else if(Ck(l,".tif"))xs[f].OrigPictType=tc.PICT_TIF;else if(Ck(l,".gif"))xs[f].OrigPictType=tc.PICT_GIF;else if(Ck(l,".bmp"))xs[f].OrigPictType=tc.PICT_DIBITMAP;else if(Ck(l,".wmf"))xs[f].OrigPictType=tc.PICT_METAFILE;else if(Ck(l,".emf"))xs[f].OrigPictType=tc.PICT_ENHMETAFILE}xs[f].ImageType=0;xs[f].ObjectType=tc.OBJ_NONE;xs[f].PictHeight=Mj(t.naturalHeight,1440,Wt);xs[f].PictWidth=Mj(t.naturalWidth,1440,Wt);xs[f].style=tc.PICT;xs[f].PictAlign=e;HN(f,hV(xs[f].PictHeight),dV(xs[f].PictWidth),true);xs[f].bmHeight=xs[f].PictHeight;xs[f].bmWidth=xs[f].PictWidth;xs[f].OrigPictHeight=xs[f].PictHeight;xs[f].OrigPictWidth=xs[f].PictWidth;mN(f);return f}_i.TerPictLinkName=function(t,e,r){if(!lv||!QD())_i.TerCreateControl();LP=r;if(t<0||t>=Ys||!xs[t].InUse||Dj(xs[t].style&tc.PICT))return false;if(e){if(Nj(xs[t].LinkFile))r=xs[t].LinkFile;else r=""}else{xs[t].LinkFile=null;if(Nj(r)&&r.length>0){xs[t].LinkFile=r}}LP=r;return true};_i.TerSetPictSize=function(t,e,r){var i,f;if(!lv||!QD())_i.TerCreateControl();if(t<0||t>Ys||!xs[t].InUse||Dj(xs[t].style&tc.PICT))return false;i=xs[t].PictWidth;f=xs[t].PictHeight;if(i==0)i=1;if(f==0)f=1;if(e==0&&r!=-1){if(r>=0)e=r*i/f;else e=r}if(e!=-1){xs[t].PictWidth=e>=0?PV(e):-e;xs[t].PctWidth=0}if(r==0&&e!=-1){if(e>=0)r=e*f/i;else r=e}if(r!=-1){xs[t].PictHeight=r>=0?pV(r):-r}if(r!=-1||e!=-1){HN(t,hV(xs[t].PictHeight),dV(xs[t].PictWidth),true);xs[t].flags|=tc.FFLAG_RESIZED;mN(t);if(xs[t].FrameType!=tc.PFRAME_NONE){var l=xs[t].ParaFID;kl[l].width=xs[t].PictWidth;kl[l].MinHeight=kl[l].height=xs[t].PictHeight;if(!GR)_i.TerRepaginate(true)}}return true};_i.TerGetOrigPictSize=function(t){if(!lv||!QD())_i.TerCreateControl();zI=ZI=0;if(t<0||t>Ys||!xs[t].InUse)return true;zI=xs[t].OrigPictWidth;ZI=xs[t].OrigPictHeight;return true};_i.TerSetXparentPict=function(t,c,s,_,o,u,T,A,E){var R;var e;var L;var r,C,I,d,F;var g=oi.modified;L=tO;tO|=tc.TFLAG6_SHOW_PICT_IN_PIXEL_SIZE;r=_i.TerInsertPictureFile(t,true,0,false,i);tO=L;function i(t,e){if(e<=0)return n(false);bm=document.createElement("canvas");bm.width=rt.right-rt.left;bm.height=rt.bottom-rt.top;R=bm.getContext("2d");var r=new tc.Brush(u);var i=new tc.Rectangle(0,0,rt.right-rt.left,rt.bottom-rt.top);oJ(R,r,i);c+=rt.left;s+=rt.top;c=-c;s=-s;d=c+_;F=s+o;var f=xs[e].image;var l=f.naturalWidth;var a=f.naturalHeight;C=c;I=s;if(T==tc.XPT_TILE_BOTH){while(I<F){C=c;while(C<d){R.drawImage(f,C,I,l,a);C+=l}I+=a}}else if(T==tc.XPT_TILE_X_TOP){C=c;while(C<d){R.drawImage(f,C,I,l,a);C+=l}}else if(T==tc.XPT_TILE_X_CENTER){C=c;I=I+(o-a)/2;while(C<d){R.drawImage(f,C,I,l,a);C+=l}}else if(T==tc.XPT_TILE_X_BOT){C=c;I=F-a;while(C<d){R.drawImage(f,C,I,l,a);C+=l}}else if(T==tc.XPT_TILE_Y_LEFT){C=c;while(I<F){R.drawImage(f,C,I,l,a);I+=a}}else if(T==tc.XPT_TILE_Y_CENTER){C=C+(_-l)/2;while(I<F){R.drawImage(f,C,I,l,a);I+=a}}else if(T==tc.XPT_TILE_Y_RIGHT){C=d-l;while(I<F){R.drawImage(f,C,I,l,a);I+=a}}else if(T==tc.XPT_STRETCH){R.drawImage(f,c,s,_,o)}else if(T==tc.XPT_CENTER){C=C+(_-l)/2;I=I+(o-a)/2;R.drawImage(f,C,I,l,a)}else if(T==tc.XPT_TOP_RIGHT){C=d-l;R.drawImage(f,C,I,l,a)}else if(T==tc.XPT_BOT_RIGHT){C=d-l;I=F-a;R.drawImage(f,C,I,l,a)}else if(T==tc.XPT_BOT_LEFT){I=F-a;R.drawImage(f,C,I,l,a)}else if(T==tc.XPT_TOP_CENTER){C=C+(_-l)/2;R.drawImage(f,C,I,l,a)}else if(T==tc.XPT_BOT_CENTER){C=C+(_-l)/2;I=I+(o-a);R.drawImage(f,C,I,l,a)}else if(T==tc.XPT_CENTER_LEFT){I=I+(o-a)/2;R.drawImage(f,C,I,l,a)}else if(T==tc.XPT_CENTER_RIGHT){C=C+(_-l);I=I+(o-a)/2;R.drawImage(f,C,I,l,a)}else{R.drawImage(f,C,I,l,a)}gb(e);e=0;R.dispose();L=tO;tO|=tc.TFLAG6_SHOW_PICT_IN_PIXEL_SIZE;e=eD(bm,0,true,null);tO=L;if(e<=0)return n(false);_i.TerSetBkPictId(e,0,A);oi.modified=g;function n(t){if(E)E(t);return t}}return true};_i.TerSetWatermarkPict=function(r,i,f){var t,e;if(!lv||!QD())_i.TerCreateControl();if(r<0){r=_i.TerInsertPictureFile(null,true,0,false,l)}else return rD(r,i,f);function l(t,e){r=e;if(r>0)rD(r,i,f)}};function rD(t,e,r){if(t<0||t>=Ys||!xs[t].InUse)return false;if(Dj(xs[t].style&tc.PICT)&&t!=0)return false;ea=e;if($l>0){for(i=0;i<Dl;i++){if(pl[i].ParaFrameId!=$l)continue;pl[i].ParaFrameId=0;pl[i].flags=cj(pl[i].flags,tc.FRAME_WATERMARK);break}if(i<Dl){pict=kl[$l].pict;if(pict>0)gb(pict);kl[$l].InUse=false}$l=0;if(ta!=null){ta=null}}if(t>0){$l=_i.TerSetPictFrame2(t,tc.PFRAME_FLOAT,0,0,false);if($l<=0)return false;kl[$l].flags|=tc.PARA_FRAME_WATERMARK|tc.PARA_FRAME_WRAP_IGNORE;if(e)F2(t,22938,19661);HN(t,hV(xs[t].PictHeight),dV(xs[t].PictWidth),true);mN(t);XJ(Lo)}oi.modified++;my(true);if(r)yJ(false,true,0,true);return true}_i.TerSetBkPictId=function(r,i,f){if(!lv||!QD())_i.TerCreateControl();if(r<0){r=_i.TerInsertPictureFile(null,true,0,false,t)}else return iD(r,i,f);function t(t,e){r=e;if(r>0)return iD(r,i,f)}};function iD(t,e,r){if(t<0||t>=Ys||Dj(xs[t].InUse))return false;if(Dj(xs[t].style&tc.PICT)&&t!=0)return false;if(Nj(jh))gb(jh);if(p!=null)mk();jh=t;Jh=e;if(Nj(jh)&&Jh==tc.BKPICT_STRETCH)HN(jh,Mt,je,true);if(r)_i.TerRepaint(true);return true}_i.TerGetBkPictId=function(){if(!lv||!QD())_i.TerCreateControl();return jh};_i.TerSetImageFilter=function(t){N_=t;return true};_i.TerSavePict=function(t,e){return _i.TerSavePict2(t,e)};_i.TerSavePict2=function(t,e,r){var i,f;if(!lv||!QD())_i.TerCreateControl();if(r==undefined)r=true;if(t<0||t>=Ys||!xs[t].InUse||Dj(xs[t].style&tc.PICT)||Xw(t)||xs[t].image==null)return false;if(!xs[t].PictData||xs[t].PictData.length==0)return false;if(Lk(e,"http://")||Lk(e,"https://"))return false;if(r){var l="";if(xs[t].PictType==tc.PICT_PNG)l=".png";else if(xs[t].PictType==tc.PICT_JPEG)l=".jpg";else if(xs[t].PictType==tc.PICT_GIF)l=".gif";else if(xs[t].PictType==tc.PICT_TIF)l=".tif";else if(xs[t].PictType==tc.PICT_DIBITMAP)l=".bmp";else if(xs[t].PictType==tc.PICT_METAFILE)l=".wmf";else if(xs[t].PictType==tc.PICT_ENHMETAFILE)l=".emf";if(l!=""){var a=e.lastIndexOf(".");if(a>=0)e=cV(e,0,a);e+=".ext"}}return _i.TerSaveToLocalFile(xs[t].PictData,e,"Image")};_i.TerGetImage=function(t){if(!_i.TerCreateControl())return null;if(t<0)t=_i.TerGetCurFont(-1,-1);if(t>=Ys||Dj(xs[t].style&tc.PICT))return null;return xs[t].image};_i.TerPastePicture=function(t,e,r,i,f){return fD(null,t,e,r,i,f)};function fD(t,e,r,i,f,l){var a;var n,c,s;var _;var o=new tc.ClsFont;var u=false;if(!lv||!QD())_i.TerCreateControl();if(r==null)return-1;nO|=tc.TOFLAG2_DONT_DELETE_LAST_CHAR;if(uA==tc.HILIGHT_CHAR&&l&&_i.TerDeleteBlock(true))uE--;nO=_j(nO,tc.TOFLAG2_DONT_DELETE_LAST_CHAR);a=br;s=jt;if(i>0&&ui[a].fid!=i){var T;for(T=0;T<Ri;T++)if(ui[T].fid==i)break;if(T<Ri&&ui[T].len>0){a=T;s=0}}if(i_>=0)o=xs[i_];_=i_>=0?true:false;c=ib(a,s);if(!Lm(br,jt)&&l&&!_){oV();return 0}if(t==null||t.length==0){var A=document.createElement("canvas");A.width=img.width;A.height=img.height;var E=A.getContext("2d");E.drawImage(r,0,0);var R=A.toDataURL("image/png");var L=R.replace(/^data:image\/(png|jpg);base64,/,"");t=atob(L)}ge=Nt;Pe=wt;n=-1;n=eD(r,f,true,null);if(n<=0){QY(tc.MSG_CLIPBOARD_NO_FMT,"e.TerPastePicture");return 0}xs[n].PictData=t;if(_){tD(n,o);_z(true);cG()}else if(l){br=a;jt=s;_i.TerInsertObjectId(n,true);nW(br,Nj(zh&tc.TFLAG_RESIZE_BITMAP))}return n}function lD(){var n;n=ib(br,jt);if(Dj(xs[n].style&tc.PICT))return false;var t=_i.DlgCompHeight;var e=_i.DlgFont;var c=new $t.DialogBox(te,"Edit Picture Parameters",e,true,function(t,e,r){I(t,e,r)});var r=c.cvs;metric=Nj(zh&tc.TFLAG_METRIC);if(metric)SizeLabel="Picture Size (cm)";else SizeLabel="Picture Size (Inches)";c.addGroupBox(0,0,6,2,SizeLabel,e,0,JV(10),JV(30),0);var i=0,f=0;if(metric){i=ZV(xs[n].PictWidth);f=ZV(xs[n].PictHeight)}else{i=VV(xs[n].PictWidth);f=VV(xs[n].PictHeight)}var l=new $t.Label(r,0,0,e,"Width");c.addComp(l,1,0,1,1,"left","middle",JV(10));var s=new $t.TextBox(r,0,0,JV(60),t,AX(i,2),e,_i.caret,false,true,null);c.addComp(s,1,1,1,1,"left","middle",JV(10));var a=new $t.Label(r,0,0,e,"Height");c.addComp(a,2,0,1,1,"left","middle",JV(10));var _=new $t.TextBox(r,0,0,JV(60),t,AX(f,2),e,_i.caret,false,true,null);c.addComp(_,2,1,1,1,"left","middle",JV(10));c.addGroupBox(0,3,6,2,"Alignment",e,0,JV(10));var o=xs[n].PictAlign;if(xs[n].offset!=0)o=-1;var u=new $t.RadioButton(r,0,0,JV(15),e,"Top",o==tc.ALIGN_TOP,null,null);c.addComp(u,0,3,1,1,"left","bottom");var T=new $t.RadioButton(r,0,0,JV(15),e,"Middle",o==tc.ALIGN_MIDDLE,u,null);c.addComp(T,1,3,1,1,"left","middle");var A=new $t.RadioButton(r,0,0,JV(15),e,"Bottom",o==tc.ALIGN_BOT,T,null);c.addComp(A,2,3,1,1,"left","top");var E=new $t.RadioButton(r,0,0,JV(15),e,"Baseline Offset",o==-1,A,C);c.addComp(E,2,3,1,1,"left","bottom",0,JV(3));var R=new $t.TextBox(r,0,0,JV(60),t,"",e,_i.caret,false,true,null);TX(R,xs[n].offset,true);c.addComp(R,3,3,1,1,"left","middle",JV(30),JV(5));var L=new $t.Label(r,0,0,e,"(Points)");c.addComp(L,3,4,1,1,"left","middle",JV(-50),JV(5));if(xs[n].offset!=0){R.setEnable(false);L.setEnable(false)}c.show();s.setFocus();function C(t,e,r){R.setEnable(E.isSelected());L.setEnable(E.isSelected())}function I(t,e,r){if(t=="Cancel"){c.hide();return}else if(t=="OK"){var i;var f=metric?40:15;if(!EX(this,"F",s,.1,f))return;if(!EX(this,"F",_,.1,f))return;var l=CX(s);xs[n].PictWidth=metric?QV(l):jV(l);l=CX(_);xs[n].PictHeight=metric?QV(l):jV(l);var a=0;if(E.isSelected()){a=tc.ALIGN_BOT;i=uX(this,R,true,0,0);xs[n].offset=i}else{xs[n].offset=0;if(u.isSelected())a=tc.ALIGN_TOP;if(A.isSelected())a=tc.ALIGN_BOT;if(T.isSelected())a=tc.ALIGN_MIDDLE}xs[n].PictAlign=a;n9();xs[n].flags|=tc.FFLAG_RESIZED;HN(n,hV(xs[n].PictHeight),dV(xs[n].PictWidth),true);mN(n);oi.modified++;cG();c.hide()}else return;if(oi.PrintView)cG();return}return true}function aD(t){return true}_i.TerInsertObjectId=function(t,e){var r,i;var f;var l,a;var n;if(!lv||!QD())_i.TerCreateControl();if(t<0||t>=Ys||!xs[t].InUse||Dj(xs[t].style&tc.PICT))return false;n=Nj(eO&tc.TFLAG7_OLD_PICT_IN_FRAME);l=ui[br].fid;if(n&&oi.PageMode&&Nj(zh&tc.TFLAG_PICT_IN_FRAME)&&(l==0||Nj(kl[l].flags&(tc.PARA_FRAME_LINE|tc.PARA_FRAME_RECT)))){_i.TerInsertParaFrame(-1,-1,-1,-1,true)}l=ui[br].fid;if(n&&Nj(l)&&Nj(kl[l].flags&(tc.PARA_FRAME_LINE|tc.PARA_FRAME_RECT))){ew(br,Bn,0,0,0,0);ui[br].fid=0;jt=0}if(jt>=ui[br].len)jt=ui[br].len;if(jt<0)jt=0;fw(br,jt,1,gk("B"));r=ui[br].txt;r[jt]=tc.PICT_CHAR;f=nb(br);f[jt]=t;if(jt+1<ui[br].len){a=f[jt+1];if(xs[a].FieldId==tc.FIELD_DATA)xs[t].FieldId=xs[a].FieldId}sb(br);V8(br,jt,br,jt,tc.CHAR_O);if(Nj(eO&tc.TFLAG7_SHRINK_PICT_TO_PAGE))_i.TerShrinkPictureToPage(br,t);if(Z_)V4(t,tc.TRACK_INS);if(n)nW(br,Nj(zh&tc.TFLAG_RESIZE_BITMAP));else if(oi.PageMode&&Nj(zh&tc.TFLAG_PICT_IN_FRAME)){if(Nj(nO&tc.TOFLAG2_USE_FRAME_POS)){l=_i.TerSetPictFrame2(t,tc.PFRAME_FLOAT,Hl,ml,false);if(!wl){kl[l].flags=cj(kl[l].flags,tc.PARA_FRAME_VPAGE|tc.PARA_FRAME_VMARG|tc.PARA_FRAME_HPAGE);i=G5(br);kl[l].x+=to[i].LeftMargin*1440;kl[l].OrgX=kl[l].x}yJ(false,true,0,true)}else{var c,s;_i.TerScrToTwipsX(Ga);c=cd;i=G5(br);c+=to[i].LeftMargin*1440;_i.TerScrToTwipsY(Ba);s=sd;_i.TerSetPictFrame2(t,tc.PFRAME_FLOAT,Hl,ml,true)}}oi.modified++;if(e)cG();return true};_i.TerShrinkAllPictures=function(t){return _i.TerShrinkAllPictures2(t,-1,-1)};_i.TerShrinkAllPictures2=function(t,e,r){return _i.TerShrinkAllPictures3(t,e,r,false)};_i.TerShrinkAllPictures3=function(t,e,r,i){var f;var l,a,n,c;var s=false;if(!lv||!QD())_i.TerCreateControl();for(f=0;f<2;f++){for(l=0;l<Ys;l++){if(Dj(xs[l].style&tc.PICT))continue;a=n=0;if(!_i.TerLocateFontId(l,a,n))continue;a=PC;n=SC;if(e>=0){if(a<e&&a>r)continue}c=ui[a].pfmt;if(f==0&&Dj(Nc[c].flags&tc.PAGE_HDR_FTR))continue;if(f==1&&Nj(Nc[c].flags&tc.PAGE_HDR_FTR))continue;var _=true;if(i&&Nj(xs[l].flags&tc.FFLAG_PREEXIST))_=false;if(_&&_i.TerShrinkPictureToPage(a,l)){if(Dj(lO&tc.TFLAG11_NO_REPAGE_IN_SHRINK_IMAGES))_i.TerRepaginate(false);s=true}}}if(s){if(Nj(lO&tc.TFLAG11_NO_REPAGE_IN_SHRINK_IMAGES))_i.TerRepaginate(t);else if(t)cG()}return s};_i.TerSetPictShrinkFactor=function(t){R_=t;return true};_i.TerShrinkPictureToPage=function(t,e){var r,i=0,f=0,l,a,n,c=0,s=0;var _=new tc.ClsHdrFtr,o=new tc.ClsHdrFtr;var u;if(!lv||!QD())_i.TerCreateControl();if(!oi.PageMode)return false;if(t<0)t=br;r=G5(t);i=M9(t,r);i=gV(i);i-=Nc[ui[t].pfmt].LeftIndentTwips;if(ui[t].cid>0){var T=ui[t].cid;var A=eR[T].row;if($E[A].MinHeight<0){f=-$E[A].MinHeight;if(eR[T].RowSpan>1&&Math.abs(rR[T].MinHeight)>f)f=Math.abs(rR[T].MinHeight)}}if(f==0){n=ui[t].page;if(Cz(n)<0)c=to[r].TopMargin*1440;else{_=jF;c=HV(_.height)+to[r].HdrMargin*1440}if(Iz(n)<0)s=to[r].TopMargin*1440;else{o=jF;s=HV(o.height)+to[r].FtrMargin*1440}f=eo[r].PgHeight*1440-c-s;var E=ui[t].pfmt;if(Nj(Nc[E].flags&tc.PAGE_HDR_FTR)){var R;var L=ui[t].len;var C=nb(t);for(R=0;R<L;R++)if(C[R]==e)break;if(R<L)f+=xs[e].PictHeight;sb(t)}if(f<360)f=360}if(R_>0&&R_<100){i=Mj(i,R_,100);f=Mj(f,R_,100)}l=xs[e].PictWidth;a=xs[e].PictHeight;if(l<=i&&a<=f)return false;if(l/i>a/f)u=i/l;else u=f/a;xs[e].PictWidth=l*u;xs[e].PictHeight=a*u;HN(e,hV(xs[e].PictHeight),dV(xs[e].PictWidth),true);mN(e);return true};_i.TerGetWordCount=function(t){var e,r,i;var f,l,a,n,c;var s=0;var _;var o;var u=false,T=false,A=true;var E;var R=0;if(!lv||!QD())_i.TerCreateControl();if(Nj(t&tc.WC_SELECTION)&&uA!=tc.HILIGHT_OFF&&!ON())return-1;if(Dj(t&tc.WC_SELECTION)){s=uA;uA=tc.HILIGHT_OFF}XN();e=rI;f=$C;r=iI;l=eI;if(Dj(t&tc.WC_SELECTION))uA=s;for(i=e;i<=r;i++){if(Dj(t&tc.WC_INCLUDE_HDR_FTR)&&Nj(Nc[ui[i].pfmt].flags&tc.PAGE_HDR_FTR))continue;if(i==e)a=f;else a=0;if(i==r)n=l;else n=ui[i].len;_=ui[i].txt;o=nb(i);for(c=a;c<n;c++){if(Dj(t&tc.WC_INCLUDE_HIDDEN)&&um(o[c]))continue;E=_[c];T=E==tc.SPACE||E==tc.TAB||BY(E)||Nj(xs[o[c]].style&tc.PICT);if(T&&!u&&!A)R++;u=T;A=false}sb(i)}if(!T)R++;return R};_i.TerDeleteObject=function(t){if(!lv||!QD())_i.TerCreateControl();if(t<0||t>=Ys||Dj(xs[t].InUse))return false;gb(t);return true};_i.TerGetPictInfo=function(t){var e,r,i,f,l;var a=new tc.RECT;var n;if(!lv||!QD())_i.TerCreateControl();e=0;r=i=0;n=new tc.Rectangle;KC=e;RF=n;Gd=r;HI=i;if(t<0||t>Ys||Dj(xs[t].InUse))return false;e=xs[t].style;r=xs[t].PictAlign;i=xs[t].AuxId;a.left=xs[t].PictX;a.top=xs[t].PictY;a.left+=rt.left;a.top+=rt.top;if(xs[t].FrameType==tc.PFRAME_NONE){f=xs[t].CharWidth[tc.PICT_CHAR];l=xs[t].height}else{f=dV(xs[t].PictWidth);l=dV(xs[t].PictHeight)}a.right=a.left+f;a.bottom=a.top+l;n=YY(a);KC=e;RF=n;Gd=r;HI=i;return true};_i.TerGetPictFrame=function(t){if(!lv||!QD())_i.TerCreateControl();if(t<0||t>Ys||Dj(xs[t].InUse)||Dj(xs[t].style&tc.PICT))return 0;return xs[t].FrameType};_i.TerSetPictFrame=function(t,e,r){return _i.TerSetPictFrame2(t,e,2e3,2e3,r)};_i.TerSetPictFrame2=function(t,e,r,i,f){var l=0,a,n=0,c;var s=0,_;if(!lv||!QD())_i.TerCreateControl();if(t<0||t>Ys||Dj(xs[t].InUse)||Dj(xs[t].style&tc.PICT))return-1;if(e!=tc.PFRAME_NONE&&e!=tc.PFRAME_LEFT&&e!=tc.PFRAME_RIGHT&&e!=tc.PFRAME_FLOAT)return-1;if(e==tc.PFRAME_NONE){if(xs[t].FrameType==tc.PFRAME_NONE)return 0;l=xs[t].ParaFID;if(Nj(l)&&l<Kl&&kl[l].InUse)kl[l].InUse=false;xs[t].ParaFID=0;xs[t].FrameType=tc.PFRAME_NONE}else{if(xs[t].FrameType==tc.PFRAME_NONE){if((l=kW())<0)return-1;kl[l]=new tc.ClsParaFrame;kl[l].InUse=true;kl[l].DistFromTextLeft=tc.FRAME_DIST_FROM_TEXT;kl[l].DistFromTextRight=tc.FRAME_DIST_FROM_TEXT;kl[l].DistFromTextTop=0;kl[l].DistFromTextBot=0;kl[l].margin=0;kl[l].PageNo=Lo;xs[t].ParaFID=l}xs[t].FrameType=e;l=xs[t].ParaFID;kl[l].pict=t;kl[l].ShapeType=tc.SHPTYPE_PICT_FRAME;kl[l].width=xs[t].PictWidth+2*kl[l].margin;kl[l].height=xs[t].PictHeight+2*kl[l].margin;kl[l].MinHeight=kl[l].height;if(e==tc.PFRAME_FLOAT){kl[l].flags|=tc.PARA_FRAME_VPAGE;kl[l].ParaY=kl[l].y=i;kl[l].x=r;kl[l].OrgX=r;a=0;if(_i.TerLocateFontId(t,s,n)){s=PC;n=SC;a=G5(s)}kl[l].x-=jV(to[a].LeftMargin);kl[l].OrgX-=jV(to[a].LeftMargin);c=oW(i);c=hV(c);s=Jq(0,c);for(_=s;_>=0;_--){if(ui[_].fid>0||ui[_].cid>0)continue;if(Nj(ui[_].flags&tc.LFLAG_HDRS_FTRS))continue;if(ui[_].page<Lo)break;if(Nj(ui[_].flags&tc.LFLAG_PARA_FIRST))break}if(_<0||ui[_].page<Lo){if(_<0)_=0;for(;_<Ri;_++){if(ui[_].fid>0||ui[_].cid>0)continue;if(Nj(ui[_].flags&tc.LFLAG_HDRS_FTRS))continue;break}if(_==Ri)_=Ri-1}if(Nj(rO&tc.TFLAG8_IN_HIN))hW(t,br,jt);else hW(t,s,0)}else{kl[l].flags=cj(kl[l].flags,tc.PARA_FRAME_VPAGE|tc.PARA_FRAME_VMARG)}}HN(t,hV(xs[t].PictHeight),dV(xs[t].PictWidth),true);mN(t);if(f)yJ(false,true,0,true);return l};_i.TerCreateHtmlRule=function(t,e,r,i,f){return _i.TerCreateHtmlRule2(t,e,r,i,f,false,false)};_i.TerCreateHtmlRule2=function(t,e,r,i,f,l,a){var n,c=0;if(!lv||!QD())_i.TerCreateControl();if((n=Nx())==-1)return 0;xs[n].InUse=true;xs[n].style=tc.PICT;xs[n].PictType=tc.PICT_SHAPE;xs[n].PictHeight=0;if(e<0){var s=M9(0,0);if(e<-100)e=-100;s=gV(s);xs[n].PictWidth=Mj(s,-e,100)}else xs[n].PictWidth=e;if((c=kW())<0){gb(n);return 0}kl[c]=new tc.ClsParaFrame;kl[c].InUse=true;kl[c].DistFromTextLeft=tc.FRAME_DIST_FROM_TEXT;kl[c].DistFromTextRight=tc.FRAME_DIST_FROM_TEXT;kl[c].margin=0;xs[n].ParaFID=c;xs[n].FrameType=tc.PFRAME_FLOAT;kl[c].pict=n;kl[c].ShapeType=tc.SHPTYPE_LINE;kl[c].width=xs[n].PictWidth+2*kl[c].margin;if(e<0)kl[c].PctWidth=-e;kl[c].height=xs[n].PictHeight+2*kl[c].margin;kl[c].MinHeight=kl[c].height;if(r==0)r=20;kl[c].LineWdth=r;kl[c].LineColor=i;kl[c].flags|=f|tc.PARA_FRAME_LINE;if(Nj(f&tc.PARA_FRAME_IN_CELL))kl[c].flags|=tc.PARA_FRAME_HCOL;kl[c].flags2|=tc.PF2_HTML_RULE;kl[c].ParaY=kl[c].y=kl[c].OrgY=gV(xs[0].height)/2;kl[c].x=kl[c].OrgX=t;HN(n,hV(xs[n].PictHeight),dV(xs[n].PictWidth),true);mN(n);if(l){var _;var o;for(_=br;_>=0;_--)if(Nj(ui[_].flags&tc.LFLAG_PARA_FIRST))break;if(_<0)_=0;br=_;jt=0;o=wY(tc.PARA_CHAR);_i.TerInsertLine(o,-1,-1,-1,-1,false);if(br>0)br--;jt=0;V8(br,0,br,ui[br].len-1,tc.CHAR_I);uE--;_i.TerInsertObjectId(n,a)}return n};_i.TerSetPictInfo=function(t,e,r,i){if(!lv||!QD())_i.TerCreateControl();if(t<0||t>Ys||Dj(xs[t].InUse))return true;xs[t].style=e;xs[t].AuxId=i;if(r!=xs[t].PictAlign){xs[t].PictAlign=r;HN(t,xs[t].height,xs[t].CharWidth[tc.PICT_CHAR],true)}return true};_i.TerGetPictOffset=function(t){if(!lv||!QD())_i.TerCreateControl();if(t<0)t=ib(br,jt);if(t<0||t>Ys||Dj(xs[t].InUse))return-1;return xs[t].offset};_i.TerSetPictOffset=function(t,e,r){if(!lv||!QD())_i.TerCreateControl();if(t<0)t=ib(br,jt);if(t<0||t>Ys||Dj(xs[t].InUse))return false;if(Dj(xs[t].style&tc.PICT))return false;xs[t].offset=e;xs[t].PictAlign=tc.ALIGN_BOT;HN(t,hV(xs[t].PictHeight),dV(xs[t].PictWidth),true);mN(t);oi.modified++;if(r)cG();return true};_i.TerSetPictCropping=function(t,e,r,i,f,l){var a,n,c,s;if(!lv||!QD())_i.TerCreateControl();if(t<0||t>Ys||Dj(xs[t].InUse))return true;a=e+i-xs[t].CropLeft-xs[t].CropRight;n=r+f-xs[t].CropTop-xs[t].CropBot;xs[t].CropLeft=e;xs[t].CropRight=i;xs[t].CropTop=r;xs[t].CropBot=f;c=xs[t].PictWidth=xs[t].PictWidth-a;s=xs[t].PictHeight=xs[t].PictHeight-n;xs[t].PctWidth=0;HN(t,hV(s),dV(c),true);xs[t].flags|=tc.FFLAG_RESIZED;mN(t);oi.modified++;if(l)cG();return true};_i.TerGetPictCropping=function(t,e){if(!lv||!QD())_i.TerCreateControl();if(t<0||t>Ys||Dj(xs[t].InUse))return-1;if(e==tc.CROP_LEFT)return xs[t].CropLeft;if(e==tc.CROP_RIGHT)return xs[t].CropRight;if(e==tc.CROP_TOP)return xs[t].CropTop;if(e==tc.CROP_BOT)return xs[t].CropBot;return-1};_i.TerPictAltInfo=function(t,e,r){if(!lv||!QD())_i.TerCreateControl();PP=r;if(t<0||t>=Ys||!xs[t].InUse||Dj(xs[t].style&tc.PICT))return false;if(e){r=xs[t].PictAlt}else{xs[t].PictAlt=r}PP=r;return true};function nD(t,e,r,i){var f=_i.DlgLevel;var l=null;var a=new Image;a.onload=function(t){if(RX(i)){if(i>0&&i<Ys&&xs[i].InUse&&Nj(xs[i].style&tc.PICT)){var e=i;xs[e].bmHeight=Mj(a.naturalHeight,1440,Wt);xs[e].bmWidth=Mj(a.naturalWidth,1440,Wt);xs[e].OrigPictHeight=xs[e].bmHeight;xs[e].OrigPictWidth=xs[e].bmWidth;if(Nj(xs[i].flags&tc.FFLAG_SET_PICT_SIZE)){xs[e].PictHeight=Mj(a.naturalHeight,1440,Wt);xs[e].PictWidth=Mj(a.naturalWidth,1440,Wt);xs[i].flags=cj(xs[i].flags,tc.FFLAG_SET_PICT_SIZE);mN(e);r_=true}else if(!GR)cG()}}n(a)};a.onerror=function(t){n(null)};a.onabort=function(t){n(null)};function n(t){if(e){_i.DlgLevel--;Rk(te,l)}if(r)r(t,i)}if(e){_i.DlgLevel++;l=Ek(te,true)}a.src=t;return a}function cD(e,r,i,f){var t=_i.DlgLevel;var l=null;if(e.charCodeAt(0)==1&&e.charCodeAt(1)==0&&e.charCodeAt(2)==9&&e.charCodeAt(3)==0){e=sD(f,e)}var a="";try{a=btoa(e)}catch(t){return false}var n=new Image;n.onload=function(t){if(RX(f)){if(f>0&&f<Ys&&xs[f].InUse&&Nj(xs[f].style&tc.PICT)){var e=f;xs[e].bmHeight=Mj(n.naturalHeight,1440,Wt);xs[e].bmWidth=Mj(n.naturalWidth,1440,Wt);xs[e].OrigPictHeight=xs[e].bmHeight;xs[e].OrigPictWidth=xs[e].bmWidth;if(Nj(xs[f].flags&tc.FFLAG_SET_PICT_SIZE)){xs[e].PictHeight=Mj(n.naturalHeight,1440,Wt);xs[e].PictWidth=Mj(n.naturalWidth,1440,Wt);xs[f].flags=cj(xs[f].flags,tc.FFLAG_SET_PICT_SIZE);mN(e);r_=true}else if(!GR)cG()}}c(n)};n.onerror=function(t){c(null)};n.onabort=function(t){c(null)};function c(t){if(r){_i.DlgLevel--;Rk(te,l)}if(i)i(t,f,e)}if(r){_i.DlgLevel++;l=Ek(te,true)}n.src="data:image/png;base64,"+a;return n}function sD(t,e){var r="";r=_D(r,2596720087);r=oD(r,0);r=oD(r,0);r=oD(r,0);r=oD(r,96);r=oD(r,96);r=oD(r,yt);r=_D(r,0);var i=0;var f=0;for(f=0;f<10;f++){var l=r.charCodeAt(2*f);var a=r.charCodeAt(2*f+1);var n=(a<<8)+l;i^=n}r=oD(r,i);return r+e}function _D(t,e){t+=String.fromCharCode(e&255);e=e>>8;t+=String.fromCharCode(e&255);e=e>>8;t+=String.fromCharCode(e&255);e=e>>8;t+=String.fromCharCode(e&255);return t}function oD(t,e){t+=String.fromCharCode(e&255);e=e>>8;t+=String.fromCharCode(e&255);return t}var uD="#7f7f7f";var TD="#cfcfcf";var AD="#000000";var ED="#3f3f3f";var RD="gray";$t.ClsComps=function(){this.ObjType="ClsComp";var r=[];var i=false;var f=false;var l=false;var t;this.AddComp=function(t){for(var e=0;e<r.length;e++){if(r[e]==null){r[e]=t;return e}}r.push(t);return r.length-1};this.DeleteComp=function(t){if(t<0||t>=r.length)return;r[t]=null};this.KillFocusExcept=function(t){if(r==null)return false;for(var e=0;e<r.length;e++){if(e==t)continue;if(r[e]!=null){if(r[e].killFocus!=null)r[e].killFocus()}}};this.OnMouseEvent=function(t){var e;i=false;if(r==null)return false;for(e=0;e<r.length;e++){if(r[e]!=null&&r[e].isPopup!=null&&r[e].isPopup()){if(r[e].OnMouseEvent(t))i=true;if(i)return i}}for(e=0;e<r.length;e++){if(r[e]!=null){if(r[e].OnMouseEvent(t))i=true}}return i};this.OnKeyEvent=function(t){f=false;if(r==null)return false;for(var e=0;e<r.length;e++){if(r[e]!=null){if(r[e].OnKeyEvent(t))f=true}}if(f)t.preventDefault();return f};this.OnCBEvent=function(t){l=false;if(r==null)return false;for(var e=0;e<r.length;e++){if(r[e]!=null){if(r[e].OnCBEvent&&r[e].OnCBEvent(t))l=true}}return l};this.hasFocus=function(){if(r==null)return false;for(var t=0;t<r.length;t++){if(r[t]!=null){if(r[t].hasFocus())return true}}return false}};$t.AddComp=function(t,e){if(t.comps==null)t.comps=new $t.ClsComps;return t.comps.AddComp(e)};$t.DeleteComp=function(t,e){if(t.comps!=null)t.comps.DeleteComp(e)};$t.KillFocusExcept=function(t,e){if(t.comps!=null)t.comps.KillFocusExcept(e)};$t.DialogBox=function(t,e,r,i,f,l){this.ObjType="DialogBox";var L=t;var C=$t.GetTerData(L);var I=0;var a=null;var n=C.DlgKeyListener;var c=C.DlgCBListener;var s=null;var _=false;var o=0;var u=0;var d=null;var F=null;var g=document.getElementById(L);var T=g.parentNode;var P=-1;var S=-1;var h=nk(e);var O=r;var v=i;var p=true;var N=0;var D=0;var A=f;var M=25;var G=25;var B=C.TerCssToDevice(10);var R=l==undefined?JV(10):l;var H=C.TerCssToDevice(42);var m=0;var w=C.TerCssToDevice(90);var b=C.TerCssToDevice(90);var x;var y=C.TerCssToDevice(20);var E=w+b+y;var W=0;var U=0;var k=0;var X=0;var K=0;var Y=0;var V=C.TerCssToDevice(1);var j;var J;var z=[];var Z=[];var Q=[];var q=[];var $=[];var tt=[];var et=[];var rt=[];var it=[];var ft=[];var lt=[];var at=null;var nt="OK";var ct="Cancel";var st=null;var _t=[];var ot=[];var ut=[];var Tt=[];var At=[];var Et=[];var Rt=[];var Lt=[];var Ct=[];var It=[];var dt=false;var Ft="#eeeeee";var gt="#dddddd";var Pt="#000";var St="#cccccc";var ht=JV(2);this.ForgetMouseUp=false;var Ot=this;var vt=0;var pt=0;var Nt=false;var Dt=0;var Mt=0;var Gt=false;var Bt=true;var Ht=false;var mt=null;var wt=false;var bt=false;var xt=false;var yt=false;var Wt=null;var Ut=9;var kt=13;var Xt=32;var Kt=27;F=document.createElement("canvas");F.style.font=O;F.style.position="absolute";F.style.whiteSpace="nowrap";F.style.left="0px";F.style.top="0px";F.width=C.TerCssToDevice(500);F.height=C.TerCssToDevice(500);F.id=L;F.EditorCvs=g;if(C.dialog!=null)s=C.dialog.cvs.caret;else s=g.caret;if(s!=null){_=s.CaretBlinking;o=s.getX();u=s.getY();s.hide()}this.cvs=F;var Yt=0;for(Yt=0;Yt<G;Yt++)tt[Yt]=0;for(Yt=0;Yt<M;Yt++)et[Yt]=0;this.hasOKIcon=function(t){p=t};this.addComp=function(t,e,r,i,f,l,a,n,c,s,_){if(n==undefined)n=0;if(c==undefined)c=0;if(s==undefined)s=0;if(_==undefined)_=0;var o=t.getWidth()+s;var u=t.getHeight()+_;if(e>=M)e=M-1;if(r>=G)r=G-1;if(i<1)i=1;if(f<1)f=1;if(e+i>M)i=M-e;if(r+f>G)f=G-r;z.push(t);Z.push(e);Q.push(r);q.push(l);$.push(a);rt.push(n);it.push(c);ft.push(i);lt.push(f);var T,A=(u+2*R)/i;for(T=e;T<e+i;T++){if(A>et[T])et[T]=A}var E=(o+2*R)/f;for(T=r;T<r+f;T++){if(E>tt[T])tt[T]=E}};this.addGroupBox=function(t,e,r,i,f,l,a,n,c,s){if(a==undefined)a=0;if(n==undefined)n=0;if(c==undefined)c=0;if(s==undefined)s=0;_t.push(t);ot.push(e);ut.push(r);Tt.push(i);At.push(a);Et.push(n);Rt.push(c);Lt.push(s);Ct.push(nk(f));It.push(l)};this.OnMouseEvent=function(t){wt=false;if(!Bt||Ht||!dt)return false;if(Ot.ForgetMouseUp&&(t.type=="mouseup"||t.type=="mousedown")){Ot.ForgetMouseUp=false;if(t.type=="mouseup")return false}var e=t.clientX;var r=t.clientY;e=e-F.getBoundingClientRect().left-F.clientLeft+F.scrollLeft;r=r-F.getBoundingClientRect().top-F.clientTop+F.scrollTop;e=JV(e);r=JV(r);if(t.type=="click"){if(Gt){Gt=false;wt=true}else if(WH(e,r,k,X,K,Y)){A("Cancel",Ot,L);t.preventDefault()}}else if(t.type=="mousedown"){if(!WH(e,r,0,0,N,W)){Gt=false;return false}vt=t.clientX;pt=t.clientY;Nt=F.caret.CaretBlinking;Dt=F.caret.getX();Mt=F.caret.getY();Gt=true;wt=true}else if(t.type=="mousemove"){if(Gt){P+=t.clientX-vt;S+=t.clientY-pt;F.style.left=P+"px";F.style.top=S+"px";F.caret.setCanvas(F);if(Nt)F.caret.position(Dt,Mt);vt=t.clientX;pt=t.clientY;Nt=F.caret.CaretBlinking;Dt=F.caret.getX();Mt=F.caret.getY();wt=true}}else if(t.type=="mouseup"){if(Gt){Gt=false;wt=true}}return wt};function Vt(t,e){if(C.DlgLevel>I)return;if(Ot.OnMouseEvent(t)){t.preventDefault();return}if(F.comps){if(F.comps.OnMouseEvent(t)){t.preventDefault();return}}}function jt(t,e){bt=false;if(C.DlgLevel>I)return false;if(!C.HasFocus)return false;var r=t.keyCode;if(t.type=="keydown"&&r==Ut){if(at.hasFocus()){at.killFocus();st.setFocus();bt=true}else if(st.hasFocus()){for(Yt=0;Yt<z.length;Yt++){z[Yt].setFocus();if(z[Yt].hasFocus()){st.killFocus();break}}if(Yt==z.length){st.killFocus();at.setFocus()}bt=true}else{var i=false;for(Yt=0;Yt<z.length;Yt++)if(z[Yt].hasFocus())break;if(Yt==z.length){for(Yt=0;Yt<z.length;Yt++){z[Yt].setFocus();if(z[Yt].hasFocus()){i=true;break}}if(!i){at.setFocus()}}else{z[Yt].killFocus();for(Yt=Yt+1;Yt<z.length;Yt++){if(z[Yt].ObjType=="TextBox")iM();z[Yt].setFocus();if(z[Yt].hasFocus())break}if(Yt==z.length)at.setFocus()}bt=true}}else if(t.type=="keydown"&&r==kt){qt("enter",at,e,"OK");bt=true}else if(t.type=="keydown"&&r==Kt){qt("enter",st,e,"Cancel");bt=true}if(bt){t.preventDefault();return true}if(F.comps){if(F.comps.OnKeyEvent(t))return true}return false}function Jt(t,e){if(!C.HasFocus)return false;t.preventDefault();if(C.DlgLevel>I)return false;if(F.comps){if(F.comps.OnCBEvent(t))return true}return false}this.show=function(){if(dt)return;dt=true;Qt();var t=F.getContext("2d");t.save();YH(t,0,0,N,D);t.clip();t.fillStyle=Ft;t.fillRect(0,0,N,D);t.fillStyle=gt;t.fillRect(0,0,N,W);t.fillStyle=Pt;t.textBaseline="top";t.font=O;t.fillText(h,B,(W-U)/2);if(v){t.moveTo(k,X);t.lineTo(k+K,X+Y);t.strokeStyle=Pt;t.lineWidth=JV(1);t.stroke();t.moveTo(k+K,X);t.lineTo(k,X+Y);t.stroke()}Zt(t);for(var e=0;e<z.length;e++)zt(e);t.restore();F.addEventListener("click",function(t){Vt(t,L)});F.addEventListener("dblclick",function(t){Vt(t,L)});F.addEventListener("mousedown",function(t){Vt(t,L)});F.addEventListener("mouseenter",function(t){Vt(t,L)});F.addEventListener("mouseleave",function(t){Vt(t,L)});F.addEventListener("mousemove",function(t){Vt(t,L)});F.addEventListener("mouseover",function(t){Vt(t,L)});F.addEventListener("mouseout",function(t){Vt(t,L)});F.addEventListener("mouseup",function(t){Vt(t,L)});a=C.dialog;n=C.DlgKeyListener;c=C.DlgCBListener;C.DlgKeyListener=jt;C.DlgCBListener=Jt;C.dialog=Ot;if(at)at.show();if(st)st.show()};function zt(t){var e=z[t].getWidth();var r=z[t].getHeight();var i=2*B,f=W+2*B;var l=Z[t];var a=Q[t];var n,c;for(n=0;n<a;n++)i+=tt[n];for(n=0;n<l;n++)f+=et[n];i+=B;f+=B;if(q[t]=="center"||q[t]=="right"){var s=tt[a];if(lt[t]>1){for(n=1;n<lt[t];n++)s+=tt[a+n]}var _=s-2*B;c=_-e;if(q[t]=="center")c=c/2;i+=c}if($[t]=="middle"||$[t]=="bottom"){var o=et[l]-2*B;c=o-r;if($[t]=="middle")c=c/2;f+=c}if($[t]=="top")f-=B;if($[t]=="bottom")f+=B;i+=rt[t];f+=it[t];if(z[t].setBkndColor)z[t].setBkndColor(Ft);z[t].setPos(i,f);z[t].show()}this.hide=function(){if(!dt)return;dt=false;yt=false;if(a){a.cvs.caret.setCanvas(a.cvs);a.cvs.focus({preventScroll:true});a.ForgetMouseUp=true}else{g.caret.setCanvas(g);C.HasFocus=true;C.ForgetMouseUp=true}F.caret=null;if(s!=null){if(!_)s.hide();else s.position(o,u)}if(C.DlgLevel>0)C.DlgLevel--;I=0;C.dialog=a;C.DlgKeyListener=n;C.DlgCBListener=c;if(C.dialog==null)ee.focus({preventScroll:true});var t=document.body||document.documentElement;t.removeChild(F);Rk(L,d)};function Zt(t){var e,r,i,f;e=B;r=W+B;i=N-2*B;f=D-B-H-W;XH(t,e,r,i,f,St,ht);for(var l=0;l<_t.length;l++){e=2*B;r=W+2*B;i=0;f=0;var a=_t[l];var n=ot[l];for(Yt=0;Yt<n;Yt++)e+=tt[Yt];for(Yt=0;Yt<a;Yt++)r+=et[Yt];e+=B/2;r+=B/2;e+=At[l];r+=Et[l];for(Yt=n;Yt<n+Tt[l];Yt++)i+=tt[Yt];for(Yt=a;Yt<a+ut[l];Yt++)f+=et[Yt];i+=Rt[l];f+=Lt[l];i-=B;f-=B;XH(t,e,r,i,f,St,ht);if(Ct[l].length>0){var c=My(F,It[l]);e+=B/2;r-=c.height;t.fillStyle=Pt;t.textBaseline="top";t.font=It[l];t.fillText(Ct[l],e,r)}}}function Qt(){if(yt)return;yt=true;var t,e=0,r=0;for(t=0;t<M;t++)if(et[t]>0)e=t;for(t=0;t<G;t++)if(tt[t]>0)r=t;for(t=0;t<=e;t++)if(et[t]===0)et[t]=2*B;for(t=0;t<=r;t++)if(tt[t]===0)tt[t]=5*B;var i=4*B,f=4*B;for(t=0;t<G;t++)i+=tt[t];for(t=0;t<M;t++)f+=et[t];var l=F.getContext("2d");l.font=O;if(Wt==null)Wt=new My(F,O);U=Wt.height;W=U+2*B;Y=Wt.ascent;K=Y;var a=EH(l,h).width+2*B;if(v)a+=K+2*B;if(i<a)i=a;if(i<b+w+y+4*B)i=b+w+y+4*B;N=i;D=f+W+H;X=B;k=N-B-K;if(P==-1&&S==-1){var n=C.TerDeviceToCss(N);var c=C.TerDeviceToCss(D);var s=g.getBoundingClientRect().left-g.clientLeft+g.scrollLeft;var _=g.getBoundingClientRect().top-g.clientTop+g.scrollTop;var o=g.getBoundingClientRect().right-g.getBoundingClientRect().left;var u=g.getBoundingClientRect().bottom-g.getBoundingClientRect().top;P=s+(o-n)/2;S=_+(u-c)/2;if(P+n>screen.width)P=screen.width-n;if(P<0)P=0;fe=ie;if(fe==0)fe=fG();if(S+c>fe)S=fe-c;if(S<0)S=0}C.DlgLevel++;I=C.DlgLevel;d=Ek(L,true);F.style.left=P+"px";F.style.top=S+"px";F.style.width=C.TerDeviceToCss(N)+"px";F.style.height=C.TerDeviceToCss(D)+"px";F.width=N;F.height=D;F.style.zIndex=g.style.zIndex+I*1e3;F.tabIndex=I*1e3;var T=document.body||document.documentElement;T.appendChild(F);F.id=L;F.caret=g.caret;F.caret.setCanvas(F);if(C.UseVirtKeyboard&&C.DlgTextarea==null){C.DlgTextarea=document.createElement("textarea");C.DlgTextarea.style.border="none";C.DlgTextarea.value=" ";C.DlgTextarea.id="textareafordialogs"+te;C.DlgTextarea.style.position="absolute";C.DlgTextarea.style.top=F.style.top;C.DlgTextarea.style.left=C.IsMobileOS?F.style.left:"-100px";C.DlgTextarea.style.width="1px";C.DlgTextarea.style.height="20px";T.appendChild(C.DlgTextarea)}if(C.UseVirtKeyboard&&C.DlgTextarea!=null){C.DlgTextarea.style.zIndex=g.style.zIndex+I*1e3-1}if(at==null){m=D-H;x=H-2*B;var A=m+B;var E=0;if(p){var R=N-B-w;at=new $t.Button(F,R,A,w,x,O,nt,true,function(t,e){qt(t,e,L,"OK")});E=R-y-b}else{at=null;E=N-B-b}st=new $t.Button(F,E,A,b,x,O,ct,true,function(t,e){qt(t,e,L,"Cancel")})}}function qt(t,e,r,i){if(t=="enter"||t=="click"){A(i,e,r)}}};$t.ColorBox=function(t,e,r,i,f,l,a,n,c,s,_){this.ObjType="ColorBox";var I=t;var o=false;var d=e;var F=r;var u=JV(200);var T=JV(300);var g=i>u?i:u;var P=f>T?f:T;var S=0;var A=0;var E=0;var R=0;var h=a;var L=s;var C=_;var O=l;var v=l;var p=true;var N=false;var D=false;var M=false;var G=JV(3);var B=JV(1);var H=false;var m=[];var w=n;var b=w;var x="black";var y="black";var W="white";var U=false;var k=this;var X=[];var K=[];var Y=0;var V=JV(20);var j=JV(10);var J=JV(2);var z=[];var Z=JV(10);var Q="12pt Arial";var q=nk("Standard Colors");var $=nk("Custom Colors");var tt=nk("Auto Color");var et=nk("Set As Custom");var rt=nk("Current: ");var it=nk("Selected: ");var ft=0;var lt=0;var at=0;var nt=0;var ct=0;var st=0;var _t=0;var ot=0;var ut=0;var Tt=0;var At=0;var Et=0;var Rt=0;var Lt=0;var Ct=0;var It=0;var dt=0;var Ft=0;var gt=0;var Pt=0;var St=null;var ht=0;var Ot=0;var vt=-1;var pt=-1;var Nt=16;var Dt=true;var Mt=this;var Gt=9;var Bt=13;var Ht=46;var mt="#f0f0f0";this.CompIdx=$t.AddComp(I,this);var wt=["ff","cf","80","3f","00"];for(var bt=0;bt<5;bt++){for(var xt=0;xt<5;xt++){for(var yt=0;yt<5;yt++){z.push("#"+wt[bt]+wt[xt]+wt[yt])}}}ht=z.length;Ot=ht;if(v=="text"){z.push("#010101");vt=ht;ht++}if(c!=null&&Array.isArray(c)){var Wt=c.length;if(Wt>2*Nt)Wt=2*Nt;for(var Ut=0;Ut<Wt;Ut++){if(pt<0)pt=ht;z.push(c[Ut]);m.push(c[Ut]);ht++}}Yt(0,0);this.getName=function(){return"colorbox"};this.setCallback=function(t){C=t};this.delete=function(){$t.DeleteComp(I,this.CompIdx);if(ParentCaret!=null){if(!ParentCaretVisible)ParentCaret.hide();else ParentCaret.position(ParetCaretX,ParentCaretY)}};this.getX=function(){return d};this.getY=function(){return F};this.setPos=function(t,e){d=t;F=e};this.getWidth=function(){return g};this.getHeight=function(){return P};this.setHidden=function(t){H=t;if(!t)kt()};this.setVisible=function(t){k.setHidden(!t)};this.isVisible=function(){return!H};this.hasFocus=function(){return U};this.setFocus=function(){if(H)return;var t=U;U=true;if(t!=U&&!H)kt();if(I.caret!=null)I.caret.hide();$t.KillFocusExcept(I,k.CompIdx)};this.killFocus=function(){if(H)return;var t=U;U=false;if(t!=U)kt()};this.setEnable=function(t){p=t};this.setEnabled=function(t){p=t};this.getText=function(){return O};this.setText=function(t){if(O!=t){O=t;kt()}};this.getSelectedColor=function(){return b};this.setSelectedColor=function(t){if(b!=t){b=t;kt()}};this.getCustomColors=function(){return m};this.OnKeyEvent=function(t){D=false;if(!p||!U||H)return false;var e=t.keyCode;if(t.type=="keypress"&&e==Bt){if(C!=null)C("enter",k,I.id);D=true}else if(t.type=="keydown"&&e==Ht){for(var r=0;r<m.length;r++)if(m[r]==b)break;if(r<m.length){z.splice(pt+r,1);ht--;m.splice(r,1);if(r<m.length)b=m[r];else b=w;kt();if(C!=null)C("change",k,I.id)}D=true}return D};this.OnMouseEvent=function(t){var e;N=false;if(!p||H)return false;var r=t.clientX;var i=t.clientY;r=r-I.getBoundingClientRect().left-I.clientLeft+I.scrollLeft;i=i-I.getBoundingClientRect().top-I.clientTop+I.scrollTop;r=JV(r);i=JV(i);var f=r;var l=i;r-=d;i-=F;if(t.type=="click"){if(!WH(r,i,0,0,g,P)){this.killFocus();return false}for(e=0;e<z.length;e++){if(WH(f,l,X[e],K[e],Y,Y)){if(b!=z[e]){b=z[e];kt();if(C!=null)C("change",k,I.id)}break}}if(m.length<2*Nt){if(WH(f,l,ut,Tt,At,Et)){for(e=0;e<m.length;e++)if(m[e]==b)break;if(e==m.length){m.push(b);z.push(b);ht++;kt()}}}if(C!=null)C("click",k,I.id);N=true;this.setFocus();N=true}return N};this.show=function(){kt()};function kt(t,e){var r;if(!t)t=0;if(!e)e=0;if(H)return;Yt(0,0);var i=I.getContext("2d");i.save();i.setTransform(1,0,0,1,0,0);i.fillStyle=mt;i.fillRect(d,F,g,P);for(r=0;r<ht;r++){var f=X[r]+(Y+J)/2;var l=K[r]+(Y+J)/2;kH(i,f,l,Y/2,z[r]);if(z[r]==b){UH(i,f,l,Y/2+J,"#000000")}}i.fillStyle=x;i.textBaseline="top";i.font=Q;i.fillText(q,ft,lt);if(v=="text"){i.fillText(tt,ct,st)}if(m.length>0){i.fillText($,at,nt)}i.fillStyle=x;i.fillText(rt,dt,Ft);Xt(i,Rt,Lt,w);i.fillStyle=x;i.fillText(it,gt,Pt);Xt(i,Ct,It,b);var a=true;if(m.length<2*Nt){for(r=0;r<m.length;r++)if(m[r]==b)break;if(r==m.length)a=false}i.fillStyle=a?"gray":x;i.fillText(et,_t,ot);XH(i,ut,Tt,At,Et,a?"gray":y,JV(1));n();function n(){Kt();i.restore()}}function Xt(t,e,r,i){if(v=="line"){XH(t,e,r+Z/2,At-Z,Et/3,i,JV(1))}else if(v=="bknd"){KH(t,e,r+Z/3,At-3*Z/2,Et-3*Z/2,i)}else{t.fillStyle=i;t.textBaseline="top";t.font=Q;t.fillText("ABC abc",e,r)}}function Kt(){var t=U;if(L&&!H)$t.CompDrawBorder(I,d,F,g,P,t)}function Yt(t,e){Y=(g-2*Z)/Nt-2*J;if(Y>V)Y=V;if(Y<j)Y=j;var r=Y+2*J;var i=r;var f=r*Nt;var l=Z+(g-2*Z-f)/2;var a=2;var n=h.indexOf(" ");if(n>=0){Q=(Y-a).toString()+"px"+h.substring(n)}else Q=Y.toString()+"px Arial";if(St==null)St=My(I,Q);S=St.height;var c=I.getContext("2d");c.font=Q;var s=EH(c,q).width;ft=d+Z+(g-2*Z-s)/2;lt=F+Z;var _=Z+S;var o=Math.floor(Ot/Nt)+1;var u,T,A=0;X=[];K=[];for(u=0;u<o;u++){for(T=0;T<Nt;T++){X.push(d+l+T*r);K.push(F+_);A++;if(A>=Ot)break}if(A>=Ot)break;_+=i}_+=i;if(v=="text"){_+=Z;s=EH(c,tt).width;ct=d+Z+(g/2-Z-s);st=F+_;X.push(ct+s+Z);K.push(F+_-a);_+=S}var E=_;if(m.length>0){_+=Z;s=EH(c,$).width;at=d+Z+(g-2*Z-s)/2;nt=F+_;_+=S;var R=m.length;o=Math.floor(R/Nt);if(o*Nt<R)o++;var L=f;var C=l;if(o==1){L=r*R;C=Z+(g-2*Z-L)/2}A=0;for(u=0;u<o;u++){for(T=0;T<Nt;T++){X.push(d+C+T*r);K.push(F+_);A++}if(A>=R)break;_+=i}_+=i}_=E+Z+S+i*2;_+=Z;s=EH(c,rt).width;dt=d+Z+(g/2-Z-s);Ft=F+_;Rt=dt+s+Z;Lt=Ft;_+=S;s=EH(c,it).width;gt=d+Z+(g/2-Z-s);Pt=F+_;Ct=gt+s+Z;It=Pt;_+=S;s=EH(c,et).width;ut=Ct;Tt=F+_+Z/2;At=s+Z;Et=S+Z;_t=ut+Z/2;ot=Tt+Z/2;_+=S+Z/2+Z;_+=Z;if(Dt){P=Math.ceil(_+Z);Dt=false}}};$t.RadioButton=function(t,e,r,i,f,l,a,n,c){this.ObjType="RadioButton";var s=t;var _=false;var o=e;var u=r;var T=i;var A=T;var E=0;var R=0;var L=0;var C=0;var I=u;var d=f;var F=true;var g=c;var P=nk(l);var S=true;var h=false;var O=false;var v=false;var p=JV(3);var N=JV(1);var D=false;var M=a;var G=JV(10);var B=n;var H=null;var m=0;var w=0;var b;var x=null;var y="black";var W="white";var U=false;var k=this;var X=9;var K=13;var Y=32;var V="#f0f0f0";this.CompIdx=$t.AddComp(s,this);if(B!=null)B.setNextButton(k);J(0,0);this.getName=function(){return"radiobutton"};this.setCallback=function(t){g=t};this.delete=function(){$t.DeleteComp(s,this.CompIdx)};this.getX=function(){return o};this.getY=function(){return u};this.setPos=function(t,e){o=t;u=e};this.getWidth=function(){J(0,0);if(P.length==0)return T;else return T+G+R};this.getHeight=function(){J(0,0);if(P.length==0)return A;else return A>E?A:E};this.setSize=function(t,e){T=t;A=e;J(0,0)};this.setHidden=function(t){D=t;if(!t)j()};this.setVisible=function(t){k.setHidden(!t)};this.isVisible=function(){return!D};this.hasFocus=function(){return U};this.setFocus=function(){if(D)return;var t=U;U=true;if(t!=U&&!D)j();if(s.caret!=null)s.caret.hide();$t.KillFocusExcept(s,k.CompIdx)};this.killFocus=function(){if(D)return;var t=U;U=false;if(t!=U)j()};this.setEnable=function(t){S=t};this.setEnabled=function(t){S=t};this.isChecked=function(){return M};this.isSelected=function(){return M};this.setChecked=function(t){if(t!=M){M=t;j()}if(g!=null)g("change",k,s.id)};this.setSelected=function(t){k.setChecked(t)};this.getPrevButton=function(){return B};this.getNextButton=function(){return H};this.setNextButton=function(t){if(H==null)H=t};this.getText=function(){return P};this.OnKeyEvent=function(t){O=false;if(!S||!U||D)return false;var e=t.keyCode;if(t.type=="keypress"&&e==Y){if(!M){M=!M;j();z();O=true}}return O};this.OnMouseEvent=function(t){h=false;if(!S||D)return false;var e=t.clientX;var r=t.clientY;e=e-s.getBoundingClientRect().left-s.clientLeft+s.scrollLeft;r=r-s.getBoundingClientRect().top-s.clientTop+s.scrollTop;e=JV(e);r=JV(r);e-=o;r-=I;if(t.type=="click"){if(!WH(e,r,0,0,T,A)){this.killFocus();return false}if(!M){M=!M;j();if(g!=null)g("click",k,s.id);z();h=true}this.setFocus();h=true}return h};this.show=function(){j()};function j(t,e){if(!t)t=0;if(!e)e=0;if(D)return;J(0,0);var r=U?AD:uD;var i=s.getContext("2d");i.save();i.setTransform(1,0,0,1,0,0);kH(i,m,w,b,V);if(M){kH(i,m,w,b/2,r)}if(P.length>0){i.fillStyle=V;i.fillRect(L,C,R,E);i.fillStyle=y;i.textBaseline="top";i.font=d;i.fillText(P,L,C)}f();function f(){UH(i,m,w,b,r,JV(1));i.restore()}}function J(t,e){if(x==null)x=My(s,d);E=x.height;if(P.length==0)E=0;m=o+T/2;b=T/2;if(A>E){I=u;C=u+(A-E)/2}else{C=u;I=u+(E-A)/2}if(C<=u)C=u+JV(1);w=I+A/2;var r=s.getContext("2d");r.font=d;R=EH(r,P).width;if(P.length==0)R=0;L=o+T+G}function z(){var t;if(B!=null){for(t=B;t!=null;t=t.getPrevButton()){if(t.isChecked())t.setChecked(false)}}if(H!=null){for(t=H;t!=null;t=t.getNextButton()){if(t.isChecked())t.setChecked(false)}}}};$t.CheckBox=function(t,e,r,i,f,l,a,n,c){this.ObjType="Checkbox";var s=t;var _=false;var o=e;var u=r;var T=i;var A=f;var E=0;var R=0;var L=0;var C=0;var I=u;var d=l;var F=true;var g=c;var P=nk(a);var S=true;var h=false;var O=false;var v=false;var p=JV(3);var N=JV(1);var D=false;var M=n;var G=10;var B=null;var H="black";var m="white";var w=false;var b=this;var x=9;var y=13;var W=32;var U="#f0f0f0";this.CompIdx=$t.AddComp(s,this);this.getName=function(){return"checkbox"};this.delete=function(){$t.DeleteComp(s,this.CompIdx)};this.getX=function(){return o};this.getY=function(){return u};this.setPos=function(t,e){o=t;u=e};this.getWidth=function(){K(0,0);if(P.length==0)return T;else return T+G+R};this.getHeight=function(){K(0,0);if(P.length==0)return A;else return A>E?A:E};this.setSize=function(t,e){T=t;A=e;K(0,0)};this.setHidden=function(t){D=t;if(!t)k()};this.setVisible=function(t){b.setHidden(!t)};this.isVisible=function(){return!D};this.hasFocus=function(){return w};this.setFocus=function(){if(D)return;var t=w;w=true;if(t!=w&&!D)k();if(s.caret!=null)s.caret.hide();$t.KillFocusExcept(s,b.CompIdx)};this.killFocus=function(){if(D)return;var t=w;w=false;if(t!=w)k()};this.setEnable=function(t){S=t};this.setEnabled=function(t){S=t};this.isChecked=function(){return M};this.isSelected=function(){return M};this.setChecked=function(t){if(t!=M){M=t;k()}};this.setSelected=function(t){b.setChecked(t)};this.setCallback=function(t){g=t};this.getText=function(){return P};this.setText=function(t){if(P!=t){P=t;k()}};this.OnKeyEvent=function(t){O=false;if(!S||!w||D)return false;var e=t.keyCode;if(t.type=="keypress"&&e==W){M=!M;k();O=true}return O};this.OnMouseEvent=function(t){h=false;if(!S||D)return false;var e=t.clientX;var r=t.clientY;e=e-s.getBoundingClientRect().left-s.clientLeft+s.scrollLeft;r=r-s.getBoundingClientRect().top-s.clientTop+s.scrollTop;e=JV(e);r=JV(r);e-=o;r-=I;if(t.type=="click"){if(!WH(e,r,0,0,T,A)){this.killFocus();return false}M=!M;k();if(g!=null)g("click",b,s.id);h=true;this.setFocus();h=true}return h};this.show=function(){k()};function k(t,e){if(!t)t=0;if(!e)e=0;if(D)return;K(0,0);var r=s.getContext("2d");r.save();r.setTransform(1,0,0,1,0,0);r.fillStyle=U;r.fillRect(o,u,T,A);if(M){r.strokeStyle=H;r.lineWidth=JV(1);r.beginPath();r.moveTo(o+T/4,I+3*A/8);r.lineTo(o+3*T/8,I+3*A/4);r.lineTo(o+5*T/6,I+A/6);r.stroke();r.closePath()}if(P.length>0){r.fillStyle=U;r.fillRect(L,C,R,E);r.fillStyle=H;r.textBaseline="top";r.font=d;r.fillText(P,L,C)}i();function i(){X();r.restore()}}function X(){var t=w;if(F&&!D)$t.CompDrawBorder(s,o,u,T,A,t)}function K(t,e){if(B==null)B=My(s,d);E=B.height;if(P.length==0)E=0;if(A>E){I=u;C=u+(A-E)/2}else{C=u;I=u+(E-A)/2}if(C<=u)C=u+JV(1);var r=s.getContext("2d");r.font=d;R=EH(r,P).width;if(P.length==0)R=0;L=o+T+G}};$t.Label=function(t,e,r,f,l){this.ObjType="Label";var u=t;var a=false;var T=e;var A=r;var E=0;var R=0;var L=0;var C=0;var I=0;var d=0;var F=f;var g=nk(l);var _=false;var P=0;var S=[];var o=true;var n=false;var c=false;var s=false;var h=JV(3);var O=JV(1);var v=false;var p=null;var N="black";var D="gray";var M="white";var G=false;var B=this;var H=9;var m=13;var w="#f0f0f0";this.CompIdx=$t.AddComp(u,this);this.getName=function(){return"label"};this.delete=function(){$t.DeleteComp(u,this.CompIdx)};this.getX=function(){return T};this.getY=function(){return A};this.setPos=function(t,e){T=t;A=e};this.getWidth=function(){y(0,0);return E};this.getHeight=function(){y(0,0);return R};this.setBkndColor=function(t){M=t};this.setHidden=function(t){v=t;if(!t)b()};this.setVisible=function(t){B.setHidden(!t)};this.isVisible=function(){return!v};this.hasFocus=function(){return false};this.setFocus=function(){};this.killFocus=function(){};this.setEnable=function(t){var e=o;o=t;if(e!=o)b(0,0)};this.setEnabled=function(t){var e=o;o=t;if(e!=o)b(0,0)};this.setText=function(t){g=nk(t)};this.setWrapWidth=function(t){P=t};this.OnKeyEvent=function(t){c=false;return c};this.OnMouseEvent=function(t){n=false;return n};this.show=function(){b()};function b(t,e){var r=I;var f=d;var l=E;var a=R;if(v)return;var n=u.getContext("2d");y(0,0);n.save();n.setTransform(1,0,0,1,0,0);if(_){n.fillStyle=M;n.fillRect(r,f,l,a)}n.fillStyle=o?N:D;n.textBaseline="top";n.font=F;if(P>0){var c=d;for(i=0;i<S.length;i++){n.fillText(S[i],I,c);c+=L}}else n.fillText(g,I,d);_=true;s();function s(){x();n.restore()}}function x(){}function y(t,e){if(p==null)p=My(u,F);L=p.height;R=L;d=A;if(d<=A)d=A+1;var r=u.getContext("2d");r.font=F;C=EH(r,g).width;E=C;if(P>0){E=P;S=[];var i=g.split(" ");var f,l=0,a=i.length;var n=0;S[l]="";for(f=0;f<a;f++){var c,s=i[f]+" ";var _=EH(r,s).width;if(n+_>P){l++;S[l]="";n=0}while((c=s.indexOf("\n"))>=0){var o=s.substring(0,c);S[l]+=o;s=s.substring(c+1,s.length);_=EH(r,s).width;l++;S[l]="";n=0}S[l]+=s;n+=_}R=L*S.length}I=T}};$t.Button=function(t,e,r,i,f,l,a,n,c){this.ObjType="Button";var s=t;var _=false;var o=e;var u=r;var T=i;var A=f;var E=0;var R=0;var L=0;var C=0;var I=l;var d=n;var F=c;var g=nk(a);var P=true;var S=false;var h=false;var O=false;var v=3;var p=1;var N=false;var D=false;var M=null;var G="black";var B="white";var H=false;var m=this;var w=9;var b=13;var x="#f0f0f0";this.CompIdx=$t.AddComp(s,this);this.getName=function(){return"button"};this.setCallback=function(t){F=t};this.delete=function(){$t.DeleteComp(s,this.CompIdx);D=true};this.getX=function(){return o};this.getY=function(){return u};this.setPos=function(t,e){o=t;u=e};this.getWidth=function(){return T};this.getHeight=function(){return A};this.setHidden=function(t){N=t;if(!t)y()};this.setVisible=function(t){m.setHidden(!t)};this.isVisible=function(){return!N};this.hasFocus=function(){return H};this.setFocus=function(){if(N)return;var t=H;H=true;if(t!=H&&!N)y();if(s.caret!=null)s.caret.hide();$t.KillFocusExcept(s,m.CompIdx)};this.killFocus=function(){if(N)return;var t=H;H=false;if(t!=H)y()};this.setEnable=function(t){P=t};this.setEnabled=function(t){P=t};this.getText=function(){return g};this.setText=function(t){if(g!=t){g=t;y()}};this.OnKeyEvent=function(t){h=false;if(!P||!H||N)return false;var e=t.keyCode;if(t.type=="keypress"&&e==b){if(F!=null)F("enter",m,s.id);h=true}return h};this.OnMouseEvent=function(t){S=false;if(!P||N)return false;var e=t.clientX;var r=t.clientY;e=e-s.getBoundingClientRect().left-s.clientLeft+s.scrollLeft;r=r-s.getBoundingClientRect().top-s.clientTop+s.scrollTop;e=JV(e);r=JV(r);e-=o;r-=u;if(t.type=="mousedown"){if(!WH(e,r,0,0,T,A)){this.killFocus();return false}if(F!=null)F("click",m,s.id);S=true;this.setFocus();S=true}return S};this.show=function(){y()};function y(t,e){if(!t)t=0;if(!e)e=0;if(N||D)return;U(0,0);var r=s.getContext("2d");r.save();r.setTransform(1,0,0,1,0,0);r.fillStyle=x;r.fillRect(o,u,T,A);r.fillStyle=G;r.textBaseline="top";r.font=I;r.fillText(g,L,C);i();function i(){W();r.restore()}}function W(){var t=H;if(d&&!N)$t.CompDrawBorder(s,o,u,T,A,t)}function U(t,e){if(M==null)M=My(s,I);E=M.height;C=u+(A-M.height)/2;if(C<=u)C=u+1;var r=s.getContext("2d");r.font=I;R=EH(r,g).width;L=o+(T-R)/2;if(L<=o)L=o+1}};$t.ComboBox=function(t,e,r,i,f,l,a,n,c,s,_,o){this.ObjType="ComboBox";this.name="combobox";this.num1=0;this.num2=0;var u=t;var T=l;var A=n;var E=e;var R=r;var L=i;var C=L;var I=f;var d=a;var F=T?I:f-d;var g=null;var P=null;var S=0;var h=false;var O=null;var v=false;var p=c;var N=s;var D=o;var M=true;var G=false;var B=false;var H=false;var m=JV(3);var w=JV(1);var b=_;var x=false;var y=null;var W="black";var U="white";var k=false;var X=this;var K=9;var Y=13;var V=38;var j=40;var J="#f0f0f0";var z="#f0f0f0";var Z="#dadada";var Q=0;var q=1;var $=Q;this.CompIdx=$t.AddComp(u,this);if(F<=5){F=5;d=I-F}if(T)C=L-I;if(T)rt();g=new $t.TextBox(u,E,R,C,F,"",p,u.caret,A,true,function(t,e){tt(t,e,u.id)});P=new $t.ListBox(u,E,R+F,L,d,p,N,T||b,function(t,e){et(t,e,u.id)});if(!T)v=true;if(T)P.setIsPopup(true);if(!b)ft();this.getName=function(){return X.name};this.setName=function(t){X.name=t;if(P!=null)P.setName(t)};this.setCallback=function(t){D=t};this.resize=function(t,e){L=t;if(P!=null)P.SetWidth(t);if(T){I=e;F=e;C=L-I}};this.getSelectedItem=function(){if(A)return P.getSelectedItem();else return g.getText()};this.getText=function(){return X.getSelectedItem()};this.getSelectedItemData=function(){return P.getSelectedItemData()};this.getSelectedValue=function(){return P.getSelectedItemData()};this.getItemCount=function(){if(P==null)return 0;else return P.getItemCount()};this.setMaximumRowCount=function(t){if(P!=null)P.setMaximumRowCount(t)};this.setItems=function(t,e,r,i){if(P!=null){P.setItems(t,e,r,i);if(r<0)g.setText("");else g.setText(P.getSelectedItem())}};this.getSelectedItemIdx=function(){return P==null?0:P.getSelectedItemIdx()};this.getSelectedIndex=function(){return P==null?0:P.getSelectedItemIdx()};this.FindStringExact=function(t){return P==null?-1:P.FindStringExact(t)};this.setSelectedItemIdx=function(t){if(P!=null)P.setSelectedItemIdx(t)};this.setSelectedIndex=function(t){if(P!=null){P.setSelectedItemIdx(t);if(g!=null)g.setText(P.getSelectedItem())}};this.setSelectedItem=function(t){if(P!=null)P.selectMatchingItem(t);if(g!=null)g.setText(t)};this.getSelectedItem=function(){return g.getText()};this.getItemAt=function(t){if(P==null)return"";else return P.getItemAt(t)};this.getValueAt=function(t){if(P==null)return"";else return P.getValueAt(t)};this.getDataAt=function(t){if(P==null)return"";else return P.getDataAt(t)};this.delete=function(){if(g!=null)g.delete();if(P!=null)P.delete();$t.DeleteComp(u,this.CompIdx)};this.getX=function(){return E};this.getY=function(){return R};this.setPos=function(t,e){E=t;R=e;if(g!=null)g.setPos(t,e);if(P!=null)P.setPos(t,e+F)};this.getWidth=function(){return L};this.getHeight=function(){return I};this.setSize=function(t,e){L=t;I=e;if(T)C=L-I;F=T?I:f-d;nt();if(P!=null)P.setSize(L,d);if(g!=null)g.setSize(C,F)};this.setHidden=function(t){b=t;if(g!=null)g.setHidden(t);if(P!=null&&v)P.setHidden(t);if(!t)ft()};this.setVisible=function(t){X.setHidden(!t)};this.isHidden=function(){return b};this.show=function(){X.setHidden(false)};this.isVisible=function(){return!b};this.hasFocus=function(){return k};this.setFocus=function(){if(b)return;var t=k;k=true;if(t!=k&&!b)ft();if(u.caret!=null)u.caret.hide();$t.KillFocusExcept(u,X.CompIdx)};this.killFocus=function(){if(b)return;var t=k;k=false;if(t!=k)ft()};this.setEnable=function(t){M=t};this.setEnabled=function(t){M=t};this.OnKeyEvent=function(t){return false};this.OnMouseEvent=function(t){G=false;if(!M||b||!T)return false;var e=t.clientX;var r=t.clientY;e=e-u.getBoundingClientRect().left-u.clientLeft+u.scrollLeft;r=r-u.getBoundingClientRect().top-u.clientTop+u.scrollTop;e=JV(e);r=JV(r);e-=E;r-=R;var i=WH(e,r,0,0,L,I);var f=false;var l=x;if(v&&P!=null)f=P.mouseInRect(t);else f=false;l=f;if(v&&P!=null&&f)return false;if(t.type=="click"){if(!i){if(v&&!f){P.setHidden(true);it();v=!v;k=false;ft(e,r);this.killFocus();if(x||l)G=true;x=l;G=false;return G}if(P!=null&&v){if(P!=null)P.setHidden(true);it();v=false}this.killFocus();return false}if(!WH(e,r,C,0,L-C,I))return false;if(v){if(P!=null)P.setHidden(true);it()}else{if(D!=null)D("BeforeListBoxShow",X,u.id);rt();if(P!=null){P.setHidden(false);MouseDownInListBox=false;MouseUpInListBox=false;x=false}}v=!v;ft(e,r);this.setFocus();G=true;MouseIn=true}else if(t.type=="mousedown"){if(v)G=true}else if(t.type=="mouseup"){if(v)G=true}else if(t.type=="mousemove"||t.type=="mousehover")ft(e,r);return G};function tt(t,e,r){if(t=="enter"){if(T&&v){if(P!=null)P.setHidden(true);it()}if(D!=null)D("selected",X,u.id)}else{if(v){var i=g.getText();P.selectMatchingItem(i)}if(D!=null)D(t,X,u.id)}}function et(t,e,r){if(t=="dblclick"||t=="enter"||t=="selected"||t=="change"){g.setText(P.getSelectedItem());if(T&&v){if(P!=null)P.setHidden(true);it();v=!v;k=false;ft(Ga,Ba)}if(D!=null)D("selected",X,u.id)}else if(D!=null){if(t=="beforehiding")D("beforehidinglistbox",X,u.id);else if(t=="beforeshowing")D("beforeunhidinglistbox",X,u.id);else D(t,X,u.id)}}function rt(){var t=u.getContext("2d");var e=R+F;var r=E-1;var i=L+JV(2);var f=d+JV(1);if(r<0){r+=JV(1);i-=JV(1)}try{O=t.getImageData(r,e,i,f)}catch(t){O=null}}function it(){if(O==null)return;var t=u.getContext("2d");var e=R+F;var r=E-JV(1);if(r<0)r+=JV(1);t.putImageData(O,r,e)}this.refresh=function(){if(g!=null)g.refresh();if(P!=null){if(v)P.refresh();else P.setHidden(true)}ft()};function ft(t,e){if(!t)t=0;if(!e)e=0;if(b)return;nt(0,0);var r=u.getContext("2d");r.save();r.setTransform(1,0,0,1,0,0);if(!T){o();return}$=lt(t,e);r.fillStyle=J;r.fillRect(E+C,R,L-C,I);var i=L-C;var f=E+C;var l,a,n,c,s,_;if(v){l=R+I/3;a=f+i/2;c=l+I/4;n=a-i/4;_=c;s=a+i/4}else{l=R+I*2/3;a=f+i/2;c=l-I/4;n=a-i/4;_=c;s=a+i/4}r.beginPath();r.moveTo(a,l);r.lineTo(s,_);r.lineTo(n,c);r.closePath();r.fillStyle="darkgray";if($==q)r.fillStyle="#2f2f2f";r.fill();o();function o(){at();r.restore()}}function lt(t,e){var r=Q;if(WH(t,e,C,0,L-C,I))r=q;return r}function at(){var t=k||g.hasFocus();if(!t&&P!=null&&P.hasFocus())t=true;if(N&&!b){if(T)$t.CompDrawBorder(u,E,R,L,I,t);else $t.CompDrawBorder(u,E,R+F,L,I-F,t)}}function nt(t,e){}};$t.ListBox=function(t,e,r,i,f,l,a,n,c){this.ObjType="ListBox";this.name="listbox";var s=t;var _=e;var o=r;var u=i;var T=u;var A=f;var E=[];var R=[];var L=0;var C=0;var I=false;var d=0;var F=1;var g=1;var P=0;var S=false;var h=JV(16);var O=null;var v=l;var p=a;var N=c;var D=true;var M=false;var G=false;var B=false;var H=JV(3);var m=JV(1);var w;var b;var x;var y=n;var W=false;var U=null;var k="black";var X="gray";var K="white";var Y=false;var V=this;var j=false;var J=this;var z=9;var Z=13;var Q=38;var q=40;this.CompIdx=$t.AddComp(s,this);if(!y)rt();else ft(0,0);this.setMaximumRowCount=function(t){P=t};this.getMaximumRowCount=function(){return P};this.setCallback=function(t){N=t};this.isPopup=function(){return j};this.setIsPopup=function(t){j=t};this.getName=function(){return J.name};this.setName=function(t){J.name=t;if(O!=null)O.setName(t)};this.getSelectedItem=function(){if(E.length==0||L<0||L>=E.length)return"";return E[L]};this.getSelectedIdx=function(){if(E.length==0||L<0||L>=E.length)return-1;return L};this.getItemAt=function(t){if(E.length==0||t<0||t>=E.length)return"";return E[t]};this.getValueAt=function(t){if(R.length==0||t<0||t>=R.length)return"";return R[t]};this.getDataAt=function(t){if(R.length==0||t<0||t>=R.length)return"";return R[t]};this.getSelectedItemData=function(){if(R.length==0||L<0||L>=R.length)return"";return R[L]};this.getSelectedValue=function(){if(R==null||R.length==0||L<0||L>=R.length)return"";return R[L]};this.getItemCount=function(){if(E==null)return 0;else return E.length};this.setItems=function(t,e,r,i){E=t==null?null:t.slice();R=e==null?null:e.slice();L=r;if(L>=E.length)L=E.length-1;I=i;d=t.length;if(e!=null&&e.length<d)d=e.length;if(!i)return;if(R==null||R.length==0){var f=L<0?"":t[L];E.sort(function(t,e){if(t.toLowerCase()<e.toLowerCase())return-1;if(t.toLowerCase()>e.toLowerCase())return 1;return 0});if(L>=0){L=$(f)}}else{for(var l=0;l<d;l++){for(var a=l+1;a<d;a++){var n=E[l].toLowerCase();var c=E[a].toLowerCase();if(c<n){var s=E[l];var _=R==null?null:R[l];E[l]=E[a];if(R!=null)R[l]=R[a];E[a]=s;if(R!=null)R[a]=_;if(L==l)L=a;else if(L==a)L=l}}}}rt()};function $(t){if(!I)return E.indexOf(t);if(E.length==0)return-1;t=t.toLowerCase();var e=0;var r=E.length-1;while(true){if(e==r){if(E[e].toLowerCase()==t)return e;else return-1}if(r==e+1){if(E[e].toLowerCase()==t)return e;if(E[r].toLowerCase()==t)return r;else return-1}var i=e+Math.floor((r-e)/2);if(t<=E[i].toLowerCase())r=i;else e=i}}this.getSelectedItemIdx=function(){return L};this.getSelectedIndex=function(){return L};this.setSelectedItemIdx=function(t){if(t>=0&&t<E.length)L=t;else L=-1};this.FindStringExact=function(t){if(E.length==0)return;var e=L;var r=E.length;var i=t.length;t=t.toLowerCase();if(!I){for(var f=0;f<r;f++){if(E[f].toLowerCase()==t)return f}return-1}var l=0;var a=E.length-1;while(true){if(l==a){if(E[l].toLowerCase()==t)return l;else return-1}if(a==l+1){if(E[l].toLowerCase()==t)return l;if(E[a].toLowerCase()==t)return a;else return-1}var n=l+Math.floor((a-l)/2);if(t<=E[n].toLowerCase())a=n;else l=n}return-1};this.selectMatchingItem=function(t){if(E.length==0)return;var e=L;var r=E.length;var i=t.length;t=t.toLowerCase();if(!I){for(var f=0;f<r;f++){if(Lk(E[f].toLowerCase(),t)){L=f;break}}if(L!=e){lt();rt()}return}var l=0;var a=E.length-1;while(true){if(l==a){if(Lk(E[l].toLowerCase(),t)){L=l;break}else break}if(a==l+1){if(Lk(E[l].toLowerCase(),t)){L=l;break}if(Lk(E[a].toLowerCase(),t)){L=a;break}else break}var n=l+Math.floor((a-l)/2);if(t<=E[n].toLowerCase())a=n;else l=n}if(L!=e){lt();rt()}};this.setHidden=function(t){y=t;if(N){if(t)N("beforehiding",this,s.id);else if(t)N("beforeshowing",this,s.id)}if(!y){lt();rt()}if(O!=null)O.setHidden(t);if(t)Y=false};this.setVisible=function(t){J.setHidden(!t)};this.isVisible=function(){return!y};this.show=function(){J.setHidden(false)};this.getSelectedItem=function(){return E[L]};this.delete=function(){if(O!=null)O.delete();$t.DeleteComp(s,this.CompIdx)};this.getX=function(){return _};this.getY=function(){return o};this.setPos=function(t,e){_=t;o=e};this.getWidth=function(){return u};this.getHeight=function(){return A};this.setWidth=function(t){u=t};this.setSize=function(t,e){u=t;A=e};this.hasFocus=function(){return Y};this.setFocus=function(){if(y)return;var t=Y;Y=true;if(t!=Y&&!y)rt();if(s.caret!=null)s.caret.hide();$t.KillFocusExcept(s,J.CompIdx)};this.killFocus=function(){if(y)return;var t=Y;Y=false;if(t!=Y&&!y)rt()};this.setEnable=function(t){D=t;rt()};this.setEnabled=function(t){D=t;rt()};this.OnKeyEvent=function(t){G=false;if(!D||y||d==0)return false;if(!Y){if(!j)return false}var e=t.keyCode;if(t.type=="keydown"){if(e==Z){if(N)N("enter",this,s.id)}else if(e==Q){if(L>0){L--;lt();rt();if(N)N("change",this,s.id)}G=true}else if(e==q){if(L+1<d){L++;lt();rt();if(N)N("change",this,s.id)}G=true}}if(j)G=true;return G};this.mouseInRect=function(t){if(!D||y||d==0)return false;var e=t.clientX;var r=t.clientY;e=e-s.getBoundingClientRect().left-s.clientLeft+s.scrollLeft;r=r-s.getBoundingClientRect().top-s.clientTop+s.scrollTop;e=JV(e);r=JV(r);e-=_;r-=o;return WH(e,r,0,0,u,A)};this.OnMouseEvent=function(t){M=false;if(!D||y||d==0)return false;var e=t.clientX;var r=t.clientY;e=e-s.getBoundingClientRect().left-s.clientLeft+s.scrollLeft;r=r-s.getBoundingClientRect().top-s.clientTop+s.scrollTop;e=JV(e);r=JV(r);e-=_;r-=o;var i=L;var f=l;var l=WH(e,r,0,0,u,A);if(l&&O!=null&&j&&WH(e,r,T,0,u,A))return O.OnMouseEvent(t);if(t.type=="click"||t.type=="dblclick"){if(!l){this.killFocus();if(f)M=true;return M}if(u!=T&&!WH(e,r,0,0,T,A))return false;L=et(e,r);if(L!=i){lt();rt();if(N!=null){if(j)N("selected",this,s.id);else N("change",this,s.id)}}this.setFocus();if(t.type=="dblclick"&&N!=null)N("dblclick",this,s.id);M=true}else if(t.type=="wheel"){if(u!=T&&!WH(e,r,0,0,T,A))return false;if(t.deltaY<0){C=C-2;M=true}else if(t.deltaY>0){C=C+2;M=true}if(M){if(C+g>d)C=d-g;if(C<0)C=0;rt()}}else if(t.type=="mousemove"){if(WH(e,r,0,0,u,A))M=true}M=l;return M};function tt(t,e,r){if(t=="up"){if(C>0)C--}else if(t=="down"){if(C+g<d)C++}else if(t=="pageup"){if(g<2)C--;else C-=Math.floor(g/2)}else if(t=="pagedown"){if(g<2)C++;else C+=Math.floor(g/2)}else if(t=="thumbmoving"||t=="thumbmoved"){C=e}if(C+g>d)C=d-g;if(C<0)C=0;rt()}function et(t,e){var r=0;for(var i=0;i<F;i++){var f=r+x;if(e>=r&&e<f)break;r=f}var l=C+i;if(l>=d)l=d-1;if(l<0)l=0;return l}this.refresh=function(){rt()};function rt(){if(y){if(O!=null&&!O.isHidden())O.setHidden(true);return}ft(0,0);var t=s.getContext("2d");t.save();t.setTransform(1,0,0,1,0,0);t.fillStyle=K;t.fillRect(_,o,T,A);if(d==0){l();return}t.save();t.beginPath();t.rect(_,o,T,A);t.closePath();t.clip();var e=o;for(var r=0;r<F;r++){var i=C+r;var f=D?k:X;if(i>=d)break;if(i==L){t.fillStyle=f;t.fillRect(_,e+m,T,b);t.fillStyle=K;t.textBaseline="top";t.font=v;t.fillText(E[i],_+H,e+m)}else{t.fillStyle=f;t.textBaseline="top";t.font=v;t.fillText(E[i],_+H,e+m)}e=e+x}t.restore();if(S&&O==null){O=new $t.VScrollBar(s,o,h,false,d,0,g,y,function(t,e){tt(t,e,s.id)});O.setX(_+T);O.setHeight(A);O.setParent(V);O.setName(J.name)}else if(!S&&O!=null){O.delete();O=null}if(O)O.SetThumbPos(C,g);l();function l(){it();t.restore()}}function it(){if(p&&!y)$t.CompDrawBorder(s,_,o,u,A,Y)}function ft(t,e){at();T=u;S=d>g;if(S)T-=h;F=g;if(F*x<A-m)F++}function lt(){at();if(E!=null&&g>=E.length)C=0;else{if(L>=C+g)C=L-g+1;if(L<C)C=L}}function at(){if(U==null)U=My(s,v);b=U.height;x=b+2*m;if(P>0){var t=P<d?P:d;if(t<1)t=1;A=x*t}g=Math.floor(A/x);if(g<1)g=1}};$t.TextBox=function(t,e,r,i,f,l,a,n,c,s,_){this.ObjType="TextBox";this.name="textbox";var o=t;var u=e;var T=r;var A=i;var E=f;var R=l==null?"":nk(l);var L=a;var C=n;var I=c;var d=s;var F=_;var g=true;var P=false;var S=false;var h=false;var O=JV(3);var v;var p;var N;var D=false;var M=null;var G="black";var B="gray";var H="white";var m=[];var w=0;var b=0;var x=-1;var y=0;var W=false;var U=-1;var k=0;var X=false;var K=[];var Y=[];var V=this;var j=8;var J=9;var z=13;var Z=35;var Q=36;var q=37;var $=39;var tt=46;if(R.length>0){x=0;y=R.length;W=false}this.CompIdx=$t.AddComp(o,this);ot();this.getName=function(){return V.name};this.setName=function(t){V.name=t};this.setCallback=function(t){F=t};this.getText=function(){return R};this.setText=function(t){if(t==null)t="";x=-1;W=false;K=[];Y=[];R=t;ot()};this.delete=function(){$t.DeleteComp(o,this.CompIdx)};this.getX=function(){return u};this.getY=function(){return T};this.setPos=function(t,e){u=t;T=e};this.getBorder=function(){return d};this.setBorder=function(t){d=t};this.getWidth=function(){return A};this.getHeight=function(){return E};this.setSize=function(t,e){A=t;E=e;Tt(0,0)};this.setHidden=function(t){D=t;if(!t)ot()};this.setVisible=function(t){V.setHidden(!t)};this.isVisible=function(){return!D};this.hasFocus=function(){return X};this.setFocus=function(){if(D)return;var t=X;X=true;if(t!=X&&!D)ot();et();$t.KillFocusExcept(o,V.CompIdx);if(document.activeElement!=_i.DlgTexarea)iM();if(_i.DlgTextarea!=null){if(_i.DlgTextareaListener!=null){_i.DlgTextarea.removeEventListener("input",_i.DlgTextareaListener);_i.DlgTextareaListener=null}_i.DlgTextarea.addEventListener("input",st);_i.DlgTextareaListener=st}};this.killFocus=function(){if(D)return;var t=X;X=false;if(t!=X&&!D)ot();rt()};function et(){if(D)return;if(w<b)ot();else{var t=m[b];var e=m[w];if(e-t>A-2*O)ot()}if(o.caret.getWidth()!=1||o.caret.getHeight()!=N)o.caret.CreateCaret(1,N);o.caret.position(u+O+m[w]-m[b],v);o.caret.owner=V.ObjType}function rt(){}this.setEnable=function(t){var e=g;g=t;if(e!=g)ot(0,0)};this.setEnabled=function(t){var e=g;g=t;if(e!=g)ot(0,0)};function it(){K.push(R);Y.push(w)}function ft(){if(K.length==0)return;R=K.pop();w=Y.pop();ot();et()}function lt(){if(K.length==0)return;R=K.pop();w=Y.pop()}function at(t){if(x>=0){it();var e=x<y?x:y;var r=x<y?y:x;R=R.substring(0,e)+R.substring(r);x=-1;W=false;if(t)ot();w=e;et()}return true}function nt(t,e){var r=window.clipboardData;if(r==null)r=t.clipboardData;if(r!=null&&x>=0){var i=x<y?x:y;var f=x<y?y:x;r.setData("Text",R.substring(i,f));if(e)at(true);t.preventDefault()}}function ct(t){var e=window.clipboardData;if(e==null)e=t.clipboardData;if(e!=null){it();if(x>=0){at(false);lt()}var r=x<y?x:y;var i=x<y?y:x;var f=e.getData("Text");if(f!=null&&f.length>0){if(x>=0)at();R=R.substring(0,w)+f+R.substring(w);w+=f.length;ot()}t.preventDefault()}}function st(t){var e;if(!_i.UseVirtKeyboard)return false;e=_i.DlgTextarea.value;if(e==null)e="";if(_i.DlgImeStartPos<0)_i.DlgImeStartPos=w;else if(w>_i.DlgImeStartPos){R=cV(R,0,_i.DlgImeStartPos)+R.substring(w)}if(e!="")R=cV(R,0,_i.DlgImeStartPos)+e+R.substring(_i.DlgImeStartPos);w=_i.DlgImeStartPos+e.length;ot();et();if(e.length>1){var r=e.charAt(e.length-1);var i=Uk(e);var f=false;var l="."+wY(13)+wY(10);if(l.indexOf(r)>=0)f=true;else if(e.length>300){l=" ,;";if(l.indexOf(r)>=0)f=true}if(f){_i.DlgImeStartPos=-1;_i.DlgTextarea.value=""}}}this.OnKeyEvent=function(t){S=false;if(!g||!X||D||I)return false;var e=R;var r=t.keyCode;if(t.type=="keypress"||t.type=="keydown"&&r==32){if(_i.UseVirtKeyboard&&document.activeElement==_i.DlgTextarea)return;if(t.ctrlKey||r==z)return true;var i=String.fromCharCode(parseFloat(t.charCode));if(t.type=="keydown"&&r==32)i=" ";it();if(x>=0)at(true);if(w==0)R=i+R;else if(w>=R.length)R=R+i;else R=R.substring(0,w)+i+R.substring(w);ot();w++;et();S=true}else if(t.type=="keydown"){if(_i.UseVirtKeyboard&&document.activeElement===_i.DlgTextarea){if(t.keyCode==8&&_i.DlgTextarea.value.length>0)return;if(t.keyCode==32||t.keyCode==13||t.keyCode==10)return}if(Sa.shiftKey&&!W&&(r==q||r==$||r==Q||r==Z)){x=-1;ot();x=w;y=w;W=true}else if(false&&!Sa.shiftKey&&!t.ctrlKey&&!t.altKey&&x>=0&&r!=tt&&r!=j&&r!=z){if(r==q||r==$){var f=x<y?x:y;var l=x<y?y:x;if(r==q)w=f;else if(r==$)w=l}x=-1;W=false;ot();if(r==q||r==$){et();return true}}if(r==z){S=true;if(F)F("enter",this,o.id)}else if(r==q){if(w>0)w--;et();S=true}else if(r==$){if(w<R.length)w++;et();S=true}else if(r==Q){w=0;et();S=true}else if(r==Z){w=R.length;et();S=true}else if(r==j){if(x>=0)return at(true);if(w>0){it();R=R.substring(0,w-1)+R.substring(w);w--;Tt(0,0);ot();et()}S=true}else if(r==tt){if(x>=0)return at(true);if(w<R.length){it();R=R.substring(0,w)+R.substring(w+1);Tt(0,0);ot();et()}S=true}else if(t.ctrlKey&&r==tc.CHAR_A){x=0;y=R.length;W=false;ot();S=true}else if(t.ctrlKey&&r==tc.CHAR_Z){ft();S=true}else if(t.ctrlKey&&r=="X".charCodeAt(0)){nt(t,true);S=true}else if(t.ctrlKey&&r=="C".charCodeAt(0)){nt(t,false);S=true}else if(t.ctrlKey&&r=="V".charCodeAt(0)){ct(t,false);S=true}if(S&&Sa.shiftKey){y=w;ot()}}if(S&&e!=R&&F!=null)F("change",this,o.id);return S};this.OnMouseEvent=function(t){P=false;if(!g||D)return false;var e=t.clientX;var r=t.clientY;e=e-o.getBoundingClientRect().left-o.clientLeft+o.scrollLeft;r=r-o.getBoundingClientRect().top-o.clientTop+o.scrollTop;e=JV(e);r=JV(r);e-=u;r-=T;if(t.type=="click"){if(!WH(e,r,0,0,A,E)){this.killFocus();return false}var i=U==e&&k==r;if(i&&x==y)i=false;if(i){U=-1}else{if(x>=0){x=-1;W=false;ot()}w=_t(e,r);if(!I){this.setFocus();if(_i.UseVirtKeyboard){iM();et()}}}P=true}else if(t.type=="dblclick"){if(!WH(e,r,0,0,A,E))return false;if(x>=0){x=-1;W=false}if(R.length==0)return true;var f=_t(e,r);var l=R.split("");var a=R.length;var n=0;for(n=f-1;n>=0;n--)if(l[n]==" ")break;x=n+1;var c=false;for(n=f+1;n<a;n++){if(l[n]==" ")c=true;if(c&&l[n]!=" ")break}y=n;W=false;ot();rt()}else if(t.type=="mousedown"){if(!WH(e,r,0,0,A,E))return false;if(!I&&!X)this.setFocus();if(x<0){x=_t(e,r);y=x;W=true;U=-1;P=true}}else if(t.type=="mousemove"){if(x>=0&&W){y=_t(e,r);U=e;k=r;ot();P=true}}else if(t.type=="mouseup"){if(!WH(e,r,0,0,A,E))return false;if(x>=0&&W){W=false;U=e;k=r;P=true}}else if(t.type=="mouseout"||t.type=="mouseover"){if(x>=0&&W){W=false;P=true}}if(X)P=true;return P};this.OnCBEvent=function(t){h=false;if(!g||!X||D)return false;var e=R;if(t.type=="cut")nt(t,true);else if(t.type=="copy")nt(t,false);else if(t.type=="paste")ct(t);if(S&&e!=R&&F!=null)F("change",this,o.id);return h};function _t(t,e){var r=R.length;var i=0;var f=0;if(b>0)f=m[b];if(t<=O)i=b;else if(t>=O+m[r]-f)i=r;else{t-=O;for(var l=b;l<r;l++){if(m[l]-f>t){if(l==0)i=0;else{var a=m[l-1]-f+(m[l]-m[l-1])/2;if(t>=a)i=l;else i=l-1}break}}}return i}this.show=function(){ot()};this.refresh=function(){ot()};this.repaint=function(){ot()};function ot(){if(D)return;Tt(0,0);var t=o.getContext("2d");t.save();t.setTransform(1,0,0,1,0,0);t.fillStyle=H;t.fillRect(u,T,A,E);t.save();t.beginPath();t.rect(u,T,A,E);t.closePath();t.clip();if(x<0||!X){t.fillStyle=g?G:B;t.textBaseline="top";t.font=L;t.fillText(R.substring(b),u+O,v)}else{var e=x;var r=y;if(r<e){var i=e;e=r;r=i}if(e>0&&e>=b){t.fillStyle=g?G:B;t.textBaseline="top";t.font=L;t.fillText(R.substring(b,e),u+O,v)}var f=u+O+m[e]-m[b];var l=u+O+m[r]-m[b];t.fillStyle=g?G:B;t.fillRect(f,v,l-f,N);t.fillStyle=H;t.textBaseline="top";t.font=L;t.fillText(R.substring(e,r),f,v);if(e<R.length){f=u+O+m[r]-m[b];t.fillStyle=g?G:B;t.textBaseline="top";t.font=L;t.fillText(R.substring(r),f,v)}}t.restore();ut();t.restore()}function ut(){if(d&&!D)$t.CompDrawBorder(o,u,T,A,E,X,true,g)}function Tt(t,e){if(M==null)M=My(o,L);N=M.height;v=T+(E-M.height)/2;if(v<=T)v=T+1;m=[];var r=o.getContext("2d");r.font=L;m.push(0);for(var i=0;i<R.length;i++){var f=EH(r,R.substring(0,i+1)).width;m.push(f)}if(w<0)w=0;if(w>R.length)w=R.length;if(b<0)b=0;if(b>R.length)b=R.length;if(w<b)b=w;else{var l=m[w];var a=m[b];var n=0;if(w<R.length)n=m[w+1]-m[w];if(l-a+n>A-2*O){a=l+n-(A-2*O);for(b=0;b<w;b++){if(m[b]>=a)break}}}}};$t.VScrollBar=function(t,e,r,i,f,l,a,n,c){this.ObjType="VScrollBar";this.name="vscrollbar";var s=t;var _=0;var o=-1;var u=e;var T=r;var A=i;var E=f;var R=l;var L=a;var C=false;var I=0;var d=0;var F=0;var g=0;var P=0;var S=0;var h=0;var O=-1;var v=0;var p=0;var N=c;var D=true;var M=false;var G=false;var B=n;var H=null;var m=null;var w;var b;var x;var y=null;var W=this;var U=0;var k=1;var X=2;var K=3;var Y=4;var V=U;var j="#f0f0f0";var J="#f0f0f0";var z="#dadada";var Z="#cdcdcd";var Q="#a6a6a6";var q="#c0c0c0";this.CompIdx=$t.AddComp(s,this);this.getName=function(){return W.name};this.setName=function(t){W.name=t};this.delete=function(){$t.DeleteComp(s,this.CompIdx)};this.getX=function(){return _};this.getY=function(){return u};this.setPos=function(t,e){_=t;u=e};this.getWidth=function(){return T};this.getHeight=function(){return h};this.isHidden=function(){return B};this.setHidden=function(t){B=t;if(!t)tt()};this.setVisible=function(t){W.setHidden(!t)};this.isVisible=function(){return!B};this.hasFocus=function(){return false};this.setParent=function(t){H=t};this.setX=function(t){o=t;A=false};this.setHeight=function(t){O=t;A=false};this.getText=function(){return"vscroll"};this.OnKeyEvent=function(t){return G};this.OnMouseEvent=function(t){M=false;if(!D||B)return false;var e=t.clientX;var r=t.clientY;e=e-s.getBoundingClientRect().left-s.clientLeft+s.scrollLeft;r=r-s.getBoundingClientRect().top-s.clientTop+s.scrollTop;e=JV(e);r=JV(r);var i=rt(e,r);if(i!=U)M=true;if(t.type=="mouseover"||t.type=="mousemove"){var f=WH(e,r,_,u,T,h);if(!f&&!C)return false;s.style.cursor="default";var l=false;if(C){var a=d+(r-I);if(a>=v+p-P)a=v+p-P-1;if(a!=g){R=(a-v)*E/p;R=Math.ceil(R);l=true}}if(i!=V||l)tt(e,r);if(l&&N!=null)N("thumbmoving",R,s.id)}else if(t.type=="click"){if(i!=U&&H!=null&&H.setFocus)H.setFocus();if(false&&N!=null){if(i==K)N("up",R,s.id);else if(i==Y)N("down",R,s.id);else if(i==k){if(r<g)N("pageup",R,s.id);else N("pagedown",R,s.id)}}w=0}else if(t.type=="mousedown"&&i==X){if(P<p&&P>0){C=true;d=g;I=r;F=R;w=0}}else if(t.type=="mousedown"){if(N!=null){b="";if(i==K)b="up";else if(i==Y)b="down";else if(i==k){if(r<g)b="pageup";else b="pagedown"}if(b!=""){N(b,R,s.id);m=window.setInterval($,100);w=i;x=R;ScrollEventMouseX=e;ScrollEventMouseY=r}else w=0}}else if((t.type=="mouseup"||t.type=="mouseout"||t.type=="mouseleave")&&C){if(F!=R&&N!=null)N("thumbmoved",R,s.id);w=0;C=false}if(m!=null&&w==0){window.clearInterval(m);m=null;b=""}return M};function $(){if(b!="")N(b,x,s.id)}this.setEnable=function(t){D=t;if(!D){L=0;R=0;tt(0,0)}};this.setEnabled=function(t){W.setEnable(t)};this.SetThumbPos=function(t,e){R=t;L=e;tt(0,0)};this.refresh=function(){tt(0,0)};function tt(t,e){if(B)return;et(t,e);var r=s.getContext("2d");r.save();r.setTransform(1,0,0,1,0,0);r.fillStyle=j;r.fillRect(_,u,T,h);r.fillStyle=Z;if(V==X)r.fillStyle=Q;else if(V==k)r.fillStyle=q;r.fillRect(_,g,T,P);r.fillStyle=V==K?z:J;r.fillRect(_,u,T,S);var i=_+T/2;var f=u+S/3;var l=i-T/4;var a=f+T/4;var n=i+T/4;var c=a;r.beginPath();r.moveTo(l,a);r.lineTo(i,f);r.lineTo(n,c);r.closePath();r.strokeStyle="black";r.lineWidth=JV(1);r.stroke();r.fillStyle=V==Y?z:J;r.fillRect(_,u+S+p,T,S);i=_+T/2;f=u+h-S/3;l=i-T/4;a=f-T/4;n=i+T/4;c=a;r.beginPath();r.moveTo(l,a);r.lineTo(i,f);r.lineTo(n,c);r.closePath();r.strokeStyle="black";r.lineWidth=JV(1);r.stroke();if(A){r.fillStyle=j;r.fillRect(_+JV(1),u+h+JV(1),T-JV(1),T-JV(1))}r.restore()}function et(t,e){_=s.width-T;if(o>=0)_=o;h=s.height-u-(A?T:0);if(O>=0)h=O;S=T*1.2;v=u+S;p=h-2*S;if(R<0)R=0;if(L<0)L=0;if(R>=E)R=E-1;if(L>E-R)L=E-R;P=p*L/E;if(P<=0)P=0;g=v+p*R/E;if(P==0)g=v;V=rt(t,e)}function rt(t,e){var r=U;if(WH(t,e,_,u,T,h)){if(WH(t,e,_,u,T,S))r=K;else if(WH(t,e,_,u+S+p,T,S))r=Y;else if(WH(t,e,_,g,T,P))r=X;else r=k}return r}};$t.HScrollBar=function(t,e,r,i,f,l,a,n,c){this.ObjType="HScrollBar";var s=t;var _=0;var o=e;var u=r;var T=i;var A=f;var E=l;var R=a;var L=false;var C=0;var I=0;var d;var F=0;var g=0;var P=0;var S=0;var h=0;var O=0;var v=c;var p=true;var N=false;var D=false;var M=n;var G=null;var B;var H;var m;var w=null;var b=this;var x=0;var y=1;var W=2;var U=3;var k=4;var X=x;var K="#f0f0f0";var Y="#f0f0f0";var V="#dadada";var j="#cdcdcd";var J="#a6a6a6";var z="#c0c0c0";this.CompIdx=$t.AddComp(s,this);this.getName=function(){return"hscroll"};this.delete=function(){$t.DeleteComp(s,this.CompIdx)};this.getX=function(){return BoxX};this.getY=function(){return BoxY};this.setPos=function(t,e){o=t;_=e};this.getWidth=function(){return S};this.getHeight=function(){return u};this.setHidden=function(t){M=t;if(!t)Q(0,0)};this.setVisible=function(t){b.setHidden(!t)};this.isVisible=function(){return!M};this.hasFocus=function(){return false};this.getText=function(){return"hscrollbar"};this.OnKeyEvent=function(t){return D};this.OnMouseEvent=function(t){N=false;if(!p||M)return false;var e=t.clientX;var r=t.clientY;e=e-s.getBoundingClientRect().left-s.clientLeft+s.scrollLeft;r=r-s.getBoundingClientRect().top-s.clientTop+s.scrollTop;e=JV(e);r=JV(r);var i=$(e,r);if(i!=x)N=true;if(t.type=="mouseover"||t.type=="mousemove"){var f=WH(e,r,o,_,S,u);if(!f)return false;s.style.cursor="default";var l=false;if(L){var a=I+(e-C);if(a>=h+O-g)a=h+O-g-1;if(a!=F){E=(a-h)*A/O;E=Math.ceil(E);l=true}}if(i!=X||l)Q(e,r);if(l&&v!=null)v("thumbmoving",E,s.id)}else if(t.type=="click"){if(false&&v!=null){if(i==U)v("up",E,s.id);else if(i==k)v("down",E,s.id);else if(i==y){if(e<F)v("pageup",E,s.id);else v("pagedown",E,s.id)}}B=0}else if(t.type=="mousedown"&&i==W){if(g<O&&g>0){L=true;I=F;d=E;C=e;B=0}}else if(t.type=="mousedown"){if(v!=null){H="";if(i==U)H="up";else if(i==k)H="down";else if(i==y){if(e<F)H="pageup";else H="pagedown"}if(H!=""){v(H,E,s.id);G=window.setInterval(Z,100);B=i;m=E}}}else if((t.type=="mouseup"||t.type=="mouseout"||t.type=="mouseleave")&&L){if(d!=E&&v!=null)v("thumbmoved",E,s.id);L=false;B=0}if(G!=null&&B==0){window.clearInterval(G);G=null;H=""}return N};function Z(){if(H!="")v(H,m,s.id)}this.setEnable=function(t){p=t;if(!p){R=0;E=0;Q(0,0)}};this.setEnabled=function(t){b.setEnable(t)};this.SetThumbPos=function(t,e){E=t;R=e;Q(0,0)};this.refresh=function(){Q(0,0)};function Q(t,e){if(M)return;q(t,e);var r=s.getContext("2d");r.save();r.setTransform(1,0,0,1,0,0);r.fillStyle=K;r.fillRect(o,_,S,u);r.fillStyle=j;if(X==W)r.fillStyle=J;else if(X==y)r.fillStyle=z;r.fillRect(F,_,g,u);r.fillStyle=X==U?V:Y;r.fillRect(o,_,P,u);var i=_+u/2;var f=o+P/3;var l=i-u/4;var a=f+u/4;var n=i+u/4;var c=a;r.beginPath();r.moveTo(a,l);r.lineTo(f,i);r.lineTo(c,n);r.closePath();r.strokeStyle="black";r.lineWidth=JV(1);r.stroke();r.fillStyle=X==k?V:Y;r.fillRect(o+P+O,_,P,u);i=_+u/2;f=o+S-P/3;l=i-u/4;a=f-u/4;n=i+u/4;c=a;r.beginPath();r.moveTo(a,l);r.lineTo(f,i);r.lineTo(c,n);r.closePath();r.strokeStyle="black";r.lineWidth=JV(1);r.stroke();r.restore()}function q(t,e){_=s.height-u;S=s.width-o-(T?u:0);P=u*JV(1.2);h=o+P;O=S-2*P;if(E<0)E=0;if(R<0)R=0;if(E>=A)E=A-1;if(R>A-E)R=A-E;g=O*R/A;if(g<=0)g=0;F=h+O*E/A;if(g==0)F=h;X=$(t,e)}function $(t,e){var r=x;if(WH(t,e,o,_,S,u)){if(WH(t,e,o,_,P,u))r=U;else if(WH(t,e,o+P+O,_,P,u))r=k;else if(WH(t,e,F,_,g,u))r=W;else r=y}return r}};$t.CompDrawBorder=function(t,e,r,i,f,l,a,n){if(typeof a=="undefined")a=true;if(n==undefined)n=true;var c=t.getContext("2d");var s=0;if(a){s=l?AD:uD;if(!n)s=RD;XH(c,e,r,i,f,s,JV(1))}else{s=l?AD:uD;if(!n)s=RD;c.strokeStyle=s;c.lineWidth=JV(1);c.beginPath();c.moveTo(e+i,r);c.lineTo(e,r);c.lineTo(e,r+f);c.closePath();c.stroke();s=l?ED:TD;c.strokeStyle=s;c.lineWidth=JV(1);c.beginPath();c.moveTo(e+i,r);c.lineTo(e+i,r+f);c.lineTo(e,r+f);c.closePath();c.stroke()}};$t.TerSetEvent=function(t,e){if(typeof t!="string"){console.log("invalid parameter, name: ",t);console.trace()}if(typeof e!="function"){console.log("invalid parameter, callback: ",e);console.trace()}if(Tk(t,"Action")==0)XP=e;else if(Tk(t,"Preprocess")==0)KP=e;else if(Tk(t,"SetUserField")==0)YP=e;else if(Tk(t,"TextDrop")==0)VP=e;else if(Tk(t,"TextDrag")==0)jP=e;else if(Tk(t,"ReplaceLastWord")==0)JP=e;else if(Tk(t,"CreateEmbeddedControl")==0)zP=e;else if(Tk(t,"PreHtmlAddon")==0)ZP=e;else if(Tk(t,"PageCount")==0)QP=e;else if(Tk(t,"Modified")==0)qP=e;else if(Tk(t,"UpdateStatusbar")==0)$P=e;else if(Tk(t,"UpdateToolbar")==0)tS=e;else if(Tk(t,"Hypertext")==0)eS=e;else if(Tk(t,"MergeData")==0)rS=e;else if(Tk(t,"PageSizeChanging")==0)iS=e;else if(Tk(t,"FireClosing")==0)_S=e;else if(Tk(t,"PostPaint")==0)lS=e;else if(Tk(t,"SpellWordReplaced")==0)aS=e;else if(Tk(t,"DrawControl")==0)nS=e;else if(Tk(t,"DoDNS")==0)cS=e;else if(Tk(t,"OpenFile")==0)sS=e;else if(Tk(t,"ControlCreated")==0)oS=e;else if(Tk(t,"ResolveImagePath")==0)uS=e};function LD(t,e,r){if(XP!=null)XP(_i,e,r)}function CD(t,e,r){if(KP!=null)KP(_i,e,r)}function ID(t,e,r){if(YP!=null)YP(_i,e,r)}function dD(t,e){if(FireTextDropEvent!=null)return FireTextDropEvent(_i,e);else return false}function FD(t,e){if(jP!=null)jP(_i,e)}function gD(t,e){oF=false;SP="";if(JP!=null)JP(_i,e);oF=ev.replace;SP=ev.NewText}function PD(t,e,r){if(zP!=null)return zP(_i,e,r)}function SD(t,e,r){if(ZP!=null)ZP(_i,e,r)}function hD(t){if(QP!=null)QP(_i)}function OD(t){if(qP!=null)qP(_i)}function vD(t){if($P!=null)$P(_i)}function pD(t){if(tS!=null)tS(_i)}function ND(t,e){var r=false;if(eS!=null)r=eS(_i,e.text,e.code,e.DoubleClick);e.used=r}function DD(t,e){var r="";if(rS!=null)r=rS(_i);return r}function MD(t,e){if(iS!=null)return iS(_i,e);else return e}function GD(t){if(_S!=null)_S(_i)}function BD(t,e){if(lS!=null)lS(_i,e)}function HD(t,e,r,i){if(aS!=null)aS(_i,e,r,i)}function mD(t,e,r,i,f,l,a){if(nS!=null)return nS(_i,e,r,i,f,l,a)}function wD(t,e,r,i){if(cS!=null)return cS(_i,e,r,i)}function bD(t,e){if(sS!=null)sS(_i,e)}function xD(t){if(oS!=null)oS(_i)}function yD(t,e){if(uS!=null)return uS(_i);else return e}function WD(){return false}function UD(t,e,r,i){var f=0;if(t==tc.TER_ACTION)LD(this,e,r);if(t==tc.TER_PREPROCESS)CD(this,e,r);if(t==tc.TER_MODIFIED)OD(this);if(t==tc.TER_UPDATE_STATUSBAR)vD(this);if(t==tc.TER_UPDATE_TOOLBAR)pD(this);if(t==tc.TER_CLOSE)GD(this);if(t==tc.TER_USER_FIELD1)ID(this,e,r);return f}function kD(t){ND(this,t);return t.used}function XD(t){OP="";DD(this,t);return OP}function KD(){vX(Qt,le,ae);NX(Qt,le,ae);Dr=false}function YD(t){if(VR)cq();if(Ka)HB();if(QE){uA=tc.HILIGHT_OFF;QE=false}switch(HJ(t)){case tc.SB_TOP:zm();break;case tc.SB_BOTTOM:Zm();break;case tc.SB_LINEDOWN:Xm();break;case tc.SB_LINEUP:Um();break;case tc.SB_PAGEDOWN:wm(false);break;case tc.SB_PAGEUP:mm(false);break;case tc.SB_THUMBPOSITION:SB(t);break;case tc.SB_THUMBTRACK:if(Nj(Zh&tc.TFLAG2_VERT_THUMB_TRACK)){aO|=tc.TOFLAG_CONTINUOUS_SCROLL;SB(t);oj(tc.TOFLAG_CONTINUOUS_SCROLL)}else if(Wr&&!Ru)hB(Ti,mJ(t));break;case tc.SB_ENDSCROLL:if(Sr&&it!=null||No)cG();hr=false;break;default:break}}function VD(t){if(VR)cq();if(Ka)HB();if(QE){uA=tc.HILIGHT_OFF;QE=false}switch(HJ(t)){case tc.SB_LINERIGHT:ym(false);break;case tc.SB_LINELEFT:xm(false);break;case tc.SB_PAGERIGHT:ym(true);break;case tc.SB_PAGELEFT:xm(true);break;case tc.SB_THUMBPOSITION:if(Ru)W0(mJ(t));else Wm(tc.CHAR_T,mJ(t));break;default:break}}_i.TerEnableKeyInput=function(t){var e=nf;nf=t;return e};function jD(t,e){if(lf){var r=3,i;Et=Tt;if(!cf){Vv(true);cG()}for(i=1;i<=3;i++)window.setTimeout(f,500*i)}function f(){if(Ti!=null&&Et==Tt){_i.TerEngageCaret(true);lG(Ti)}}}function JD(t,e){if(_i.InSafari)Tt=Mt}function zD(t,e){var r;var i;var f,l;var a=false;var n=0;var c=0;if(Nr||!nf)return false;var s=document.getElementById(e);if(s==null)return;var _=$t.GetTerData(e);if(!_.UseVirtKeyboard)return false;if(fe==Rt)fe=fG();if(fe==Rt)Vv(true);if(mS[tc.CURSOR_HANDLE_IDX]!=null)mS[tc.CURSOR_HANDLE_IDX].style.visibility="hidden";if(fe!=fG())lG(Ti);cO|=tc.TOFLAG3_IN_VIRT_INPUT;_.TerEngageCaret(true);if(aL<0){_L=uE;sL=0;oL=""}n=_L;if(uA!=tc.HILIGHT_OFF){uE=n;_.TerDeleteBlock(true)}Sa=tc.clone(t,true);Sa.shiftKey=Sa.ctrlKey=Sa.altKey=false;va=(new Date).getTime();f=l=_.VirtTextarea.value;PreserveChars=sL;if(true||sL>=f.length){if(aL<0)PreserveChars=0;else if(l==oL+" ")PreserveChars=oL.length;else{r=aL+PreserveChars;var o=r;r=ZD(r);if(r<o){PreserveChars=r-aL;if(PreserveChars<0)PreserveChars=0}}}if(PreserveChars>=f.length){PreserveChars=f.length;f=""}else if(PreserveChars>0)f=f.substring(PreserveChars);if(f==null)f="";r=Lq(br,jt);if(aL<0)aL=r;else if(r>aL+PreserveChars){_.SelectTerText(aL+PreserveChars,-1,r,-1,false);uE=n;var u=Oc;_.TerDeleteBlock(f==""?true:false);if(_.VirtTextarea.value!=l)_.VirtTextarea.value=l;a=true;Oc=u}if(f!=""){uE=n;_.InsertTerText(f,true);a=true}nL=Lq(br,jt);oL=l;if(f.length>1){var T=f.charAt(f.length-1);var A=Uk(f);var E=false;i="."+wY(13)+wY(10);if(i.indexOf(T)>=0)E=true;else if(f.length>300){i=" ,;";if(i.indexOf(T)>=0)E=true}if(E){aL=-1;sL=0;oL="";_.VirtTextarea.value=""}}else if(f.length==1&&f.charCodeAt(0)==10){aL=-1;sL=0;oL="";_.VirtTextarea.value=""}if(a){_.TerTextPosToPix(tc.REL_TEXT_BOX,br,jt);var R=td+Ft;if(R<=At*9/10){Ft=0;BG();cG()}}if(a){_.TerTextPosToPix(tc.REL_TEXT_BOX,br,jt);var L=ed;var C=Tt-ui[br].height;if(L>C){Gt+=L-C;BG();cG()}FN(true);pX();yJ(false,true,0,true);_z(true)}Tj(tc.TOFLAG3_IN_VIRT_INPUT);return true}function ZD(t){var e,r,i;var f=" ,;.";Cq(t);e=i=PC;r=SC;for(;e>=0;e--){if(e<i)r=ui[e].len-1;var l=ui[e].txt;for(;r>=0;r--){var a=l[r];var n=String.fromCharCode(a);if(f.indexOf(n)>=0)break}if(r>=0)break;if(e==0)break}r++;if(r>=ui[e].len&&e+1<Ri){r=0;e++}t=Lq(e,r);PC=e;SC=r;return t}function QD(){return true}function qD(){if(Nj(cO&tc.TOFLAG3_IN_VIRT_INPUT)||_i.VirtTextarea==null)return true;aL=-1;sL=0;oL="";_i.VirtTextarea.value="";return true}function $D(t){var e=t.charCode;if(oi.ReadOnly&&!ww(false,false))return;if(Ru)return;if(_i.UseVirtKeyboard)return;if(uA!=tc.HILIGHT_OFF&&(OA||Bh)&&!Ua){oV();return}if(!zR&&sq())_q();if(!VR&&!Ru)nq(0);if(Ka)HB();if(e==tc.ESCAPE){if(_h>=0)jN();else if(Ah){Ah=false;eq(ha,true)}}else if(e>26){if(DX(tc.WM_CHAR,e,0))return;jH(e);NX(tc.WM_CHAR,e,0)}return}function tM(t){if(DX(tc.WM_KEYUP,t,0))return;if(Sa.shiftKey){OA=false;GA=false;if(uA==tc.HILIGHT_CHAR)vB();if(!OA&&sA==_A&&TA==AA)uA=tc.HILIGHT_OFF}if(t.ctrlKey){if(Bf)$j(tc.ID_PARA_LTR_KEY);else if(Hf)$j(tc.ID_PARA_RTL_KEY);Bf=Hf=false}NX(tc.WM_KEYUP,t,0)}function eM(t){var e;if(_i.UseVirtKeyboard&&document.activeElement===_i.VirtTextarea){if(t.keyCode==8&&_i.VirtTextarea.value.length>0)return;if(t.keyCode==32||t.keyCode==13||t.keyCode==10)return}Bf=t.location==1||t.keyLocation==1;Hf=t.location==2||t.keyLocation==2;var r=t.keyCode;if(DX(tc.WM_KEYDOWN,t,0))return;var f=t.ctrlKey;if(!f&&vS&&t.metaKey)f=true;if(!f&&!t.altKey){if(r>=tc.CHAR_A&&r<=tc.CHAR_Z)return;else if(r>=tc.CHAR_0&&r<=tc.CHAR_9)return;else if(r>=144)return true}var l=0;var a=tc.CTRL_MASK;if(!vS&&t.ctrlKey)l|=a;if(vS&&t.metaKey)l|=a;if(Sa.shiftKey)l|=tc.SHIFT_MASK;if(t.altKey)l|=tc.ALT_MASK;if(_i.UseVirtKeyboard)l=0;for(i=0;i<hh;i++){if(Fh[i]==r&&gh[i]==l&&Ch[i]){var n=true;if((zh&tc.TFLAG_DISABLE_ACCEL)!=0){e=Ph[i];var c,s;var _=[tc.ID_PGUP,tc.ID_PGDN,tc.ID_UP,tc.ID_DOWN,tc.ID_LEFT,tc.ID_RIGHT,tc.ID_DEL,tc.ID_BACK_SPACE,tc.ID_TAB,tc.ID_SPACE,tc.ID_BACK_TAB,tc.ID_LINE_BEGIN,tc.ID_LINE_END,tc.ID_FILE_BEGIN,tc.ID_FILE_END,tc.ID_PREV_WORD,tc.ID_NEXT_WORD,tc.ID_RETURN];if(_.indexOf(e)<0)n=false}if(n)break}}if(i==hh)return false;e=Ph[i];if(e==tc.ID_CUT||e==tc.ID_COPY||e==tc.ID_PASTE)return;t.preventDefault();$j(e);NX(tc.WM_KEYDOWN,t,0)}function rM(t){if(_i==null||!oi.open||pr)return;if(DX(tc.WM_SETFOCUS,t,0))return;if(dr)Ex(Ti);if(JR&&!VR&&jR)nq(-1);_q();aO|=tc.TOFLAG_NO_RESET_FONT;Ua=true;if(QE&&!JE){XM()}if(qE&&!zE){KM()}JR=false;NX(tc.WM_SETFOCUS,t,0);if(lf)iM()}_i.TerShowKeyboard=function(){if(_i.UseVirtKeyboard)lf=true;_i.TerSetFocus()};_i.TerResetKeyboard=function(){aL=-1;_i.cvs.terdata.VirtTextarea.value="";sL=0;oL=""};function iM(){var t=document.getElementById(te);if(_i.UseVirtKeyboard&&t!=null){if(_i.DlgLevel==0||_i.DlgTextarea==null){var e=Lq(br,jt);var r=$w();if(e!=nL){aL=-1;t.terdata.VirtTextarea.value="";sL=0;oL=""}else if(cL!=r){sL=t.terdata.VirtTextarea.value.length;cL=r}t.terdata.VirtTextarea.focus({preventScroll:true})}else{_i.DlgImeStartPos=-1;_i.DlgTextarea.value="";_i.DlgTextarea.focus({preventScroll:true})}}}function fM(t){if(_i==null||!oi.open||pr)return;if(DX(tc.WM_KILLFOCUS,t,0))return;if(hn){hn=false;cG()}jR=VR;JR=true;if(VR)cq();if(Ka)HB();Aq();if(JE){XM()}if(zE){KM()}NX(tc.WM_KILLFOCUS,t,0)}function lM(t){if((t.buttons&1)!=0)return tc.BUTTON_LEFT;else if((t.buttons&2)!=0)return tc.BUTTON_RIGHT;else if((t.buttons&4)!=0)return tc.BUTTON_MIDDLE;else return 0}function aM(t){var e;var r=!oi.ReadOnly;e=JV(t.offsetY);e=(e<<16)+JV(t.offsetX);var i=lM(t);Oa=i;lf=false;if(wj(t.offsetX,t.offsetY))return;if(eN(t.offsetX,t.offsetY,true))return;if(hn&&sN(t.offsetX,t.offsetY))return;if(Ri==1&&ui[0]==null)return;if(KE<0&&If!=null&&t.button==1&&uA!=tc.HILIGHT_OFF){var f=DnDConstants.tc.ACTION_COPY_OR_MOVE;if(oi.ReadOnly||wN(false,true)&&Dj(qh&tc.TFLAG4_FULL_DRAG_PROT_TEXT))f=DnDConstants.tc.ACTION_COPY;return}if(i==tc.BUTTON_LEFT||i==tc.BUTTON_RIGHT){if(Ka)HB();if(Nj(aO&tc.TOFLAG_SET_FOCUS))return;var l=i==tc.BUTTON_LEFT||Dj(iO&tc.TFLAG9_ENABLE_POPUP_MENU);if(l&&!LM(t,i,e))return;ue=0;ef=false;if(KE>=0)return;if(i==tc.BUTTON_RIGHT){if(ei){ei=false;rv=iv}if(_4()&&E4(t)&&uA==tc.HILIGHT_OFF){iv=rv;rv=null;ei=true}if(false&&r){$Q(t,true);if(Ir&&KE<0)hX(lM(t),e,t);KE=-1;t.preventDefault()}}}else if(i==tc.BUTTON_MIDDLE){if(Ka)HB()}}function nM(t){var e;if(eN(t.offsetX,t.offsetY,false))return;e=JV(t.offsetY);e=(e<<16)+JV(t.offsetX);var r=lM(t);r=Oa;if(KE>=0&&XE[KE].InUse){SM(e,true);KE=-1;Ua=true;eq(t,false);cG();return}if(r==tc.BUTTON_LEFT){if(uA!=tc.HILIGHT_OFF&&Ua&&Tf<=1)LM(t,lM(t),e);if(Nj(aO&tc.TOFLAG_SET_FOCUS)){oj(tc.TOFLAG_SET_FOCUS);return}OA=Bh=MA=false;NB();if(!OA&&sA==_A&&TA==AA&&!Xr){uA=tc.HILIGHT_OFF;if(Om(br,jt))cG()}if(uA==tc.HILIGHT_CHAR&&!Xr)vB();Ua=true;if(KE>=0){cG();KE=-1}else if(Xr&&!Vr)IM(JV(t.offsetX),JV(t.offsetY));else if(ka&&uA!=tc.HILIGHT_OFF&&sA==_A&&TA==AA){uA=tc.HILIGHT_OFF;cG()}else if(_h>=0){_i.TerPaintFormat(_h,oh,true);if(!Th)jN()}else if(Ah){_i.TerSetHilightColor(false,Eh,false,true)}else if(uA!=tc.HILIGHT_OFF&&!JE){Oc=-1;cG()}eq(t,false);if(Nj(aO&tc.TOFLAG_NO_RESET_FONT))oj(tc.TOFLAG_NO_RESET_FONT);else Oc=-1;if(uA!=tc.HILIGHT_OFF)FN(true)}else if(r==tc.BUTTON_RIGHT){var i=false;if(Nj(iO&tc.TFLAG9_SHOW_FIELD)&&gw(JV(t.offsetX),JV(t.offsetY),true))return;if(Dj(eO&tc.TFLAG7_NO_SPELLER_POPUP)&&_4()&&uA==tc.HILIGHT_OFF){i=R4(t)}if(!i&&Nj(iO&tc.TFLAG9_ENABLE_POPUP_MENU))_i.TerShowPopupMenu(Da,Ma)}}function cM(t){var e;e=JV(t.offsetY);e=(e<<16)+JV(t.offsetX);if(Uj(t.offsetX,t.offsetY)){pL=null;return}if(rN(t.offsetX,t.offsetY))return;if(hn&&cN(t.offsetX,t.offsetY))return;var r=lM(t);if(Ka){BB(e,false);if(hasFocus())eq(t,false);Si=false;return}if(Ua||Xr){if(true||hasFocus()||vh)eq(t,false);if(Xr){if(Vm())return}if(Ua&&!Xr&&KE<0)mB(t,e);Si=false;return}if(r==tc.BUTTON_LEFT||r==tc.BUTTON_RIGHT||r==tc.BUTTON_MIDDLE){if(KE>=0)SM(e,false);else if(!RM(t)){OB(t,lM(t),e,false);if(!Ua&&KE>=0)KE=-1}}}function sM(t){if(!_i.TerEditComment(true,-1,null,null,null,true)&&ya==tc.SPACE&&Xa)oK()}function _M(t){var e;e=JV(t.offsetY);e=(e<<16)+JV(t.offsetX);if(VR)cq();if(Ka)HB();if(QE){uA=tc.HILIGHT_OFF;QE=false}Qt=tc.WMTER_MOUSEWHEEL;if(t.deltaY<0)Um();else Xm();Qt=0}function oM(t){jr=true}function uM(t){jr=false;if(Vr){var e,r;if(oi.PageMode&&Gt!=Ve){Gt=Ve;BG()}Cq(Ye);e=PC;r=SC;jt=r;Iq(e+1)}}function TM(t){var e;var r;e=t.getLocation();r=e.getY();r=r<<16;r=r+e.getX();$Q(ha,false);jr=true;Rq(t);if(e.getY()>rt.bottom-20)Xm();else if(e.getY()>rt.bottom-10)wm(false);else if(e.getY()<rt.top+20)Um();else if(e.getY()<rt.top+10)mm(false);if(Nj(eO&tc.TFLAG7_INT_DROP_MOVE)&&Vr)t.acceptDrag(DnDConstants.tc.ACTION_MOVE);else if(Nj(eO&tc.TFLAG7_EXT_DROP_COPY)&&!Vr)t.acceptDrag(DnDConstants.tc.ACTION_COPY);else t.acceptDrag(t.getDropAction());if(oi.ReadOnly||!Lm(Da,Ma))t.acceptDrag(DnDConstants.tc.ACTION_NONE);FD(_i,t)}function AM(t){gM(t);jr=false}function EM(t,e){if(!oi.open)return;if(t==tc.TIMER_REPAGE&&Dj(Zh&tc.TFLAG2_IGNORE_TIMER)){if(Dj(Zh&tc.TFLAG2_NO_AUTO_REPAGE))yJ(true,false,0,true)}else if(t==tc.TIMER_HILIGHT){if(!RM(ha))OB(ha,0,0,true)}else if(t==tc.TIMER_EVAL){if(rp())AH();else clearInterval(il)}else if(t==tc.TIMER_WHEEL_UP||t==tc.TIMER_WHEEL_DOWN){if(Ka){if(t==tc.TIMER_WHEEL_UP)Um();else Xm()}}else if(t==tc.TIMER_MOUSE_STOP)wB();else if(t>=tc.TIMER_ANIM&&Dj(Zh&tc.TFLAG2_IGNORE_TIMER))TH(t);return}function RM(t){var e=2e3;return t.timeStamp-IA<e}function LM(t,e,r){var i;var f;var l;var a=Dj(Qh&tc.TFLAG3_NO_MOUSE_SEL);var n=false;var c=!oi.ReadOnly;var s;if(!_i.HasFocus){_i.cvs.focus({preventScroll:true});n=_i.cvs===document.activeElement}else if(false&&zR&&!ZR&&_l&&_i.dialog==null){_i.caret.hide();_i.caret.position(_i.caret.CurX,_i.caret.CurY)}if(zR&&!ZR&&_l&&_i.dialog==null){if(!_i.caret.visible)_i.caret.position(_i.caret.CurX,_i.caret.CurY)}El=false;Kr=false;$Q(t,true);if(ya!=tc.SPACE&&Da>=0&&Da<Ri){f=ib(Da,Ma);if(xs[f].FrameType!=tc.PFRAME_NONE){ya=tc.SPACE;if(VR)cq()}}if(!n&&(Da!=br||Ma!=jt))Oc=-1;else aO|=tc.TOFLAG_NO_RESET_FONT;if(Ir){if(c&&Dj(eO&tc.TFLAG7_DISABLE_RULER)){if(KE<0||XE[KE].type==tc.DRAG_TYPE_TAB_TYPE)hX(e,r,t)}}else if(ya==tc.SPACE){var _=QE;QE=qE=false;if(a){if(Bh)g8(Da,true,true);else if(uA==tc.HILIGHT_CHAR){if(Sa.shiftKey)OA=true;else{if(KE<0){if(e==tc.BUTTON_LEFT){Yr=false;if(false&&gm()){}if(!Kr&&!Xr&&!Vr){uA=tc.HILIGHT_OFF;MA=false;if(!_)cG()}}else if(e==tc.BUTTON_RIGHT){var o=Lq(sA,TA);var u=Lq(_A,AA);var T=Lq(Da,Ma);if(o>u){o=WY(o,u);u=JC}if(T<o||T>=u){uA=tc.HILIGHT_OFF;MA=false;if(!_)cG()}}if(document.activeElement!==_i.VirtTextarea&&!oi.ReadOnly)lf=true;wS=true}else{if(XE[KE].type==tc.DRAG_TYPE_CELL||XE[KE].type==tc.DRAG_TYPE_ROW_INDENT)B6(tc.IDC_TABLE_SEL_ROWS);XE[KE].TextHilighted=uA!=tc.HILIGHT_OFF;uA=tc.HILIGHT_OFF;GA=false}}}else if(uA==tc.HILIGHT_OFF&&Sa.shiftKey&&KE<0&&!RM(t)){uA=tc.HILIGHT_CHAR;if(VR){sA=br;TA=jt}else{var A,E;Cq(lL);A=PC;E=SC;sA=A;TA=E}_A=Da;AA=Ma;OA=true}}if(Da>=Ri)$Q(t,true);if(KE<0){if(br!=Da||jt!=Ma){if(JE)XM();if(zE)KM();$M(tc.DRAG_TYPE_SCR_FIRST,tc.DRAG_TYPE_SCR_LAST)}jt=Ma;f=ib(Da,jt);l=Om(Da,jt);if(l)MT=Nj(Zh&tc.TFLAG2_CURSOR_BEF_HIDDEN)?tc.CURS_BACKWARD:tc.CURS_FORWARD;if(br!=Da||it!=null||uA==tc.HILIGHT_CHAR||l){if(it!=null||uA==tc.HILIGHT_CHAR||l){Iq(Da+1)}else{br=Da;we=br-fr;VR=true;eB();fB(false)}}else{VR=true;eB()}FN(true);if(k_>=0)_i.TerEditStyle(true,null,true,0,true);if(ti||xr||GY(br,tc.INFO_PAGE))cG();if(document.activeElement!==_i.VirtTextarea&&!oi.ReadOnly)lf=true;wS=true}else{VR=true;eB()}if((i=iW(br))>=0&&pl[i].ParaFrameId>0)qE=true;if(qE){s=pl[i].ParaFrameId;if(Nj(kl[s].flags2&tc.PF2_NO_SIZE))qE=false;if(qE&&Sa.ctrlKey)qE=false;if(qE&&s>0)pM(pl[i].BoxFrame,-1)}f=ib(br,jt);if(Nj(xs[f].style&tc.PICT)&&Dj(xs[f].style&tc.PROTECT)&&a&&uA==tc.HILIGHT_OFF&&xs[f].ctl==null&&Dj(zh&tc.TFLAG_NO_EDIT_PICT)){var R=oi.ReadOnly&&Nj(qh&tc.TFLAG4_READONLY_CONTROLS)&&Xw(f);if(qE&&Nj(Zh&tc.TFLAG2_SELECT_FRAME_PICT)){var L=br==0?0:ui[br-1].fid;var C=br==Ri-1?0:ui[br+1].fid;if(L!=ui[br].fid&&C!=ui[br].fid&&ui[br].len==2)qE=false}if(!qE&&!R){QE=true;uA=tc.HILIGHT_CHAR;sA=_A=br;TA=jt;AA=jt+1;OA=false;GA=false;MT=tc.CURS_FORWARD}}else if(qE&&uA==tc.HILIGHT_OFF){s=pl[i].ParaFrameId;var I=kl[s].ShapeType==tc.SHPTYPE_TEXT_BOX||Nj(kl[s].flags&tc.PARA_FRAME_TEXT_BOX);if(!I)xW(pl[i].ParaFrameId)}}if(!Ir&&ya==tc.SPACE||KE>=0){if(e==tc.BUTTON_LEFT||e==tc.BUTTON_RIGHT)Ua=false;else if(Dj(oi.WordWrap))Ua=false;if(n&&(KE<0||XE[KE].type!=tc.DRAG_TYPE_CTL_SIZE))Ua=true}VR=true;Uh=-1;if(e==tc.BUTTON_LEFT&&!Ir&&ya==tc.SPACE&&Xa&&Hh){if(!Nh&&(Kx(true)||sU(false))){if(!lv||!QD())return false;Ua=true}else{if(!lv||!QD())return false;Yx(true)}}if(Sa.ctrlKey){var d=LU(true,br,jt);if(!d)CU(true,br,jt)}CM();return true}function CM(){}_i.TerEnableDashes=function(t,e,r){return true};function IM(t,e){var r,i,f,l,a;var n=null;t:{if(uA==tc.HILIGHT_OFF)break t;if(getCursor()==jf||getCursor()==Yf){y-=10;x-=10}else if(getCursor()==Vf){y-=14;x-=10}Ga=t-_i.cvs.getBoundingClientRect().left-_i.cvs.clientLeft+_i.cvs.scrollLeft;Ba=e-_i.cvs.getBoundingClientRect().top-_i.cvs.clientTop+_i.cvs.scrollTop;tq(true);if(ya!=tc.SPACE)break t;ON();i=Lq(sA,TA);f=Lq(_A,AA);l=Lq(Da,Ma);if(i>f){i=WY(i,f);f=JC}if(l>=i&&l<f)break t;if(Nj(qh&tc.TFLAG4_NO_DRAG_PROT_TEXT)&&wN(true,true)){Xr=false;break t}if(null==(n=_i.TerGetRtfSel()))break t;a=n.length;br=Da;jt=Ma;if(!Lm(br,jt)){oV();break t}var c=Sa.isControlDown();if(uA==tc.HILIGHT_CHAR&&!c){var s=zh;if(Nj(qh&tc.TFLAG4_FULL_DRAG_PROT_TEXT))zh|=tc.TFLAG_UNPROTECTED_DEL;if(_i.TerDeleteBlock(true)){uE--;if(l>=f)l-=f-i;var _,o;Cq(l);_=PC;o=SC;br=_;jt=o}zh=s}_i.InsertRtfBuf(n,br,jt,false);if(br>=Ri)br=Ri-1;if(br-fr>=Dt||br-fr<0)fr=br-Dt/2;if(fr<0)fr=0;we=br-fr;if(we<0)we=0}uA=tc.HILIGHT_OFF;Xr=false;Br=tc.PAINT_WIN;cG();return true}function dM(t){var e,r;df=oi.modified;if(uA!=tc.HILIGHT_OFF&&ui[sA].cid>0&&ui[sA].cid==ui[_A].cid){ON();if(GY(_A,tc.INFO_CELL)&&AA==ui[_A].len&&AA>0)AA--;if(sA==_A&&TA==AA)return true}if(Nj(qh&tc.TFLAG4_NO_DRAG_PROT_TEXT)&&wN(true,true))return true;xfer=new OurTransferable(_i);Vr=true;Kr=false;Yr=false;Ye=Lq(br,jt);Ve=Gt;Vr=false;return true}function FM(t){var e=t.getDropAction();if(!t.getDropSuccess())return true;Vr=false;Kr=false;if(uA!=tc.HILIGHT_OFF){var r=zh;if(Nj(qh&tc.TFLAG4_FULL_DRAG_PROT_TEXT))zh|=tc.TFLAG_UNPROTECTED_DEL;if(!oi.ReadOnly){Jr=false;UD(tc.TER_PREPROCESS,tc.ACTION_DRAG_DEL,0,false);if(!Jr){if(oi.modified>df)uE--;_i.TerDeleteBlock(true);UD(tc.TER_ACTION,tc.ACTION_DRAG_DEL,0,false)}}zh=r}Xr=false;return true}function gM(t){var e;var r;var i=0,f=0,l,a,n,c;var s=false;Ga=ClientX-_i.cvs.getBoundingClientRect().left-_i.cvs.clientLeft+_i.cvs.scrollLeft;Ba=ClientY-_i.cvs.getBoundingClientRect().top-_i.cvs.clientTop+_i.cvs.scrollTop;tq(false);t:{if(!Lm(Da,Ma)){t.rejectDrop();oV();cG();break t}if(Vr&&uA!=tc.HILIGHT_OFF){ON();if(ui[sA].cid>0&&sA==_A&&ui[_A].len==1){var _=GY(_A,tc.INFO_CELL)&&(sA==0||ui[sA-1].cid!=ui[_A].len);if(_){uA=tc.HILIGHT_OFF;cG();break t}}i=Lq(sA,TA);f=Lq(_A,AA);l=Lq(Da,Ma);if(i>f){i=WY(i,f);f=JC}if(l>=i&&l<f){uA=tc.HILIGHT_OFF;cG();break t}}br=Da;jt=Ma;a=Lq(br,jt);var o=false;if(jt>=ui[br].len)o=true;s=Vr&&uA!=tc.HILIGHT_OFF&&a<i;if(!dD(_i,t))break t;t.acceptDrop(t.getDropAction());c=uA;if(s)aO|=tc.TOFLAG_NO_ADJUST_POS;YN("",xfer);uA=c;if(s){n=Lq(br,jt);i+=n-a;f+=n-a;if(!oi.WordWrap&&o&&i>0){i-=2;f-=2}Cq(i,gk("B"));Cq(f,gk("E"));aO=_j(aO,tc.TOFLAG_NO_ADJUST_POS)}t.dropComplete(true)}return true}function PM(t){var e=t.toUpperCase();if(e.endsWith(".tc.RTF")&&_i.TerInsertRtfFile(t,-1,0,true))return true;if(e.endsWith(".tc.TXT")||e.endsWith(".tc.BAT")||e.endsWith(".tc.SYS")){var r=_i.TerFileToMem(t);return _i.InsertTerText(Wk(r),true)}if(e.endsWith(".tc.BMP")||e.endsWith(".tc.JPG")||e.endsWith(".tc.JPEG")||e.endsWith(".tc.PNG")||e.endsWith(".tc.TIF")||e.endsWith(".tc.GIF")){var i=_i.TerInsertPictureFile(t,Dj(tO&tc.TFLAG6_INSERT_DROP_PICT_AS_LINK),0,true);return i>0}return false}function SM(t,e){var r,i,f,l;var a=0;var n;if(KE<0||!XE[KE].InUse){ar=0;nr=0;return false}r=HJ(t);i=mJ(t);if(XE[KE].type==tc.DRAG_TYPE_FRAME_MOVE)a=Nt/10;if(r<a)r=a;if(r>K.right-a)r=K.right-a;if(i<0)i=0;if(i>K.bottom)i=K.bottom;f=r-Ga;l=i-Ba;ar+=f;nr+=l;if(XE[KE].type==tc.DRAG_TYPE_PICT_SIZE)MM(tc.DRAG_TYPE_PICT_SIZE,f,l);else if(XE[KE].type==tc.DRAG_TYPE_CELL)HM(f);else if(XE[KE].type==tc.DRAG_TYPE_ROW)wM(l);else if(XE[KE].type==tc.DRAG_TYPE_FRAME_SIZE)MM(tc.DRAG_TYPE_FRAME_SIZE,f,l);else if(XE[KE].type==tc.DRAG_TYPE_FRAME_MOVE)GM(f,l);else if(XE[KE].type==tc.DRAG_TYPE_ROW_INDENT)mM(f);else if(XE[KE].type==tc.DRAG_TYPE_RULER_LEFT)bM(f);else if(XE[KE].type==tc.DRAG_TYPE_RULER_RIGHT)bM(f);else if(XE[KE].type==tc.DRAG_TYPE_RULER_FIRST)bM(f);else if(XE[KE].type==tc.DRAG_TYPE_RULER_TAB)xM(f,i);else if(XE[KE].type==tc.DRAG_TYPE_CTL_SIZE)BM(f,l);Ga+=f;Ba+=l;if(e){yM(ar,nr,r,i);KE=-1;ar=0;nr=0}return true}function hM(t){var e=xs[t].ParaFID;if(e>0&&Nj(kl[e].flags&tc.PARA_FRAME_LINE)){var r=xs[t].DispFrame;if(r>=0)pM(r,e)}else if(Dj(zh&tc.TFLAG_NO_EDIT_PICT)){if(uA==tc.HILIGHT_CHAR)OM(t);else QE=false}return true}function OM(t){var e,r,i,f,l;var a=new tc.RECT;var n,c;var s,_;if(oi.ReadOnly)return true;if(JE){if(KE>0&&XE[KE].InUse&&XE[KE].type==tc.DRAG_TYPE_PICT_SIZE&&XE[KE].id1==t)return true;XM();$M(tc.DRAG_TYPE_SCR_FIRST,tc.DRAG_TYPE_SCR_LAST)}if((i=qM())<0)return false;XE[i].InUse=true;XE[i].type=tc.DRAG_TYPE_PICT_SIZE;XE[i].id1=t;XE[i].HotRectCount=8;IE=xs[t].PictWidth;dE=xs[t].PictHeight;s=xs[t].ParaFID;f=dV(xs[t].PictWidth);l=hV(xs[t].PictHeight);if(l>0)XE[i].AspectRatio=f/l;r=xs[t].PictY+Gt;e=xs[t].PictX+Ft;a.left=e;a.right=e+f;a.top=r;a.bottom=r+l;_=xs[t].InFrame;if(_>=0&&_<Dl&&I$(_)!=0){a=vM(a,t);e=a.left;r=a.top}XE[i].ObjRect=a.copy();n=dV(tc.DRAG_TAB_WIDTH);c=hV(tc.DRAG_TAB_WIDTH);a.left=e;a.right=a.left+n;a.top=r+(l-c)/2;a.bottom=a.top+c;XE[i].HotRect[tc.DRAG_HOT_LEFT]=a.copy();a.left=e+f-n;a.right=a.left+n;a.top=r+(l-c)/2;a.bottom=a.top+c;XE[i].HotRect[tc.DRAG_HOT_RIGHT]=a.copy();a.left=e+(f-n)/2;a.right=a.left+n;a.top=r;a.bottom=a.top+c;XE[i].HotRect[tc.DRAG_HOT_TOP]=a.copy();a.left=e+(f-n)/2;a.right=a.left+n;a.top=r+l-c;a.bottom=a.top+c;XE[i].HotRect[tc.DRAG_HOT_BOT]=a.copy();a.left=e;a.right=a.left+n;a.top=r;a.bottom=a.top+c;XE[i].HotRect[tc.DRAG_HOT_TL]=a.copy();a.left=e+f-n;a.right=a.left+n;a.top=r;a.bottom=a.top+c;XE[i].HotRect[tc.DRAG_HOT_TR]=a.copy();a.left=e;a.right=a.left+n;a.top=r+l-c;a.bottom=a.top+c;XE[i].HotRect[tc.DRAG_HOT_BL]=a.copy();a.left=e+f-n;a.right=a.left+n;a.top=r+l-c;a.bottom=a.top+c;XE[i].HotRect[tc.DRAG_HOT_BR]=a.copy();XM();if(xs[t].ParaFID>0)PE=kl[xs[t].ParaFID].copy();if(xs[t].FrameType==tc.PFRAME_FLOAT)DM(-1,t);return true}function vM(t,e){var r,i,f,l,a=0,n;n=xs[e].InFrame;a=I$(n);r=t.right-t.left;i=t.bottom-t.top;f=g$(t.left,t.top,n);l=P$(t.left,t.top,n);t.left=f;if(a==270)t.left-=r;t.right=t.left+r;t.top=l;if(a==90)t.top-=i;t.bottom=t.top+i;return t}function pM(t,e){var r=0,i=0,f,l,a,n=0,c=0,s=0,_=0;var o=new tc.RECT;var u,T,A,E,R=0;var L=false;if(zE)return true;if(oi.ReadOnly)return true;if((f=qM())<0)return false;if(e<0)e=pl[t].ParaFrameId;PE=kl[e].copy();XE[f].InUse=true;XE[f].type=tc.DRAG_TYPE_FRAME_SIZE;XE[f].id1=e;if(Nj(kl[e].flags&tc.PARA_FRAME_LINE))L=true;if(L)XE[f].HotRectCount=2;else XE[f].HotRectCount=4;l=pl[t].width;a=pl[t].height;R=yV(pl[t].AddedBorderSpace);if(R>0){l-=2*R;a-=2*R}if(a>0)XE[f].AspectRatio=l/a;if(L){n=s=c=_=0;aW(t,n,c,s,_);n=rd;c=fd;s=id;_=ld;XE[f].ObjPointCount=2;XE[f].ObjPoint[0]=new tc.Point(n,c);XE[f].ObjPoint[1]=new tc.Point(s,_);XE[f].ObjPoint[2]=new tc.Point(n,c);XE[f].ObjPoint[3]=new tc.Point(s,_)}else{XE[f].ObjRect.left=r=pl[t].x+R;XE[f].ObjRect.top=i=pl[t].y+R;XE[f].ObjRect.right=XE[f].ObjRect.left+l;XE[f].ObjRect.bottom=XE[f].ObjRect.top+a}u=dV(tc.DRAG_TAB_WIDTH);T=hV(tc.DRAG_TAB_WIDTH);A=u*3/5;E=T*3/5;if(L){o.left=n;o.top=c-T/2}else{o.left=r+1;o.top=i+(a-T)/2}o.right=o.left+A;o.bottom=o.top+T;XE[f].HotRect[tc.DRAG_HOT_LEFT]=o.copy();if(L){o.left=s-A;o.top=_-T/2}else{o.left=r+l-A-1;o.top=i+(a-T)/2}o.right=o.left+A;o.bottom=o.top+T;XE[f].HotRect[tc.DRAG_HOT_RIGHT]=o.copy();if(!L){o.left=r+(l-u)/2;o.right=o.left+u;o.top=i+1;o.bottom=o.top+E;XE[f].HotRect[tc.DRAG_HOT_TOP]=o.copy();o.left=r+(l-u)/2;o.right=o.left+u;o.top=i+a-E-1;o.bottom=i+a-1;XE[f].HotRect[tc.DRAG_HOT_BOT]=o.copy()}if(kl[e].pict>0)DM(t,kl[e].pict);else DM(t,-1);return true}function NM(t){var e,r,i,f,l;var a=new tc.RECT;var n,c;var s;if(xs[t].ctl==null)return true;s=xs[t].ctl;var _=s.toString().toLowerCase();if(_.indexOf("checkbox")<0)return true;if((i=qM())<0)return false;XE[i].InUse=true;XE[i].type=tc.DRAG_TYPE_CTL_SIZE;XE[i].id1=t;XE[i].HotRectCount=4;f=dV(xs[t].PictWidth);l=hV(xs[t].PictHeight);if(l>0)XE[i].AspectRatio=f/l;r=xs[t].PictY+Gt;XE[i].ObjRect.top=r;XE[i].ObjRect.bottom=XE[i].ObjRect.top+l;XE[i].ObjRect.left=e=xs[t].PictX+Ft;XE[i].ObjRect.right=XE[i].ObjRect.left+f;n=dV(tc.DRAG_TAB_WIDTH);c=hV(tc.DRAG_TAB_WIDTH);a.left=e-n;a.right=a.left+n;a.top=r;a.bottom=a.top+l;XE[i].HotRect[tc.DRAG_HOT_LEFT]=a.copy();a.left=e+f;a.right=a.left+n;a.top=r;a.bottom=a.top+l;XE[i].HotRect[tc.DRAG_HOT_RIGHT]=a.copy();a.left=e;a.right=a.left+f;a.top=r-c;a.bottom=a.top+c;XE[i].HotRect[tc.DRAG_HOT_TOP]=a.copy();a.left=e;a.right=a.left+f;a.top=r+l;a.bottom=a.top+c;XE[i].HotRect[tc.DRAG_HOT_BOT]=a.copy();return true}function DM(t,e){var r,i,f=0,l=0,a=0,n=0,c,s,_,o;var u,T;var A=false;var E=new tc.RECT;if((r=qM())<0)return false;if(e>0)t=xs[e].DispFrame;i=pl[t].ParaFrameId;if(e>0&&xs[e].ParaFID>0)i=xs[e].ParaFID;u=pl[t].x;T=pl[t].y;c=pl[t].width;s=pl[t].height;_=dV(tc.DRAG_TAB_WIDTH);o=hV(tc.DRAG_TAB_WIDTH);if(Nj(kl[i].flags&tc.PARA_FRAME_LINE))A=true;XE[r].InUse=true;XE[r].type=tc.DRAG_TYPE_FRAME_MOVE;XE[r].id1=pl[t].ParaFrameId;XE[r].HotRectCount=4;if(A){f=l=a=n=0;aW(t,f,a,l,n);f=rd;a=fd;l=id;n=ld;XE[r].ObjPointCount=2;XE[r].ObjPoint[0]=new tc.Point(f,a);XE[r].ObjPoint[1]=new tc.Point(l,n)}else{XE[r].ObjRect.left=u;XE[r].ObjRect.top=T;XE[r].ObjRect.right=XE[r].ObjRect.left+c;XE[r].ObjRect.bottom=XE[r].ObjRect.top+s}if(A){XE[r].IsHotPolygon=true;XE[r].HotRect[0].left=f+_;XE[r].HotRect[0].top=a-_;XE[r].HotRect[1].left=f+_;XE[r].HotRect[1].top=a+_;XE[r].HotRect[2].left=l-_;XE[r].HotRect[2].top=n+_;XE[r].HotRect[3].left=l-_;XE[r].HotRect[3].top=n-_}else{if(e>0&&(kl[i].ShapeType==0||kl[i].ShapeType==tc.SHPTYPE_PICT_FRAME)){XE[r].HotRect[tc.DRAG_HOT_LEFT]=XE[r].ObjRect;XE[r].HotRect[tc.DRAG_HOT_RIGHT]=XE[r].ObjRect;XE[r].HotRect[tc.DRAG_HOT_TOP]=XE[r].ObjRect;XE[r].HotRect[tc.DRAG_HOT_BOT]=XE[r].ObjRect}else{E.left=u-_;E.right=u;E.top=T;E.bottom=E.top+s;XE[r].HotRect[tc.DRAG_HOT_LEFT]=E.copy();E.left=u+c;E.right=E.left+_;E.top=T;E.bottom=E.top+s;XE[r].HotRect[tc.DRAG_HOT_RIGHT]=E.copy();E.left=u-_;E.right=u+c+_;E.top=T-o;E.bottom=T;XE[r].HotRect[tc.DRAG_HOT_TOP]=E.copy();E.left=u-_;E.right=u+c+_;E.top=T+s;E.bottom=E.top+o;XE[r].HotRect[tc.DRAG_HOT_BOT]=E.copy()}}ZE=false;KM();if(e>0)KE=r;return true}function MM(t,e,r){var i,f=0,l=0,a,n;var c=false,s=false;var _=0;i=XE[KE].id1;if(t==tc.DRAG_TYPE_FRAME_SIZE&&Nj(kl[i].flags2&tc.PF2_NO_SIZE))return true;if(t==tc.DRAG_TYPE_FRAME_SIZE&&Nj(kl[i].flags&tc.PARA_FRAME_LINE))c=true;if(t==tc.DRAG_TYPE_PICT_SIZE){_=xs[i].ParaFID;if(_>0&&Nj(kl[_].flags&tc.PARA_FRAME_LINE))c=true}if(t==tc.DRAG_TYPE_PICT_SIZE&&JE)XM();if(t==tc.DRAG_TYPE_FRAME_SIZE){if(zE)KM();if(ZE)YM()}var o=Sa.shiftKey;if(YE>=tc.DRAG_HOT_CORNER_START&&YE<=tc.DRAG_HOT_CORNER_END)s=true;else{if(t==tc.DRAG_TYPE_PICT_SIZE&&(Nj(zh&tc.TFLAG_KEEP_PICT_ASPECT)||o))s=true;if(t==tc.DRAG_TYPE_FRAME_SIZE&&Nj(zh&tc.TFLAG_KEEP_FRAME_ASPECT)&&!c)s=true}if(s){var u=Math.abs(XE[KE].ObjRect.right-XE[KE].ObjRect.left);var T=Math.abs(XE[KE].ObjRect.bottom-XE[KE].ObjRect.top);var A=XE[KE].AspectRatio;if(YE==tc.DRAG_HOT_LEFT||YE==tc.DRAG_HOT_RIGHT){var E=A==0?l:(u+e)/A;r=E-T}else{var R=A==0?f:(T+r)*A;e=R-u}}n=YE;for(a=0;a<2;a++){if(a==1){if(!s)break;if(YE==tc.DRAG_HOT_LEFT){YE=tc.DRAG_HOT_TOP;r=-r}else if(YE==tc.DRAG_HOT_TOP){YE=tc.DRAG_HOT_LEFT;e=-e}else if(YE==tc.DRAG_HOT_RIGHT)YE=tc.DRAG_HOT_BOT;else if(YE==tc.DRAG_HOT_BOT)YE=tc.DRAG_HOT_RIGHT}if(YE==tc.DRAG_HOT_LEFT){XE[KE].ObjRect.left+=e;XE[KE].HotRect[YE].left+=e;XE[KE].HotRect[YE].right+=e;if(c){XE[KE].ObjPoint[0].x+=e;XE[KE].ObjPoint[0].y+=r;XE[KE].HotRect[YE].top+=r;XE[KE].HotRect[YE].bottom+=r}}if(YE==tc.DRAG_HOT_RIGHT){XE[KE].ObjRect.right+=e;XE[KE].HotRect[YE].left+=e;XE[KE].HotRect[YE].right+=e;if(c){XE[KE].ObjPoint[1].x+=e;XE[KE].ObjPoint[1].y+=r;XE[KE].HotRect[YE].top+=r;XE[KE].HotRect[YE].bottom+=r}}if(YE==tc.DRAG_HOT_TOP){XE[KE].ObjRect.top+=r;XE[KE].HotRect[YE].top+=r;XE[KE].HotRect[YE].bottom+=r}if(YE==tc.DRAG_HOT_BOT){XE[KE].ObjRect.bottom+=r;XE[KE].HotRect[YE].top+=r;XE[KE].HotRect[YE].bottom+=r}if(YE==tc.DRAG_HOT_TL){XE[KE].ObjRect.left-=e;XE[KE].ObjRect.top+=r;XE[KE].HotRect[YE].top+=r;XE[KE].HotRect[YE].bottom+=r;XE[KE].HotRect[YE].left-=e;XE[KE].HotRect[YE].right-=e;break}if(YE==tc.DRAG_HOT_TR){XE[KE].ObjRect.right+=e;XE[KE].ObjRect.top+=r;XE[KE].HotRect[YE].top+=r;XE[KE].HotRect[YE].bottom+=r;XE[KE].HotRect[YE].left+=e;XE[KE].HotRect[YE].right+=e;break}if(YE==tc.DRAG_HOT_BL){XE[KE].ObjRect.left-=e;XE[KE].ObjRect.bottom+=r;XE[KE].HotRect[YE].top+=r;XE[KE].HotRect[YE].bottom+=r;XE[KE].HotRect[YE].left-=e;XE[KE].HotRect[YE].right-=e;break}if(YE==tc.DRAG_HOT_BR){XE[KE].ObjRect.right+=e;XE[KE].ObjRect.bottom+=r;XE[KE].HotRect[YE].top+=r;XE[KE].HotRect[YE].bottom+=r;XE[KE].HotRect[YE].left+=e;XE[KE].HotRect[YE].right+=e;break}}YE=n;if(!c){f=XE[KE].ObjRect.right-XE[KE].ObjRect.left;l=XE[KE].ObjRect.bottom-XE[KE].ObjRect.top;if(f<dV(2*tc.RULER_TOLERANCE))f=dV(2*tc.RULER_TOLERANCE);if(l<hV(2*tc.RULER_TOLERANCE))l=hV(2*tc.RULER_TOLERANCE)}if(t==tc.DRAG_TYPE_PICT_SIZE){XM()}else{if(!c){kl[i].width=gV(f);kl[i].MinHeight=kl[i].height=vV(l);if(kl[i].TextAngle>0)kl[i].height=kl[i].MinHeight}KM();YM()}oi.modified++;return true}function GM(t,e){var r,i;var f=false;if(ZE)YM();i=XE[KE].id1;if(Nj(kl[i].flags2&tc.PF2_NO_MOVE))return true;if(Nj(kl[i].flags&tc.PARA_FRAME_LINE))f=true;if(f){XE[KE].ObjPoint[0].x+=t;XE[KE].ObjPoint[1].x+=t;XE[KE].ObjPoint[0].y+=e;XE[KE].ObjPoint[1].y+=e}else{XE[KE].ObjRect.left+=t;XE[KE].ObjRect.right+=t;XE[KE].ObjRect.top+=e;XE[KE].ObjRect.bottom+=e}for(r=0;r<VE;r++){if(XE[r].InUse&&(XE[r].type==tc.DRAG_TYPE_FRAME_SIZE||XE[r].type==tc.DRAG_TYPE_PICT_SIZE)){if(f){XE[r].ObjPoint[0]=new tc.Point(XE[KE].ObjPoint[0]);XE[r].ObjPoint[1]=new tc.Point(XE[KE].ObjPoint[1])}else XE[r].ObjRect=XE[KE].ObjRect.copy();break}}for(r=0;r<4;r++){XE[KE].HotRect[r].left+=t;XE[KE].HotRect[r].right+=t;XE[KE].HotRect[r].top+=e;XE[KE].HotRect[r].bottom+=e}oi.modified++;YM();return true}function BM(t,e){var r,i=0,f=0,l,a;var n=false;r=XE[KE].id1;if(XE[KE].id2==1)VM();var c=Sa.shiftKey;if(Nj(zh&tc.TFLAG_KEEP_PICT_ASPECT)||c)n=true;if(n){var s=Math.abs(XE[KE].ObjRect.right-XE[KE].ObjRect.left);var _=Math.abs(XE[KE].ObjRect.bottom-XE[KE].ObjRect.top);var o=XE[KE].AspectRatio;if(YE==tc.DRAG_HOT_LEFT||YE==tc.DRAG_HOT_RIGHT){var u=o==0?f:(s+t)/o;e=u-_}else{var T=o==0?i:(_+e)*o;t=T-s}}a=YE;for(l=0;l<2;l++){if(l==1){if(!n)break;if(YE==tc.DRAG_HOT_LEFT){YE=tc.DRAG_HOT_TOP;e=-e}else if(YE==tc.DRAG_HOT_TOP){YE=tc.DRAG_HOT_LEFT;t=-t}else if(YE==tc.DRAG_HOT_RIGHT)YE=tc.DRAG_HOT_BOT;else if(YE==tc.DRAG_HOT_BOT)YE=tc.DRAG_HOT_RIGHT}if(YE==tc.DRAG_HOT_LEFT){XE[KE].ObjRect.left+=t;XE[KE].HotRect[YE].left+=t;XE[KE].HotRect[YE].right+=t}if(YE==tc.DRAG_HOT_RIGHT){XE[KE].ObjRect.right+=t;XE[KE].HotRect[YE].left+=t;XE[KE].HotRect[YE].right+=t}if(YE==tc.DRAG_HOT_TOP){XE[KE].ObjRect.top+=e;XE[KE].HotRect[YE].top+=e;XE[KE].HotRect[YE].bottom+=e}if(YE==tc.DRAG_HOT_BOT){XE[KE].ObjRect.bottom+=e;XE[KE].HotRect[YE].top+=e;XE[KE].HotRect[YE].bottom+=e}}YE=a;i=XE[KE].ObjRect.right-XE[KE].ObjRect.left;f=XE[KE].ObjRect.bottom-XE[KE].ObjRect.top;if(i<dV(2*tc.RULER_TOLERANCE))i=dV(2*tc.RULER_TOLERANCE);if(f<hV(2*tc.RULER_TOLERANCE))f=hV(2*tc.RULER_TOLERANCE);VM();oi.modified++;return true}function HM(t){var e;var r,i,f,l;var a,n;var c=false;if(XE[KE].id2==-1){r=XE[KE].id1;c=XE[KE].TextHilighted&&Nj(eR[r].flags&(tc.CFLAG_SEL1|tc.CFLAG_SEL2));i=r;a=-1;while(true){if((l=v6(i,true))==-1)break;if(c&&Dj(eR[l].flags&(tc.CFLAG_SEL1|tc.CFLAG_SEL2)))break;for(e=0;e<Dl;e++)if(pl[e].CellId==l)break;if(e<Dl)a=e;i=l}f=r;n=-1;while(true){if((l=M6(f))==-1)break;if(c&&Dj(eR[l].flags&(tc.CFLAG_SEL1|tc.CFLAG_SEL2)))break;for(e=0;e<Dl;e++)if(pl[e].CellId==l)break;if(e<Dl)n=e;f=l}if(a>=0)XE[KE].ObjPoint[0].y=pl[a].ScrY;if(n>=0)XE[KE].ObjPoint[1].y=pl[n].ScrY+pl[n].ScrHeight;XE[KE].id2=i;XE[KE].id3=f}if(XE[KE].drawn)zM();XE[KE].HotRect[YE].left+=t;XE[KE].HotRect[YE].right+=t;for(e=0;e<XE[KE].ObjPointCount;e++)XE[KE].ObjPoint[e].x+=t;zM();oi.modified++;return true}function mM(t){var e;var r,i,f,l;var a,n;if(XE[KE].id2==-1){r=XE[KE].id1;i=r;a=-1;while(true){if((l=$E[i].PrevRow)==-1)break;for(e=0;e<Dl;e++)if(pl[e].RowId==l)break;if(e<Dl)a=e;i=l}f=r;n=-1;while(true){if((l=$E[f].NextRow)==-1)break;for(e=0;e<Dl;e++)if(pl[e].RowId==l)break;if(e<Dl)n=e;f=l}if(a>=0)XE[KE].ObjPoint[0].y=pl[a].ScrY;if(n>=0)XE[KE].ObjPoint[1].y=pl[n].ScrY+pl[n].ScrHeight;XE[KE].id2=i;XE[KE].id3=f}if(XE[KE].drawn)zM();XE[KE].HotRect[YE].left+=t;XE[KE].HotRect[YE].right+=t;for(e=0;e<XE[KE].ObjPointCount;e++)XE[KE].ObjPoint[e].x+=t;zM();oi.modified++;return true}function wM(t){var e;var r,i,f,l;var a,n;if(XE[KE].id2==-1){r=XE[KE].id1;i=r;a=-1;while(true){if((l=eR[i].PrevCell)<=0)break;if(Nj(eR[l].flags&tc.CFLAG_ROW_SPANNED))l=rR[l].SpanningCell;if(l<=0)break;for(e=0;e<Dl;e++)if(pl[e].CellId==l)break;if(e<Dl)a=e;i=l}f=r;n=-1;while(true){if((l=eR[f].NextCell)<=0)break;if(Nj(eR[l].flags&tc.CFLAG_ROW_SPANNED))l=rR[l].SpanningCell;if(l<=0)break;for(e=0;e<Dl;e++)if(pl[e].CellId==l)break;if(e<Dl)n=e;f=l}if(a>=0)XE[KE].ObjPoint[0].x=pl[a].ScrX;if(n>=0)XE[KE].ObjPoint[1].x=pl[n].ScrX+pl[n].ScrWidth;XE[KE].id2=i;XE[KE].id3=f}if(XE[KE].drawn)ZM();XE[KE].HotRect[YE].top+=t;XE[KE].HotRect[YE].bottom+=t;for(e=0;e<XE[KE].ObjPointCount;e++)XE[KE].ObjPoint[e].y+=t;ZM();oi.modified++;return true}function bM(t){var e;if(XE[KE].drawn)jM();XE[KE].HotRect[YE].left+=t;XE[KE].HotRect[YE].right+=t;for(e=0;e<XE[KE].ObjPointCount;e++)XE[KE].ObjPoint[e].x+=t;oi.modified++;ai=true;jM();return true}function xM(t,e){var r;if(XE[KE].drawn)JM(e);XE[KE].HotRect[YE].left+=t;XE[KE].HotRect[YE].right+=t;for(r=0;r<XE[KE].ObjPointCount;r++)XE[KE].ObjPoint[r].x+=t;oi.modified++;ai=true;JM(e);return true}function yM(t,e,r,i){var f,l;var a,n,c,s;var _,o,u,T,A,E,R,L;var C,I,d,F,g,P;f=gV(t);l=vV(e);if(XE[KE].type==tc.DRAG_TYPE_RULER_LEFT){if(XE[KE].drawn)jM();if(Nj(ui[br].flags2&tc.LFLAG2_RTL))f=-f;if(uA!=tc.HILIGHT_OFF&&Nj($h&tc.TFLAG5_RULER_INDENT_FIXED)){_=XE[KE].id1;o=Nc[_].LeftIndentTwips+f;if(o<0)o=0;_i.TerSetParaIndent(o,-1,Nc[_].FirstIndentTwips-f,false)}else _i.ParaIndentTwips(f,0,-f,false)}else if(XE[KE].type==tc.DRAG_TYPE_RULER_RIGHT){if(XE[KE].drawn)jM();if(Nj(ui[br].flags2&tc.LFLAG2_RTL))f=-f;if(uA!=tc.HILIGHT_OFF&&Nj($h&tc.TFLAG5_RULER_INDENT_FIXED)){_=XE[KE].id1;o=Nc[_].RightIndentTwips-f;if(o<0)o=0;_i.TerSetParaIndent(-1,o,-1,false)}else _i.ParaIndentTwips(0,-f,0,false)}else if(XE[KE].type==tc.DRAG_TYPE_RULER_FIRST){if(XE[KE].drawn)jM();if(Nj(ui[br].flags2&tc.LFLAG2_RTL))f=-f;if(uA!=tc.HILIGHT_OFF&&Nj($h&tc.TFLAG5_RULER_INDENT_FIXED)){_=XE[KE].id1;o=Nc[_].FirstIndentTwips+f;if(o<0)o=0;_i.TerSetParaIndent(Nc[_].LeftIndentTwips,-1,o,false)}else _i.ParaIndentTwips(0,0,f,false)}else if(XE[KE].type==tc.DRAG_TYPE_RULER_TAB){if(XE[KE].drawn)JM(i);a=XE[KE].id1;if(Y_)n=W_[k_].TabId;else n=Nc[ui[br].pfmt].TabId;if(Nj(ui[br].flags2&tc.LFLAG2_RTL))f=-f;if(a<B_[n].count){var S=B_[n].flags[a];s=B_[n].type[a];c=B_[n].pos[a]+f;if(Gh){if(Nj(zh&tc.TFLAG_METRIC))c=HY(c,tc.SNAP_DIST_METRIC);else c=HY(c,tc.SNAP_DIST)}_i.ClearTab(B_[n].pos[a],false);if(c>0&&i>=k.top&&i<k.bottom)_i.TerSetTab(s,c,S,false)}}else if(XE[KE].type==tc.DRAG_TYPE_ROW){var h,O;if(XE[KE].drawn)ZM();u=XE[KE].id1;UD(tc.TER_PREPROCESS,tc.ACTION_ROW_HEIGHT,eR[u].row,false);if(Jr)return true;V8(-1,u,-1,u,tc.UNDO_TABLE_ATTRIB);h=eR[u].row;O=$E[h].MinHeight;if(O>=0){$E[h].MinHeight=HV($E[h].height)+l;if($E[h].MinHeight<0)$E[h].MinHeight=0}else $E[h].MinHeight-=l;bG(true);_z(true);UD(tc.TER_ACTION,tc.ACTION_ROW_HEIGHT,h,false)}else if(XE[KE].type==tc.DRAG_TYPE_CELL){var v,p,N;var D,M;var G=Nj(qh&tc.TFLAG4_ADJ_LEFT_TABLE_COL);var B=Sa.shiftKey;if(B)G=true;if(XE[KE].drawn)zM();u=XE[KE].id1;D=XE[KE].id2;M=XE[KE].id3;if(D==-1)D=u;if(M==-1)M=u;UD(tc.TER_PREPROCESS,tc.ACTION_CELL_WIDTH,u,false);if(Jr)return true;V8(-1,D,-1,M,tc.UNDO_TABLE_ATTRIB);T=eR[D].row;A=eR[M].row;v=N6(u);E=T;while(true){p=$E[E].FirstCell;while(true){N=N6(p)-v;if(Math.abs(N)<tc.RULER_TOLERANCE){L=f;if(Nj($E[E].flags&tc.ROWFLAG_RTL))L=-L;R=eR[p].NextCell;if(eR[p].width+L<tc.MIN_CELL_WIDTH)return true;if(R>0&&!G&&eR[R].width-L<tc.MIN_CELL_WIDTH)return true}if(eR[p].NextCell==-1)break;p=eR[p].NextCell}if(E==A)break;if(E==$E[E].NextRow)break;E=$E[E].NextRow;if(E==-1)break}E=T;while(true){p=$E[E].FirstCell;while(true){N=N6(p)-v;if(Math.abs(N)<tc.RULER_TOLERANCE){L=f;if(Nj($E[E].flags&tc.ROWFLAG_RTL))L=-L;R=eR[p].NextCell;if(eR[p].width+L<tc.MIN_CELL_WIDTH)break;if(R>0&&!G&&eR[R].width-L<tc.MIN_CELL_WIDTH)break;if(Gh){C=eR[p].x+eR[p].width+L;if(Nj(zh&tc.TFLAG_METRIC))C=HY(C,tc.SNAP_DIST_METRIC);else C=HY(C,tc.SNAP_DIST);L=C-eR[p].x-eR[p].width}eR[p].width+=L;if(Li){eR[p].FixWidth=eR[p].width;eR[p].flags=cj(eR[p].flags,tc.CFLAG_FIX_WIDTH_PCT);eR[p].flags|=tc.CFLAG_FIX_WIDTH}if(R>0&&!G){eR[R].width-=L;eR[R].x+=L;if(Li){eR[R].FixWidth=eR[R].width;eR[R].flags=cj(eR[R].flags,tc.CFLAG_FIX_WIDTH_PCT);eR[R].flags|=tc.CFLAG_FIX_WIDTH}}if($E[E].FixWidth>0&&(eR[p].NextCell<=0||G))$E[E].FixWidth+=f;break}if(eR[p].NextCell==-1)break;p=eR[p].NextCell}if(!Li){for(p=$E[E].FirstCell;p>0;p=eR[p].NextCell){eR[p].flags=cj(eR[p].flags,tc.CFLAG_AUTO_WIDTH|tc.CFLAG_AUTO_WIDTH_RTF);eR[p].FixWidth=0}$E[E].flags=cj($E[E].flags,tc.ROWFLAG_AUTO_FIT|tc.ROWFLAG_AUTO_WIDTH_RTF);$E[E].FixWidth=0}if(E==A)break;if(E==$E[E].NextRow)break;E=$E[E].NextRow;if(E==-1)break}bG(true);_z(true);UD(tc.TER_ACTION,tc.ACTION_CELL_WIDTH,u,false)}else if(XE[KE].type==tc.DRAG_TYPE_ROW_INDENT){var H;var m,w,b,x=180;if(XE[KE].drawn)zM();H=XE[KE].id1;T=XE[KE].id2;A=XE[KE].id3;if(T==-1)T=H;if(A==-1)A=H;UD(tc.TER_PREPROCESS,tc.ACTION_ROW_INDENT,H,false);if(Jr)return true;V8(-1,$E[T].FirstCell,-1,$E[A].FirstCell,tc.UNDO_TABLE_ATTRIB);E=T;while(E>0){L=f;if(Gh){C=$E[E].indent+L;if(Nj(zh&tc.TFLAG_METRIC))C=HY(C,tc.SNAP_DIST_METRIC);else C=HY(C,tc.SNAP_DIST);L=C-$E[E].indent;if(Nj($E[E].flags&tc.ROWFLAG_RTL))L=-L}if(true||$E[E].indent+L>=0){w=0;R=$E[E].FirstCell;b=0;while(R>0){w+=eR[R].width;R=eR[R].NextCell;b++}if(L>=w-x*b){L=w-x*b;if(L<0)L=0}$E[E].indent+=L;if($E[E].FixWidth>0){$E[E].FixWidth-=L;if($E[E].FixWidth<0)$E[E].FixWidth=0}m=$E[E].indent;R=$E[E].FirstCell;while(R>0){eR[R].x=m;eR[R].width-=eR[R].width*L/w;if(eR[R].width<x)eR[R].width=x;if(Li){eR[R].FixWidth=eR[R].width;eR[R].flags=cj(eR[R].flags,tc.CFLAG_FIX_WIDTH_PCT);eR[R].flags|=tc.CFLAG_FIX_WIDTH}m=m+eR[R].width;R=eR[R].NextCell}}E=$E[E].NextRow}bG(true);yJ(false,true,0,true);UD(tc.TER_ACTION,tc.ACTION_ROW_INDENT,H,false)}else if(XE[KE].type==tc.DRAG_TYPE_FRAME_SIZE){d=XE[KE].id1;UD(tc.TER_PREPROCESS,tc.ACTION_FRAME_SIZE,d,false);if(Jr)return true;if(ZE)YM();nW(br,true);nO|=tc.TOFLAG2_USE_UNDO_FRAME;if(Nj(kl[d].flags&tc.PARA_FRAME_LINE))kM(t,e);else if(YE==tc.DRAG_HOT_LEFT||YE==tc.DRAG_HOT_TOP){C=gV(XE[KE].ObjRect.left);I=XE[KE].ObjRect.top;if(I>Ze)I-=Ze;I=vV(I);if(Ci)I-=HV(rr);if(Ci)C-=MV(dW(Lo));_i.TerMoveParaFrame(XE[KE].id1,C,I,-1,-1)}else{V8(d,0,0,0,tc.UNDO_FRAME_LIMITED);yJ(false,true,0,true)}nO=_j(nO,tc.TOFLAG2_USE_UNDO_FRAME)}else if(XE[KE].type==tc.DRAG_TYPE_PICT_SIZE){F=XE[KE].id1;d=xs[F].ParaFID;UD(tc.TER_PREPROCESS,tc.ACTION_PICT_SIZE,F,false);if(Jr)return true;g=XE[KE].ObjRect.right-XE[KE].ObjRect.left;P=XE[KE].ObjRect.bottom-XE[KE].ObjRect.top;if(g<dV(2*tc.RULER_TOLERANCE))g=dV(2*tc.RULER_TOLERANCE);if(P<hV(2*tc.RULER_TOLERANCE))P=hV(2*tc.RULER_TOLERANCE);xs[F].PictWidth=gV(g);xs[F].PictHeight=vV(P);if(d>0){kl[d].width=gV(g);kl[d].height=vV(P)}HN(F,P,g,true);mN(F);if(d>0){C=gV(XE[KE].ObjRect.left);I=XE[KE].ObjRect.top;if(I>Ze)I-=Ze;I=vV(I);if(Ci)C-=MV(dW(Lo));kl[d].x+=C-kl[d].OrgX;kl[d].OrgX=C;kl[d].OrgY+=I-kl[d].y;kl[d].ParaY+=I-kl[d].y;kl[d].y=I}nO|=tc.TOFLAG2_USE_UNDO_FRAME;if(d>0)V8(d,0,0,0,tc.UNDO_FRAME_LIMITED);else V8(F,0,0,0,tc.UNDO_PICT_SIZE);nO=_j(nO,tc.TOFLAG2_USE_UNDO_FRAME);xs[F].flags|=tc.FFLAG_RESIZED;if(br<Fo)Fo=br;if(xs[F].FrameType!=tc.PFRAME_NONE&&d>0){yJ(false,true,0,true)}}else if(XE[KE].type==tc.DRAG_TYPE_FRAME_MOVE){if(ZE)YM();d=XE[KE].id1;if(kl[d].pict>0)_i.TerMovePictFrame2(kl[d].pict,f,l);else{var y;if(Nj(kl[d].flags&tc.PARA_FRAME_LINE)){if(XE[KE].ObjPoint[0].x<XE[KE].ObjPoint[1].x)C=gV(XE[KE].ObjPoint[0].x);else C=gV(XE[KE].ObjPoint[1].x);I=XE[KE].ObjPoint[0].y;if(XE[KE].ObjPoint[1].y<I)I=XE[KE].ObjPoint[1].y}else{C=gV(XE[KE].ObjRect.left);I=XE[KE].ObjRect.top}y=qe;if(I>Ze){I-=Ze;y++}I=vV(I);if(Ci)I-=HV(rr);if(Ci)C-=MV(dW(Lo));_i.TerMoveParaFrame2(XE[KE].id1,C,I,-1,-1,y)}}else if(XE[KE].type==tc.DRAG_TYPE_CTL_SIZE){F=XE[KE].id1;var W=xs[F].ctl;g=Math.abs(XE[KE].ObjRect.right-XE[KE].ObjRect.left);P=Math.abs(XE[KE].ObjRect.bottom-XE[KE].ObjRect.top);if(XE[KE].id2==1)VM();xs[F].PictWidth=gV(g);xs[F].PictHeight=vV(P);HN(F,P,g,true);mN(F);W.setSize(g,P);oi.modified++;cG();if(br<Fo)Fo=br}return true}function WM(t,e,r,i,f){var l;if((l=qM())<0)return false;XE[l].InUse=true;XE[l].type=t;XE[l].id1=e;XE[l].id2=-1;XE[l].id3=-1;XE[l].HotRectCount=1;XE[l].HotRect[0].left=r-dV(tc.RULER_TOLERANCE);XE[l].HotRect[0].top=i;XE[l].HotRect[0].right=r+dV(tc.RULER_TOLERANCE);XE[l].HotRect[0].bottom=f;XE[l].ObjPointCount=2;XE[l].ObjPoint[0].x=r;XE[l].ObjPoint[0].y=i;XE[l].ObjPoint[1].x=r;XE[l].ObjPoint[1].y=f;return true}function UM(t,e,r,i,f){var l;if((l=qM())<0)return false;XE[l].InUse=true;XE[l].type=t;XE[l].id1=e;XE[l].id2=-1;XE[l].id3=-1;XE[l].HotRectCount=1;XE[l].HotRect[0].left=r;XE[l].HotRect[0].top=f-hV(tc.RULER_TOLERANCE);XE[l].HotRect[0].right=i;XE[l].HotRect[0].bottom=f+hV(tc.RULER_TOLERANCE);XE[l].ObjPointCount=2;XE[l].ObjPoint[0].x=r;XE[l].ObjPoint[0].y=f;XE[l].ObjPoint[1].x=i;XE[l].ObjPoint[1].y=f;return true}function kM(t,e){var r,i,f,l,a,n,c,s,_,o;r=XE[KE].id1;_=kl[r].OrgX;n=kl[r].x;s=kl[r].y;c=kl[r].ParaY;i=vV(XE[KE].ObjPoint[2].x);l=vV(XE[KE].ObjPoint[2].y);f=vV(XE[KE].ObjPoint[3].x);a=vV(XE[KE].ObjPoint[3].y);if(YE==tc.DRAG_HOT_LEFT){i+=gV(t);l+=vV(e);if(Math.abs(i-f)<tc.RULER_TOLERANCE)i=f;if(Math.abs(l-a)<tc.RULER_TOLERANCE)l=a}else if(YE==tc.DRAG_HOT_RIGHT){f+=gV(t);a+=vV(e);if(Math.abs(i-f)<tc.RULER_TOLERANCE)f=i;if(Math.abs(l-a)<tc.RULER_TOLERANCE)a=l}TW(r,i,l,f,a);if(kl[r].pict>0){if(Ci){kl[r].x-=MV(dW(Lo))}kl[r].ParaY+=kl[r].y-s;kl[r].OrgX=_+(kl[r].x-n);yJ(false,true,0,true);return true}i=kl[r].x;l=hV(kl[r].y);o=qe;if(l>=Ze){l-=Ze;o++}l=vV(l);if(Ci){l-=HV(rr);i-=MV(er);var u=G5(br);i-=to[u].LeftMargin*1440}kl[r].x=n;kl[r].y=s;kl[r].ParaY=c;_i.TerMoveParaFrame2(r,i,l,-1,-1,o);uW(r);i=rd;l=fd;f=id;a=ld;return true}function XM(){var t;for(t=0;t<VE;t++){if(XE[t].InUse&&XE[t].type==tc.DRAG_TYPE_PICT_SIZE){rG(XE[t].ObjRect,wf,true,true);break}}QM(tc.DRAG_TYPE_PICT_SIZE);JE=!JE;return true}function KM(){QM(tc.DRAG_TYPE_FRAME_SIZE);zE=!zE;return true}function YM(){var t;var e;var r=new tc.RECT;for(t=0;t<VE;t++){if(XE[t].InUse&&(XE[t].type==tc.DRAG_TYPE_FRAME_SIZE||XE[t].type==tc.DRAG_TYPE_PICT_SIZE)){if(XE[t].type==tc.DRAG_TYPE_FRAME_SIZE)e=XE[t].id1;else{var i=XE[t].id1;e=xs[i].ParaFID}if(Nj(kl[e].flags&tc.PARA_FRAME_LINE))tG(XE[t].ObjPoint[0].x,XE[t].ObjPoint[0].y,XE[t].ObjPoint[1].x,XE[t].ObjPoint[1].y,wf,r,false,true);else rG(XE[t].ObjRect,wf,true,true);break}}ZE=!ZE;return true}function VM(){if(XE[KE].InUse&&XE[KE].type==tc.DRAG_TYPE_CTL_SIZE){rG(XE[KE].ObjRect,wf,true,true);if(XE[KE].id2==1)XE[KE].id2=0;else XE[KE].id2=1}return true}function jM(){var t=[6];var e,r;var i=new tc.RECT;for(e=0;e<XE[KE].ObjPointCount;e++){t[e]=new tc.Point(XE[KE].ObjPoint[e])}eG(t,XE[KE].ObjPointCount,new tc.Pen(tc.Color.black),null,k,true,true);if(XE[KE].ObjPointCount==5)r=0;else r=1;tG(XE[KE].ObjPoint[r].x,Gt,XE[KE].ObjPoint[r].x,Gt+rt.bottom-rt.top,wf,i,false,true);XE[KE].drawn=!XE[KE].drawn;return true}function JM(t){var e=t>=k.top&&t<=k.bottom?true:false;if(e||XE[KE].drawn){tG(XE[KE].ObjPoint[0].x,XE[KE].ObjPoint[0].y,XE[KE].ObjPoint[1].x,XE[KE].ObjPoint[1].y,wf,k,true,true);tG(XE[KE].ObjPoint[1].x,XE[KE].ObjPoint[1].y,XE[KE].ObjPoint[1].x,Gt+rt.bottom-rt.top,wf,rt,true,true);XE[KE].drawn=!XE[KE].drawn}return true}function zM(){tG(XE[KE].ObjPoint[0].x,XE[KE].ObjPoint[0].y,XE[KE].ObjPoint[1].x,XE[KE].ObjPoint[1].y,wf,rt,true,true);if(oi.ruler){var t=Gt-(rt.top-k.top);var e=t+(k.bottom-k.top);tG(XE[KE].ObjPoint[0].x,t,XE[KE].ObjPoint[1].x,e,new tc.Pen(tc.Color.black),k,true,true)}XE[KE].drawn=!XE[KE].drawn;return true}function ZM(){tG(XE[KE].ObjPoint[0].x,XE[KE].ObjPoint[0].y,XE[KE].ObjPoint[1].x,XE[KE].ObjPoint[1].y,wf,rt,true,true);XE[KE].drawn=!XE[KE].drawn;return true}function QM(t){var e,r;Ti.save();UG();for(e=0;e<VE;e++){if(!XE[e].InUse)continue;if(XE[e].type!=t)continue;for(r=0;r<XE[e].HotRectCount;r++){TG(Ti,XE[e].HotRect[r])}}Ti.restore();return true}function qM(){var t,e;t:{for(t=0;t<VE;t++)if(!XE[t].InUse)break t;if(VE>=jE){if(jE<100)jE+=20;else jE+=50}if(VE<jE){t=VE;VE++}else{if(Dj(Vh&tc.MSG_MAX_DRAG)){QY(tc.MSG_OUT_OF_DRAG_OBJ,null);Vh|=tc.MSG_MAX_DRAG}return-1}}XE[t]=new tc.ClsDragObj;XE[t].ObjPoint=[6];for(e=0;e<6;e++)XE[t].ObjPoint[e]=new tc.Point(0,0);XE[t].ObjRect=new tc.RECT;XE[t].HotRect=[8];for(e=0;e<8;e++)XE[t].HotRect[e]=new tc.RECT(0,0);return t}function $M(t,e){var r;for(r=0;r<VE;r++){if(XE[r].type>=t&&XE[r].type<=e)XE[r].InUse=false}return true}function tG(t,e,r,i,f,l,a,n){ZU("TerDrawLine");if(a){var c=Gt-rt.top;var s=new tc.Rectangle(l.left,l.top+c,l.right-l.left,l.bottom-l.top);Ti.save()}if(n)uG(Ti,t,e,r,i,f);else OH(Ti,f,t,e,r,i);if(a)Ti.restore();return true}function eG(t,e,r,i,f,l,a){var n;var c;ZU("TerDrawPolygon");if(a)l=false;if(l){var s=Gt-rt.top;var _=new tc.Rectangle(f.left,f.top+s,f.right-f.left,f.bottom-f.top);Ti.save();WG(Ti,_)}if(a){for(n=0;n+1<e;n++){tG(t[n].x,t[n].y,t[n+1].x,t[n+1].y,r,f,false,true)}tG(t[n].x,t[n].y,t[0].x,t[0].y,r,f,false,true)}else{c=[e];for(n=0;n<e;n++)c[n]=t[n];RJ(Ti,wf,c)}if(l)Ti.restore();return true}function rG(t,e,r,i){var f=[5];ZU("TerDrawRect");if(r){Ti.save();UG()}if(i){tG(t.left,t.top,t.right,t.top,e,t,false,true);tG(t.right,t.top,t.right,t.bottom,e,t,false,true);tG(t.right,t.bottom,t.left,t.bottom,e,t,false,true);tG(t.left,t.bottom,t.left,t.top,e,t,false,true)}else{f[0].x=t.left;f[0].y=t.top;f[1].x=t.right;f[1].y=t.top;f[2].x=t.right;f[2].y=t.bottom;f[3].x=t.left;f[3].y=t.bottom;f[4].x=t.left;f[4].y=t.top;RJ(Ti,e,f)}if(r)Ti.restore();return true}function iG(){var t,e,r,i;var f=je;var l,a,n;ZU("GetWinDimension");if(oi.ShowMenu){K=new tc.RECT(0,xO,ee.width,ee.height-xO)}else K=new tc.RECT(ee.width,ee.height);if(ve>0){if(K.right>K.left+3){K.left+=ve;K.right-=ve}if(K.bottom>K.top+3){if(xO==0)K.top+=ve;K.bottom-=ve}}if(oi.ShowVerBar&&K.right>Y)K.right-=Y;if(oi.ShowHorBar&&K.bottom>Y)K.bottom-=Y;Ti.setTransform(1,0,0,1,0,0);rt=K.copy();k=new tc.RECT;X=new tc.RECT;B=new tc.RECT;if(G==null)G=new tc.RECT;r=v.getHeight()+v.getLeading();if(r<=0)r=1;i=xs[0].CharWidth[tc.CHAR_m];if(i<=0)i=1;if(oi.ruler){k.top=K.top+wA;k.bottom=k.top+2*Hr;t=k.bottom-k.top}else t=0;if($A){X.left=K.left;X.right=X.left+2*Hr;e=X.right-X.left}else e=0;if(xs[0].CharWidth[tc.CHAR_m]>0)tt=(K.right-K.left)/i-1;Dt=(K.bottom-K.top-t)/r;if(Dt==0)Dt=1;if(tt<=0)tt=1;if(oi.BorderMargin&&Nt>0){he=tc.BORDER_MARGIN;rt.left=K.left+e+FV(tc.BORDER_MARGIN);rt.right=K.right-FV(tc.BORDER_MARGIN);rt.top=K.top+t+wA+OV(tc.BORDER_MARGIN);rt.bottom=K.bottom-OV(tc.BORDER_MARGIN)}else{rt=K.copy();rt.left+=e;rt.top+=t+wA;he=0}se=oi.ShowStatus?Ot+6*vt:0;rt.bottom-=se;k.left=K.left;k.right=K.right;if(oi.ShowVerBar)k.right+=Y;X.top=K.top+wA+t;X.bottom=K.bottom-se;je=rt.right-rt.left;Mt=rt.bottom-rt.top;Vv(false);a=20;n=K.bottom-K.top-2*15;if(a>n/2)a=n/2;ut=Mj(a,tc.SCROLL_RANGE,n);if(WA!=null){var c=0;if(!oi.ShowMenu)c+=ve;else c+=xO;for(l=FL;l<FL+dL;l++){if(WA[l]==null)continue;WA[l].x=K.left;WA[l].y=c;WA[l].width=_i.cvs.width;WA[l].height=bA[l];c+=bA[l]}}pl[0].width=pl[0].ScrWidth=29999;pl[0].height=pl[0].ScrHeight=Mt;et=Ti;if(_l){Ti.setTransform(1,0,0,1,0,0);Ti.translate(-Ft+rt.left,-Gt+rt.top)}if(false&&Nj(et)){et.setTransform(1,0,0,1,0,0);et.translate(-Ft,-Gt)}if(oi.ShowMenu)Kj();if(Nj(jh)&&Jh==tc.BKPICT_STRETCH)HN(jh,Mt,je,true);if(oi.FittedView&&je!=f&&f>0)_z(true);return true}function fG(){var t=window.innerHeight;var e=window.innerWidth;if(_i.IsMobileOS){t=window.visualViewport.height;e=window.visualViewport.width;if(window.innerWidth!=dt){dt=window.innerWidth;Rt=0;ie=0;Ct=0;It=0}}if(t>Rt)Rt=t;if(ie==0)ie=t;else if(t<ie)ie=t;if(e>Ct)Ct=e;if(It==0)It=e;else if(e<It)It=e;if(_i.IsMobileOS&&t<Rt*3/4)cf=true;else if(_i.InIPhone)cf=true;Lt=e;return t}_i.TerRepaint=function(t){var e,r,i;var f;var l;ZU("e.TerRepaint");if(!lv||!QD())_i.TerCreateControl();aO|=tc.TOFLAG_FULL_PAINT;f=false;if(t&&Ti!=null)Ti.clearRect(0,0,_i.cvs.width,_i.cvs.height);r=je;i=Mt;iG();Tp(true,true);if(_i.caret!=null&&_i.cvs!=null)_i.caret.setCanvas(_i.cvs);if(t||Zr)VG();if((Li||Nj(rO&tc.TFLAG8_AUTO_REFORMAT_TABLES))&&je!=r){if(fR>1)_i.TerAdjustHtmlTable();MK();if(Ys>1)GK();if(fR>1)_z(true)}if(we>=Dt){we=Dt-1;fr=br-we}bG(true);l=Fo;if(t){$R=true;ai=true}cG();if(Li&&fR>1)Fo=l;fB(true);if(oi.ShowStatus&&Oi)tB();if(Xi||t||je!=r||f){if(WA!=null)EN();if(Nj(UA))UA.repaint()}Xi=true;if(Li&&(je!=r||Mt!=i))UD(tc.TER_HTML_SIZE,S,0,false);if(oi.FittedView&&je!=r&&r>0)_z(true);oj(tc.TOFLAG_FULL_PAINT|tc.TOFLAG_PAINT_WAITING);return true};function lG(t){ZU("RepaintTer");var e;if(hi)return true;if(!oi.open)return true;if(Wi){Wi=false;if(sf==Se)return true}Ur=true;$R=true;UO=true;return _i.TerRepaint(false)}_i.TerApplySize=function(t,e){var r;ee.width=Math.floor(I*t);ee.height=Math.floor(I*e);ee.style.width=t+"px";ee.style.height=e+"px";return};_i.TerCssToDevice=function(t){return JV(t)};_i.TerDeviceToCss=function(t){return zV(t)};function aG(t){var e;for(e=0;e<Ys;e++){if(!xs[e].InUse||xs[e].gr!=Ti)continue;xs[e].gr=t;if(oi.PrintView)Xs[e].gr=t}return true}_i.TerQuickRepaint=function(){ZU("TerQuickRepaint");if(!lv||!QD())_i.TerCreateControl();cG();return true};function nG(){return true}function cG(){var t,e,r,i;var f,l;var a;var n=0;var c=fr;ZU("PaintTer");Oi=false;if(fr%1!=0)fr=Math.floor(fr);if(fr<0)fr=0;if(br%1!=0)br=Math.floor(br);if(br<0)br=0;if(!_l)return true;if(!si||Nj(qh&tc.TFLAG4_NO_REPAGINATE))return true;Ui=false;ki=false;a=Ti;hi=true;if(Ru){b0();hi=false;return true}if(sA>=Ri||_A>=Ri)uA=tc.HILIGHT_OFF;if(dr)Ex(Ti);if(Nj(M)){var s=_i.TerPastePicture("",M,0,tc.ALIGN_BOT,false);M=null;if(Nj(s))_i.TerSetBkPictId(s,tc.BKPICT_STRETCH,false);bG(true)}if(Nj(Br&tc.PAINT_MIN)){if(xr&&!GY(br,tc.INFO_PAGE))Br=tc.PAINT_WIN;if(!xr&&GY(br,tc.INFO_PAGE))Br=tc.PAINT_WIN}if(Br==tc.PAINT_WIN_RESET)bG(true);else if(Nj(jh)&&Br==tc.PAINT_WIN&&Dj(aa))bG(false);if(Br==tc.PAINT_WIN_RESET)Br=tc.PAINT_WIN;if(UR){si=false;U5(false);si=true}aq();t:while(true){l=Br;e=Dt+10;if(oi.PageMode&&(Nl=iW(br))>=0){e=Dt+20;fr=Jq(pl[Nl].x,Gt);if(br<fr){fr=po[Lo].FirstLine;if(br<fr)fr=br}if(Nj(pl[Nl].flags&tc.FRAME_ON_SCREEN)&&pl[Nl].ScrFirstLine<fr&&pl[Nl].ScrFirstLine>=0)fr=pl[Nl].ScrFirstLine;if(Nj(Nc[ui[fr].pfmt].flags&tc.PAGE_HDR_FTR)!=Nj(Nc[ui[br].pfmt].flags&tc.PAGE_HDR_FTR)){fr=br;if(Dj(Nc[ui[br].pfmt].flags&tc.PAGE_HDR_FTR)&&fr>=po[Lo].FirstLine&&fr<=po[Lo].FirstLine)fr=po[Lo].FirstLine}if(yn==tc.WRAP_PAGE){fr=po[Lo].FirstLine;if(Lo==To-1)e=Ri-fr;else e=po[Lo+1].FirstLine-fr}}if(NS)PY("ww: ",oi.WordWrap,"flags: ",yn,tc.WRAP_OFF,"op flag: ",Nj(nO&tc.TOFLAG2_NO_WRAP));if(oi.WordWrap&&yn!=tc.WRAP_OFF&&Dj(nO&tc.TOFLAG2_NO_WRAP)){var _=(new Date).getTime();var o=50;if(NS)PY("cmd: ",Zt,"times: ",_-Ge,o);if(Zt>0||_-Ge>o){if(NS)PY("calling word wrap");T9(fr,e);Ge=_}else di=true}if(Nj(it))Br=tc.PAINT_WIN;if(Nj(it))it.flush();it=null;if(br>=Ri)br=Ri-1;if(oi.WordWrap&&jt>=ui[br].len)jt=ui[br].len-1;if(jt<0)jt=0;lq();r=Lo;Lo=cz(br);if(Lo!=r){yn=tc.WRAP_WIN;Br=tc.PAINT_WIN}if(jt<0)jt=0;if(!oi.PageMode){if(we+2>=Dt&&!D$()){fr=br+2-(Dt-1);if(fr<0)fr=0;Br=tc.PAINT_WIN}if(fr<0)fr=0;we=br-fr;if(we<0){fr=br;we=0;Br=tc.PAINT_WIN}}if(fr!=Ue)Ue=-1;if(Ue==-1)zt=0;if(uA!=tc.HILIGHT_OFF&&OA){if(!Bh||!n6(ui[sA].cid,ui[_A].cid)){DB()}if(Br!=tc.PAINT_WIN)Br=tc.PAINT_WIN}if(uA!=tc.HILIGHT_OFF&&!OA&&sA==_A&&TA==AA)uA=tc.HILIGHT_OFF;if(!oi.PageMode){Nl=0;pl[Nl].ScrFirstLine=fr;pl[Nl].PageFirstLine=0;pl[Nl].PageLastLine=Ri-1;pl[Nl].level=0}if(JE){Br=tc.PAINT_WIN;XM()}if(zE){Br=tc.PAINT_WIN;KM()}$M(tc.DRAG_TYPE_SCR_FIRST,tc.DRAG_TYPE_SCR_LAST);if(Br<tc.PAINT_WIN&&ti&&!s4())Br=tc.PAINT_WIN;if(Br>=tc.PAINT_WIN)ti=false;if(Br>=tc.PAINT_WIN){for(f=0;f<Ys;f++)if(xs[f].InUse&&Nj(xs[f].style&tc.PICT))xs[f].flags=cj(xs[f].flags,tc.FFLAG_PICT_DRAWN|tc.FFLAG_CTL_DRAWN|tc.FFLAG_DRAW_PENDING)}ne++;B.left=-1;if(Br>=tc.PAINT_WIN)xr=false;qr=true;if(Br==tc.PAINT_WIN&&jh==0&&a==et){var u=new tc.RECT;u=VY(Ft,Gt,Ft+je,Gt+Mt);var T=fA;fA=nZ();TB(a,0,0,tc.ETO_OPAQUE,u,null,0,null);fA=T;qr=false}else CG(a);BA=0;s_=0;if(!oi.WordWrap&&fr!=c&&Sf!=null){Sf=null}if(oi.PageMode){a.save();UG();if(Br==tc.PAINT_LINE||Br==tc.PAINT_RANGE){var A=Nj(Zh&tc.TFLAG2_FULL_REPAINT);if(!A){var E,R;var L=c$(br);s$(br,L,true);E=Sd;R=hd;L+=E+R;if(Math.abs($q(br,false)-L)>.5)A=true}if(A){Br=tc.PAINT_WIN;yn=tc.WRAP_WIN;CG(a);AG(a,-1)}else AG(a,br)}else if(Br==tc.PAINT_PARTIAL_WIN||Br==tc.PAINT_WIN)AG(a,-1);a.restore()}else{if(zR&&!ZR)_i.caret.hide();a.save();UG();if(Br==tc.PAINT_LINE){if(e$(br)!=c$(br))Br=tc.PAINT_PARTIAL_WIN;else IG(a,we,we)}if(Br==tc.PAINT_PARTIAL_WIN)IG(a,we-1,9999);else if(Br==tc.PAINT_WIN)IG(a,0,9999);a.restore()}a.setTransform(1,0,0,1,0,0);a.translate(-Ft+rt.left,-Gt+rt.top);DG();qr=true;if(BA>0)oG(a);if(Br>=tc.PAINT_WIN){var C=false;for(f=0;f<Ys;f++){if(!xs[f].InUse||Dj(xs[f].style&tc.PICT)||Nj(xs[f].flags&(tc.FFLAG_CTL_DRAWN|tc.FFLAG_DRAW_PENDING)))continue;if(Dj(xs[f].flags&tc.FFLAG_CTL_VISIBLE))continue;if(Kw(f))C=true}}if(hn)TN(a);if(Ka)GB(a);if(Nj(et)&&_l){if(NS)tg.disable=true;if(!tg.disable){NG()}else if(tg.disable){oJ(a,new tc.Brush(tc.Color.white),new tc.Rectangle(Ft,Gt,je,Mt));var I="EVALUATION EXPIRED!  TO PURCHASE, PLEASE VISIT:  WWW.SUBSYSTEMS.COM";if(tg.LicenseYYMM>0)I="License Expired on year: "+mY(Math.floor(2e3+tg.LicenseYYMM/100))+", month: "+mY(tg.LicenseYYMM%100)+", Please visit:  WWW.SUBSYSTEMS.COM";sJ(a,I,xs[0].font,new tc.Brush(tc.Color.black),new tc.Point(Ft,Gt+Mt/2))}}Ur=false;if(VR)eB();kG();if(zR&&!ZR&&_l&&_i.dialog==null)_i.caret.show();if(ai||ni||Lo!=pt||Pt!=G5(br)||gt!=ui[br].x||l==tc.PAINT_WIN){if(VR||_i.HasTouchScreen)fB(true)}if(oi.ShowHorBar||oi.ShowVerBar)h$();uq();if(UO)ur=tc.SPILL_LEFT|tc.SPILL_RIGHT|tc.SPILL_TOP|tc.SPILL_BOT;if(Nj(ur))RB(ur);UO=false;if(_i.HasTouchScreen)sG(a);Br=tc.PAINT_WIN;yn=tc.WRAP_WIN;aa=true;vT=br;pT=jt;DT=Xt+Gt;NT=Lo;MT=tc.CURS_RESET;Sf=null;ur=0;if(Dj($h&tc.TFLAG5_GROUP_UNDO))uE++;Gr=true;No=false;Se++;if(uA!=tc.HILIGHT_CHAR||!OA)DA=false;if(!oi.PageMode&&br>pl[0].ScrLastLine&&fr<br){fr++;continue t}break}if(Nj(zh&tc.TFLAG_AUTO_VSCROLL_BAR)||Nj(fO&tc.TFLAG10_AUTO_HSCROLL_BAR)){var d=false,F=false,g=false;var P=oi.ShowVerBar;var S=oi.ShowHorBar;var h,O;if(Nj(fO&tc.TFLAG10_AUTO_HSCROLL_BAR)){var v=0;if(oi.WordWrap&&(oi.PageMode||!M$())){if(oi.PageMode)v=Az(true);else v=M9(br,-1)}else{for(h=fr;h<=pl[0].ScrLastLine;h++){O=B$(h,true,true);if(O>v)v=O}}if(v>je+1||Ft>0)d=true;if(d!=S)_p(d)}if(Nj(zh&tc.TFLAG_AUTO_VSCROLL_BAR)||Nj(fO&tc.TFLAG10_AUTO_HSCROLL_BAR)){if(!oi.WordWrap||!oi.PageMode){if(fr>0&&D$()){fr=0;cG()}F=fr!=0||pl[0].ScrLastLine+1!=Ri}if(oi.PageMode){F=Gt>0||To>1||oz(0,To)>Mt}else if(oi.FittedView){F=Gt>0||To>1||Yt>Mt}if(F!=P)sp(F)}if(F&&!P&&oi.ShowVerBar)g=true;else if(d&&!S&&oi.ShowHorBar)g=true;if(g)h$()}Oi=true;hi=false;ci=false;KQ(false);BD(_i,Ti);return true}function sG(t){if(uA==tc.HILIGHT_OFF){YQ(false,tc.SEL_BEG_HANDLE_IDX,0,0);YQ(false,tc.SEL_END_HANDLE_IDX,0,0);return true}_G(t,tc.SEL_BEG_HANDLE_IDX);_G(t,tc.SEL_END_HANDLE_IDX);return true}function _G(t,e){var r,i,f,l,a;if(e==tc.SEL_BEG_HANDLE_IDX){r=sA;i=TA}else{r=_A;i=AA}f=iW(r);if(f<0){YQ(false,e,0,0);return true}_i.TerTextPosToPix(tc.REL_WINDOW,r,i);l=td;a=ed;a+=ui[r].height;if(l<rt.left||l>rt.left+je||a<rt.top||a>rt.top+Mt){YQ(false,e,0,0);return true}YQ(true,e,l,a);return true}function oG(t){if(!_l)return true;for(i=0;i<BA;i++){var e=mA[i].x-Ft;var r=mA[i].y-Gt;var f=Math.ceil(mA[i].width);var l=Math.ceil(mA[i].height);if(e>je)continue;if(e+f<0)continue;if(false&&e<0){f+=e;e=0}if(e+f>je){f=je-e}e+=rt.left;if(r>Mt)continue;if(r+l<0)continue;if(r<0){l+=r;r=0}if(r+l>Mt){l=Mt-r}r+=rt.top;e=Math.round(e);r=Math.round(r);f=Math.round(f);l=Math.round(l);if(f<1)f=1;if(l<1)l=1;var a=t.getImageData(e,r,f,l);var n=a.data;var c=0,s,_;for(s=0;s<l;s++){c=s*(f*4);for(_=0;_<f;_++){n[c]=255-n[c];n[c+1]=255-n[c+1];n[c+2]=255-n[c+2];c+=4}}a.data=n;t.putImageData(a,e,r)}return true}function uG(t,e,r,i,f,l){var a,n,c;var s,_;var o,u;var T=false,A=false;var E=false;var R=false;var L=true,C=true;e=Math.round(e-Ft+rt.left);i=Math.round(i-Ft+rt.left);r=Math.round(r-Gt+rt.top);f=Math.round(f-Gt+rt.top);if(i>e)L=true;else L=false;if(f>r)C=true;else C=false;if(i<e){c=e;e=i;i=c;A=true}if(f<r){c=r;r=f;f=c;T=true}_=f-r;s=i-e;var I=_==0||s==0;a=i-e;n=f-r;if(a<=0)a=1;if(n<=0)n=1;var d=t.getImageData(e,r,a,n);var F=d.data;var g=0,P,S;if(_>=s||I){for(P=0;P<n;P++){g=P*(a*4);for(S=0;S<a;S++){E=false;R=false;o=T?n-P:P;u=A?a-S:S;if(I)E=u*_==o*s;else{if(L){if(u*_>o*s){R=true;E=true}}else{if(u*_<o*s){R=true;E=true}}}if(E){F[g]=255-F[g];F[g+1]=255-F[g+1];F[g+2]=255-F[g+2]}g+=4;if(!I&&R==true)break}}}else{for(S=0;S<a;S++){g=S*4;for(P=0;P<n;P++){E=false;R=false;o=T?n-P:P;u=A?a-S:S;if(C){if(u*_<o*s){R=true;E=true}}else{if(u*_>o*s){R=true;E=true}}if(E){F[g]=255-F[g];F[g+1]=255-F[g+1];F[g+2]=255-F[g+2]}g+=a*4;if(!I&&R==true)break}}}d.data=F;t.putImageData(d,e,r)}function TG(t,e){var r,i,f;var l=Math.round(e.left-Ft+rt.left);var a=Math.round(e.right-Ft+rt.left);var n=Math.round(e.top-Gt+rt.top);var c=Math.round(e.bottom-Gt+rt.top);if(a<l){f=l;l=a;a=f}if(c<n){f=n;n=c;c=f}r=a-l;i=c-n;if(r<=0)r=1;if(i<=0)i=1;var s=t.getImageData(l,n,r,i);var _=s.data;var o=0,u,T;for(u=0;u<i;u++){o=u*(r*4);for(T=0;T<r;T++){_[o]=255-_[o];_[o+1]=255-_[o+1];_[o+2]=255-_[o+2];o+=4}}s.data=_;t.putImageData(s,l,n)}function AG(t,e){var r,i,f,l,a=0,n,c,s,_,o,u,T,A;var E,R;var L,C,I,d;var F=false,g=false;var P,S,h,O;var v,p,N;var D;var M=Br;var G=false;var B=-1,H=0,m=0;var w;ZU("PaintFrames");if(Br!=tc.PAINT_LINE&&Br!=tc.PAINT_RANGE){$M(tc.DRAG_TYPE_CELL,tc.DRAG_TYPE_CELL);$M(tc.DRAG_TYPE_ROW,tc.DRAG_TYPE_ROW);$M(tc.DRAG_TYPE_ROW_INDENT,tc.DRAG_TYPE_ROW_INDENT);$M(tc.DRAG_TYPE_CTL_SIZE,tc.DRAG_TYPE_CTL_SIZE);if(yn!=tc.WRAP_MIN&&yn!=tc.WRAP_OFF){var b=Dj(Zt==tc.ID_PGUP||Zt==tc.ID_PGDN||Zt==tc.ID_UP||Zt==tc.ID_DOWN||Qt==tc.WM_HSCROLL||Qt==tc.WM_VSCROLL||Qt==tc.WM_CHAR);my(b)}}if(Ur&&!_i.HasTouchScreen){var x=Tz();if(br>=0&&br<Ri&&Nj(ui[br].flags2&tc.LFLAG2_RTL))x+=2;if(Ft+je>x){var y=Gt;Ft=x-je;if(Ft<0)Ft=0;if(Ft!=y){if(_l){Ti.setTransform(1,0,0,1,0,0);Ti.translate(-Ft+rt.left,-Gt+rt.top)}if(false&&Nj(et)){et.setTransform(new AffineTransform);et.translate(-Ft,-Gt)}Sf=null}}}else if(_i.HasTouchScreen&&VR){var W=Ft;_i.TerTextPosToPix(tc.REL_TEXT_BOX,br,jt);var U=td+Ft;if(U<Ft){Ft=U;if(Ft<0)Ft=0;BG()}else if(U>At){Ft=U-At*9/10;if(Ft<0)Ft=0;BG()}}E=br;if(E>0&&Nj(ui[E].flags&tc.LFLAG_SECT)&&Lo>qe&&E==po[Lo].FirstLine)E--;if((Nl=iW(E))<0){var k=false;var X;for(X=E-1;X>=0;X--){if((Nl=iW(X))>0){pl[Nl].PageLastLine=br;k=true;break}}if(!k){for(;E<=po[Lo].LastLine;E++)if((Nl=iW(E))>=0)break;if(E>po[Lo].LastLine)return;br=E}}d=ui[br].fid;v=d>0&&Nj(kl[d].flags&tc.FRAME_NON_TEXT_DO);if(!v&&Nj(ui[br].flags&tc.LFLAG_PICT)){var K=ib(br,jt);if(xs[K].ParaFID>0)v=true}L=pl[Nl].y+pl[Nl].SpaceTop;T=pl[Nl].y+pl[Nl].height-pl[Nl].SpaceTop;R=-1;for(E=pl[Nl].PageFirstLine;E<=br;E++){if(L6(E)!=pl[Nl].level)continue;n=$q(E,true);if(L+n/4>=T&&R<0&&E>pl[Nl].PageFirstLine)R=E-1;if(E>=br)break;L+=n}if(!_i.HasTouchScreen&&L>Gt+Tt-$q(br,true))F=true;var Y=$q(E,true);var V=Y-$q(E,false);if(L+V<Gt)g=true;C=I=L;if(_i.HasTouchScreen)I+=Y;if(Nj(Qh&tc.TFLAG3_CURSOR_IN_CELL)&&br>R&&R>=0){br=R;jt=ui[br].len-1;if(jt<0)jt=0}else if(VR&&!v&&Dj(it)&&!jr&&(C<=Gt||I>Gt+Tt))GG(br);else Xt=L-Gt;if(Nj(Qh&tc.TFLAG3_NO_SCROLL)){var j=false;if(Gt!=0&&!_i.HasTouchScreen){Gt=0;j=true}if(Ft!=0&&!oi.ShowHorBar&&!_i.HasTouchScreen){Ft=0;j=true}if(j)BG()}if((Nl=iW(br))<0)return;if(Ue<0&&g&&VR&&!v&&Dj(it)&&!jr&&Dj(Qh&tc.TFLAG3_NO_SCROLL)){if(pl[Nl].y+pl[Nl].SpaceTop<Gt&&pl[Nl].y+pl[Nl].height>Gt&&!_i.HasTouchScreen){L=pl[Nl].y+pl[Nl].SpaceTop;for(E=pl[Nl].PageFirstLine;E<br;E++){if(L6(E)!=pl[Nl].level)continue;n=$q(E,true);if(!F&&L+n/2>Gt)break;if(L>Gt)break;L+=n}if(L!=Gt){Xt=Xt-(L-Gt);Gt=L;BG();if(jh>0)bG(true)}}}if(Br==tc.PAINT_WIN&&Br!=M){CG(t)}c=Nl;if(zR&&!ZR)_i.caret.hide();UG();fr=-1;Dt=0;if($l>0&&Br>=tc.PAINT_WIN){for(f=0;f<Dl;f++){if(Dj(pl[f].flags&tc.FRAME_WATERMARK))continue;if(pl[f].ScrX>=Ft+je)continue;if(pl[f].ScrX+pl[f].ScrWidth<=Ft)continue;if(pl[f].y>=Gt+Mt)continue;if(pl[f].ScrY+pl[f].ScrHeight<=Gt)continue;d=pl[f].ParaFrameId;w=kl[d].pict;if(w>0)hG(t,pl[f].ScrX,pl[f].ScrY,pl[f].width,pl[f].height,w,1,0,true)}}u=bl?1:5;A=0;$n=false;rc=ic=ec=-1;Wl=null;xl=yl=0;for(i=0;i<u;i++){for(r=0;r<Dl;r++){f=pl[r].DispFrame;if(Nj(pl[f].flags&tc.FRAME_WATERMARK))continue;d=pl[f].ParaFrameId;if(d>0&&kl[d].width<0)continue;if(d>0&&Nj(kl[d].flags2&tc.PF2_HIDDEN))continue;if(pl[f].BoxFrame==f&&JW(d))continue;if(!bl){if(i==0&&d!=0)continue;if(i>0&&d==0&&Dj(pl[f].flags&(tc.FRAME_BORDER|tc.FRAME_PAGE_BOX)))continue;if(i==1&&!pl[f].empty&&br>=pl[f].PageFirstLine&&br<=pl[f].PageLastLine)continue;if(i>1&&pl[f].empty&&pl[f].BoxFrame==f&&d>0)continue;if(i==2&&!pl[f].empty&&(br<pl[f].PageFirstLine||br>pl[f].PageLastLine))continue;p=Nj(kl[d].flags&(tc.PARA_FRAME_LINE|tc.PARA_FRAME_RECT));if(p&&Nj(kl[d].flags&tc.PARA_FRAME_RECT)&&kl[d].FillPattern>0)p=false;if(i!=3&&p)continue;if(i==3&&!p)continue;if(i!=4&&Nj(pl[f].flags&(tc.FRAME_BORDER|tc.FRAME_PAGE_BOX)))continue;if(i==4&&Dj(pl[f].flags&(tc.FRAME_BORDER|tc.FRAME_PAGE_BOX)))continue}Nl=f;li=Nj(pl[Nl].flags&tc.FRAME_TRANSPARENT)||Nj(Zh&tc.TFLAG2_XPARENT_WRITE);A++;pl[f].DispOrder=A;if(Nj(aO&tc.TOFLAG_INSERT_CHAR)&&!Po&&pl[f].ParaFrameId==0&&pl[f].PageFirstLine<pl[f].PageLastLine){var J=pl[f].PageFirstLine;if(J>=0&&J<Ri&&ui[J].fid>0)pl[f].PageFirstLine++}pl[f].ScrX=pl[f].x;pl[f].ScrY=pl[f].y+pl[f].SpaceTop;pl[f].ScrWidth=pl[f].width;pl[f].ScrHeight=pl[f].height-pl[f].SpaceTop;if(pl[f].LimitY!=-1&&pl[f].height>pl[f].LimitY-pl[f].y)pl[f].ScrHeight=pl[f].LimitY-pl[f].ScrY;pl[f].ScrFirstLine=-1;if(Br!=tc.PAINT_LINE&&Br!=tc.PAINT_RANGE)pl[f].ScrLastLine=-1;pl[f].flags=cj(pl[f].flags,tc.FRAME_ON_SCREEN);D=pl[f].border;N=false;if(pl[f].ParaFrameId>0)N=kl[pl[f].ParaFrameId].TextAngle>0;else if(pl[f].CellId>0)N=eR[pl[f].CellId].TextAngle>0;if(pl[f].ScrX>=Ft+je&&!N)continue;if(pl[f].ScrX+pl[f].ScrWidth<=Ft&&!N)continue;if(pl[f].y>=Gt+Mt)continue;if(pl[f].LimitY!=-1&&pl[f].y>pl[f].LimitY)continue;if(pl[f].ScrY+pl[f].ScrHeight<=Gt&&!N)continue;if(pl[f].CellId>0&&Nj(eR[pl[f].CellId].flags&tc.CFLAG_ROW_SPANNED)&&Dj(pl[f].flags&tc.FRAME_TOP_SPAN))continue;if(Nj(pl[f].flags&tc.FRAME_BORDER_TOP)&&pl[f].PageNo>qe){pl[f].ScrY--;pl[f].ScrHeight++}if(jh<0&&RG(t,f,pl[f].x,pl[f].y,pl[f].width,pl[f].height))continue;if(xl>0&&(i>B||pl[f].ZOrder>H||m!=pl[f].ParaFrameId)){G=qG(t,G);Wl=null;xl=yl=0}B=i;H=pl[f].ZOrder;m=pl[f].ParaFrameId;G=EG(t,f,G,0,0);pl[f].flags|=tc.FRAME_ON_SCREEN;if(kl[d].pict>0){w=kl[d].pict;if(w>=0&&w<Ys)xs[w].DispFrame=f}if(!pl[f].empty&&Nj(pl[f].flags&tc.FRAME_NON_TEXT_DO)){pl[f].ScrFirstLine=pl[f].ScrLastLine=pl[f].PageFirstLine;if(Br!=tc.PAINT_LINE&&Br!=tc.PAINT_RANGE){pl[f].ScrFirstLine=pl[f].ScrLastLine=pl[f].PageFirstLine;pl[f].RowOffset=a;fa[a]=0;ra[a]=pl[f].ScrY;ia[a]=0;a=a+2;if(a>=la)wX(a)}if(Br!=tc.PAINT_LINE){if(Nj(kl[d].flags&tc.PARA_FRAME_LINE))kB(t,f,0,0,0,0,0);else if(Nj(kl[d].flags&tc.PARA_FRAME_RECT))VB(t,f,0,0,0,0,0,tc.MODE_DRAW_FILL);w=kl[d].pict;if(w>0&&w<Ys&&Nj(xs[w].style&tc.PICT)){xs[w].PictX=pl[f].x;xs[w].PictY=pl[f].y}}continue}if(JW(d))VB(t,f,0,0,0,0,0,tc.MODE_FILL);if(Br>=tc.PAINT_WIN&&d>0&&pl[f].empty&&(Nj(kl[d].flags&tc.PARA_FRAME_FILL_PICT)&&kl[d].FillPict>0)){var z,Z;w=kl[d].FillPict;z=pl[f].width;Z=pl[f].height;xs[w].PictWidth=gV(z);xs[w].PictHeight=vV(Z);HN(w,Z,z,false);hG(t,pl[f].x,pl[f].y,z,Z,w,1,pl[f].PageFirstLine,true);continue}if(!pl[f].empty&&Nj(pl[f].flags&tc.FRAME_PICT)){KB(t,f);continue}if(Nj(pl[f].flags&tc.FRAME_FNOTE)){ZB(t,f,true);continue}if(pl[f].ParaFrameId>0&&pl[f].width<0)continue;lA=pl[f].shading;Ca=pl[f].BackColor;sa=pl[f].flags;if(Nj(kl[d].flags&(tc.PARA_FRAME_TEXT_BOX|tc.PARA_FRAME_CONV))&&(MJ(Ca,tc.CLR_WHITE)||pl[f].CellId==0)){if(kl[d].FillPattern>0)Ca=kl[d].BackColor;lA=-1}s=_=o=0;if(Br>=tc.PAINT_WIN&&LG(f,e)&&pl[f].SpaceTop-s>0&&pl[f].ScrY>Gt&&pl[f].y<Gt+Mt&&rW(-f)==0){var Q=new tc.RECT;if(Nj(pl[f].flags&tc.FRAME_RTL))_=o=0;Q=VY(pl[f].ScrX+_,pl[f].y+s,pl[f].ScrX+pl[f].ScrWidth-o+1,pl[f].ScrY);if(h8(f))KG(t,gk("H"),tc.DEFAULT_CFMT);else KG(t,tc.CHAR_T,tc.DEFAULT_CFMT);if(Nj(jh))fi=true;gG(t,Q.left,Q.top,Q,null,0,null,0)}pl[f].ScrFirstLine=pl[f].PageFirstLine;if(Br!=tc.PAINT_LINE&&Br!=tc.PAINT_RANGE)pl[f].ScrLastLine=pl[f].PageLastLine;P=pl[f].ScrX;S=pl[f].ScrX+pl[f].ScrWidth;h=pl[f].y;O=h+pl[f].height;if(pl[f].empty&&pl[f].CellId>0&&eR[pl[f].CellId].NextCell==-1&&Nj(pl[f].flags&tc.FRAME_LAST_ROW_FRAME)){if(Nj(pl[f].flags&tc.FRAME_RTL))P++;else S--}if(!pl[f].empty&&pl[f].ScrY<Gt&&!N){L=pl[f].ScrY;E=pl[f].ScrFirstLine;while(true){if(L6(E)!=pl[f].level)n=0;else n=$q(E,true);if(L+n>Gt)break;if(E==pl[f].ScrLastLine)break;L+=n;E++}pl[f].ScrHeight=pl[f].height-(L-pl[f].ScrY);pl[f].ScrY=L;pl[f].ScrFirstLine=E;if(fr<0)fr=E;pl[f].border=pl[f].border&~tc.BORDER_TOP}if(pl[f].ScrY+pl[f].ScrHeight>Gt+Mt&&!N){pl[f].ScrHeight=Gt+Mt-pl[f].ScrY;pl[f].border=pl[f].border&~tc.BORDER_BOT}if(f<Dl-1&&Nj(pl[f].flags&tc.FRAME_RIGHTMOST)&&!N&&pl[f].ParaFrameId==0){pl[f].ScrWidth=Ft+je-pl[f].ScrX}if((f==Dl-1||Nj(pl[f].flags&tc.FRAME_BORDER_BOT)&&pl[f].PageNo==To-1)&&!N){pl[f].ScrWidth=Ft+je-pl[f].ScrX;pl[f].ScrHeight=pl[f].height=Gt+Mt-pl[f].ScrY}so=tH(Nl);if(Br==tc.PAINT_LINE){if(!pl[f].empty&&L6(e)==pl[f].level&&e>=pl[f].ScrFirstLine&&e<=pl[f].ScrLastLine){IG(t,e-pl[f].ScrFirstLine,e-pl[f].ScrFirstLine);break}}else if(Br==tc.PAINT_RANGE){for(e=ye;e<=We;e++){if(!pl[f].empty&&L6(e)==pl[f].level&&e>=pl[f].ScrFirstLine&&e<=pl[f].ScrLastLine){IG(t,e-pl[f].ScrFirstLine,e-pl[f].ScrFirstLine)}}if(!pl[f].empty&&We>=pl[f].ScrFirstLine&&We<=pl[f].ScrLastLine)break}else if(Br!=tc.PAINT_LINE&&Br!=tc.PAINT_RANGE){pl[Nl].RowOffset=a;if(Dj(pl[f].flags&tc.FRAME_PAGE_BOX))IG(t,0,9999);if(pl[Nl].CellId>0&&(uA==tc.HILIGHT_OFF||!OA)&&Dj(pl[Nl].flags&(tc.FRAME_FIRST_ROW_FRAME|tc.FRAME_DISABLED))&&Dj(Qh&tc.TFLAG3_NO_EDIT_TABLE_COL)){var q=pl[Nl].RowId;var $=Nj(pl[Nl].flags&tc.FRAME_RTL);if(Dj($h&tc.TFLAG5_NO_DRAG_CELL_LINE)){if($E[q].FirstCell==pl[Nl].CellId){WM(tc.DRAG_TYPE_ROW_INDENT,pl[f].RowId,$?S:P,h,O)}if(!pl[f].empty)WM(tc.DRAG_TYPE_CELL,pl[f].CellId,$?P:S,h,O)}if(Dj($h&tc.TFLAG5_NO_DRAG_ROW_LINE)&&!pl[f].empty)UM(tc.DRAG_TYPE_ROW,pl[f].CellId,$?S:P,$?P:S,O)}if(!pl[f].empty){l=pl[f].ScrLastLine-pl[f].ScrFirstLine+1;a=a+l+1;if(a>=la)wX(a)}if(Nj(pl[f].flags&tc.FRAME_DIVIDER_LINE)&&!oi.FittedView&&Dj(Zh&tc.TFLAG2_HIDE_PAGE_BREAK)){var tt=pl[f].y+pl[f].height-2;if(tt>=Gt&&tt<Gt+Mt)if(f==Dl-1&&$e+1<To){}else{if(f==Qe-1){if(pl[f].height>0&&!Ci)RH(t,pl[f].x,tt,pl[f].x+pl[f].width,tt,tc.Color.black)}else if(WR)FH(t,pl[f].x,tt,pl[f].x+pl[f].width,tt)}}if(Nj(pl[f].flags&tc.FRAME_BORDER))xB(t,f)}if(JW(d)){if(G){G=EG(t,0,G,0,0)}VB(t,f,0,0,0,0,0,tc.MODE_DRAW)}if(Nj(pl[f].flags&tc.FRAME_PAGE_BOX))yB(t,f);pl[f].border=D;if(!pl[f].empty)Dt+=pl[f].ScrLastLine-pl[f].ScrFirstLine+1}if(xl>0){G=qG(t,G);Wl=null;xl=yl=0}}Wl=null;xl=yl=0;if(Br!=tc.PAINT_LINE&&Br!=tc.PAINT_RANGE&&$n)iH(t);if(G)t.restore();Nl=c;if(fr<0)fr=br;li=false}function EG(t,e,r,i,f){var l=pl[e].BoxFrame;var a=false,n=false;iF=null;if(r){if(Eu){if(Go==null)t.restore()}else t.restore();r=false}if(Nj(eO&tc.TFLAG7_SET_BOX_CLIPPING)||pl[e].CellId>0&&Nj(rR[pl[e].CellId].flags&tc.CAUX_HAS_LARGE_PICTURE)||Nj(pl[e].flags1&tc.FRAME1_OVERFLOWS_BOX)){if(pl[e].CellId>0||pl[l].ParaFrameId>0){l=e;if(l!=pl[e].BoxFrame&&pl[l].ParaFrameId>0)n=true;a=true}}else if(pl[e].CellId>0&&pl[e].ParaFrameId>0&&e!=l&&l>=0&&l<Dl&&pl[l].ParaFrameId>0)a=true;if(Nj(rO&tc.TFLAG8_NO_BOX_CLIPPING))a=false;if(a&&Dj(pl[e].flags1&tc.FRAME1_OVERFLOWS_BOX)){var c;for(c=pl[e].PageFirstLine;c<=pl[e].PageLastLine;c++){var s=ui[c].pfmt;if(Nj(Nc[s].flags&tc.BULLET)){a=false;break}}}if(a){var _=pl[l].x;var o=pl[l].y;var u=pl[l].x+pl[l].width;var T=pl[l].y+pl[l].height;var A=pl[l].width;var E=pl[l].height;if(pl[e].ParaFrameId>0){var R=pl[e].ParaFrameId;if(kl[R].TextAngle!=0){pl[l].height=A;pl[l].width=E;u=pl[l].x+pl[l].width;T=pl[l].y+pl[l].height}}if(n){var L=pl[e].BoxFrame;var C=Nj(pl[L].border&tc.BORDER_BOT)?pl[L].BorderWidth[tc.BORDER_INDEX_BOT]:0;C=Eu?mV(C):hV(C);if(T>pl[L].y+pl[L].height-C)T=pl[L].y+pl[L].height-C}if(pl[e].x>=u||pl[e].y>=T)r=true;if(pl[e].y+pl[e].height>=T||pl[e].x+pl[e].width>=u)r=true;if(!Eu&&dS)r=false;pl[l].height=E;pl[l].width=A;if(r){_-=Eu?DV(108):dV(108);if(Eu){if(Go==null)t.save();WG(t,new tc.Rectangle(_+i,o+f,u-_+1,T-o+1))}else{t.save();WG(t,new tc.Rectangle(_,o,u-_+1,T-o+1))}}}return r}function RG(t,e,r,i,f,l){var a=0,n=0;var c=true;if(vl==null||Fl!=Ul||Ol!=oi.modified)return false;if(je!=Sl||Mt!=hl)return false;if(e>=0&&pl[e].ParaFrameId>0){var s=pl[e].ParaFrameId;if(kl[s].TextAngle!=0||kl[s].rotation!=0)return false}r-=1;f+=2;i-=1;l+=2;if(r<Ft)r=Ft;if(r+f>Ft+je)f=Ft+je-r;if(f<=0)return false;if(i<Gt)i=Gt;if(i+l>Gt+Mt)l=Gt+Mt-i;if(l<=0)return false;a=r-gl;if(a<0)return false;if(a+f>Sl)return false;n=i-Pl;if(n<0)return false;if(n+l>hl)return false;t.save();t.mozImageSmoothingEnabled=false;t.webkitImageSmoothingEnabled=false;t.msImageSmoothingEnabled=false;t.imageSmoothingEnabled=false;try{t.drawImage(vl,a,n,f,l,r,i,f,l)}catch(t){c=false}t.restore();return c}function LG(t,e){ZU("FrameToDraw");if(Br==tc.PAINT_LINE){if(!pl[t].empty&&L6(e)==pl[t].level&&e>=pl[t].ScrFirstLine&&e<=pl[t].ScrLastLine){return true}}else if(Br==tc.PAINT_RANGE){for(e=ye;e<=We;e++){if(!pl[t].empty&&L6(e)==pl[t].level&&e>=pl[t].ScrFirstLine&&e<=pl[t].ScrLastLine){return true}}}else return true;return false}function CG(t){if(Nj(Zh&tc.TFLAG2_XPARENT_WRITE)&&(Br==tc.PAINT_WIN||Br==tc.PAINT_WIN_RESET)){Nl=0;gB(t,Ft,Gt,Ft+je,Gt+Mt,true)}return true}function IG(t,e,r){var i;var f,l,a,n,c,s,_,o;var u,T,A;var E,R,L=0,C=0;var I,d,F,g;var P,S,h;var O;var v=0,p=0;var N,D;var M;var G=new tc.RECT;var B;var H;var m,w;var b,x,y=-1,W=-1;var U=false;var k;var X;var K,Y;var V=false,j=false;var J=false,z;var Z;var Q,q=false,$=false;var tt;var et;ZU("PaintRows");x=Dt;b=uA;if(uA==tc.HILIGHT_CHAR&&QE&&sA==_A&&TA==AA-1)uA=tc.HILIGHT_OFF;if(uA==tc.HILIGHT_CHAR&&sA==_A&&TA==AA-1){et=ib(sA,TA);if(Nj(xs[et].style&tc.PICT))uA=tc.HILIGHT_OFF}if(e<0)e=0;I=pl[Nl].ScrX;d=Ea=pl[Nl].ScrY;F=I+pl[Nl].ScrWidth;g=d+pl[Nl].ScrHeight;if(g>pl[Nl].y+pl[Nl].height)g=pl[Nl].y+pl[Nl].height;if(Nl<Qe&&pl[Nl].ParaFrameId>0&&g>Ze&&Ie==0&&!oi.FittedView){pl[Nl].LimitY=g=Ze-(Ci?yV(ir):0);pl[Nl].height=g-pl[Nl].y}O=pl[Nl].PageLastLine;if(O<Ri&&GY(O,tc.INFO_ROW)&&O>pl[Nl].PageFirstLine)O--;Ta=pl[Nl].CellId;Aa=pl[Nl].RowId;Ra=pl[Nl].height;Ie=0;S=pl[Nl].level;P=I;li=Nj(pl[Nl].flags&tc.FRAME_TRANSPARENT);if(Nj(jh))li=true;if(Nj(Zh&tc.TFLAG2_XPARENT_WRITE))li=true;vA=false;o=pl[Nl].RowOffset;if(Br!=tc.PAINT_LINE){ra[o]=d;if(!oi.PageMode)ra[o]-=zt}t:{if(pl[Nl].ScrWidth==0||pl[Nl].ScrHeight==0){var rt=true;if(pl[Nl].PageFirstLine==O&&O>=0&&O<Ri&&Nj(Nc[ui[O].pfmt].flags&tc.PAGE_HDR_FTR))rt=false;if(rt)break t}if(pl[Nl].CellId>0){tt=pl[Nl].CellId;if(Nj(eR[tt].flags&tc.CFLAG_HIDDEN))break t}if(uA!=tc.HILIGHT_OFF){v=sA;p=_A;L=TA;C=AA;r6(v,L,p,C,false);v=qC;L=$C;p=tI;C=eI;if(uA==tc.HILIGHT_CHAR){if(v>p){i=p;p=v;v=i;_=C;C=L;L=_;if(GA&&C+1==ui[p].len)C=ui[p].len}if(v==p&&L>C){_=C;C=L;L=_;if(GA&&C+1==ui[p].len)C=ui[p].len}}else{if(v>p){i=p;p=v;v=i}if(L>C){_=C;C=L;L=_}}w=C6(v,p);y=W=E6(w,v);W=E6(w,p);V=T6();if(y==W&&y>0)J=true;$=false;for(n=O;n<p;n++){if(GY(n,tc.INFO_CELL)){if(pm(n))$=true;break}}}if(pl[Nl].empty)q=true;if(Br>=tc.PAINT_WIN&&pl[Nl].CellId>0&&rW(-Nl)!=0)q=true;if(Br>=tc.PAINT_WIN&&pl[Nl].CellId>0&&!MJ(Ca,tc.CLR_WHITE))q=true;if(Br>=tc.PAINT_WIN&&!MJ(Ca,tc.CLR_WHITE))q=true;if(q&&pl[Nl].ParaFrameId>0&&pl[Nl].CellId==0&&pl[Nl].BoxFrame>0&&Nl!=pl[Nl].BoxFrame&&rW(-Nl)!=0)q=false;if(q){var it=Ca;var ft=false;tt=pl[Nl].CellId;var lt=eR[tt].FirstLine;if(Nj(pl[Nl].flags&tc.FRAME_BORDER)&&(Dj(jh)||Dj(Zh&tc.TFLAG2_BKPICT_OVER_PAGE_BORDER)))ft=true;if(tt>0&&Nj(pl[Nl].flags1&tc.FRAME1_PART_EMPTY_CELL)&&uA!=tc.HILIGHT_OFF&&!J&&lt>=sA&&lt<=_A&&pm(lt))vA=true;var at=fA;if(ft)Ca=QT;else KG(t,tc.CHAR_T,tc.DEFAULT_CFMT);if(tt>0&&eR[tt].TextAngle>0)gB(t,pl[Nl].x,pl[Nl].y,pl[Nl].x+pl[Nl].width,pl[Nl].height,!li);else gB(t,I,ra[o],F,g-ra[o],!li);if(ft)Ca=it;fA=at;vA=false;if(pl[Nl].empty)break t}if(pl[Nl].CellId>0)Ie=eR[pl[Nl].CellId].TextAngle;else if(pl[Nl].ParaFrameId>0)Ie=kl[pl[Nl].ParaFrameId].TextAngle;if(Ie>0){if(tg.OSCanRotate)d$(t,Nl);F=WY(F,g);g=JC}for(f=e;f<=r;f++){var nt=0;N=Hs=pl[Nl].ScrFirstLine+f;if(oi.PageMode&&N<Ri&&L6(N)!=S){if(o+f+1>=la)wX(o+f+1);ra[o+f+1]=ra[o+f];ia[o+f]=0;if(false&&N==pl[Nl].PageLastLine)break;continue}na=0;eA=tc.CLR_AUTO;$c=ts=0;ca=k=0;Ds=Ms=ce=0;Gs=Bs=0;kh=Xh=Kh=oa=ua=false;Qn=qn=false;Yh=false;Fc=null;ii=N>=0&&N<Ri&&Nj(ui[N].flags2&tc.LFLAG2_RTL);pf=Nf=0;Z=ii||Ie>0;if(N<Ri)Gc=ui[N].pfmt;else Gc=0;La=0;Y=0;h=0;Ia=X=tc.CLR_WHITE;da=tc.PARA_BOX_SPACE;Fa=tc.PARA_BOX_SPACE;ga=Pa=0;if(N>O||N>=Ri){if(!oi.PageMode)Dt=f;if(ra[o+f]<g&&Ie==0){var ct=0;if(g==Gt+Mt)ct=1;gB(t,I,ra[o+f],F,g-ra[o+f]+ct,!li);if(!oi.PageMode&&Dt<x)Dt=x}break}if(N<Ri)A=ui[N].pfmt;else A=tc.DEFAULT_PFMT;if(!oi.PrintView&&GY(N,tc.INFO_DYN_FIELD))ow(N,0);if(N<Ri)_b(N);if(o+f+1>=la)wX(o+f+1);ia[o+f]=e$(N);u=pd;if(Nj(pl[Nl].flags&tc.FRAME_LAST_FRAME_OF_BOX_FRAME)&&(N+1>=Ri||ui[N].fid!=ui[N+1].fid)){if(Nj(Nc[A].flags&tc.PARA_BOX)||Nc[A].shading>0||!MJ(Nc[A].BkColor,tc.CLR_WHITE)){var st=ra[o+f]+ia[o+f]+hV(Nc[A].BorderSpaceBot);if(st<g)nt=g-st}}if(oi.PageMode&&ui[N].height==0)ia[o+f]=0;_e=ia[o+f];if(oi.WordWrap){if(false&&Nc[A].flow==tc.FLOW_RTL)fa[o+f]=P=pl[Nl].SpaceLeft+Nc[A].RightIndent;else fa[o+f]=P=pl[Nl].SpaceLeft+Nc[A].LeftIndent;if(Nj(ui[N].flags&tc.LFLAG_PARA_FIRST)){fa[o+f]+=RZ(N,true);h=fI;Kh=nP}if(Nc[A].FirstIndent<0)P+=Nc[A].FirstIndent;P+=I;B=Nc[A].flags;if(Nj(B&tc.PARA_BOX))CZ(N);$c=I+pl[Nl].SpaceLeft+Nc[A].LeftIndent-dV(tc.PARA_BORDER_MARGIN);if(Nc[A].FirstIndent<0)$c+=Nc[A].FirstIndent;ts=I+pl[Nl].SpaceLeft+M9(N,-1)-Nc[A].RightIndent+dV(tc.PARA_BORDER_MARGIN);if(Nj(ui[N].flags2&tc.LFLAG2_SHADE_BEGIN))oa=true;if(Nj(ui[N].flags2&tc.LFLAG2_SHADE_END))ua=true;da=Nc[A].BorderSpaceLeft;if(Nj(ui[N].flags&tc.LFLAG_BOX_TOP))ga=Nc[A].BorderSpaceTop;if(Nj(ui[N].flags&tc.LFLAG_BOX_BOT))Pa=Nc[A].BorderSpaceBot;eA=Nc[A].BorderColor;if(!oi.PageMode&&Nj(ui[N].tabw)&&Nj(ui[N].tabw.type&tc.INFO_CELL))na|=tc.BORDER_BOT;k=Nc[A].shading;X=Nc[A].BkColor;j=k>0||X!=tc.CLR_WHITE?true:false;Q=false;if(ii&&Nj(ui[N].flags2&tc.LFLAG2_PARA_RTL)){Q=true;if(false&&Nc[A].flow==tc.FLOW_LTR){if(Dj(B&(tc.CENTER|tc.RIGHT_JUSTIFY|tc.JUSTIFY)))Q=true}else if(Nj(B&(tc.RIGHT_JUSTIFY|tc.JUSTIFY)))Q=false;if(Nj(tO&tc.TFLAG6_RIGHT_JUST_RTL))Q=false}else if(Nj(B&tc.RIGHT_JUSTIFY))Q=true;if(Nj(B&tc.CENTER)||Q){var _t=!GY(N,tc.INFO_FRAME)&&Dj(ui[N].flags&tc.LFLAG_ASSUMED_TAB);var ot=0;if(Dj(_t)&&Nj(ui[N].tabw)&&ui[N].tabw.FrameCharPos==0){_t=true;ot=ui[N].tabw.FrameScrWidth}if(Dj(_t)&&GY(N,tc.INFO_FRAME)){var ut=M9(N,-1);var Tt=Nc[A].RightIndent;var At=bV(ui[N].tabw.FrameX);if(ui[N].tabw.FrameCharPos>=ui[N].len||At>ut-Tt){if(At<ut-Tt)ot=ut-Tt-At;_t=true}}if(Nj(_t)){var Et=Nj(ui[N].flags2&tc.LFLAG2_RTL)&&Dj(B&tc.CENTER);T=M9(N,-1)-(fa[o+f]-pl[Nl].SpaceLeft)-Nc[A].RightIndent-H$(N,true,Et,true)-ot;if(T>0){if(Nj(Nc[A].flags&tc.CENTER))fa[o+f]=fa[o+f]+T/2;else fa[o+f]=fa[o+f]+T}}}if(oi.PageMode&&Nj(ui[N].flags&tc.LFLAG_ASSUMED_TAB)&&Nj(ui[N].tabw)&&ui[N].tabw.count>0){fa[o+f]+=dV(ui[N].tabw.width[0])}}else fa[o+f]=0;m=vW(N,true);if(m>0){var Rt=na;na=0;KG(t,tc.CHAR_T,tc.DEFAULT_CFMT);gB(t,I,ra[o+f],F,m,!li);if(Br!=tc.PAINT_LINE)ra[o+f]+=m;na=Rt}_$(N,yV(ui[N].TextHt),true);Ds=Sd;Ms=hd;Gs=Od;Bs=vd;ra[o+f+1]=ra[o+f]+ia[o+f];ra[o+f+1]+=Ds+Ms;if(qq()){ra[o+f+1]=ra[o+f]+$q(N,false);ce=ra[o+f+1]-ia[o+f]-Ds-Ms-ra[o+f];if(ce<-1)ce=-1;ce=0;ia[o+f]=ra[o+f+1]-ra[o+f]-Ds-Ms}else ui[N].ScrHt=$q(N,false);if(nt>0)ra[o+f+1]+=nt;if(oi.PageMode&&pl[Nl].LimitY!=-1&&ra[o+f+1]>g&&Ms>0&&Ie==0){var Lt=ra[o+f+1]-g;Ms-=Lt;if(Ms<0)Ms=0}if(ra[o+f+1]>Gt+Mt&&f!=0&&Ie==0){if(g-ra[o+f]>tc.WIN_BOT_MARGIN&&!U)U=true;else{if(!oi.PageMode)Dt=f+1;if(ra[o+f]<g){na=0;Ds=Ms=0;gB(t,I,ra[o+f],F,g-ra[o+f]+nt,!li)}break}}if(oi.PageMode&&pl[Nl].LimitY!=-1&&ra[o+f+1]-Ms-ia[o+f]/4>g&&Ie==0&&f>0){if(ra[o+f]<g){na=Ds=Ms=0;gB(t,I,ra[o+f],F,g-ra[o+f]+nt,!li)}break}if(Br>=tc.PAINT_WIN&&jh<0){if(RG(t,Nl,pl[Nl].x,ra[o+f],pl[Nl].width,ra[o+f+1]-ra[o+f]))continue}if(Nj(Zh&tc.TFLAG2_XPARENT_WRITE)&&Br!=tc.PAINT_WIN){var Ct=Br==tc.PAINT_LINE?1:0;gB(t,I,ra[o+f],F,ra[o+f+1]-ra[o+f]+nt+Ct,true)}s=ra[o+f];if(Br!=tc.PAINT_LINE&&Br!=tc.PAINT_RANGE)pl[Nl].ScrLastLine=N;if(br==N)Xt=s-Gt;if(oi.WordWrap&&oi.PrintView&&!oi.PageMode){for(l=0;l<To;l++)if(po[l].FirstLine-1==N&&Dj(po[l].flags&tc.PAGE_HARD))break;if(l<To){if(Dj(ui[N].tabw)||Dj(ui[N].tabw.type&(tc.INFO_PAGE|tc.INFO_SECT)))na=tc.BORDER_BOT}}if(Nj(ui[N].tabw)&&Nj(ui[N].tabw.type&tc.INFO_DYN_FIELD))ow(N,Nl>=Qe?qe+1:qe);if(_4()&&Dj(ui[N].flags2&tc.LFLAG2_SPELL_CHECKED))o4(N);M=ui[N].txt;c=ui[N].len;if(oi.WordWrap&&c>0&&dS&&Nj(ui[N].flags&tc.LFLAG_SECT)){c--;Y=M[c]}while(c>0&&!dS&&!ii){if(M[c-1]!=tc.SPACE){if(Nj(eO&tc.TFLAG7_SHOW_SPACES_AT_PARA_END))break;else if(Dj(nO&tc.TOFLAG2_DONT_ULINE_TRAIL_SPC))break;else if(M[c-1]!=Bn&&M[c-1]!=TR&&M[c-1]!=tc.LINE_CHAR)break;else{if(ui[N].fmt==null)et=ui[N].UniFmt;else et=ui[N].fmt[c-1];if(xs[et].StoryIds!=null&&xs[et].StoryIds.length>0)break}}else if(ui[N].fmt!=null){var It=ui[N].fmt;if(xs[It[c-1]].FieldId==tc.FIELD_TEXTBOX)break;et=ui[N].fmt[c-1];if(xs[et].StoryIds!=null&&xs[et].StoryIds.length>0)break}c--}if(!oi.WordWrap&&ui[N].fmt==null){for(a=0;a<c;a++)if(M[a]==tc.TAB)break;if(a!=c)ob(N)}if(ui[N].fmt!=null)Fc=ui[N].fmt;if(oi.WordWrap&&c>0&&!dS&&Nj(ui[N].flags&(tc.LFLAG_PARA|tc.LFLAG_LINE|tc.LFLAG_SECT|tc.LFLAG_ASSUMED_TAB)))Yh=true;z=Nj(Zh&(tc.TFLAG2_ALT_PARA_SYM|tc.TFLAG2_ALT_LINE_SYM))||ri;if(z&&oi.WordWrap&&c>0&&dS&&Nj(ui[N].flags&(tc.LFLAG_PARA|tc.LFLAG_LINE|tc.LFLAG_SECT))){if(ui[N].fmt!=null){Pc=[];for(a=0;a<c;a++)Pc[a]=ui[N].fmt[a];Fc=Pc}Yh=true}if(ii)Yh=true;if(!Yh&&c>0&&dS&&(M[c-1]==Bn||M[c-1]==TR||M[c-1]==tc.LINE_CHAR)){if(ui[N].fmt==null)et=ui[N].UniFmt;else et=ui[N].fmt[c-1];if(xs[et].CharSet>1)Yh=true}if(Yh&&ui[N].fmt==null){Pc=[];for(a=0;a<c;a++)Pc[a]=ui[N].UniFmt;Fc=Pc}if(Yh||ui[N].fmt!=null){Sc=[c+1];for(a=0;a<c;a++){if(M[a]==tc.NBDASH_CHAR)Sc[a]=tc.HYPH;else if(M[a]==tc.NBSPACE_CHAR)Sc[a]=tc.SPACE;else if(M[a]==tc.HYPH_CHAR){if(dS)Sc[a]=tc.DISP_HYPH_CHAR;else if(a==c-1)Sc[a]=tc.HYPH;else Sc[a]=M[a];vi=true}else if(M[a]==tc.HIDDEN_CHAR){if(dS)Sc[a]=tc.DISP_HIDDEN_CHAR;else Sc[a]=M[a]}else Sc[a]=M[a]}M=Sc;if(z&&dS&&c>0&&(M[c-1]==Bn||M[c-1]==TR||M[c-1]==tc.LINE_CHAR)){et=Fc[c-1];var dt="Arial";var Ft=xs[et].TwipsSize/20;var gt=false;if(z){if(M[c-1]==Bn&&Nj(Zh&tc.TFLAG2_ALT_PARA_SYM))dt="Symbol";if(M[c-1]==tc.LINE_CHAR&&Nj(Zh&tc.TFLAG2_ALT_LINE_SYM)){dt="Symbol";if(Ft>3)Ft-=3}gt=true}else if(xs[et].CharSet>1)gt=true;if(gt)Fc[c-1]=Rb(t,et,dt,Ft*20,0,xs[et].TextColor,xs[et].TextBkColor,xs[et].UlineColor,0,0,0,1,0,0,0,0,null,0,0,0,xs[et].TextAngle)}}gc=vq(N);vf=null;var Pt=0;if(ii){vf=Mq(N,gc,fa[o+f]);Pt=Dd}pf=Pt;E=R=-1;vA=false;if(uA!=tc.HILIGHT_OFF&&N>=v&&N<=p&&pm(N)){if(uA==tc.HILIGHT_LINE){E=0;R=9999}else if(uA==tc.HILIGHT_CHAR){if(N>v&&N<p){E=0;R=c}else if(N==v&&N==p){E=L;R=C}else if(N==v){E=L;R=c}else{E=0;R=C}if(ui[N].cid>0&&V)vA=true;if(N<=p&&ui[N].cid>0&&!J)vA=true;if($&&ui[N].cid>0)vA=true}if(R<E)R=E}if(c>0&&!dS&&c==ui[N].len&&Nj(ui[N].flags&(tc.LFLAG_PARA|tc.LFLAG_LINE))&&Dj(eO&tc.TFLAG7_SHOW_SPACES_AT_PARA_END)&&Fc!=null&&!MJ(xs[Fc[c-1]].TextBkColor,tc.CLR_WHITE))c--;Bt=I+fa[o+f];if(fa[o+f]>0){G.left=I;G.top=ra[o+f];if(j)G.right=P-dV(tc.PARA_BORDER_MARGIN+Fa);else G.right=Bt;G.bottom=ra[o+f+1];if(uA==tc.HILIGHT_LINE&&E>=0)K=gk("H");else K=tc.CHAR_T;KG(t,K,tc.DEFAULT_CFMT);hc=0;PB(t,G);if(j&&Bt>G.right){G.left=G.right;G.right=Bt;ca=k;Ia=X;KG(t,K,tc.DEFAULT_CFMT);PB(t,G);ca=0;Ia=tc.CLR_WHITE}}nO|=tc.TOFLAG2_NO_COMPRESS_CFMT;if(Kh)CB(t,N,A,Bt-h,s+Ds,u,true);uj(tc.TOFLAG2_NO_COMPRESS_CFMT);Ht=0;mt=0;ca=k;Ia=X;if(so>=0)$B(t,N-pl[Nl].PageFirstLine,I+pl[Nl].SpaceLeft,s+Ds,u,true);var St=false;if(Fc!=null){for(l=0;l<c;l++){if(!MJ(xs[Fc[l]].TextBkColor,tc.CLR_WHITE)){St=true;break}}}Tj(tc.TOFLAG3_TEXT_BKND_ONLY|tc.TOFLAG3_NO_TEXT_BKND);if(St){var ht=Bt;var Ot=Ht;var vt=mt;cO|=tc.TOFLAG3_TEXT_BKND_ONLY;dG(t,0,s,ia[o+f]+nt,u,M,c,N,Y==0&&!j,tc.CHAR_T);Tj(tc.TOFLAG3_TEXT_BKND_ONLY);Bt=ht;Ht=Ot;mt=vt;cO|=tc.TOFLAG3_NO_TEXT_BKND;dG(t,0,s,ia[o+f]+nt,u,M,c,N,Y==0&&!j,tc.CHAR_T);Tj(tc.TOFLAG3_NO_TEXT_BKND)}else dG(t,0,s,ia[o+f]+nt,u,M,c,N,Y==0&&!j,tc.CHAR_T);if(Nj(ui[N].flags2&(tc.LFLAG2_DEL_REV|tc.LFLAG2_INS_REV))||w4(ui[N].pfmt))eH(t,I+pl[Nl].SpaceLeft,s+Ds,ia[o+f]);if(Nj(ui[N].flags2&tc.LFLAG2_LEFT_LINE))rH(t,I+pl[Nl].SpaceLeft,s+Ds,ia[o+f]);if(E>=0&&R>0&&!vA)cB(t,N,E,R,s,ia[o+f]+Ds+Ms);if((Bt<F||Z)&&j){var pt=dV(Fa);if(oi.PageMode&&ts>F)ts=F;if(Bt<ts+pt){KG(t,tc.CHAR_T,tc.DEFAULT_CFMT);gB(t,Bt,s,ts+pt,ia[o+f]+Ds+Ms+nt,false);Bt=ts+pt}ca=0;Ia=tc.CLR_WHITE;KG(t,tc.CHAR_T,tc.DEFAULT_CFMT);gB(t,Bt,s,F,ia[o+f]+Ds+Ms,false)}else if((Bt<F||Z)&&Y>0){var Nt=s+(ia[o+f]+Ds+Ms)/2;gB(t,Bt,s,F,ia[o+f]+Ds+Ms+nt,false);if(Y==tc.SECT_CHAR)LB(t,tg.MsgString[tc.MSG_SECT_BREAK],Bt,Nt,oi.PageMode?F-Bt:je-Bt,null);Bt=F}if(so>=0)$B(t,N-pl[Nl].PageFirstLine,I+pl[Nl].width,s+Ds,u,false);qB(t,Nl,N,I+pl[Nl].SpaceLeft,s+Ds,u)}if(Ie>0&&tg.OSCanRotate)F$(t);Ie=0}ii=false;H=pl[Nl].border;if(Nj(H&tc.BORDER_ALL)&&Dj(pl[Nl].flags&tc.FRAME_NON_TEXT_DO))ZG(t,Nl);if(pl[Nl].BoxFrame!=Nl&&Nj(pl[Nl].flags&tc.FRAME_LAST_FRAME_OF_BOX_FRAME))ZG(t,pl[Nl].BoxFrame);if(Nj(pl[Nl].flags&tc.FRAME_LINE_BET_COL))zG(t,Nl,0,0);na=0;eA=tc.CLR_AUTO;$c=ts=Ta=Aa=Ra=lA=0;ca=0;Ds=Ms=Ea=ce=0;kh=Xh=Kh=vA=li=fi=oa=ua=false;Qn=qn=false;uA=b;Gc=0;La=0;Ca=Ia=tc.CLR_WHITE;da=tc.PARA_BOX_SPACE;Fa=tc.PARA_BOX_SPACE;ga=Pa=0;sa=0;Yh=false;ii=false;gc=null;vf=null;pf=Nf=0;Sc=null;Pc=null;so=-1}function dG(t,e,r,i,f,l,a,n,c,s){var _,o,u,T,A,E,R,L,C,I,d=0;var F;var g=tc.DEFAULT_CFMT;var P;var S;var h=new tc.RECT;var O,v;var p=Nj(aO&tc.TOFLAG_FNOTE_FRAME);var N;var D,M,G;var B;var H=Bt;Jt=-1;if(Ie>0)o=pl[Nl].ScrX+pl[Nl].height;else if(ii)o=pl[Nl].x+pl[Nl].width;else{o=pl[Nl].ScrX+pl[Nl].ScrWidth;if(o>Ft+je)o=Ft+je}D=Ie>0;if(ii&&Nj(vf)){Nf=Vq(n,e,pf,vf);B=vf[Nf].col+vf[Nf].count;M=vf[Nf].rtl;if(vf[Nf].IsDate)Bt=H+vf[Nf].x}else{Nf=0;M=false;B=9999}h.top=r;h.bottom=h.top+i+Ds+Ms;if(Br==tc.PAINT_LINE)h.bottom++;L=h.bottom-h.top;r+=Ds;I=ui[n].len;t:{if(a<=0)break t;if(Bt>o&&!D)return true;if(!p&&ui[n].fmt==null&&!Yh){P=ui[n].UniFmt;S=xs[P].style;XG(t,P,s);C=xs[P].BaseHeightAdj+yV(ui[n].BaseHeightAdj);if(Bt<o||D){h.left=A=Bt;for(u=0;u<a;u++)Bt+=gc[e+u];if(c&&Nj(S&tc.ITALIC)&&Dj(xs[P].flags&tc.FFLAG_ITALIC_OH))Bt+=Gx(P,true,tc.CHAR_W);h.right=Bt<=o?Bt:o;if(Nj(S&tc.PICT))PG(t,A,r,h,P,a,n);else gG(t,A,r+C,h,l,a,gc,f)}g=P}else{var m=ui[n].pfmt;var w=ui[n].tabw!=null&&Nj(ui[n].tabw.type&tc.INFO_ALT_JUST)&&ui[n].tabw.CharFlags!=null;var b=ui[n].tabw!=null&&Nj(ui[n].tabw.type&tc.INFO_JUST);var x=0;if(w&&Nj(nO&tc.TOFLAG2_DRAW_FNOTE))w=false;if(e>0)g=Fc[e-1];F=lV(Fc,e);N=lV(gc,e);P=F[0];S=xs[P].style;v=Nj(xs[P].flags&tc.FFLAG_ITALIC_OH);O=Nj(xs[g].flags&tc.FFLAG_ITALIC_OH);T=0;if(!p&&Nj(ui[n].tabw)&&Nj(ui[n].tabw.type&tc.INFO_FRAME)&&ui[n].tabw.FrameCharPos==e&&e==0)FB(t,n,h.top,L);_=1;if(O&&!v&&_<a&&l[_]==tc.SPACE){Bt+=Gx(P,true,tc.SPACE);_++;T++;P=F[_];S=xs[P].style}while(_<=a){var y=0;var W=false;if(!p&&Nj(ui[n].tabw)&&Nj(ui[n].tabw.type&tc.INFO_FRAME))R=ui[n].tabw.FrameCharPos;else R=-1;G=!p&&Nj(ui[n].tabw)&&ui[n].tabw.CharFlagsLen>0;var U=_<a?l[_]:0;if(xs[P].TextAngle!=0&&Nj(fO&tc.TFLAG10_UPRIGHT_CHARS)){W=true;if(xs[P].TextAngle==270)y=-xs[P].height}if(!W&&b){if(x==tc.CHAR_SPACE||U==tc.CHAR_SPACE)W=true}if(!W&&_<a&&xs[P].expand!=0)W=true;if(Qi&&_>0&&l[_-1]==tc.SPACE){if(xs[F[_-1]].CharWidth[tc.SPACE]!=N[_-1])W=true}if(_==a||W||F[_]!=P||U==tc.TAB||U==tc.HYPH_CHAR||U==tc.HIDDEN_CHAR||l[_]==tc.ZWNJ_CHAR||U==tc.SPACE&&dS&&Dj($h&tc.TFLAG5_NO_SHOW_SPACE_SYM)||!oi.PageMode&&U==tc.SECT_CHAR||R==e+_||_+e>=B||ii&&M&&(l[_-1]==tc.SPACE||U==tc.SPACE)||w&&e+_>0&&Nj(ui[n].tabw.CharFlags[e+_-1]&tc.BFLAG_JUST_SPACE)||G&&e+_-1>0&&Nj(ui[n].tabw.CharFlags[e+_-1]&tc.BFLAG_BOX_LAST)){XG(t,P,s);E=r+f-xs[P].BaseHeight+xs[P].BaseHeightAdj+yV(ui[n].BaseHeightAdj);if(l[T]==tc.TAB&&!um(F[T])){IB(t,n,E,h.top,L,f+Ds,N[T]);T++;XG(t,P,s)}else if(dS&&l[T]==tc.SPACE&&!um(F[T])&&Dj($h&tc.TFLAG5_NO_SHOW_SPACE_SYM)){var k=F[T];if(xs[k].StoryIds==null||xs[k].StoryIds.length==0){dB(t,n,E,h.top,L,f+Ds,N[T]);T++;XG(t,P,s)}}else if((l[T]==tc.HYPH_CHAR||l[T]==tc.HIDDEN_CHAR)&&!dS){T++}else if(l[T]==tc.ZWNJ_CHAR){T++}yr=T<a&&l[T]==tc.PAGE_CHAR&&br==n;if((Bt<o||D)&&_>T){var X=nO;h.left=A=Bt;for(u=0;u<_-T;u++)Bt+=N[T+u];if(!p&&Nj(ui[n].tabw)&&e+T<ui[n].tabw.CharFlagsLen&&Nj(ui[n].tabw.CharFlags[e+T]&tc.BFLAG_BOX_FIRST)){A+=yh;kh=true}if(!p&&Nj(ui[n].tabw)&&e+_-1<ui[n].tabw.CharFlagsLen&&Nj(ui[n].tabw.CharFlags[e+_-1]&tc.BFLAG_BOX_LAST)){Xh=true}Qn=ny(true,n,T,false,0,0,false);d=r+f-xs[P].BaseHeight+xs[P].height+xs[P].BaseHeightAdj-hV(20)+yV(ui[n].BaseHeightAdj);qn=ny(false,n,_-1,true,Bt,d,false);if(!qn&&l[_-1]==TR){if(n+1<Ri&&GY(n+1,tc.INFO_ROW))qn=ny(false,n+1,0,true,Bt,d,false)}if(c&&_==a&&Nj(S&tc.ITALIC)&&!v)Bt+=Gx(P,true,tc.CHAR_W);h.right=Bt<=o||D?Bt:o;if(Nj(xs[P].style&tc.ITALIC)&&!MJ(xs[P].TextBkColor,tc.CLR_WHITE))nO|=tc.TOFLAG2_NO_TEXT_CLIP;if(Nc[m].TextVAlign==tc.TEXT_VALIGN_BASE)E=r+f-xs[P].BaseHeight+xs[P].BaseHeightAdj+yV(ui[n].BaseHeightAdj);else{E=r+xs[P].BaseHeightAdj+yV(ui[n].BaseHeightAdj);if(Nc[m].TextVAlign==tc.TEXT_VALIGN_CENTER)E+=(L-xs[P].height)/2;else if(Nc[m].TextVAlign==tc.TEXT_VALIGN_BOT)E+=L-xs[P].height}if(Nj(S&tc.PICT))PG(t,A,E+ce,h,P,_-T,n);else gG(t,A,E-y,h,lV(l,T),_-T,lV(N,T),f);nO=X;kh=Xh=false;if(v){if(_<a&&l[_]==tc.SPACE&&Dj(xs[F[_]].flags&tc.FFLAG_ITALIC_OH)){Bt+=Gx(F[_],true,tc.SPACE);_++}}}if(R==e+_)FB(t,n,h.top,L);if(_==a)break;T=_;g=P;if(T<a)P=F[_];S=xs[P].style;v=Nj(xs[P].flags&tc.FFLAG_ITALIC_OH);O=Nj(xs[g].flags&tc.FFLAG_ITALIC_OH);if(ii&&Nj(vf)&&_+e>=B){Nf++;B=vf[Nf].col+vf[Nf].count;if(vf[Nf].IsDate)Bt=H+vf[Nf].x;M=vf[Nf].rtl}}x=U;_++}}}var K=Bt;if(c&&Bt<=o&&Ie==0&&(true||ui[n].fid==0||ui[n].cid>0)){var Y=ii&&Nj(vf)&&Nf<pf&&n>=0&&Nj(ui[n].flags2&tc.LFLAG2_PARA_RTL);var V=false;if(Jt>=0)Bt+=Gx(Jt,true,tc.CHAR_W);XG(t,tc.DEFAULT_CFMT,s);h.left=Bt;h.right=o;if(h.right==Ft+je)h.right++;if(Y){V=vf[Nf].rtl;vf[Nf].rtl=true;Df=true}if(h.right>h.left&&Dj(vf)&&(fA!=nZ()||Nj(na)||jh>0||Nl>0))PB(t,h);if(Y){vf[Nf].rtl=V;Df=false}Bt=o}return true}function FG(t,e){if(xs[t].TwipsSize!=xs[e].TwipsSize)return true;if(Tk(xs[t].TypeFace,xs[e].TypeFace)!=0)return true;if(xs[t].offset!=xs[e].offset)return true;if(xs[t].style!=xs[e].style)return true;if(xs[t].TextColor!=xs[e].TextColor)return true;if(xs[t].TextBkColor!=xs[e].TextBkColor)return true;if((xs[t].TempStyle&tc.TSTYLE_IME)!=(xs[e].TempStyle&tc.TSTYLE_IME))return true;if(xs[t].expand!=xs[e].expand)return true;if(xs[t].ScaleX!=xs[e].ScaleX)return true;if(xs[t].InsRev!=xs[e].InsRev)return true;if(xs[t].DelRev!=xs[e].DelRev)return true;if(xs[t].FmtRev!=xs[e].FmtRev)return true;return false}function gG(t,e,r,i,f,l,a,n){var c,s,_=0,o=tc.ETO_CLIPPED;var u,T,A,E;var R;var L,C,I;var d=false,F;var g,P;var S=l,h=0,O=0;var v=null;var p,N,D,M,G,B;L=i.copy();if(l==0)f=[0];if(!fi)_=tc.ETO_OPAQUE;if(Nj(Zh&tc.TFLAG2_XPARENT_WRITE)&&(fi||Ie>0||ii))o=0;if(Nj(nO&tc.TOFLAG2_NO_TEXT_CLIP))o=0;if(Nj(cO&tc.TOFLAG3_TEXT_BKND_ONLY))l=0;else if(Nj(cO&tc.TOFLAG3_NO_TEXT_BKND)){_=0;o=0}F=(Nj(qh&tc.TFLAG4_AUTO_SPELL)||Nj(aO&tc.TOFLAG_EXT_SPELLER))&&Nj(xs[hc].flags&tc.FFLAG_AUTO_SPELL);O=r+ce;if(l==1){var H=f[0];if(H==tc.PAGE_CHAR||H==tc.SECT_CHAR||H==tc.COL_CHAR||H==tc.ROW_CHAR||hj(H)){if(oi.PageMode)Bt=i.right=pl[Nl].x+pl[Nl].width-10;else Bt=i.right=i.left+je;d=true}}if(i.right<Ft&&Ie==0&&!ii)return true;c=xs[hc].style;s=xs[hc].TempStyle;if(Nj(xs[hc].flags&tc.FFLAG_ITALIC_OH)&&!ii){i.right=i.right+Gx(hc,true,tc.CHAR_W)}if(!um(hc)||l==0){A=Jt;if(Nj(xs[hc].flags&tc.FFLAG_ITALIC_OH)&&l>0)Jt=hc;else Jt=-1;if(HG(i,l))return true;mG(e,r,i);if(Nj(aO&tc.TOFLAG_WRITING_BKND)&&Nj(jh))_=0;if(Nj(xs[hc].flags&tc.FFLAG_ITALIC_OH)&&!ii){if(A>=0){i.left+=Gx(A,true,tc.CHAR_W);if(i.left>i.right)i.left=i.right}else{u=i.right;i.right=i.left+Gx(hc,true,tc.SPACE);TB(t,e,r,tc.ETO_OPAQUE,i,null,0,null);i.right=u}}}if(d){TB(t,e,r,_,i,null,0,null);r=i.top+(i.bottom-i.top)/2;E=i.right-i.left;if(!oi.ReadOnly||Nj(zh&tc.TFLAG_SHOW_BREAKS)){if(Dj(oi.PageMode)||dS||(yr||Nj($h&tc.TFLAG5_SHOW_PAGE_BREAK))&&f[0]==tc.PAGE_CHAR){if(f[0]==tc.PAGE_CHAR&&Dj(Zh&tc.TFLAG2_HIDE_PAGE_BREAK)){LB(t,tg.MsgString[tc.MSG_PAGE_BREAK],i.left,r,E,new tc.Pen(1,tc.Color.black));xr=true}if(f[0]==tc.COL_CHAR)LB(t,tg.MsgString[tc.MSG_COL_BREAK],i.left,r,E-dV(360),new tc.Pen(1,tc.Color.black));if(f[0]==tc.SECT_CHAR)LB(t,tg.MsgString[tc.MSG_SECT_BREAK],i.left,r,E,new tc.Pen(1,tc.Color.black))}}if(f[0]==tc.HDR_CHAR)LB(t,tg.MsgString[tc.MSG_PAGE_HDR],i.left,r,E,null);if(f[0]==tc.FTR_CHAR)LB(t,tg.MsgString[tc.MSG_PAGE_FTR],i.left,r,E,null);if(f[0]==tc.LHDR_CHAR)LB(t,tg.MsgString[tc.MSG_PAGE_LHDR],i.left,r,E,null);if(f[0]==tc.LFTR_CHAR)LB(t,tg.MsgString[tc.MSG_PAGE_LFTR],i.left,r,E,null);if(f[0]==tc.RHDR_CHAR)LB(t,tg.MsgString[tc.MSG_PAGE_RHDR],i.left,r,E,null);if(f[0]==tc.RFTR_CHAR)LB(t,tg.MsgString[tc.MSG_PAGE_RFTR],i.left,r,E,null);if(f[0]==tc.FHDR_CHAR)LB(t,tg.MsgString[tc.MSG_FIRST_HDR],i.left,r,E,null);if(f[0]==tc.FFTR_CHAR)LB(t,tg.MsgString[tc.MSG_FIRST_FTR],i.left,r,E,null);if(f[0]==tc.ROW_CHAR&&!oi.PageMode)LB(t,tg.MsgString[tc.MSG_ROW_BREAK],i.left,r,E-dV(360),new tc.Pen(1,tc.Color.black));if(Nj(na&tc.PARA_BOX))UB(t,i,true)}else{if(l==0||!um(hc)){var m;var w;var b=0;if(f!=null){var x=f.length;v=[x];var y=xs[hc].UcBase;for(w=0;w<l;w++){if(y!=0)v[w]=Sy(xs[hc].UcBase,f[w]);else v[w]=f[w]}}if(oi.WordWrap&&!dS){while(l>0&&(v[l-1]==Bn||v[l-1]==TR||v[l-1]==tc.LINE_CHAR||v[l-1]==tc.SECT_CHAR)){l--;h++}}if(l==0)kh=Xh=false;if(Nj(xs[hc].style&(tc.SCAPS|tc.CAPS))){for(w=0;w<l;w++)if(sk(v[w]))v[w]=ok(v[w])}m=pq(hc,v,l,a);if(kh)m[0]-=yh;if(Xh&&l>0)m[l-1]-=yh;if(dS&&l>0){if(v[l-1]==Bn||v[l-1]==TR||v[l-1]==tc.LINE_CHAR){b=v[l-1];if(v[l-1]==Bn)v[l-1]=Nj(Zh&tc.TFLAG2_ALT_PARA_SYM)?tc.DISP_PARA_CHAR_ALT:tc.DISP_PARA_CHAR;if(v[l-1]==tc.LINE_CHAR)v[l-1]=Nj(Zh&tc.TFLAG2_ALT_LINE_SYM)?tc.DISP_LINE_CHAR_ALT:tc.DISP_LINE_CHAR;if(v[l-1]==TR)v[l-1]=tc.DISP_CELL_CHAR}}if(Ds>0||Ms>0){I=i.copy();C=I.copy();C.top=C.top+Ds;C.bottom=C.bottom-Ms;TB(t,e,r+ce,_|o,C,v,null,l,m);if(Dj(iO&tc.TFLAG9_DONT_COLOR_PARA_SPACING)&&jh==0){var W=ca;var U=Ia;t.save();g=iA;P=fA;C=I.copy();if(ga>0)C.top=I.top+Ds-hV(ga);else C.top=I.top+Gs;C.bottom=I.top+Ds;O=C.bottom;KG(t,tc.CHAR_T,tc.DEFAULT_CFMT);TB(t,e,r+ce,_|o,C,null,0,null);C=I.copy();C.top=I.bottom-Ms;if(Pa>0)C.bottom=I.bottom-Ms+hV(Pa);else C.bottom=I.bottom-Bs;KG(t,tc.CHAR_T,tc.DEFAULT_CFMT);TB(t,e,r+ce,_|o,C,null,0,null);iA=g;fA=P;t.restore()}}else{C=i.copy();TB(t,e,r+ce,_|o,C,v,null,l,m);O=C.top}if(Nj(b))v[l-1]=b;if(Nj(na&tc.BORDER_TOP))hH(t,i.left,r+1+Ds,i.right,r+1+Ds,mf,null);if(Nj(na&tc.BORDER_BOT))hH(t,i.left,i.bottom-1-Ms,i.right,i.bottom-1-Ms,mf,null);if(l>0&&(Nj(c&tc.HIDDEN)||Nj(c&tc.FNOTETEXT)&&Dj(aO&tc.TOFLAG_FNOTE_FRAME))){if(null!=(R=new tc.Pen(1,iA))){if(n==0)p=r+xs[hc].BaseHeight+ce;else p=n+L.top+Ds+ce;R.setDotted();T=xs[hc].BaseHeight;hH(t,L.left,p+2,L.right,p+2,R,null)}}if(!Q_){if(Nj(xs[hc].InsRev))c|=ul[xs[hc].InsRev].InsStyle;if(Nj(xs[hc].DelRev))c|=ul[xs[hc].DelRev].DelStyle;if(Nj(xs[hc].FmtRev))c|=ul[xs[hc].FmtRev].FmtStyle}if(Nj(c&(tc.ULINED|tc.ULINE|tc.STRIKE|tc.DOUBLE_STRIKE|tc.ULINE_DOTTED))||Nj(s&tc.TSTYLE_IME)||F){if(l>0){var k=false;var X,K=0,Y;var V;for(X=0;X<3;X++){if(X==0){Y=c&(tc.ULINED|tc.ULINE);k=Nj(s&tc.TSTYLE_IME)&&Nj(Y&(tc.ULINED|tc.ULINE))?true:false;V=iA;if(xs[hc].UlineColor!=tc.CLR_AUTO)V=xs[hc].UlineColor;if(F){var j=MJ(xs[hc].WlineColor,tc.CLR_AUTO)?tc.Color.red:xs[hc].WlineColor;if(!MJ(fA,j))V=j}if(Dj(Y)&&Dj(s&tc.TSTYLE_IME)&&!F)continue}else if(X==1){Y=c&(tc.STRIKE|tc.DOUBLE_STRIKE);if(Dj(Y))continue;k=false;V=iA;K=xs[hc].TwipsSize/240}else{Y=c&tc.ULINE_DOTTED;if(Dj(Y))continue;k=false;if(Nj(xs[hc].FmtRev)){var J=xs[hc].FmtRev;V=ul[J].FmtColor}else V=xs[hc].UlineColor;K=xs[hc].TwipsSize/240}if(null!=(R=new tc.Pen(V,K))){var z=Nj(Y&tc.ULINE)||F?1:0;var Z=0;if(k)R.setDotted();if(S==0)Z=L.right-L.left;else for(w=0;w<S-h;w++)Z+=Nj(a)?a[w]:Gx(hc,true,v[w]);if(n==0)p=r+xs[hc].BaseHeight+ce;else p=n+L.top+Ds+ce;if(F&&X==0)dH(t,L.left,p+1,L.left+Z,p+1,V);else if(Nj(Y&tc.ULINED)){hH(t,L.left,p,L.left+Z,p,R,null);hH(t,L.left,p+2,L.left+Z,p+2,R,null)}else if(Nj(Y&(tc.STRIKE|tc.DOUBLE_STRIKE))){var Q=xs[hc].BaseHeight/2*2/3;if(Q<1)Q=1;p-=Q;Q=2+xs[hc].TwipsSize/240;if(Nj(Y&tc.STRIKE)){hH(t,L.left,p-Q/2,L.left+Z,p-Q/2,R,null)}if(Nj(Y&tc.DOUBLE_STRIKE)){hH(t,L.left,p,L.left+Z,p,R,null);hH(t,L.left,p-Q,L.left+Z,p-Q,R,null)}}else if(Nj(Y&tc.ULINE_DOTTED)||Nj(s&tc.TSTYLE_IME)){if(Nj(xs[hc].FmtRev)){z=2;RH(t,L.left,p+z,L.left+Z,p+z,V)}else RH(t,L.left,p+1,L.left+Z,p+1,V)}else if(Nj(Y&tc.ULINE))hH(t,L.left,p+1,L.left+Z,p+1,R,null)}}}}if(Nj(na&tc.PARA_BOX))UB(t,L,true);if(Nj(xs[hc].style&tc.CHAR_BOX)&&l>0){R=new tc.Pen(t.fillStyle);N=L.left;BoxWidth=0;M=O;G=M+_e-2;if(S==0)BoxWidth=L.right-L.left;else for(w=0;w<l;w++)BoxWidth+=Nj(a)?a[w]:Gx(hc,true,v[w]);D=N+BoxWidth;if(kh)N++;if(Xh)D--;if(G>i.bottom-2)G=i.bottom-2;T=xs[hc].BaseHeight;hH(t,N,M,D,M,R,null);hH(t,N,G,D,G,R,null);if(kh)hH(t,N,M,N,G,R,null);if(Xh)hH(t,D,M,D,G,R,null)}if(Qn&&Dj(iO&tc.TFLAG9_NO_COMMENTS)){if(null!=(R=new tc.Pen(Zn))){B=3;N=L.left;M=O;G=M+_e-2;hH(t,N+B,M,N,M+B,R,null);hH(t,N,M+B,N,G-B,R,null);hH(t,N,G-B,N+B,G,R,null)}Qn=false}if(qn&&Dj(iO&tc.TFLAG9_NO_COMMENTS)){if(null!=(R=new tc.Pen(Zn))){B=3;N=L.right-1;M=O;G=M+_e-2;hH(t,N-B,M,N,M+B,R,null);hH(t,N,M+B,N,G-B,R,null);hH(t,N,G-B,N-B,G,R,null)}qn=false;$n=true}}}return true}function PG(t,e,r,i,f,l,a){var n=true;var c=false,s=false;var _,o;var u;if(um(f))return true;u=xs[f].ParaFID;o=xs[f].FrameType==tc.PFRAME_NONE||Nj(aO&tc.TOFLAG_DRAWING_FRAME_PICT);if(!o&&u>0){if(Nj(kl[u].flags2&tc.PF2_INLINE))o=true}if(o){xs[f].PictX=e;if(ii)xs[f].PictX=E$(xs[f].PictX,xs[f].CharWidth[tc.PICT_CHAR],Nl,vf[Nf]);xs[f].PictX-=Ft;xs[f].PictY=r-Gt}xs[f].InFrame=Nl;if(i.right<Ft&&!ii){var T=xs[f].ctl;if(T==null||!T.isVisible())return true}_=oi.PageMode&&xs[f].FrameType!=tc.PFRAME_NONE&&Dj(kl[u].flags2&tc.PF2_INLINE)&&Dj(aO&tc.TOFLAG_DRAWING_FRAME_PICT)&&!dS;if(_&&Math.abs(i.right-i.left)<=1)return true;mG(e,r,i);s=jh==0&&$l<=0;if(s&&Nj(pl[Nl].flags&tc.FRAME_TRANSPARENT))s=false;if(s){if((xs[f].PictType==tc.PICT_DIBITMAP||xs[f].PictType==tc.PICT_CONTROL||xs[f].PictType==tc.PICT_FORM)&&!_)n=false;if(xs[f].ObjectType==tc.OBJ_OCX&&Dj(xs[f].flags&tc.FFLAG_OCX_SRV_ERROR)&&Dj(it))n=false;if(!n){var A=i.copy();if(r>i.top){A.bottom=r;TB(t,e,r,tc.ETO_OPAQUE|tc.ETO_CLIPPED,A,null,0,null)}if(r+xs[f].height<i.bottom){A=i.copy();A.top=r+xs[f].height;TB(t,e,r,tc.ETO_OPAQUE|tc.ETO_CLIPPED,A,null,0,null)}}else if(_||xs[f].FrameType!=tc.PFRAME_NONE){TB(t,e,r,tc.ETO_OPAQUE|tc.ETO_CLIPPED,i,null,0,null)}}if(_)return true;if(Nj(et)&&t!=Ti&&Dj(it)&&!_){if(xs[f].ObjectType==tc.OBJ_OCX&&Dj(xs[f].flags&tc.FFLAG_OCX_SRV_ERROR))c=true}if(c)xs[f].flags|=tc.FFLAG_DRAW_PENDING;else{var E=f;if(Nj(xs[f].anim)&&Nj(xs[f].anim.CurAnim)){E=xs[f].anim.CurAnim;if(xs[E].InUse&&Nj(xs[E].style&tc.PICT)){xs[E].CharWidth[tc.PICT_CHAR]=xs[f].CharWidth[tc.PICT_CHAR];xs[E].height=xs[f].height}else E=f}var R=xs[E].CharWidth[tc.PICT_CHAR];var L=xs[E].height;if(Ie!=0){var C=new tc.RECT;C=VY(e,r,e+R,r+L);C=S$(C,Nl);e=C.left<C.right?C.left:C.right;r=C.top<C.bottom?C.top:C.bottom}hG(t,e,r,R,L,E,l,a,true)}xs[f].flags|=tc.FFLAG_PICT_DRAWN;if(Nj(na&tc.PARA_BOX))UB(t,i,true);if(Nj(xs[f].anim))aD(f);return true}function SG(t,e,r,i,f){var l;if(s_>=__){__+=10;o_=fV(o_,__)}l=s_;var a=xs[r].CharWidth[tc.PICT_CHAR];var n=xs[r].height;if(Ie!=0){var c=new tc.RECT;c=VY(t,e,t+a,e+n);c=S$(c,Nl);t=c.left<c.right?c.left:c.right;e=c.top<c.bottom?c.top:c.bottom}o_[l].x=t;o_[l].y=e;o_[l].width=a;o_[l].height=n;o_[l].pict=r;o_[l].count=i;o_[l].LineNo=f;s_++;return true}function hG(t,e,r,i,f,l,a,n,c){var s,_,o,u,T=0,A=0;var E=e;var R=r;var L;var C;var I=xs[l].ParaFID;var d=0;var F=false;if(!_l)return true;c=false;a=1;if(i<0)i=xs[l].CharWidth[tc.PICT_CHAR];if(f<0)f=xs[l].height;if(xs[l].PctHeight>0){R=r=pl[Nl].y;_=f=Mj(pl[Nl].height,xs[l].PctHeight,100)}if(i<=0)i=1;if(f<=0)f=1;o=s=i;u=_=f;if(xs[l].ObjectType==tc.OBJ_OCX&&Dj(xs[l].flags&tc.FFLAG_OCX_SRV_ERROR)&&Dj(it)){if(Nj(xs[l].flags&tc.FFLAG_CTL_VISIBLE)){Or=true;Or=false}if(Nj(xs[l].flags&tc.FFLAG_CTL_VISIBLE)){xs[l].flags|=tc.FFLAG_CTL_DRAWN;return true}}if(Nj(kl[I].flags2&tc.PF2_INLINE)&&Nj(kl[I].flags&(tc.PARA_FRAME_RECT|tc.PARA_FRAME_LINE))){if(Nj(kl[I].flags&tc.PARA_FRAME_RECT))VB(t,-1,I,E,R,s,_,tc.MODE_DRAW_FILL);if(Nj(kl[I].flags&tc.PARA_FRAME_LINE))kB(t,-1,I,E,R,s,_)}L=Nj(xs[l].CropLeft)||Nj(xs[l].CropRight)||Nj(xs[l].CropTop)||Nj(xs[l].CropBot);if(L&&xs[l].PictWidth!=0){if(xs[l].ParaFID==0||xs[l].CropLeft<0){d=xs[l].PictWidth/(xs[l].OrigPictWidth-xs[l].CropLeft-xs[l].CropRight);T=dV(xs[l].CropLeft*d);E-=T;s=xs[l].OrigPictWidth*d;s=dV(s)}}if(L&&xs[l].PictHeight!=0){if(xs[l].ParaFID==0||xs[l].CropTop<0){d=xs[l].PictHeight/(xs[l].OrigPictHeight-xs[l].CropTop-xs[l].CropBot);A=hV(xs[l].CropTop*d);R-=A;_=xs[l].OrigPictHeight*d;_=hV(_)}}if(Nj(ii)&&Nj(vf)&&Nf<pf){var g=E$(E,0,Nl,vf[Nf]);var P=E$(E+s,0,Nl,vf[Nf]);if(P<g){g=WY(g,P);P=JC}E=g}var S=s;var h=_;if(Ie>0){s=WY(s,_);_=JC;o=WY(o,u);u=JC}if(Ie>0&&tg.OSCanRotate)F$(t);if(s<=0||_<=0)return true;if(xs[l].PictType==tc.PICT_IMAGE&&xs[l].ctl==null){var O=s*a;var v,p;var N=null;var D=0;N=t;v=e;p=r;var M=xs[l].image;if(M.naturalWidth>s*1.05||M.naturalHeight>_*1.05){if(xs[l].BlurImage==null)xs[l].BlurImage=OG(M,s,_);if(xs[l].BlurImage!=null)M=xs[l].BlurImage}var G=0,B=0;var H=M.naturalWidth;var m=M.naturalHeight;if(L&&xs[l].ParaFID>0){var w=65536;G=Mj(xs[l].CropLeftFixed,H,w);H-=Mj(xs[l].CropLeftFixed+xs[l].CropRightFixed,H,w);B=Mj(xs[l].CropTopFixed,m,w);m-=Mj(xs[l].CropTopFixed+xs[l].CropBotFixed,m,w)}try{if($l>0&&xs[l].ParaFID==$l&&ta!=null){N.drawImage(M,G,B,H,m,v,p,s,_)}else{if(xs[l].ImageAttr==null)N.drawImage(M,G,B,H,m,v,p,s,_);else{N.drawImage(M,G,B,H,m,v,p,s,_)}}}catch(t){console.log("PictOut, pict drawing error: ",t.toString())}}else if(xs[l].ctl!=null){var b,x,y;var W=true;var U=xs[l].ctl;var k=new tc.Point(E,R);k=cX(k);x=rt.top-OV(he);y=rt.bottom+OV(he);pG(E,R,E+s,R+_);if(W){if(U.getX()!=k.x||U.getY()!=k.y)U.setPos(k.x,k.y);if(s!=U.getWidth()||_!=U.getHeight())U.setSize(s,_);for(b=0;b<WE;b++)if(kE[b].InUse&&kE[b].pict==l&&kE[b].ctl==xs[l].ctl)break;if(b==WE){for(b=0;b<WE;b++)if(!kE[b].InUse)break}if(b==WE){if(WE>=UE){UE+=10;kE=fV(kE,UE)}b=WE;WE++}kE[b]=new tc.ClsScrCtl;kE[b].InUse=true;kE[b].x=k.x;kE[b].y=k.y;kE[b].width=s;kE[b].height=_;kE[b].DrawX=E;kE[b].pict=l;kE[b].ctl=U;kE[b].LineNo=n;kE[b].PaintId=Se;if(xs[l].FieldId!=tc.FIELD_CHECKBOX&&xs[l].FieldId!=tc.FIELD_COMBOBOX){NM(l)}}else{for(b=0;b<WE;b++)if(kE[b].InUse&&kE[b].pict==l&&kE[b].ctl==xs[l].ctl)break;if(b<WE){U.setVisible(false);kE[b].InUse=false;var X=K.copy();if(WA!=null)X.top=wA}}}xs[l].flags=cj(xs[l].flags,tc.FFLAG_DRAW_PENDING);if(Ie>0&&tg.OSCanRotate)d$(t,Nl);return true}function OG(t,e,r){}function vG(t,e,r,i){var f=new tc.RECT;var l,a;Hd=t;md=e;if(Nj(ii)&&Nj(vf)&&Nf<pf){l=E$(t,0,Nl,vf[Nf]);a=E$(t+r,0,Nl,vf[Nf]);if(a<l){l=WY(l,a);a=JC}t=l}if(Ie!=0){f.left=t;f.right=t+r;f.top=e;f.bottom=e+i;f=S$(f,Nl);t=f.left<f.right?f.left:f.right;e=f.top<f.bottom?f.top:f.bottom}Hd=t;md=e;return true}function pG(t,e,r,i){if(t<=Ft&&r>=0)ur|=tc.SPILL_LEFT;if(t<=Ft+je&&r>=Ft+je)ur|=tc.SPILL_RIGHT;if(e<=Gt&&i>=Gt-rt.top)ur|=tc.SPILL_TOP;if(i>=Gt+Mt&&e<Gt+K.bottom-rt.top)ur|=tc.SPILL_BOT;if(ur!=0)ur|=tc.SPILL_LEFT|tc.SPILL_RIGHT;return true}function NG(){var t;Ti.save();UG();for(t=0;t<WE;t++){if(!kE[t].InUse)continue;if(!kE[t].ctl.isVisible())kE[t].ctl.setVisible(true);else{if(Ur&&Sf!=null){var e=kE[t].ctl.getBounds();e.x+=Ft-rt.left;e.y+=Gt-rt.top;if(e.intersects(Sf))kE[t].ctl.repaint()}else kE[t].ctl.show()}MG(kE[t].pict)}Ti.restore();return true}function DG(){var t,e,r;var i=false,f=false;for(t=0;t<WE;t++){if(!kE[t].InUse)continue;if(kE[t].PaintId==Se)continue;e=kE[t].LineNo;r=kE[t].pict;if(e<0||e>=Ri)i=true;else i=!n$(e);if(!i){var l=nb(e);var a,n=ui[e].len;for(a=0;a<n;a++)if(l[a]==r)break;if(a==n)i=true;sb(e)}if(!i){var c=kE[t].DrawX;var s=c+kE[t].width;if(c>Ft+je)i=true;if(s<Ft)i=true}if(i){if(kE[t].ctl.isVisible())f=true;kE[t].ctl.setVisible(false);kE[t].InUse=false;var _=K.copy();if(WA!=null)_.top=wA}}if(f)VG();return true}function MG(t){return true}function GG(t){var e,r,i;var f,l,a;var n=false;var c=0;e=iW(t);if(e<0)return false;r=pl[e].y+pl[e].SpaceTop;for(f=pl[e].PageFirstLine;f<t;f++){if(L6(f)!=pl[e].level)continue;r=r+$q(f,true)}l=t$(t,true);a=t$(t,false);r+=l-a;if(Xt>Tt-a)n=true;if(r>Gt+Tt-a)n=true;if(n)Xt=Tt-a;if(_i.HasTouchScreen){if(Xt<Gt){var s=ib(br,jt);Xt=-ui[br].BaseHt+xs[s].BaseHeight;c=(Tt-xs[s].height)*9/10}}else if(Xt<0)Xt=0;if(r<Xt)Xt=r;i=r-Xt;if(Gt!=i){Gt=i;if(c>0)Gt-=c;if(Gt<0)Gt=0;BG()}return true}function BG(){if(JE){Br=tc.PAINT_WIN;XM()}if(zE){Br=tc.PAINT_WIN;KM()}$M(tc.DRAG_TYPE_SCR_FIRST,tc.DRAG_TYPE_SCR_LAST);Aq();if(_l){Ti.setTransform(1,0,0,1,0,0);Ti.translate(-Ft+rt.left,-Gt+rt.top)}_q();bG(false);ai=true}function HG(t,e){if(e==0&&Nl>=0&&Nl<Dl&&pl[Nl].ParaFrameId>0){var r=pl[Nl].ParaFrameId;if(jW(r)){if(pl[Nl].BoxFrame==Nl){var i=kl[r].FillOpacity-1;if(i>255)i=255;BH(et,t,kl[r].BackColor,i);return true}else{return MJ(fA,kl[r].BackColor)}}}return false}function mG(t,e,r){if(Nj(it))return false;if(Nj(Zh&tc.TFLAG2_XPARENT_WRITE)&&Nj(aO&tc.TOFLAG_WRITING_BKND)&&fi){if(Nj(p))wG(r,et);else{var i=nZ();var f=et.fillStyle;et.fillStyle=nZ().toString();et.fillRect(r.left,r.top,r.right-r.left,r.bottom-r.top);et.fillStyle=f}}else if(Nj(p))wG(r,et);if(B.left==-1)B=r.copy();else{if(r.left<B.left)B.left=r.left;if(r.top<B.top)B.top=r.top;if(r.right>B.right)B.right=r.right;if(r.bottom>B.bottom)B.bottom=r.bottom}return false}function wG(t,e){if(Nj(p)){var r=ii&&vf!=null&&Nf<pf;if(r)t=R$(t,Nl,vf[Nf]);var i=t.top;var f=t.left;if(i<Gt)i=Gt;if(f<Ft)f=Ft;var l=Math.round(t.right-f);var a=Math.round(t.bottom-i);var n=Math.round(f-Ft);var c=Math.round(i-Gt);var s=l;var _=a;if(n+s>je)s=Math.round(je-n);if(c+_>Mt)_=Math.round(Mt-c);if(s>0&&_>0)e.drawImage(p,n,c,s,_,t.left,t.top,s,_)}return true}function bG(t){ZU("DeleteTextMap");if(t&&jh>0){if(Nj(p)){if(et==null){Ti.drawImage(p,0,0,je,Mt,Ft,Gt,je,Mt);if(zR&&!ZR&&_i.dialog==null)_i.caret.show()}}else{if(je>0&&Mt>0){var e=Nj(et)?et:Ti;xG(e);var r=document.createElement("canvas");r.width=je+10;r.height=Mt+10;var i=r.getContext("2d");i.drawImage(_i.cvs,rt.left,rt.top,je,Mt,0,0,je,Mt);p=r;H=i;if(zR&&!ZR&&_i.dialog==null)_i.caret.show()}}}Br=tc.PAINT_WIN;return true}function xG(t){var e=new tc.RECT;var r=null,i=t;ZU("PaintBkPict");if(jh==0)return true;if(i==Ti||i==et){if(zR&&!ZR)_i.caret.hide();yG(i,Ft,Gt);if(zR&&!ZR&&_i.dialog==null)_i.caret.show()}else{var f=rt;var l=Ft;var a=Gt;rt=e;Ft=Gt=0;yG(i,0,0);rt=f;Ft=l;Gt=a;if(Nj(r)&&Nj(MetaBM)&&(t==Ti||t==et)){if(zR&&!ZR)_i.caret.hide();t.drawImage(MetaBM,0,0,je,Mt,Ft,Gt,je,Mt);if(zR&&!ZR&&_i.dialog==null)_i.caret.show()}}return true}function yG(t,e,r){var i=xs[jh].CharWidth[tc.PICT_CHAR];var f=xs[jh].height;ZU("BkPictOut");if(i==0||f==0)return true;if(Jh==tc.BKPICT_STRETCH)hG(t,e,r,i,f,jh,1,-1,t==et);else if(Jh==tc.BKPICT_TILE){var l=e+je;var a=r+Mt;var n,c;var s=Nj(zh&tc.TFLAG_NO_PALETTE);t.save();UG();c=r;while(c<a){n=e;while(n<l){hG(t,n,c,i,f,jh,1,-1,t==et);n+=i;if(i>1)n--;zh|=tc.TFLAG_NO_PALETTE}c+=f;if(f>1)c--}if(!s)_i.TerSetFlags(false,tc.TFLAG_NO_PALETTE);t.restore()}else{hG(t,e,r,i,f,jh,1,-1,t==et);if(t==Ti||t==et){var _=new tc.RECT;if(i<je){_.left=e+i;_.right=e+je;_.top=r;_.bottom=r+f;var o=t.getColor();t.setPaint(nZ());t.fill(YY(_));t.setPaint(o)}if(f<Mt){_.left=e;_.right=e+je;_.top=r+f;_.bottom=r+Mt;oJ(Ti,new tc.Brush(nZ()),YY(_))}}}return true}function WG(t,e){t.beginPath();t.rect(e.left,e.top,e.width,e.height);t.closePath();t.clip()}function UG(){var t;if(false&&Nj(Sf))t=Sf;else t=new tc.Rectangle(Ft,Gt,rt.right-rt.left,rt.bottom-rt.top);WG(Ti,t);return true}function kG(){return true}function XG(t,e,r){if(r!=gk("N"))KG(t,r,e);hc=e;if(Nj(xs[e].style&tc.PICT))return true;if(Eu){V=Xs[e].font;T=Xs[e].FontString;g=Xs[e].hFont}else{V=xs[e].font;T=xs[e].FontString;g=xs[e].hFont}return FJ(t,V)}function KG(t,e,r){var i,f,l;var a,n;var c,s,_;var o=true,u=false;if(Nl<0)Nl=0;if(Nl>=0){n=pl[Nl].ParaFrameId;if(n>0&&n<Kl&&Nj(kl[n].flags&(tc.PARA_FRAME_TEXT_BOX|tc.PARA_FRAME_CONV)))u=kl[n].FillPattern!=0;if(n>0&&kl[n].FillOpacity>0)o=false}f=xs[r].TextBkColor;if(MJ(f,tc.CLR_WHITE))f=xs[r].HilightColor;if(MJ(f,tc.CLR_WHITE))f=Ia;if(MJ(f,tc.CLR_WHITE))f=nZ();if(e==tc.CHAR_P){if(Ia!=tc.CLR_WHITE)f=Ia;else f=nZ();e=tc.CHAR_T}l=Ca;if(l==tc.CLR_WHITE)l=nZ();if((lA!=0||l!=nZ()||Nj(sa&tc.FRAME_FORCE_BKND_CLR))&&f==nZ()&&(e==tc.CHAR_T||e==gk("H"))&&ca==0&&Ia==tc.CLR_WHITE){if(lA==-1)f=l;else{if(l!=nZ()||Nj(sa&tc.FRAME_FORCE_BKND_CLR)){var T=lA>0?lA:0;c=l.getRed()*(100-T)/100;s=l.getGreen()*(100-T)/100;_=l.getBlue()*(100-T)/100;f=new tc.Color(c,s,_)}else{a=lA*255/100;if(a>255)a=255;a=~a&255;f=new tc.Color(a,a,a);if(lA<80)o=false}}}if(vA)e=gk("H");i=xs[r].TextColor;if(!Q_){if(Nj(xs[r].InsRev))i=ul[xs[r].InsRev].InsColor;if(Nj(xs[r].DelRev))i=ul[xs[r].DelRev].DelColor}if($T!=tc.CLR_WHITE)o=false;if(i==tc.CLR_AUTO&&Dj(Qh&tc.TFLAG3_NO_TEXT_COLOR_ADJ)&&o){var A=f.getRed()+f.getGreen()+f.getBlue();if(A<=192)i=tc.CLR_WHITE}if(i==tc.CLR_BLACK||i==tc.CLR_AUTO)i=JT;if(e==tc.CHAR_T){if(oi.ReadOnly&&Nj(Qh&tc.TFLAG3_GRAY_READ_ONLY)){if(i==tc.Color.black)i=new tc.Color(128,128,128);else i=BJ(i,tc.PROTECT_COLOR)}else if(Nj(xs[r].style&tc.PROTECT)&&ph||oi.ReadOnly&&Nj(Qh&tc.TFLAG3_GRAY_READ_ONLY)||Nj(aO&tc.TOFLAG_FNOTE_FRAME)||Nj(pl[Nl].flags&tc.FRAME_GRAY)&&ph&&Dj(Qh&tc.TFLAG3_NO_TEXT_COLOR_ADJ)||yR&&!WR&&Nj(Nc[Gc].flags&tc.PAGE_HDR_FTR)&&Dj(Qh&tc.TFLAG3_NO_TEXT_COLOR_ADJ)||k_>=0){i=BJ(i,new tc.Color(63,63,63))}}else if(e==gk("H")){if(Nj(xs[r].style&tc.PROTECT)&&ph)i=DJ(BJ(i,tc.PROTECT_COLOR));else i=DJ(i);f=DJ(f)}else if(e==gk("S")){i=ZT;f=zT}if(Nj(xs[r].style&tc.EMBOSS))i=YG(i,f);if(Nj(ca)&&Ia==tc.CLR_WHITE){a=ca*255/1e4;if(a>255)a=255;if(a>=104&&a<=152)a=104;var E=new tc.Color(a,a,a);if((!Li||Dj(xs[r].style&wh))&&i==xs[0].TextColor&&ca>=80)i=BJ(i,E);if(f==nZ())f=BJ(tc.Color.white,E);else f=BJ(f,E)}else if(ca!=0){var R=255*ca/1e4;c=f.getRed();s=f.getGreen();_=f.getBlue();c=c<R?0:c-R;s=s<R?0:s-R;_=_<R?0:_-R;f=new tc.Color(c,s,_)}if(Nj(ca)||Ia!=tc.CLR_WHITE){var L=i==tc.CLR_AUTO?tc.CLR_BLACK:i;if(L==f)i=DJ(f)}if(xs[r].FieldId>0&&Dj(iO&tc.TFLAG9_NO_SHADE_DYNAMIC_FIELDS)&&Iw(xs[r].FieldId)||xs[r].FieldId==tc.FIELD_NAME||xs[r].FieldId==tc.FIELD_DATA&&Dj(Zh&tc.TFLAG2_NO_SHADE_FIELD_TEXT)||xs[r].FieldId==tc.FIELD_TEXTBOX&&Dj(Zh&tc.TFLAG2_NO_SHADE_FIELD_TEXT)){if(MJ(xs[r].HilightColor,tc.CLR_WHITE)){f=NJ(176,176,176)}}if(Dj(iO&tc.TFLAG9_NO_COMMENTS)&&ly(r))f=zn;if(GJ(i,f)&&!GJ(xs[r].TextColor,xs[r].TextBkColor)){i=xs[r].TextColor}iA=i;fA=f;fi=li;if(f!=nZ())fi=false;if(u)fi=false;if(Nj(cO&tc.TOFLAG3_NO_TEXT_BKND))fi=true;if(pl[Nl].ParaFrameId>0){n=pl[Nl].ParaFrameId;if(Nj(kl[n].flags&tc.PARA_FRAME_FILL_PICT)&&kl[n].FillPict>0)fi=true}if(!fi&&Dj(cO&tc.TOFLAG3_TEXT_BKND_ONLY)&&jW(-Nl))fi=true;return true}function YG(t,e){var r,i,f;r=Math.abs(e.getRed()-t.getRed());i=Math.abs(e.getGreen()-t.getGreen());f=Math.abs(e.getBlue()-t.getBlue());if(r<=32&&i<=32&&f<=32){r=e.getRed()/2;if(r==e.getRed())r=t.getRed()/2;i=e.getGreen()/2;if(i==e.getGreen())i=t.getGreen()/2;f=e.getBlue()/2;if(f==e.getBlue())f=t.getBlue()/2;t=new tc.Color(r,i,f)}return t}function VG(){var t,e;if(!oi.BorderMargin&&!Ru)return true;Ti.save();Ti.setTransform(1,0,0,1,0,0);var r=Ti.fillStyle;Ti.fillStyle=tA.toString();e=K.copy();if($A)e.left=X.right+1;if(Ru){Kw(-1);e.top+=wA;Ti.fill(YY(e))}else{if(Nj(se)||Nj(wA)||oi.ruler){e.top=e.top+wA;if(oi.ruler)e.top=k.bottom;e.bottom-=se}if(e.top<rt.top&&e.left<e.right){t=e.copy();t.bottom=rt.top;Ti.fillRect(t.left,t.top,t.right-t.left,t.bottom-t.top)}if(e.bottom>rt.bottom&&e.left<e.right){t=e.copy();t.top=rt.bottom;Ti.fillRect(t.left,t.top,t.right-t.left,t.bottom-t.top)}if(e.left<rt.left&&e.top<e.bottom){t=e.copy();t.right=rt.left;Ti.fillRect(t.left-1,t.top,t.right-t.left+1,t.bottom-t.top)}if(e.right>rt.right&&e.top<e.bottom){t=e.copy();t.left=rt.right;Ti.fillRect(t.left,t.top,t.right-t.left,t.bottom-t.top)}}Ti.fillStyle=r.toString();Ti.restore();Zr=false;return true}function jG(t,e,r,i,f,l,a,n){var c=new tc.Pen(1,tc.Color.black);var s=new tc.Pen(tc.Color.white);var _=tc.Color.white;var o=false,u=false,T=true;var A,E,R,L,C,I;var d=false,F=false,g=false,P=false;var S=Nl>=Qe?qe+1:qe;var h,O;var v,p=0,N,D;var M,G,B,H;var m,w,b,x;var y,W;var U;if(Nj(eR[e].flags&tc.CFLAG_ROW_SPANNED))return true;E=eR[e].row;if(n)v=1;else{v=DV(15);c=new tc.Pen(tc.Color.black);s=new tc.Pen(new tc.Color(4144959),v);o=u=true}h=o6(true,eR[e].row,S);O=o6(false,eR[e].row,S);if(oi.ReadOnly){var k=pl[Nl].PageFirstLine;if(Nj(ui[k].tabw)&&Nj(ui[k].tabw.type&tc.INFO_CELL)&&ui[k].len==1&&!h)T=false}if(Nj(eR[e].flags&tc.CFLAG_HIDDEN))T=false;if(n){R=dV(a[tc.BORDER_INDEX_LEFT]);L=dV(a[tc.BORDER_INDEX_RIGHT]);C=hV(a[tc.BORDER_INDEX_TOP]);I=hV(a[tc.BORDER_INDEX_BOT])}else{R=DV(a[tc.BORDER_INDEX_LEFT]);L=DV(a[tc.BORDER_INDEX_RIGHT]);C=mV(a[tc.BORDER_INDEX_TOP]);I=mV(a[tc.BORDER_INDEX_BOT])}p=c8(e);N=n?dV(p):DV(p);D=n?hV(p):mV(p);b=$E[E].BorderWidth[tc.BORDER_INDEX_LEFT];x=$E[E].BorderWidth[tc.BORDER_INDEX_RIGHT];m=$E[E].BorderWidth[tc.BORDER_INDEX_TOP];w=$E[E].BorderWidth[tc.BORDER_INDEX_BOT];B=$E[E].BorderColor[tc.BORDER_INDEX_LEFT];H=$E[E].BorderColor[tc.BORDER_INDEX_RIGHT];M=$E[E].BorderColor[tc.BORDER_INDEX_TOP];G=$E[E].BorderColor[tc.BORDER_INDEX_BOT];E=eR[e].row;if(s6(E))d=true;for(A=eR[e].RowSpan;A>1;A--)if(E>0)E=$E[E].NextRow;if(E<=0||u6(E))F=true;if(eR[e].PrevCell<=0)g=true;if(eR[e].NextCell<=0)P=true;if(eR[e].BorderColor[tc.BORDER_INDEX_TOP]!=tc.CLR_AUTO){o=u=false;s=new tc.Pen(eR[e].BorderColor[tc.BORDER_INDEX_TOP]);c=new tc.Pen(eR[e].BorderColor[tc.BORDER_INDEX_TOP]);o=u=true}else if(n&&nZ()==tc.Color.white){o=u=false;s=new tc.Pen(new tc.Color(11513775));o=true}if(d&&D>0){y=n?hV(m):mV(m);W=y/2;U=new tc.Pen(JG(M,true),y);U.setStartCapRound();U.setEndCapRound();hH(t,r-N-W,i-D-W,f+N+W,i-D-W,U,null)}if(F&&D>0){y=n?hV(w):mV(w);W=y/2;U=new tc.Pen(JG(G,false),y);U.setStartCapRound();U.setEndCapRound();hH(t,r-N-W,l+D+W,f+N+W,l+D+W,U,null)}if(g&&N>0){y=n?dV(b):DV(b);W=y/2;U=new tc.Pen(JG(B,true),y);U.setStartCapRound();U.setEndCapRound();hH(t,r-N-W,i-D-W,r-N-W,l+D+W,U,null)}if(P&&N>0){y=n?dV(x):DV(x);W=y/2;U=new tc.Pen(JG(H,false),y);U.setStartCapRound();U.setEndCapRound();hH(t,f+N+W,i-D-W,f+N+W,l+D+W,U,null)}if(T){if(!h)hH(t,r,i,f,i,c,null);hH(t,r,i,r,l,c,null);if(!O)hH(t,r,l,f,l,s,null);hH(t,f,i,f,l,s,null)}return true}function JG(t,e){var r=t.getRed();var i=t.getGreen();var f=t.getBlue();var l=32;if(MJ(t,tc.CLR_WHITE)){if(e)return new tc.Color(192,192,192);else return new tc.Color(128,128,128)}if(MJ(t,tc.CLR_BLACK)){if(e)return new tc.Color(128,128,128);else return new tc.Color(64,64,64)}if(e){r+=l;if(r>255)r=255;i+=l;if(i>255)i=255;f+=l;if(f>255)f=255}else{r-=l;if(r<0)r=0;i-=l;if(i<0)i=0;f-=l;if(f<0)f=0}return new tc.Color(r,i,f)}function zG(t,e,r,i){var f,l,a,n;var c;if(Dj(pl[e].flags&tc.FRAME_LINE_BET_COL))return true;f=pl[e].sect;if(Dj(to[f].flags&tc.SECT_LINE_BET_COL))return true;if(Eu)a=tg.UNITS_PER_INCH*to[f].ColumnSpace;else a=Nt*to[f].ColumnSpace;l=r+pl[e].x+pl[e].width-a/2;n=i+pl[e].y;c=new tc.Pen(1,tc.Color.black);hH(t,l,n,l,n+pl[e].height,c,null);return true}function ZG(t,e){var r,i,f,l,a;r=pl[e].border;if(Nj(r&tc.BORDER_ALL)&&Dj(pl[e].flags&tc.FRAME_NON_TEXT_DO)&&!JW(pl[e].ParaFrameId)){var n,c,s=0;i=pl[e].ScrX;l=pl[e].y;f=pl[e].ScrX+pl[e].width;a=pl[e].y+pl[e].height;if(pl[e].CellId>0){var _=pl[e].CellId;s=eR[_].row}if(pl[e].CellId>0&&c8(pl[e].CellId)>0)jG(t,pl[e].CellId,i,l,f,a,pl[e].BorderWidth,true);else{var o=pl[e].CellId>0&&Nj(pl[e].flags&tc.FRAME_RTL);if(o){i=WY(i,f);f=JC}QG(t,i,l,f,l,pl[e].BorderWidth[tc.BORDER_INDEX_TOP],tc.BORDER_TOP);c=pl[e].CellId>0?a-1:a;QG(t,i,c,f,c,pl[e].BorderWidth[tc.BORDER_INDEX_BOT],tc.BORDER_BOT);QG(t,i,l,i,a,pl[e].BorderWidth[tc.BORDER_INDEX_LEFT],tc.BORDER_LEFT);n=o||pl[e].CellId==0?f:f-1;QG(t,n,l,n,a,pl[e].BorderWidth[tc.BORDER_INDEX_RIGHT],tc.BORDER_RIGHT)}}return true}function QG(t,e,r,i,f,l,a){var n=new tc.RECT;var c;var s=tc.Color.black;var _;var o=pl[Nl].CellId;var u=Nl>=Qe?qe+1:qe;var T=ii;var A,E;var R;if(o>0&&Nj(rR[o].flags&tc.CAUX_HIDDEN)){var L=true;A=eR[o].row;E=$E[A].FirstCell;while(E>0){if(Dj(rR[E].flags&tc.CAUX_HIDDEN))L=false;E=eR[E].NextCell}if(L)return true}if(o>0){if(Nj(eR[o].flags&tc.CFLAG_ROW_SPANNED)){A=eR[o].row;var C=rR[o].PrevColCell;var I=rR[o].NextColCell;if(a==tc.BORDER_TOP){var d=po[u].FirstRow==A;if(!d&&C>0&&rR[o].FirstPage==rR[C].LastPage)return true}else if(a==tc.BORDER_BOT){if(I>0&&rR[o].LastPage==rR[C].FirstPage)return true}}if(Wl==null)Wl=[yl+1];Wl[xl]=new tc.ClsFrameBorder;Wl[xl].frm=Nl;Wl[xl].border=a;Wl[xl].CellHilighted=vA;xl++;return true}if(l>0){var F=l;if(o==0){if(r==f)l=hV(l);else l=dV(l);if(l==0&&F>0)l=1}else if(a==tc.BORDER_TOP||a==tc.BORDER_LEFT){R=true;if(a==tc.BORDER_TOP||R){if(r==f)l=hV(l);else l=dV(l);if(l<=0)l=1}else{var g=dV(l);if(g<=0)g=1;l=dV(l)-g}}else{if(a==tc.BORDER_RIGHT){var P=eR[o].NextCell;if(P>0&&Nj(eR[P].flags&tc.CFLAG_ROW_SPANNED)&&rR[P].SpanningCell>0)P=rR[P].SpanningCell;R=P<=0;if(!R&&eR[o].RowSpan!=eR[P].RowSpan){var S=dV(l/2);if(S<=0)S=1;e+=S;i+=S;R=true}if(ii){R=true;if(eR[o].NextCell<=0)l=l/2}}else{A=eR[o].row;R=$E[A].NextRow<=0||Lz(-o,u)}if(R){if(r==f)l=hV(l);else l=dV(l);if(l<=0)l=1}else{var h;if(r==f)h=hV(l);else h=dV(l);if(h<=0)h=1;if(r==f)l=hV(2*l)-h;else l=dV(2*l)-h;if(l==0&&a==tc.BORDER_BOT){l=1;if(r+l>=pl[Nl].y+pl[Nl].height&&AW(o,u,true)>0)return true;r++;f++}}}if(l<=0)return true}if(l==0){if(Dj(pl[Nl].border&a))return true;if(o>0&&Nj(eR[o].border&a))return true;if(o>0&&a==tc.BORDER_TOP){A=eR[o].row;var O=$E[A].PrevRow;var v=false;if(O>=0){if(tR[O].LastPage!=tR[A].FirstPage)v=true;if(!v&&tR[A].LastPage==u&&tR[A].LastPage!=tR[A].FirstPage)v=true;if(!v){var p=bV(tR[O].FrmBegX);var N=bV(tR[O].FrmEndX);var D;if(e>=p&&i<=N)return true;D=e<p&&i>N;if(!D&&e<p&&i<=p)D=true;if(!D&&i>N&&e>=N)D=true;if(!D){if(e<p)i=p;if(i>N)e=N}}}}if(Nj(pl[Nl].flags&tc.FRAME_RTL)&&a==tc.BORDER_RIGHT&&e==-1&&i==-1)e=i=0;if(vA)return RH(t,e,r,i,f,Color.white);else return RH(t,e,r,i,f,tc.Color.black)}if(a==tc.BORDER_TOP)s=pl[Nl].BorderColor[tc.BORDER_INDEX_TOP];if(a==tc.BORDER_BOT)s=pl[Nl].BorderColor[tc.BORDER_INDEX_BOT];if(a==tc.BORDER_LEFT)s=pl[Nl].BorderColor[tc.BORDER_INDEX_LEFT];if(a==tc.BORDER_RIGHT)s=pl[Nl].BorderColor[tc.BORDER_INDEX_RIGHT];c=pl[Nl].ParaFrameId;if(Nj(kl[c].flags&(tc.PARA_FRAME_TEXT_BOX|tc.PARA_FRAME_CONV)))s=kl[c].LineColor;if(c>0&&kl[c].LineOpacity>0){var M=kl[c].LineOpacity-1;if(M>255)M=255;if(M<255&&pl[Nl].BoxFrame==Nl){if(a==tc.BORDER_TOP){var G=new tc.RECT;G.left=e;G.top=r;G.right=G.left+pl[Nl].width;G.bottom=G.top+pl[Nl].height;GH(t,G,s,l,M)}}else DH(t,e,r,i,f,s,l,M);return true}if(Nj(c)&&Nj(kl[c].flags&tc.PARA_FRAME_DOTTED)){return RH(t,e,r,i,f,s)}ii=false;if(l<=1){if(vA)hH(t,e,r,i,f,new tc.Pen(tc.Color.white),null);else{if(s==tc.Color.black)_=new tc.Pen(l,tc.Color.black);else _=new tc.Pen(s,l);hH(t,e,r,i,f,_,null)}}else{if(l>1){if(a==tc.BORDER_TOP||a==tc.BORDER_BOT){if(a==tc.BORDER_TOP)n.top=r;else n.top=r-l+1;n.bottom=n.top+l;n.left=e;n.right=i}else{if(a==tc.BORDER_LEFT)n.left=e;else n.left=e-l+1;n.right=n.left+l;n.top=r;n.bottom=f}if(vA)HH(t,tc.CLR_WHITE,n);else HH(t,s,n)}}ii=T;return true}function qG(t,e){var r,i;var f,l,a;for(r=0;r<xl;r++){Wl[r].width=0;l=Wl[r].frm;f=pl[l].CellId;if(f<=0)return true;a=Wl[r].border;if(a==tc.BORDER_BOT&&eR[f].RowSpan>1&&rR[f].LastSpannedCell>0){var n=rR[f].LastSpannedCell;Wl[r].width=eR[n].BorderWidth[tc.BORDER_INDEX_BOT]}else{if(Nj(eR[f].border&a)){if(a==tc.BORDER_TOP)Wl[r].width=eR[f].BorderWidth[tc.BORDER_INDEX_TOP];else if(a==tc.BORDER_BOT)Wl[r].width=eR[f].BorderWidth[tc.BORDER_INDEX_BOT];else if(a==tc.BORDER_LEFT)Wl[r].width=eR[f].BorderWidth[tc.BORDER_INDEX_LEFT];else if(a==tc.BORDER_RIGHT)Wl[r].width=eR[f].BorderWidth[tc.BORDER_INDEX_RIGHT];else Wl[r].width=-1}}rR[f].FrameY=pl[l].y}Wl.sort(function(t,e){return t.width<e.width});for(r=0;r<xl;r++){if(!ER&&Wl[r].width<=0)continue;e=EG(t,Wl[r].frm,e,0,0);$G(t,r)}return e}function $G(t,e){var r,i,f,l=0,a=0,n=0,c=0;var s=rA;var _=0,o,u;var T;if(e>=xl)return true;i=Wl[e].frm;r=pl[i].CellId;if(r<=0)return true;f=Wl[e].border;var A=pl[i].height;a=pl[i].y+A;o=eR[r].row;u=$E[o].NextRow;if(u>=0){var E=$E[u].FirstCell;if(E>0){if(a+1==rR[E].FrameY)A=rR[E].FrameY-pl[i].y;else if(a-1==rR[E].FrameY)A=rR[E].FrameY-pl[i].y}}if(f==tc.BORDER_TOP){if(oi.FittedView){o=eR[r].row;if(o6(true,o,pl[i].PageNo))return true}l=pl[i].x;n=pl[i].x+pl[i].width;a=c=pl[i].y}else if(f==tc.BORDER_BOT){if(oi.FittedView){o=eR[r].row;if(o6(false,o,pl[i].PageNo))return true}l=pl[i].x;n=pl[i].x+pl[i].width;a=c=pl[i].y+A}else if(f==tc.BORDER_LEFT){a=pl[i].y;c=pl[i].y+A;l=n=pl[i].x}else if(f==tc.BORDER_RIGHT){a=pl[i].y;c=pl[i].y+A;l=n=pl[i].x+pl[i].width}if(eR[r].RowSpan>1&&rR[r].LastSpannedCell>0){r=rR[r].LastSpannedCell}if(Nj(eR[r].border&f)){s=tc.Color.black;if(f==tc.BORDER_TOP)s=eR[r].BorderColor[tc.BORDER_INDEX_TOP];if(f==tc.BORDER_BOT)s=eR[r].BorderColor[tc.BORDER_INDEX_BOT];if(f==tc.BORDER_LEFT)s=eR[r].BorderColor[tc.BORDER_INDEX_LEFT];if(f==tc.BORDER_RIGHT)s=eR[r].BorderColor[tc.BORDER_INDEX_RIGHT];if(Wl[e].CellHilighted)s=DJ(s);_=0;if(f==tc.BORDER_TOP||f==tc.BORDER_BOT)_=hV(Wl[e].width);else if(f==tc.BORDER_LEFT||f==tc.BORDER_RIGHT)_=dV(Wl[e].width)}else if(Nj(fO&tc.TFLAG10_DOTTED_GRID_LINES)){if(Wl[e].CellHilighted)s=tc.CLR_WHITE;else s=tc.CLR_BLACK;if(Nj(l^2)&&(f==tc.BORDER_TOP||f==tc.BORDER_BOT))l++;return RH(t,l,a,n,c,s)}T=new tc.Pen(s,_);hH(t,l,a,n,c,T,null);return true}function tB(){var t;var e,r,i,f,l,a,n,c,s,_,o,u,T,A,E,R;var L;var C,I;var d=new tc.RECT;var F=Eu;var g;var P;if(Ru)return true;if(!oi.ShowStatus)return Nj(UD(tc.TER_UPDATE_STATUSBAR,S,0,false));Eu=false;if(dr)Ex(Ti);C=new tc.Pen(new tc.Color(8355711),vt);I=new tc.Pen(new tc.Color(15724527),vt);V=h;hc=0;g=new tc.Brush(ZT);o=r=Pq(tc.STATUS_ROW);u=Ft-(rt.left-K.left);T=u+K.right-K.left;d.left=u;d.right=T;d.top=o;d.bottom=d.top+Ot+6*vt;oJ(Ti,new tc.Brush(zT),YY(d));f=o+Ot+6*vt-1;hH(Ti,u,f,T,f,I,null);o+=3*vt;if(ES)t=tg.MsgString[tc.MSG_SB_INS];else t=tg.MsgString[tc.MSG_SB_OT];e=Ft+2;P=d.top+(d.bottom-d.top-Ot)/2;FJ(Ti,h);sJ(Ti,t,h,g,new tc.Point(e+vt,P));n=mX(Ti,tg.MsgString[tc.MSG_SB_INS]);c=mX(Ti,tg.MsgString[tc.MSG_SB_OT]);if(c>n)n=c;i=r+2*vt;f=i+Ot+vt;l=e;a=e+n+2*vt;PH(Ti,l,i,a,f,C,I);if(F)t=tg.MsgString[tc.MSG_SB_PRINTING_PAGE]+"00000";else if(oi.FittedView)t=tg.MsgString[tc.MSG_SB_LINE]+"00000 "+tg.MsgString[tc.MSG_SB_COL]+"0000";else t=tg.MsgString[tc.MSG_SB_ROW]+"0000 "+tg.MsgString[tc.MSG_SB_LINE]+"00000 "+tg.MsgString[tc.MSG_SB_COL]+"0000";s=mX(Ti,t);_=Math.max((rt.right-rt.left-s)/2,a+10);_=_+Ft;l=_-4;if(F){t=tg.MsgString[tc.MSG_SB_PRINTING_PAGE];sJ(Ti,t,h,g,new tc.Point(_,o));_+=mX(Ti,t);Ff=_-Ft;JO=Integer.toString(iu+1);if(iu<0)JO="";for(s=JO.length;s<5;s++)JO+=tc.SPACE;sJ(Ti,JO,h,g,new tc.Point(_,o));_+=mX(Ti,"00000 ")}else{A=rB();E=SC;R=hC;if(!oi.FittedView){if(oi.WordWrap&&oi.PrintView)t=tg.MsgString[tc.MSG_SB_PAGE];else t=tg.MsgString[tc.MSG_SB_ROW];sJ(Ti,t,h,g,new tc.Point(_,o));_+=mX(Ti,t);Ff=_-Ft;if(oi.WordWrap&&oi.PrintView){if(Nj(Zh&tc.TFLAG2_SHOW_SECT_PAGE_NO))JO=po[R].DispNbr.toString();else JO=(R+1).toString()}else JO=mY(we+1);for(s=JO.length;s<5;s++)JO+=" ";sJ(Ti,JO,h,g,new tc.Point(_,o));_+=mX(Ti,"00000 ")}t=tg.MsgString[tc.MSG_SB_LINE];sJ(Ti,t,h,g,new tc.Point(_,o));_+=mX(Ti,t);Pf=_-Ft;JO=mY(A);for(s=JO.length;s<5;s++)JO+=" ";sJ(Ti,JO,h,g,new tc.Point(_,o));_+=mX(Ti,"00000 ");t=tg.MsgString[tc.MSG_SB_COL];sJ(Ti,t,h,g,new tc.Point(_,o));_+=mX(Ti,t);gf=_-Ft;JO=mY(E+1);for(s=JO.length;s<4;s++)JO+=" ";sJ(Ti,JO,h,g,new tc.Point(_,o))}a=_+mX(Ti,"00000")+1;PH(Ti,l,i,a,f,C,I);kG();Eu=F;return true}function eB(){var t,e,r,i,f,l;var a=[5];var n;var c,s;var _;var o;var u=new tc.RECT;var T=Eu;if(!oi.ShowStatus||Nj(iO&tc.TFLAG9_ALWAYS_FIRE_STATUS_EVENT))return Nj(UD(tc.TER_UPDATE_STATUSBAR,S,0,false));Eu=false;n=new tc.Rectangle(Ft+rt.left,Gt+rt.top,rt.right-1-rt.left,K.bottom-rt.top);Ti.save();Ti.setTransform(1,0,0,1,0,0);Ti.translate(-Ft+rt.left,-Gt+rt.top);WG(Ti,n);V=h;FJ(Ti,h);hc=0;c=Ti.fillStyle;iA=ZT;s=fA;fA=zT;JO="0123456789";if(A==null){A=SJ(Ti,V,JO)}_=A;for(t=0;t<5;t++)a[t]=_.cx/10;e=Pq(tc.STATUS_ROW)+3*vt;u.top=e;u.bottom=e+_.cy;if(T){JO=mY(iu+1);for(t=JO.length;t<5;t++)JO+=" ";u.left=Ft+Ff;u.right=u.left+5*a[0];cJ(Ti,Ft+Ff,e,tc.ETO_OPAQUE,u,null,Uk(JO),5,a,0,false)}else{i=rB();f=SC;l=hC;if(!oi.FittedView){if(oi.WordWrap&&oi.PrintView){if(Nj(Zh&tc.TFLAG2_SHOW_SECT_PAGE_NO))JO=mY(po[l].DispNbr);else JO=mY(l+1)}else JO=mY(we+1);for(t=JO.length;t<5;t++)JO+=" ";u.left=Ft+Ff;u.right=u.left+5*a[0];cJ(Ti,Ft+Ff,e,tc.ETO_OPAQUE,u,null,Uk(JO),5,a,0,false)}JO=mY(i);for(t=JO.length;t<5;t++)JO+=" ";u.left=Ft+Pf;u.right=u.left+5*a[0];cJ(Ti,Ft+Pf,e,tc.ETO_OPAQUE,u,null,Uk(JO),5,a,0,false);JO=mY(f+1);for(t=JO.length;t<4;t++)JO+=" ";u.left=Ft+gf;u.right=u.left+4*a[0];cJ(Ti,Ft+gf,e,tc.ETO_OPAQUE,u,null,Uk(JO),4,a,0,false)}Ti.fillStyle=c;fA=s;Ti.restore();Eu=T;return true}function rB(){var t,e,r,i,f;var l;if(br>=Ri&&Ri>=1){br=Ri-1;jt=0}if(Ri==0){i=0;f=0;return 0}r=br;i=jt;f=Lo;if(!VR){Cq(lL);r=PC;i=SC;f=ui[r].page}if(!oi.WordWrap||!oi.PrintView||oi.FittedView){t=r;if(oi.FittedView&&Nj(Qh&tc.TFLAG3_TABLE_STATUS_LINE))t-=iB(0,r);SC=i;hC=f;return t+1}t=r+1-po[f].FirstLine;if(oi.PageMode){var a,n,c,s;var _;if(f<To-1)a=po[f+1].FirstLine-po[f].FirstLine;else a=Ri-po[f].FirstLine;c=s=po[f].FirstLine;if(c>=Ri){c=Ri-1;if(c<0)c=0}if(c+a>Ri)a=Ri-c;if(Nj(Nc[ui[c].pfmt].flags&tc.PAGE_HDR_FTR)){for(e=c;e<Ri&&Nj(Nc[ui[e].pfmt].flags&tc.PAGE_HDR_FTR)&&a>1;e++)a--;s=e}var o=0;for(e=s;e<s+a;e++)if(ui[e].height==0)o++;a-=o;if(yR){var u=Cz(f);_=jF;if(u<0)_.FirstLine=_.LastLine=-1;n=_.LastLine-_.FirstLine+1-2;if(n==1&&_.FirstLine>=0&&_.FirstLine+1<Ri&&ui[_.FirstLine+1].len==1&&!WR)n=0;if(n>0){for(e=_.FirstLine+1;e<_.LastLine;e++)if(ui[e].height==0)n--}if(Nj(Nc[ui[r].pfmt].flags&tc.PAGE_HDR)){t=0;for(e=r;e>=0&&Dj(ui[e].flags&tc.LFLAG_HDRS_FTRS);e--){if(ui[e].height==0)continue;t++}}else if(Nj(Nc[ui[r].pfmt].flags&tc.PAGE_FTR)){t=n+a;for(e=r;e>=0&&Dj(ui[e].flags&tc.LFLAG_HDRS_FTRS);e--){if(ui[e].height==0)continue;t++}}else t=r-s+n+1}else{t=r-s+1;if(Nj(Qh&tc.TFLAG3_TABLE_STATUS_LINE))t-=iB(po[f].FirstLine,po[f].LastLine)}}if(Dj(Nc[ui[r].pfmt].flags&tc.PAGE_HDR_FTR)){for(e=po[f].FirstLine;e<r;e++){if(Nj(Nc[ui[e].pfmt].flags&tc.PAGE_HDR_FTR))continue;if(ui[e].height==0)t--}if(t<1)t=1;e=po[f].FirstLine;l=Nj(Nc[ui[e].pfmt].flags&tc.PAGE_HDR_FTR);for(;e<r;e++){if(l&&Nj(Nc[ui[e].pfmt].flags&tc.PAGE_HDR_FTR))continue;l=false;if(Nj(Nc[ui[e].pfmt].flags&tc.PAGE_HDR_FTR))t--}}if(t<1)t=1;SC=i;hC=f;return t}function iB(t,e){var r,i=0,f=0,l=0,a=0;if(br<t)return 0;for(r=t;r<=e;r++){if(r==br){if(ui[br].cid==0)break;i+=l-f;break}if(Nj(ui[r].cid)){l++;f++}if(GY(r,tc.INFO_CELL)){if(f>a)a=f;f=0}else if(GY(r,tc.INFO_ROW)){i+=l-a;a=l=f=0}}return i}function fB(t){if(!oi.open||Ru)return;lB(t);aB(t)}function lB(t){var e,r,i,f,l,a,n,c,s,_,o,u,T,A,E;var R,L;var C;var I,d;var F,g;var P;var S;var h,O,v,p=-1;var N;var D=Dj(eO&tc.TFLAG7_DISABLE_RULER);var M;var G;if(!oi.ruler)return;if(!VR&&!$R&&Qt!=tc.WM_HSCROLL&&uA==tc.HILIGHT_OFF){ai=true;return}if(OA||ci){ai=true;return}M=TZ();Be=0;He=0;var B=(new Date).getTime();if(t&&gt==ui[M].x){if(B-Be<He){ai=true;return}}Be=B;ai=$R=false;Pt=G5(M);gt=ui[M].x;Gc=ui[M].pfmt;$M(tc.DRAG_TYPE_RULER_BEGIN,tc.DRAG_TYPE_RULER_END);s=Nt;r=G5(M);if(Ci)_=s*eo[r].PgWidth+2*bV(er);else _=s*(eo[r].PgWidth-to[r].LeftMargin-to[r].RightMargin);if(_<Ft+je)_=Ft+je;e=iW(M);if(e<0)e=0;Nl=e;T=pl[e].x+pl[e].SpaceLeft;kG();I=new tc.RECT;I.left=Ft+(k.left-rt.left);I.right=Ft+je+(k.right-rt.right);o=I.right-I.left;I.top=Gt-(rt.top-k.top);I.bottom=I.top+(k.bottom-k.top);A=Gt+k.top-rt.top;Ti.save();Ti.fillStyle=tc.Color.black.toString();F=new tc.Pen(1,tc.Color.black);g=new tc.Pen(tc.Color.white);FJ(Ti,W);if(MJ(jT,tc.CLR_WHITE))P=new tc.Brush(tc.Color.white);else P=new tc.Brush(jT);var H=new tc.Rectangle(I.left,0,I.right+2-I.left,I.bottom+1-I.top);oJ(Ti,P,new tc.Rectangle(I.left,I.top,I.right+2-I.left,I.bottom+1-I.top));if(!MJ(jT,tc.CLR_WHITE))P.Dispose();P=nA!=null?nA:new tc.Brush(tc.Color.lightGray);v=Hr/2;d=I.copy();d.bottom=d.top+v;oJ(Ti,P,new tc.Rectangle(d.left,d.top,d.right+2-d.left,d.bottom+1-d.top));d=I.copy();d.top=d.bottom-v;oJ(Ti,P,new tc.Rectangle(d.left,d.top,d.right+2-d.left,d.bottom+1-d.top));P=new tc.Brush(tc.Color.gray);d=I.copy();d.top+=v;d.bottom-=v;d.right=T;oJ(Ti,P,new tc.Rectangle(d.left,d.top,d.right+2-d.left,d.bottom+1-d.top));d.right=I.right;d.left=T+M9(M,-1);oJ(Ti,P,new tc.Rectangle(d.left,d.top,d.right+2-d.left,d.bottom+1-d.top));hH(Ti,I.left,I.top,I.right,I.top,F,null);ii=Nj(ui[M].flags2&tc.LFLAG2_PARA_RTL);vf=null;a=I.top+Hr;if(D&&$A&&(h=qM())>=0){p=h;XE[h].InUse=true}R=T-JV(3);L=s;if(Nj(zh&tc.TFLAG_METRIC))L=L*10/ij(1);n=I.top+v;c=0;while(R<=_){E=HY(R*10,10)/10;C=mY(c);O=E;if(ii)O=E$(O-JV(5),0,e,new tc.ClsLineSeg);if(R>T)sJ(Ti,C,W,new tc.Brush(tc.Color.black),new tc.Point(O,n));R+=L;c++}L=s/2;if(Nj(zh&tc.TFLAG_METRIC))L=L*10/ij(1);R=T+L;n=a-Hr/3;c=0;while(R<_){c++;if(c%2!=0){E=HY(R*10,10)/10;hH(Ti,E,n+JV(2),E,n+JV(6),F,g)}R+=L}L=s/8;if(Nj(zh&tc.TFLAG_METRIC))L=L*20/ij(1);R=T+L;n=a-Hr/3;c=0;while(R<_){c++;if(c%4!=0){E=HY(R*10,10)/10;hH(Ti,E,n+JV(3),E,n+JV(5),F,g)}R+=L}if(Y_)u=W_[k_].TabId;else u=Nc[Gc].TabId;S=B_[u];for(i=0;i<S.count;i++){var m=v-1;f=S.pos[i];f=dV(f);f+=T;n=I.bottom-v;hH(Ti,f,a-JV(1),f,n,F,F);if(D&&(k_<0||Y_)&&(h=qM())>=0){var w=ii?E$(f,0,e,new tc.ClsLineSeg):f;XE[h].InUse=true;XE[h].type=tc.DRAG_TYPE_RULER_TAB;XE[h].id1=i;XE[h].HotRectCount=1;XE[h].HotRect[0].left=w-dV(tc.RULER_TOLERANCE);XE[h].HotRect[0].top=a;XE[h].HotRect[0].right=w+dV(tc.RULER_TOLERANCE);XE[h].HotRect[0].bottom=a+Hr+1;XE[h].ObjPointCount=2;XE[h].ObjPoint[0].x=w;XE[h].ObjPoint[0].y=a;XE[h].ObjPoint[1].x=w;XE[h].ObjPoint[1].y=a+Hr}f++;if(S.type[i]==tc.TAB_LEFT)hH(Ti,f-1,n,f+m+1,n,F,F);else if(S.type[i]==tc.TAB_RIGHT)hH(Ti,f-m-JV(1),n,f,n,F,F);else hH(Ti,f-m,n,f+m,n,F,F);if(S.type[i]==tc.TAB_DECIMAL){n=(a+n)/2+JV(1);hH(Ti,f+m/2,n-JV(1),f+m/2+JV(1),n-JV(1),F,F)}}if(S.count==0)f=0;else f=S.pos[S.count-1];if(m_>0){while(true){l=dV(f);l+=T;if(l>=_)break;n=I.bottom-v;hH(Ti,l,n+JV(2),l,n+JV(5),g,null);f+=m_;if(f<0)break}}if(!oi.BorderMargin&&(!FS||oi.FittedView)){G=[3];for(j=0;j<3;j++)G[j]=new tc.Point;if(Y_)G[0].x=dV(W_[k_].LeftIndentTwips);else G[0].x=Nc[Gc].LeftIndent;G[0].x+=T;G[0].y=a;G[1].x=G[0].x;G[1].y=a+Hr;G[2].x=G[0].x+Hr/2;G[2].y=a+Hr/2;if(ii)for(i=0;i<3;i++)G[i].x=E$(G[i].x,0,e,new tc.ClsLineSeg);EJ(Ti,new tc.Brush(tc.Color.lightGray),G);RJ(Ti,new tc.Pen(1,tc.Color.black),G);if(D&&(k_<0||Y_)&&(h=qM())>=0){XE[h].InUse=true;XE[h].type=tc.DRAG_TYPE_RULER_LEFT;XE[h].id1=Gc;XE[h].HotRectCount=1;XE[h].HotRect[0].left=G[0].x;XE[h].HotRect[0].top=G[0].y;XE[h].HotRect[0].right=G[2].x;if(ii){XE[h].HotRect[0].left=WY(XE[h].HotRect[0].left,XE[h].HotRect[0].right);XE[h].HotRect[0].right=JC}XE[h].HotRect[0].bottom=G[1].y;XE[h].ObjPointCount=3;for(i=0;i<3;i++)XE[h].ObjPoint[i]=new tc.Point(G[i])}if(Y_)G[0].x=dV(W_[k_].LeftIndentTwips+W_[k_].FirstIndentTwips);else G[0].x=Nc[Gc].LeftIndent+Nc[Gc].FirstIndent;G[0].x+=T;G[0].y=a-Hr;G[1].x=G[0].x;G[1].y=a;G[2].x=G[0].x+Hr/2;G[2].y=a-Hr/2;if(ii)for(i=0;i<3;i++)G[i].x=E$(G[i].x,0,e,new tc.ClsLineSeg);EJ(Ti,new tc.Brush(tc.Color.lightGray),G);RJ(Ti,new tc.Pen(1,tc.Color.black),G);if(D&&(k_<0||Y_)&&(h=qM())>=0){XE[h].InUse=true;XE[h].type=tc.DRAG_TYPE_RULER_FIRST;XE[h].id1=Gc;XE[h].HotRectCount=1;XE[h].HotRect[0].left=G[0].x;XE[h].HotRect[0].top=G[0].y;XE[h].HotRect[0].right=G[2].x;if(ii){XE[h].HotRect[0].left=WY(XE[h].HotRect[0].left,XE[h].HotRect[0].right);XE[h].HotRect[0].right=JC}XE[h].HotRect[0].bottom=G[1].y;XE[h].ObjPointCount=3;for(i=0;i<3;i++)XE[h].ObjPoint[i]=new tc.Point(G[i])}if(Y_)G[0].x=M9(M,-1)-dV(W_[k_].RightIndentTwips);else G[0].x=M9(M,-1)-Nc[Gc].RightIndent;G[0].x+=T;G[0].y=a;G[1].x=G[0].x;G[1].y=a+Hr;G[2].x=G[0].x-Hr/2;G[2].y=a+Hr/2;if(ii)for(i=0;i<3;i++)G[i].x=E$(G[i].x,0,e,new tc.ClsLineSeg);EJ(Ti,new tc.Brush(tc.Color.lightGray),G);RJ(Ti,new tc.Pen(1,tc.Color.black),G);if(D&&(k_<0||Y_)&&(h=qM())>=0){XE[h].InUse=true;XE[h].type=tc.DRAG_TYPE_RULER_RIGHT;XE[h].id1=Gc;XE[h].HotRectCount=1;XE[h].HotRect[0].left=G[2].x;XE[h].HotRect[0].top=G[0].y;XE[h].HotRect[0].right=G[0].x;if(ii){XE[h].HotRect[0].left=WY(XE[h].HotRect[0].left,XE[h].HotRect[0].right);XE[h].HotRect[0].right=JC}XE[h].HotRect[0].bottom=G[1].y;XE[h].ObjPointCount=3;for(i=0;i<3;i++)XE[h].ObjPoint[i]=new tc.Point(G[i])}}else{G=[5];for(i=0;i<5;i++)G[i]=new tc.Point;var b=v/2+JV(1);if(Y_)G[0].x=dV(W_[k_].LeftIndentTwips);else G[0].x=Nc[Gc].LeftIndent;G[0].x+=T;G[0].y=a;G[1].x=G[0].x-b;G[1].y=G[0].y+b;G[2].x=G[1].x;G[2].y=I.bottom-v;G[3].x=G[0].x+b;G[3].y=G[2].y;G[4].x=G[3].x;G[4].y=G[1].y;if(ii)for(i=0;i<5;i++)G[i].x=E$(G[i].x,0,e,new tc.ClsLineSeg);EJ(Ti,new tc.Brush(tc.Color.lightGray),G);RJ(Ti,new tc.Pen(1,tc.Color.black),G);if(D&&(k_<0||Y_)&&(h=qM())>=0){XE[h].InUse=true;XE[h].type=tc.DRAG_TYPE_RULER_LEFT;XE[h].id1=Gc;XE[h].HotRectCount=1;XE[h].HotRect[0].left=G[0].x-b;XE[h].HotRect[0].top=G[0].y;XE[h].HotRect[0].right=G[0].x+b;XE[h].HotRect[0].bottom=G[2].y;XE[h].ObjPointCount=5;for(i=0;i<5;i++)XE[h].ObjPoint[i]=new tc.Point(G[i])}if(Y_)G[0].x=dV(W_[k_].LeftIndentTwips+W_[k_].FirstIndentTwips);else G[0].x=Nc[Gc].LeftIndent+Nc[Gc].FirstIndent;G[0].x+=T;G[0].y=a;G[1].x=G[0].x-b;G[1].y=G[0].y-b;G[2].x=G[1].x;G[2].y=I.top+v;G[3].x=G[0].x+b;G[3].y=G[2].y;G[4].x=G[3].x;G[4].y=G[1].y;if(ii)for(i=0;i<5;i++)G[i].x=E$(G[i].x,0,e,new tc.ClsLineSeg);EJ(Ti,new tc.Brush(tc.Color.lightGray),G);RJ(Ti,new tc.Pen(1,tc.Color.black),G);if(D&&(k_<0||Y_)&&(h=qM())>=0){XE[h].InUse=true;XE[h].type=tc.DRAG_TYPE_RULER_FIRST;XE[h].id1=Gc;XE[h].HotRectCount=1;XE[h].HotRect[0].left=G[0].x-b;XE[h].HotRect[0].top=G[2].y;XE[h].HotRect[0].right=G[0].x+b;XE[h].HotRect[0].bottom=G[0].y;XE[h].ObjPointCount=5;for(i=0;i<5;i++)XE[h].ObjPoint[i]=new tc.Point(G[i])}if(Y_)G[0].x=M9(M,-1)-dV(W_[k_].RightIndentTwips);else G[0].x=M9(M,-1)-Nc[Gc].RightIndent;G[0].x+=T;G[0].y=a;G[1].x=G[0].x-b;G[1].y=G[0].y+b;G[2].x=G[1].x;G[2].y=I.bottom-v;G[3].x=G[0].x+b;G[3].y=G[2].y;G[4].x=G[3].x;G[4].y=G[1].y;if(ii)for(i=0;i<5;i++)G[i].x=E$(G[i].x,0,e,new tc.ClsLineSeg);EJ(Ti,new tc.Brush(tc.Color.lightGray),G);RJ(Ti,new tc.Pen(1,tc.Color.black),G);if(D&&(k_<0||Y_)&&(h=qM())>=0){XE[h].InUse=true;XE[h].type=tc.DRAG_TYPE_RULER_RIGHT;XE[h].id1=Gc;XE[h].HotRectCount=1;XE[h].HotRect[0].left=G[0].x-b;XE[h].HotRect[0].top=G[0].y;XE[h].HotRect[0].right=G[0].x+b;XE[h].HotRect[0].bottom=G[2].y;XE[h].ObjPointCount=5;for(i=0;i<5;i++)XE[h].ObjPoint[i]=new tc.Point(G[i])}}if($A){var x=null;var y;P=nA!=null?nA:new tc.Brush(tc.Color.lightGray);d=I.copy();d.top=d.top+1;d.left=Ft-(rt.left-X.left);d.right=d.left+(X.right-X.left);oJ(Ti,P,new tc.Rectangle(d.left,d.top,d.right-d.left,d.bottom+1-d.top));d.left+=v-1;d.right-=v-1;d.top+=v-1;d.bottom-=v-1;hH(Ti,d.left,d.top,d.right,d.top,F,g);hH(Ti,d.left,d.bottom,d.right,d.bottom,F,g);hH(Ti,d.left,d.top,d.left,d.bottom,F,g);hH(Ti,d.right,d.top,d.right,d.bottom,F,g);x=new tc.Pen(tc.Color.black,2);if(w_==tc.TAB_LEFT){R=d.left+JV(5);y=d.top+v+JV(2);hH(Ti,R,y,R+JV(5),y,x,null);hH(Ti,R,y,R,y-JV(5),x,null)}else if(w_==tc.TAB_RIGHT){R=d.left+JV(8);y=d.top+v+JV(2);hH(Ti,R,y,R-JV(5),y,x,null);hH(Ti,R,y,R,y-JV(5),x,null)}else if(w_==tc.TAB_CENTER){R=d.left+JV(6);y=d.top+v+JV(2);hH(Ti,R-JV(3),y,R+JV(4),y,x,null);hH(Ti,R,y,R,y-JV(5),x,null)}else if(w_==tc.TAB_DECIMAL){R=d.left+JV(6);y=d.top+v+JV(2);hH(Ti,R-JV(3),y,R+JV(4),y,x,null);hH(Ti,R,y,R,y-JV(5),x,null);hH(Ti,R+JV(2),y-JV(3),R+JV(4),y-JV(4),x,null)}if((h=p)>=0){XE[h].InUse=true;XE[h].type=tc.DRAG_TYPE_TAB_TYPE;XE[h].HotRectCount=1;XE[h].HotRect[0].left=d.left;XE[h].HotRect[0].top=d.top;XE[h].HotRect[0].right=d.right;XE[h].HotRect[0].bottom=d.bottom}}Ti.restore();ii=false}function aB(t){var e,r,i,f,l,a,n,c;var s=new tc.RECT,_=new tc.RECT;var o,u;var T,A;var E;var R;if(!$A)return;if(OA||ci){ai=true;return}r=wt;i=X.bottom-X.top;if(i<=0)return;s.left=Ft-rt.left;s.right=s.left+(X.right-X.left);s.top=Gt-(rt.top-X.top);s.bottom=s.top+i;c=s.left;Ti.save();Ti.beginPath();Ti.rect(s.left,s.top,s.right-s.left,s.bottom-s.top);Ti.closePath();Ti.clip();Ti.fillStyle=tc.Color.black.toString();o=new tc.Pen(1,tc.Color.black);u=new tc.Pen(1,tc.Color.white);if(MJ(jT,tc.CLR_WHITE))T=new tc.Brush(tc.Color.white);else T=new tc.Brush(jT);oJ(Ti,T,new tc.Rectangle(s.left,s.top,s.right+JV(2)-s.left,s.bottom+JV(1)-s.top));if(!MJ(jT,tc.CLR_WHITE))T.Dispose();if(oi.WordWrap&&oi.PageMode&&!oi.FittedView){l=Lo==qe?0:pl[Qe].y;if(Ci)l+=yV(rr);e=po[Lo].TopSect;n=eo[e].PgHeight*r;if(yR||Ci){f=l+to[e].TopMargin*r;a=n-r*(to[e].TopMargin+to[e].BotMargin)}else{n=n-r*(to[e].TopMargin+to[e].BotMargin);f=l;a=n}}else{f=l=Gt;a=n=Mt}E=Hr/2;A=nA!=null?nA:new tc.Brush(tc.Color.lightGray);if(l>s.top){_=s.copy();if(l<_.bottom)_.bottom=l;oJ(Ti,A,new tc.Rectangle(_.left,_.top,_.right-_.left+JV(2),_.bottom-_.top+JV(1)))}if(l+n<s.bottom){_=s.copy();if(l+n>_.top)_.top=l+n;oJ(Ti,A,new tc.Rectangle(_.left,_.top,_.right-_.left+JV(2),_.bottom-_.top+JV(1)))}if(f>l){_=s.copy();_.top=l;_.bottom=f;oJ(Ti,new tc.Brush(tc.Color.gray),new tc.Rectangle(_.left,_.top,_.right-_.left+JV(2),_.bottom-_.top+JV(1)))}if(f>l){_=s.copy();_.top=f+a;_.bottom=l+n;oJ(Ti,new tc.Brush(tc.Color.gray),new tc.Rectangle(_.left,_.top,_.right-_.left+JV(2),_.bottom-_.top+JV(1)))}_=s.copy();_.top=l;_.bottom=_.top+n;_.right=_.left+E;oJ(Ti,A,new tc.Rectangle(_.left,_.top,_.right-_.left+JV(2),_.bottom-_.top+JV(1)));_.right=s.right;_.left=_.right-E-JV(1);oJ(Ti,A,new tc.Rectangle(_.left,_.top,_.right-_.left+JV(2),_.bottom-_.top+JV(1)));nB(Ti,s.left+E,f,l+n,W,o,u);nB(Ti,s.left+E,f,l,P,o,u);Ti.restore();ni=false;pt=Lo}function nB(t,e,r,i,f,l,a){var n;var c,s;var _=wt,o,u;var T;var A=false;var E=0,R=-1,L=1,C=0,I,d;var F;t.save();if(i<r){var g=r-i;A=true;i=r+g}c=r;s=_;if(Nj(zh&tc.TFLAG_METRIC))s=s*10/ij(1);n=0;while(c<=i){u=HY(c*10,10)/10;T=mY(n);if(A){F=u-r;o=r-F}else o=u;if(c>r){t.save();I=e;d=o;t.transform(E,R,L,C,I,d);sJ(t,T,f,new tc.Brush(tc.Color.black),new tc.Point(0,0));t.restore()}c+=s;n++}t.restore();s=_/2;if(Nj(zh&tc.TFLAG_METRIC))s=s*10/ij(1);c=r+s;n=0;while(c<i){n++;if(n%2!=0){u=HY(c*10,10)/10;if(A){F=u-r;o=r-F}else o=u;hH(t,e+JV(5),o,e+JV(9),o,l,a)}c+=s}s=_/8;if(Nj(zh&tc.TFLAG_METRIC))s=s*20/ij(1);c=r+s;n=0;while(c<i){n++;if(n%4!=0){u=HY(c*10,10)/10;if(A){F=u-r;o=r-F}else o=u;hH(t,e+JV(6),o,e+JV(7),o,l,a)}c+=s}}function cB(t,e,r,i,f,l){var a,n;var c=Nf;if(ii&&Nj(vf))n=pf;else n=1;for(a=0;a<n;a++){var s,_,o,u;if(ii&&Nj(vf)&&n>1){if(r>=vf[a].col+vf[a].count)continue;if(i<=vf[a].col)continue;if(r<=vf[a].col)s=vf[a].col;else s=r;if(i>=vf[a].col+vf[a].count)_=vf[a].col+vf[a].count;else _=i;_--}else{s=r;_=i-1}o=Fq(s,e,tc.TER_LEFT);u=Fq(_,e,tc.TER_RIGHT);if(ii&&Nj(vf))Nf=a;sB(t,o,f,u-o,l,e)}Nf=c;return true}function sB(t,e,r,i,f,l){var a=new tc.RECT;var n,c,s,_;var o,u=BA;BA++;if(BA>HA){var T=HA;HA+=10;mA=fV(mA,HA);for(o=T;o<HA;o++)mA[o]=new tc.ClsHlSeg}if(ii&&Nj(vf)&&Nf<pf){s=E$(e,0,Nl,vf[Nf]);_=E$(e+i,0,Nl,vf[Nf]);if(_<s){s=WY(s,_);_=JC}e=s;i=_-s}if(Ie==0){mA[u].x=Math.round(e);mA[u].y=Math.round(r);mA[u].width=Math.round(i);mA[u].height=Math.round(f);mA[u].LineNo=l;mA[u].ScrFrameAngle=Ie;if(u>0&&mA[u].LineNo==mA[u-1].LineNo+1&&mA[u].ScrFrameAngle==0&&mA[u-1].ScrFrameAngle==0){if(Math.abs(mA[u].y-(mA[u-1].y+mA[u-1].height))<=2)mA[u].y=mA[u-1].y+mA[u-1].height}return true}a=VY(e,r,e+i,r+f);a=S$(a,Nl);n=a.left<a.right?a.left:a.right;c=a.top<a.bottom?a.top:a.bottom;mA[u].x=n;mA[u].y=c;mA[u].width=f;mA[u].height=i;mA[u].LineNo=l;mA[u].ScrFrameAngle=Ie;return true}function _B(t,e,r){var i=oB(t,e,r);return i.cx}function oB(t,e,r){var i=Uk(r);if(Oy(V,i))return SJ(t,e,r);else{e=hy(e,r);return SJ(t,e,r)}}function uB(t,e,r,i,f,l,a,n){var c=false,s=false,_=false,o;var u=false,T=false,A=false,E=false;var R,L,C=0,I=0;var d;var F=0,g;var P;if(Oy(V,l))return iJ(t,e,r,i,f,l,a,n);else{var S=hy(V,Wk(l));if(!S.equals(V)){P=V;V=hy(V,Wk(l,0,a));FJ(t,V);iJ(t,e,r,i,null,l,a,n);V=P;FJ(t,V);return 1}}for(R=0;R<=a;R++){g=F;F=R<a?l[R]:0;c=s=_=o=false;if(F>255){if(h9(F,0))c=true;else if(P9(F))o=true;else if(kq(F))_=true;else if(Yq(F))s=true}if(R==0){u=c;E=o;T=s;A=_}var h=false;if(c!=u)h=true;else if(o!=E)h=true;else if(_!=A)h=true;else if(s!=T)h=true;if(R==a||h){var O=R-C;if(O==0)break;var v=[O];for(L=0;L<O;L++)v[L]=l[C+L];I=0;if(n==null)d=null;else{d=[O];for(L=0;L<O;L++){d[L]=n[C+L];I+=d[L]}}P=V;V=hy(V,Wk(v));FJ(t,V);iJ(t,e,r,i,f,v,O,d);if(n==null){I=gJ(t,V,Wk(v))}V=P;FJ(t,V);u=c;E=o;T=s;A=_;C=R;e+=I}}return 1}function TB(t,e,r,i,f,l,a,n,c){if(c==undefined)return AB(t,e,r,i,f,l,a,n);else return EB(t,e,r,i,f,l,a,n,c)}function AB(t,e,r,i,f,l,a,n){return EB(t,e,r,i,f,null,l,a,n)}function EB(t,e,r,i,f,l,a,n,c){var s,_,o,u;var T;var A=ii&&Nj(vf)&&Nf<pf;var E=[2];var R=[];var L=[];var C=[];var I=r>=877&&r<=883;if(!_l&&!Eu)return 1;if(f.right<=f.left||f.bottom<=f.top){if(n==0)return 0;for(u=0;u<n;u++)if(v9(l==null?a[u]:l[u]))break;if(u==n)return 0}T=new tc.RECT;T.left=f.left;T.right=f.right;T.top=f.top;T.bottom=f.bottom;if(l!=null)a=null;E[0]=0;if(A&&!vf[Nf].IsDate){e=E$(e,T.right-T.left,Nl,vf[Nf]);T=R$(T,Nl,vf[Nf]);E[0]=vf[Nf].MirrorChar}var d=true;for(u=0;u<n;u++){var F=false;if(a!=null)F=a[u]>=64336&&a[u]<=65023||a[u]>=65136&&a[u]<=65279;else F=l[u]>=64336&&l[u]<=65023||l[u]>=65136&&l[u]<=65279;if(!F){if(a!=null){if(a[u]!=tc.SPACE&&a[u]!=",")d=false}else{if(l[u]!=tc.SPACE&&l[u]!=",")d=false}}}if(tg.OSCanRotate||Ie==0){var g=A?vf[Nf].rtl:false;var P=A?vf[Nf].rtlch:false;if(n==1&&A&&(!g||P)){if(E[0]==0&&P){if(l==null){if(a[0]==gk("<"))E[0]=gk(">");else if(a[0]==gk(">"))E[0]=gk("<");else if(a[0]==gk("("))E[0]=gk(")");else if(a[0]==gk(")"))E[0]=gk("(");else if(a[0]==gk("{"))E[0]=gk("}");else if(a[0]==gk("}"))E[0]=gk("{");else if(a[0]==gk("["))E[0]=gk("]");else if(a[0]==gk("]"))E[0]=gk("[")}else{if(l[0]==gk("<"))E[0]=gk(">");else if(l[0]==gk(">"))E[0]=gk("<");else if(l[0]==gk("("))E[0]=gk(")");else if(l[0]==gk(")"))E[0]=gk("(");else if(l[0]==gk("{"))E[0]=gk("}");else if(l[0]==gk("}"))E[0]=gk("{");else if(l[0]==gk("["))E[0]=gk("]");else if(l[0]==gk("]"))E[0]=gk("[")}}if(E[0]!=0){E[1]=0;if(a==null)a=[];a[0]=E[0];l=null}}if(g){var S,h,O=0;var v=[n+1];if(n>0){for(u=0;u<n;u++){v[u]=c[n-u-1];O+=v[u]}var p;var N=2;if(a!=null)p=SJ(t,xs[hc].font,a.toString());else p=SJ(t,xs[hc].font,Wk(l,0,l.length));if(Eu)N=wV(N);h=0;if(p.cx>O+N)h=-((p.cx-O)/n+1);else if(p.cx<O-N)h=(O-p.cx)/n;if(d){R=[n];L=[n];C=[n];for(u=0;u<n;u++){if(a!=null)R[n-1-u]=a[u];else L[n-1-u]=l[u];C[n-1-u]=c[u]}if(a!=null)return iJ(t,e,r,i|tc.ETO_RTLREADING,T,R,n,C);else return iJ(t,e,r,i|tc.ETO_RTLREADING,T,L,a,n,C,0)}else if(true||h==0){if(a!=null)return iJ(t,e,r,i|tc.ETO_RTLREADING,T,a,n,c);else return iJ(t,e,r,i|tc.ETO_RTLREADING,T,l,a,n,c,0)}else if(Nj(xs[hc].expand)||Eu){if(a!=null)o=iJ(t,e,r,i|tc.ETO_RTLREADING,T,a,n,h);else o=iJ(t,e,r,i|tc.ETO_RTLREADING,T,l,a,n,null,h);return o}else{t.save();t.scale(p.cx/(T.right-T.left),1);V=xs[hc].font;FJ(t,xs[hc].font);if(a!=null)o=iJ(t,0,r-T.top,i|tc.ETO_RTLREADING,TempRect,a,n,null);else o=iJ(t,0,r-T.top,i|tc.ETO_RTLREADING,TempRect,l,a,n,null,0);t.restore();return o}}if(a!=null)return iJ(t,e,r,i|tc.ETO_RTLREADING,T,a,n,null);else return iJ(t,e,r,i|tc.ETO_RTLREADING,T,l,a,n,null,0)}else{if(A&&vf[Nf].rtl)i|=tc.ETO_RTLREADING;if(a!=null)return iJ(t,e,r,i,T,a,n,c);else return iJ(t,e,r,i,T,l,a,n,c,0)}}s=g$(e,r,Nl);_=P$(e,r,Nl);T=S$(T,Nl);if(A&&vf[Nf].rtl)i|=tc.ETO_RTLREADING;if(d){R=[n];L=[n];C=[n];for(u=0;u<n;u++){if(a!=null)R[n-1-u]=a[u];else L[n-1-u]=l[u];C[n-1-u]=c[u]}if(a!=null)return iJ(t,s,_,i,T,R,n,C);else return iJ(t,s,_,i,T,L,a,n,C,0)}else{if(a!=null)return iJ(t,s,_,i,T,a,n,c);else return iJ(t,s,_,i,T,l,a,n,c,0)}}function RB(t){var e,r;if(!_l)return true;if(Nj(t&tc.SPILL_TOP)&&Dj(t&tc.SPILL_NO_RULER)&&oi.ruler){$R=true;fB(false)}if(Nj(t&tc.SPILL_LEFT)&&Dj(t&tc.SPILL_NO_RULER)&&$A){aB(false)}if(Nj(t&tc.SPILL_BOT)&&Dj(t&tc.SPILL_NO_RULER)&&oi.ShowStatus)tB();if(oi.BorderMargin){var i=new tc.RECT;var f=fA;fA=jT;if(Nj(t&tc.SPILL_LEFT)){i.left=Ft-dV(tc.BORDER_MARGIN);i.right=Ft;i.top=Gt-dV(tc.BORDER_MARGIN);i.bottom=i.top+Mt;iJ(Ti,i.left,i.top,tc.ETO_OPAQUE,i,null,0,null)}if(Nj(t&tc.SPILL_RIGHT)){i.left=Ft+je;i.right=i.left+dV(tc.BORDER_MARGIN)+1;i.top=Gt-dV(tc.BORDER_MARGIN);i.bottom=i.top+Mt;iJ(Ti,i.left,i.top,tc.ETO_OPAQUE,i,null,0,null)}if(Nj(t&tc.SPILL_TOP)){i.left=Ft-dV(tc.BORDER_MARGIN);i.right=i.left+K.right;i.top=Gt-hV(tc.BORDER_MARGIN);i.bottom=Gt;iJ(Ti,i.left,i.top,tc.ETO_OPAQUE,i,null,0,null)}if(Nj(t&tc.SPILL_BOT)){i.left=Ft-dV(tc.BORDER_MARGIN);i.right=i.left+K.right;i.top=Gt+Mt;i.bottom=i.top+hV(tc.BORDER_MARGIN);iJ(Ti,i.left,i.top,tc.ETO_OPAQUE,i,null,0,null)}fA=f}if(false&&UO&&ve>0){var l=Ti.getColor();Ti.setPaint(tc.Color.black);Ti.drawRect(Ft-rt.left,Gt-rt.top,getWidth()-1,getHeight()-1);Ti.setPaint(l);if(HO!=null)HO.repaint()}return true}function LB(t,e,r,i,f,l){var a;var n;var c;var s=ii;if(nh<=50)V=xs[0].font;else V=W;FJ(t,W);n=SJ(t,W,e);if(n.cx>=f*3/4)n.cx=0;if(ii)r=E$(r,f,Nl,new tc.ClsLineSeg);a=(f-n.cx)/2;if(a<0)a=0;c=t.fillStyle;t.fillStyle=tc.Color.black.toString();if(n.cx>0)sJ(t,e,W,new tc.Brush(tc.Color.black),new tc.Point(r+a,i-n.cy/2));t.fillstyle=c;ii=false;if(Nj(l)){hH(t,r,i,r+a,i,l,null);hH(t,r+a+n.cx,i,r+f,i,l,null)}else{RH(t,r,i,r+a,i,tc.Color.black);RH(t,r+a+n.cx,i,r+f,i,tc.Color.black)}ii=s;return true}function CB(t,e,r,i,f,l,a){var n;var c,s,_=0,o,u,T,A=tc.OPAQUE;var E,R,L;var C=0;var I;var d=Nc[r].StyId;var F,g="HEADING";var P,S;var h;var O=false,v=false;var p=-1;var N;var D;ZU("DrawBullet");ns="";zI=0;if(vm(e)||GY(e,tc.INFO_ROW))return true;if(Nc[r].LeftIndentTwips==0&&Nc[r].FirstIndentTwips<0)return true;F=W_[d].name;F.toUpperCase();P=F.indexOf(g)==0;s=Nc[r].BltId;if((S=HX())&&Nj(ui[e].flags2&tc.LFLAG2_PARA_RTL))h=tc.ETO_RTLREADING;else h=0;if(false&&Li)C=ib(e,0);else{for(E=e;E<Ri-1;E++)if(Nj(ui[E].flags&tc.LFLAG_PARA))break;if(ui[E].len==0)C=0;else{C=p=ib(E,ui[E].len-1);if(Nj(xs[C].style&(tc.ULINE|tc.ULINED))){var M=xs[C].style;M=cj(M,tc.ULINE|tc.ULINED);C=Rb(t,C,xs[C].TypeFace,xs[C].TwipsSize,M,xs[C].TextColor,tc.CLR_WHITE,xs[C].UlineColor,0,0,0,1,Nc[r].StyId,0,0,0,null,0,ks,0,xs[C].TextAngle)}}}if(xc[s].ls>0){if(Nj(ui[e].flags&tc.LFLAG_LIST)){if((N=sQ(xc[s].ls,xc[s].lvl))!=null){O=Nj(N.flags&tc.LISTLEVEL_RIGHT);v=Nj(N.flags&tc.LISTLEVEL_CENTER);if((O||v)&&N.CharAft!=tc.LISTAFT_TAB)O=v=false;if((O||v)&&N.txt!=null&&N.txt.length>0){for(c=0;c<N.txt[0];c++){var G=N.txt[c+1];if(G>=9)continue;if(false&&G!=xc[s].lvl){O=v=false;break}}}}}else return true}if(xc[s].IsBullet){if((N=sQ(xc[s].ls,xc[s].lvl))!=null){C=N.FontId;if(MJ(xs[C].TextColor,tc.CLR_AUTO)&&p>=0&&!MJ(xs[p].TextColor,tc.CLR_AUTO)){C=fx(C,pJ(xs[p].TextColor),0,"",e,0)}}else{if(xc[s].font==tc.BFONT_SYMBOL){if(n_.length>0)I=n_;else I="Symbol"}else if(xc[s].font==tc.BFONT_WINGDINGS){if(c_.length>0)I=c_;else I="Wingdings"}else I=xs[0].TypeFace;T=xs[C].TwipsSize;if(xc[s].BulletChar==168){if(Eu)T=T*4/5;else T=T*3/4}C=Rb(t,C,I,T,0,xs[C].TextColor,tc.CLR_WHITE,xs[C].UlineColor,0,0,0,1,Nc[r].StyId,0,0,0,null,0,ks,0,xs[C].TextAngle)}}else if(Nj(ui[e].flags&tc.LFLAG_LIST)){if(Nj(ui[e].tabw))C=ui[e].tabw.ListFontId}else{if(Li&&Nj(xs[C].style)||xs[C].FieldId>0)C=Rb(t,C,xs[C].TypeFace,xs[C].TwipsSize,0,xs[C].TextColor,tc.CLR_WHITE,xs[C].UlineColor,0,0,0,1,Nc[r].StyId,0,0,0,null,0,ks,0,xs[C].TextAngle);if(S&&!xs[C].rtl)C=Zb(C,null)}XG(t,C,tc.CHAR_T);if(xs[C].BaseHeight>0){if(Eu)f=f+l-Xs[C].BaseHeight+Xs[C].BaseHeightAdj;else f=f+l-xs[C].BaseHeight+xs[C].BaseHeightAdj}if(xc[s].IsBullet){var B=Py(C,xc[s].BulletChar);C=vy(C,B);XG(t,C,tc.CHAR_T);var H=[B];n=Wk(H,0,1)}else if(Nj(ui[e].flags&tc.LFLAG_LIST)){n="";if(Nj(ui[e].tabw)&&Nj(ui[e].tabw.ListText))n=ui[e].tabw.ListText}else{R=0;L=e;for(E=e-1;E>=0;E--){u=Nc[ui[E].pfmt].BltId;if(GY(E,tc.INFO_ROW))continue;if(Li){if(true||pK(ui[E].pfmt)){var m=xc[u].level;var w=ui[E+1].pfmt;if(Nc[w].SpaceBefore>0&&Nj(ui[E+1].flags&tc.LFLAG_PARA_FIRST))break;if(m<xc[s].level)break;if(!xc[u].IsBullet&&xc[u].start!=xc[s].start)break;if(u==0)continue;if(xc[u].level>xc[s].level)continue;if(GY(E,tc.INFO_CELL))break;if(xc[s].IsBullet)break;if(Nj(ui[E].flags&tc.LFLAG_PARA_FIRST))R++}else break}else{if(Nj(u)){if(Nj(xc[u].flags&tc.BLTFLAG_HIDDEN))continue;if(xc[u].IsBullet)continue;if(xc[u].start!=xc[s].start)continue;if(Nj(ui[E].flags&tc.LFLAG_BREAK))continue;if(xc[u].level<xc[s].level)break;if(xc[u].level==xc[s].level){if(xc[u].AftChar!=xc[s].AftChar)break;if(Tk(xc[u].BefText,xc[s].BefText)!=0)break;if(xc[u].NumberType!=xc[s].NumberType)break;if(Nj(ui[E].flags&tc.LFLAG_PARA_FIRST))R++;L=E}}else break}}E++;u=Nc[ui[L].pfmt].BltId;R+=xc[u].start;n="";if(xc[s].NumberType==tc.NBR_UPR_ALPHA)n=KX(R,true);else if(xc[s].NumberType==tc.NBR_LWR_ALPHA)n=KX(R,false);else if(xc[s].NumberType==tc.NBR_UPR_ROMAN)n=YX(R,true);else if(xc[s].NumberType==tc.NBR_LWR_ROMAN)n=YX(R,false);else if(xc[s].NumberType==tc.NBR_DEC)n=mY(R);else if(xc[s].NumberType==tc.NBR_DEFAULT&&!P)n=String.fromCharCode(tc.CHAR_A+R-1);O=xc[s].NumberType==tc.NBR_UPR_ROMAN||xc[s].NumberType==tc.NBR_LWR_ROMAN;if(!Li){if(xc[u].BefText.length>0){var b;b=n;n=xc[u].BefText;n+=b}if(Nj(xc[u].AftChar)){n+=String.fromCharCode(xc[u].AftChar)}}if(Li||xc[u].BefText.length==0&&xc[u].AftChar==0){n+="."}}if(GY(e,tc.INFO_PAGE|tc.INFO_COL)&&ui[e].len==1)n="";o=n.length;var x=Uk(n);for(c=0;c<o;c++)_+=Gx(C,true,x[c]);if(Dj(xc[s].flags&tc.BLTFLAG_HIDDEN)){var y=Eu?DV(Nc[r].FirstIndentTwips):dV(Nc[r].FirstIndentTwips);if(!a){ns=n;Ls=C;zI=_;zI=gV(zI);return true}f+=ce;if(O||v){var W;D=oB(t,V,n);if(Eu)W=MV(D.cx);else W=gV(D.cx);if(false&&Nc[r].LeftIndentTwips+Nc[r].FirstIndentTwips<W){W=Nc[r].LeftIndentTwips+Nc[r].FirstIndentTwips;if(Eu)D.cx=DV(W);else D.cx=dV(W)}if(O)i-=D.cx;else if(v)i-=D.cx/2;if(i<0)i=0}else if(Dj(ui[e].flags&tc.LFLAG_LIST)&&_>Math.abs(y)){var U=Eu?PT:0;i-=_-Math.abs(y);if(i<0)i=0}if(ii&&Nj(vf)&&Nj(ui[e].flags2&tc.LFLAG2_PARA_RTL)){D=oB(t,V,n);i=E$(i,D.cx,Nl,new tc.ClsLineSeg);i+=D.cx/2;h|=tc.ETO_RTLREADING}uB(t,i,f,h,null,Uk(n),o,null);if(Nj(xs[C].style&(tc.ULINE|tc.ULINED))){var k;var X=Eu?CV(1):AV(1);var K=0;D=oB(t,V,n);if(Eu)X=X*2;if(Eu)f+=Xs[C].BaseHeight-Xs[C].BaseHeightAdj+X;else f+=xs[C].BaseHeight-xs[C].BaseHeightAdj+X;K=ib(e,0);if(Nj(xs[K].style&(tc.ULINE|tc.ULINED))){if(ui[e].tabw!=null){var Y=ui[e].tabw.ListTextWidth;if(!Eu)Y=bV(Y);D.cx=Y}}k=new tc.Pen(xs[C].TextColor);hH(t,i,f,i+D.cx,f,k,null);if(Nj(xs[C].style&tc.ULINED)){if(Eu)f+=mV(30);else f+=hV(30);hH(t,i,f,i+D.cx,f,k,null)}}}return true}function IB(t,e,r,i,f,l,a){var n,c,s,_,o,u;var T=new tc.RECT;var A,E;var R;n=Nc[ui[e].pfmt].TabId;o=Bt;if(oi.PageMode)o-=pl[Nl].x+pl[Nl].SpaceLeft;var L;O$(ui[e].pfmt,B_[n],o,true);L=nI;La=L;Ht++;T.left=Bt;Bt=T.right=T.left+a;T.top=i;T.bottom=i+f;gG(t,Bt,r,T,null,0,null,0);if(dS){var C,I=10,d=4;var F=[3];for(j=0;j<3;j++)F[j]=new tc.Point;c=T.left+(T.right-T.left)/2-I/2;if(c<T.left){c=T.left;I=T.right-T.left}s=c+I;if(s>T.right)s=T.right;if(s-c>I/2){_=T.top+2*l/3;if(_<=T.top)_=T.top+1;hH(t,c,_,s,_,new tc.Pen(1,tc.Color.black),null);F[0].x=s;F[0].y=_;F[1].x=s-d;if(F[1].x<T.left)F[1].x=T.left;F[1].y=_-d/2;F[2].x=s-d;if(F[2].x<T.left)F[2].x=T.left;F[2].y=_+d/2;if(ii)for(C=0;C<3;C++)F[C].x=E$(F[C].x,0,Nl,Nj(vf)?vf[Nf]:new tc.ClsLineSeg);vH(t,new tc.Brush(tc.Color.black),tc.Color.black,F)}}if(La==tc.TAB_DOT){A=i+l;if(A<=i)A=i+1;if(A>=T.bottom)A=T.bottom-1;RH(t,T.left,A,T.right,A,iA)}else if(La==tc.TAB_HYPH){R=new tc.Pen(iA);A=i+l-2;if(A<=i)A=i+1;if(A>=T.bottom)A=T.bottom-1;R.setDotted();hH(t,T.left,A,T.right,A,R,null)}else if(La==tc.TAB_ULINE){R=new tc.Pen(iA,Nj(xs[hc].style&tc.BOLD)?1:0);A=i+l;if(A<=i)A=i+1;if(A>=T.bottom)A=T.bottom-1;hH(t,T.left,A,T.right,A,R,null);if(Nj(xs[hc].style&tc.ULINED)){A+=2;hH(t,T.left,A,T.right,A,R,null)}}if(!um(hc)){var g=MJ(xs[hc].UlineColor,tc.CLR_AUTO)?iA:xs[hc].UlineColor;R=new tc.Pen(g,0);if(Nj(xs[hc].style&(tc.ULINE|tc.ULINE_DOTTED))){E=i+l+ce+1;if(E>=T.bottom)E=T.bottom-1;if(Nj(xs[hc].style&tc.ULINE))hH(t,T.left,E,T.right,E,R,null);if(Nj(xs[hc].style&tc.ULINE_DOTTED))RH(t,T.left,E,T.right,E,g)}else if(Nj(xs[hc].style&tc.ULINED)){hH(t,T.left,r+xs[hc].BaseHeight,T.right,r+xs[hc].BaseHeight,R,null);hH(t,T.left,r+xs[hc].BaseHeight+2,T.right,r+xs[hc].BaseHeight+2,R,null)}else if(Nj(xs[hc].style&tc.STRIKE)){E=i+l+ce+1;var P=xs[hc].BaseHeight/2*2/3;if(P<1)P=1;E-=P;if(E>=T.bottom)E=T.bottom-1;hH(t,T.left,E,T.right,E,R,null)}}La=0;return true}function dB(t,e,r,i,f,l,a){var n=new tc.RECT;var c;var s=[2];n.left=Bt;Bt=n.right=n.left+a;n.top=i;n.bottom=i+f;s[0]=tc.SPACE;gG(t,Bt,r,n,s,1,null,l-Ds);c=xs[hc].BaseHeight/4;if(c>=a)c=a-1;if(c<1)c=1;n.left=n.left+a/2-c/2;n.right=n.left+c;n.top=n.top+l-xs[hc].BaseHeight/2;n.bottom=n.top+c;if(ii&&vf!=null){n.left--;n.right--;n=R$(n,Nl,vf[Nf])}if(c<=4)HH(t,iA,n);else mH(t,true,iA,null,n);return true}function FB(t,e,r,i){var f,l,a;var n=new tc.RECT;var c=Nj(ui[e].flags2&tc.LFLAG2_RTL);ZU("WriteFrameSpace");a=ui[e].tabw.FrameX;a+=ui[e].x;l=bV(a)-Bt;if(l<0)l=0;f=bV(ui[e].tabw.FrameWidth);ui[e].tabw.FrameScrWidth=l+f;if(l>0){n.left=Bt;Bt=n.right=n.left+l;n.top=r;n.bottom=r+i;KG(Ti,tc.CHAR_T,tc.DEFAULT_CFMT);if(!c)gG(t,Bt,r,n,null,0,null,0)}if(f>0){n.left=Bt;Bt=n.right=n.left+f;n.top=r;n.bottom=r+i;KG(Ti,tc.CHAR_T,tc.DEFAULT_CFMT);_a=true;if(!c)gG(t,Bt,r,n,null,0,null,0);_a=false}return true}function gB(t,e,r,i,f,l){var a=new tc.RECT;var n;var c=Gt+Mt;var s=ii;if(e==i||f==0)return true;if(ii&&vf!=null){var _=pl[Nl].width;var o=pl[Nl].ScrX;e=o+(_-(e-o));i=o+(_-(i-o));if(e>i){e=WY(e,i);i=td}ii=false}a.left=e;if(a.left<Ft&&r<c)a.left=Ft;a.top=r;a.right=i;if(a.right==Ft+je)a.right++;if(a.right>Ft+je+1&&r<c)a.right=Ft+je+1;a.bottom=r+f;if(a.right<=a.left||a.bottom<=a.top)return true;n=hc;hc=0;KG(t,tc.CHAR_T,hc);if(l)aO|=tc.TOFLAG_WRITING_BKND;aO|=tc.TOFLAG_CLEAR_EOL;if(r>Gt+Mt)gG(t,e,r,a,null,0,null,0);else PB(t,a);aO=oj(tc.TOFLAG_CLEAR_EOL);if(l)aO=oj(tc.TOFLAG_WRITING_BKND);hc=n;ii=s;return true}function PB(t,e){var r,i,f;var l=new tc.RECT;if(!oi.PageMode||!jl||pl[Nl].ParaFrameId>0){gG(t,e.left,e.top,e,null,0,null,0);return true}DW(-1,e);r=HF;i=mF;if(r==0&&i==0){gG(t,e.left,e.top,e,null,0,null,0);return true}r=e.left+bV(r);i=bV(i);l.top=e.top;l.bottom=e.bottom;if(r>e.left){l.left=e.left;l.right=r;if(l.right>e.right)l.right=e.right;gG(t,l.left,l.top,l,null,0,null,0)}if(i>0&&r<e.right){l.left=r;l.right=r+i;if(l.right>e.right)l.right=e.right;_a=true;if(jh==0)gG(t,l.left,l.top,l,null,0,null,0);_a=false}if(r+i<e.right){l.left=r+i;l.right=e.right;gG(t,l.left,l.top,l,null,0,null,0)}return true}function SB(t){if(Ru)U0(mJ(t));else if(nt!=mJ(t)){if(oi.PageMode)iZ(mJ(t));else{var e=tc.SCROLL_RANGE-ct;dq(1+Mj(km(),mJ(t),e),false);fr=br;we=0;cG()}}return true}function hB(t,e){var r,i,f;var l=new tc.Pen(tc.CLR_WHITE);var a=new tc.Pen(1,tc.Color.black);var n=false;var c;var s=tc.SCROLL_RANGE-ct;var _,o,u;var T;if(!Wr||To<1)return false;if(!No&&e==nt)return false;_=oz(0,To)-Mt;o=Mj(_,e,s);u=0;for(r=0;r<To-1;r++){u+=uz(r);if(u>o)break}i=Hr*3/2;f=FV(tc.PAGE_BOX_WIDTH);if(!No){Mo=new tc.RECT;Mo.top=Gt+e*Mt/tc.SCROLL_RANGE;if(Mo.top<=Gt)Mo.top=Gt+1;if(Mt<=i)return false;Mo.bottom=Mo.top+i;if(Mo.bottom>=Gt+Mt){Mo.bottom=Gt+Mt-1;Mo.top=Mo.bottom-i}Mo.right=Ft+je-f/8;Mo.left=Mo.right-f;if(Mo.left<Ft)return false;Do=-1;No=true}if(r!=Do){if(nZ()==tc.Color.white){l=new tc.Pen(new tc.Color(175,175,175));n=true}T=new tc.Brush(new tc.Color(255,255,225));oJ(t,T,YY(Mo));T.Dispose();PH(t,Mo.left,Mo.top,Mo.right,Mo.bottom,l,a);if(Nj(Zh&tc.TFLAG2_SHOW_SECT_PAGE_NO))c=tg.MsgString[tc.MSG_PAGE_BOX]+mY(po[r].DispNbr);else c=tg.MsgString[tc.MSG_PAGE_BOX]+mY(r+1);sJ(t,c,W,new tc.Brush(tc.Color.black),new tc.Point(Mo.left+f/8,Mo.top+Hr/4));Do=r}if(n)l.Dispose();return true}_i.TerGetSelection=function(){var t,e,r,i;if(!lv||!QD())_i.TerCreateControl();t=e=r=i=0;rI=$C=iI=eI=0;if(uA==tc.HILIGHT_OFF)return false;t=sA;e=TA;r=_A;i=AA;if(uA==tc.HILIGHT_LINE){e=0;i=ui[_A].len}rI=t;$C=e;iI=r;eI=i;return true};_i.SelectTerText=function(t,e,r,i,f){var l;var a;if(!lv||!QD())_i.TerCreateControl();if(e<0){l=t;Cq(l);t=PC;e=SC}if(i<0){l=r;Cq(l);r=PC;i=SC;a=t==r&&e==i;if(!a&&oi.WordWrap&&i==0&&r>0&&nK(r-1)){r--;i=ui[r].len}}uA=tc.HILIGHT_CHAR;sA=t;TA=e;_A=r;AA=i;OA=false;GA=false;if(f){var n=ib(sA,TA);QE=false;if(Nj(xs[n].style&tc.PICT)&&xs[n].ctl==null){var c=Lq(sA,TA);var s=Lq(_A,AA);QE=s==c+1}if(QE&&Dj(zh&tc.TFLAG_NO_EDIT_PICT)){JE=false;OM(n)}else cG()}return true};_i.DeselectTerText=function(t){if(!lv||!QD())_i.TerCreateControl();uA=tc.HILIGHT_OFF;GA=false;if(t)cG();return true};function OB(t,e,r,i){var f,l,a,n,c=0,s,_;var o,u,T,A,E;var R=false,L,C;var I;var d=false;var F=Dj(Qh&tc.TFLAG3_NO_MOUSE_SEL);var g=uA==tc.HILIGHT_OFF;if(!F)return true;T=Da;a=Ma;s=Ga;_=Ba;I=Nj(aO&tc.TOFLAG_X_BEYOND_LINE)?true:false;E=_A;NB();if(i)R=true;else{f=Math.abs(HJ(r)-Ga);l=Math.abs(mJ(r)-Ba);d=f>xs[0].CharWidth[tc.CHAR_m]/4||l>(v.height+v.leading)/8;if(ka&&d)ka=false;$Q(t,true);if(Bh&&ya==tc.SPACE&&uA==tc.HILIGHT_CHAR&&n6(ui[sA].cid,ui[Da].cid))return g8(Da,false,true)}if(d)qE=false;if(e==tc.BUTTON_LEFT||e==tc.BUTTON_MIDDLE||e==tc.RIGHT||i){if(ya!=tc.SPACE){si=false;Vm();si=true;Da=br;if(Dj(ui[br].flags2&tc.LFLAG2_RTL))Ma=jt;R=true}}if(uA!=tc.HILIGHT_OFF&&!OA&&(e==tc.BUTTON_LEFT||e==tc.BUTTON_MIDDLE||e==tc.RIGHT)){uA=tc.HILIGHT_OFF;yn=tc.WRAP_OFF;cG()}if(uA==tc.HILIGHT_OFF){if(e==tc.BUTTON_LEFT)uA=tc.HILIGHT_CHAR;else if(e==tc.BUTTON_MIDDLE)uA=tc.HILIGHT_LINE;if(uA!=tc.HILIGHT_OFF){sA=T;TA=a;_A=AA=-1;GA=I;OA=true;pA=false}ka=true}n=Ma;if(!R&&Da<Ri-1&&Ma<ui[Da].len){if(_A>sA||_A==sA&&(AA>TA||AA==TA&&Ga>s&&Dj(ui[Da].flags2&tc.LFLAG2_RTL))){n++;if(oi.WordWrap&&n>=ui[Da].len)n--}}if(!R&&n==ui[Da].len-1&&Nj(aO&tc.TOFLAG_X_BEYOND_LINE)&&(!g||!I))n++;if(MA&&Da!=oA)MA=false;if(MA&&n>=TA&&n<EA)n=EA;var P=false;if(sA<0||sA>=Ri)P=true;else if(ui[sA].fid==0||ui[sA].fid==ui[Da].fid)P=true;if(OA&&(_A!=Da||AA!=n)&&P&&(_A<0||_A>=Ri||(Nc[ui[sA].pfmt].flags&tc.PAGE_HDR_FTR)==(Nc[ui[Da].pfmt].flags&tc.PAGE_HDR_FTR))){var S=true;if(_A>=0&&_A<Ri)c=ui[_A].cid;if(Nj(aO&tc.TOFLAG_X_BEYOND_LINE)){if(_A>=0&&_A<Ri&&sA>=0&&sA<Ri){var h=false;if(_A>sA)h=true;else if(_A==sA){if(AA>TA)h=true;else if(AA==TA){if(Da>sA)h=true;else if(Da==sA){if(Ma>TA)h=true;else if(Ma==TA){if(Ba>_)h=true;else if(Ba==_&&Ga>=s)h=true}}}}if(h&&Da<sA&&ui[sA].cid>0)h=false;if(h&&Da<sA){AA=ui[_A].len-1;if(AA<0)AA=0;S=false}if(!h&&Da>sA){AA=0;S=false}if(!S&&ui[sA].cid>0&&ui[_A].cid!=ui[sA].cid)S=true}}if(S){_A=Da;AA=n}if(sA>=Ri){sA=Ri-1;TA=0}if(_A>=Ri){_A=Ri-1;AA=ui[_A].len}if(R){br=Da;jt=n;we=br-fr;cG()}else{o=br;u=Da;if(br>Da){o=Da;u=br}L=OA;OA=false;Ui=true;ci=true;C=Ii;Ii=false;A=uA;if(oi.PageMode){br=Da;if(jt>=ui[Da].len&&ui[Da].len>0)jt=ui[Da].len-1;ye=o-1;We=u+1;Br=tc.PAINT_RANGE;if(Nj(Zh&tc.TFLAG2_XPARENT_WRITE))Br=tc.PAINT_WIN;if(o==u&&E==_A)Br=tc.PAINT_LINE;if(ui[sA].cid!=ui[_A].cid)Br=tc.PAINT_WIN;else if(ui[_A].cid!=c)Br=tc.PAINT_WIN;else if(Nj(ui[sA].flags&tc.LFLAG_PICT))Br=tc.PAINT_WIN;else if($r)Br=tc.PAINT_WIN;else if(GY(sA,tc.INFO_FRAME))Br=tc.PAINT_WIN;else if(rW(sA)>0)Br=tc.PAINT_WIN;yn=tc.WRAP_OFF;cG()}else{br=Da;we=br-fr;Br=tc.PAINT_WIN;yn=tc.WRAP_OFF;cG()}uA=A;OA=L;Ii=C;br=Da;jt=n;if(br+1==Ri&&jt>=ui[br].len&&jt>0)jt--;we=br-fr;uq()}}if(uA!=tc.HILIGHT_OFF){if(sA>=Ri)sA=Ri-1;if(_A>=Ri)_A=Ri-1;if(sA<0)sA=0;if(_A<0)_A=0}if(R){if(!NA){ll=window.setInterval(Up,40);NA=true}}return true}function vB(){var t;var e;if(uA!=tc.HILIGHT_CHAR||QE)return true;if(r6(true))cG();if(sA>=Ri)return true;t=ui[sA].pfmt;if(Nj(Nc[t].flags&tc.PAGE_HDR_FTR)&&!yN()){for(e=sA+1;e<Ri&&e<=_A;e++)if(Nj(ui[e].flags&tc.LFLAG_HDRS_FTRS))break;if(e-1<_A){_A=e-1;AA=ui[_A].len;cG()}}return true}function pB(){var t;NB();if(QE)uA=tc.HILIGHT_OFF;if(Nj($h&tc.TFLAG5_NO_KB_SEL))return true;t=Sa.shiftKey;if(t){if(uA!=tc.HILIGHT_CHAR){if(WR&&Dj(Nc[ui[br].pfmt].flags&tc.PAGE_HDR_FTR))y5();uA=tc.HILIGHT_CHAR;sA=_A=br;TA=AA=jt}OA=true}else if(uA==tc.HILIGHT_CHAR){uA=tc.HILIGHT_OFF;cG()}Oc=-1;QE=qE=false;pA=false;return true}function NB(){if(NA){clearInterval(ll);NA=false}return true}function DB(){if(uA!=tc.HILIGHT_OFF&&(Nc[ui[sA].pfmt].flags&tc.PAGE_HDR_FTR)!=(Nc[ui[br].pfmt].flags&tc.PAGE_HDR_FTR)){uA=tc.HILIGHT_OFF;OA=false;return true}_A=br;AA=jt;if(Zt==tc.ID_LINE_END&&AA==ui[_A].len-1)AA++;if(_A>sA||_A==sA&&AA>TA){if(oi.WordWrap&&!DA&&AA==0&&_A>0&&nK(_A-1)){_A--;AA=ui[_A].len;if(GY(_A,tc.INFO_ROW)&&_A>0){_A--;AA=ui[_A].len}}}return true}function MB(t,e){if(VR)cq();if(QE){uA=tc.HILIGHT_OFF;QE=false}Ka=true;ja=HJ(e);Ja=mJ(e);za=Jf;eq(ha,false);cG();return true}function GB(t){var e,r,f=tc.WHEEL_RADIUS;var l,a;var n;var c=[3];for(i=0;i<3;i++)c[i]=new tc.Point;e=ja-rt.left+Ft;r=Ja-rt.top+Gt;l=new tc.Color(8355711);if(l==nZ())l=tc.Color.white;a=nZ();n=new tc.Pen(l);TJ(t,new tc.Brush(a),e-f,r-f,2*f,2*f);AJ(t,n,e-f,r-f,2*f,2*f);TJ(t,new tc.Brush(l),e-2,r-2,5,5);c[0].x=e;c[0].y=r-(f-2);c[1].x=e-(f-6);c[1].y=r-4;c[2].x=e+(f-6);c[2].y=r-4;EJ(t,new tc.Brush(l),c);c[0].x=e;c[0].y=r+(f-3);c[1].x=e-(f-7);c[1].y=r+4;c[2].x=e+(f-7);c[2].y=r+4;EJ(t,new tc.Brush(l),c);return true}function BB(t,e){var r,i=100,f;if(Ya){clearInterval(al);Ya=false}if(Va){clearInterval(nl);Va=false}if(e)return true;za=Jf;r=mJ(t);if(r<=Ja-tc.WHEEL_RADIUS){za=zf;f=i/((Ja-r)/tc.WHEEL_RADIUS);al=window.setInterval(kp,f);Ya=true}else if(r>=Ja+tc.WHEEL_RADIUS){za=Zf;f=i/((r-Ja)/tc.WHEEL_RADIUS);nl=window.setInterval(Xp,f);Va=true}return true}function HB(){if(!Ka)return true;BB(0,true);Ka=false;if(Nj(za)){za=null;eq(ha,false)}cG();return true}function mB(t,e){var r,i;r=Ga=HJ(e);i=Ba=mJ(e);if(tn&&r==Za&&i==Qa)return true;Za=r;Qa=i;tq(true);if(tn&&Da==qa&&Ma==$a)return true;if(rn&&Da==qa&&Ma==$a)return true;qa=Da;if(!Xa||Nj(aO&(tc.TOFLAG_X_BEYOND_LINE|tc.TOFLAG_X_BEFORE_LINE)))qa=-1;if(qa>=Ri)qa=-1;$a=Ma;if(tn)return true;fl=window.setInterval(Kp,500);tn=true;rn=false;return true}function wB(){var t="";clearInterval(fl);fl=null;tn=false;if(en)cG();if(qa>=0&&qa<Ri){if(K4(qa,$a)){t=GP;bB(Ti,t)}else if(LU(false,qa,$a)){bB(Ti,tg.MsgString[tc.MSG_INVOKE_TEXT_LINK])}else if(CU(false,qa,$a)){bB(Ti,tg.MsgString[tc.MSG_INVOKE_TEXT_LINK])}}rn=true;return true}function bB(t,e){var r,f;var l=new tc.Pen(tc.CLR_WHITE);var a=new tc.Pen(1,tc.Color.black);var n=false,c=false;var s;var _=new tc.RECT;var o=5;var u;var T,A,E=0;var R=[10];if(Ru)return true;if(e==null)return true;A=e.length;T=0;var L=Uk(e);for(i=0;i<=A;i++){if(i==A||L[i]=="\n"){R[E]=cV(e,T,i-T);E++;T=i+1;if(E>=10)break}}t:{r=Hr*E+Hr/2;if(r>=Mt)break t;f=0;for(i=0;i<E;i++){u=SJ(t,P,R[i]);if(u.cx>f)f=u.cx}f+=o*2;if(f>=je)break t;_.top=Gt+(Qa-rt.top-r-10);if(_.top<=Gt){_.top=Gt+1;c=true}_.bottom=_.top+r;if(_.bottom>=Gt+Mt){_.bottom=Gt+Mt-1;_.top=_.bottom-r;c=true}_.left=Ft+(Za-rt.left-f/2);if(c){if(Za-rt.left<je/2)_.left+=f/2+2*o;else _.left-=f/2+2*o}if(_.left<Ft)_.left=Ft;_.right=_.left+f;if(_.right>=Ft+je){_.right=Ft+je-1;_.left=_.right-f}if(nZ()==tc.Color.white){l=new tc.Pen(new tc.Color(175,175,175));n=true}s=new tc.Brush(new tc.Color(255,255,225));oJ(t,s,YY(_));s.Dispose();PH(t,_.left,_.top,_.right,_.bottom,l,a);var C=_.top+Hr/4;for(i=0;i<E;i++){var I=Nj(i%2)?W:P;sJ(t,R[i],I,new tc.Brush(tc.Color.black),new tc.Point(_.left+o,C));C+=Hr}}if(n)l.Dispose();en=true;return true}function xB(t,e){var r=new tc.Color(204,204,204);var i=new tc.Pen(1,r);var f=null;var l=pl[e].flags&tc.FRAME_BORDER;var a,n,c,s,_;if(Nj(l&(tc.FRAME_BORDER_RIGHT|tc.FRAME_BORDER_BOT)))f=new tc.Pen(qT,3);if(!MJ(qT,tc.CLR_BLACK)){r=qT;i=new tc.Pen(qT,1)}a=pl[e].x;n=pl[e].y;c=pl[e].width;s=pl[e].height;_=bV(pl[e].LeftBorderWdth);if(Nj(l&tc.FRAME_BORDER_TOP)){CH(t,a+_,n+s-1,a+c-_,n+s-1,r,false)}if(Nj(l&tc.FRAME_BORDER_BOT)){hH(t,a+_,n,a+c-_,n,f,i)}if(Nj(l&tc.FRAME_BORDER_LEFT)){CH(t,a+c-1,n,a+c-1,n+s,r,false)}if(Nj(l&tc.FRAME_BORDER_RIGHT)){hH(t,a,n,a,n+s,f,i)}if(Nj(f))f.Dispose();if(!MJ(qT,tc.CLR_BLACK))i.Dispose();return true}function yB(t,e){var r,i;var f;var l,a,n,c,s,_,o=20,u;var T;var A=[5];var E;var R=[5];var L;a=pl[e].x;n=pl[e].y;c=pl[e].width;s=pl[e].height;_=pl[e].sect;if(to[_].BorderType==tc.BRDRTYPE_NONE)return true;f=to[_].border;E=1;A[0]=A[1]=A[2]=false;T=false;if(to[_].BorderType==tc.BRDRTYPE_DBL){E=2}else if(to[_].BorderType==tc.BRDRTYPE_TRIPLE){E=3}else if(to[_].BorderType==tc.BRDRTYPE_SHADOW)T=true;else if(to[_].BorderType==tc.BRDRTYPE_THICK_THIN){E=2;A[1]=true}else if(to[_].BorderType==tc.BRDRTYPE_THIN_THICK){E=2;A[0]=true}else if(to[_].BorderType==tc.BRDRTYPE_THICK_THIN_THICK){E=3;A[1]=true}else if(to[_].BorderType==tc.BRDRTYPE_THIN_THICK_THIN){E=3;A[0]=A[2]=true}L=to[_].BorderWidth[tc.BORDER_INDEX_TOP]/2;for(l=0;l<E;l++)R[l]=L*(A[l]?1:2);var C=to[_].BorderOpts==32;if($T!=tc.CLR_WHITE&&!Eu&&C){var I=new tc.RECT;var d,F,g,P;d=to[_].BorderSpace[tc.BORDER_INDEX_TOP];d=Eu?mV(d):hV(d);if(Ru&&Dj(nO&tc.TOFLAG2_PRINTING_TO_EMF))d-=xV(2);F=to[_].BorderSpace[tc.BORDER_INDEX_BOT];F=Eu?mV(F):hV(F);g=to[_].BorderSpace[tc.BORDER_INDEX_LEFT];g=Eu?DV(g):dV(g);if(Ru&&Dj(nO&tc.TOFLAG2_PRINTING_TO_EMF))g-=xV(2);P=to[_].BorderSpace[tc.BORDER_INDEX_RIGHT];P=Eu?DV(P):dV(P);I=VY(a-g,n-d,a+c+P,n);HH(t,tc.CLR_WHITE,I);I=VY(a-g,n+s,a+c+P,n+s+F);HH(t,tc.CLR_WHITE,I);I=VY(a-g,n-d,a,n+s+F);HH(t,tc.CLR_WHITE,I);I=VY(a+c,n-d,a+c+P,n+s+F);HH(t,tc.CLR_WHITE,I)}i=null;for(l=0;l<E;l++){r=WB(R[l],to[_].BorderColor);if(T)i=WB(to[_].BorderWidth[tc.BORDER_INDEX_TOP]*(A[l]?2:1),new tc.Color(pJ(to[_].BorderColor)|8421504));if(Nj(f&tc.BORDER_TOP)){hH(t,a,n,a+c,n,r,i)}if(Nj(f&tc.BORDER_BOT)){hH(t,a,n+s,a+c,n+s,r,i)}if(Nj(f&tc.BORDER_LEFT)){hH(t,a,n,a,n+s,r,i)}if(Nj(f&tc.BORDER_RIGHT)){hH(t,a+c,n,a+c,n+s,r,i)}if(l+1<E){u=o+(R[l]+R[l+1])/2;u=Eu?DV(u):dV(u);a+=u;n+=u;c-=2*u;s-=2*u}if(Nj(i))i.Dispose();i=null}return true}function WB(t,e){var r;if(Eu)r=DV(t);else r=dV(t);if(r<1)r=1;wd=r;return new tc.Pen(e,r)}function UB(t,e,r){var i,f,l,a,n,c,s,_,o,u,T,A,E;var R=0,L=0,C=0,I=0;var d=false,F=false,g=false,P=false,S;var h;var O=new tc.RECT;O=e;if(Eu){C=DV(da);I=DV(Fa);R=mV(ga);L=mV(Pa)}else{C=hV(da);I=hV(Fa);R=hV(ga);L=hV(Pa)}O.top-=R;O.bottom+=L;var v=ui[Hs].pfmt;if(Eu)_=DV(Nc[v].BorderWidth);else _=dV(Nc[v].BorderWidth);if(_<1)_=1;var p=Eu?RV(1):uV(1);if(_<p)_=p;if(Nj(na&tc.BOX_THICK)){if(Eu)o=Mj(_,4,3);else o=_*2}else o=_;i=pl[Nl].ParaFrameId;S=i>0&&Nj(kl[i].flags&tc.PARA_FRAME_TEXT_BOX);u=0;if(Nj(na&tc.BOX_DOUBLE)){if(r){A=2*o+_;u=-(_+o)}else{A=o}}else{A=o}if(Nj(Qh&tc.TFLAG3_LARGE_PARA_BORDER))T=u+1;else{T=u;u+=Ds;T+=Ms;if(Nj(na&tc.BOX_BETWEEN))u=T=0}c=$c-(A-o)-C;s=ts+(A-o)+I;if(Nj(na&tc.BOX_TOP))g=true;if(Nj(na&(tc.BOX_BOT|tc.BOX_BETWEEN)))P=true;if(S){if(Nj(na&tc.BOX_LEFT))d=true;if(Nj(na&tc.BOX_RIGHT))F=true}else{if(Nj(na&tc.BOX_LEFT)&&c>=O.left&&c<O.right)d=true;if(Nj(na&tc.BOX_RIGHT)&&s>=O.left&&s<O.right)F=true}if(Dj(g|P|d|F))return true;if(null==(h=new tc.Pen(MJ(eA,tc.CLR_AUTO)?tc.Color.black:eA,o)))return true;if(g){if(c<O.left)f=O.left;else f=c;if(s>O.right)a=O.right;else a=s;l=n=O.top+u;if(a>f)hH(t,f,l,a,n,h,null);if(Li&&!P)hH(t,f,l,a,n,new tc.Pen(tc.CLR_WHITE),null)}var N=Nj(na&tc.BOX_BETWEEN)?0:_;if(P){if(c<O.left)f=O.left;else f=c;if(s>O.right)a=O.right;else a=s;l=n=O.bottom-T;if(Nj(na&tc.BOX_BETWEEN))l=n=n-2*_;if(a>f)hH(t,f,l-N,a,n-N,h,null)}if(d){f=a=c;l=O.top;if(g)l+=u;n=O.bottom;if(P)n-=T;hH(t,f,l,a,n-N,h,null)}if(F){f=a=s;l=O.top;if(g)l+=u;n=O.bottom;if(P)n-=T;hH(t,f,l,a,n-N,h,null)}if(Nj(na&tc.BOX_DOUBLE)&&r)UB(t,e,false);return true}function kB(t,e,r,f,l,a,n){var c,s,_,o,u,T;var A=true;var E;if(e>=0){r=pl[e].ParaFrameId;if(pl[e].empty||Dj(kl[r].flags&tc.PARA_FRAME_LINE))return true;if(Nj(kl[r].flags&tc.PARA_FRAME_NO_LINE))return true;c=kl[r].pict;if(c>0&&c<Ys&&xs[c].PictType==tc.PICT_SHAPE){xs[c].PictX=pl[e].x-Ft;xs[c].PictY=pl[e].y-Gt;xs[c].DispFrame=e}s=o=_=u=0;aW(e,s,_,o,u);s=rd;o=id;_=fd;u=ld}else{c=kl[r].pict;s=f;_=l;o=f+a;u=l+n;aW(-r,s,_,o,u);s=rd;o=id;_=fd;u=ld}if(Eu)T=DV(kl[r].LineWdth);else T=dV(kl[r].LineWdth);if(Nj(kl[r].flags&tc.PARA_FRAME_DOTTED)){A=false;T=1}if(null==(E=new tc.Pen(kl[r].LineColor,T)))return true;if(!A)E.setDotted();if(Nj(kl[r].flags2&tc.PF2_HTML_RULE)){E.setStartCapRound(false);E.setEndCapRound(false)}hH(t,s,_,o,u,E,null);if(Nj(kl[r].flags2&(tc.PF2_START_ARROW|tc.PF2_END_ARROW))){var R=[3];for(i=0;i<3;i++)R[i]=new tc.Point;var L=tc.CLR_BLACK;var C=null;L=kl[r].LineColor;C=new tc.Brush(L);if(Nj(kl[r].flags2&tc.PF2_START_ARROW)){XB(s,_,o,u,true,kl[r].LineWdth,R);vH(t,C,L,R)}if(Nj(kl[r].flags2&tc.PF2_END_ARROW)){XB(s,_,o,u,false,kl[r].LineWdth,R);vH(t,C,L,R)}C.Dispose()}E.Dispose();return true}function XB(t,e,r,i,f,l,a){var n,c,s;var _,o,u,T,A,E=100,R=100,L;L=l/25+1;E*=L;R*=L;E=Eu?DV(E):dV(E);R=Eu?DV(R):dV(R);l=Eu?DV(l):dV(l);if(t==r){a[0].x=r;a[1].x=r-R/2;a[2].x=r+R/2;if(f){a[0].y=e;if(i>e)a[1].y=a[2].y=e+E;else a[1].y=a[2].y=e-E}else{a[0].y=i;if(i>e)a[1].y=a[2].y=i-E;else a[1].y=a[2].y=i+E}return true}if(e==i){if(f){t-=l;a[0].x=t;a[0].y=e;a[1].x=t+E;a[1].y=e+R/2;a[2].x=t+E;a[2].y=e-R/2}else{r+=l;a[0].x=r;a[0].y=i;a[1].x=r-E;a[1].y=i+R/2;a[2].x=r-E;a[2].y=i-R/2}}if(r<t){t=WY(t,r);r=JC;e=WY(e,i);i=JC;f=!f}_=r-t;o=-(i-e);n=Math.atan(o/_);u=n*180/tc.PI;if(Math.sin(n)==0)T=_;else T=Math.abs(o/Math.sin(n));if(f){a[0].x=0;a[0].y=0;a[1].x=E;a[1].y=R/2;a[2].x=E;a[2].y=-R/2}else{a[0].x=T;a[0].y=0;a[1].x=T-E;a[1].y=R/2;a[2].x=T-E;a[2].y=-R/2}c=Math.atan(a[1].y/a[1].x);if(Math.sin(c)==0)A=a[1].x;else A=a[1].y/Math.sin(c);s=n+c;if(f){a[0].x=0;a[0].y=0;a[1].x=A*Math.cos(s);a[1].y=A*Math.sin(s);s=n-c;a[2].x=A*Math.cos(s);a[2].y=A*Math.sin(s)}else{a[0].x=_;a[0].y=o;a[1].x=A*Math.cos(s);a[1].y=A*Math.sin(s);s=n-c;a[2].x=A*Math.cos(s);a[2].y=A*Math.sin(s)}if(f){a[0].x=t;a[0].y=e;a[1].x+=t;a[1].y=e-a[1].y;a[2].x+=t;a[2].y=e-a[2].y}else{a[0].x=r;a[0].y=i;a[1].x+=t;a[1].y=e-a[1].y;a[2].x+=t;a[2].y=e-a[2].y}return true}function KB(t,e){var r=new tc.RECT;var i,f,l,a,n,c;ZU("DrawPictFrame");l=pl[e].x;a=pl[e].y;n=pl[e].width;c=pl[e].height;r=VY(l,a-pl[e].SpaceTop,l+n,a+c);KG(t,tc.CHAR_T,tc.DEFAULT_CFMT);f=pl[e].ParaFrameId;i=kl[f].pict;if(Dj(xs[i].InUse)||Dj(xs[i].style&tc.PICT))return true;r.top=a;r.left=l+pl[e].SpaceLeft;r.right=l+n-pl[e].SpaceRight;r.bottom=a+c-pl[e].SpaceBot;HN(i,hV(xs[i].PictHeight),dV(xs[i].PictWidth),false);aO|=tc.TOFLAG_DRAWING_FRAME_PICT;PG(t,r.left,r.top,r,i,1,pl[e].PageFirstLine);oj(tc.TOFLAG_DRAWING_FRAME_PICT);YB(t,e);HN(i,0,0,true);xs[i].DispFrame=e;return true}function YB(t,e){var r=new tc.RECT;var i,f,l,a,n;i=pl[e].ParaFrameId;if(Dj(kl[i].flags&tc.PARA_FRAME_BOXED))return false;f=pl[e].x;l=pl[e].y;a=pl[e].width;n=pl[e].height;r.top=l;r.left=f+pl[e].SpaceLeft;r.right=f+a-pl[e].SpaceRight;r.bottom=l+n-pl[e].SpaceBot;var c=WB(kl[i].LineWdth,kl[i].LineColor);if(Nj(kl[i].flags&tc.PARA_FRAME_DOTTED))c.setDotted();hH(t,r.left,r.top,r.right,r.top,c,null);hH(t,r.left,r.bottom,r.right,r.bottom,c,null);hH(t,r.left,r.top,r.left,r.bottom,c,null);hH(t,r.right,r.top,r.right,r.bottom,c,null);c.Dispose();return true}function VB(t,e,r,i,f,l,a,n){var c,s,_;var o=new tc.RECT;var u,T;var A;var E;var R,L;var C;var I,d;var F;var g;var P=null;var S=0,h=0;var O;var v=null;if(e>=0){r=pl[e].ParaFrameId;if(pl[e].empty)return true;if(Dj(kl[r].flags&tc.PARA_FRAME_RECT)&&!JW(r))return true;c=kl[r].pict;if(c>0&&c<Ys&&xs[c].PictType==tc.PICT_SHAPE){xs[c].PictX=pl[e].x-Ft;xs[c].PictY=pl[e].y-Gt;xs[c].DispFrame=e}o.left=pl[e].x;o.right=o.left+pl[e].width;o.top=pl[e].y;o.bottom=o.top+pl[e].height;if(JW(r)){var p=pl[e].BoxFrame;if(p>0&&Nj(pl[p].flags1&tc.FRAME1_PARA_FRAME_BOX)){o.left=pl[p].x;if(Eu)o.left+=PT;o.right=o.left+pl[p].width;o.top=pl[p].y;if(Eu)o.top+=ST;o.bottom=o.top+pl[p].height}}}else{c=kl[r].pict;o.left=i;o.right=o.left+l;if(Eu)o.top+=ST;o.top=f;o.bottom=o.top+a}if(o.right==o.left)o.right++;if(o.bottom==o.top)o.bottom++;hc=0;u=iA;T=fA;iA=tc.CLR_WHITE;fA=kl[r].BackColor;if(!Eu&&!Ru)mG(o.left,o.top,o);iA=u;fA=T;E=kl[r].BackColor;if(kl[r].FillPattern>=2&&kl[r].FillPattern<=13){var N=[5,10,20,25,30,40,50,60,70,75,80,90];var D=kl[r].FillPattern-2;var M=N[D];var G=E.getRed()*(100-M)/100;var B=E.getGreen()*(100-M)/100;var H=E.getBlue()*(100-M)/100;E=new tc.Color(G,B,H)}R=kl[r].ShapeType;if(JW(r))R=kl[r].OrigShapeType;if(JW(-R)||R==tc.SHPTYPE_LBRACKET||R==tc.SHPTYPE_RBRACKET||R==tc.SHPTYPE_CHART_PUNCHED_CARD||R==tc.SHPTYPE_RECT&&kl[r].PointCount>0&&kl[r].pPoint!=null){var m=kl[r].FillPattern>0&&(n==tc.MODE_FILL||n==tc.MODE_DRAW_FILL);var w=R==tc.SHPTYPE_RECT&&kl[r].PointCount>0&&kl[r].pPoint!=null;if(Eu)s=DV(kl[r].LineWdth);else s=dV(kl[r].LineWdth);if(Ru&&s<wV(1))s=wV(1);F=true;if(Nj(kl[r].flags&tc.PARA_FRAME_DOTTED)){F=false;s=1}if(Nj(kl[r].flags&tc.PARA_FRAME_BOXED)&&(n==tc.MODE_DRAW||n==tc.MODE_DRAW_FILL)){A=new tc.Pen(kl[r].LineColor,s);if(!F)A.setDotted()}else A=null;if(R==tc.SHPTYPE_ELLIPSE)mH(t,m,E,A,o);else if(R==tc.SHPTYPE_CROSSED_CIRCLE){var b,x,y,W,U;mH(t,m,E,A,o);y=(o.right-o.left)/2;L=(o.bottom-o.top)/2;b=o.left+y;x=o.top+L;W=y/Math.sqrt(2);U=L/Math.sqrt(2);hH(t,b-W,x-U,b+W,x+U,A,null);hH(t,b+W,x-U,b-W,x+U,A,null)}else if(R==tc.SHPTYPE_ROUND_RECT||R==tc.SHPTYPE_CHART_ALT_PROCESS){d=o.right-o.left;if(o.bottom-o.top<d)d=o.bottom-o.top;d=d/4;if(kl[r].AdjVal1>0){d=kl[r].AdjVal1;if(Eu)d=DV(d);else d=dV(d)}if(R==tc.SHPTYPE_CHART_ALT_PROCESS){l=o.right-o.left;a=o.bottom-o.top;if(l<a)d=l/7;else d=a/7}xH(t,m,E,A,o,d,d)}else if(R==tc.SHPTYPE_LBRACKET||R==tc.SHPTYPE_RBRACKET){var k=R==tc.SHPTYPE_LBRACKET;var X=o;var K=o.right-o.left;var Y;L=kl[r].AdjVal1;if(L==0)L=180;if(Eu)L=DV(L);else L=dV(L);if(2*L>o.bottom-o.top)L=(o.bottom-o.top)/2;Y=L*2;if(kl[r].rotation!=0)k=!k;if(k){X.right=o.right+K;X.bottom=X.top+Y;wH(t,A,X,o.right,o.top,o.left,o.top+L);hH(t,o.left,o.top+L,o.left,o.bottom-L,A,null);X.top=o.bottom-Y;X.bottom=o.bottom;wH(t,A,X,o.left,o.bottom-L,o.right,o.bottom)}else{X.left=o.left-K;X.bottom=X.top+Y;wH(t,A,X,o.right,o.top+L,o.left,o.top);hH(t,o.right,o.top+L,o.right,o.bottom-L,A,null);X.top=o.bottom-Y;X.bottom=o.bottom;wH(t,A,X,o.left,o.bottom,o.right,o.bottom-L)}}else if(R==tc.SHPTYPE_CHART_PUNCHED_CARD){C=[6];var V=18;var J=22;for(_=0;_<6;_++)C[_]=new tc.Point;C[0].x=C[5].x=o.left+(o.right-o.left)*V/100;C[0].y=C[5].y=o.top;C[1].x=o.right;C[1].y=o.top;C[2].x=o.right;C[2].y=o.bottom;C[3].x=o.left;C[3].y=o.bottom;C[4].x=o.left;C[4].y=o.top+(o.bottom-o.top)*J/100;yH(t,m,E,A,C)}else if(R==tc.SHPTYPE_CHART_DECISION){C=[];for(_=0;_<5;_++)C[_]=new tc.Point;C[0].x=C[4].x=o.left+(o.right-o.left)/2;C[0].y=C[4].y=o.top;C[1].x=o.right;C[1].y=o.top+(o.bottom-o.top)/2;C[2].x=o.left+(o.right-o.left)/2;C[2].y=o.bottom;C[3].x=o.left;C[3].y=o.top+(o.bottom-o.top)/2;yH(t,m,E,A,C)}else if(R==tc.SHPTYPE_RR_CALLOUT){var z=0,Z=0,Q=0,q=0,$=0,tt=0;var et=22e3;l=o.right-o.left;a=o.bottom-o.top;var rt=l/12;var it=a/12;var ft=10;var lt=15;var at=25;var nt=false;if(rt==0||it==0)rt=it=0;if(rt<it)it=rt;else rt=it;var ct=Mj(l,kl[r].AdjVal1,et);var st=Mj(a,kl[r].AdjVal2,et);var _t=ct;if(st>_t)_t=st;P=null;S=i;h=f;if(Go!=null){P=document.createElement("canvas");P.width=l+2*_t;P.height=a+2*_t;S=o.left-_t;h=o.top-_t;O=o.copy();o.adjust(-o.left+_t,-o.top+_t);t=P.getContext("2d")}z=o.left+ct;Z=o.top+st;if(!nt&&Z<=o.top&&z<=o.left+l/2){if(z>=o.left)nt=true;else if((o.top-Z)/(o.left-z)>=a/l)nt=true;if(nt){$=tt=o.top;Q=o.left+Mj(l,lt,100);q=Q+Mj(l,at,100)}}if(!nt&&Z<=o.top&&z>=o.left+l/2){if(z<o.left+l)nt=true;else if((o.top-Z)/(z-(o.left+l))>=a/l)nt=true;if(nt){$=tt=o.top;Q=o.left+l/2+Mj(l,ft,100);q=Q+Mj(l,at,100)}}if(!nt&&Z>=o.top+a&&z<=o.left+l/2){if(z>=o.left)nt=true;else if((Z-(o.top+a))/(o.left-z)>=a/l)nt=true;if(nt){$=tt=o.top+a;Q=o.left+Mj(l,lt,100);q=Q+Mj(l,at,100)}}if(!nt&&Z>=o.top+a&&z>=o.left+l/2){if(z<o.left+l)nt=true;else if((Z-(o.top+l))/(z-(o.left+l))>=a/l)nt=true;if(nt){$=tt=o.top+a;Q=o.left+l/2+Mj(l,ft,100);q=Q+Mj(l,at,100)}}if(!nt&&z<=o.left&&Z<=o.top+a/2){nt=true;Q=q=o.left;$=o.top+Mj(a,lt,100);tt=$+Mj(a,at,100)}if(!nt&&z<=o.left&&Z>=o.top+a/2){nt=true;Q=q=o.left;$=o.top+a/2+Mj(a,ft,100);tt=$+Mj(a,at,100)}if(!nt&&z>=o.left+l&&Z<=o.top+a/2){nt=true;Q=q=o.left+l;$=o.top+Mj(a,lt,100);tt=$+Mj(a,at,100)}if(!nt&&z>=o.left+l&&Z>=o.top+a/2){nt=true;Q=q=o.left+l;$=o.top+a/2+Mj(a,ft,100);tt=$+Mj(a,at,100)}t.beginPath();t.moveTo(o.left+rt,o.top);JB(t,new tc.Rectangle(o.left,o.top,2*rt,2*it),270,-90);t.lineTo(o.left,o.top+it);if(nt&&o.left==Q){t.lineTo(o.left,$);t.lineTo(z,Z);t.lineTo(q,tt)}t.lineTo(o.left,o.bottom-it);JB(t,new tc.Rectangle(o.left,o.bottom-2*it,2*rt,2*it),180,-90);t.moveTo(o.left+rt,o.bottom);if(nt&&o.top+a==$){t.lineTo(Q,o.top+a);t.lineTo(z,Z);t.lineTo(q,tt)}t.lineTo(o.right-rt,o.bottom);JB(t,new tc.Rectangle(o.right-2*rt,o.bottom-2*it,2*rt,2*it),90,-90);t.moveTo(o.right,o.bottom-it);if(nt&&o.left+l==Q){t.lineTo(o.left+l,tt);t.lineTo(z,Z);t.lineTo(Q,$)}t.lineTo(o.right,o.top+it);JB(t,new tc.Rectangle(o.right-2*rt,o.top,2*rt,2*it),0,-90);t.moveTo(o.right-rt,o.top);if(nt&&o.top==$){t.lineTo(q,o.top);t.lineTo(z,Z);t.lineTo(Q,$)}t.lineTo(o.left+rt,o.top);t.closePath();if(n==tc.MODE_FILL||n==tc.MODE_DRAW_FILL)IJ(t,E);if(n==tc.MODE_DRAW||n==tc.MODE_DRAW_FILL)dJ(t,A);if(Go!=null){v=P.toDataURL("image/png");Q$(v,S,h);o=O}}else if(R==tc.SHPTYPE_CHART_MAG_DRUM){l=o.right-o.left;a=o.bottom-o.top;d=a/2;if(d>l/6)d=l/6;P=null;S=i;h=f;if(Go!=null){P=document.createElement("canvas");P.width=l;P.height=a;S=o.left;h=o.top;O=o.copy();o.adjust(-S,-h);t=P.getContext("2d")}t.beginPath();t.moveTo(o.left+d,o.top);var ot=new tc.Rectangle(o.left,o.top,2*d,o.bottom-o.top);JB(t,ot,270,-180);t.lineTo(o.right-d,o.bottom);ot=new tc.Rectangle(o.right-2*d,o.top,2*d,o.bottom-o.top);JB(t,ot,90,-180);t.lineTo(o.left+d,o.top);t.closePath();if(n==tc.MODE_FILL||n==tc.MODE_DRAW_FILL)IJ(t,E);if(n==tc.MODE_DRAW||n==tc.MODE_DRAW_FILL)dJ(t,A);if(Go!=null){v=P.toDataURL("image/png");Q$(v,S,h);o=O}if(n==tc.MODE_DRAW||n==tc.MODE_DRAW_FILL){wH(t,A,new tc.RECT(o.right-2*d,o.top,2*d,o.bottom-o.top),o.right-d,o.top,o.right-d,o.bottom)}}else if(R==tc.SHPTYPE_CHART_ONLINE_STORAGE){l=o.right-o.left;a=o.bottom-o.top;d=l/6;P=null;S=i;h=f;if(Go!=null){P=document.createElement("canvas");P.width=l;P.height=a;S=o.left;h=o.top;O=o.copy();o.adjust(-S,-h);t=P.getContext("2d")}t.beginPath();t.moveTo(o.left+d,o.top);JB(t,new tc.Rectangle(o.left,o.top,2*d,o.bottom-o.top),270,-180);t.lineTo(o.right,o.bottom);JB(t,new tc.Rectangle(o.right-d,o.top,2*d,o.bottom-o.top),90,180);t.lineTo(o.left+d,o.top);t.closePath();if(n==tc.MODE_FILL||n==tc.MODE_DRAW_FILL)IJ(t,E);if(n==tc.MODE_DRAW||n==tc.MODE_DRAW_FILL)dJ(t,A);if(Go!=null){v=P.toDataURL("image/png");Q$(v,S,h);o=O}}else if(w){C=null;var ut=kl[r].PointCount;C=[];for(j=0;j<ut;j++)C[j]=new tc.Point;for(_=0;_<ut;_++){if(Eu){C[_].x=o.left+DV(kl[r].pPoint[_].x);C[_].y=o.top+mV(kl[r].pPoint[_].y)}else{C[_].x=o.left+dV(kl[r].pPoint[_].x);C[_].y=o.top+hV(kl[r].pPoint[_].y)}}var Tt=Nj(kl[r].flags&tc.PARA_FRAME_BOXED);if(jB(t,C,ut,r,m,E,Tt,A,false))jB(t,C,ut,r,m,E,Tt,A,true);else{if(m||C[0].x==C[ut-1].x&&C[0].y==C[ut-1].y)yH(t,m,E,Tt?A:null,C);else{for(_=0;_<ut-1;_++)hH(t,C[_].x,C[_].y,C[_+1].x,C[_+1].y,A,null)}}}else{C=[8];for(_=0;_<8;_++)C[_]=new tc.Point;var At=22e3;var Et=kl[r].AdjVal1==0?16500:kl[r].AdjVal1;var Rt=kl[r].AdjVal2==0?5500:kl[r].AdjVal2;var Lt=Mj(o.right-o.left,Et,At);var Ct=Mj(o.bottom-o.top,Rt,At);C[0].x=C[7].x=o.left;C[0].y=C[7].y=o.top+Ct;C[1].x=C[0].x+Lt;C[1].y=C[0].y;C[2].x=C[1].x;C[2].y=o.top;C[3].x=o.right;C[3].y=o.top+(o.bottom-o.top)/2;C[4].x=C[1].x;C[4].y=o.bottom;C[5].x=C[0].x+Lt;C[5].y=o.bottom-Ct;C[6].x=o.left;C[6].y=o.bottom-Ct;yH(t,m,E,A,C)}}else{if(kl[r].FillPattern>0&&E!=nZ()){var It=o.copy();It.top++;It.left++;if(kl[r].FillOpacity>0){I=kl[r].FillOpacity-1;if(I>255)I=255;BH(t,It,E,I)}else HH(t,E,It)}if(Nj(kl[r].flags&tc.PARA_FRAME_FILL_PICT)&&kl[r].FillPict>0){hG(t,o.left,o.top,o.right-o.left,o.bottom-o.top,kl[r].FillPict,1,-1,true)}if(kl[r].LineWdth>0&&Nj(kl[r].flags&tc.PARA_FRAME_BOXED)){if(Eu)s=DV(kl[r].LineWdth);else s=dV(kl[r].LineWdth);if(Ru&&s<wV(1))s=wV(1);if(s<=0)s=1;if(kl[r].LineOpacity>0){I=kl[r].FillOpacity-1;if(I>255)I=255;GH(t,o,kl[r].LineColor,s,I)}else{if(s>0){F=true;if(Nj(kl[r].flags&tc.PARA_FRAME_DOTTED)){F=false;s=1}A=new tc.Pen(kl[r].LineColor,s);if(!F)A.setDotted();hH(t,o.left,o.top,o.left,o.bottom,A,null);hH(t,o.right,o.top,o.right,o.bottom,A,null)}if(Eu)s=mV(kl[r].LineWdth);else s=hV(kl[r].LineWdth);if(Ru&&s<xV(1))s=xV(1);if(s<=0)s=1;if(s>0){F=true;if(Nj(kl[r].flags&tc.PARA_FRAME_DOTTED)){F=false;s=1}A=new tc.Pen(kl[r].LineColor,s);if(!F)A.setDotted();hH(t,o.left,o.top,o.right,o.top,A,null);hH(t,o.left,o.bottom,o.right,o.bottom,A,null)}}}}return true}function jB(t,e,r,i,f,l,a,n,c){var s=false;var _=false;var o=[];var u,T,A,E,R=0;var L;var C=0,I=0,d=0,F=0,g=1;var P=false;o=kl[i].pSegment;u=kl[i].SegmentCount;if(u==0)return false;if(o==null||o.length<u)return false;if(r==0)return true;if(c){if(Go!=null){var S=e[0].x;var h=e[0].y;var O=e[0].x;var v=e[0].y;for(T=1;T<e.length;T++){if(e[T].x<S)S=e[T].x;if(e[T].y<S)h=e[T].y;if(e[T].x>O)O=e[T].x;if(e[T].y>O)v=e[T].y}C=S-g;I=h-g;d=O-S+2*g;F=v-h+2*g;e0("DrawUserDrawing, ParaFID: "+i.toString());i0("gr.beginPath")}else{t.save();t.beginPath()}}t:{L=e[0];for(T=A=0;T<u;T++){var p=o[T]&65280;var N=o[T]&255;if(N==0)N=1;for(R=0;R<N;R++){if(p==tc.DSEG_MOVE_TO){if(A>=r)break t;if(c){if(Go!=null)i0("gr.moveTo",e[A].x-C,e[A].y-I);else t.moveTo(e[A].x,e[A].y)}A++}else if(p==tc.DSEG_LINE_TO){if(A>=r)break t;if(c){if(Go!=null)i0("gr.lineTo",e[A].x-C,e[A].y-I);else t.lineTo(e[A].x,e[A].y)}A++}else if(p==tc.DSEG_BEZ_TO){if(A+2>=r)break t;if(c){if(Go!=null)i0("gr.bezierCurveTo",e[A].x-C,e[A].y-I,e[A+1].x-C,e[A+1].y-I,e[A+2].x-C,e[A+2].y-I);else t.bezierCurveTo(e[A].x,e[A].y,e[A+1].x,e[A+1].y,e[A+2].x,e[A+2].y)}A+=3}else if(p==tc.DSEG_CLOSE){if(c){if(Go!=null)i0("gr.closePath");else t.closePath()}}else if(p==tc.DSEG_END)break;else if(o[T]>43520)continue;else if(o[T]>43776)continue;else if(o[T]>32768)continue;else break t;if(A>0)L=e[A-1]}}if(c){if(Go!=null)i0("gr.closePath");else{t.closePath();P=true}}if(c){if(f){if(Go!=null&&c){f0('gr.fillStyle="'+l.toString()+'";',true);f0("gr.fill();",true)}else{t.fillStyle=l.toString();t.fill()}}if(a&&n!=null){if(Go!=null&&c){f0('gr.strokeStyle="'+n.color.toString()+'";',true);f0("gr.stroke();",true)}else{t.strokeStyle=n.color.toString();t.stroke()}}}s=true}if(c){if(Go!=null)r0(C,I,d,F);else{if(!P)t.closePath();t.restore()}}return s}function JB(t,e,r,i){var f=new tc.Point;var l=new tc.Point;var a=0,n;if(Math.abs(r)!=0&&Math.abs(r)!=90&&Math.abs(r)!=180&&Math.abs(r)!=270)return f;if(Math.abs(i)!=90&&Math.abs(i)!=180)return f;r=-r;i=-i;if(r<0)r=360+r;n=i>0?90:-90;f=zB(t,e,r,n);a+=n;r+=n;if(a!=i)f=zB(t,e,r,n);return f}function zB(t,e,r,i){var f=e.width;var l=e.height;var a=e.left;var n=a+f;var c=e.top;var s=c+l;var _=new tc.Point;var o=new tc.Point;var u=new tc.Point;if(r==0||r==360){o=new tc.Point(n,c+l/2);if(i>0)_=new tc.Point(a+f/2,c);else _=new tc.Point(a+f/2,s);if(i>0)u=new tc.Point(n,c);else u=new tc.Point(n,s)}else if(r==90){o=new tc.Point(a+f/2,c);if(i>0)_=new tc.Point(a,c+l/2);else _=new tc.Point(n,c+l/2);if(i>0)u=new tc.Point(a,c);else u=new tc.Point(n,c)}else if(r==180){o=new tc.Point(a,c+l/2);if(i>0)_=new tc.Point(a+f/2,s);else _=new tc.Point(a+f/2,c);if(i>0)u=new tc.Point(a,s);else u=new tc.Point(a,c)}else if(r==270){o=new tc.Point(a+f/2,c+l);if(i>0)_=new tc.Point(n,c+l/2);else _=new tc.Point(a,c+l/2);if(i>0)u=new tc.Point(n,s);else u=new tc.Point(a,s)}else return _;t.quadraticCurveTo(u.x,u.y,_.x,_.y);return _}function ZB(t,e,r){var i;var f=new tc.RECT;var l,a,n,c,s;var _;var o;var u;ZU("DrawFootnote");Nl=e;pl[e].SpaceRight=pl[e].SpaceLeft;l=pl[e].x+pl[e].SpaceLeft;s=pl[e].width-pl[e].SpaceLeft-pl[e].SpaceRight;if(!r)l+=Le;a=pl[e].y;if(r){f.left=l;if(Ci)f.right=f.left+s;else f.right=Ft+je;f.top=pl[e].y;f.bottom=f.top+pl[e].height;_=fA;fA=nZ();gG(t,f.left,f.top,f,null,0,null,0);fA=_;c=hV(tc.FNOTE_MARGIN)}else c=mV(tc.FNOTE_MARGIN);a+=c;u=ui[pl[e].PageFirstLine].page;for(i=pl[e].PageFirstLine;i<=pl[e].PageLastLine;i++){if(i>=Ri)break;if(ui[i].page!=u)continue;if(Nj(ui[i].flags&tc.LFLAG_FNOTETEXT))a+=Rz(t,l,a,i,G5(i),r,true)}if(null==(o=new tc.Pen(new tc.Color(12632256))))return true;n=pl[Nl].y+c/2;if(HX())hH(t,l+s,n,l+s*2/3,n,o,null);else hH(t,l,n,l+s/3,n,o,null);o.Dispose();n=pl[Nl].y+pl[Nl].height-c/2;if(r&&!Ci)RH(t,l,n,pl[Nl].x+pl[Nl].width,n,tc.Color.black);return true}function QB(t,e,r,i,f,l,a,n){var c=0;var s,_=0,o,u,T,A,E,R;var L,C,I,d=0,F=0;var g=false;var P=[tc.MAX_WIDTH+1];nO|=tc.TOFLAG2_DRAW_FNOTE;while(_<f){o=_;u=-1;E=0;if(d>0)E=F;while(true){if(true||Nj(cc)){T=cc[o];A=a?wV(T):T}else T=Gx(dc[o],false,wn[o]);P[o-_]=T;if(d==0&&!g)F+=T;if(wn[o]==tc.SPACE)g=true;if(wn[o]!=Bn&&wn[o]!=tc.LINE_CHAR&&E+A<l&&o-_<tc.MAX_WIDTH&&o+1<f){if(wn[o]==tc.SPACE)u=o;E+=A;o++;continue}d++;if(u>=0&&E+A>l)o=u;R=o-_+1;L=i$(lV(wn,_,R),lV(dc,_,R),R,false);C=pd;I=Nd;if(a)c+=yV(L);else c+=L;if(!n)break;aO|=tc.TOFLAG_FNOTE_FRAME;Fc=lV(dc,_);Bt=e;if(Nj(ui[i].flags2&tc.LFLAG2_RTL)){ii=true;var S;vf=Gq(-1,P,R,pl[Nl].SpaceLeft,lV(wn,_,R),lV(dc,_,R),-1);S=Dd;pf=S;Nf=0}if(a){gc=[R+1];if(Nj(gc)){for(s=0;s<R;s++){gc[s]=P[s]}}i$(lV(wn,_,R),lV(dc,_,R),R,true);C=pd;I=Nd;if(d>1)Bt+=bV(F);dG(t,0,r,yV(L),C,lV(wn,_,R),R,i,false,tc.CHAR_T);r+=yV(L);gc=null}else{var h=0;if(d>1)Bt+=F;p0(i,t,Bt,r,lV(wn,_,R),lV(dc,_,R),R,L,C,null,ui[i].pfmt,0,0,I,Nl,Le,ko,P,false,0,0,r,h);r+=L}if(Nj(ui[i].flags2&tc.LFLAG2_RTL)){ii=false;vf=null;pf=Nf=0}oj(tc.TOFLAG_FNOTE_FRAME);break}_=o+1}uj(tc.TOFLAG2_DRAW_FNOTE);return c}function qB(t,e,r,i,f,l){var a;a=ui[r].pfmt;if(dS&&Nj(ui[r].flags&tc.LFLAG_PARA_FIRST)&&Nj(Nc[a].flags&tc.PARA_KEEP_NEXT)&&ui[r].cid==0&&ui[r].fid==0){var n;var c=new tc.RECT;c.left=i-10;c.top=f+l/2;c.right=c.left+4;c.bottom=c.top+5;HH(t,tc.CLR_BLACK,c);c.left=i+pl[e].width+10;if(Ci){n=pl[e].sect;c.left-=(to[n].LeftMargin+to[n].RightMargin)*Nt}c.right=c.left+4;HH(t,tc.CLR_BLACK,c)}return true}function $B(t,e,r,i,f,l){var a;var n=0;var c,s,_,o,u,T=0,A,E=0;var R;var L;ZU("DrawSectLineNbr");o=pl[Nl].sect;c=to[o].flow;if(c==tc.FLOW_DEF)c=mr;if(c==tc.FLOW_DEF)c=tc.FLOW_LTR;if(c==tc.FLOW_RTL&&l)return true;if(c==tc.FLOW_LTR&&!l)return true;_=so+e+1;u=to[o].LineStep;if(u<=0||_%u>0)return true;a=mY(_);if(R=HX())L=tc.ETO_RTLREADING;else L=0;XG(t,n,tc.CHAR_T);A=a.length;var C=Uk(a);for(s=0;s<A;s++)T+=Gx(n,!Eu,C[s]);if(c==tc.FLOW_LTR){r-=Eu?DV(tc.SECT_LINE_DIST):dV(tc.SECT_LINE_DIST);r-=T}else{r+=Eu?DV(tc.SECT_LINE_DIST):dV(tc.SECT_LINE_DIST);if(!Eu&&c==tc.FLOW_RTL&&Ci)r-=to[o].RightMargin*Nt}if(Eu)i=i+f-Xs[n].BaseHeight+Xs[n].BaseHeightAdj;else i=i+f-xs[n].BaseHeight+xs[n].BaseHeightAdj;i+=ce;if(false&&ii&&Nj(vf)){var I;I=SJ(t,V,a);r=E$(r,I.cx,Nl,new tc.ClsLineSeg)}iJ(t,r,i,L,null,Uk(a),A,null);return true}function tH(t){var e,r,i,f=-1;var l,a,n,c;if(pl[t].empty)return-1;if(Nj(pl[t].flags&tc.FRAME_DISABLED))return-1;if(pl[t].ParaFrameId>0)return-1;if(pl[t].CellId>0)return-1;r=pl[t].PageFirstLine;if(Nj(Nc[ui[r].pfmt].flags&tc.PAGE_HDR_FTR))return-1;a=pl[t].sect;if(Dj(to[a].flags&tc.SECT_LINE))return-1;l=ui[r].page;i=po[l].FirstLine;c=G5(i);for(e=i;e<=po[l].LastLine;e++){if(ui[e].page!=l)continue;if(ui[e].cid>0)continue;if(ui[e].fid>0)continue;if(Nj(Nc[ui[e].pfmt].flags&tc.PAGE_HDR_FTR))continue;if(e>r)break;if(c!=a){n=G5(e);if(Dj(to[n].flags&tc.SECT_LINE)){f=-1;continue}}f++}return f}function eH(t,e,r,i){var f=45;ZU("DrawTrackingLine");if(Nj(eO&tc.TFLAG7_NO_TRACK_CHANGE_LINE))return true;if(Q_)return true;if(!Eu&&!Ci)f=0;e-=Eu?DV(f):dV(f);hH(t,e,r,e,r+i,new tc.Pen(1,tc.Color.black),null);return true}function rH(t,e,r,i){var f=45;ZU("DrawLeftLine");if(!Eu&&!Ci)f=0;e-=Eu?DV(f):dV(f);hH(t,e,r,e,r+i,new tc.Pen(1,tc.Color.black),null);return true}function iH(t){var e,r,i,f,l,a,n;var c,s,_;if(!oi.PageMode||oi.FittedView)return true;if(!Ci&&!Eu)return true;if(rc<0||ic<0)return true;l=0;c=null;s=null;_=null;a=0;for(f=0;f<2;f++){for(i=0;i<Vn;i++){Yn[i].flags=cj(Yn[i].flags,tc.FSTORY_DRAWN);if(Yn[i].text==null)continue;n=Yn[i].line;if(n<0||n>=Ri)continue;if(ui[n].page<qe||ui[n].page>$e)continue;if(f==0)l++;else{c[a]=Yn[i].y1;s[a]=Yn[i].x1;_[a]=i;a++;Yn[i].flags=cj(Yn[i].flags,tc.FSTORY_FORMATTED)}}if(f==0){if(l==0)break;c=[l+1];s=[l+1];_=[l+1];a=0}else{for(e=0;e<l;e++){for(r=e+1;r<l;r++){var o=false;if(c[r]<c[e])o=true;else if(c[r]==c[e]&&s[r]<s[e])o=true;if(o){var u=s[e];var T=c[e];var A=_[e];s[e]=s[r];c[e]=c[r];_[e]=_[r];s[r]=u;c[r]=T;_[r]=A}}}}}if(l==0)return true;nH(t,_,l);fH(t,_,l);return true}function fH(t,e,r){var i,f,l,a,n,c,s;var _;var o;var u=null;l=Eu?DV(tc.RULER_TOLERANCE):dV(tc.RULER_TOLERANCE);u=new tc.Pen(Zn);o=iA;iA=tc.CLR_BLACK;for(i=0;i<r;i++){f=e[i];if(Nj(Yn[f].flags&tc.FSTORY_SKIP))continue;_=VY(Yn[f].x,Yn[f].y,Yn[f].x+Yn[f].width,Yn[f].y+Yn[f].height);HH(t,zn,_);if(Dj(Yn[f].flags&tc.FSTORY_TEXT_POS_SET)&&!Eu){var T=0,A=0;_i.TerTextPosToPix(tc.REL_TEXT_BOX,Yn[f].line,Yn[f].col);T=td;A=ed;Yn[f].x1=T+Ft;Yn[f].y1=A+Gt}RH(t,Yn[f].x1,Yn[f].y1,Yn[f].RightMargX,Yn[f].y1,Zn);a=Yn[f].y;n=Yn[f].y+Yn[f].height+l;s=Yn[f].y1;if(s>=a&&s<=n){if(s>=a-2*l)c=s-2*l;else c=s}else if(s>n)c=n-2*l;else c=a+2*l;hH(t,Yn[f].RightMargX,s,Yn[f].x,c,u,null);if(Nj(Yn[f].flags&tc.FSTORY_VERT))aH(t,f);else lH(t,f);MH(t,u,_.left,_.top,_.right+2-_.left,_.bottom+1-_.top);Yn[f].flags|=tc.FSTORY_DRAWN}iA=o;u.Dispose();return true}function lH(t,e){var r;var i,f,l,a,n=0,c,s,_;var o=0;var u=0;var T=Yn[e].FontId,A;var E="";var R=null;var L;r=Eu?DV(tc.RULER_TOLERANCE):dV(tc.RULER_TOLERANCE);if(Eu)n=Xs[T].height;else n=xs[T].height;l=Yn[e].y;a=Yn[e].TextWidth;L=fA;fA=zn;T=$x(t,e,true);XG(t,T,gk("N"));E="["+Yn[e].AuthorInit+Yn[e].num.toString()+"]: ";var C=Uk(E);iJ(t,Yn[e].x+r,l,0,null,C,E.length,null);_=Yn[e].NumPixLen;A=_;c=0;T=Yn[e].FontId;XG(t,T,gk("N"));var I=Uk(Yn[e].text);var d;if(Yn[e].StoryLines.length>0&&Yn[e].InPrinting==Eu){var F=Yn[e].StoryLines.length;for(i=0;i<F;i++){if(Yn[e].StoryLines[i]==null)continue;f=Yn[e].x+r;if(i==0)f+=A;s=Yn[e].StoryLines[i].length;d=Uk(Yn[e].StoryLines[i]);iJ(t,f,l,0,null,d,s,null);l+=n}}else{while((s=uH(t,Yn[e].text,c,T,a))>0){o=qI;u=$I;var g="";g=cV(Yn[e].text,c,s);if(A+o>a&&A>0){l+=n;A=0}f=Yn[e].x+r+A;d=Uk(g);iJ(t,f,l,0,null,d,s,null);A+=u;c+=s;if(s>0&&(I[c-1]==13||I[c-1]==10||I[c-1]==Bn)){l+=n;A=0}}}fA=L;return true}function aH(t,e){var r;var i,f,l,a=0,n,c,s;var _=0;var o=0;var u=Yn[e].FontId,T;var A="";var E=null;var R;var L=new tc.RECT;r=Eu?DV(tc.RULER_TOLERANCE):dV(tc.RULER_TOLERANCE);if(Eu)a=Xs[u].height;else a=xs[u].height;i=Yn[e].x+Yn[e].width;l=Yn[e].TextWidth;R=fA;fA=zn;u=$x(t,e,true);XG(t,u,gk("N"));A="["+Yn[e].AuthorInit+Yn[e].num.toString()+"]: ";var C=Uk(A);L.left=i-a;L.right=i;L.top=Yn[e].y+r;L.bottom=L.top+Yn[e].NumPixLen;iJ(t,i,Yn[e].y+r,0,L,C,A.length,null);s=Yn[e].NumPixLen;T=s;n=0;u=Yn[e].FontId;XG(t,u,gk("N"));var I=Uk(Yn[e].text);var d=[];if(Yn[e].StoryLines.length>0&&Yn[e].InPrinting==Eu){var F=Yn[e].StoryLines.length;for(line=0;line<F;line++){if(Yn[e].StoryLines[line]==null)continue;f=Yn[e].y+r;if(line==0)f+=T;c=Yn[e].StoryLines[line].length;d=Uk(Yn[e].StoryLines[line]);L.left=i-a;L.right=i;L.top=f;L.bottom=L.top+Yn[e].height;iJ(t,i,f,0,L,d,c,null);i-=a}}else{while((c=uH(t,Yn[e].text,n,u,l))>0){_=qI;o=$I;var g="";g=cV(Yn[e].text,n,c);if(T+_>l&&T>0){i-=a;T=0}f=Yn[e].y+r+T;d=Uk(g);L.left=i-a;L.right=i;L.top=f;L.bottom=L.top+o;iJ(t,i,f,0,L,d,c,null);T+=o;n+=c;if(c>0&&(I[n-1]==13||I[n-1]==10||I[n-1]==Bn)){i-=a;T=0}}}fA=R;return true}function nH(t,e,r){var i,f,l,a,n,c,s,_,o;var u="";var T;var A,E;for(a=0;a<r;a++){n=e[a];Yn[n].flags=cj(Yn[n].flags,tc.FSTORY_SKIP);c=Yn[n].line;Yn[n].page=f=ui[c].page;Yn[n].sect=_=po[f].TopSect;o=to[_].RightMargin*1440;Yn[n].flags=cj(Yn[n].flags,tc.FSTORY_VERT);if(o<fc)Yn[n].flags|=tc.FSTORY_VERT;Yn[n].FontId=$x(t,n,false);if(Yn[n].FontId<0)Yn[n].FontId=0;i=1;for(l=1;l<Vn;l++){if(Yn[l].line<Yn[n].line)i++;else if(Yn[l].line==Yn[n].line&&Yn[l].col<Yn[n].col)i++;else if(Yn[l].line==Yn[n].line&&Yn[l].col==Yn[n].col&&Nj(Yn[l].flags&tc.FSTORY_FORMATTED))i++}Yn[n].num=i;u="["+Yn[n].AuthorInit+i.toString()+"]: ";s=$x(t,n,true);XG(t,s,gk("N"));A=Eu?Xs[s].font:xs[s].font;T=SJ(t,A,u);Yn[n].NumPixLen=T.cx;if(Nj(Yn[n].flags&tc.FSTORY_VERT))cH(t,n);else _H(t,n);Yn[n].flags|=tc.FSTORY_FORMATTED}for(f=qe;f<=$e;f++){var R,L,C,I,d,F,g,P=0;var S,h,O,v,p,N,D=0,M,G;_=po[f].TopSect;P=Eu?DV(tc.RULER_TOLERANCE):dV(tc.RULER_TOLERANCE);if(Eu){L=PT;F=(eo[_].PgWidth-to[_].LeftMargin-to[_].RightMargin)*1440;F=DV(F);L+=F+P;C=ST+P;o=DV(to[_].RightMargin*1440);I=L+o-DV(360);g=mV(eo[_].PgHeight*1440-720);d=C+g-P}else{L=I=C=d=-1;for(R=f==qe?0:Qe;R<Dl;R++){if(f==qe&&R>=Qe)break;if(Nj(pl[R].flags&tc.FRAME_BORDER_TOP))C=pl[R].y+pl[R].height+P;else if(Nj(pl[R].flags&tc.FRAME_BORDER_BOT))d=pl[R].y-P;else if(Nj(pl[R].flags&tc.FRAME_BORDER_RIGHT)){I=pl[R].x-P-dV(360);o=dV(to[_].RightMargin*1440);L=pl[R].x-o+P}}if(L<0||I<0||C<0||d<0){C=0;d=eo[_].PgHeight*1440-720;d=hV(d);I=eo[_].PgWidth*1440-360;I=dV(I);o=dV(to[_].RightMargin);L=dV(L);L-=o;L+=P}}N=-1;for(a=0;a<r;a++){n=e[a];if(Yn[n].page!=f)continue;if(N<0)N=a;Yn[n].flags=cj(Yn[n].flags,tc.FSTORY_OVERFLOW);if(Nj(Yn[n].flags&tc.FSTORY_VERT)){var B=I-L;Yn[n].x=L}else Yn[n].x=L;Yn[n].RightMargX=L-P;O=Yn[n].y1;v=Yn[n].height2;if(a==N){p=O-C;if(p<v)Yn[n].y=C;else Yn[n].y=O-Yn[n].height2;D=Yn[n].y+Yn[n].height2;Yn[n].AvailSpace=Yn[n].y-C;continue}if(O-D>v){Yn[n].y=O-v;Yn[n].AvailSpace=O-D-v;D=Yn[n].y+Yn[n].height2;continue}v=v-(O-D);for(h=a-1;h>=N;h--){var H;S=e[h];if(Yn[S].AvailSpace>=v){H=v;Yn[S].y-=v;Yn[S].AvailSpace-=v;v=0}else{H=Yn[S].AvailSpace;v-=Yn[S].AvailSpace;Yn[S].y-=Yn[S].AvailSpace;Yn[S].AvailSpace=0}for(M=h+1;M<a;M++){G=e[M];Yn[G].y-=H}if(v==0)break}if(v<=0){Yn[n].y=O-Yn[n].height2;Yn[n].AvailSpace=0;D=O}else{Yn[n].y=O-Yn[n].height2+v;Yn[n].AvailSpace=0;D=Yn[n].y+Yn[n].height2;if(Yn[n].y>d)Yn[n].flags|=tc.FSTORY_OVERFLOW}}}return true}function cH(t,e){var r,i,f,l,a,n,c;var s=Yn[e].FontId;var _;var o=1440*5/4,u=1440/2;if(Yn[e].StoryLines.length>0&&Yn[e].InPrinting==Eu)return true;a=Yn[e].sect;r=to[a].RightMargin*1440;r-=3*tc.RULER_TOLERANCE+360/2;if(Eu){r=DV(r);_=Xs[s].height}else{r=dV(r);_=xs[s].height}if(r<_){Yn[e].flags|=tc.FSTORY_SKIP;return true}i=eo[a].PgHeight*1440-720;if(Eu)i=mV(i);else i=hV(i);l=Eu?mV(o):hV(o);c=-1;while(true){n=oH(t,e,l);if(n<=r)break;if(n>=c&&c!=-1)break;c=n;if(Eu)l+=DV(u);else l+=dV(u)}Yn[e].TextWidth=l;Yn[e].TextHeight=n;f=Eu?DV(tc.RULER_TOLERANCE):dV(tc.RULER_TOLERANCE);Yn[e].width=n;Yn[e].height=l+2*f;Yn[e].height2=Yn[e].height+2*f;return true}function sH(){var t;for(t=1;t<Vn;t++)Yn[t].StoryLines=[];return true}function _H(t,e){var r,i,f,l,a;var n=Yn[e].FontId;var c;if(Yn[e].StoryLines.length>0&&Yn[e].InPrinting==Eu)return true;l=Yn[e].sect;r=eo[l].PgHeight*1440;r-=3*tc.RULER_TOLERANCE+720;if(Eu){r=mV(r);c=Xs[n].height}else{r=hV(r);c=xs[n].height}if(r<c){Yn[e].flags|=tc.FSTORY_SKIP;return true}f=to[l].RightMargin*1440-3*tc.RULER_TOLERANCE-360;if(Eu)f=DV(f);else f=dV(f);a=oH(t,e,f);if(a>r)a=r;Yn[e].TextWidth=f;Yn[e].TextHeight=a;i=Eu?DV(tc.RULER_TOLERANCE):dV(tc.RULER_TOLERANCE);Yn[e].width=f+2*i;Yn[e].height=a;Yn[e].height2=Yn[e].height+2*i;return true}function oH(t,e,r){var i=0,f=0,l,a,n;var c=0;var s=0;var _=Yn[e].FontId,o;var u=[];var T=0;if(Eu)f=Xs[_].height;else f=xs[_].height;Yn[e].StoryLineHt=f;Yn[e].InPrinting=Eu;i=f;n=Yn[e].NumPixLen;o=n;l=0;var A=Uk(Yn[e].text);u[T]="";while((a=uH(t,Yn[e].text,l,_,r))>0){c=qI;s=$I;var E="";E=cV(Yn[e].text,l,a);if(o+c>r&&o>0){i+=f;o=0;T++;u[T]=""}u[T]+=E;o+=s;l+=a;if(a>0&&(A[l-1]==13||A[l-1]==10||A[l-1]==Bn)){i+=f;o=0;T++;u[T]=""}}Yn[e].StoryLines=u;return i}function uH(t,e,r,i,f){var l,a,n=0,c=ui.length,s=0,_=0,o=0;var u=false;var T;var A="";qI=$I=0;var E=Uk(e);for(l=0;l<2;l++){n=o=0;u=false;for(a=r;a<c&&n<100;a++,n++){var R=E[a];if(R==13||R==Bn){n++;if(a+1<c&&E[a+1]==10)n++;break}if(u){if(R!=tc.SPACE)break}else if(R==tc.SPACE)u=true;if(!u){o++;if(l==1){A=cV(e,r,o);T=SJ(t,Eu?Xs[i].font:xs[i].font,A);if(T.cx>f&&o>1){o--;break}}}}if(n==0){s=_=0;break}A=cV(e,r,o);T=SJ(t,Eu?Xs[i].font:xs[i].font,A);s=T.cx;A=cV(e,r,n);T=SJ(t,Eu?Xs[i].font:xs[i].font,A);_=T.cx;if(l==0&&s>f)continue;else break}qI=s;$I=_;return n}function TH(t){return true}function AH(){var t,e="";var r;var i=false;var f=hS||tg.InIE;if(!rp())return true;if(SO)return true;if(tg.EvalMsgShown&&!tg.expired)return true;PO++;SO=true;r=S;i=Li;t="";if(!tg.expired)t+="License key not set! TE Edit Component, v28 for HTML is now running in the demo mode.\n\n";t+="Please visit our web site: www.subsystems.com to purchase a suitable license.\n";t+="\n";t+="If you have already purchased a license for this product, please install the license key on your web site. \n";t+="\n";t+="Thank you.";t+="\n";t+="\n";if(tg.expired&&tg.LicenseYYMM>0){e="License Expired on year: "+mY(Math.floor(2e3+tg.LicenseYYMM/100))+", month: "+mY(tg.LicenseYYMM%100)+", Please visit:  WWW.SUBSYSTEMS.COM"}else{if(tg.EvalDaysUsed>0){if(tg.expired)e="***** EVALUATION EXPIRED *******";else e="EVALUATION DAY(S) REMAINING: "+mY(tg.EvalDaysRemaining)}else e="Evaluation Message"}if(Dj(tO&tc.TFLAG6_IN_TEST_MODE))qk(t,e);SO=false;tg.EvalMsgShown=true;return!tg.expired}function EH(t,e,r){if(r==undefined)r=t.font;var i=r+e;var f=tg.MeasureTextStr.indexOf(i);if(f>=0)return tg.MeasureTextObj[f];var l=t.measureText(e);tg.MeasureTextStr.push(i);tg.MeasureTextObj.push(l);return l}function RH(t,e,r,i,f,l){var a=3,n=40;var c,s,_;var o,u;var T=false,A=false;var E=true;if(!Eu){var R=new tc.Pen(l);R.setDotted();return _J(t,R,e,r,i,f)}if(Eu){e=Math.round(e);i=Math.round(i);r=Math.round(r);f=Math.round(f)}else{e=Math.round(e-Ft+rt.left);i=Math.round(i-Ft+rt.left);r=Math.round(r-Gt+rt.top);f=Math.round(f-Gt+rt.top)}u=f-r;o=i-e;if(i<e){_=e;e=i;i=_;A=true}if(f<r){_=r;r=f;f=_;T=true}c=i-e;s=f-r;if(c<=0)c=1;if(s<=0)s=1;var L=null;var C=null;var I=null;if(Eu){C=document.createElement("canvas");I=C.getContext("2d");C.width=c+1;C.height=s+1;L=I.getImageData(0,0,c,s)}else L=t.getImageData(e,r,c,s);var d=L.data;var F=0,g,P;for(g=0;g<s;g++){F=g*(c*4);for(P=0;P<c;P++){var S=false;var h=T?s-g:g;var O=A?c-P:P;S=O*u==h*o;if(S){if(!E){d[F]=l.red;d[F+1]=l.green;d[F+2]=l.blue;d[F+3]=255}E=!E}F+=4}}L.data=d;if(Eu){I.putImageData(L,0,0);if(Go==null)t.drawImage(C,e,r);else{var v=C.toDataURL("image/png");Q$(v,e,r)}}else t.putImageData(L,e,r);return true}function LH(t,e,r,i,f,l){var a=3,n=40;var c,s,_;var o,u;var T=false,A=false;var E=true;e=Math.round(e-Ft+rt.left);i=Math.round(i-Ft+rt.left);r=Math.round(r-Gt+rt.top);f=Math.round(f-Gt+rt.top);u=f-r;o=i-e;if(i<e){_=e;e=i;i=_;A=true}if(f<r){_=r;r=f;f=_;T=true}c=i-e;s=f-r;if(c<=0)c=1;if(s<=0)s=1;var R=t.getImageData(e,r,c,s);var L=R.data;var C=0,I,d;for(I=0;I<s;I++){C=I*(c*4);for(d=0;d<c;d++){var F=false;var g=T?s-I:I;var P=A?c-d:d;F=P*u==g*o;if(F){if(!E){L[C]=l.red;L[C+1]=l.green;L[C+2]=l.blue}E=!E}C+=4}}R.data=L;t.putImageData(R,e,r);return true}function CH(t,e,r,i,f,l,a){if(a!=undefined&&a&&t.setLineDash!=undefined){t.save();t.setLineDash([1,4])}var n=t.strokeStyle;t.strokeStyle=l.toString();var c=t.lineWidth;t.lineWidth=1;t.beginPath();t.moveTo(Math.round(e)+.5,Math.round(r)+.5);t.lineTo(Math.round(i)+.5,Math.round(f)+.5);t.closePath();t.stroke();t.strokeStyle=n;t.lineWidth=c;if(a!=undefined&&a&&t.setLineDash!=undefined)t.restore()}function IH(t,e,r,i,f,l,a){var n=3,c=40;var s,_,o;var u,T;var A=false,E=false;var R=true;if(a==undefined)a=false;if(a){e=Math.round(e-Ft+rt.left);i=Math.round(i-Ft+rt.left);r=Math.round(r-Gt+rt.top);f=Math.round(f-Gt+rt.top)}else{e=Math.round(e);i=Math.round(i);r=Math.round(r);f=Math.round(f)}T=f-r;u=i-e;if(i<e){o=e;e=i;i=o;E=true}if(f<r){o=r;r=f;f=o;A=true}s=i-e;_=f-r;if(s<=0)s=1;if(_<=0)_=1;var L=t.getImageData(e,r,s,_);var C=L.data;var I=0,d,F;for(d=0;d<_;d++){I=d*(s*4);for(F=0;F<s;F++){var g=false;var P=A?_-d:d;var S=E?s-F:F;g=S*T==P*u;if(g){C[I]=l.red;C[I+1]=l.green;C[I+2]=l.blue}I+=4}}L.data=C;t.putImageData(L,e,r);return true}function dH(t,e,r,f,l,a){var n,c,s=0,_;var o=true;t:{if(Ie==0&&!ii)break t;if(ii){e=E$(e,0,Nl,Nj(vf)?vf[Nf]:new tc.ClsLineSeg);f=E$(f,0,Nl,Nj(vf)?vf[Nf]:new tc.ClsLineSeg)}if(Ie!=0){var u,T;u=g$(e,r,Nl);T=P$(e,r,Nl);e=u;r=T;u=g$(f,l,Nl);T=P$(f,l,Nl);f=u;l=T}}if(r!=l)o=false;var A=null;if(o){if(e>f){e=WY(e,f);f=JC}e=Math.floor(e);f=Math.floor(f);_=0;A=[];for(n=e;n<=f;n++,s++){A[n-e]=new tc.Point;A[n-e].x=n;A[n-e].y=r+_;_=s%4;if(_==2)_=0;else if(_==3)_=-1}}else{if(r>l){r=WY(r,l);l=JC}_=0;A=[l-r+1];for(i=0;i<l-r+1;i++)A[i]=new tc.Point;for(c=r;c<=l;c++,s++){A[c-r].x=e+_;A[c-r].y=c;_=s%4;if(_==2)_=0;else if(_==3)_=-1}}if(A!=null){RJ(t,new tc.Pen(a),A,false)}return true}function FH(t,e,r,i,f){var l=new tc.Pen(tc.Color.black);l.setLightDotted();_J(t,l,e,r,i,f);return true}function gH(t,e,r,i,f){var l=new tc.Pen(tc.Color.black);l.setDarkDotted();_J(t,l,e,r,i,f);return true}function PH(t,e,r,i,f,l,a){hH(t,e,r,i,r,l,null);hH(t,e,f,i,f,a,null);hH(t,e,r,e,f,l,null);hH(t,i,r,i,f,a,null);return true}function SH(t,e,r,i,f){var l=new tc.Brush(i);sJ(t,e,r,l,new tc.Point(f.left,f.top));l.Dispose();return 1}function hH(t,e,r,i,f,l,a){var n=t.shadowColor;if(Nj(a))t.shadowColor=a.color.toString();OH(t,l,e,r,i,f);t.shadowColor=n;if(false&&Nj(a)){if(l==a){if(e==i)e=i=e+1;if(r==f)r=f=r+1}else{e++;i++;r++;f++}OH(t,a,e,r,i,f)}return true}function OH(t,e,r,i,f,l){var a,n,c,s;if((tg.OSCanRotate||Ie==0)&&!ii){if(Go!=null)$$(e,r,i,f,l);else _J(t,e,r,i,f,l);return}if(ii){r=E$(r,0,Nl,Nj(vf)?vf[Nf]:new tc.ClsLineSeg);f=E$(f,0,Nl,Nj(vf)?vf[Nf]:new tc.ClsLineSeg)}if(tg.OSCanRotate){a=r;c=i;n=f;s=l}else{a=g$(r,i,Nl);c=P$(r,i,Nl);n=g$(f,l,Nl);s=P$(f,l,Nl)}if(Go!=null)$$(e,a,c,n,s);else _J(t,e,a,c,n,s)}function vH(t,e,r,i){EJ(t,e,i)}function pH(t){t.save()}function NH(t){t.restore()}function DH(t,e,r,i,f,l,a,n){var c=new tc.Color(l.getRed(),l.getGreen(),l.getBlue(),n);var s=new tc.Pen(a,c);OH(t,s,e,r,i,f)}function MH(t,e,r,i,f,l){uJ(t,e,new tc.Rectangle(r,i,f,l))}function GH(t,e,r,i,f){var l=new tc.Color(r.getRed(),r.getGreen(),r.getBlue(),f);var a=new tc.Pen(i,l);MH(t,a,e.left,e.top,e.right-e.left,e.bottom-e.top)}function BH(t,e,r,i){var f=new tc.Color(r.getRed(),r.getGreen(),r.getBlue(),i);var l=t.fillStyle;t.fillStyle=f.toString();t.fillRect(e.left,e.top,e.right-e.left,e.bottom-e.top);t.fillStyle=l}function HH(t,e,r){if(Go!=null)q$(r.left,r.top,r.right-r.left,r.bottom-r.top,e);else{var i=t.fillStyle;t.fillStyle=e.toString();t.fillRect(r.left,r.top,r.right-r.left,r.bottom-r.top);t.fillStyle=i}}function mH(t,e,r,i,f){if(e){var l=new tc.Brush(r);TJ(t,l,f.left,f.top,f.right-f.left,f.bottom-f.top);l.Dispose()}if(i!=null)AJ(t,i,f.left,f.top,f.right-f.left,f.bottom-f.top)}function wH(t,e,r,i,f,l,a){var n=false;if(e==null)return;var c=r.copy();var s=null;var _=0,o=0;if(Go!=null){s=document.createElement("canvas");s.width=c.right-c.left;s.height=c.bottom-c.top;_=c.left;o=c.top;c.adjust(-_,-o);i-=_;f-=o;l-=_;a-=o;t=s.getContext("2d")}var u=c.left+(c.right-c.left)/2;var T=c.top+(c.bottom-c.top)/2;var A=bH(u,T,i,f);var E=bH(u,T,l,a);var R=E-A;if(R<0)R+=360;var L=t.strokeStyle;t.strokeStyle=e.color.toString();var C=t.lineWidth;t.lineWidth=e.width;t.beginPath();t.moveTo(i,f);bounds=new tc.Rectangle(c.left,c.top,c.right-c.left,c.bottom-c.top);JB(t,bounds,-A,-R);t.stroke();t.closePath();t.strokeStyle=L;t.lineWidth=C;if(Go!=null){var I=s.toDataURL("image/png");Q$(I,_,o)}}function bH(t,e,r,i){var f,l;var a;f=r-t;l=e-i;if(f==0){if(l>=0)a=90;else a=-90}else a=Math.atan2(l,f)*180/tc.PI;if(a<0)a+=360;return a}function xH(t,e,r,i,f,l,a){if(e){KH(t,f.left,f.top,f.right-f.left,f.bottom-f.top,r,l,a)}if(i!=null){XH(t,f.left,f.top,f.right-f.left,f.bottom-f.top,i.color,i.thick,l,a)}}function yH(t,e,r,i,f){if(e){var l=new tc.Brush(r);EJ(t,l,f);l.Dispose()}if(i!=null)RJ(t,i,f)}function WH(t,e,r,i,f,l){var a=r+f;var n=i+l;return t>=r&&t<a&&e>=i&&e<n}function UH(t,e,r,i,f,l){var a=null;var n=e-i,c=r-i;if(l==undefined)l=JV(1);if(Go!=null){a=document.createElement("canvas");a.width=width;a.height=height;t=a.getContext("2d");e=r=i}t.beginPath();t.arc(e,r,i,0,2*Math.PI,false);t.closePath();var s=t.strokeStyle;var _=t.lineWidth;t.lineWidth=l;t.strokeStyle=f;t.stroke();t.lineWidth=_;t.strokeStyle=s;if(Go!=null){var o=a.toDataURL("image/png");Q$(o,n,c)}}function kH(t,e,r,i,f){var l=null;var a=e-i,n=r-i;if(Go!=null){l=document.createElement("canvas");l.width=width;l.height=height;t=l.getContext("2d");e=r=i}t.beginPath();t.arc(e,r,i,0,2*Math.PI,false);t.closePath();var c=t.fillStyle;t.fillStyle=f;t.fill();t.fillStyle=c;if(Go!=null){var s=l.toDataURL("image/png");Q$(s,a,n)}}function XH(t,e,r,i,f,l,a,n,c){var s=null;var _=e,o=r;if(Go!=null){s=document.createElement("canvas");s.width=i;s.height=f;t=s.getContext("2d");e=r=0}YH(t,e,r,i,f,n,c);var u=t.strokeStyle;var T=t.lineWidth;t.strokeStyle=l;t.lineWidth=a;t.stroke();t.lineWidth=T;t.strokeStyle=u;if(Go!=null){var A=s.toDataURL("image/png");Q$(A,_,o)}}function KH(t,e,r,i,f,l,a,n){var c=null;var s=e,_=r;if(Go!=null){c=document.createElement("canvas");c.width=i;c.height=f;t=c.getContext("2d");e=r=0}YH(t,e,r,i,f,a,n);var o=t.fillStyle;t.fillStyle=l;t.fill();t.fillStyle=o;if(Go!=null){var u=c.toDataURL("image/png");Q$(u,s,_)}}function YH(t,e,r,i,f,l,a){if(typeof l==="undefined")l=i/25;if(typeof a==="undefined")a=f/25;t.beginPath();t.moveTo(e+l,r);t.lineTo(e+i-l,r);t.quadraticCurveTo(e+i,r,e+i,r+a);t.lineTo(e+i,r+f-a);t.quadraticCurveTo(e+i,r+f,e+i-l,r+f);t.lineTo(e+l,r+f);t.quadraticCurveTo(e,r+f,e,r+f-a);t.lineTo(e,r+a);t.quadraticCurveTo(e,r,e+l,r);t.closePath()}_i.TerEnableRefresh=function(t){if(!lv||!QD())_i.TerCreateControl();si=t;return true};_i.TerSetDefBkColor=function(t,e){if(!lv||!QD())_i.TerCreateControl();if(t==jT)return true;jT=tA=t;if(e)_i.TerRepaint(true);return true};_i.TerSetBorderColor=function(t){if(typeof t=="string")t=yK(t);tA=QT=t;_i.TerRepaint(true);return true};_i.TerSetBorderLineColor=function(t){return _i.TerSetBorderLineColor(yK(t))};_i.TerSetBorderLineColor=function(t){qT=t;_i.TerRepaint(true);return true};_i.TerSetStatusColor=function(t,e){return _i.TerSetStatusColor(yK(t),yK(e))};_i.TerSetStatusColor=function(t,e){var r;if(!lv||!QD())_i.TerCreateControl();if(t==undefined)t="#000000";if(e==undefined)e="#ffffff";t=yK(t);e=yK(e);ZT=t;zT=e;nA=new tc.Brush(zT);cA=zT;if(WA!=null)_i.TerRecreateToolbar(true);if(UA!=null)UA.repaint();ai=true;_i.TerRepaint(true);return true};_i.TerGetBufferGr=function(){if(!lv||!QD())_i.TerCreateControl();return et};_i.TerSetCtlColor=function(t,e){if(!lv||!QD())_i.TerCreateControl();jT=tA=yK(t);if(e)_i.TerRepaint(true);else _i.TerRepaint(true);return true};function VH(t,e,r){return true}function jH(t){var e,r,i=0,f,l,a=0;var n=null;var c;var s,_,o;var u,T=false;var A;var E=false;var R=0,L=0;var C;if(tg.expired)return true;if(t<=65535)R=t;else{C=String.fromCodePoint(t);if(C.length==1){L=C.charCodeAt(0);R=C.charCodeAt(1)}else{L=0;R=t}}if(Oc<0)Oe=tc.FLOW_DEF;if(xY(qS,R))return true;if(R==tc.ESCAPE){oV();return false}JH(R);if(oi.PageMode&&!WR&&Nj(Nc[ui[br].pfmt].flags&tc.PAGE_HDR_FTR)||Nj(ui[br].flags&tc.LFLAG_HDRS_FTRS)){oV();return false}u=ES;if(!u&&(R==Bn||R==tc.LINE_CHAR||R==tc.PAGE_CHAR||R==tc.TAB))u=true;if(!u&&ui[br].len>0){if(ui[br].fmt==null)s=ui[br].UniFmt;else{c=nb(br);if(jt<ui[br].len)s=c[jt];else s=tc.DEFAULT_CFMT;sb(br)}if(Nj(xs[s].style&tc.PROTECT)){oV();return false}n=ui[br].txt;if(jt<ui[br].len&&(n[jt]==Bn||n[jt]==tc.CELL_CHAR))u=true}if(Ji)a=fm();if(Oc>=0)_=Oc;else{f=uA;_=$w();uA=f}if(uA!=tc.HILIGHT_OFF){var I,d=sA;var F=TA;if(_A<sA||_A==sA&&AA<TA){d=_A;F=AA}if(Nj(ui[d].flags&tc.LFLAG_PARA)&&sA==_A&&Math.abs(TA-AA)==1&&F>=0&&F==ui[d].len-1){uA=tc.HILIGHT_OFF;br=d;jt=F}if(uA!=tc.HILIGHT_OFF){I=ib(d,F);if(xs[_].FieldId!=xs[I].FieldId&&Iw(xs[I].FieldId))_=I;Oc=_;ef=true}}if(!mh&&u&&xs[_].FieldId==tc.FIELD_TEXTBOX){o=fb(br,jt);s=ib(br,jt);if(xs[s].FieldId==tc.FIELD_TEXTBOX){if(xs[s].FieldId!=xs[o].FieldId||xs[s].AuxId!=xs[o].AuxId){_=_i.TerGetFieldFont(_,0,null)}}}if(u&&xs[_].FieldId==tc.FIELD_TEXTBOX&&!Fm(_,br,jt)){oV();return false}var g=Nj($h&tc.TFLAG5_PROTECT_DATA_FIELD)&&(xs[_].FieldId==tc.FIELD_NAME||xs[_].FieldId==tc.FIELD_DATA);if(Nj(xs[_].style&tc.PROTECT)&&uA==tc.HILIGHT_OFF||GE&&Dj(xs[_].style&tc.FNOTETEXT)||g){_=ib(br,jt);if(g||Nj(xs[_].style&(tc.PROTECT|tc.FNOTE|tc.FNOTEREST))){oV();return false}}if(Nj(Nc[ui[br].pfmt].pflags&tc.PFLAG_ENDNOTE)){oV();return false}if(br+1==Ri&&br>0&&Nj(Nc[ui[br-1].pfmt].pflags&tc.PFLAG_ENDNOTE)){vJ(0);return false}if(ui[br].fid>0){var P=ui[br].fid;if(Nj(kl[P].flags&(tc.PARA_FRAME_LINE|tc.PARA_FRAME_RECT))){oV();return false}}if(Nj(ui[br].flags&tc.LFLAG_BREAK)&&Dj(ui[br].flags&(tc.LFLAG_PARA|tc.LFLAG_SECT))&&R!=Bn||Nj(ui[br].flags&tc.LFLAG_HTML_RULE)){oV();return false}if(Nj(fO&tc.TFLAG10_APPEND_TO_FIELD_DATA)&&jt>0){o=ib(br,jt-1);if(xs[o].FieldId==tc.FIELD_DATA&&xs[_].FieldId==0){_=Ew(_,tc.FIELD_DATA,"")}}else if(false&&xs[_].FieldId==tc.FIELD_DATA){s=ib(br,jt);if(xs[s].FieldId==0)_=Ew(_,0,"")}if(Nj(xs[_].style&tc.PICT))_=tc.DEFAULT_CFMT;l=Nj(ui[br].fid)?kl[ui[br].fid].TextAngle:0;if(l==0)l=Nj(ui[br].cid)?eR[ui[br].cid].TextAngle:0;if(xs[_].TextAngle!=l)_=mb(_,l);_=zb(_);if(R==32){var S=xs[_].CharSet;if(S==tc.CHINESEBIG5_CHARSET||S==tc.GB2312_CHARSET||S==tc.HANGUL_CHARSET){_=yb(_,0,tc.ENGLISH)}}if(Ji&&a!=xs[_].AuxId)_=gy(_,a,0,"",br,jt);if(Z_)_=V4(_,tc.TRACK_INS);else if(Nj(xs[_].InsRev)||Nj(xs[_].DelRev))_=V4(_,tc.TRACK_NONE);if(R!=Bn&&R!=tc.LINE_CHAR)aO|=tc.TOFLAG_INSERT_CHAR;if(Nj(Qh&tc.TFLAG3_DATA_FIELD_INPUT))aO|=tc.TOFLAG_NO_FIELD_ADJ;if(uA==tc.HILIGHT_CHAR){var h=zh;var O=true;if(wN(true,true))return false;if(oi.WordWrap&&Nj(ui[_A].flags&(tc.LFLAG_PARA|tc.LFLAG_BREAK))){if(_A==sA&&AA>TA&&AA==ui[_A].len)AA--;else if(_A>sA&&AA==ui[_A].len)AA--}zh|=tc.TFLAG_NO_AUTO_FULL_CELL_SEL;aO|=tc.TOFLAG_SEL_CELL_CONTENT;uj(tc.TOFLAG2_TRACK_DELETION);if(Z_&&Q_)MT=tc.CURS_FORWARD;_i.TerDeleteBlock(false);zh=h;oj(tc.TOFLAG_SEL_CELL_CONTENT);if(Z_&&Nj(nO&tc.TOFLAG2_TRACK_DELETION))O=false;if(O){br=sA;jt=TA}uA=tc.HILIGHT_OFF;Br=tc.PAINT_WIN;T=true;if(xs[_].FieldId>0){var v=mh&&xs[_].FieldId==tc.FIELD_TEXTBOX;if(!v){var p=ib(br,jt);var N=fb(br,jt);if(xs[p].FieldId==0&&xs[N].FieldId==0){var D=xs[_].FieldId==tc.FIELD_NAME;_=Ew(_,0,"");if(D&&Nj(xs[_].style&tc.PROTECT))_=Db(_,tc.PROTECT,false);Oc=_}}}}e=ui[br].len;if(u&&jt<ui[br].len){if(false&&ui[br].len>=ft){if(R!=Bn||ui[br].len>ft)return false}fw(br,jt,1,gk("B"));n=ui[br].txt;c=nb(br)}else{var M=ui[br].len;if(Pm(br,jt)){oV();return false}if(jt+1>ui[br].len)Tm(br,ui[br].len,jt+1);n=ui[br].txt;c=nb(br);if(ui[br].len>M){var G;if(M==0)G=0;else G=c[M-1];for(r=M;r<ui[br].len;r++)c[r]=G}}for(r=0;r<ui[br].len;r++)if(xs[c[r]].height>i)i=xs[c[r]].height;for(r=e;r<=jt;r++)n[r]=tc.SPACE;s=tc.DEFAULT_CFMT;if(e>0)s=c[e-1];if(Nj(xs[s].style&(tc.PICT|tc.PROTECT)))s=tc.DEFAULT_CFMT;for(r=e;r<=jt;r++)c[r]=s;if(R==Bn||R==tc.LINE_CHAR)aO|=tc.TOFLAG_BREAK_CHAR;if(true||!ES){V8(br,jt,br,jt,u?tc.CHAR_I:tc.CHAR_R);c=nb(br)}if(xs[_].UcBase!=L)_=Wb(_,L);if(L==0){var B=Py(_,R);if(B<=65535)R=B;else{C=String.fromCodePoint(B);if(C.length==1){L=C.charCodeAt(0);R=C.charCodeAt(1)}else{L=0;R=t}}}n[jt]=R;c[jt]=_;if(Dj(ui[br].flags2&tc.LFLAG2_RTL)&&xs[_].rtl)E=true;if(xq(th)){if(!xs[c[jt]].rtlch||xs[c[jt]].flow!=tc.FLOW_RTL){var H=Sa.shiftKey||Sa.getModifierState("CapsLock");var m=true;var w='~!@#$%^&*()_+:"<>?';if(xs[c[jt]].CharSet==tc.HEBREW_CHARSET&&H&&w.indexOf(wY(R))<0)m=false;if(xs[c[jt]].rtlch!=m)c[jt]=Jb(c[jt],m);if(m&&xs[c[jt]].flow!=FLOW_RTL)c[jt]=Jb(c[jt],m);if(!m&&xs[c[jt]].flow==FLOW_RTL)c[jt]=Jb(c[jt],m)}}else if(xs[c[jt]].rtlch||xs[c[jt]].flow==tc.FLOW_RTL){c[jt]=Jb(c[jt],false)}if(R!=Bn&&R!=tc.LINE_CHAR){_=c[jt]=vy(c[jt],R)}if(Oe==tc.FLOW_DEF)Oe=xs[c[jt]].rtlch||xs[c[jt]].flow==tc.FLOW_RTL?tc.FLOW_RTL:tc.FLOW_LTR;sb(br);A=br>0&&ui[br].len==2&&Nj(ui[br].cid)&&GY(br,tc.INFO_CELL)&&L6(br-1)>L6(br);if(R!=Bn&&R!=tc.LINE_CHAR&&R!=tc.TAB&&R!=tc.NBSPACE_CHAR&&R!=tc.NBDASH_CHAR&&!T&&Oc==-1&&xs[_].height<=i&&!A&&!E&&Dj(ui[br].flags2&tc.LFLAG2_RTL)&&R<256&&Dj(xs[_].style&(tc.FNOTETEXT|tc.ENOTETEXT|tc.SCAPS))&&Nj(xs[_].ParaStyId==Nc[ui[br].pfmt].StyId)){yn=tc.WRAP_MIN;Br=tc.PAINT_LINE}Br=tc.PAINT_LINE;if(ui[br].height==0)nO|=tc.TOFLAG2_FRAME_REFRESH;if(jt<ft-1||jt+1<ui[br].len)jt++;if(jt>=ui[br].len&&oi.WordWrap&&br+1<Ri){br++;we++;jt=0;Br=tc.PAINT_WIN;yn=tc.WRAP_WIN}qE=false;ui[br].flags2=cj(ui[br].flags2,tc.LFLAG2_SPELL_CHECKED);be=br;Q=jt;if(Nj(ui[br].flags&tc.LFLAG_PICT))nO|=tc.TOFLAG2_REPOS_PICT_FRAMES;if(R==Bn||R==tc.LINE_CHAR)Ui=true;cG();oi.modified++;zQ();if(!ef)Oc=-1;Ni=false;oj(tc.TOFLAG_INSERT_CHAR|tc.TOFLAG_NO_RESET_FONT|tc.TOFLAG_NO_FIELD_ADJ|tc.TOFLAG_BREAK_CHAR);if(ME&&Nj(xs[_].style&tc.ENOTETEXT))aO|=tc.TOFLAG_UPDATE_ENOTE;if(Nj(aO&tc.TOFLAG_UPDATE_ENOTE)&&br<Fo)Fo=br;if(Rl>0||WD())zH(R);if(R==Bn)bZ();return true}_i.TerAdjustInputPos=function(){return JH(0)};function JH(t){var e,r,i;var f;var l;var a=Nj(rO&tc.TFLAG8_ALLOW_TEXT_BEF_PROT_FIELD);var n=Oc;t:{var c=false;if(jt>0){e=ib(br,jt);if(xs[e].FieldId==tc.FIELD_DATA){r=ib(br,jt-1);c=xs[r].FieldId==tc.FIELD_NAME}}if(t!=tc.SPACE&&!a&&!c){if(!NE){e=ib(br,jt);if(xs[e].FieldId!=tc.FIELD_NAME)break t}else break t}if(NE)break t;if(c&&Nj(fO&tc.TFLAG10_INSERT_AT_FIELD_DATA_BEGIN))break t;e=ib(br,jt);if(xs[e].FieldId!=tc.FIELD_DATA&&xs[e].FieldId!=tc.FIELD_NAME)break t;l=Nj(xs[e].style&tc.PROTECT);if(jt>0){r=ib(br,jt-1);if(xs[r].FieldId!=tc.FIELD_NAME)break t;f=nb(br);for(i=jt-1;i>=0;i--)if(xs[f[i]].FieldId!=tc.FIELD_NAME)break;sb(br);jt=i+1}if(Oc>=0)Oc=Ew(Oc,0,"");else Oc=Ew(e,0,"");if(Nj(xs[Oc].style&tc.PROTECT)&&(!l||a))Oc=Db(Oc,tc.PROTECT,false);MT=tc.CURS_FORWARD}if(jt==0&&Oc>0&&xs[Oc].FieldId==tc.FIELD_HLINK){if(br==0)Oc=0;else{r=fb(br,jt);if(xs[r].FieldId!=tc.FIELD_HLINK)Oc=r}}if(Z_&&Q_&&jt>0){f=nb(br);if(xs[f[jt-1]].DelRev>0){for(i=jt-1;i>=0;i--)if(xs[f[i]].DelRev==0)break;jt=i+1;MT=tc.CURS_FORWARD}sb(br)}if(ef)Oc=n;return true}function zH(t){var e,r,i,f;var l=null;var a;var n=false;var c="";if(!El){Cl=Lq(br,jt);if(t>=32)Cl--;El=true;return true}t:{if(t!=tc.SPACE&&t!=","&&t!=Bn&&t!=tc.LINE_CHAR)return true;if(jt==0){if(br==0)break t;else{br--;jt=ui[br].len}}Cq(Cl);r=PC;i=SC;if(r!=br)break t;l=ui[r].txt;for(e=i;e<jt;e++){if(l[e]!=tc.SPACE&&l[e]!=tc.COMMA&&l[e]!=tc.SEMI_COLON&&l[e]>=32)break}if(e==jt)break t;i=e;if(i>0){var s=l[i-1];if(s!=tc.SPACE&&s!=tc.COMMA&&s!=tc.SEMI_COLON&&s!=tc.TAB)break t}for(e=i;e<jt;e++){if(l[e]==tc.SPACE||l[e]<32)break;if(l[e]==","||l[e]==tc.SEMI_COLON){if(e+1>=jt)break;if(l[e+1]==tc.SPACE)break}}if(i==e)break t;f=e-i;a=Wk(l,i,f);n=false;if(WD()){gD(_i,a);n=oF;c=SP}if(!n){for(e=0;e<Rl;e++)if(nV(a,Il[e]))break;if(e==Rl)break t;c=dl[e]}var _=r;var o=i;var u=uE;V8(_,o,_,o+f-1,tc.CHAR_D);rw(r,i,f,c);r=PC;i=SC;uE=u;V8(_,o,_,o+c.length-1,tc.CHAR_I);jt+=c.length-f;var T=c.length;var A=false;var E=Uk(c);for(e=0;e<T;e++){if(E[e]>255){A=true;break}}Br=tc.PAINT_LINE;yn=tc.WRAP_MIN;if(A)yn=tc.WRAP_WIN;if(jt>=ui[br].len&&br+1<Ri){br++;jt=0;Br=tc.PAINT_WIN;yn=tc.WRAP_WIN}if(Fo>br)Fo=br;cG()}if(jt>=ui[br].len&&br+1<Ri){br++;jt=0}Cl=Lq(br,jt);return true}function ZH(){var t,e;var r,i;var f;var l=false;var a=true,n=false,c=false;var s,_,o,u;if(sr==br&&_r!=jt&&_r>=0&&_r<ui[br].len&&$H(sr,_r)){o=ui[sr].cwidth;if((o[_r]&tc.CWIDTH_WIDTH)==0){jt=_r;n=true}}sr=-1;if(uA!=tc.HILIGHT_OFF){var T=zh;var A=0;if(sA<_A||sA==_A&&TA<AA){A=ib(sA,TA);if(!NE&&AA>0){var E=ib(_A,AA-1);if(xs[E].FieldId==tc.FIELD_NAME)MT=tc.CURS_FORWARD;else{E=ib(_A,AA);if(xs[E].FieldId==tc.FIELD_NAME)MT=tc.CURS_FORWARD}}}else A=ib(_A,AA);zh|=tc.TFLAG_NO_AUTO_FULL_CELL_SEL;_i.TerDeleteBlock(true);zh=T;if(Dj(fO&tc.TFLAG10_DONT_USE_BKSP_FONT)){var R=false;if(xs[A].FieldId!=0){u=xs[A].FieldId;if(u==tc.FIELD_TEXTBOX&&mh)R=true}else R=true;if(R){Oc=A;ef=true}}return true}r=br;e=jt;t:{e:while(true){if(jt==0){if(Nj(ui[br].flags&tc.LFLAG_PARA_FIRST)||br==0){if(_i.TerMenuSelect2(tc.ID_BULLET))return _i.TerCommand2(tc.ID_BULLET,false);if(_i.TerMenuSelect2(tc.ID_PARA_NBR))return _i.TerCommand2(tc.ID_PARA_NBR,false)}if(br==0)return true;if(Nj(ui[br].cid)&&Dj(ui[br-1].cid))return true;if(oi.WordWrap){br--;jt=ui[br].len;l=true}else if(Rr){br--;we--;jt=ui[br].len;om();return true}else return true}if(jt>ui[br].len){jt--;Br=tc.PAINT_MIN;cG();return true}if(rm(true))return true;else if(im(true))return true;if(ui[br].len>0){u=0;var L=0,C=uE;if(Pm(br,jt-1)){t=ib(br,jt-1);if(Nj(xs[t].style&tc.PICT)&&xs[t].ParaFID!=0&&!dS){jt--;continue e}if(xs[t].FieldId==tc.FIELD_NAME&&um(t)){s=br;_=jt;jt--;MT=tc.CURS_BACKWARD;aq();if(s==br&&_==jt)return true;vT=br;pT=jt;MT=tc.CURS_FORWARD;return QH()}oV();br=r;jt=e;return false}if(_U(br,jt-1))return _i.TerDeleteHypertext(br,jt-1,true);t=ib(br,jt-1);if(um(t)){s=br;_=jt;jt--;MT=tc.CURS_BACKWARD;aq();if(s==br&&_==jt)return true;if(Z_&&Q_&&Pm(br,jt)){br=s;jt=_;vJ(0);return true}vT=br;pT=jt;MT=tc.CURS_FORWARD;return QH()}if(Z_&&k4(br,jt-1,false)){if(Q_)a=false;break t}jx(br,jt-1);if(mh){if(uA==tc.HILIGHT_OFF)L=fb(br,jt);else L=ib(br,jt-1);u=xs[L].FieldId}Oc=t;f=Sm(br,jt-1);if($H(br,jt-1)){sr=br;_r=jt-1;c=true;if(n||tm(br,jt-1)){var I=br;var d=jt-1;Em(I,d);I=PC;d=SC;o=ui[I].cwidth;if((o[d]&tc.CWIDTH_WIDTH)==0)o[d]=1|tc.CWIDTH_USED}}V8(br,jt-1,br,jt-1,tc.CHAR_D);if(Dj(fO&tc.TFLAG10_DONT_USE_BKSP_FONT)){Oc=ib(br,jt-1);ef=true}fw(br,jt-1,1,tc.CHAR_D);if(f==Bn&&ui[br].len>0&&jt>ui[br].len){for(i=br+1;i<Ri;i++){ui[i].pfmt=ui[br].pfmt;if(Nj(ui[i].flags&(tc.LFLAG_PARA|tc.LFLAG_BREAK))){if(ui[i].len>0){var F=nb(i);var g=F[ui[i].len-1];var P=(xs[g].style&tc.PROTECT)==(xs[t].style&tc.PROTECT);if(P&&xs[g].FieldId!=xs[t].FieldId)P=false;if(P)F[ui[i].len-1]=t}break}}}if(mh&&u==tc.FIELD_TEXTBOX)bw(L,C,br,jt-1)}break}}if(a)jt--;if(Nj(ui[br].flags&tc.LFLAG_PARA)&&!l&&!fq()&&!c)yn=tc.WRAP_MIN;else yn=tc.WRAP_PARA;if(Nj(ui[br].flags&tc.LFLAG_FNOTETEXT)||Nj(ui[br].flags2&tc.LFLAG2_ENOTETEXT)){yn=tc.WRAP_PARA;aO|=tc.TOFLAG_UPDATE_ENOTE}if(true||yn==tc.WRAP_MIN)Br=tc.PAINT_LINE;else Br=tc.PAINT_WIN;qE=false;if(Oc>=0&&xs[Oc].FieldId!=0&&!ef)Oc=-1;if(l&&Nj(Nc[ui[br].pfmt].flags&tc.PAGE_HDR_FTR))yJ(false,true,0,true);else cG();return true}function QH(){var t;var e=false;if(uA!=tc.HILIGHT_OFF){var r=zh;zh|=tc.TFLAG_NO_AUTO_FULL_CELL_SEL;_i.TerDeleteBlock(true);zh=r;return true}if(qE)return eW();if(jt>=ui[br].len&&!oi.WordWrap){if(Rr){om();return true}else return true}if(oi.WordWrap&&jt+1>ui[br].len)return true;if(DN(false))return true;if(rm(false))return true;else if(im(false))return true;else if(em(false))return true;if(Li&&!pE)rq();if(Pm(br,jt)){oV();return true}if(oi.WordWrap&&br==Ri-1&&jt==ui[br].len-1)return true;t:{if(Z_&&k4(br,jt,true))break t;if(_U(br,jt))return _i.TerDeleteHypertext(br,jt,true);if(ui[br].len>0){var i=Sm(br,jt);var f=0,l=0,a=uE;if(Nj(ui[br].flags&tc.LFLAG_FNOTETEXT)||Nj(ui[br].flags2&tc.LFLAG2_ENOTETEXT)){var n=ib(br,jt);if(Nj(xs[n].style&(tc.FNOTETEXT|tc.ENOTETEXT)))e=true;aO|=tc.TOFLAG_UPDATE_ENOTE}jx(br,jt);if(mh){if(uA==tc.HILIGHT_OFF)l=ib(br,jt);else l=ib(sA,TA);f=xs[l].FieldId}V8(br,jt,br,jt,tc.CHAR_D);fw(br,jt,1,tc.CHAR_D);if(i==Bn&&ui[br].len>0&&jt==ui[br].len){for(t=br+1;t<Ri;t++){ui[t].pfmt=ui[br].pfmt;if(Nj(ui[t].flags&(tc.LFLAG_PARA|tc.LFLAG_BREAK)))break}}if(mh&&f==tc.FIELD_TEXTBOX)bw(l,a,br,jt)}}if(Nj(ui[br].flags&tc.LFLAG_PARA)&&jt<ui[br].len-1&&!fq()&&!e&&!Q_)yn=tc.WRAP_MIN;else yn=tc.WRAP_PARA;if(Z_&&Q_)yn=tc.WRAP_WIN;if(true||yn==tc.WRAP_MIN)Br=tc.PAINT_LINE;else Br=tc.PAINT_WIN;qE=false;cG();return true}function qH(){var t,e=0,r,i,f;var l;var a;var n=0;if(jt<2)return false;l=ui[br].txt;a=nb(br);for(t=jt-1,r=0;t>=0;t--,r++){if(r>=4)break;n=l[t];if(n>=tc.CHAR_0&&n<=tc.CHAR_9)i=n-tc.CHAR_0;else if(n>=tc.CHAR_a&&n<=gk("f"))i=n-tc.CHAR_a+10;else if(n>=tc.CHAR_A&&n<=tc.CHAR_F)i=n-tc.CHAR_A+10;else break;if(Nj(xs[a[t]].style&tc.PROTECT))return false;i=i<<4*r;e+=i}sb(br);if(r==0)return false;f=uE;V8(br,jt-r,br,jt-1,tc.CHAR_D);fw(br,jt-r,r,tc.CHAR_D);jt-=r;fw(br,jt,1,gk("B"));l=ui[br].txt;l[jt]=e;if(v9(e)){var c=ib(br,jt);if(Tk(xs[c].TypeFace,"Cambria Math")!=0){a=nb(br);a[jt]=xb(a[jt],"Cambria Math",0,0);sb(br)}}uE=f;V8(br,jt,br,jt,tc.CHAR_I);jt++;return true}function $H(t,e){var r=t,i=e;var f;var l=false,a=false;if(i>=ui[r].len)return false;if(!g9(t,e))return false;Em(r,i);r=PC;i=SC;f=ui[r].cwidth;if(f!=null)a=Nj(f[i]&tc.CWIDTH_USED)&&(f[i]&tc.CWIDTH_WIDTH)==0;f=ui[t].cwidth;if(f!=null)l=Nj(f[e]&tc.CWIDTH_USED)&&(f[e]&tc.CWIDTH_WIDTH)==0;return a||l}function tm(t,e){var r=ui[t].cwidth;if(r==null)return true;if(Dj(r[e]&tc.CWIDTH_USED))return true;if((r[e]&tc.CWIDTH_WIDTH)>0)return true;return false}function em(t){var e,r;var i=zh;e=br;r=jt;if(t){if($H(br,jt)){while(true){var f=e;var l=r;Em(e,r);e=PC;r=SC;if(e==0&&r==0)break;if(e==f||r==l)break;if(tm(e,r))break}}else{Em(e,r);e=PC;r=SC;if(e==br&&r==jt)return false;if(!$H(e,r))return false}br=e;jt=r;MT=tc.CURS_FORWARD;QH()}else{if(!$H(br,jt))return false;sA=e=br;TA=r=jt;Rm(e,r);e=PC;r=SC;_A=e;AA=r;OA=false;uA=tc.HILIGHT_CHAR;MT=tc.CURS_FORWARD;zh|=tc.TFLAG_NO_AUTO_FULL_CELL_SEL;_i.TerDeleteBlock(true);zh=i}return true}function rm(t){var e,r,i,f,l=0,a,n,c;var s=0,_;c=br;_=jt;if(t){Em(c,_);c=PC;_=SC}r=ib(c,_);i=xs[r].FieldId;if(!Iw(i))return false;for(s=c;s>=0;s--){if(s==c)f=_;else f=ui[s].len-1;for(l=f;l>=0;l--){a=fb(s,l);n=xs[a].FieldId;if(n!=i)break}if(l>=0)break}if(s<0){s=0;l=0}sA=s;TA=l;for(s=c;s<Ri;s++){if(s==c)f=_;else f=0;e=ui[s].len;for(l=f;l<e;l++){a=ib(s,l);n=xs[a].FieldId;if(n!=i)break}if(l<e)break}if(s>=Ri){s=Ri-1;l=ui[s].len}_A=s;AA=l;OA=false;uA=tc.HILIGHT_CHAR;cG();return true}function im(t){var e,r,i;var f,l=0,a=0,n=0,c=0,s;var _;if(Dj(iO&tc.TFLAG9_TREAT_DATA_FIELD_AS_ATOM))return false;i=br;f=jt;if(t){Em(i,f);i=PC;f=SC}e=ib(i,f);r=xs[e].FieldId;if(r!=tc.FIELD_NAME&&r!=tc.FIELD_DATA)return false;Pw(i,f,tc.FIELD_NAME);l=rI;a=$C;_=Pw(i,f,tc.FIELD_DATA);n=iI;c=eI;if(!_){Pw(i,f,tc.FIELD_NAME);n=iI;c=eI}_A=n;AA=c;sA=l;TA=a;OA=false;uA=tc.HILIGHT_CHAR;cG();return true}function fm(){var t,e;if(Ne==Me)return Me;t=ib(br,jt);e=fb(br,jt);if((xs[t].AuxId==De||xs[t].AuxId==Ne)&&(xs[e].AuxId==Ne||xs[e].AuxId==De))return Ne;return Me}function lm(){var t,e,r,i,f,l;var a;var n=Sa.shiftKey;var c;var s,_;var o=uE;if(Nj(tO&tc.TFLAG6_SWAP_CR_LINE_BREAK))n=!n;if(oi.LineLimit>0&&Ri>=oi.LineLimit)return QY(tc.MSG_MAX_LINES_EXCEEDED,"Carriage Return");if(oi.WordWrap){if(ui[br].len==1&&Nj(ui[br].flags&tc.LFLAG_PARA_FIRST)){e=ui[br].pfmt;r=Nc[e].BltId;if(Dj(tO&tc.TFLAG6_DONT_PROCESS_BULLET_KEYS)&&r!=0&&xc[r].ls!=0){var u=xc[r].lvl;if(u==0){_i.TerSetListBullet(false,0,0,0,"","",false);e=ui[br].pfmt;if((Li||vr)&&Nc[e].LeftIndentTwips>0||Nc[e].LeftIndentTwips<360&&u==1)_i.TerSetParaIndent(0,-1,-1,true)}else{_i.TerSetListLevel(-1,-1,true);return true}}}else if(false&&br>0&&ui[br-1].len==1&&Nj(ui[br-1].flags&tc.LFLAG_PARA_FIRST)&&Dj(ui[br-1].flags&tc.LFLAG_BREAK)){e=ui[br-1].pfmt;r=Nc[e].BltId;if(Dj(tO&tc.TFLAG6_DONT_PROCESS_BULLET_KEYS)&&r!=0&&xc[r].ls!=0){br-=1;_i.TerSetListBullet(false,0,0,0,"","",false)}}if(jt==0&&ui[br].cid>0&&!n&&Dj(Qh&tc.TFLAG3_CURSOR_IN_CELL)){l=ui[br].cid;f=eR[l].row;c=Li&&eR[l].PrevCell<=0&&Nj($E[f].flags&tc.ROWFLAG_NEW_TABLE);if(br==0||c&&ui[br-1].cid>0&&ui[br-1].cid!=ui[br].cid||Nj(ui[br-1].flags&tc.LFLAG_HDRS_FTRS)||Nj(ui[br-1].tabw)&&Nj(ui[br-1].tabw.type&(tc.INFO_SECT|tc.INFO_PAGE|tc.INFO_COL))&&ui[br-1].cid==0){ew(br,Bn,0,ui[br].pfmt,0,0);V8(br,0,br,0,tc.CHAR_I);cG();return true}}if(n)jH(tc.LINE_CHAR);else{jH(Bn);if(br+1==Ri&&Dj(ui[br].flags&tc.LFLAG_LIST)&&OQ(br)){Br=tc.PAINT_LINE;cG()}}Ni=true;or=br;return true}else if(uA!=tc.HILIGHT_OFF){uE=o;_i.TerDeleteBlock(false)}s=br;_=jt;i=0;if(ui[br].len>0){a=ui[br].txt;for(t=0;t<ui[br].len;t++)if(a[t]!=tc.SPACE)break;if(a[t]!=tc.SPACE)i=t;if(jt<i)i=jt}if(Ar){uE=o;sm(i,true,true);uE=o;V8(s,_,br,jt,tc.CHAR_I);return true}if(Tr&&ui[br].len<=jt){uE=o;sm(i,true,true);uE=o;V8(s,_,br,jt,tc.CHAR_I);return true}if(br+1>=Ri)return true;jt=0;we++;br++;uE=o;V8(s,_,br,jt,tc.CHAR_I);if(uA!=tc.HILIGHT_OFF){uA=tc.HILIGHT_OFF;Br=tc.PAINT_WIN}cG();return true}function am(){var t,e,r,i;var f;r=Oc;pB();Oc=r;if(oi.WordWrap){if(oi.PrintView&&ui[br].cid>0&&Zt!=tc.ID_CTRL_TAB&&!mh&&!oi.ReadOnly)return V6();var l=Sa!=null&&Sa.ctrlKey&&(Sa.location==2||Sa.keyLocation==2);f=ui[br].cid==0||l;if(jt==0&&Nj(ui[br].flags&tc.LFLAG_PARA_FIRST)&&f){t=ui[br].pfmt;e=Nc[t].BltId;if(Dj(tO&tc.TFLAG6_DONT_PROCESS_BULLET_KEYS)&&e!=0&&xc[e].ls!=0&&xc[e].lvl<8){_i.TerSetListLevel(-1,1,true);return true}}i=ib(br,jt);if(oi.ReadOnly&&xs[i].FieldId!=tc.FIELD_TEXTBOX&&xs[i].ctl==null){var a=fb(br,jt);if(xs[a].FieldId==tc.FIELD_TEXTBOX){Em();i=ib(br,jt)}}if(oi.ReadOnly&&(xs[i].FieldId==tc.FIELD_TEXTBOX||xs[i].ctl!=null)){Yw(false);return true}if(oi.ReadOnly)return true;if(Li){return _i.InsertTerText("    ",true)}if(Dj(ui[br].tabw))xX(br);if(Dj(ui[br].tabw.type&tc.INFO_TAB)){ui[br].tabw.type|=tc.INFO_TAB;ui[br].tabw.count=0}}if(!oi.ReadOnly)return jH(tc.TAB);else return true}function nm(){var t;var e,r,i;var f;i=ib(br,jt);if(ui[br].len==0)return true;if(mh&&(xs[i].FieldId==tc.FIELD_TEXTBOX||xs[i].ctl!=null)){return Yw(true)}var l=Sa.ctrlKey;if(oi.PrintView&&ui[br].cid>0&&xs[i].FieldId!=tc.FIELD_TEXTBOX&&l)return j6();var a=Sa!=null&&Sa.ctrlKey&&(Sa.location==2||Sa.keyLocation==2);f=ui[br].cid==0||a;if(jt==0&&Nj(ui[br].flags&tc.LFLAG_PARA_FIRST)&&f){e=ui[br].pfmt;r=Nc[e].BltId;if(Dj(tO&tc.TFLAG6_DONT_PROCESS_BULLET_KEYS)&&r!=0&&xc[r].ls!=0&&(xc[r].lvl>0||Nc[e].LeftIndentTwips>0)){_i.TerSetListLevel(-1,-1,true);return true}}if(jt>=ui[br].len)jt=ui[br].len-1;t=ui[br].txt;if(jt>0&&t[jt]==tc.TAB)jt--;while(jt>0){if(t[jt]==tc.TAB)break;jt--}Br=tc.PAINT_MIN;cG();return true}function cm(){if(oi.WordWrap&&Ri==1){if(ui[br].len<=1)return true;sA=_A=br;TA=0;AA=ui[br].len-1;uA=tc.HILIGHT_CHAR;return GN(true,true)}oi.modified++;V8(br,0,br,ui[br].len,tc.CHAR_D);iw(br,1,tc.CHAR_D);if(br==Ri&&br>0){br--;we--;jt=0}if(br>=sA&&br<=_A)uA=tc.HILIGHT_OFF;if(br>=_A&&br<=sA)uA=tc.HILIGHT_OFF;if(br<=sA)sA--;if(br<=_A)_A--;if(sA<0||_A<0)uA=tc.HILIGHT_OFF;if(we<0){we=0;fr=br}if(oi.WordWrap&&jt>=ui[br].len)jt=ui[br].len-1;if(jt<0)jt=0;Br=tc.PAINT_PARTIAL_WIN;cG();return true}function sm(t,e,r){var i;var f;var l;if(!MY(Ri+1)){return QY(tc.MSG_MAX_LINES_EXCEEDED,"TerSplitLine")}_m(br,jt,t);ui[br+1].pfmt=ui[br].pfmt;if(br<sA)sA++;if(br<_A)_A++;jt=0;if(e&&ui[br+1].len==0){i=br;while(ui[i].len==0&&i>0)i--;l=0;f=ui[i].txt;while(l<ui[i].len&&f[l]==tc.SPACE)l++;jt=l}Br=tc.PAINT_PARTIAL_WIN;br++;we++;if(we>=Dt){we=Dt-1;Br=tc.PAINT_WIN}fr=br-we;oi.modified++;if(r)cG();return true}function _m(t,e,r){var i;var f=[1];var l=[1];var a=[1];iw(t,1,tc.CHAR_A);if(e>=ui[t].len)return false;Tm(t+1,ui[t+1].len,r+ui[t].len-e);if(e<ui[t].len)f[0]=ib(t,e);else f[0]=tc.DEFAULT_CFMT;if(Nj(xs[f[0]].style&tc.PICT))f[0]=tc.DEFAULT_CFMT;l[0]=0;a[0]=tc.SPACE;for(i=0;i<r;i++)nw(t+1,i,1,a,f,l);lw(t,e,t+1,r,ui[t].len-e);Tm(t,ui[t].len,e);if(Nj(ui[t].tabw)){UX(t,t+1);ui[t].tabw.type=ui[t].tabw.type&(tc.INFO_TAB|tc.INFO_JUST)}if(GY(t,tc.INFO_SECT)){ui[t+1].tabw.type|=tc.INFO_SECT;ui[t+1].tabw.section=ui[t].tabw.section;ui[t].tabw.type=cj(ui[t].tabw.type,tc.INFO_SECT)}return true}function om(){var t,e,r=0,i;var f,l;var a,n;var c,s,_,o;var u=uE;if(Ri==br+1)return true;if(false&&ui[br].len+ui[br+1].len>ft){QY(tc.MSG_LINE_TOO_LONG,"TerJoinLine");return true}uE=u;if(oi.WordWrap)V8(br,0,br,ui[br].len-1,tc.CHAR_D);else{if(br+2>=Ri)V8(br,0,br+1,ui[br+1].len-1,tc.CHAR_D);else V8(br,0,br+2,0,tc.CHAR_D)}oi.modified++;a=ui[br+1].txt;while(r<ui[br+1].len&&a[r]==tc.SPACE)r++;e=ui[br].len;Tm(br,ui[br].len,ui[br].len+ui[br+1].len-r);a=ui[br].txt;n=ui[br+1].txt;ab(br);c=uP;_=oP;ab(br+1);s=uP;o=oP;for(t=0;t<ui[br+1].len-r;t++){a[e+t]=n[r+t];c[e+t]=s[r+t];_[e+t]=o[r+t]}cb(br);cb(br+1);uE=u;if(oi.WordWrap)V8(br,0,br,ui[br].len-1,tc.CHAR_I);f=br;l=we;i=jt;br++;we++;if(we>=Dt)we=Dt-1;fr=br-we;uE=u;if(!oi.WordWrap)nO|=tc.TOFLAG2_NO_SAVE_UNDO;cm();br=f;we=l;jt=i;fr=br-we;if(!oi.WordWrap){uj(tc.TOFLAG2_NO_SAVE_UNDO);uE=u;if(br+1>=Ri)V8(br,0,br,ui[br].len-1,tc.CHAR_I);else V8(br,0,br+1,0,tc.CHAR_I)}cG();return true}function um(t){var e=false;var r=xs[t].style;if(!pE&&Nj(r&tc.HIDDEN))e=true;if(!DE&&(Nj(r&tc.FNOTETEXT)&&Dj(r&tc.ENOTETEXT))&&Dj(aO&tc.TOFLAG_FNOTE_FRAME))e=true;if(!ME&&Nj(r&tc.ENOTETEXT))e=true;if(!NE&&xs[t].FieldId==tc.FIELD_NAME)e=true;if(NE&&xs[t].FieldId==tc.FIELD_DATA)e=true;if(Q_&&xs[t].DelRev>0)e=true;if(!NE&&xs[t].FieldId==tc.FIELD_SEQ){if(xs[t].FieldCode!=null){if(xs[t].FieldCode.indexOf("\\h ")>=0)e=true}}return e}function Tm(t,e,r){oi.modified++;if(Nj(ui[t].fmt))Vw(t,e,r);if(Nj(ui[t].tag))Jw(t,e,r);if(Nj(ui[t].cwidth))jw(t,e,r);if(e==0&&r==0){ui[t].txt=null;ui[t].len=0;ui[t].tabw=null;return}if(e==r){ui[t].len=r;return}if(r==0){ui[t].txt=null;ui[t].len=0;ui[t].tabw=null;return}if(e!=0){ui[t].txt=fV(ui[t].txt,r+1);ui[t].len=r;ui[t].flags2=sj(ui[t].flags2,tc.LFLAG2_SPELL_CHECKED);return}if(e==0){ui[t].txt=new Array(r+1);ui[t].len=r;ui[t].flags2=sj(ui[t].flags2,tc.LFLAG2_SPELL_CHECKED);return}}function Am(t,e){var r=t;var i=e;if(t==undefined){r=br;i=jt}PC=r;SC=i;if(r<0){r=0;i=0}if(r>=Ri){r=Ri-1;i=ui[r].len-1}if(!oi.WordWrap)return true;if(i<0){r--;while(r>=0&&ui[r].len==0)r--;if(r<0){r=0;i=0}else i=ui[r].len-1}else if(i>=ui[r].len){r++;while(r<Ri&&ui[r].len==0)r++;if(r>=Ri){r=Ri-1;i=ui[r].len-1;if(i<0)i=0}else i=0}PC=r;SC=i;if(t==undefined){br=PC;jt=SC}return true}function Em(t,e){var r=t;var i=e;if(t==undefined){r=br;i=jt}PC=r;SC=i;if(r==0&&i==0)return false;i--;if(i<0){r--;while(r>=0&&ui[r].len==0)r--;if(r<0){r=0;i=0}else i=ui[r].len-1}PC=r;SC=i;if(t==undefined){br=PC;jt=SC}return true}function Rm(t,e){var r=t;var i=e;if(t==undefined){r=br;i=jt}PC=r;SC=i;if(r==Ri-1&&i==ui[r].len-1)return false;i++;if(i>=ui[r].len){r++;while(r<Ri&&ui[r].len==0)r++;if(r>=Ri){r=Ri-1;i=ui[r].len-1;if(i<0)i=0}else i=0}PC=r;SC=i;if(t==undefined){br=PC;jt=SC}return true}function Lm(t,e){var r,i;var f;if(t>=Ri)return false;if(e>=ui[t].len&&!oi.WordWrap)return true;if(e>=ui[t].len)return false;if(oi.PageMode&&!WR&&Nj(Nc[ui[t].pfmt].flags&tc.PAGE_HDR_FTR))return false;if(Nj(ui[t].flags&tc.LFLAG_HDRS_FTRS))return false;if(Nj(Nc[ui[t].pfmt].pflags&tc.PFLAG_ENDNOTE))return false;if(t+1==Ri&&t>0&&Nj(Nc[ui[t-1].pfmt].pflags&tc.PFLAG_ENDNOTE)){return false}i=ib(t,e);if(Nj(xs[i].style&tc.PROTECT)){r=fb(t,e);if(Nj(xs[r].style&tc.PROTECT)){var l=false;if(xs[i].FieldId==tc.FIELD_NAME&&xs[r].FieldId==tc.FIELD_NAME){f=ui[t].txt;if(f[e]==tc.LEFT_BRACE){var a=lb(t,e);if(Dj(xs[a].style&tc.PROTECT))l=true}}if(false&&!l){var n=$w();if(Dj(xs[n].style&tc.PROTECT))l=true}if(!l)return false}}if(Nj($h&tc.TFLAG5_PROTECT_DATA_FIELD)){var c,s;r=fb(t,e);c=xs[i].FieldId;s=xs[r].FieldId;if(c==tc.FIELD_DATA)return false;if(c==tc.FIELD_NAME&&ui[t].txt[e]!=tc.LEFT_BRACE)return false}if(Nj(ui[t].tabw)&&Nj(ui[t].tabw.type&tc.INFO_ROW))return false;if(Iw(xs[i].FieldId)&&i==fb(t,e))return false;return true}function Cm(t,e){if(Nj(Nc[ui[t].pfmt].flags&tc.PAGE_HDR_FTR))return false;return Im(t,e)}function Im(t,e){if(Nj(ui[t].fid)||Nj(ui[t].cid))return false;return dm(t,e)}function dm(t,e){var r,i,f,l;if(Nj(ui[t].flags&(tc.LFLAG_HDR|tc.LFLAG_FHDR|tc.LFLAG_FTR|tc.LFLAG_FFTR)))return false;if(GY(t,tc.INFO_ROW))return false;r=ib(t,e);i=fb(t,e);f=xs[r].FieldId;l=xs[i].FieldId;if(f==tc.FIELD_DATA&&l==tc.FIELD_NAME||f==tc.FIELD_DATA&&l==tc.FIELD_DATA)return false;if(f==tc.FIELD_NAME&&l==tc.FIELD_NAME){var a=Sm(t,e);if(a!=tc.LEFT_BRACE)return false}if(f==tc.FIELD_TEXTBOX){if(l==tc.FIELD_TEXTBOX&&xs[r].AuxId==xs[i].AuxId&&Cw(xs[r].FieldCode,xs[i].FieldCode))return false}if(Nj(xs[r].style&(tc.FNOTETEXT|tc.FNOTEREST)))return false;return true}function Fm(t,e,r){var i,f;var l;var a,n,c,s;var _="";if(xs[t].FieldCode==null)return true;if(uA!=tc.HILIGHT_OFF)return true;s=ib(e,r);if(xs[s].FieldId!=tc.FIELD_TEXTBOX||xs[s].AuxId!=xs[t].AuxId){Em(e,r);e=PC;r=SC;s=ib(e,r);if(xs[s].FieldId!=tc.FIELD_TEXTBOX||xs[s].AuxId!=xs[t].AuxId)return false}_=TK(xs[t].FieldCode,0,gk("|"));a=LX(_);if(a==0)return true;l=e;n=r;if(!_i.TerLocateFieldChar(tc.FIELD_TEXTBOX,null,false,l,n,false)){zC=0;ZC=0}i=Lq(zC,ZC);l=e;n=r;if(!_i.TerLocateFieldChar(tc.FIELD_TEXTBOX,null,false,l,n,true))return true;f=Lq(zC,ZC);c=f-i-1;return a>c}function gm(){var t,e,r;var i;if(uA!=tc.HILIGHT_CHAR)return false;if(!Ua)return false;t=Lq(sA,TA);e=Lq(_A,AA);r=Lq(Da,Ma);if(t>e){t=WY(t,e);e=JC}if((!oi.ReadOnly||Nj(tO&tc.TFLAG6_OLE_DROP_SOURCE))&&Dj(zh&tc.TFLAG_NO_DRAG_TEXT)&&r>=t&&r<e){if(ui[sA].cid==ui[_A].cid&&ui[sA].fid==ui[_A].fid){var f=true;if(JE){i=ib(sA,TA);f=xs[i].FrameType!=tc.PFRAME_FLOAT}return f}}return false}function Pm(t,e){var r,i,f;var l;var a;var n;if(t>=Ri||e>=ui[t].len)return false;if(oi.PageMode&&!WR&&Nj(Nc[ui[t].pfmt].flags&tc.PAGE_HDR_FTR))return true;if(Nj(ui[t].flags&tc.LFLAG_HDRS_FTRS))return true;if(t>0&&ui[t].len==1&&Nj(Nc[ui[t-1].pfmt].flags&tc.PAGE_HDR_FTR)&&Dj(Nc[ui[t].pfmt].flags&tc.PAGE_HDR_FTR)&&(t>=Ri-1||Nj(ui[t+1].tabw)&&Nj(ui[t+1].tabw.type&tc.INFO_SECT)))return true;r=ib(t,e);if(Nj(xs[r].style&tc.PROTECT))return true;i=f=0;if(e>0)i=ib(t,e-1);else{for(n=t-1;n>=0;n--)if(ui[n].len>0)break;if(n>=0)i=ib(n,ui[n].len-1)}if(e+1<ui[t].len)f=ib(t,e+1);else{for(n=t+1;n<Ri;n++)if(ui[n].len>0)break;if(n<Ri)f=ib(n,0)}if(Dj(Zh&tc.TFLAG2_CAN_MERGE_PROT_TEXT)&&Nj(xs[i].style&tc.PROTECT)&&Nj(xs[f].style&tc.PROTECT))return true;if(Nj(xs[r].style&(tc.FNOTE|tc.FNOTEREST)))return true;if(Nj(xs[r].style&tc.FNOTETEXT)&&Nj(xs[i].style&tc.FNOTE)&&Dj(xs[f].style&tc.FNOTETEXT))return true;if(Nj($h&tc.TFLAG5_PROTECT_DATA_FIELD)&&(xs[r].FieldId==tc.FIELD_NAME||xs[r].FieldId==tc.FIELD_DATA))return true;if(!dS&&!QE&&Nj(xs[r].style&tc.PICT)&&xs[r].FrameType!=tc.PFRAME_NONE)return true;l=ui[t].txt;a=l[e];if(a==TR||a==tc.ROW_CHAR)return true;if(ui[t].fid>0&&(t==Ri-1||ui[t+1].fid==0)&&a==Bn)return true;if(e+1==ui[t].len&&Nj(ui[t].flags&tc.LFLAG_PARA)&&t+1<Ri&&ui[t].fid!=ui[t+1].fid)return true;if(false&&Li&&e>0&&e+1==ui[t].len&&Nj(ui[t].flags&tc.LFLAG_PARA)){if(t+1>=Ri||Nc[ui[t].pfmt].AuxId!=Nc[ui[t+1].pfmt].AuxId)return true}if(e+1==ui[t].len&&Nj(ui[t].flags&tc.LFLAG_PARA)&&!GY(t,tc.INFO_SECT)&&t+1<Ri&&Nj(ui[t+1].flags&tc.LFLAG_HDRS_FTRS))return true;if(Nj(qh&tc.TFLAG4_NO_MERGE_TABLE)){if(e+1==ui[t].len&&Nj(ui[t].flags&tc.LFLAG_PARA)&&!GY(t,tc.INFO_SECT)&&t+1<Ri&&ui[t+1].cid>0){if(ui[t].cid==0)return true;if(eR[ui[t].cid].level<eR[ui[t+1].cid].level)return true}}return false}function Sm(t,e){var r;var i;if(t>=Ri)return 0;if(e<0||e>=ui[t].len)return 0;r=ui[t].txt;i=r[e];return i}function hm(){var t;if(MT==tc.CURS_FORWARD||MT==tc.CURS_DOWN)t=true;else if(MT==tc.CURS_BACKWARD||MT==tc.CURS_UP)t=false;else{t=false;if(oi.PageMode){if(Lo>NT)t=true;else if(Lo==NT&&Xt+Gt>DT)t=true;else if(br==vT&&jt>=pT)t=true}else{if(br>vT)t=true;else if(br==vT&&jt>=pT)t=true}}return t}function Om(t,e){var r=ib(t,e);var i,f,l;var a=Nj(Zh&tc.TFLAG2_CURSOR_BEF_HIDDEN)?true:false;var n=Nj($h&tc.TFLAG5_BEF_AND_AFT_HIDDEN);var c=Nj(Zh&tc.TFLAG2_NO_CURSOR_ON_PROTECT)?true:false;var s=Nj(qh&tc.TFLAG4_SKIP_PROT_TEXT)?true:false;var _=Nj(iO&tc.TFLAG9_TREAT_DATA_FIELD_AS_ATOM);if(g9(t,e)&&ui[t].cwidth!=null){var o=t;var u=e;Em(o,u);o=PC;u=SC;if(o!=t||u!=e){if(!tm(o,u))return true}}if(O9(t,e)&&ui[t].cwidth!=null)return true;if(Li){if(!oi.ReadOnly){l=fb(t,e);var T=um(r);var A=um(l);if(T&&!A)return false;if(!pE&&A&&!T&&oU(r))return true}if(um(r))return true}else{if(a){l=fb(t,e);if(um(l)){if(c){var E=t;var R=e-1,L,C;Am(E,R);E=PC;R=SC;if(!_i.TerLocateStyleChar(tc.HIDDEN,false,E,R,false))return true;E=zC;R=ZC;L=ib(E,R);C=lb(E,R);if(Dj(xs[L].style&tc.PROTECT)||Dj(xs[C].style&tc.PROTECT))return true}else return true}}else{if(um(r)){if(n){l=fb(t,e);if(um(l))return true}else return true}}if(c){l=fb(t,e);if(Nj(xs[l].style&tc.PROTECT)&&Nj(xs[r].style&tc.PROTECT))return true}if(s){if(Nj(xs[r].style&tc.PROTECT))return true}i=xs[r].FieldId;if(i>0&&i!=tc.FIELD_NAME&&i!=tc.FIELD_DATA&&i!=tc.FIELD_TOC&&i!=tc.FIELD_HLINK&&i!=tc.FIELD_TEXTBOX){l=fb(t,e);if(xs[l].FieldId>0)return true}if(i>0&&(i==tc.FIELD_NAME||i==tc.FIELD_DATA)&&_){l=fb(t,e);if(xs[l].FieldId>0)return true}if(yR&&Dj(WR)&&Nj(Nc[ui[t].pfmt].flags&tc.PAGE_HDR_FTR))return true;f=ui[t].cid;if(Nj(eR[f].flags&tc.CFLAG_ROW_SPANNED))return true}return false}function vm(t){var e,r,i,f=-1;var l;if(ui[t].fmt==null){i=ui[t].UniFmt;return um(i)}else{l=ui[t].fmt;r=ui[t].len;for(e=0;e<r;e++){i=l[e];if(i==f)continue;if(!um(i))break;f=i}if(e<r)return false}return true}_i.TerLineSelected=function(t){if(!lv||!QD())_i.TerCreateControl();return pm(t)};function pm(t){var e,r,i,f,l,a,n,c;var s,_,o,u;if(uA!=tc.HILIGHT_CHAR)return true;if(t<0||t>=Ri)return true;n=C6(sA,_A);i=E6(n,t);if(i==0)return true;e=E6(n,sA);r=E6(n,_A);if(e==0||r==0)return true;if(!n6(e,r))return true;if(s6(eR[e].row)&&u6(eR[r].row)&&eR[e].PrevCell<=0&&eR[r].NextCell<=0)return true;if(eR[e].PrevCell<=0&&eR[r].NextCell<=0){var T=eR[e].row;var A=eR[r].row;var E=eR[i].row;if(E==T||E==A)return true;for(c=T;c>0;c=$E[c].NextRow){if(c==E)return true;if(c==A)break}}s=G6(e,true);o=s+eR[e].ColSpan-1;_=G6(r,true);u=_+eR[r].ColSpan-1;l=s<_?s:_;a=o>u?o:u;f=G6(i,true);return f>=l&&f<=a?true:false}function Nm(){pB();if(oi.PageMode)return Yz();if(br+1==Ri&&uA==tc.HILIGHT_CHAR&&OA&&jt+1==ui[br].len&&jt>0){jt=0;yn=tc.WRAP_OFF;Br=tc.PAINT_MIN;cG();return true}if(br<=0)return true;if(Vt<0)Vt=Fq(jt,br,tc.TER_CENTER);if(we>0){we--;br--;jt=Oq(Vt,br);if(oi.WordWrap){if(jt>=ui[br].len)jt=ui[br].len-1;if(jt<0)jt=0}yn=tc.WRAP_OFF;Br=tc.PAINT_MIN;cG();return true}else{br--;fr--;we--;jt=Oq(Vt,br);if(oi.WordWrap){we=0;if(jt>=ui[br].len)jt=ui[br].len-1;if(jt<0)jt=0;yn=tc.WRAP_PARA}Br=tc.PAINT_WIN;aa=false;cG();return true}}function Dm(){var t;if(jt==0&&br==0)return true;pB();if(jt==0)t=br-1;else t=br;for(;t>0;t--)if(Nj(ui[t].flags&tc.LFLAG_PARA_FIRST))break;br=t;jt=0;Br=tc.PAINT_WIN;cG();return true}function Mm(){pB();if(oi.PageMode)return Vz();if(br+1>=Ri){if(uA==tc.HILIGHT_CHAR&&OA&&jt+1<ui[br].len){if(oi.WordWrap)jt=ui[br].len-1;else jt=ui[br].len;if(jt<0)jt=0;yn=tc.WRAP_OFF;Br=tc.PAINT_MIN;cG()}return true}if(Vt<0)Vt=Fq(jt,br,tc.TER_CENTER);if(br<pl[0].ScrLastLine){we++;br++;jt=Oq(Vt,br);yn=tc.WRAP_OFF;if(oi.WordWrap){if(jt>=ui[br].len)jt=ui[br].len-1;if(jt<0)jt=0}Br=tc.PAINT_MIN;cG();return true}else{br++;jt=Oq(Vt,br);if(oi.WordWrap){we=Dt-1;fr++}else{we=Dt;fr=br-we}if(fr<0){fr=0;we=br-fr}if(oi.WordWrap){if(jt>=ui[br].len)jt=ui[br].len-1;if(jt<0)jt=0}aa=false;Br=tc.PAINT_WIN;cG()}return true}function Gm(){var t;pB();for(t=br+1;t<Ri;t++)if(Nj(ui[t].flags&tc.LFLAG_PARA_FIRST))break;if(t>=Ri){br=Ri-1;jt=ui[br].len-1}else{br=t;jt=0}Br=tc.PAINT_WIN;cG();return true}function Bm(){var t=0;var e;var r=uA;var i;var f=br,l=jt;if(uA==tc.HILIGHT_CHAR){var a=sA<_A;if(!a&&sA==_A)a=TA<=AA;f=a?_A:sA;l=a?AA:TA}pB();if(r==tc.HILIGHT_CHAR&&uA==tc.HILIGHT_OFF){jt=l;return Iq(f+1)}i=r==tc.HILIGHT_OFF&&uA==tc.HILIGHT_CHAR;if(oi.PageMode)return jz(i);if(oi.WordWrap&&br==Ri-1&&jt+1==ui[br].len)return true;jt++;if(ui[br].len>0){e=ui[br].txt;t=e[ui[br].len-1]}if(oi.WordWrap&&jt>=ui[br].len&&(br+1<Ri||t==Bn)){jt=0;if(br+1<Ri)br++}else{if(!oi.WordWrap&&uA!=tc.HILIGHT_OFF&&sA>_A&&jt>=ui[br].len&&br+1<Ri){br++;jt=0}yn=tc.WRAP_OFF;Br=tc.PAINT_MIN}cG();return true}function Hm(){var t=uA;var e=br,r=jt;if(uA==tc.HILIGHT_CHAR){var i=sA<_A;if(!i&&sA==_A)i=TA<=AA;e=i?sA:_A;r=i?TA:AA}pB();if(t==tc.HILIGHT_CHAR&&uA==tc.HILIGHT_OFF){jt=r;return Iq(e+1)}if(oi.PageMode)return Jz();if(jt>0){jt--;yn=tc.WRAP_OFF;Br=tc.PAINT_MIN;cG();return true}else{if(br!=0){if(we>0){we--;br--;jt=ui[br].len-1;Br=tc.PAINT_MIN;yn=tc.WRAP_MIN;cG();return true}else{br--;we=0;if(br<we)we=br;fr=br-we;jt=ui[br].len-1;Br=tc.PAINT_WIN;cG();return true}}else return true}}function mm(t){var e;if(Ru)return X0(true);if(t)pB();if(oi.PageMode)return zz();if(br==0)return Um();if(Vt<0)Vt=Fq(jt,br,tc.TER_CENTER);if(fr==0){br=we=0;jt=0;Br=tc.PAINT_MIN;yn=tc.WRAP_OFF;cG();return true}e=Dt-St;if(e<=0)e=1;br=br-e;fr=fr-e;if(fr<0){br=we;fr=0}jt=Oq(Vt,br);aa=false;Br=tc.PAINT_WIN;cG();return true}function wm(t){var e;var r;if(Ru)return k0(true);if(t)pB();if(oi.PageMode)return Zz();if(Vt<0)Vt=Fq(jt,br,tc.TER_CENTER);if(pl[0].ScrLastLine>=Ri-1){Xm();var i=ui[Ri-1].len;if(i<0)i=0;_i.SetTerCursorPos(Ri-1,i,true);return true}else{e=pl[0].ScrLastLine-fr+1-St;if(e<=0)e=1;r=km();fr=fr+e;if(fr>=r)fr=r;br=br+e;if(br>=Ri-1)br=Ri-1;if(br<fr)br=fr;we=br-fr}jt=Oq(Vt,br);aa=false;Br=tc.PAINT_WIN;cG();return true}function xm(t){if(Ru)return y0(t);if(oi.PageMode)return fZ(t);if(oi.WordWrap&&!M$()){if(t)Ft-=je/2;else Ft-=je/6;if(Ft<0)Ft=0;BG()}else{if(t)return Wm(gk("L"),0);else return Wm(gk("l"),0)}aa=false;Br=tc.PAINT_WIN;cG();return true}function ym(t){if(Ru)return x0(t);if(oi.PageMode)return lZ(t);if(oi.WordWrap&&!M$()){if(M9(br,-1)<je)return true;if(t)Ft+=je/2;else Ft+=je/6;if(Ft>M9(br,-1)-je)Ft=M9(br,-1)-je;BG()}else{if(t)return Wm(tc.CHAR_R,0);else return Wm(gk("r"),0)}aa=false;Br=tc.PAINT_WIN;cG();return true}function Wm(t,e){var r,i;var f;if(oi.PageMode)return aZ(e);if(oi.WordWrap&&!M$()){if(M9(br,-1)<je)return true;Ft=(M9(br,-1)-je)*e/tc.SCROLL_RANGE;if(Ft>M9(br,-1)-je)Ft=M9(br,-1)-je;BG()}else{r=0;for(f=fr;f<=pl[0].ScrLastLine;f++){i=B$(f,true,true);if(i>r)r=i}if(t==gk("L"))Ft-=je/2;else if(t==gk("l"))Ft-=Gx(0,true,tc.CHAR_M);else if(t==tc.CHAR_R)Ft+=je/2;else if(t==gk("r"))Ft+=Gx(0,true,tc.CHAR_M);else{var l=r,a,n;if(l<je)l=je;a=je*tc.SCROLL_RANGE/l;if(a<ut)a=ut;if(a>tc.SCROLL_RANGE)a=tc.SCROLL_RANGE;n=tc.SCROLL_RANGE-a;if(n>0){Ft=(r-je)*e/n}}if(Ft>r-je)Ft=r-je;if(Ft<0)Ft=0;BG()}aa=false;Br=tc.PAINT_WIN;cG();return true}function Um(){var t=false;var e,r,i;MT=tc.CURS_UP;if(Ru)return X0(false);if(oi.PageMode)return Qz();t:{while(true){e=e$(fr);if(e>Tt&&(Ue>=0||t)){if(Ue==-1&&t)zt=e-Tt;else zt-=Tt/6;if(zt>0)Ue=fr;else Ue=-1;break t}Ue=-1;if(t)break t;if(br<=0&&fr<=0)return true;if(br>0)br--;if(fr>0)fr--;if(fr>br)fr=br;we=br-fr;if(oi.WordWrap){if(jt>=ui[br].len)jt=ui[br].len-1;if(jt<0)jt=0}t=true}}aa=false;Br=tc.PAINT_WIN;cG();return true}function km(){var t=0;var e;for(e=Ri-1;e>=0;e--){t+=$q(e,true);if(t>Tt)break}e++;return e}function Xm(){var t,e,r;MT=tc.CURS_DOWN;if(Ru)return k0(false);if(oi.PageMode)return qz();if(Ri<=Dt&&D$())return true;if(fr>km())return true;t:{t=e$(fr);if(t>Tt){if(Ue==-1)zt=0;zt+=Tt/6;if(zt<t){Ue=fr;break t}if(zt>t)zt=t}else Ue=-1;if(br+1>=Ri&&fr+1>=Ri)return true;if(uA!=tc.HILIGHT_OFF&&OA&&Ri-fr<Dt-1)return true;if(br+1<Ri)br++;if(fr+1<Ri)fr++;if(fr>br)fr=br;we=br-fr;if(oi.WordWrap){if(jt>=ui[br].len)jt=ui[br].len-1;if(jt<0)jt=0}}aa=false;Br=tc.PAINT_WIN;cG();return true}function Km(){var t;var e;if(oi.PageMode)return tZ();jt++;if(jt<ui[br].len){t=ui[br].txt;e=ib(br,jt-1);Ft=Ft+Gx(e,true,t[jt-1])}else{if(oi.WordWrap){if(jt>=ui[br].len)jt=ui[br].len-1;if(jt<0)jt=0;yn=tc.WRAP_OFF}else Ft=Ft+Gx(0,true,tc.SPACE)}BG();aa=false;cG();return true}function Ym(){var t;var e;if(oi.PageMode)return eZ();if(jt==0)return true;jt--;if(jt+1<ui[br].len){t=ui[br].txt;e=ib(br,jt+1);Ft=Ft-Gx(e,true,t[jt+1])}else Ft=Ft-Gx(0,true,tc.SPACE);if(Ft<0)Ft=0;BG();if(oi.WordWrap){if(jt>=ui[br].len)jt=ui[br].len-1;if(jt<0)jt=0;yn=tc.WRAP_OFF}aa=false;Br=tc.PAINT_WIN;cG();return true}function Vm(){var t;if(ya==tc.SPACE)return false;if(Xr&&Wa>xs[0].height*3/2)return false;t:while(true){if(ya==gk("L"))Ym();else if(ya==tc.CHAR_R)Km();else if(ya==tc.CHAR_T){t=rt.top-Ba>=2*xs[0].height;if(oi.PageMode){if(Nj(qh&tc.TFLAG4_SMOOTH_SCROLL)&&!t)Um();else Yz()}else{if(t)mm(false);else Um()}}else if(ya==gk("B")){t=Ba-rt.bottom>=2*xs[0].height;if(oi.PageMode){Zt=tc.ID_DOWN;if(Nj(qh&tc.TFLAG4_SMOOTH_SCROLL)&&!t){var e;var r;Xm();e=Fq(jt,br,tc.TER_CENTER);r=Jq(e,Gt+Mt);if(r!=br){br=r;jt=Oq(e,br)}}else Vz()}else{if(t)wm(false);else Xm()}}if(Xr){if(qt<=0){}}break}return true}function jm(){pB();jt=0;pT=0;Br=tc.PAINT_MIN;cG();return true}function Jm(){pB();if(ui[br].len==0)return true;jt=ui[br].len;if(oi.WordWrap&&jt>0)jt--;Br=tc.PAINT_MIN;cG();return true}function zm(){var t,e,r;pB();jt=0;if(oi.PageMode){if(WR){Lo=0;my(true);e=r=-1;for(t=0;t<Ri;t++){if(Dj(Nc[ui[t].pfmt].flags&tc.PAGE_HDR_FTR))break;if(Nj(ui[t].flags&tc.LFLAG_HDR)&&e==-1)e=t;if(Nj(ui[t].flags&tc.LFLAG_FHDR)&&r==-1)r=t}if(r>=0)Iq(r+2);else if(e>=0)Iq(e+2);else Iq(t+1)}else{for(t=0;t<Ri;t++)if(Dj(Nc[ui[t].pfmt].flags&tc.PAGE_HDR_FTR))break;if(t==Ri)t++;Iq(t+1)}}else Iq(1);return true}function Zm(){pB();jt=ui[Ri-1].len;if(oi.WordWrap)jt--;if(jt<0)jt=0;if(oi.PageMode&&yR){Lo=To-1;if(Lo<0)Lo=0;my(true)}DA=true;if(oi.PageMode)Iq(Ri);else{fr=km();br=Ri-1;we=br-fr;cG()}return true}function Qm(){var t,e,r;var i=false;var f;var l;pB();MT=tc.CURS_FORWARD;e=r=0;t:{e:while(true){f=ui[br].txt;l=nb(br);for(t=jt;t<ui[br].len;t++){r=e;e=l[t];if(i&&f[t]!=tc.SPACE&&f[t]!=tc.TAB&&f[t]!=tc.NBSPACE_CHAR||t>jt&&BY(f[t])||t>jt&&xs[e].FieldId!=xs[r].FieldId){jt=t;break t}if(f[t]==tc.SPACE||f[t]==tc.TAB||f[t]==tc.NBSPACE_CHAR)i=true;if(f[t]==tc.HYPH||t>0&&f[t-1]==tc.HYPH){if(t>jt){jt=t;break t}}}sb(br);if(br+1<Ri){jt=0;br++;we++;i=true;continue e}break}}Iq(br+1);return true}function qm(t){var e,r,i,f;var l=false;var a;var n;pB();MT=tc.CURS_BACKWARD;if(jt>=ui[br].len)f=ui[br].len-2;else f=jt-1;r=i=0;t:{e:while(true){a=ui[br].txt;n=nb(br);for(e=f;e>=0;e--){i=r;r=n[e];if(l&&(a[e]==tc.SPACE||a[e]==tc.TAB||a[e]==tc.NBSPACE_CHAR)||e<f&&xs[r].FieldId!=xs[i].FieldId){jt=e+1;break t}if(a[e]!=tc.SPACE&&a[e]!=tc.TAB&&a[e]!=tc.NBSPACE_CHAR)l=true;if(a[e]==tc.HYPH||e>0&&a[e-1]==tc.HYPH){if(e<jt){jt=e;break t}}}sb(br);if(br>0&&!l){br--;we--;if(Nj(ui[br].flags&(tc.LFLAG_PARA|tc.LFLAG_BREAK))&&ui[br].len>0){jt=ui[br].len-1;break t}f=ui[br].len-2;continue e}jt=0;break}}if(t)Iq(br+1);return true}function $m(){var t=br;var e=jt;if(jt==0&&br>0&&GY(br-1,tc.INFO_ROW|tc.INFO_CELL))return false;var r=br==Ri-1&&jt==ui[br].len;if(!qm(false))return false;sA=br;TA=jt;if(!oi.WordWrap&&TA==0&&sA>0){sA--;TA=ui[sA].len}_A=t;AA=e;uA=tc.HILIGHT_CHAR;_i.TerDeleteBlock(true);if(!oi.WordWrap&&r)_i.SetTerCursorPos(Ri-1,ui[Ri-1].len,true);return true}function tw(){var t=br;var e=jt;var r,i,f,l;var a=false;var n;var c;if(jt==0&&br>0&&GY(br-1,tc.INFO_ROW|tc.INFO_CELL))return false;if(br==Ri-1&&jt+1==ui[br].len)return false;pB();MT=tc.CURS_FORWARD;i=jt;f=l=0;t:{e:while(true){n=ui[br].txt;c=nb(br);for(r=i;r<ui[br].len;r++){l=f;f=c[r];if(a&&(n[r]==tc.SPACE||n[r]==tc.TAB||BY(n[r]))||r<i&&xs[f].FieldId!=xs[l].FieldId){jt=r;break t}if(n[r]!=tc.SPACE&&n[r]!=tc.TAB)a=true}sb(br);if(br+1<Ri&&!a){br++;we++;i=0;continue e}jt=ui[br].len;break}}sA=t;TA=e;_A=br;AA=jt;uA=tc.HILIGHT_CHAR;_i.TerDeleteBlock(true);return true}function ew(t,e,r,i,f,l){var a;var n;var c;if(!MY(Ri+1)){QY(tc.MSG_MAX_LINES_EXCEEDED,"InsertMarkerLine");return false}c=ui[t].fid;iw(t,1,gk("B"));Tm(t,0,1);ui[t].fid=c;a=ui[t].txt;n=nb(t);a[0]=e;n[0]=r;sb(t);if(i>=0)ui[t].pfmt=i;else{if(Nj(Nc[ui[t].pfmt].flags&tc.PAGE_HDR_FTR)!=Nj(Nc[ui[t+1].pfmt].flags&tc.PAGE_HDR_FTR))ui[t].pfmt=ui[t+1].pfmt}if(l>=0)ui[t].cid=l;if(e==Bn||e==TR)ui[t].flags|=tc.LFLAG_PARA;if(Nj(f)){xX(t);ui[t].tabw.type=f}return true}function rw(t,e,r,i){var f,l,a,n,c,s=e;var _;var o=t;PC=t;SC=e;l=a=i.length;t:while(r>0||l>0){if(l==0){while(r>0){n=r;if(s+n>ui[o].len)n=ui[o].len-s;fw(o,s,n,tc.CHAR_D);r-=n;s+=n;if(s>=ui[o].len){o++;if(o>=Ri)break t;s=0}}}else if(r==0){var u=fb(o,s);fw(o,s,l,gk("B"));nw(o,s,l,Uk(cV(i,a-l)),null,null);_=nb(o);for(f=0;f<l;f++)_[s+f]=u;sb(o);s+=l;break t}c=r;if(l<c)c=l;if(ui[o].len-s<c)c=ui[o].len-s;nw(o,s,c,Uk(cV(i,a-l)),null,null);l-=c;r-=c;s+=c;if(s>=ui[o].len){o++;s=0}}PC=o;SC=s;return true}function iw(t,e,r){var i;if(r==tc.CHAR_A){if(!MY(Ri+e))return;if(Ri-t-1>0){eV(ui,t+1,t+e+1,Ri-t-1)}for(i=t+1;i<=t+e;i++)Ip(i);Ri=Ri+e;m5(t,e);if(Fo>t+1)Fo=t+1}else if(r==gk("B")){if(!MY(Ri+e))return;eV(ui,t,t+e,Ri-t);for(i=t;i<t+e;i++)Ip(i);Ri=Ri+e;m5(t-1,e);if(Fo>t)Fo=t}else{for(i=t;i<t+e&&i<Ri;i++){if(Nj(ui[i])&&Nj(ui[i].flags2&tc.LFLAG2_ENOTETEXT))aO|=tc.TOFLAG_UPDATE_ENOTE;dp(i)}if(Ri-t-e>0){eV(ui,t+e,t,Ri-t-e)}Ri=Ri-e;if(Ri<=0){Ri=1;Ip(0)}m5(t,-e);if(Fo>t-1)Fo=t-1}}function fw(t,e,r,i){var f,l;var a;var n;var c,s;var _;var o;var u=Fo;l=ui[t].len;o=ui[t].fmt==null;if(i==tc.CHAR_A){Tm(t,l,l+r);if(e+1<l){n=ui[t].txt;eV(n,e+1,e+1+r,l-e-1);if(!o){c=ui[t].fmt;eV(c,e+1,e+1+r,l-e-1);a=c[e+1+r];for(f=0;f<r;f++)c[e+1+f]=a}if(Nj(ui[t].tag)){s=ui[t].tag;eV(s,e+1,e+1+r,l-e-1);for(f=0;f<r;f++)s[e+1+f]=0}if(Nj(ui[t].cwidth)){_=ui[t].cwidth;eV(_,e+1,e+1+r,l-e-1);for(f=0;f<r;f++)zw(t,e+1+f,0)}}}else if(i==gk("B")){Tm(t,l,l+r);if(e<l){n=ui[t].txt;eV(n,e,e+r,l-e);if(!o){c=ui[t].fmt;eV(c,e,e+r,l-e);a=c[e+r];for(f=0;f<r;f++)c[e+f]=a}if(Nj(ui[t].tag)){s=ui[t].tag;eV(s,e,e+r,l-e);for(f=0;f<r;f++)s[e+f]=0}if(Nj(ui[t].cwidth)){_=ui[t].cwidth;eV(_,e,e+r,l-e);for(f=0;f<r;f++)zw(t,e+f,0)}}}else{if(r<=l){n=ui[t].txt;for(f=0;f<r;f++)if(n[e+f]==tc.SECT_CHAR)lo=UR=true;if(e+r<l){n=ui[t].txt;eV(n,e+r,e,l-e-r);if(!o){c=ui[t].fmt;eV(c,e+r,e,l-e-r)}if(Nj(ui[t].tag)){s=ui[t].tag;eV(s,e+r,e,l-e-r)}if(Nj(ui[t].cwidth)){_=ui[t].cwidth;eV(_,e+r,e,l-e-r)}}Tm(t,l,l-r)}}if(Nj(aO&tc.TOFLAG_INSERT_CHAR))Fo=u;else if(Fo>t)Fo=t;ui[t].flags2=cj(ui[t].flags2,tc.LFLAG2_SPELL_CHECKED)}function lw(t,e,r,i,f){var l,a;var n,c,s,_;l=ui[t].txt;n=nb(t);s=ub(t);if(t==r){eV(l,e,i,f);eV(n,e,i,f);eV(s,e,i,f)}else{a=ui[r].txt;c=nb(r);_=ub(r);qY(l,e,a,i,f);qY(n,e,c,i,f);qY(s,e,_,i,f);cb(r)}cb(t);return}function aw(t,e,r,i,f,l){var a;var n,c;a=ui[t].txt;n=nb(t);c=ub(t);if(Nj(i)){eV(a,e,i,0,r);i[r]=0}if(Nj(f))eV(n,e,f,0,r);if(Nj(l))eV(c,e,l,0,r);cb(t);return}function nw(t,e,r,i,f,l){var a;var n,c;a=ui[t].txt;n=nb(t);c=ub(t);if(Nj(i))eV(i,0,a,e,r);if(Nj(f))eV(f,0,n,e,r);if(Nj(l))eV(l,0,c,e,r);cb(t);return}function cw(t,e){var r;var i;var f,l;r=ui[t].len;Tm(e,0,r);if(r==0)return;i=[r+1];f=[r];l=[r];aw(t,0,r,i,f,l);nw(e,0,r,i,f,l);ui[e].pfmt=ui[t].pfmt;ui[e].cid=ui[t].cid;ui[e].fid=ui[t].fid;ui[e].flags=ui[t].flags;return}function sw(t,e,r){var i,f=null;var l;var a,n;f=Uk(t);a=f.length;if(r+a>ui[e].len)Tm(e,ui[e].len,r+a);i=ui[e].txt;l=nb(e);for(n=0;n<a;n++){i[r+n]=f[n];l[r+n]=vy(l[r+n],i[r+n])}return true}_i.TerSelectParaText=function(t){var e;if(!_i.TerCreateControl())return false;for(e=br;e>0;e--)if(e==0||Nj(ui[e].flags&tc.LFLAG_PARA_FIRST))break;sA=e;TA=0;for(e=br;e<Ri-1;e++)if(Nj(ui[e].flags&tc.LFLAG_PARA))break;_A=e;AA=ui[e].len;if(AA<0)AA=0;OA=false;uA=tc.HILIGHT_CHAR;if(t)cG();return true};_i.TerInsertDate=function(t,e){var r;if(!lv||!QD())_i.TerCreateControl();if(t!=null&&t.length>0)return _w(tc.FIELD_DATE,t);var i=_i.DlgCompHeight;var f=_i.DlgFont;var l=new $t.DialogBox(te,"Insert Current Date/Time",f,true,o,JV(2));var a=l.cvs;var n=new $t.ListBox(a,0,0,JV(300),JV(225),f,true,true,u);l.addComp(n,0,0,1,1,"Left","middle",0,0,JV(10),0);var c=[];var s=[];for(r=0;r<tg.TotalDateFmts;r++){var _=GX("",tg.DateFieldText[r],-2);c.push(_);s.push(tg.DateFieldText[r])}n.setItems(c,s,0,false);l.show();n.setFocus();function o(t,e,r){if(t=="Cancel"){l.hide();return}else if(t=="OK"){T()}}function u(t,e,r){if(t=="dblclick"||t=="enter"){T();l.hide()}}function T(){t=n.getSelectedItemData();l.hide();return _w(tc.FIELD_DATE,t)}return};_i.TerInsertUserField=function(t){if(!lv||!QD())_i.TerCreateControl();return _w(tc.FIELD_USER1,"")};_i.TerSetUserField=function(t){if(!lv||!QD())_i.TerCreateControl();if(t==null)t="";DO=t;return true};_i.TerInsertDynamicField=function(t,e,r,i){var f=-1;if(!_i.TerCreateControl())return false;if(e==null||e.length==0)return false;f=$w();Oc=_i.TerGetFieldFont(f,t,r);_i.InsertTerText(e,i);Oc=-1;oi.modified++;_z(true);return true};function _w(t,e){var r;var i,f;var l;var a;var n;if(ui[br].len>=0&&jt>=ui[br].len)return true;uA=tc.HILIGHT_OFF;l=Rw(ib(br,jt),t,0,e,br,jt);Oc=-1;if(l<0||xs[l].FieldId!=t)return false;l=zb(l);if(t==tc.FIELD_DATE)r=GX("",e,l);else if(t==tc.FIELD_TIME)r=GX("TIME",e,l);else if(t==tc.FIELD_USER1)r="USER1";else r=mY(Lo+1);f=r.length;fw(br,jt,f,gk("B"));V8(br,jt,br,jt+f-1,tc.CHAR_I);a=ui[br].txt;n=nb(br);for(i=jt;i<jt+f;i++){a[i]=Uk(r)[i-jt];n[i]=l}jt+=f;sb(br);cG();return true}_i.TerUpdateDynField=function(t){var e;if(!lv||!QD())_i.TerCreateControl();_i.TerRepaginate(false);for(e=0;e<Ri;e++)ow(e,ui[e].page);if(t)cG();return true};function ow(t,e){var r,i,f,l,a,n,c,s,_=0,o;var u,T=0,A,E,R,L=0,C,I,d,F,g;var P;var S;var h;var O,v,p="";var N;var D=t,M=0;var G=0,B,H;var m,w,b,x;var y;var W,U;d=g=po[e].DispNbr;F=po[e].TopSect;o=to[F].PageNumFmt;if(o==tc.NBR_UPR_ALPHA)O=KX(d,true);else if(o==tc.NBR_LWR_ALPHA)O=KX(d,false);else if(o==tc.NBR_UPR_ROMAN)O=YX(d,true);else if(o==tc.NBR_LWR_ROMAN)O=YX(d,false);else O=mY(d);E=O.length;d=To;if(Nj(iO&tc.TFLAG9_DONT_COUNT_LAST_BLANK_PAGE)&&d>0&&_i.TerIsBlankPage(d-1))d--;G=d;if(o==tc.NBR_UPR_ALPHA)v=KX(d,true);else if(o==tc.NBR_LWR_ALPHA)v=KX(d,false);else if(o==tc.NBR_UPR_ROMAN)v=YX(d,true);else if(o==tc.NBR_LWR_ROMAN)v=YX(d,false);else v=mY(d);R=v.length;if(ro>1){M=po[e].TopSect;d=1;for(i=e-1;i>=0&&po[i].TopSect==M;i--)d++;for(i=e+1;i<To&&po[i].TopSect==M;i++)d++;if(o==tc.NBR_UPR_ALPHA)p=KX(d,true);else if(o==tc.NBR_LWR_ALPHA)p=KX(d,false);else if(o==tc.NBR_UPR_ROMAN)p=YX(d,true);else if(o==tc.NBR_LWR_ROMAN)p=YX(d,false);else p=mY(d);L=p.length}var k=Eo;JO=mY(k);u=JO.length;if(E<u){O=yY(O,u);E=O.length}if(R<u){v=yY(v,u);R=v.length}if(L<u&&ro>1){p=yY(p,u);L=p.length}t:while(true){u=ui[t].len;if(u==0)return true;if(T>=u){if(t+1>=Ri)return true;l=ib(t+1,0);if(xs[l].FieldId!=tc.FIELD_PAGE_NUMBER&&xs[l].FieldId!=tc.FIELD_PAGE_COUNT&&xs[l].FieldId!=tc.FIELD_SECT_PAGE_COUNT&&xs[l].FieldId!=tc.FIELD_FILE_NAME&&!uw(l))return true;h=nb(t+1);I=0;for(i=0;i<ui[t+1].len;i++){if(xs[h[i]].FieldId!=tc.FIELD_PAGE_NUMBER&&xs[h[i]].FieldId!=tc.FIELD_PAGE_COUNT&&xs[h[i]].FieldId!=tc.FIELD_SECT_PAGE_COUNT&&xs[h[i]].FieldId!=tc.FIELD_FILE_NAME&&!uw(h[i]))break;I++}sb(t+1);n=oi.modified;if(I>0)fw(t+1,0,I,tc.CHAR_D);oi.modified=n;return true}h=nb(t);for(i=T;i<u;i++){var X=xs[h[i]].FieldId;if(Iw(X)){if((X==tc.FIELD_DATE||X==tc.FIELD_TIME)&&Nj(qh&tc.TFLAG4_DISABLE_DATE_UPDATE))continue;if(X!=tc.FIELD_PRINTDATE)break;else if(Eu&&!Ru)break}}if(i==u){sb(t);return true}a=h[i];r=xs[h[i]].FieldId;S=xs[h[i]].FieldCode;f=i;A=1;for(i=f+1;i<u;i++){if(xs[h[i]].FieldId!=r||!Cw(xs[h[i]].FieldCode,S))break;A++}sb(t);var K=false;if((r==tc.FIELD_PAGE_NUMBER||r==tc.FIELD_PAGE_COUNT)&&S!=null){if(S.indexOf("ALPHABETIC")>=0)K=true;else if(S.indexOf("alphabetic")>=0)K=true;else if(S.indexOf("CardText")>=0)K=true;else if(S.indexOf("GB4")>=0)K=true}if(r==tc.FIELD_DATE||r==tc.FIELD_TIME||r==tc.FIELD_PRINTDATE||r==tc.FIELD_LISTNUM||r==tc.FIELD_AUTONUMLGL||r==tc.FIELD_USER1||r==tc.FIELD_PAGE_REF||r==tc.FIELD_REF||r==tc.FIELD_SEQ||r==tc.FIELD_FILE_NAME||r==tc.FIELD_DOC_PROP||r==tc.FIELD_FORMULA||K){var Y="";if(i==u){B=t+1;var V=0;while(true){c=ib(B,V);if(xs[c].FieldId!=r)break;A++;if(!Rm(B,V))break;B=PC;V=SC}}s=fb(t,f);if(xs[s].FieldId==r&&Cw(xs[s].FieldCode,S)){T=f+A;if(T>=u)return true;else continue t}if(K){if(r==tc.FIELD_PAGE_NUMBER||r==tc.FIELD_PAGE_COUNT){var j=g;if(r==tc.FIELD_PAGE_COUNT)j=G;if(S.indexOf("ALPHABETIC")>=0)Y=KX(j,true);else if(S.indexOf("alphabetic")>=0)Y=KX(j,false);else if(S.indexOf("CardText")>=0){Y=eK(j,false,false,0);Y=Y.toLowerCase()}else if(S.indexOf("GB4")>=0){var J=VX(j,false);Y="("+J+")"}}}else if(r==tc.FIELD_DATE||r==tc.FIELD_PRINTDATE)Y=GX("",S,a);else if(r==tc.FIELD_TIME)Y=GX("TIME",S,a);else if(r==tc.FIELD_SEQ){Y=Tw(t,f)}else if(r==tc.FIELD_LISTNUM){Y="List";if(Nj(ui[t].tabw)&&_<ui[t].tabw.ListnumCount){Y=ui[t].tabw.pListnum[_].text;_++}}else if(r==tc.FIELD_AUTONUMLGL){Y="1";if(Nj(ui[t].tabw)&&Nj(ui[t].tabw.pAutoNumLgl)){Y=ui[t].tabw.pAutoNumLgl;if(Dj(S)||S.length==0||S.indexOf("\\e")<0)Y+="."}}else if(r==tc.FIELD_PAGE_REF&&oi.PageMode){var z=S.indexOf("\\* alphabetic")>=0;var Z=S.indexOf("\\p")>=0;m=S.length;var Q=0;W=Uk(S);for(i=0;i<m&&W[i]!=tc.SPACE;i++);y=cV(S,0,i);for(i=1;i<Ac;i++){if(ac[i].InUse&&ac[i].type==tc.TERTAG_BKM&&nV(ac[i].name,y))break}if(i<Ac){var q=ac[i].line;if(q>=0&&q<Ri)Q=ui[q].page}if(Q<0)Q=0;if(Q>=To)Q=To-1;Q=po[Q].DispNbr;if(z)Y=KX(Q,false);else Y=Q.toString();if(Z)Y="on page "+Y}else if(r==tc.FIELD_REF&&oi.PageMode){var $=S.indexOf("\\r")>=0;var tt=S.indexOf("\\w")>=0;var et=S.indexOf("\\n")>=0;m=S.length;var rt;var it=t;Y=" ";if(tt||$||et){var ft=-1;var lt=0;W=Uk(S);for(i=0;i<m&&W[i]!=tc.SPACE;i++);y=cV(S,0,i);for(i=1;i<Ac;i++){if(ac[i].InUse&&ac[i].type==tc.TERTAG_BKM&&nV(ac[i].name,y))break}rt="";if(i<Ac){ft=ac[i].line;while(Dj(ui[ft].flags&tc.LFLAG_PARA_FIRST)&&ft>0)ft--;if(ui[ft].tabw!=null&&ui[ft].tabw.ListText!=null)rt=ui[ft].tabw.ListText}u=rt.length;var at=Uk(rt);for(i=u-1;i>=0;i--)if(at[i]!=tc.SPACE&&at[i]!=tc.TAB&&at[i]!=tc.PERIOD)break;rt=cV(rt,0,i+1);lt=0;if($&&ft>=0){var nt=it<ft?it:ft;var ct=it>ft?it:ft;var st;H=ui[ft].pfmt;w=Nc[H].BltId;b=xc[w].ls;x=xc[w].lvl;lt=x;for(st=nt;st<=ct;st++){H=ui[st].pfmt;w=Nc[H].BltId;if(xc[w].ls==0)continue;if(Jc[xc[w].ls].ListIdx!=Jc[b].ListIdx)continue;if(xc[w].lvl<lt)lt=xc[w].lvl;if(lt==0)break}tt=true}while(tt&&ft>=0){var _t=new tc.ClsListLevel;H=ui[ft].pfmt;w=Nc[H].BltId;b=xc[w].ls;x=xc[w].lvl;if(x==0)break;if((_t=sQ(xc[w].ls,xc[w].lvl))!=null){u=_t.txt[0];for(i=0;i<u;i++)if(_t.txt[i+1]<x)x=_t.txt[i+1]}if(x<=lt)break;for(B=ft-1;B>=0;B--){var ot=new tc.ClsListLevel;var ut=ui[B].pfmt;var Tt=Nc[ut].BltId;var At=xc[Tt].ls,Et=xc[Tt].lvl;if(At==0)continue;if(Jc[b].ListIdx!=Jc[At].ListIdx)continue;if(Et<x){var Rt="";if(ui[B].tabw!=null&&ui[B].tabw.ListText!=null)Rt=ui[B].tabw.ListText;u=Rt.length;if(u>0){var Lt=Uk(Rt);for(i=u-1;i>=0;i--)if(Lt[i]!=tc.SPACE&&Lt[i]!=tc.TAB&&Lt[i]!=tc.PERIOD)break;Rt=cV(Rt,0,i+1);rt=Rt+rt;if((ot=sQ(xc[Tt].ls,xc[Tt].lvl))!=null){u=ot.txt[0];for(i=0;i<u;i++)if(ot.txt[i+1]<Et)Et=ot.txt[i+1]}x=Et}}if(Et<=lt)break}ft=B}Y=rt}else Y=""}else if(r==tc.FIELD_FILE_NAME){if(ih==null||ih.length==0)Y="";else{var Ct=Uk(ih);var It=ih.length;for(i=It-1;i>=0;i--){if(tg.IsWindows){if(Ct[i]==tc.BACK_SLASH||Ct[i]==gk(":"))break}else if(Ct[i]==gk("/"))break}if(i==It-1)Y="";else Y=cV(ih,i+1,It-i-1)}}else if(r==tc.FIELD_DOC_PROP){if(S=="FullName"||S.indexOf('"'+"FullName"+'"')>=0||S.indexOf("FullName ")>=0){var dt=CO[tc.INFO_AUTHOR];if(dt==null||dt.length==0)Y="";else Y=dt}}else if(r==tc.FIELD_USER1){var Ft=Lq(t,f);DO="USER1";UD(tc.TER_USER_FIELD1,e,Ft,false);Y=DO}if(Y.length==0)T=f+A;else{rw(t,f,A,Y);t=PC;f=SC;T=f}if(t>D)return true;continue t}if(r==tc.FIELD_PAGE_NUMBER)C=E;else if(r==tc.FIELD_SECT_PAGE_COUNT&&ro!=1)C=L;else C=R;if(r==tc.FIELD_PAGE_NUMBER)N=O;else if(r==tc.FIELD_SECT_PAGE_COUNT&&ro!=1)N=p;else N=v;if(C<=A){P=ui[t].txt;h=nb(t);U=Uk(N);for(i=f;i<f+C;i++){P[i]=U[i-f];h[i]=h[f]}T=i;if(C<A){n=oi.modified;fw(t,T,A-C,tc.CHAR_D);oi.modified=n}}else{P=ui[t].txt;U=Uk(N);for(i=f;i<f+A;i++)P[i]=U[i-f];T=i;n=oi.modified;fw(t,T,C-A,gk("B"));oi.modified=n;P=ui[t].txt;h=nb(t);U=Uk(N);for(i=T;i<f+C;i++){P[i]=U[i-f];h[i]=h[f]}sb(t);T=i}}}function uw(t){var e="FullName";var r;if(xs[t].FieldId!=tc.FIELD_DOC_PROP)return false;e=zk(e);r=xs[t].FieldCode;if(r=="FullName"||r.indexOf(e)>=0||r.indexOf("FullName ")>=0)return true;else return false}function Tw(t,e){var r;var i,f,l=0,a,n;var c=false,s=true;var _="",o="";var u="";for(f=t;f>=0;f--){if(Dj(ui[f].flags2&tc.LFLAG2_SEQ))continue;r=nb(f);if(f==t)a=e;else a=ui[f].len-1;for(i=a;i>=0;i--){var T="",A="";n=xs[r[i]].FieldId;if(xs[r[i]].FieldCode!=null){A=xs[r[i]].FieldCode;T=Aw(A)}if(s){_=T;o=A;s=false}if(c){if(n!=tc.FIELD_SEQ||Tk(_,T)!=0)c=false;continue}if(n==tc.FIELD_SEQ&&Tk(_,T)==0){var E=IQ(A,"\\r");if(E!=null&&E.length>0){var R=LX(E);l+=R;f=0;break}l++;c=true}}}o=o.toUpperCase();if(o.indexOf("ALPHABETIC")>0){if(o.indexOf("CAPS")>0)u=KX(l,true);else u=KX(l,false)}else if(o.indexOf("ROMAN")>0){u=YX(l,true)}else u=l.toString();return u}function Aw(t){var e,r;var i;r="";e=t.trim();if(e.length==0)return"";var f=Uk(e);if(f[0]==tc.CHAR_QUOTE){var l;r=e.substring(1);if((l=r.indexOf('"'))>=0)r=cV(r,0,l);return r}else{var a=e.length;for(i=0;i<a&&f[i]!=tc.SPACE&&f[i]!=tc.BACK_SLASH;i++)continue;r=cV(e,0,i);r.trim();return r}}function Ew(t,e,r){if(Nj(xs[t].style&tc.PICT))return t;var i=xs[t].AuxId;if(xs[t].FieldId==tc.FIELD_TEXTBOX&&e!=tc.FIELD_TEXTBOX&&i>=5e3)i=0;return Rb(Ti,t,xs[t].TypeFace,xs[t].TwipsSize,xs[t].style,xs[t].TextColor,xs[t].TextBkColor,xs[t].UlineColor,e,i,xs[t].Aux1Id,xs[t].CharStyId,xs[t].ParaStyId,xs[t].expand,xs[t].TempStyle,xs[t].lang,r,xs[t].offset,xs[t].CharSet,xs[t].flags,xs[t].TextAngle)}_i.TerSetTcField=function(t,e){var r;if(!lv||!QD())_i.TerCreateControl();if(k_>=0)return false;if(t<1||t>9)return false;r="\\tcl"+mY(t);return qb(tc.CMASK_FIELD,tc.FIELD_TC,0,r,e)};function Rw(t,e,r,i,f,l){var a,n;var c;a=t;c=xs[a].style;var s=xs[a].AuxId;if(xs[a].FieldId==tc.FIELD_TEXTBOX&&e!=tc.FIELD_TEXTBOX&&s)s=0;if((n=Rb(Ti,a,xs[a].TypeFace,xs[a].TwipsSize,c,xs[a].TextColor,xs[a].TextBkColor,xs[a].UlineColor,e,s,xs[a].Aux1Id,xs[a].CharStyId,xs[a].ParaStyId,xs[a].expand,xs[a].TempStyle,xs[a].lang,i,xs[a].offset,xs[a].CharSet,xs[a].flags,xs[a].TextAngle))>=0){return n}else return t}function Lw(t,e){if(xs[t].FieldId==0||xs[e].FieldId==0)return false;if(t==e)return true;if(xs[t].FieldId!=xs[e].FieldId)return false;return Cw(xs[t].FieldCode,xs[e].FieldCode)}function Cw(t,e){if(t==null)t="";if(e==null)e="";if(t==""&&e=="")return true;if(nV(t,"*")||nV(e,"*"))return true;return nV(t,e)}function Iw(t){return t==tc.FIELD_PAGE_NUMBER||t==tc.FIELD_PAGE_COUNT||t==tc.FIELD_SECT_PAGE_COUNT||t==tc.FIELD_DATE||t==tc.FIELD_TIME||t==tc.FIELD_PRINTDATE||t==tc.FIELD_LISTNUM||t==tc.FIELD_USER1||t==tc.FIELD_AUTONUMLGL||t==tc.FIELD_PAGE_REF||t==tc.FIELD_REF||t==tc.FIELD_SEQ||t==tc.FIELD_FILE_NAME||t==tc.FIELD_DOC_PROP||t==tc.FIELD_FORMULA}_i.TerGetFieldFont=function(t,e,r){if(t<0||t>=Ys||!xs[t].InUse)return-1;if(xs[t].FieldId==e&&Cw(xs[t].FieldCode,r))return t;if(Nj(xs[t].style&tc.PICT)){xs[t].FieldId=e;xs[t].FieldCode=r;return t}return Rw(t,e,0,r,0,0)};_i.TerLocateFieldChar=function(t,e,r,i,f,l){var a;var n,c,s,_;var o;var u;if(!lv||!QD())_i.TerCreateControl();zC=i;ZC=f;if(t==0)e=null;if(l){for(a=i;a<Ri;a++){if(a==i)c=f;else c=0;if(c>=ui[a].len)continue;if(ui[a].len==0)continue;if(ui[a].fmt==null){s=ui[a].UniFmt;_=xs[s].FieldId;u=xs[s].FieldCode;if(Dj(e))u=null;if(r&&_==t&&Cw(e,u)||!r&&(_!=t||!Cw(e,u))){zC=a;ZC=c;return true}else continue}o=nb(a);for(n=c;n<ui[a].len;n++){s=o[n];_=xs[s].FieldId;u=xs[s].FieldCode;if(Dj(e))u=null;if(r&&_==t&&Cw(e,u)||!r&&(_!=t||!Cw(e,u))){zC=a;ZC=n;sb(a);return true}}sb(a)}}else{for(a=i;a>=0;a--){if(a==i)c=f;else c=ui[a].len-1;if(c<0)continue;if(ui[a].len==0)continue;if(ui[a].fmt==null){s=ui[a].UniFmt;_=xs[s].FieldId;u=xs[s].FieldCode;if(Dj(e))u=null;if(r&&_==t&&Cw(e,u)||!r&&(_!=t||!Cw(e,u))){zC=a;ZC=c;return true}else continue}o=nb(a);for(n=c;n>=0;n--){s=o[n];_=xs[s].FieldId;u=xs[s].FieldCode;if(Dj(e))u=null;if(r&&_==t&&Cw(e,u)||!r&&(_!=t||!Cw(e,u))){zC=a;ZC=n;sb(a);return true}}sb(a)}}return false};_i.TerSetMergeDelim=function(t){MergeDelim=t.charCodeAt(0);return true};_i.TerMergeFields=function(t,e,r){var i,f,l,a=tc.MAX_FIELDS;var n,c,s,_,o,u;var T;var A=null;var E,R;var L,C;var I=false,d=false;var F=null;if(!lv||!QD())_i.TerCreateControl();if(t==null||e==null)return true;if(t.length==0)return true;t:{F=[a+1];n=0;var g=-1,P;while((P=t.indexOf(MergeDelim,g+1))>=0){F[n]=new tc.ClsMergeData;F[n].pName=cV(t,g+1,P-g-1);n++;if(n>=a){a=a+tc.MAX_FIELDS;F=fV(F,a+1)}g=P}if(g<t.length&&n<a){F[n]=new tc.ClsMergeData;F[n].pName=cV(t,g+1);n++}c=0;g=-1;while((P=e.indexOf(MergeDelim,g+1))>=0){if(F[c]==null)F[c]=new tc.ClsMergeData;F[c].pData=cV(e,g+1,P-g-1);c++;if(c>=a)break;g=P}if(g<e.length&&c<a){if(F[c]==null)F[c]=new tc.ClsMergeData;F[c].pData=cV(e,g+1);c++}if(n!=c||c==a){QY(tc.MSG_COUNT_MISMATCH,"");break t}T=0;_=0;while(_i.TerLocateStyle(tc.FIELD_NAME_STYLE,T,_)){T=PC;_=SC;s=yC;u=o=0;E=ui[T].txt;for(i=0;i<s;i++)if(E[i+_]!=Bn&&E[i+_]!=TR&&!xY(qS,E[i+_]))break;_+=i;s-=i;if(s==0)continue;A=lV(E,_,s);if(_+s>=ui[T].len&&Dj(ui[T].flags&(tc.LFLAG_PARA|tc.LFLAG_BREAK))){var S=T+1;var h=false;while(S<Ri&&!h){if(ui[S].len>0){var O=ui[S].txt;var v;var p=0,N;v=nb(S);for(i=0;i<ui[S].len;i++){if(Dj(xs[v[i]].style&tc.FIELD_NAME_STYLE))break;if(O[i]==Bn||O[i]==TR||xY(qS,O[i]))h=true;if(h)break}sb(S);p=i;N=ui[T].len;if(p==0||p+N>=tc.MAX_WIDTH)break;Tm(T,N,N+p);lw(S,0,T,N,p);O=ui[S].txt;A=aV(O,0,p,A);s=A.length;fw(S,0,p,tc.CHAR_D);if(ui[S].len>0)break}S++}}f=s;for(i=s-1;i>=0;i--)if(A[i]!=Bn&&A[i]!=TR&&!xY(qS,A[i]))break;s=i+1;for(i=0;i<s;i++)if(A[i]!=tc.SPACE)break;o=i;_+=o;if(o==s)continue;for(i=o;i<s;i++)A[i-o]=A[i];s-=o;for(i=s-1;i>=0;i--)if(A[i]!=tc.SPACE)break;u=s-i-1;s-=u;if(s!=f)A=fV(A,s);f=s;for(i=0;i<n;i++){var D=Wk(A,0,s);if(Tk(F[i].pName,D)==0)break}e:{if(i==n){var M;l=f;if((M=XD(Wk(A,0,f)))==null)break e;R=Uk(M);l=R.length}else{R=Uk(F[i].pData);l=R.length}if(l>tc.MAX_DATA_LEN){if(oi.WordWrap)I=true;else{QY(tc.MSG_MERGE_DATA_TOO_LONG,"");break t}}if(l>f)fw(T,_+f-1,l-f,tc.CHAR_A);if(l<f)fw(T,_+l,f-l,tc.CHAR_D);E=ui[T].txt;for(i=0;i<l;i++){E[_+i]=R[i]}ab(T);L=uP;C=oP;for(i=f;i<l;i++){L[_+i]=L[_+f-1];C[_+i]=0}cb(T);uA=tc.HILIGHT_CHAR;sA=_A=T;TA=_-o;AA=_+l+u;_i.SetTerCharStyle(tc.FIELD_NAME_STYLE,false,false);oi.modified++}_+=l+u}if(I)_i.TerRewrap();if(r)cG();d=true}return d};_i.TerInsertField=function(i,f,l){var t,e,r;var a,n,c,s;var _;if(!lv||!QD())_i.TerCreateControl();if(!dm(br,jt))return false;if(i!=null&&i.length>0)return dw(i,f,l);var o=_i.DlgCompHeight;var u=_i.DlgFont;var T=new $t.DialogBox(te,"Data Field Parameters",u,true,I,JV(2));var A=T.cvs;var E=new $t.Label(A,0,0,u,"Field Name");T.addComp(E,0,0,1,3,"Left","bottom");var R=new $t.TextBox(A,0,0,JV(400),o,"",u,_i.caret,false,true,null);T.addComp(R,1,0,1,3,"left","middle");var L=new $t.Label(A,0,0,u,"Field Data");T.addComp(L,3,0,1,3,"Left","bottom");var C=new $t.TextBox(A,0,0,JV(400),o,"",u,_i.caret,false,true,null);T.addComp(C,4,0,1,3,"left","middle");T.show();R.setFocus();function I(t,e,r){if(t=="Cancel"){T.hide();return}else if(t=="OK"){i=R.getText();if(i.length==0){return}f=C.getText();T.hide();return dw(i,f,l)}else return}};function dw(t,e,r){SaveFontId=$w();BegLine=br;BegCol=jt;SaveFlags=nO;nO|=tc.TOFLAG2_NO_SAVE_UNDO;uA=tc.HILIGHT_OFF;var i=Oc>=0&&Nj(xs[Oc].style&tc.PROTECT);FldFont=Rw(SaveFontId>=0?SaveFontId:ib(br,jt),tc.FIELD_NAME,0,null,br,jt);if(!i)FldFont=Nb(FldFont,tc.PROTECT,0,"",br,-1);ProtFldFont=Nb(FldFont,tc.PROTECT,1,"",br,-1);Oc=ProtFldFont;qN("{",null,null,false);Oc=FldFont;qN(t,null,null,false);Oc=ProtFldFont;qN("}",null,null,false);Oc=SaveFontId;if(Nj(e)&&e.length>0){uA=tc.HILIGHT_OFF;Oc=Rw(Oc,tc.FIELD_DATA,0,null,br,jt);qN(e,null,null,false)}nO=SaveFlags;EndLine=br;EndCol=jt;Em(EndLine,EndCol);EndLine=PC;EndCol=SC;V8(BegLine,BegCol,EndLine,EndCol,tc.CHAR_I);Oc=-1;oi.modified++;if(r)cG();return true}_i.TerGetField=function(t,e,r){var i,f,l,a;var n;var c,s,_;if(!lv||!QD())_i.TerCreateControl();vP="";if(r!=tc.FIELD_NAME&&r!=tc.FIELD_DATA)return 0;if(t<0){t=br;e=jt}if(!Sw(t,e,r))return 0;s=rI;i=$C;_=iI;f=eI;if(r==tc.FIELD_NAME){i++;Am(s,i);s=PC;i=SC;f--;Am(_,f);_=PC;f=SC;if(s==_&&f<=i)return 0}for(c=s;c<=_;c++){l=c==s?i:0;a=c==_?f:ui[c].len;n=ui[c].txt;vP+=Wk(n,l,a-l)}return vP.length};_i.TerChangeField=function(t,e,r){var i=tc.TER_FIRST,f,l;var a,n;var c=-1,s;var _=false;var o=false;if(!lv||!QD())_i.TerCreateControl();while(true){if(!_i.TerLocateField(i,t,true,false))break;l=jt;n=br;s=ib(br,jt+1);_=Nj(xs[s].style&tc.PROTECT)&&Dj(zh&tc.TFLAG_UNPROTECTED_DEL);if(Pw(br,jt,tc.FIELD_DATA)){a=sA;f=TA;c=ib(a,f);if(!_)_=Nj(xs[c].style&tc.PROTECT)&&Dj(zh&tc.TFLAG_UNPROTECTED_DEL);if(!_){uA=tc.HILIGHT_CHAR;OA=false;aO|=tc.TOFLAG_NO_FIELD_ADJ;_i.TerDeleteBlock(false);uA=tc.HILIGHT_OFF;oj(tc.TOFLAG_NO_FIELD_ADJ)}else{a=_A;f=AA;o=true}}else{if(!hw(br,jt,false))return false;a=PC;f=SC}br=a;jt=f;if(!_&&e.length>0){uA=tc.HILIGHT_OFF;if(c>=0&&Dj(xs[c].style&tc.PICT))Oc=c;else Oc=Rw(lb(n,l),tc.FIELD_DATA,0,null,br,jt);nO|=tc.TOFLAG2_NO_SET_LANG;qN(e,null,null,false);nO=_j(nO,tc.TOFLAG2_NO_SET_LANG);Oc=-1}i=tc.TER_NEXT;jt--;Am()}jt++;Am();n9();if(r)cG();return i!=tc.TER_FIRST&&!o};_i.TerChangeFieldPicture=function(t,e,r){var f='{\\rtf1 {\\field{\\*\\fldinst tc.INCLUDEPICTURE "';var l=Uk(e);for(i=0;i<e.length;i++){if(l[i]==tc.BACK_SLASH)f+="\\\\\\\\";else f+=l[i]}f+='" \\\\d}{\\fldrslt}}}';return TerChangeFieldRtf(t,f,r)};_i.TerChangeFieldRtf=function(t,e,r){var i=tc.TER_FIRST,f,l,a;var n,c,s,_,o,u,T,A;var E;if(!lv||!QD())_i.TerCreateControl();while(true){if(!_i.TerLocateField(i,t,true,false))break;if(Pw(br,jt,tc.FIELD_DATA)){s=sA;f=TA;uA=tc.HILIGHT_CHAR;OA=false;aO|=tc.TOFLAG_NO_FIELD_ADJ;_i.TerDeleteBlock(false);uA=tc.HILIGHT_OFF;aO=_j(aO,tc.TOFLAG_NO_FIELD_ADJ)}else{if(!hw(br,jt,false))return false;s=PC;f=SC}br=s;jt=f;_=Lq(s,f);if(e!=null&&e.length>0){uA=tc.HILIGHT_OFF;cO|=tc.TOFLAG3_IN_DATA_FIELD;_i.InsertRtfBuf(e,-1,0,false);Tj(tc.TOFLAG3_IN_DATA_FIELD);Oc=-1;Cq(_);o=PC;u=SC;T=br;A=jt;for(c=o;c<=T;c++){l=c==o?u:0;a=c==T?A:ui[c].len;E=nb(c);for(n=l;n<a;n++){if(Nj(xs[E[n]].style&tc.PICT))xs[E[n]].FieldId=tc.FIELD_DATA;else E[n]=Rw(E[n],tc.FIELD_DATA,0,null,c,n)}sb(c)}}i=tc.TER_NEXT;jt--;Am()}jt++;Am();n9();if(r)cG();return i!=tc.TER_FIRST};_i.TerDeleteField=function(t){var e,r;var i;if(!lv||!QD())_i.TerCreateControl();e=ib(br,jt);r=xs[e].FieldId;if(r!=tc.FIELD_NAME&&r!=tc.FIELD_DATA)return false;if(!Pw(br,jt,tc.FIELD_NAME))return false;e=ib(_A,AA);r=xs[e].FieldId;if(r==tc.FIELD_DATA){var f,l;if(!hw(_A,AA,false))return false;f=PC;l=SC;_A=f;AA=l}uA=tc.HILIGHT_CHAR;OA=false;i=zh;zh|=tc.TFLAG_UNPROTECTED_DEL;aO|=tc.TOFLAG_NO_FIELD_ADJ;_i.TerDeleteBlock(t);zh=i;uA=tc.HILIGHT_OFF;oj(tc.TOFLAG_NO_FIELD_ADJ);return true};_i.TerSelectField=function(t,e){var r,i;r=ib(br,jt);i=xs[r].FieldId;if(i!=tc.FIELD_NAME&&i!=tc.FIELD_DATA)return false;if(!Pw(br,jt,t?tc.FIELD_DATA:tc.FIELD_NAME))return false;uA=tc.HILIGHT_CHAR;OA=false;if(e)cG();return true};_i.TerLocateField=function(t,e,r,i){var f,l,a;var n;if(!lv||!QD())_i.TerCreateControl();if(t!=tc.TER_FIRST&&t!=tc.TER_LAST&&t!=tc.TER_NEXT&&t!=tc.TER_PREV)return false;n=br;f=jt;if(t==tc.TER_FIRST){n=0;f=0}if(t==tc.TER_LAST){n=Ri-1;f=ui[n].len-1;Am(n,f);n=PC;f=SC}l=ib(n,f);a=xs[l].FieldId;t:{if(a==tc.FIELD_NAME||a==tc.FIELD_DATA){if(t==tc.TER_FIRST||t==tc.TER_LAST){if(Fw(n,f,e,r))break t}}if(t==tc.TER_FIRST)t=tc.TER_NEXT;if(t==tc.TER_LAST)t=tc.TER_PREV;while(true){if(t==tc.TER_NEXT&&n==Ri-1&&f==ui[n].len)return false;if(t==tc.TER_PREV&&n==0&&f==0)return false;l=ib(n,f);a=xs[l].FieldId;if(t==tc.TER_NEXT){if(a==tc.FIELD_NAME){hw(n,f,false);n=PC;f=SC;l=ib(n,f);a=xs[l].FieldId}if(a==tc.FIELD_DATA){hw(n,f,false);n=PC;f=SC;l=ib(n,f);a=xs[l].FieldId}}else{if(a==tc.FIELD_DATA){hw(n,f,true);n=PC;f=SC;f--;Am(n,f);n=PC;f=SC;l=ib(n,f);a=xs[l].FieldId}if(a==tc.FIELD_NAME){hw(n,f,true);n=PC;f=SC;f--;Am(n,f);n=PC;f=SC;l=ib(n,f);a=xs[l].FieldId}}while(a!=tc.FIELD_NAME&&a!=tc.FIELD_DATA){if(t==tc.TER_NEXT){if(n==Ri-1&&f==ui[n].len)return false;hw(n,f,false);n=PC;f=SC;l=ib(n,f);a=xs[l].FieldId}else{if(n==0&&f==0)return false;hw(n,f,true);n=PC;f=SC;f--;Am(n,f);n=PC;f=SC;l=ib(n,f);a=xs[l].FieldId}}if(Fw(n,f,e,r))break t}}l=ib(n,f);a=xs[l].FieldId;if(a==tc.FIELD_DATA){hw(n,f,true);n=PC;f=SC;f--;Am(n,f);n=PC;f=SC;l=ib(n,f);a=xs[l].FieldId}if(a==tc.FIELD_NAME){hw(n,f,true);n=PC;f=SC}br=n;jt=f;MT=tc.CURS_FORWARD;if(i)cG();return true};function Fw(t,e,r,i){var f;var l;var a,n;var c=false;l=_i.TerGetField(t,e,tc.FIELD_NAME);f=vP;if(i){if(Dj(r))return false;if(nV(r,f))c=true}else{if(r==null)return true;a=r.length;if(a>l)a=l;var s=Uk(f);var _=Uk(r);for(n=0;n<a;n++)if(s[n]!=_[n])break;if(n==a)c=true}return c}function gw(t,e,r){var i,f;var l,a;var n="";_i.TerPixToTextPos(tc.REL_WINDOW,t,e,false);i=PC;f=SC;l=ib(i,f);a=xs[l].FieldId;if(a!=tc.FIELD_NAME&&a!=tc.FIELD_DATA)return false;if(r){_i.TerGetField(i,f,a==tc.FIELD_NAME?tc.FIELD_DATA:tc.FIELD_NAME);n=vP;ctl.ShowMessage(n,a==tc.FIELD_NAME?"Field Data":"Field Name")}return true}function Pw(t,e,r){var i,f,l,a;var n=Sw(t,e,r);sA=rI;TA=$C;_A=iI;AA=eI;return n}function Sw(t,e,r){var i,f;var l,a,n,c;l=a=n=c=0;rI=l;$C=a;iI=c;eI=c;i=ib(t,e);f=xs[i].FieldId;if(f!=tc.FIELD_NAME&&f!=tc.FIELD_DATA)return false;if(r==tc.FIELD_NAME&&f==tc.FIELD_DATA){hw(t,e,true);t=PC;e=SC;e--;Am(t,e);t=PC;e=SC}else if(r==tc.FIELD_DATA&&f==tc.FIELD_NAME){hw(t,e,false);t=PC;e=SC}i=ib(t,e);if(xs[i].FieldId!=r)return false;hw(t,e,true);l=PC;a=SC;hw(t,e,false);n=PC;c=SC;rI=l;$C=a;iI=n;eI=c;return true}function hw(t,e,r){var i;var f=0,l,a,n;var c=true,s;var _;var o,u;n=ib(t,e);l=xs[n].FieldId;_=xs[n].FieldCode;if(r){for(i=t;i>=0;i--){a=i==t?e:ui[i].len-1;for(f=a;f>=0;f--){n=ib(i,f);s=l!=xs[n].FieldId;if(!s&&_!=xs[n].FieldCode){s=!Cw(_,xs[n].FieldCode)}if(s){f++;if(f>=ui[i].len){i++;f=0}break}if(l==tc.FIELD_NAME&&l==xs[n].FieldId&&Nj(xs[n].style&tc.PROTECT)&&Sm(i,f)==tc.LEFT_BRACE)break;c=false}if(f>=0)break}if(i<0){i=0;f=0}}else{for(i=t;i<Ri;i++){a=i==t?e:0;for(f=a;f<ui[i].len;f++){n=ib(i,f);s=l!=xs[n].FieldId;if(!s&&_!=xs[n].FieldCode){s=!Cw(_,xs[n].FieldCode)}if(s)break;if(l==tc.FIELD_NAME&&l==xs[n].FieldId&&Nj(xs[n].style&tc.PROTECT)&&Sm(i,f)==tc.LEFT_BRACE&&!c)break;c=false}if(f<ui[i].len)break}if(i==Ri){i=Ri-1;f=ui[i].len}}PC=i;SC=f;return true}function Ow(){NE=!NE;Ex(Ti);Ro=-1;Fo=0;_i.TerRepaginate(true);return true}_i.TerFieldToText=function(t,e){var r,i,f;var l,a,n,c,s,_,o;var u,T,A=0;var E;if(!lv||!QD())_i.TerCreateControl();r=0;_=0;i=Ri-1;o=ui[i].len-1;if(!t){if(uA==tc.HILIGHT_OFF)return false;ON();r=sA;_=TA;i=_A;o=AA-1}for(f=r;f<=i;f++){a=ui[f].len;E=nb(f);T=65535;n=f==r?_:0;c=f==i?o:ui[f].len-1;for(s=n;s<=c;s++){u=E[s];l=xs[u].FieldId;if(l==0)continue;if(l!=tc.FIELD_NAME&&l!=tc.FIELD_DATA&&l!=tc.FIELD_PAGE_COUNT&&l!=tc.FIELD_SECT_PAGE_COUNT&&l!=tc.FIELD_DATE&&l!=tc.FIELD_TIME&&l!=tc.FIELD_LISTNUM&&l!=tc.FIELD_AUTONUMLGL)continue;if(l==tc.FIELD_NAME){fw(f,s,1,tc.CHAR_D);E=nb(f);s--;c--;continue}if(u!=T){T=u;if(Nj(xs[T].style&tc.PICT)){xs[T].FieldId=0;A=T}else{A=Rw(T,0,0,null,f,s)}}E[s]=A}sb(f)}if(e)cG();return true};_i.TerInsertTextInputField=function(f,l,a,n,c,s,_,o,u,t){var e;var r;if(!lv||!QD())_i.TerCreateControl();if(!dm(br,jt))return 0;if(f&&f.length>0)return vw(f,l,a,n,c,s,_,o,u,t);var i=_i.DlgCompHeight;var T=_i.DlgFont;var A=new $t.DialogBox(te,"Input Field Parameters",T,true,g);var E=A.cvs;var R=new $t.Label(E,0,0,T,"Field Name");A.addComp(R,0,0,1,3,"Left","bottom");var L=new $t.TextBox(E,0,0,JV(400),i,"",T,_i.caret,false,true,null);A.addComp(L,1,0,1,3,"left","middle");var C=new $t.Label(E,0,0,T,"Field Data");A.addComp(C,2,0,1,3,"Left","bottom");var I=new $t.TextBox(E,0,0,JV(400),i,"",T,_i.caret,false,true,null);A.addComp(I,3,0,1,3,"left","middle");var d=new $t.Label(E,0,0,T,"Maximum Field Length");A.addComp(d,4,0,1,2,"Left","middle");var F=new $t.TextBox(E,0,0,JV(60),i,"",T,_i.caret,false,true,null);A.addComp(F,4,1,1,1,"left","middle",JV(50));A.show();L.setFocus();function g(t,e,r){if(t=="Cancel"){A.hide();return}else if(t=="OK"){f=L.getText();if(f.length==0){return}l=I.getText();a=LX(F);if(a>0&&l.length>a){qk(tg.MsgString[tc.MSG_DATA_TOO_BIG],null);I.setFocus();return}var i=$w();c=xs[i].TypeFace;s=xs[i].TwipsSize;_=xs[i].style;o=xs[i].TextColor;n=false;A.hide();return vw(f,l,a,n,c,s,_,o,u,true)}else return}};function vw(t,e,r,f,l,a,n,c,s,_){if(f)n|=tc.CHAR_BOX;font=_i.TerCreateFont(-1,false,l,a/20,n,c,tc.CLR_WHITE,tc.FIELD_TEXTBOX,0);if(font<0)return 0;xs[font].FieldCode=mY(r)+"|"+t;var o=5e3;for(i=0;i<Ys;i++){if(i!=font&&xs[i].FieldId==tc.FIELD_TEXTBOX&&xs[i].AuxId>=o)o=xs[i].AuxId+1}xs[font].AuxId=o;EffFont=_i.TerGetEffectiveFont();if(EffFont>=0){xs[font].ParaStyId=xs[EffFont].ParaStyId;xs[font].ParaStyId=xs[EffFont].ParaStyId}var u=uE;if(uA==tc.HILIGHT_CHAR)_i.TerDeleteBlock(true);uE=u;_i.TerInsertText(e,font,-1,_);return font}_i.TerInsertCheckboxField=function(f,l,a,n,t,c){if(!lv||!QD())_i.TerCreateControl();if(!dm(br,jt))return 0;if(f!=null&&f.length>0)return pw(f,l,a,n,t);var e=_i.DlgCompHeight;var r=_i.DlgFont;var s=new $t.DialogBox(te,"Checkbox Field Parameters",r,true,E);var i=s.cvs;var _=new $t.Label(i,0,0,r,"Field Name");s.addComp(_,0,0,1,3,"Left","bottom");var o=new $t.TextBox(i,0,0,JV(400),e,"",r,_i.caret,false,true,null);s.addComp(o,1,0,1,3,"left","middle");var u=new $t.CheckBox(i,0,0,JV(15),JV(16),r,"Checked",false,null);s.addComp(u,2,0,1,1,"Left","middle");var T=new $t.Label(i,0,0,r,"Size (twips)");s.addComp(T,2,1,1,1,"right","middle",JV(60));var A=new $t.TextBox(i,0,0,JV(60),e,"200",r,_i.caret,false,true,null);s.addComp(A,2,2,1,1,"right","middle");s.show();o.setFocus();function E(t,e,r){if(t=="Cancel"){s.hide();if(c)c(-1);return}else if(t=="OK"){f=o.getText();if(f.length==0){return}l=LX(A);a=u.isSelected();s.hide();var i=pw(f,l,a,n,true);if(c)c(i)}else return}};function pw(t,e,r,i,f){var l;var a;var n,c,s,_;var o=new tc.ClsForm;var u;var T=0;u=i_>=0?true:false;c=ib(br,jt);if((n=Nx())==-1)return 0;xs[n].form=o;o.CtlClass="JCheckBox";o.name=t;o.style=0;o.CheckBoxSize=e;o.InitNum=r?1:0;o.border=true;o.id=T;s=_=e;if(uA==tc.HILIGHT_CHAR)_i.TerDeleteBlock(true);uE--;xs[n].InUse=true;xs[n].PictType=tc.PICT_FORM;xs[n].FieldId=tc.FIELD_CHECKBOX;xs[n].ObjectType=tc.OBJ_NONE;xs[n].PictHeight=_;xs[n].PictWidth=s;xs[n].style=tc.PICT;xs[n].PictAlign=tc.ALIGN_MIDDLE;xs[n].AuxId=T;t:{if(!kw(n,new $t.CheckBox(ee,0,0,15,16,C,"",false,null))){Fb(n);break t}mN(n);if(i&&!u){if(jt>=ui[br].len)jt=ui[br].len-1;if(jt<0)jt=0;V8(br,jt,br,jt,tc.CHAR_O);fw(br,jt,1,gk("B"));l=ui[br].txt;l[jt]=tc.PICT_CHAR;a=nb(br);a[jt]=n;sb(br)}}Br=tc.PAINT_WIN;if(i||u)cG();return n}_i.TerInsertComboBoxField=function(i,f,l,t,e){var r;var a;var n=[gk("|")];var c,s,_,o;var u=new tc.ClsForm;var T;var A=0;if(!lv||!QD())_i.TerCreateControl();if(!dm(br,jt))return 0;if(i!=null&&i.length>0)return Nw(i,f,l,t,e);var E=_i.DlgCompHeight;var R=_i.DlgFont;var L=new $t.DialogBox(te,"Selection Field Parameters",R,true,v);var C=L.cvs;var I=new $t.Label(C,0,0,R,"Field Name");L.addComp(I,0,0,1,3,"Left","bottom");var d=new $t.TextBox(C,0,0,JV(400),E,"",R,_i.caret,false,true,null);L.addComp(d,1,0,1,3,"left","middle");var F=new $t.Label(C,0,0,R,"Selection");L.addComp(F,2,0,1,3,"Left","bottom");var g=new $t.TextBox(C,0,0,JV(400),E,"",R,_i.caret,false,true,null);L.addComp(g,3,0,1,3,"left","middle");var P=new $t.Label(C,0,0,R,"(Separate each item with a '|' character.");L.addComp(P,4,0,1,3,"Left","top");var S=new $t.Label(C,0,0,R,"Example: Jeannie | Isabella | Stefano | Mike | Dirk )");L.addComp(S,4,0,1,3,"Left","bottom");var h=new $t.Label(C,0,0,R,"Current Item");L.addComp(h,5,0,1,2,"Left","bottom");var O=new $t.TextBox(C,0,0,JV(275),E,"",R,_i.caret,false,true,null);L.addComp(O,5,1,1,2,"right","bottom");L.show();d.setFocus();function v(t,e,r){if(t=="Cancel"){L.hide();return}else if(t=="OK"){i=d.getText();if(i.length==0){return}f=g.getText();l=O.getText();if(f.length==0||l.length==0){return}L.hide();return Nw(i,f,l,true,true)}else return}};function Nw(t,e,r,i,f){var l;var a;var n=[gk("|")];var c,s,_,o;var u=new tc.ClsForm;var T;var A=0;if(nV(t,"")||nV(e,"")||nV(r,""))return-1;T=i_>=0?true:false;o=ib(br,jt);if((_=Nx())==-1)return 0;xs[_].form=u;u.CtlClass="ComboBox";u.name=t;u.style=0;u.InitNum=0;u.InitText=r;u.ListItems=e;u.border=true;u.id=A;if(uA==tc.HILIGHT_CHAR)_i.TerDeleteBlock(true);uE--;xs[_].InUse=true;xs[_].PictType=tc.PICT_FORM;xs[_].FieldId=tc.FIELD_COMBOBOX;xs[_].ObjectType=tc.OBJ_NONE;xs[_].PictHeight=xs[0].TwipsSize;xs[_].PictWidth=xs[0].TwipsSize*10;xs[_].style=tc.PICT;xs[_].PictAlign=tc.ALIGN_MIDDLE;xs[_].AuxId=A;var E=e.split(/[\\|]/);s=E.length;for(c=0;c<s;c++){var R=E[c].trim();if(Tk(R,r)==0){u.InitNum=c;break}}t:{var L=new $t.ComboBox(ee,0,0,50,xs[0].height,true,200,true,C,true,true,null);if(!kw(_,L)){Fb(_);break t}if(i&&!T){if(jt>=ui[br].len)jt=ui[br].len-1;if(jt<0)jt=0;V8(br,jt,br,jt,tc.CHAR_O);fw(br,jt,1,gk("B"));l=ui[br].txt;l[jt]=tc.PICT_CHAR;a=nb(br);a[jt]=_;sb(br)}}Br=tc.PAINT_WIN;if(i||T)cG();return _}function Dw(t){var e=/[\\|]/;var r,i=0;var f=xs[t].form;var l=new tc.SIZE;zI=0;ZI=0;QI=0;t:{if(f.ListItems==null)break t;var a=f.ListItems.split(e);i=a.length;for(r=0;r<i;r++){var n=a[r].trim();l.cx=gJ(Ti,W,n);l.cy=PJ(Ti,W,n);if(l.cx>zI)zI=l.cx;ZI+=l.cy;if(r==0){ZI+=l.cy*2;QI=l.cy}}}if(i==0){var c="1234";l.cx=gJ(Ti,W,c);l.cy=PJ(Ti,W,c);zI=l.cx;ZI=l.cy*3;QI=l.cy}zI+=Nt/3;if(ZI>wt*4)ZI=wt*4;QI=QI*3/2;ZI=QI;return true}function Mw(t){var e=/[\\|]/;var r=xs[t].form;var i,f=0;if(r.ListItems==null)return true;var l=xs[t].ctl;var a=r.ListItems.split(e);f=a.length;l.setItems(a,null,r.InitNum,false);l.setMaximumRowCount(f<10?f:10);return true}function Gw(){var t,e,r;var i,f;for(t=0;t<Ys;t++)if(Hw(t,0))break;if(t==Ys)return true;i=0;while((i=_i.TerGetNextControlPos(i-1))>=0){Cq(i);f=PC;r=SC;e=_i.TerGetCurFont(f,r);if(Hw(e,0))return Bw(e)}return true}function Bw(t){var e,r,i;var f;if(xs[t].FieldId==tc.FIELD_TEXTBOX){var l=xs[t].AuxId;yw(l);_i.SetTerCursorPos(br,jt,!a$(br,jt));Ww(true);oO=null}else{f=uO=xs[t].ctl;e=_i.TerGetControlPos(f);if(e<0)return true;oO=f;Cq(e);r=PC;i=SC;var a=a$(r,i,true);if(!a)_i.TerPosLineAtTop(r,false);Ui=true;_i.SetTerCursorPos(e,-1,false);Ui=false;f.setFocus()}return true}function Hw(t,e){if(t>=0&&t<Ys&&xs[t].InUse){var r=xs[t].FieldId;if(r!=tc.FIELD_TEXTBOX&&r!=tc.FIELD_CHECKBOX&&r!=tc.FIELD_COMBOBOX)return false;if(e!=0&&e!=r)return false;if(r!=tc.FIELD_TEXTBOX){if(Dj(xs[t].style&tc.PICT)||xs[t].PictType!=tc.PICT_FORM)return false}return true}return false}function mw(t,e){var r=xs[t].form;var i,f,l,a;var n=xs[t].ctl;var c,s=0;f=e;a=dV(xs[t].PictWidth);l=dV(xs[t].PictHeight);c=r.FontStyle;if(Nj(c&tc.ULINE))s|=tc.TSTYLE_ULINEF;if(r.FontId<0)r.FontId=Rb(Ti,0,r.typeface,r.TwipsSize,c&(tc.BOLD|tc.ITALIC|tc.ULINE),r.TextColor,r.TextBkColor,tc.CLR_AUTO,0,0,0,0,0,0,s,0,null,0,r.CharSet,0,0);if(r.TextBkColor!=tc.Color.white)n.setBackground(r.TextBkColor);if(r.FontId>=0){var _=r.FontId;var o=xs[_].font;if(!n.getLineWrap())n.setFont(xs[r.FontId].font);xs[t].PictAlign=tc.ALIGN_MIDDLE;if(r.border)xs[t].height=xs[_].height*5/4;else xs[t].height=xs[_].height;xs[t].PictHeight=vV(xs[t].height);if(true){var u=n.getText().length;if(u>0&&(u==r.MaxLen||r.MaxLen==0)){var T=new tc.SIZE;var A,E,R=je*5/6,L;T.cx=gJ(Ti,o,n.getText());T.cx+=10;if(Nj(r.flags&tc.FMFLAG_SSFLDW_FOUND))R=dV(xs[t].PictWidth)+10;A=r.InitText.length;L=0;var C=Uk(r.InitText);for(i=0;i<A;i++)if(C[i]==Bn)L++;if(T.cx>R||L>0){E=T.cx/R+1+L;t:while(true){T.cx=R;xs[t].height=xs[t].height*E;xs[t].PictHeight=vV(xs[t].height);if(!n.getLineWrap()){n.setLineWrap(true);l=xs[t].height;if(Nj(r.flags&tc.FMFLAG_SSFLDW_FOUND))T.cx=dV(xs[t].PictWidth);f=T.cx;n.resize(f,l);if(L==0)n.setText(r.InitText);else{var I=r.InitText.length;var d=[A+1+L];var F=0;C=Uk(r.InitText);for(i=0;i<I+1;i++,F++){if(C[i]==Bn){d[F]=13;F++;d[F]=10}else d[F]=C[i]}n.setText(Wk(d,0,F))}}if(n.getLineWrap()){var g=n.getRows();if(g!=E){E=g;continue t}}break}}xs[t].PictWidth=gV(T.cx);a=T.cx}}if(xs[t].height!=l||a!=f){l=xs[t].height;f=a;n.resize(f,l)}}return true}function ww(t,e){var r,i,f;var l,a,n,c;var s,_;var o;if(!oi.ReadOnly||!mh)return false;if(uA==tc.HILIGHT_OFF){if(false&&(t||e)){var u,T;var A=br;var E=jt;if(e){Em(A,E);A=PC;E=SC}l=A;i=E;Em(l,i);l=PC;i=SC;r=ib(l,i);u=Nj(xs[r].FieldId==tc.FIELD_TEXTBOX);l=A;i=E;Rm(l,i);l=PC;i=SC;r=ib(l,i);T=Nj(xs[r].FieldId==tc.FIELD_TEXTBOX);if(!u&&!T)return false}r=ib(br,jt);if(t&&Dj(xs[r].FieldId==tc.FIELD_TEXTBOX))return false;if(!e&&Nj(xs[r].FieldId==tc.FIELD_TEXTBOX))return true;l=br;i=jt;Em(l,i);l=PC;i=SC;r=ib(l,i);if(e&&Dj(xs[r].FieldId==tc.FIELD_TEXTBOX))return false;return oi.ReadOnly&&Nj(xs[r].FieldId==tc.FIELD_TEXTBOX)}a=sA;s=TA;n=_A;_=AA;o=OA;c=br;f=jt;ON();WY(a,sA);sA=JC;WY(s,TA);TA=JC;WY(n,_A);_A=JC;WY(_,AA);AA=JC;UY(o,OA);OA=YF;WY(c,br);br=JC;WY(f,jt);jt=JC;r=ib(a,s);if(Dj(xs[r].FieldId==tc.FIELD_TEXTBOX))return false;l=n;i=_;Em(l,i);l=PC;i=SC;r=ib(l,i);if(Dj(xs[r].FieldId==tc.FIELD_TEXTBOX))return false;if(false&&(t||e)){r=ib(n,_);if(Dj(xs[r].FieldId==tc.FIELD_TEXTBOX)){if(a==0&&s==0)return false;else{l=a;i=s;Em(l,i);l=PC;i=SC;r=ib(l,i);if(Dj(xs[r].FieldId==tc.FIELD_TEXTBOX))return false}}}return true}function bw(t,e,r,i){var f=-1;var l=-1;if(Nj(aO&tc.TOFLAG_INSERT_CHAR))return true;var a=ib(r,i);if(xs[a].FieldId!=xs[t].FieldId||Tk(xs[a].FieldCode,xs[t].FieldCode)!=0){var n=fb(r,i);if(xs[n].FieldId!=xs[t].FieldId||Tk(xs[n].FieldCode,xs[t].FieldCode)!=0){var c=wY(tc.NBSPACE_CHAR);if(r!=br||i!=jt){l=br;br=r;f=jt;jt=i}uE=e;_i.TerInsertText(c,t,-1,false);if(f>=0)jt=f;if(l>=0)br=l}}return true}function xw(){var i=ue;var t;var f="";var l=0;var a=false;var n=false;ue=i=ib(br,jt);if(Hw(i,0)){t=xs[i].form;f=t.name;n=t.border;if(xs[i].FieldId==tc.FIELD_TEXTBOX)a=true}if(a){var e=ib(br,jt);i=xs[e].AuxId;if(yw(i)){f=TK(xs[e].FieldCode,1,gk("|"));l=LX(TK(xs[e].FieldCode,0,gk("|")));n=Nj(xs[e].style&tc.CHAR_BOX)}else return false}var r=_i.DlgCompHeight;var c=_i.DlgFont;var s=new $t.DialogBox(te,"Edit Input Field",c,true,E);var _=s.cvs;var o=new $t.Label(_,0,0,c,"Field Name");s.addComp(o,0,0,1,3,"Left","bottom");var u=new $t.TextBox(_,0,0,JV(400),r,f,c,_i.caret,false,true,null);s.addComp(u,1,0,1,3,"left","middle");if(a){var T=new $t.Label(_,0,0,c,"Maximum Field Length");s.addComp(T,2,0,1,2,"Left","middle");var A=new $t.TextBox(_,0,0,JV(60),r,l==0?"":l.toString(),c,_i.caret,false,true,null);s.addComp(A,2,1,1,1,"left","middle",JV(50))}s.show();u.setFocus();function E(t,e,r){if(t=="Cancel"){s.hide();return}else if(t=="OK"){f=u.getText();if(f.length==0){return}if(a){l=LX(A);if(l<0){A.setFocus();return}}s.hide();_i.TerSetInputFieldInfo(i,f,n);if(a)_i.TerSetTextFieldInfo(i,null,l,0,null,0,0);return true}else return}return true}_i.TerGetInputFieldInfo=function(t){var e;if(!lv||!QD())_i.TerCreateControl();LP="";kC=0;uF=false;if(Hw(t,0)){e=xs[t].form;if(e!=null){LP=e.name;kC=xs[t].FieldId;uF=e.border;return true}else if(xs[t].FieldId==tc.FIELD_TEXTBOX){kC=tc.FIELD_TEXTBOX;LP=TK(xs[t].FieldCode,1,gk("|"));uF=Nj(xs[t].style&tc.CHAR_BOX);return true}}else{if(yw(t)){var r=ib(br,jt);kC=tc.FIELD_TEXTBOX;LP=TK(xs[r].FieldCode,1,gk("|"));uF=Nj(xs[r].style&tc.CHAR_BOX);return true}}return false};_i.TerGetInputFieldId=function(t){var e;var r;var i;if(!_i.TerCreateControl())return-1;for(r=0;r<Ys;r++){if(!xs[r].InUse)continue;if(Hw(r,0)){e=xs[r].form;i="";if(e!=null)i=e.name;else if(xs[r].FieldId==tc.FIELD_TEXTBOX)i=TK(xs[r].FieldCode,1,gk("|"));if(Tk(i,t)==0){if(xs[r].FieldId==tc.FIELD_TEXTBOX)return xs[r].AuxId;else return r}}else if(xs[r].FieldId==tc.FIELD_TEXTBOX){i=TK(xs[r].FieldCode,1,gk("|"));if(Tk(i,t)==0)return xs[r].AuxId}}return-1};_i.TerGetCheckboxInfo=function(t){if(!lv||!QD())_i.TerCreateControl();TF=false;if(!Hw(t,tc.FIELD_CHECKBOX))return false;TF=xs[t].ctl.isSelected();return true};_i.TerGetComboboxInfo=function(t){var e,r,i;var f=null;if(!lv||!QD())_i.TerCreateControl();hP="";if(!Hw(t,tc.FIELD_COMBOBOX))return-1;f=xs[t].ctl;if(f==null)return-1;r=f.getItemCount();for(e=0;e<r;e++){if(hP.length>0)hP+="|";hP+=f.getItemAt(e)}i=f.getSelectedIndex();return i};_i.TerSetComboboxInfo=function(t,e,r,i){var f,l,a;var n=null;var c=null;if(!lv||!QD())_i.TerCreateControl();if(!Hw(t,tc.FIELD_COMBOBOX))return false;c=xs[t].ctl;if(c==null)return false;n=xs[t].form;n.ListItems=e;n.InitNum=r;Dw(t);f=zI;l=ZI;a=QI;xs[t].PictWidth=gV(f);xs[t].PictHeight=gV(a);c.resize(f,l);Mw(t);xs[t].CharWidth[tc.PICT_CHAR]=f;xs[t].PictWidth=gV(f);xs[t].height=c.getHeight();xs[t].PictHeight=vV(xs[t].height);HN(t,hV(xs[t].PictHeight),dV(xs[t].PictWidth),true);xs[t].bmHeight=xs[t].height;xs[t].bmWidth=xs[t].CharWidth[tc.PICT_CHAR];mN(t);if(i)cG();return true};_i.TerGetTextFieldInfo=function(t){var e;if(!lv||!QD())_i.TerCreateControl();OP=RP="";lP=YC=0;KC=0;if(t==0)return false;if(!yw(t))return false;e=ib(br,jt);lP=LX(TK(xs[e].FieldCode,0,gk("|")));RP=xs[e].TypeFace;YC=xs[e].TwipsSize;KC=xs[e].style;Ww(false);OP=_i.TerGetTextSel();_i.DeselectTerText(false);return true};_i.TerSetInputFieldInfo=function(t,e,r){var i;var f,l,a;if(!lv||!QD())_i.TerCreateControl();t:{if(Hw(t,0))break t;if(!yw(t))return false;l=br;a=jt;var n=ib(br,jt);if(xs[n].FieldId!=tc.FIELD_TEXTBOX||xs[n].FieldCode==null||xs[n].AuxId!=t)return false;var c=TK(xs[n].FieldCode,0,gk("|"));var s=TK(xs[n].FieldCode,1,gk("|"));var _=c+"|"+e;while(true){xs[n].FieldCode=_;if(br==Ri&&jt==ui[br].len-1)break;Rm();f=ib(br,jt);if(f==n)continue;n=f;var o=TK(xs[n].FieldCode,1,gk("|"));if(xs[n].FieldId!=tc.FIELD_TEXTBOX||xs[n].AuxId!=t||o!=s)break}br=l;jt=a;Ww(false);_i.SetTerCharStyle(tc.CHAR_BOX,r,true);oi.modified++;return true}i=xs[t].form;if(e!=null)i.name=e;if(xs[t].FieldId==tc.FIELD_TEXTBOX){i.border=r;if(nV(i.CtlClass,"TextBox"))xs[t].ctl.setBorder(i.border)}oi.modified++;return true};_i.TerSetCheckboxInfo=function(t,e){var r;var i;if(!lv||!QD())_i.TerCreateControl();if(!Hw(t,tc.FIELD_CHECKBOX))return false;r=xs[t].form;i=xs[t].ctl.isSelected();if(i&&!e||!i&&e){xs[t].ctl.setSelected(e)}oi.modified++;return true};_i.TerSetTextFieldInfo=function(t,e,r,i,f,l,a){var n,c,s,_,o,u,T;var A;if(!lv||!QD())_i.TerCreateControl();if(!yw(t))return false;_=br;o=jt;T=ib(br,jt);A=Nj(xs[T].style&tc.CHAR_BOX);u=LX(TK(xs[T].FieldCode,0,gk("|")));if(u!=r){var E=TK(xs[T].FieldCode,1,gk("|"));var R=mY(r)+"|"+E;while(true){xs[T].FieldCode=R;if(br==Ri-1&&jt==ui[br].len-1)break;Rm();n=ib(br,jt);if(n==T)continue;var L=TK(xs[T].FieldCode,1,gk("|"));T=n;if(xs[T].FieldId!=tc.FIELD_TEXTBOX||xs[T].AuxId!=t||L!=E)break}}br=_;jt=o;Ww(false);c=Lq(sA,TA);s=Lq(_A,AA);if(f!=null){_i.SetTerFont(f,false);_i.SetTerPointSize(-l,false);_i.SetTerCharStyle(tc.BOLD|tc.ITALIC|tc.ULINE|tc.ULINED|tc.STRIKE|tc.DOUBLE_STRIKE|tc.SUBSCR|tc.SUPSCR|tc.CHAR_BOX,false,false);if(A)a|=tc.CHAR_BOX;_i.SetTerCharStyle(a,true,false)}if(e!=null){var C=wY(tc.PARA_CHAR);e=e.replace("\r\n",C);dK(e,c,s-1)}n9();oi.modified++;_i.DeselectTerText(true);return true};_i.TerSetSelectionFieldPrintFontSize=function(t){if(!lv||!QD())_i.TerCreateControl();fu=t;return true};_i.TerLocateInputField=function(t,e){var r;var i,f,l,a=0;var n=false,c=false;if(!lv||!QD())_i.TerCreateControl();if(!oi.open)return 0;i=ib(br,jt);if(t==tc.TER_CUR){if(xs[i].FieldId==tc.FIELD_TEXTBOX)return xs[i].AuxId;else return ue}r=br;f=jt;if(t==tc.TER_FIRST){r=0;f=-1;t=tc.TER_NEXT}else if(t==tc.TER_LAST){r=Ri-1;f=ui[r].len-1;t=tc.TER_PREV}else if(t==tc.TER_NEXT&&xs[i].FieldId==tc.FIELD_TEXTBOX)n=true;else if(t==tc.TER_PREV&&xs[i].FieldId==tc.FIELD_TEXTBOX)n=true;if(n)a=xs[i].AuxId;while(true){if(t==tc.TER_NEXT&&!Rm(r,f))return 0;else{r=PC;f=SC}if(t==tc.TER_PREV&&!Em(r,f))return 0;else{r=PC;f=SC}l=ib(r,f);if(n&&xs[l].FieldId==tc.FIELD_TEXTBOX&&xs[l].AuxId==a)continue;n=false;if(xs[l].FieldId==tc.FIELD_TEXTBOX){l=xs[l].AuxId;c=true;break}if(Hw(l,0)){c=true;break}}_i.SetTerCursorPos(r,f,e);return c?l:0};function yw(t){var e=0;var r=0,i;if(_i.TerLocateAuxIdChar(t,true,e,r,true)){e=zC;r=ZC;br=e;jt=r;return true}return false}function Ww(t){return Uw(br,jt,t)}function Uw(t,e,r){var i,f,l;i=ib(t,e);if(xs[i].FieldId!=tc.FIELD_TEXTBOX)return false;f=t;l=e;if(!_i.TerLocateAuxIdChar(xs[i].AuxId,false,f,l,false)){sA=TA=0}else{f=zC;l=ZC;Rm(f,l);f=PC;l=SC;sA=f;TA=l}f=t;l=e;if(!_i.TerLocateAuxIdChar(xs[i].AuxId,false,f,l,true)){_A=Ri-1;AA=ui[Ri-1].len}else{f=zC;l=ZC;_A=f;AA=l}uA=tc.HILIGHT_CHAR;OA=false;_i.TerSetFocus();if(r){Ui=true;cG();Ui=false}return true}_i.TerInputFieldToTextBox=function(t){var e=0,r=0,i,f,l,a,n,c,s,_;var o=5e3;if(!lv||!QD())_i.TerCreateControl();if(mh){mh=false;oi.ReadOnly=false}while(_i.TerLocateFieldChar(tc.FIELD_TEXTBOX,null,true,e,r,true)){e=zC;r=ZC;l=Lq(e,r);i=e;f=r;if(!_i.TerLocateFieldChar(tc.FIELD_TEXTBOX,null,false,i,f,true))break;i=zC;f=ZC;c=ib(e,r);_i.SelectTerText(e,r,i,f,false);var u=_i.TerGetTextSel();a=u.length;_i.TerDeleteBlock(false);n=xs[c].CharWidth[tc.CHAR_m]*a;s=xs[c].height;_i.SetTerCursorPos(e,r,false);var T=new $t.TextBox(ee,0,0,n,s,u,xs[c].FontString,_i.caret,false,true,null);_=_i.TerInsertControl(T,"",0,o,true);Cq(l+1);e=PC;r=SC;o++}_i.TerRepaginate(t);return true};_i.TerInsertControl=function(t,e,r,i,f){var l;var a;var n,c,s,_;var o;if(!lv||!QD())_i.TerCreateControl();o=i_>=0?true:false;c=ib(br,jt);if(Nj(xs[c].style&tc.PROTECT)&&f&&!o){oV();return 0}if((n=Nx())==-1)return 0;s=PV(t.getWidth());_=pV(t.getHeight());var u=new tc.ClsForm;if((e==null||nV(e,""))&&t!=null){e=t.getClass().getName();if(e.indexOf("TextBox")>=0){if(t.getBorder())u.border=true}}u.CtlClass=e;u.id=i;if(uA==tc.HILIGHT_CHAR)_i.TerDeleteBlock(true);uE--;xs[n].InUse=true;xs[n].PictType=tc.PICT_CONTROL;xs[n].ObjectType=tc.OBJ_NONE;xs[n].PictHeight=_;xs[n].PictWidth=s;xs[n].style=tc.PICT;xs[n].PictAlign=r;xs[n].AuxId=i;xs[n].form=u;t:{if(!kw(n,t)){Fb(n);break t}mN(n);if(f&&!o){if(jt>=ui[br].len)jt=ui[br].len;if(jt<0)jt=0;fw(br,jt,1,gk("B"));l=ui[br].txt;l[jt]=tc.PICT_CHAR;a=nb(br);a[jt]=n;sb(br)}}Br=tc.PAINT_WIN;if(f||o)cG();return n};function kw(t,e){var r=xs[t].form;var i,f,l,a=0;var n=false;i=l=dV(xs[t].PictWidth);f=hV(xs[t].PictHeight);if(xs[t].FieldId==tc.FIELD_COMBOBOX){Dw(t);i=zI;f=ZI;a=QI;xs[t].PictWidth=gV(i);xs[t].PictHeight=vV(a);l=i}if(e==null&&r.CtlClass!=null)e=PD(_i,r.CtlClass,xs[t].AuxId);if(e==null){if(r.CtlClass==null)r.CtlClass="";if(Tk(r.CtlClass,"TextBox")==0)e=new $t.TextBox(ee,0,0,i,f,"",C,_i.caret,false,true,null);else if(Tk(r.CtlClass,"CheckBox")==0)e=new $t.CheckBox(ee,0,0,i,f,C,"",false,null);else if(Tk(r.CtlClass,"ComboBox")==0)e=new $t.ComboBox(ee,0,0,i,f,true,200,true,C,true,true,null);else if(Tk(r.CtlClass,"RadioButton")==0)e=new $t.RadioButton(ee,0,0,i,C,"",false,null,null);else if(Tk(r.CtlClass,"Button")==0)e=new $t.Button(ee,0,0,i,f,C,"",true,null);else if(Tk(r.CtlClass,"Label")==0)e=new $t.Label(ee,0,0,C,"");else{if(nV(r.CtlClass,""))r.CtlClass="Label";e=new $t.Label;e.setText("[Unknown: "+r.CtlClass+"]");e.setEnabled(false)}n=true}if((oi.ReadOnly||Nj(xs[t].style&tc.PROTECT))&&Nj(qh&tc.TFLAG4_READONLY_CONTROLS))e.setEnabled(false);xs[t].ctl=e;e.setVisible(false);if(nV(r.CtlClass,"CheckBox")){}oO=e;ue=t;if(xs[t].PictType==tc.PICT_FORM&&xs[t].FieldId==tc.FIELD_TEXTBOX){e.setText(r.InitText);mw(t,xs[t].PictWidth)}else if(xs[t].PictType==tc.PICT_FORM&&xs[t].FieldId==tc.FIELD_CHECKBOX){e.setSelected(Nj(r.InitNum))}else if(xs[t].PictType==tc.PICT_FORM&&xs[t].FieldId==tc.FIELD_COMBOBOX){Mw(t);var c=e;xs[t].height=c.getHeight();xs[t].PictHeight=vV(xs[t].height);xs[t].offset=-xs[t].PictHeight/3}if(nV(r.CtlClass,"CheckBox")||nV(r.CtlClass,"TextBox")||nV(r.CtlClass,"Button")||nV(r.CtlClass,"RadioButton")||nV(r.CtlClass,"ComboBox")){}if(n&&nV(r.CtlClass,"TextBox"))e.setBorder(r.border);HN(t,hV(xs[t].PictHeight),dV(xs[t].PictWidth),true);xs[t].bmHeight=xs[t].height;xs[t].bmWidth=xs[t].CharWidth[tc.PICT_CHAR];if(xs[t].FieldId!=tc.FIELD_COMBOBOX)xs[t].TwipsSize=xs[t].PictHeight;mN(t);return true}_i.TerGetControlId=function(t){var e;var r=-1;if(!lv||!QD())_i.TerCreateControl();if(t<0||t>=Ys||!Xw(t))return-1;e=xs[t].form;r=e.id;return r};_i.TerXlateControlId=function(t){var e;var r,i;if(!lv||!QD())_i.TerCreateControl();for(r=0;r<Ys;r++){if(!Xw(r))continue;e=xs[r].form;i=e.id;if(i==t)return r}return-1};function Xw(t){return t>=0&&t<Ys&&xs[t].InUse&&Nj(xs[t].style&tc.PICT)&&(xs[t].PictType==tc.PICT_CONTROL||xs[t].PictType==tc.PICT_FORM)}function Kw(t){return true}_i.TerGetNextControlPos=function(t){var e,r;var i,f,l;var a;if(!lv||!QD())_i.TerCreateControl();Cq(t);e=PC;i=SC;t:{for(r=e;r<Ri;r++){if(ui[r].len==0)continue;if(r==e)l=i;else l=0;a=nb(r);for(f=l;f<ui[r].len;f++){if(Xw(a[f]))break t;var n=a[f];if(xs[n].FieldId==tc.FIELD_TEXTBOX)break t}sb(r)}return-1}return Lq(r,f)};_i.TerGetPrevControlPos=function(t){var e,r;var i,f,l,a;var n;if(!lv||!QD())_i.TerCreateControl();Cq(t);e=PC;i=SC;t:{for(r=e;r>=0;r--){if(ui[r].len==0)continue;if(r==e)a=i;else a=ui[r].len-1;n=nb(r);for(f=a;f>=0;f--){if(Xw(n[f]))break t;l=n[f];if(xs[l].FieldId==tc.FIELD_TEXTBOX){Uw(r,f,false);r=sA;f=TA;_i.DeselectTerText(false);break t}}sb(r)}return-1}return Lq(r,f)};_i.TerGetControlPos=function(t){var e,r=0;var i;var f;if(!lv||!QD())_i.TerCreateControl();if(-1==(e=_i.TerXlateControl(t)))return-1;for(i=0;i<Ri;i++){f=nb(i);for(r=0;r<ui[i].len;r++)if(f[r]==e)break;sb(i);if(r<ui[i].len)break}if(i<Ri)return Lq(i,r);else return-1};_i.TerXlateControl=function(t){var e;if(!lv||!QD())_i.TerCreateControl();if(typeof t=="number")return _i.TerXlateControl2(t);for(e=0;e<Ys;e++){if(!Xw(e))continue;if(xs[e].ctl==t)return e}return-1};_i.TerXlateControl2=function(t){if(!lv||!QD())_i.TerCreateControl();if(!Xw(t))return null;else return xs[t].ctl};function Yw(t){var e,r,i;var f=null;var l=t;var a,n,c,s;var _;s=ib(br,jt);if(xs[s].FieldId==tc.FIELD_TEXTBOX){r=xs[s].AuxId;Ww(false);if(l)n=a=Lq(sA,TA);else n=a=Lq(_A,AA)-1;_i.DeselectTerText(true)}else if(xs[s].ctl!=null){_=xs[s].ctl;n=a=_i.TerGetControlPos(_);if(a<0)return false}else return false;t:{if(l){while((a=_i.TerGetPrevControlPos(a-1))>=0){Cq(a);c=PC;i=SC;r=_i.TerGetCurFont(c,i);if(xs[r].FieldId==tc.FIELD_TEXTBOX||Xw(r))break t}a=Lq(Ri-1,ui[Ri-1].len);while((a=_i.TerGetPrevControlPos(a-1))>=0){if(a<=n)return false;Cq(a);c=PC;i=SC;r=_i.TerGetCurFont(c,i);if(xs[r].FieldId==tc.FIELD_TEXTBOX||Xw(r))break t}}else{while((a=_i.TerGetNextControlPos(a+1))>=0){Cq(a);c=PC;i=SC;r=_i.TerGetCurFont(c,i);if(xs[r].FieldId==tc.FIELD_TEXTBOX||Xw(r))break t}a=0;while((a=_i.TerGetNextControlPos(a-1))>=0){if(a>=n)return false;Cq(a);c=PC;i=SC;r=_i.TerGetCurFont(c,i);if(xs[r].FieldId==tc.FIELD_TEXTBOX||Xw(r))break t}}return false}ef=false;Oc=-1;Bw(r);return true}$t.DefFontWidths=[];$t.DefFontHeights=[];function Vw(t,e,r){var i;var f;var l;oi.modified++;if(ui[t].fmt==null){if(e!=0){i=ui[t].UniFmt;ui[t].fmt=[e+1];f=ui[t].fmt;for(l=0;l<e;l++)f[l]=i}}if(e==0&&r==0){ui[t].fmt=null;return true}if(e==r)return true;if(r==0){ui[t].fmt=null;ui[t].UniFmt=0;return true}if(e>0){ui[t].fmt=fV(ui[t].fmt,r+1);for(l=e;l<r;l++)ui[t].fmt[l]=0;return true}if(e==0){ui[t].fmt=[r+1];for(l=0;l<r;l++)ui[t].fmt[l]=0;return true}return true}function jw(t,e,r){var i;oi.modified++;if(ui[t].cwidth==null){if(r==0)return true;ui[t].cwidth=[r+1];for(i=0;i<r;i++)zw(t,i,-1);return true}if(e==0&&r==0){ui[t].cwidth=null;return true}if(e==r)return true;if(r==0){ui[t].cwidth=null;return true}if(e>0){ui[t].cwidth=fV(ui[t].cwidth,r+1);for(i=e;i<r;i++)zw(t,i,-1);return true}return true}function Jw(t,e,r){var i;oi.modified++;if(ui[t].tag==null){if(r==0)return true;ui[t].tag=[r+1];for(i=0;i<r;i++)Qw(t,i,0);return true}if(e==0&&r==0){ui[t].tag=null;return true}if(e==r)return true;if(r==0){ui[t].tag=null;return true}if(e>0){ui[t].tag=fV(ui[t].tag,r+1);for(i=e;i<r;i++)Qw(t,i,0);return true}return true}function zw(t,e,r){ui[t].cwidth[e]=r}function Zw(t,e){return ui[t].cwidth[e]}function Qw(t,e,r){ui[t].tag[e]=r}function qw(t,e){return ui[t].tag[e]}function $w(){var t,e,r,i,f,l,a;var n;var c;var s=false;var _;var o;var u;var T=Li||vr;e=tc.DEFAULT_CFMT;if(Oc>=0&&Nj(xs[Oc].style&tc.PICT))Oc=-1;if(Oc>=0&&uA==tc.HILIGHT_OFF)return Oc;else if(uA==tc.HILIGHT_CHAR){if(_A<sA||_A==sA&&AA<TA){c=_A;r=AA}else{c=sA;r=TA}if(r>=0&&ui[c].len>r){n=nb(c);e=n[r];sb(c);if(sA==_A&&Math.abs(AA-TA)==1&&Nj(xs[e].style&tc.PICT)){var A=xs[e].style;A=cj(A,tc.PICT);e=Oc=Db(0,A,true)}if(Nj(xs[e].style&tc.PROTECT)){Oc=e;return Oc}if(Oc==e)return Oc}}else{if(br>0){if(T){u=ui[br].txt;for(t=jt-1;t>=0;t--){if(u[t]==tc.NBSPACE_CHAR)continue;else break}if(t<0)s=true}if(!s){if(ui[br].len==0)s=true;else if(jt==0){if(ui[br].len<1)s=true;else if(Dj(ui[br-1].flags&(tc.LFLAG_PARA|tc.LFLAG_BREAK)))s=true;else if(Ni&&or==br&&Nj(ui[br].flags&tc.LFLAG_PARA)&&ui[br].len==1)s=true;if(s&&br>0&&ui[br-1].cid!=ui[br].cid)s=false;if(s&&br>0&&ui[br-1].fid!=ui[br].fid)s=false;if(s&&br>0&&ui[br-1].pfmt!=ui[br].pfmt){var E=ui[br-1].pfmt;var R=ui[br].pfmt;if(Nc[E].StyId!=Nc[R].StyId)s=false}}}}else if(T&&jt==0)s=true;if(s){if(T){var L=false;t=0;for(c=br-1;c>=0;c--){if(ui[c].len==0)continue;u=ui[c].txt;for(t=ui[c].len-1;t>=0;t--){if(t==ui[c].len-1&&Nj(ui[c].flags&(tc.LFLAG_PARA|tc.LFLAG_BREAK)))continue;if(u[t]==tc.NBSPACE_CHAR)continue;else break}if(t>=0){L=true;break}}if(!L){for(c=br;c<Ri;c++){if(ui[c].len==0)continue;u=ui[c].txt;for(t=0;t<ui[c].len;t++){if(t==ui[c].len-1&&Nj(ui[c].flags&(tc.LFLAG_PARA|tc.LFLAG_BREAK)))continue;if(u[t]==tc.NBSPACE_CHAR)continue;else break}if(t<ui[c].len){L=true;break}}}if(L){n=nb(c);e=n[t];sb(c)}else e=0}else{f=0;_=0;for(c=br-1;c>=0;c--){if(ui[c].len==0)continue;u=ui[c].txt;_=u[ui[c].len-1];f=ui[c].len-(Nj(ui[c].flags&tc.LFLAG_BREAK)?1:0);if(f>0)break}if(c>=0&&f>0){if(BY(_)&&_!=Bn&&_!=tc.LINE_CHAR)e=ib(br,0);else{n=nb(c);e=n[f-1];sb(c)}}else{s=false}}}else if(Ri==1&&ui[0].len==1)e=ib(0,0);else if(ui[br].fmt==null)e=ui[br].UniFmt;else if(jt>=ui[br].len&&ui[br].len>0){n=nb(br);e=n[ui[br].len-1];sb(br)}else{n=nb(br);if(n!=null){var C=false;i=0;if(jt>0&&jt-1<ui[br].len){for(t=jt-1;t>=0;t--){e=n[t];if(Nj(xs[e].style&tc.PICT))continue;if(Nj(xs[e].style&tc.HIDDEN)&&!pE)continue;i=e;C=true;break}}if(Li&&Nj(xs[i].style&tc.HLINK))e=n[jt];else{if(jt==0){e=n[jt];if(Li&&Nj(xs[e].style&tc.HIDDEN)&&!pE){for(t=jt+1;t<ui[br].len;t++)if(Dj(xs[n[t]].style&(tc.HIDDEN|tc.HLINK)))break;if(t<ui[br].len)e=n[t]}else if(Nj($h&tc.TFLAG5_BEF_AND_AFT_HIDDEN)&&um(e))e=0}else if(!C)e=n[jt-1]}sb(br);if(Nj(xs[e].style&tc.PICT)){l=ib(br,jt);if(Dj(xs[l].style&tc.PICT))e=l}}}}a=xs[e].FieldId;if(a>0&&a!=tc.FIELD_TEXTBOX&&uA!=tc.HILIGHT_CHAR){var I=ib(br,jt);if(xs[I].FieldId==0||br==0&&jt==0){e=rb(e,false);if(a==tc.FIELD_HLINK){if(MJ(xs[e].TextColor,bh)){var d=xs[ib(br,jt)].TextColor;if(br==0&&jt==0)d=xs[0].TextColor;e=fx(e,pJ(d),0,"",br,jt)}if(Nj(wh)&&(xs[e].style&wh)==wh)e=Nb(e,wh,0,"",br,jt)}}}if(uA==tc.HILIGHT_OFF)l=ib(br,jt);else l=e;t:{if(xs[l].FieldId==tc.FIELD_TEXTBOX&&!oi.ReadOnly){i=fb(br,jt);if(xs[i].FieldId!=tc.FIELD_TEXTBOX||br==0&&jt==0){e=rb(e,false);break t}}if(xs[e].FieldId==tc.FIELD_TEXTBOX&&xs[l].FieldId!=tc.FIELD_TEXTBOX){if(!oi.ReadOnly)e=l;break t}if(xs[e].FieldId!=tc.FIELD_TEXTBOX&&xs[l].FieldId==tc.FIELD_TEXTBOX){if(oi.ReadOnly)e=l;break t}if(!tb(e,l,br,jt)){e=jC;if(xs[l].FieldId>0){e=l;break t}l=e;e=0;r=jt-1;c=br;o=false;while(r>0&&Em(c,r)){c=PC;r=SC;i=ib(c,r);if(tb(i,l,c,r+1)){i=jC;e=i;o=true;break}l=i}if(!o){n=nb(br);for(t=0;t<ui[br].len;t++){l=n[t];if(Dj(xs[l].style&(tc.PICT|tc.HIDDEN|tc.FNOTEALL))&&xs[l].FieldId==0){e=l;break}}sb(br)}}}if(Nj(xs[e].style&tc.PICT))e=tc.DEFAULT_CFMT;if(jt==0&&Nj(xs[e].style&tc.PROTECT)){var F=false;if(br==0)F=true;else{i=fb(br,jt);if(Dj(xs[i].style&tc.PROTECT))F=true}if(F){n=nb(br);f=ui[br].len;for(t=0;t<f;t++){l=n[t];if(Dj(xs[l].style&tc.PROTECT)){e=Db(e,tc.PROTECT,false);break}}sb(br)}}i=fb(br,jt);if(uA==tc.HILIGHT_OFF){l=ib(br,jt);if(xs[l].FieldId==tc.FIELD_HLINK&&xs[i].FieldId==tc.FIELD_HLINK&&!Lw(l,i)){e=Db(i,wh,false);e=fx(e,pJ(xs[0].TextColor),0,"",br,jt);e=Ew(e,0,null)}else if(xs[i].FieldId==tc.FIELD_HLINK&&xs[e].FieldId!=tc.FIELD_HLINK){e=Db(e,xs[i].style,false);e=Db(e,xs[l].style,true);if(!MJ(xs[l].TextColor,xs[e].TextColor))e=fx(e,pJ(xs[l].TextColor),0,"",br,jt)}if(jt==0&&Dj(xs[e].style&tc.PROTECT)){if(xs[e].FieldId==tc.FIELD_HLINK||Iw(xs[e].FieldId)){if(br==0)e=0;else e=i}}}return e}function tb(t,e,r,i){var f,l;var a=t,n,c;var s=false;if(i>=ui[r].len){Am(r,i);r=PC;i=SC}jC=a;t:while(true){f=xs[a].style;n=xs[a].FieldId;l=xs[e].style;c=xs[e].FieldId;if(Nj(f&tc.PICT)&&Dj(l&tc.PICT)){a=e;continue t}if(Nj(f&tc.PROTECT)&&Dj(l&tc.PROTECT)&&uA!=tc.HILIGHT_CHAR){a=e;continue t}if(Nj(f&tc.PROTECT)&&Nj(l&tc.PROTECT)){if(NE&&n==tc.FIELD_NAME&&c==tc.FIELD_NAME&&Sm(r,i)=="{".charCodeAt(0))a=0;break t}if(n>0&&c==0){var _;_=n==tc.FIELD_DATA&&Nj(Qh&tc.TFLAG3_DATA_FIELD_INPUT)&&!NE;if(!_){a=e;continue t}}if(Nj(f&tc.HIDDEN)){if(oU(e)){a=e;break t}if(!pE)return false}if(vh&&oU(a)&&!oU(e)){a=e;break t}if(Nj(f&tc.FNOTETEXT)&&!DE)return false;if(Nj(f&tc.ENOTETEXT)&&!ME)return false;if(Nj(f&(tc.FNOTE|tc.FNOTEREST)))return false;if(xs[a].FieldId>0&&n!=tc.FIELD_NAME&&n!=tc.FIELD_DATA&&n!=tc.FIELD_HLINK&&n!=tc.FIELD_TOC)return false;if(!NE&&n==tc.FIELD_NAME)return false;if(NE&&n==tc.FIELD_DATA){if(c==tc.FIELD_NAME)a=0;else return false}if(NE&&c==tc.FIELD_NAME&&n==tc.FIELD_NAME){var o=ui[r].txt;var u=o[i];if(Nj(l&tc.PROTECT)&&u=="{".charCodeAt(0))a=0}s=true;break}jC=a;return true}function eb(t,e,r,i){$d=new tc.ClsFont;tF=new tc.ClsPrtFont;if(t){xs[e].CharWidth=null;Xs[e].CharWidth=null;xs[e].hidden=null;Xs[e].hidden=null;xs[e]=r.ShallowCopy();Xs[e]=i.ShallowCopy()}else{$d=xs[e].ShallowCopy();tF=Xs[e].ShallowCopy();xs[e].CharWidth=null;Xs[e].CharWidth=null;xs[e].hidden=null;Xs[e].hidden=null;xs[e].LinkFile=null;xs[e].InUse=false}return true}_i.TerSetInputTextAuxId=function(t,e,r){Ji=true;Ne=t;De=e;Me=r;return true};_i.TerIsMixPara=function(t){var e=false,r=false;var i;var f,l,a;var n;var c;var s;if(!lv||!QD())_i.TerCreateControl();for(f=0;f<Ys;f++){if(xs[f].flow==tc.FLOW_RTL)break;if(xs[f].rtlch)break;if(xs[f].CharSet==tc.ARABIC_CHARSET)break;if(xs[f].CharSet==tc.HEBREW_CHARSET)break}if(f==Ys)return false;for(i=t;i>=0;i--){l=ui[i].len;n=nb(i);c=ui[i].txt;for(f=0;f<l;f++){a=n[f];if(xs[a].flow==tc.FLOW_RTL||xs[a].rtlch)r=true;else{s=c[f];if(s<128)e=true;else{if(Yq(s))r=true;else e=true}}if(e&&r)return true}if(Nj(ui[i].flags&tc.LFLAG_PARA_FIRST))break;if(i>0&&Nj(ui[i-1].flags&tc.LFLAG_PARA_FIRST))break}if(Nj(ui[i].flags&tc.LFLAG_PARA))return false;for(i=t+1;i<Ri;i++){l=ui[i].len;n=nb(i);c=ui[i].txt;for(f=0;f<l;f++){a=n[f];if(xs[a].flow==tc.FLOW_RTL||xs[a].rtlch)r=true;else{s=c[f];if(s<128)e=true;else{if(Yq(s))r=true;else e=true}}if(e&&r)return true}if(Nj(ui[i].flags&tc.LFLAG_PARA))break}return e&&r};_i.TerGetCurFont=function(t,e){if(!lv||!QD())_i.TerCreateControl();if(t<0){t=br;e=jt}return ib(t,e)};function rb(t,e){if(Nj(xs[t].style&tc.PICT))return 0;if(xs[t].FieldId>0||Nj(xs[t].FieldCode))t=Rw(t,0,0,null,0,0);if(e&&Nj(xs[t].style&tc.PROTECT))t=Db(t,tc.PROTECT,false);return t}function ib(t,e){var r;var i;if(t<0||t>=Ri)return tc.DEFAULT_CFMT;if(e<0||e>=ui[t].len)return tc.DEFAULT_CFMT;if(ui[t].fmt==null)return ui[t].UniFmt;r=nb(t);i=r[e];sb(t);return i}function fb(t,e){var r;if(t>=Ri)return tc.DEFAULT_CFMT;r=ui[t].len;if(e<0||e>r)return tc.DEFAULT_CFMT;e--;if(e>=0)return ib(t,e);if(t==0)return 0;while(t>0){t--;e=ui[t].len-1;if(e>=0)break}if(e<0)return 0;else return ib(t,e)}function lb(t,e){var r;if(t>=Ri)return tc.DEFAULT_CFMT;r=ui[t].len;if(e<0||e>=r)return tc.DEFAULT_CFMT;e++;if(e<r)return ib(t,e);if(t+1==Ri)return 0;while(t+1<Ri){t++;if(ui[t].len>0)break}return ib(t,0)}_i.TerSetEffectiveFont=function(t){if(!lv||!QD())_i.TerCreateControl();if(t!=-1){if(t<0||t>=Ys||!xs[t].InUse||Nj(xs[t].style&tc.PICT))t=0}Oc=t;return true};_i.TerGetEffectiveFont=function(){if(!lv||!QD())_i.TerCreateControl();return $w()};function ab(t){if(ui[t].fmt==null)ob(t);if(Dj(ui[t].tag))Eb(t);uP=ui[t].fmt;oP=ui[t].tag;return true}function nb(t){if(ui[t].fmt==null)ob(t);return ui[t].fmt}function cb(t){if(Nj(ui[t].fmt))_b(t);if(Nj(ui[t].tag))Ab(t)}function sb(t){if(Nj(ui[t].fmt))_b(t)}function _b(t){var e,r;var i;var f;var l;if(true)return;if(ui[t].fmt==null||Nj(nO&tc.TOFLAG2_NO_COMPRESS_CFMT))return;if(oi.WordWrap){if(ui[t].len==0){ui[t].fmt=null;ui[t].UniFmt=tc.DEFAULT_CFMT;return}if(Nj(ui[t].tabw)||Nj(ui[t].flags&(tc.LFLAG_NBSPACE|tc.LFLAG_NBDASH|tc.LFLAG_HYPH)))return;if(Nj(ui[t].flags&tc.LFLAG2_HIDDEN_CHAR))return}else{if(ui[t].len>0){l=ui[t].txt;for(e=0;e<ui[t].len;e++)if(l[e]==tc.TAB)break;if(e<ui[t].len)return}}f=ui[t].fmt;if(ui[t].len>0)i=f[0];else i=tc.DEFAULT_CFMT;for(e=0;e<ui[t].len;e++){if(f[e]!=i)return}r=oi.modified;Vw(t,ui[t].len,0);oi.modified=r;ui[t].fmt=null;ui[t].UniFmt=i;return}function ob(t){var e,r;var i;var f;if(Nj(ui[t].fmt))return;if(ui[t].len==0)return;i=ui[t].UniFmt;r=oi.modified;Vw(t,0,ui[t].len);oi.modified=r;f=ui[t].fmt;for(e=0;e<ui[t].len;e++){f[e]=i}return}function ub(t){Eb(t);return ui[t].tag}function Tb(t){Ab(t)}function Ab(t){var e,r;if(Dj(ui[t].tag))return;for(e=0;e<ui[t].len;e++)if(Nj(qw(t,e)))return;r=oi.modified;Jw(t,ui[t].len,0);oi.modified=r;return}function Eb(t){var e;if(Nj(ui[t].tag))return;if(ui[t].len==0)return;e=oi.modified;Jw(t,0,ui[t].len);oi.modified=e;return}function Rb(t,e,r,i,f,l,a,n,c,s,_,o,u,T,A,E,R,L,C,I,d){var F=new tc.ClsFont;F=xs[e].ShallowCopy();F.TypeFace=r;F.TwipsSize=i;F.TextColor=l;F.TextBkColor=a;F.UlineColor=n;F.style=f;F.FieldId=c;F.AuxId=s;F.Aux1Id=_;F.CharStyId=o;F.ParaStyId=u;F.expand=T;F.ScaleX=xs[e].ScaleX;F.rtlch=xs[e].rtlch;F.TempStyle=A;F.lang=E;F.CharSet=C;F.offset=L;F.TextAngle=d;F.flags=cj(F.flags,tc.FFLAG_MASK);F.flags|=I;if(Nj(R)){F.FieldCode=R}return Lb(t,e,F)}function Lb(t,e,r){var i,f;var l;var a;var n;if(Nj(xs[e].style&tc.PICT))return e;if(Z_&&Nj(nO&tc.TOFLAG2_SET_TRACK_FONT)){if(r.DelRev>0)return e;if(r.FmtRev==0)r.FmtOrigFont=e;r.FmtRev=q_;r.FmtTime=$_}r.flags&=tc.FFLAG_MASK;if(Dh){if(Dj(xs[e].style&tc.PICT)&&Tk(xs[e].TypeFace,r.TypeFace)==0&&xs[e].TwipsSize==r.TwipsSize&&Ny(xs[e].TextColor,r.TextColor)&&Ny(xs[e].TextBkColor,r.TextBkColor)&&Ny(xs[e].UlineColor,r.UlineColor)&&Ny(xs[e].HilightColor,r.HilightColor)&&Ny(xs[e].WlineColor,r.WlineColor)&&xs[e].style==r.style&&xs[e].AuxId==r.AuxId&&xs[e].CharId==r.CharId&&xs[e].Aux1Id==r.Aux1Id&&xs[e].CharStyId==r.CharStyId&&xs[e].ParaStyId==r.ParaStyId&&xs[e].expand==r.expand&&xs[e].ScaleX==r.ScaleX&&xs[e].rtlch==r.rtlch&&xs[e].flow==r.flow&&xs[e].TempStyle==r.TempStyle&&xs[e].ProtExId==r.ProtExId&&xs[e].lang==r.lang&&xs[e].UcBase==r.UcBase&&(xs[e].CharSet==r.CharSet||r.CharSet==ks&&(xs[e].CharSet==0||xs[e].CharSet==tc.SYMBOL_CHARSET))&&xs[e].InsRev==r.InsRev&&Ak(xs[e].InsTime,r.InsTime)&&xs[e].DelRev==r.DelRev&&Ak(xs[e].DelTime,r.DelTime)&&xs[e].FmtRev==r.FmtRev&&Ak(xs[e].FmtTime,r.FmtTime)&&xs[e].FmtOrigFont==r.FmtOrigFont&&xs[e].offset==r.offset&&xs[e].TextAngle==r.TextAngle&&(xs[e].flags&tc.FFLAG_MASK)==(r.flags&tc.FFLAG_MASK)&&Cw(xs[e].FieldCode,r.FieldCode)&&xs[e].FieldId==r.FieldId&&Cb(xs[e].StoryIds,r.StoryIds))return e;for(i=0;i<Ys;i++){if(!xs[i].InUse||Nj(xs[i].style&tc.PICT))continue;if(Tk(xs[i].TypeFace,r.TypeFace)!=0)continue;if(xs[i].TwipsSize!=r.TwipsSize)continue;if(!Ny(xs[i].TextColor,r.TextColor))continue;if(!Ny(xs[i].TextBkColor,r.TextBkColor))continue;if(!Ny(xs[i].UlineColor,r.UlineColor))continue;if(!Ny(xs[i].HilightColor,r.HilightColor))continue;if(!Ny(xs[i].WlineColor,r.WlineColor))continue;if(xs[i].style!=r.style)continue;if(xs[i].AuxId!=r.AuxId)continue;if(xs[i].Aux1Id!=r.Aux1Id)continue;if(xs[i].CharId!=r.CharId)continue;if(xs[i].CharStyId!=r.CharStyId)continue;if(xs[i].ParaStyId!=r.ParaStyId)continue;if(xs[i].expand!=r.expand)continue;if(xs[i].ScaleX!=r.ScaleX)continue;if(xs[i].rtlch!=r.rtlch)continue;if(xs[i].flow!=r.flow)continue;if(xs[i].TempStyle!=r.TempStyle)continue;if(xs[i].ProtExId!=r.ProtExId)continue;if(xs[i].lang!=r.lang)continue;if(xs[i].UcBase!=r.UcBase)continue;n=xs[i].CharSet==r.CharSet;if(!n&&r.CharSet==ks&&xs[i].CharSet==tc.SYMBOL_CHARSET)n=true;if(!n&&r.CharSet==ks&&xs[i].CharSet==tc.ANSI_CHARSET)n=true;if(!n)continue;if(xs[i].InsRev!=r.InsRev)continue;if(!Ak(xs[i].InsTime,r.InsTime))continue;if(xs[i].DelRev!=r.DelRev)continue;if(!Ak(xs[i].DelTime,r.DelTime))continue;if(xs[i].FmtRev!=r.FmtRev)continue;if(!Ak(xs[i].FmtTime,r.FmtTime))continue;if(xs[i].FmtOrigFont!=r.FmtOrigFont)continue;if(xs[i].offset!=r.offset)continue;if(xs[i].TextAngle!=r.TextAngle)continue;if((xs[i].flags&tc.FFLAG_MASK)!=(r.flags&tc.FFLAG_MASK))continue;if(!Cw(xs[i].FieldCode,r.FieldCode))continue;if(xs[i].FieldId!=r.FieldId)continue;if(!Cb(xs[i].StoryIds,r.StoryIds))continue;return i}}else Dh=true;a=r.TypeFace;if((f=Nx())==-1)return e;xs[f].InUse=true;xs[f].TypeFace=r.TypeFace;xs[f].FontFamily=r.FontFamily;xs[f].TwipsSize=r.TwipsSize;xs[f].TextColor=r.TextColor;xs[f].TextBkColor=r.TextBkColor;xs[f].UlineColor=r.UlineColor;xs[f].HilightColor=r.HilightColor;xs[f].WlineColor=r.WlineColor;xs[f].style=r.style;xs[f].FieldId=r.FieldId;xs[f].AuxId=r.AuxId;xs[f].Aux1Id=r.Aux1Id;xs[f].CharId=r.CharId;xs[f].CharStyId=r.CharStyId;xs[f].ParaStyId=r.ParaStyId;xs[f].expand=r.expand;xs[f].ScaleX=r.ScaleX;xs[f].rtlch=r.rtlch;xs[f].flow=r.flow;xs[f].TempStyle=r.TempStyle;xs[f].ProtExId=r.ProtExId;xs[f].lang=r.lang;xs[f].CharSet=r.CharSet;xs[f].UcBase=r.UcBase;xs[f].InsRev=r.InsRev;xs[f].InsTime=r.InsTime==null?null:r.InsTime;xs[f].DelRev=r.DelRev;xs[f].DelTime=r.DelTime==null?null:r.DelTime;xs[f].FmtRev=r.FmtRev;xs[f].FmtTime=r.FmtTime==null?null:r.FmtTime;xs[f].FmtOrigFont=r.FmtOrigFont;xs[f].offset=r.offset;xs[f].TextAngle=r.TextAngle;xs[f].flags=cj(xs[f].flags,tc.FFLAG_MASK);xs[f].flags|=r.flags&tc.FFLAG_MASK;if(Nj(r.FieldCode)){xs[f].FieldCode=r.FieldCode}if(Nj(r.StoryIds)){xs[f].StoryIds=r.StoryIds}l=xs[f].CharSet;if(!Rx(t,f,true))QY(tc.MSG_ERR_FONT_CREATE,null);xs[f].CharSet=l;return f}function Cb(t,e){if(t==null)t="";if(e==null)e="";if(t==""&&e=="")return true;if(t=="*"||e=="*")return true;return t==e}function Ib(t){var e,r;var i=[256];for(e=0;e<Ys;e++){if(!xs[e].InUse||Nj(xs[e].style&tc.PICT)||Dj(xs[e].hidden))continue;if(Dj(xs[e].style&tc.FNOTETEXT))continue;if(t&&Nj(xs[e].flags&tc.FFLAG_HIDDEN_INFO))continue;if(!t&&Dj(xs[e].flags&tc.FFLAG_HIDDEN_INFO))continue;xs[e].height=WY(xs[e].height,xs[e].hidden.height);xs[e].hidden.height=JC;xs[e].BaseHeight=WY(xs[e].BaseHeight,xs[e].hidden.BaseHeight);xs[e].hidden.BaseHeight=JC;xs[e].BaseHeightAdj=WY(xs[e].BaseHeightAdj,xs[e].hidden.BaseHeightAdj);xs[e].hidden.BaseHeightAdj=JC;xs[e].ExtLead=WY(xs[e].ExtLead,xs[e].hidden.ExtLead);xs[e].hidden.ExtLead=JC;qY(xs[e].CharWidth,i,256);qY(xs[e].hidden.CharWidth,xs[e].CharWidth,256);qY(i,xs[e].hidden.CharWidth,256);if(Nj(Xs[e].hidden)){Xs[e].height=WY(Xs[e].height,Xs[e].hidden.height);Xs[e].hidden.height=JC;Xs[e].BaseHeight=WY(Xs[e].BaseHeight,Xs[e].hidden.BaseHeight);Xs[e].hidden.BaseHeight=JC;Xs[e].BaseHeightAdj=WY(Xs[e].BaseHeightAdj,Xs[e].hidden.BaseHeightAdj);Xs[e].hidden.BaseHeightAdj=JC;Xs[e].ExtLead=WY(Xs[e].ExtLead,Xs[e].hidden.ExtLead);Xs[e].hidden.ExtLead=JC;qY(Xs[e].CharWidth,i,256);qY(Xs[e].hidden.CharWidth,Xs[e].CharWidth,256);qY(i,Xs[e].hidden.CharWidth,256)}if(t)xs[e].flags|=tc.FFLAG_HIDDEN_INFO;else xs[e].flags=cj(xs[e].flags,tc.FFLAG_HIDDEN_INFO)}return true}function db(t,e,r){var i=t[e];var f;if(i>=tc.CHAR_a&&i<=tc.CHAR_z||i>=tc.CHAR_A&&i<=tc.CHAR_Z)return true;if(i>=tc.CHAR_0&&i<=tc.CHAR_9)return MO==tc.ENGLISH;if(i==tc.CHAR_SPACE){for(f=e-1;f>=0;f--)if(t[f]!=tc.CHAR_SPACE)break;if(f>=0){i=t[f];if(i>=tc.CHAR_a&&i<=tc.CHAR_z||i>=tc.CHAR_A&&i<=tc.CHAR_Z)return true;if(i>=tc.CHAR_0&&i<=tc.CHAR_9)return MO==tc.ENGLISH}for(f=e+1;f<r;f++)if(t[f]!=tc.CHAR_SPACE)break;if(f<r){i=t[f];if(i>=tc.CHAR_a&&i<=tc.CHAR_z||i>=tc.CHAR_A&&i<=tc.CHAR_Z)return true;if(i>=tc.CHAR_0&&i<=tc.CHAR_9)return MO==tc.ENGLISH}}return false}function Fb(t){xs[t]=new tc.ClsFont;Xs[t]=new tc.ClsPrtFont;if(xs[t].CharWidth==null){xs[t].CharWidth=[];Xs[t].CharWidth=[];xs[t].MetCharWidth=[];Xs[t].MetCharWidth=[]}xs[t].TypeFace="";xs[t].TextBkColor=tc.CLR_WHITE;xs[t].TextColor=tc.CLR_AUTO;xs[t].UlineColor=tc.CLR_AUTO;xs[t].HilightColor=tc.CLR_WHITE;xs[t].WlineColor=tc.CLR_AUTO;xs[t].FontFamily=tc.FF_DONTCARE;xs[t].CharSet=ks;xs[t].ObjectType=tc.OBJ_NONE;xs[t].PictAlign=tc.ALIGN_BOT;xs[t].GlbFontId=-1;xs[t].CharStyId=1;xs[t].hFont=0;xs[t].hMeta=0;Xs[t].GlbFontId=-1;Xs[t].hFont=0;return true}function gb(t){if(xs[t].InUse){if(Nj(xs[t].style&tc.PICT)){xs[t].image=null;xs[t].hMeta=0;xs[t].PictFile=null;if(xs[t].PictType==tc.PICT_CONTROL||xs[t].PictType==tc.PICT_FORM){xs[t].InUse=false}if(xs[t].ctl!=null)xs[t].ctl.delete()}else{if(Nj(xs[t].font)){if(xs[t].GlbFontId>=0){if(Nj(v_))v_[xs[t].GlbFontId].UseCount--;else if(Nj(GlbFont))GlbFont[xs[t].GlbFontId].UseCount--}}if(Nj(Xs[t].font)){if(Xs[t].GlbFontId>=0){if(Nj(v_))v_[Xs[t].GlbFontId].UseCount--;else if(Nj(GlbFont))GlbFont[Xs[t].GlbFontId].UseCount--}}}Fb(t)}return true}function Pb(t){xC=VK(t);var e=XK(t);return yq(e)}_i.TerRestrictFont=function(t,e,r,i){if(!lv||!QD())_i.TerCreateControl();Qs=t>0?t*20:-t;qs=e>0?e*20:-e;$s=r;if(i)_i.TerRecreateToolbar(true);return true};function Sb(t,e){var r=t.indexOf(e);if(r<0)return"";var i=t.substr(r);r=i.indexOf(":");if(r<0)return"";i=i.substr(r+1);r=i.indexOf(";");if(r<0)return"";return i.substr(0,r).trim()}function hb(){var t=document.styleSheets;var e=t.length;for(i=0;i<e;i++){try{var r=t[i].cssRules||t[i].rules||[];var f,l=r.length;for(f=0;f<l;f++){var a=r[f].cssText.trim();if(a.indexOf("@font-face")==0){var n=Sb(a,"font-family");var c=Sb(a,"src");if(n.charCodeAt(0)==tc.QUOTE){n=n.substr(1);var s=n.length;if(s>0&&n.charCodeAt(s-1)==tc.QUOTE)n=n.substr(0,s-1)}if(n!=""&&c!=""){_i.TerLoadExtFont(n,"src: "+c,"",true,true)}}}}catch(t){}}}_i.TerLoadExtFont=function(i,f,l,a,n,c){if(!lv||!QD())_i.TerCreateControl();if(_i.TerFontExists(i))return e(c);var t=window.setInterval(function(){if(!_i.TerFontExists(i))return;e(c);window.clearInterval(t)},500);function e(t){var e;var r=false;if(ys.indexOf(i)<0){ys.push(i);ys.sort()}Ks[Vs]=new tc.ClsExtFont;Ks[Vs].typeface=i;Ks[Vs].url=f;Ks[Vs].options=l;Vs++;tE=true;if(a)FN(true);for(e=0;e<Ys;e++){if(xs[e].TypeFace==i){Rx(Ti,e,true);r=true}}if(r){if(n)cG();_z(true)}if(c)c()}return true};function Ob(){var t;if(Ks==null||Vs==0)return true;for(t=0;t<Vs;t++){Ks[t].InUse=false}Ks=null;Vs=0;return true}_i.TerSetCustomFontSizes=function(t,e,r){if(!lv||!QD())_i.TerCreateControl();if(e==undefined||e==null)return false;if(t==undefined||t==null||t.length==0){EO=0;return true}if(EO+1>=RO){RO=EO+10}AO[EO]=new tc.ClsCustomFontProp;AO[EO].IsSizeProp=true;AO[EO].typeface=t;AO[EO].value=e;EO++;if(oi.ToolBar&&r)_i.TerRecreateToolbar(r);return true};_i.TerSetCustomFontStyles=function(t,e,r){if(!lv||!QD())_i.TerCreateControl();if(e==undefined||e==null)return false;if(t==undefined||t==null||t.length==0){EO=0;return true}if(EO+1>=RO){RO=EO+10}AO[EO]=new tc.ClsCustomFontProp;AO[EO].IsSizeProp=false;AO[EO].typeface=t;AO[EO].value=e;EO++;if(oi.ToolBar&&r)_i.TerRecreateToolbar(r);return true};_i.TerSetCustomSymbolFonts=function(t,e){if(!lv||!QD())_i.TerCreateControl();if(t!=undefined&&t!=null)n_=t;if(e!=undefined&&e!=null)c_=e;return true};_i.TerSetCustomFontList=function(t,e){if(!lv||!QD())_i.TerCreateControl();TO=t;if(oi.ToolBar)_i.TerRecreateToolbar(e);return true};function vb(t,e,r){var i;var f;var l=0,a;if(TO==null)return null;i=TO;fonts=[];while(true){a=i.indexOf(",");if(a>=0)f=cV(i,0,a);else f=i;if(f.length>32)f=cV(f,0,32);f=f.trim();if(f.length>0)fonts.push(f);l++;if(a<0)break;a++;if(i.length<=a)break;i=i.substring(a)}if(t)r.setItems(fonts,null,0,true);else{e.setItems(fonts,null,0,false);e.setMaximumRowCount(fonts.length<10?fonts.length:10)}return fonts}_i.SetTerCharStyle=function(t,e,r){if(!lv||!QD())_i.TerCreateControl();if(e&&Nj(t&tc.HLINK))wh|=tc.HLINK;if(k_>=0){t=cj(t,tc.CHAR_BOX);if(e)W_[k_].style|=t;else W_[k_].style=cj(W_[k_].style,t);W_[k_].StyleMask|=t;return true}else{nO|=tc.TOFLAG2_SET_TRACK_FONT;var i=qb(tc.CMASK_STYLE,t,e?1:0,null,r);uj(tc.TOFLAG2_SET_TRACK_FONT);return i}};function pb(t,e,r,i,f,l,a){if(t==tc.CMASK_STYLE)return Nb(e,r,i,f,l,a);if(t==tc.CMASK_CHAR_STYLE)return GZ(e,r,i,f,l,a);if(t==tc.CMASK_TEMP_STYLE)return Gb(e,r,i,f,l,a);if(t==tc.CMASK_AUX)return gy(e,r,i,f,l,a);if(t==tc.CMASK_LANG)return Fy(e,r,i,f,l,a);if(t==tc.CMASK_TEXT_COLOR)return fx(e,r,i,f,l,a);if(t==tc.CMASK_TEXT_BK_COLOR)return lx(e,r,i,f,l,a);if(t==tc.CMASK_FLOW)return rx(e,r,i,f,l,a);if(t==tc.CMASK_ULINE_COLOR)return ax(e,r,i,f,l,a);if(t==tc.CMASK_HILIGHT_COLOR)return cx(e,r,i,f,l,a);if(t==tc.CMASK_EXPAND)return ox(e,r,i,f,l,a);if(t==tc.CMASK_SCALE_X)return ux(e,r,i,f,l,a);if(t==tc.CMASK_OFFSET)return Tx(e,r,i,f,l,a);if(t==tc.CMASK_FONT_ETC)return hx(e,r,i,f,l,a);if(t==tc.CMASK_FONT)return Ox(e,r,i,f,l,a);if(t==tc.CMASK_SIZE)return vx(e,r,i,f,l,a);if(t==tc.CMASK_FIELD)return Rw(e,r,i,f,l,a);if(t==tc.CMASK_STORY)return iy(e,r,i,f,l,a);if(t==tc.CMASK_PROPS)return Hb(e,r,i,f,l,a);if(t==tc.CMASK_SIZE_PERCENT)return px(e,r,i,f,l,a);return e}function Nb(t,e,r,i,f,l){var a,n;var c,s;var _;s=e;s=s&~tc.PICT;_=Nj(r);a=t;c=xs[a].style;if(_)c=c|s;else c=c&~s;if(_&&Nj(s&tc.SUPSCR))c=c&~tc.SUBSCR;if(_&&Nj(s&tc.SUBSCR))c=c&~tc.SUPSCR;if(xs[t].FieldId==tc.FIELD_NAME&&l>=0){var o=Sm(f,l);if(o=="{".charCodeAt(0)||o=="}".charCodeAt(0)){if(Nj(xs[a].style&tc.PROTECT))c|=tc.PROTECT;if(Dj(xs[a].style&tc.PROTECT))c=cj(c,tc.PROTECT)}}if(Nj(c&tc.PICT)){xs[a].style=c;if(Nj(s&tc.HIDDEN)){HN(a,hV(xs[a].PictHeight),dV(xs[a].PictWidth),true);mN(a)}if(Nj(s&tc.PROTECT)&&xs[a].ctl!=null){var u=true;if(!mh){if(oi.ReadOnly&&Nj(qh&tc.TFLAG4_READONLY_CONTROLS))u=false;if(Nj(xs[a].style&tc.PROTECT))u=false}xs[a].ctl.setEnabled(u)}return t}if((n=Rb(Ti,a,xs[a].TypeFace,xs[a].TwipsSize,c,xs[a].TextColor,xs[a].TextBkColor,xs[a].UlineColor,xs[a].FieldId,xs[a].AuxId,xs[a].Aux1Id,xs[a].CharStyId,xs[a].ParaStyId,xs[a].expand,xs[a].TempStyle,xs[a].lang,xs[a].FieldCode,xs[a].offset,xs[a].CharSet,xs[a].flags,xs[a].TextAngle))>=0){return n}else return t}_i.TerSetFontStyle=function(t,e,r){return Db(t,e,r)};function Db(t,e,r){var i;if(Nj(xs[t].style&tc.PICT)){if(r)xs[t].style|=e;else xs[t].style=cj(xs[t].style,e);return t}i=xs[t].style;if(r)i|=e;else i=cj(i,e);return Rb(Ti,t,xs[t].TypeFace,xs[t].TwipsSize,i,xs[t].TextColor,xs[t].TextBkColor,xs[t].UlineColor,xs[t].FieldId,xs[t].AuxId,xs[t].Aux1Id,xs[t].CharStyId,xs[t].ParaStyId,xs[t].expand,xs[t].TempStyle,xs[t].lang,xs[t].FieldCode,xs[t].offset,xs[t].CharSet,xs[t].flags,xs[t].TextAngle)}function Mb(t,e,r){return qb(tc.CMASK_TEMP_STYLE,t,e?1:0,null,r)}function Gb(t,e,r,i,f,l){var a,n;var c,s,_=e;var o=Nj(r);a=t;c=xs[a].style;s=xs[a].TempStyle;if(Nj(c&tc.PICT))return t;if(o)s|=_;else s=cj(s,_);if((n=Rb(Ti,a,xs[a].TypeFace,xs[a].TwipsSize,xs[a].style,xs[a].TextColor,xs[a].TextBkColor,xs[a].UlineColor,xs[a].FieldId,xs[a].AuxId,xs[a].Aux1Id,xs[a].CharStyId,xs[a].ParaStyId,xs[a].expand,s,xs[a].lang,xs[a].FieldCode,xs[a].offset,xs[a].CharSet,xs[a].flags,xs[a].TextAngle))>=0){return n}else return t}function Bb(t,e,r){if(Nj(xs[t].style&tc.PICT))return t;return Rb(Ti,t,xs[t].TypeFace,xs[t].TwipsSize,xs[t].style,xs[t].TextColor,xs[t].TextBkColor,xs[t].UlineColor,xs[t].FieldId,xs[t].AuxId,xs[t].Aux1Id,e,r,xs[t].expand,xs[t].TempStyle,xs[t].lang,xs[t].FieldCode,xs[t].offset,xs[t].CharSet,xs[t].flags,xs[t].TextAngle)}_i.TerSetFontProps=function(t,e,r){var i;if(!lv||!QD())_i.TerCreateControl();if(t<0||t>=Ys||!xs[t].InUse)return false;if(k_>=0){var f=tc.BOLD|tc.ULINE|tc.ULINED|tc.ITALIC|tc.STRIKE|tc.DOUBLE_STRIKE|tc.SUPSCR|tc.SUBSCR|tc.SCAPS|tc.CAPS|tc.HIDDEN|tc.PROTECT;W_[k_].CharMask=e;if(Nj(e&tc.CMASK_FONT_LATIN))W_[k_].TypeFace=xs[t].TypeFace;if(Nj(e&tc.CMASK_FONT_DB))W_[k_].TypeFaceDB=xs[t].TypeFace;if(Nj(e&tc.CMASK_FONT_HI))W_[k_].TypeFaceHi=xs[t].TypeFace;if(Nj(e&tc.CMASK_FONT_RTL))W_[k_].TypeFaceCs=xs[t].TypeFace;if(Nj(e&tc.CMASK_SIZE)){W_[k_].TwipsSize=xs[t].TwipsSize}if(Nj(e&tc.CMASK_EXPAND)){W_[k_].expand=xs[t].expand}if(Nj(e&tc.CMASK_TEXT_COLOR)){W_[k_].TextColor=xs[t].TextColor}if(Nj(e&tc.CMASK_TEXT_BK_COLOR)){W_[k_].TextBkColor=xs[t].TextBkColor}if(Nj(e&tc.CMASK_OFFSET)){W_[k_].offset=xs[t].offset}if(Nj(e&tc.CMASK_ULINE_COLOR)){W_[k_].UlineColor=xs[t].UlineColor}if(Nj(e&tc.CMASK_SCALE_X)){W_[k_].CharScaleX=xs[t].ScaleX}if(Nj(e&tc.CMASK_LANG)){W_[k_].lang=xs[t].lang}W_[k_].style=W_[k_].style=cj(W_[k_].style,f);W_[k_].style|=xs[t].style&f;return true}else{nO|=tc.TOFLAG2_SET_TRACK_FONT;i=qb(tc.CMASK_PROPS,t,e,null,r);nO=_j(nO,tc.TOFLAG2_SET_TRACK_FONT);return i}};function Hb(t,e,r,i,f,l){var a;var n;var c;var s;var _=tc.BOLD|tc.ULINE|tc.ULINED|tc.ITALIC|tc.STRIKE|tc.DOUBLE_STRIKE|tc.SUPSCR|tc.SUBSCR|tc.SCAPS|tc.CAPS|tc.HIDDEN|tc.PROTECT|tc.CHAR_BOX;var o;c=e;s=r;a=t;n=xs[a].style;if(Nj(n&tc.PICT)){if(Nj(s&tc.CMASK_FLOW)){var u=xs[c].flow;xs[a].flow=u;if(u==tc.FLOW_RTL)xs[a].rtlch=true;else xs[a].rtlch=false}return t}o=xs[a].ShallowCopy();if(Nj(s&tc.CMASK_FONT)){o.TypeFace=xs[c].TypeFace}if(Nj(s&tc.CMASK_SIZE)){o.TwipsSize=xs[c].TwipsSize}if(Nj(s&tc.CMASK_EXPAND)){o.expand=xs[c].expand}if(Nj(s&tc.CMASK_TEXT_COLOR)){o.TextColor=xs[c].TextColor}if(Nj(s&tc.CMASK_TEXT_BK_COLOR)){o.TextBkColor=xs[c].TextBkColor}if(Nj(s&tc.CMASK_OFFSET)){o.offset=xs[c].offset}if(Nj(s&tc.CMASK_AUX)){o.AuxId=xs[c].AuxId}if(Nj(s&tc.CMASK_ULINE_COLOR)){o.UlineColor=xs[c].UlineColor}if(Nj(s&tc.CMASK_HILIGHT_COLOR)){o.HilightColor=xs[c].HilightColor}if(Nj(s&tc.CMASK_SCALE_X)){o.ScaleX=xs[c].ScaleX}if(Nj(s&tc.CMASK_LANG)){o.lang=xs[c].lang}if(Nj(s&tc.CMASK_FLOW)){o.flow=xs[c].flow;if(o.flow==tc.FLOW_RTL)o.rtlch=true;else o.rtlch=false}o.style=cj(o.style,_);o.style|=xs[c].style&_;o.CharStyId=xs[c].CharStyId;return Lb(Ti,t,o)}function mb(t,e){var r;if(Nj(xs[t].style&tc.PICT)){xs[t].TextAngle=e;HN(t,hV(xs[t].PictHeight),dV(xs[t].PictWidth),true);mN(t);return t}if((r=Rb(Ti,t,xs[t].TypeFace,xs[t].TwipsSize,xs[t].style,xs[t].TextColor,xs[t].TextBkColor,xs[t].UlineColor,xs[t].FieldId,xs[t].AuxId,xs[t].Aux1Id,xs[t].CharStyId,xs[t].ParaStyId,xs[t].expand,xs[t].TempStyle,xs[t].lang,xs[t].FieldCode,xs[t].offset,xs[t].CharSet,xs[t].flags,e))>=0){return r}else return t}function wb(t,e){var r;if(Nj(xs[t].style&tc.PICT))return t;r=xs[t].flags;if(e)r|=tc.FFLAG_SCAPS;else r=cj(r,tc.FFLAG_SCAPS);return Rb(Ti,t,xs[t].TypeFace,xs[t].TwipsSize,xs[t].style,xs[t].TextColor,xs[t].TextBkColor,xs[t].UlineColor,xs[t].FieldId,xs[t].AuxId,xs[t].Aux1Id,xs[t].CharStyId,xs[t].ParaStyId,xs[t].expand,xs[t].TempStyle,xs[t].lang,xs[t].FieldCode,xs[t].offset,xs[t].CharSet,r,xs[t].TextAngle)}function xb(t,e,r,i){var f;if(Nj(xs[t].style&tc.PICT))return t;f=xs[t].ShallowCopy();f.TypeFace=e;f.CharSet=r;f.lang=i;return Lb(Ti,t,f)}function yb(t,e,r){var i;var f=nO;var l;if(Nj(xs[t].style&tc.PICT))return t;i=xs[t].ShallowCopy();i.CharSet=e;if(r!=-1)i.lang=r;nO|=tc.TOFLAG2_IN_SET_CHARSET;l=Lb(Ti,t,i);nO=f;return l}function Wb(t,e){var r;if(Nj(xs[t].style&tc.PICT))return t;r=xs[t].ShallowCopy();r.UcBase=e;if(e>0)r.CharSet=0;return Lb(Ti,t,r)}function Ub(t,e){var r;if(Nj(xs[t].style&tc.PICT))return t;r=xs[t].ShallowCopy();r.WlineColor=e;return Lb(Ti,t,r)}function kb(t,e){var r;if(Nj(xs[t].style&tc.PICT))return t;r=xs[t].ShallowCopy();r.CharId=e;return Lb(Ti,t,r)}function Xb(t,e){var r,i,f;var l;var a;for(r=t;r<=e;r++){f=ui[r].len;a=nb(r);for(i=0;i<f;i++){l=a[i];if(xs[l].height>0)return false}}return true}function Kb(t,e,r,i,f){var l,a,n,c;var s=tc.FLOW_DEF,_=tc.FLOW_DEF;var o=false;var u;var T;var A;var E=-1;var R=0;var L=0;var C=0;var I=false;if(t>0||e>0){u=ib(t,e);s=xs[u].flow}else s=f?tc.FLOW_RTL:tc.FLOW_DEF;for(l=t;l<=r;l++){if(l==t)n=e;else n=0;if(l==r)c=i;else c=ui[l].len;o=Nc[ui[l].pfmt].flow==tc.FLOW_RTL||mr==tc.FLOW_RTL;T=nb(l);A=ui[l].txt;for(a=n;a<c;a++){var d=A[a];u=T[a];_=tc.FLOW_DEF;I=false;if(Yq(d))_=tc.FLOW_RTL;else if("{}[]()".indexOf(d)>=0){if(f&&o)_=tc.FLOW_RTL;else _=tc.FLOW_LTR}else if(d>=tc.CHAR_a&&d<=tc.CHAR_z||d>=tc.CHAR_A&&d<=tc.CHAR_Z||d>=tc.CHAR_0&&d<=tc.CHAR_9)_=tc.FLOW_LTR;else if(d==tc.CHAR_SPACE||wq(d,u)){_=s;I=true;if(E<0){E=l;R=a;L=_;C=s}}else _=s;if(_==tc.FLOW_RTL&&(!xs[u].rtlch||xs[u].flow!=tc.FLOW_RTL)){T[a]=Vb(u,d,true)}else if(_!=tc.FLOW_RTL&&(xs[u].rtlch||xs[u].flow==tc.FLOW_RTL)){T[a]=Vb(u,d,false)}if(!I&&E>=0){if(C!=_){Yb(E,R,l,a,o,_,C,L)}E=-1}s=_}}if(E>=0){T=nb(r);A=ui[r].txt;_=L;if(i<ui[r].len){u=T[i];if(A[i]==Bn||A[i]==TR){_=o?tc.FLOW_RTL:tc.FLOW_LTR}else _=xs[u].rtlch?tc.FLOW_RTL:tc.FLOW_LTR}else if(r+1<Ri&&ui[r+1].len>0){T=nb(r+1);u=T[0];_=xs[u].rtlch?tc.FLOW_RTL:tc.FLOW_LTR}if(C!=_){Yb(E,R,r,i,o,_,C,L)}}return true}function Yb(t,e,r,i,f,l,a,n){var c=l;var s,_,o,u;var T;var A;var E;if(f){if(a==tc.FLOW_LTR&&l==tc.FLOW_RTL)c=tc.FLOW_RTL;else if(a==tc.FLOW_RTL&&l==tc.FLOW_LTR)c=tc.FLOW_RTL}else{if(a==tc.FLOW_RTL&&l==tc.FLOW_LTR)c=tc.FLOW_LTR;else if(a==tc.FLOW_LTR&&l==tc.FLOW_RTL)c=tc.FLOW_LTR}if(c==n)return true;for(s=t;s<=r;s++){if(s==t)o=e;else o=0;if(s==r)u=i;else u=ui[s].len;A=nb(s);E=ui[s].txt;for(_=o;_<u;_++){var R=E[_];T=A[_];if(c==tc.FLOW_RTL&&(!xs[T].rtlch||xs[T].flow!=tc.FLOW_RTL)){A[_]=Vb(T,R,true)}else if(c!=tc.FLOW_RTL&&(xs[T].rtlch||xs[T].flow==tc.FLOW_RTL)){A[_]=Vb(T,R,false)}}}return true}function Vb(t,e,r){var i=0;if(r){t=Jb(t,true);if(kq(e))i=tc.ARABIC_CHARSET;else i=tc.HEBREW_CHARSET;if(xs[t].CharSet!=i)t=yb(t,i,xs[t].lang)}else{t=Jb(t,false);if(xs[t].CharSet==tc.ARABIC_CHARSET||xs[t].CharSet==tc.HEBREW_CHARSET)t=yb(t,0,xs[t].lang)}return t}function jb(t){var e=0,r,i=ui[t].len;var f;var l;var a;var n;var c,s;var _;f=nb(t);l=ui[t].txt;for(r=0;r<i;r++){n=l[r];a=f[r];if(r>0)e=f[r-1];s=false;if(r>0&&(xs[e].rtlch||xs[e].rtl)){s=n==tc.CHAR_SPACE||n==tc.TAB||n==gk(",")||n==tc.CHAR_QUOTE||n=="(".charCodeAt(0)||n==")".charCodeAt(0)||n=="[".charCodeAt(0)||n=="]".charCodeAt(0)||n=="{".charCodeAt(0)||n=="}".charCodeAt(0);if(!s&&(n==";".charCodeAt(0)||n==":".charCodeAt(0)))s=true;if(!s&&(n>=tc.CHAR_0&&n<=tc.CHAR_9))s=true}if(n>255||s){c=s||Yq(n);if(c){if(!xs[a].rtlch)f[r]=a=Jb(a,true);if(!s){if(kq(n))_=tc.ARABIC_CHARSET;else _=tc.HEBREW_CHARSET;if(xs[a].CharSet!=_)f[r]=a=yb(a,_,xs[a].lang)}}}}return true}function Jb(t,e){var r;var i;if(Nj(xs[t].style&tc.PICT))return t;if(e&&(xs[t].rtlch==e&&xs[t].flow==tc.FLOW_RTL))return t;if(!e&&(xs[t].rtlch==e&&xs[t].flow==tc.FLOW_LTR))return t;r=xs[t].ShallowCopy();r.rtlch=e;r.flow=e?tc.FLOW_RTL:tc.FLOW_LTR;i=Lb(Ti,t,r);if(i!=t)xs[i].rtlch=e;return i}function zb(t){return Zb(t,null)}function Zb(t,e){var r;var i=tc.FLOW_DEF;var f=",symbol,wingdings,wingdings,wingdings2,wingdings3,webdings,";var l;if(xs[t].CharSet==tc.SYMBOL_CHARSET)return t;l=","+xs[t].TypeFace.toLowerCase()+",";if(MO==tc.ENGLISH&&th==tc.ENGLISH&&$S==tc.ANSI_CHARSET&&xs[t].CharSet==ks){if(xs[t].lang==0||xs[t].lang==tc.ENGLISH)$S=xs[t].CharSet}if($S==tc.HEBREW_CHARSET){if(!Sa.shiftKey)i=tc.FLOW_RTL}else if($S==tc.ARABIC_CHARSET)i=tc.FLOW_RTL;else i=0;if(xs[t].CharSet==$S&&xs[t].lang==th&&i==xs[t].flow)return t;r=xs[t].ShallowCopy();r.CharSet=$S;r.lang=th;r.flow=i;return Lb(Ti,t,r)}function Qb(t){eh=t;th=t;$S=0;return true}function qb(t,e,r,i,f){var l;oi.modified++;if(uA==tc.HILIGHT_LINE){$b(t,e,r,i,f);return true}if(uA==tc.HILIGHT_CHAR){tx(t,e,r,i,f);return true}if(Dj(cO&tc.TOFLAG3_DONT_UPDATE_PARA_FONT)&&Nj(ui[br].flags&tc.LFLAG_PARA)&&jt+1==ui[br].len){var a;var n=[];l=ib(br,jt);a=pb(t,l,e,r,i,br,jt);if(xs[l].FieldId==xs[a].FieldId&&Dj(xs[a].style&tc.PICT)){n=nb(br);n[jt]=a}}l=$w();Oc=pb(t,l,e,r,i,br,jt);return true}function $b(t,e,r,i,f){var l;var a;var n;if(!ON())return true;if(Nj(Zh&tc.TFLAG2_PROTECT_FORMAT)&&bN(true,true))return true;V8(sA,0,_A,ui[_A].len-1,tc.CHAR_F);for(a=sA;a<=_A;a++){if(ui[a].fmt==null){ui[a].UniFmt=pb(t,ui[a].UniFmt,e,r,i,a,0)}else{n=nb(a);for(l=0;l<ui[a].len;l++){n[l]=pb(t,n[l],e,r,i,a,l)}sb(a)}}if(Nj(aO&tc.TOFLAG_HILIGHT_OFF))uA=tc.HILIGHT_OFF;if(f)cG();if(Fo<0||Fo>sA&&sA>=0&&sA<Ri)Fo=sA;return true}function tx(t,e,r,i,f){var l;var a,n,c;var s;var _=-1,o=0;if(!ON())return true;if(Nj(Zh&tc.TFLAG2_PROTECT_FORMAT)&&bN(true,true))return true;V8(sA,TA,_A,AA-1,tc.CHAR_F);t:{if(sA==_A){s=nb(sA);for(l=TA;l<AA;l++){if(l>=ui[sA].len)break;if(s[l]==_)s[l]=o;else{_=s[l];s[l]=pb(t,s[l],e,r,i,sA,l);o=s[l]}}sb(sA);break t}s=nb(sA);for(l=TA;l<ui[sA].len;l++){if(s[l]==_)s[l]=o;else{_=s[l];s[l]=pb(t,s[l],e,r,i,sA,l);o=s[l]}}sb(sA);s=nb(_A);for(l=0;l<AA;l++){if(l>=ui[_A].len)break;if(s[l]==_)s[l]=o;else{_=s[l];s[l]=pb(t,s[l],e,r,i,_A,l);o=s[l]}}sb(_A);n=sA+1;c=_A-1;for(a=n;a<=c;a++){if(!pm(a))continue;if(ui[a].fmt==null){ui[a].UniFmt=pb(t,ui[a].UniFmt,e,r,i,a,l)}else{s=nb(a);for(l=0;l<ui[a].len;l++){if(s[l]==_)s[l]=o;else{_=s[l];s[l]=pb(t,s[l],e,r,i,a,l);o=s[l]}}sb(a)}}}if(Nj(aO&tc.TOFLAG_HILIGHT_OFF))uA=tc.HILIGHT_OFF;if(f)cG();if(Fo<0||Fo>sA&&sA>=0&&sA<Ri)Fo=sA;return true}function ex(e){var t;var r;var i;var f;var l;var a;if(ui[br].fmt==null)f=ui[br].UniFmt;else{l=ui[br].fmt;if(jt<ui[br].len)f=l[jt];else f=tc.DEFAULT_CFMT;if(Nj(xs[f].style&tc.PICT))f=tc.DEFAULT_CFMT}var n;if(k_>=0){if(e)n=W_[k_].TextColor;else n=W_[k_].TextBkColor}else{if(e)n=xs[f].TextColor;else n=xs[f].TextBkColor}if(MJ(n,tc.CLR_AUTO))n=tc.CLR_BLACK;Dy(e?"Text Color Selection":"Text Background Color Selection",e?"text":"bknd",n,c);function c(t){if(MJ(n,t))return false;if(e)return _i.SetTerColor(t,true);else return _i.SetTerBkColor(t,true)}}_i.SetTerColor=function(t,e){if(!lv||!QD())_i.TerCreateControl();if(typeof t=="string")t=yK(t);if(k_>=0){W_[k_].TextColor=t;W_[k_].CharMask|=tc.CMASK_TEXT_COLOR;return true}else{nO|=tc.TOFLAG2_SET_TRACK_FONT;var r=qb(tc.CMASK_TEXT_COLOR,pJ(t),0,null,e);uj(tc.TOFLAG2_SET_TRACK_FONT);return r}};_i.SetTerBkColor=function(t,e){if(!lv||!QD())_i.TerCreateControl();if(typeof t=="string")t=yK(t);if(k_>=0){W_[k_].TextBkColor=t;W_[k_].CharMask|=tc.CMASK_TEXT_BK_COLOR;return true}else{nO|=tc.TOFLAG2_SET_TRACK_FONT;var r=qb(tc.CMASK_TEXT_BK_COLOR,pJ(t),0,null,e);uj(tc.TOFLAG2_SET_TRACK_FONT);return r}};_i.TerSetCharFlow=function(t,e){if(!lv||!QD())_i.TerCreateControl();if(t!=tc.FLOW_DEF&&t!=tc.FLOW_RTL&&t!=tc.FLOW_LTR)return false;return qb(tc.CMASK_FLOW,t,0,null,e)};_i.TerGetFlowFont=function(t,e){if(!lv||!QD())_i.TerCreateControl();return rx(t,e,0,"",0,0)};function rx(t,e,r,i,f,l){var a,n;var c;var s;var _;s=e;a=t;c=xs[a].style;if(Nj(c&tc.PICT)){xs[a].flow=s;if(s==tc.FLOW_RTL)xs[a].rtlch=true;else xs[a].rtlch=false;return t}_=xs[a].ShallowCopy();_.flow=s;if(s==tc.FLOW_RTL)_.rtlch=true;else _.rtlch=false;if((n=Lb(Ti,a,_))>=0){return n}else return t}_i.TerSetUlineColor=function(t,e,r){if(!lv||!QD())_i.TerCreateControl();if(typeof e=="string")e=yK(e);if(!t)return ix(e,r);if(k_>=0)e=W_[k_].UlineColor;else{if(uA!=tc.HILIGHT_OFF){ON();e=xs[ib(sA,TA)].UlineColor}else e=xs[ib(br,jt)].UlineColor}Dy("Underline Color","line",e,i);function i(t){return ix(t,r)}};function ix(t,e){if(k_>=0){W_[k_].UlineColor=t;W_[k_].CharMask|=tc.CMASK_ULINE_COLOR;return true}else{nO|=tc.TOFLAG2_SET_TRACK_FONT;var r=qb(tc.CMASK_ULINE_COLOR,pJ(t),0,null,e);uj(tc.TOFLAG2_SET_TRACK_FONT);return r}}function fx(t,e,r,i,f,l){var a,n;var c;var s=new tc.Color(e);a=t;c=xs[a].style;if(Nj(c&tc.PICT))return t;if((n=Rb(Ti,a,xs[a].TypeFace,xs[a].TwipsSize,xs[a].style,s,xs[a].TextBkColor,xs[a].UlineColor,xs[a].FieldId,xs[a].AuxId,xs[a].Aux1Id,xs[a].CharStyId,xs[a].ParaStyId,xs[a].expand,xs[a].TempStyle,xs[a].lang,xs[a].FieldCode,xs[a].offset,xs[a].CharSet,xs[a].flags,xs[a].TextAngle))>=0){return n}else return t}function lx(t,e,r,i,f,l){var a,n;var c;var s;s=new tc.Color(e);a=t;c=xs[a].style;if(Nj(c&tc.PICT))return t;if((n=Rb(Ti,a,xs[a].TypeFace,xs[a].TwipsSize,xs[a].style,xs[a].TextColor,s,xs[a].UlineColor,xs[a].FieldId,xs[a].AuxId,xs[a].Aux1Id,xs[a].CharStyId,xs[a].ParaStyId,xs[a].expand,xs[a].TempStyle,xs[a].lang,xs[a].FieldCode,xs[a].offset,xs[a].CharSet,xs[a].flags,xs[a].TextAngle))>=0){return n}else return t}function ax(t,e,r,i,f,l){var a,n;var c;var s=new tc.Color(e);a=t;c=xs[a].style;if(Nj(c&tc.PICT))return t;if((n=Rb(Ti,a,xs[a].TypeFace,xs[a].TwipsSize,xs[a].style,xs[a].TextColor,xs[a].TextBkColor,s,xs[a].FieldId,xs[a].AuxId,xs[a].Aux1Id,xs[a].CharStyId,xs[a].ParaStyId,xs[a].expand,xs[a].TempStyle,xs[a].lang,xs[a].FieldCode,xs[a].offset,xs[a].CharSet,xs[a].flags,xs[a].TextAngle))>=0){return n}else return t}_i.TerSetHilightColor=function(t,e,r,i){var f;if(!lv||!QD())_i.TerCreateControl();if(k_>0)return true;if(Ah){if(r){Ah=false;e=tc.CLR_WHITE;return true}e=Eh;t=false}if(!t)return nx(e,r,i);if(uA!=tc.HILIGHT_OFF){ON();e=xs[ib(sA,TA)].HilightColor}else e=tc.Color.yellow;Dy("Highlight Color","bknd",e,l);function l(t){return nx(t,r,i)}};function nx(t,e,r){if(uA==tc.HILIGHT_OFF&&e){Ah=true;Eh=t;return true}nO|=tc.TOFLAG2_SET_TRACK_FONT;result=qb(tc.CMASK_HILIGHT_COLOR,pJ(t),0,null,r);nO=_j(nO,tc.TOFLAG2_SET_TRACK_FONT);return result}function cx(t,e,r,i,f,l){var a;var n;var c=new tc.Color(e);var s;a=t;n=xs[a].style;if(Nj(n&tc.PICT))return t;s=xs[a].ShallowCopy();s.HilightColor=c;return Lb(Ti,a,s)}_i.TerSetBkColor=function(t){if(!lv||!QD())_i.TerCreateControl();if(typeof t=="string")t=yK(t);jT=tA=t;_i.TerRepaint(true);return true};_i.TerSetCharSpace=function(t,f,l){if(!lv||!QD())_i.TerCreateControl();if(!t)return sx(f,l);if(k_>=0)f=W_[k_].expand;else{var e=$w();f=xs[e].expand}var r=_i.DlgCompHeight;var i=_i.DlgFont;var a=new $t.DialogBox(te,"Character Spacing",i,true,L,2);var n=a.cvs;a.addGroupBox(0,0,4,2,"",i,0,0,0,JV(17));var c=new $t.RadioButton(n,0,0,JV(15),i,"Expand",f>0,null,C);a.addComp(c,1,0,1,1,"left","middle",JV(15));var s=new $t.RadioButton(n,0,0,JV(15),i,"Compress",f<0,c,C);a.addComp(s,2,0,1,1,"left","middle",JV(15));var _=new $t.RadioButton(n,0,0,JV(15),i,"Normal",f==0,s,C);a.addComp(_,3,0,1,1,"left","middle",JV(15));a.addGroupBox(0,2,4,2,"",i,0,0,JV(30),JV(17));var o=new $t.Label(n,0,0,i,"Adjustment");a.addComp(o,1,2,1,1,"left","middle");var u=new $t.TextBox(n,0,0,JV(60),r,"",i,_i.caret,false,true,null);a.addComp(u,1,3,1,1,"left","middle",JV(10));var T=new $t.Label(n,0,0,i,"     ");a.addComp(T,1,4,1,1,"left","middle");var A=new $t.Label(n,0,0,i,"(Twips)");a.addComp(A,2,2,1,1,"left","top");var E=new $t.Label(n,0,0,i,"       ");a.addComp(E,4,1,1,1,"left","middle",0,0,0,JV(-8));a.show();if(f==0){var R=20;u.setText(R.toString());u.setEnabled(false);o.setEnabled(false);A.setEnabled(false)}else u.setText(Math.abs(f).toString());c.setFocus();function L(t,e,r){if(t=="Cancel"){a.hide();return}else if(t=="OK"){f=0;var i=_.isSelected();if(!i){f=LX(u);if(f<1||f>5e3){u.setFocus();vJ(0);return}if(s.isSelected())f=-f}a.hide();return sx(f,l)}else return}function C(t,e,r){var i=_.isSelected();u.setEnabled(!i);o.setEnabled(!i);A.setEnabled(!i)}};function sx(t,e){if(k_>=0){W_[k_].expand=t;W_[k_].CharMask|=tc.CMASK_EXPAND;return true}else{nO|=tc.TOFLAG2_SET_TRACK_FONT;var r=qb(tc.CMASK_EXPAND,t,0,null,e);uj(tc.TOFLAG2_SET_TRACK_FONT);return r}}_i.TerSetCharScaleX=function(t,i,f){if(!lv||!QD())_i.TerCreateControl();if(!t)return _x(i,f);var e=$w();i=xs[e].ScaleX+100;var r=_i.DlgCompHeight;var l=_i.DlgFont;var a=new $t.DialogBox(te,"Horizontal Character Scaling",l,true,_,2);var n=a.cvs;var c=new $t.Label(n,0,0,l,"Horizontal Scaling Percent");a.addComp(c,0,0,1,1,"Left","middle",0,0,JV(15),0);var s=new $t.TextBox(n,0,0,JV(60),r,i.toString(),l,_i.caret,false,true,null);a.addComp(s,0,1,1,1,"left","middle",0,0,JV(15),0);a.show();s.setFocus();function _(t,e,r){if(t=="Cancel"){a.hide();return}else if(t=="OK"){i=LX(s);if(i<10||i>999){s.setFocus();vJ(0);return}a.hide();return _x(i,f)}else return}};function _x(t,e){t-=100;if(k_>=0){W_[k_].CharScaleX=t;W_[k_].CharMask|=tc.CMASK_SCALE_X;return true}else{nO|=tc.TOFLAG2_SET_TRACK_FONT;var r=qb(tc.CMASK_SCALE_X,t,0,null,e);uj(tc.TOFLAG2_SET_TRACK_FONT);return r}}_i.TerSetFontSpace=function(t,e,r){if(!lv||!QD())_i.TerCreateControl();if(t<0||t>=Ys||!xs[t].InUse||Nj(xs[t].style&tc.PICT))return false;xs[t].expand=e;if(!Rx(Ti,t,true))return false;_z(true);if(r)cG();return true};_i.TerGetFontSpace=function(t){if(!lv||!QD())_i.TerCreateControl();if(t<0||t>=Ys||!xs[t].InUse||Nj(xs[t].style&tc.PICT))return 0;return xs[t].expand};function ox(t,e,r,i,f,l){var a,n;var c;var s;s=e;a=t;c=xs[a].style;if(Nj(c&tc.PICT))return t;if((n=Rb(Ti,a,xs[a].TypeFace,xs[a].TwipsSize,xs[a].style,xs[a].TextColor,xs[a].TextBkColor,xs[a].UlineColor,xs[a].FieldId,xs[a].AuxId,xs[a].Aux1Id,xs[a].CharStyId,xs[a].ParaStyId,s,xs[a].TempStyle,xs[a].lang,xs[a].FieldCode,xs[a].offset,xs[a].CharSet,xs[a].flags,xs[a].TextAngle))>=0){return n}else return t}function ux(t,e,r,i,f,l){var a,n;var c;var s;var _;s=e;a=t;c=xs[a].style;if(Nj(c&tc.PICT))return t;_=xs[a].ShallowCopy();_.ScaleX=s;if((n=Lb(Ti,a,_))>=0){return n}else return t}_i.TerSetCharOffset=function(t,e){if(!lv||!QD())_i.TerCreateControl();if(k_>=0){W_[k_].offset=t;W_[k_].CharMask|=tc.CMASK_OFFSET;return true}else return qb(tc.CMASK_OFFSET,t,0,null,e)};function Tx(t,e,r,i,f,l){var a,n;var c;var s;s=e;a=t;c=xs[a].style;if(Nj(c&tc.PICT))return t;if((n=Rb(Ti,a,xs[a].TypeFace,xs[a].TwipsSize,xs[a].style,xs[a].TextColor,xs[a].TextBkColor,xs[a].UlineColor,xs[a].FieldId,xs[a].AuxId,xs[a].Aux1Id,xs[a].CharStyId,xs[a].ParaStyId,xs[a].expand,xs[a].TempStyle,xs[a].lang,xs[a].FieldCode,s,xs[a].CharSet,xs[a].flags,xs[a].TextAngle))>=0){return n}else return t}_i.TerLocateStyle=function(t,e,r){var i;var f,l,a,n,c;var s;var _;if(!lv||!QD())_i.TerCreateControl();yC=0;for(i=e;i<Ri;i++){if(i==e)a=r;else a=0;if(a>=ui[i].len)continue;if(ui[i].len==0)continue;if(ui[i].fmt==null){n=ui[i].UniFmt;_=xs[n].style;if(Nj(_&t)){PC=i;SC=a;yC=ui[i].len-a;return true}else continue}s=nb(i);for(f=a;f<ui[i].len;f++){n=s[f];_=xs[n].style;if(Nj(_&t)){for(l=f+1;l<ui[i].len;l++){c=s[l];_=xs[c].style;if(Dj(_&t))break}PC=i;SC=f;yC=l-f;sb(i);return true}}sb(i)}return false};_i.TerLocateStyleChar=function(t,e,r,i,f){var l;var a,n,c;var s;var _;if(!lv||!QD())_i.TerCreateControl();if(f){for(l=r;l<Ri;l++){if(l==r)n=i;else n=0;if(n>=ui[l].len)continue;if(ui[l].len==0)continue;if(ui[l].fmt==null){c=ui[l].UniFmt;_=xs[c].style;if(e&&Nj(_&t)||!e&&Dj(_&t)){zC=l;ZC=n;return true}else continue}s=nb(l);for(a=n;a<ui[l].len;a++){c=s[a];_=xs[c].style;if(e&&Nj(_&t)||!e&&Dj(_&t)){zC=l;ZC=a;sb(l);return true}}sb(l)}}else{for(l=r;l>=0;l--){if(l==r)n=i;else n=ui[l].len-1;if(n<0)continue;if(ui[l].len==0)continue;if(ui[l].fmt==null){c=ui[l].UniFmt;_=xs[c].style;if(e&&Nj(_&t)||!e&&Dj(_&t)){zC=l;ZC=n;return true}else continue}s=nb(l);for(a=n;a>=0;a--){c=s[a];_=xs[c].style;if(e&&Nj(_&t)||!e&&Dj(_&t)){zC=l;ZC=a;sb(l);return true}}sb(l)}}return false};_i.TerLocateFontFlags=function(t,e,r,i,f){var l;var a,n,c;var s;var _;if(!lv||!QD())_i.TerCreateControl();if(f){for(l=r;l<Ri;l++){if(l==r)n=i;else n=0;if(n>=ui[l].len)continue;if(ui[l].len==0)continue;if(ui[l].fmt==null){c=ui[l].UniFmt;_=xs[c].flags;if(e&&Nj(_&t)||!e&&Dj(_&t)){r=l;i=n;return true}else continue}s=nb(l);for(a=n;a<ui[l].len;a++){c=s[a];_=xs[c].flags;if(e&&Nj(_&t)||!e&&Dj(_&t)){r=l;i=a;sb(l);return true}}sb(l)}}else{for(l=r;l>=0;l--){if(l==r)n=i;else n=ui[l].len-1;if(n<0)continue;if(ui[l].len==0)continue;if(ui[l].fmt==null){c=ui[l].UniFmt;_=xs[c].flags;if(e&&Nj(_&t)||!e&&Dj(_&t)){r=l;i=n;return true}else continue}s=nb(l);for(a=n;a>=0;a--){c=s[a];_=xs[c].flags;if(e&&Nj(_&t)||!e&&Dj(_&t)){r=l;i=a;sb(l);return true}}sb(l)}}return false};_i.TerLocateAuxIdChar=function(t,e,r,i,f){var l;var a,n,c,s;var _;if(!lv||!QD())_i.TerCreateControl();if(f){for(l=r;l<Ri;l++){if(l==r)n=i;else n=0;if(n>=ui[l].len)continue;if(ui[l].len==0)continue;if(ui[l].fmt==null){c=ui[l].UniFmt;s=xs[c].AuxId;if(e&&s==t||!e&&s!=t){zC=l;ZC=n;return true}else continue}_=nb(l);for(a=n;a<ui[l].len;a++){c=_[a];s=xs[c].AuxId;if(e&&s==t||!e&&s!=t){zC=l;ZC=a;sb(l);return true}}sb(l)}}else{for(l=r;l>=0;l--){if(l==r)n=i;else n=ui[l].len-1;if(n<0)continue;if(ui[l].len==0)continue;if(ui[l].fmt==null){c=ui[l].UniFmt;s=xs[c].AuxId;if(e&&s==t||!e&&s!=t){zC=l;ZC=n;return true}else continue}_=nb(l);for(a=n;a>=0;a--){c=_[a];s=xs[c].AuxId;if(e&&s==t||!e&&s!=t){zC=l;ZC=a;sb(l);return true}}sb(l)}}return false};_i.TerCreateFont=function(t,e,r,i,f,l,a,n,c){return _i.TerCreateFont2(t,e,r,i,f,l,a,n,c,1,0,0)};_i.TerCreateFont2=function(t,e,r,i,f,l,a,n,c,s,_,o){return _i.TerCreateFont3(t,e,r,i,f,l,a,n,c,s,_,o,ks)};_i.TerCreateFont3=function(t,e,r,i,f,l,a,n,c,s,_,o,u){return _i.TerCreateFont3(t,e,r,i,f,yK(l),yK(a),n,c,s,_,o,u)};_i.TerCreateFont3=function(t,e,r,i,f,l,a,n,c,s,_,o,u){var T,A,E=0,R;if(!lv||!QD())_i.TerCreateControl();if(t>=f_)return-1;if(i>=0)R=i*20;else R=-i;if(t>=0)e=false;if(t>=f_)Mx(t+1);if(t>=Ys){for(T=Ys;T<=t;T++)Fb(T);Ys=t+1}if(!e)Dh=false;if(t>=0)E=t;if(s<0||s>=X_||!W_[s].InUse||W_[s].type!=tc.SSTYPE_CHAR)s=1;if(_<0||_>=X_||!W_[_].InUse||W_[_].type!=tc.SSTYPE_PARA)_=0;A=Rb(Ti,E,r,R,f,l,a,tc.CLR_AUTO,n,c,l_,s,_,o,0,0,null,0,u,0,0);l_=0;if(A>=0)xs[A].flags|=tc.FFLAG_USER;if(t>=0&&A!=t){var L,C;var I,d;if(xs[t].InUse)gb(t);L=xs[t].CharWidth;C=Xs[t].CharWidth;I=xs[t].MetCharWidth;d=Xs[t].MetCharWidth;xs[t]=xs[A];Xs[t]=Xs[A];xs[A].CharWidth=L;Xs[A].CharWidth=C;xs[A].MetCharWidth=I;Xs[A].MetCharWidth=d;Fb(A);A=t}if(A==tc.DEFAULT_CFMT){F=V=xs[tc.DEFAULT_CFMT].font;g=xs[tc.DEFAULT_CFMT].hFont;v=V.met;if(v==null){v=My(ee,V);V.met=v}iG()}bG(true);if(oi.ShowStatus&&A==tc.DEFAULT_CFMT)tB();return A};function Ax(){var t;var e;var r;if(uA==tc.HILIGHT_LINE){e=sA;r=0}else if(uA==tc.HILIGHT_CHAR){e=sA;r=TA}else{e=br;r=jt}if(Oc>=0)t=Oc;else t=$w();Ls=t;zs=xs[t].TypeFace;Zs=xs[t].TwipsSize;yQ(t,i);function i(t,e){if(k_<0&&uA==tc.HILIGHT_OFF&&ui[br].len==1){sA=_A=br;TA=0;AA=1;uA=tc.HILIGHT_CHAR;_i.SetTerFont(zs,false);_i.SetTerPointSize(-Zs,false);uA=tc.HILIGHT_OFF}_i.SetTerFont(zs,false);_i.SetTerPointSize(-Zs,true)}return true}function Ex(t){var e;ZU("RecreateFonts");if(Eu){SavePvResX=Nt;SavePvResY=wt;Nt=yt;wt=Wt}else if(nh!=0&&nh!=100){lX(nh)}for(e=0;e<Ys;e++){if(xs[e].InUse&&Dj(xs[e].style&tc.PICT)){if(!Rx(t,e,true)){var r=SY("#: %d, Font: %s, Twips Size: %d",e,xs[e].TypeFace,xs[e].TwipsSize);QY(tc.MSG_ERR_FONT_CREATE,r)}}}for(e=0;e<Ys;e++){if(xs[e].InUse&&Nj(xs[e].style&tc.PICT)){if(xs[e].PictType==tc.PICT_FORM&&xs[e].FieldId==tc.FIELD_TEXTBOX){mw(e,xs[e].PictWidth)}if(t==Ti){HN(e,hV(xs[e].PictHeight),dV(xs[e].PictWidth),true);mN(e)}else HN(e,mV(xs[e].PictHeight),DV(xs[e].PictWidth),true)}}dr=false;if(t==Ti)F=xs[0].font;return true}function Rx(t,e,r){var i,f,l,a;var n;var c,s,_;var o=null;var u=null;var T,A;var E,R,L=false;var C;var I;var d=0,F=0;var g;if(Nj(xs[e].style&tc.PICT))return true;if(xs[e].CharWidth==null){xs[e].CharWidth=[];Xs[e].CharWidth=[]}if(xs[e].MetCharWidth==null){xs[e].MetCharWidth=[];Xs[e].MetCharWidth=[]}if(Nj(xs[e].font)){V=new tc.Font(oi.FontTypeFace,0,oi.PointSize*wt/72);if(V==null){try{V=new tc.Font("Arial",0,oi.PointSize*wt/72)}catch(t){V=null}}T=xs[e].GlbFontId;if(T>=0){if(Nj(v_))v_[T].UseCount--;else GlbFont[T].UseCount--}else{}xs[e].font=null;xs[e].hFont=0;xs[e].gr=null;xs[e].GlbFontId=-1}if(r&&Ut!=Nt){Rx(Ti,e,false);Xs[e].height=xs[e].height;Xs[e].BaseHeight=xs[e].BaseHeight;Xs[e].BaseHeightAdj=xs[e].BaseHeightAdj;Xs[e].YAdj=xs[e].YAdj;Xs[e].CharWidth=xs[e].CharWidth.slice(0);Xs[e].MetCharWidth=xs[e].MetCharWidth.slice(0);Xs[e].ExtLead=xs[e].ExtLead;Xs[e].OffsetVal=xs[e].OffsetVal;if(Nj(xs[e].hidden)){Xs[e].hidden=xs[e].hidden;xs[e].hidden=null}Xs[e].gr=xs[e].gr;Xs[e].font=xs[e].font.copy();Xs[e].hFont=xs[e].hFont;Xs[e].GlbFontId=xs[e].GlbFontId}if(xs[e].TypeFace==null)xs[e].TypeFace="";g=xs[e].TwipsSize/20;if(r)f=wt;else f=kt;n=xs[e].style;if(!Q_){if(Nj(xs[e].InsRev))n|=ul[xs[e].InsRev].InsStyle;if(Nj(xs[e].DelRev))n|=ul[xs[e].DelRev].DelStyle}s=xs[e].CharSet;if(Tk(xs[e].TypeFace,"Symbol")==0||Tk(xs[e].TypeFace,n_)==0)s=tc.SYMBOL_CHARSET;I=s==tc.GB2312_CHARSET||s==tc.CHINESEBIG5_CHARSET||s==tc.SHIFTJIS_CHARSET;a=g*f/72;if(Nj(n&tc.SUBSCR)||Nj(n&tc.SUPSCR)){g=(g+1)/tc.REDUCTION;if(xs[e].TwipsSize/20<=14)g=g*5/4}else if(Nj(n&tc.SCAPS)&&Nj(xs[e].flags&tc.FFLAG_SCAPS))g=g*82/100;if(g==0)g=1;var P=xs[e].TypeFace;if(s!=tc.SYMBOL_CHARSET){if(P=="Times")P="Times New Roman"}P=Fx(P,s,xs[e].lang);l=0;d=0;if(Nj(n&tc.BOLD))d|=tc.BOLD;if(xs[e].TypeFace.indexOf("Bold")>=0&&P.indexOf("Bold")<0)d|=tc.BOLD;if(Nj(n&tc.ITALIC))d|=tc.ITALIC;if(xs[e].TypeFace.indexOf("Italic")>=0&&P.indexOf("Italic")<0)d|=tc.ITALIC;var S=new tc.Font(P,d,g*f/72);xs[e].font=S;if(xs[e].font==null)return QY(tc.MSG_ERR_FONT_CREATE,"CreateOneFont(a)");xs[e].GlbFontId=-1;S=xs[e].font;xs[e].gr=t;if(Dj(nO&tc.TOFLAG2_IN_SET_CHARSET))xs[e].CharSet=s;o=My(ee,S.FontString);if(o.getAscent()==0&&!ol)return QY(tc.MSG_ERR_FONT_CREATE,"CreateOneFont(d): "+S.FontString);xs[e].ExtLead=o.getLeading();if(xs[e].rtlch){xs[e].rtl=true;e_=true}if(t_&&r)xs[e].ExtLead=0;if(t_)return true;if(!Cx(t,o,e,r,0,0))return QY(tc.MSG_ERR_FONT_CREATE,"CreateOneFont(d)");if(false)xs[e].flags|=tc.FFLAG_ITALIC_OH;else xs[e].flags=cj(xs[e].flags,tc.FFLAG_ITALIC_OH);xs[e].height=o.getHeight();xs[e].BaseHeightAdj=0;if(l==0)l=o.getAscent();else xs[e].BaseHeightAdj=l-o.getAscent();if(xs[e].CharSet==tc.HANGUL_CHARSET&&xs[e].TwipsSize<=180)l=Mj(l,14,10);xs[e].BaseHeight=l;if(Dj(n&(tc.SUPSCR|tc.SUBSCR|tc.SCAPS)))dx(e,f,true);if(xs[e].TextAngle!=0&&Nj(fO&tc.TFLAG10_UPRIGHT_CHARS)){for(i=0;i<256;i++)xs[e].CharWidth[i]=xs[e].height}A=xs[e].offset*f/1440;xs[e].OffsetVal=A;if(Nj(n&tc.SUPSCR)||Nj(n&tc.SUBSCR)){var h=xs[e].height;xs[e].height=a;xs[e].BaseHeight=o.getAscent()*a/h;if(Nj(n&tc.SUPSCR))xs[e].BaseHeightAdj=-(o.getAscent()/4);else xs[e].BaseHeightAdj=a-h}if(xs[e].offset!=0){if(A>0)xs[e].BaseHeight+=A;if(A>0)xs[e].BaseHeightAdj+=A;else xs[e].BaseHeightAdj=-A;xs[e].height+=Math.abs(A)}if(Nj(xs[e].style&tc.CHAR_BOX)){if(r)xs[e].BaseHeightAdj=hV(tc.BOX_BORDER_WIDTH);else xs[e].BaseHeightAdj=mV(tc.BOX_BORDER_WIDTH);xs[e].height+=7*xs[e].BaseHeightAdj/4;xs[e].BaseHeight+=xs[e].BaseHeightAdj}if(um(e)){if(Dj(xs[e].hidden))xs[e].hidden=new tc.ClsHdnFont;xs[e].hidden.height=xs[e].height;xs[e].hidden.BaseHeight=xs[e].BaseHeight;xs[e].hidden.ExtLead=xs[e].ExtLead;xs[e].hidden.BaseHeightAdj=xs[e].BaseHeightAdj;xs[e].hidden.CharWidth=[tc.NUM_WIDTH_CHARS];xs[e].hidden.CharWidth=xs[e].CharWidth.slice(0);xs[e].height=xs[e].BaseHeight=0;xs[e].ExtLead=xs[e].BaseHeightAdj=0;for(i=0;i<tc.NUM_WIDTH_CHARS;i++)xs[e].CharWidth[i]=0}else if(Nj(xs[e].hidden)){xs[e].hidden=null}if(r&&Ut==Nt){Xs[e].height=xs[e].height;Xs[e].BaseHeight=xs[e].BaseHeight;Xs[e].BaseHeightAdj=xs[e].BaseHeightAdj;Xs[e].CharWidth=xs[e].CharWidth.slice(0);Xs[e].MetCharWidth=xs[e].MetCharWidth.slice(0);Xs[e].ExtLead=xs[e].ExtLead;Xs[e].OffsetVal=xs[e].OffsetVal;if(Nj(xs[e].hidden)){Xs[e].hidden=xs[e].hidden.copy()}Xs[e].gr=xs[e].gr;Xs[e].font=xs[e].font;Xs[e].hFont=xs[e].hFont;Xs[e].GlbFontId=xs[e].GlbFontId}if(NS){PY("nf/sf: ",e,r,"tf/s: ",xs[e].TypeFace,xs[e].style,"w: ",xs[e].CharWidth[tc.CHAR_h]);for(i=0;i<Ys;i++)PY(" f: ",i,"tf/s: ",xs[i].TypeFace,xs[i].style,"w: ",xs[i].CharWidth[tc.CHAR_h])}return true}function Lx(t,e){return-1}function Cx(t,e,r,i,f,l){var a,n;var c,s,_;var o=xs[r].font;var u=100;var T="";if(Nj(nO&tc.TOFLAG2_DONT_CALC_CHAR_WIDTH))return true;for(a=0;a<Ys;a++){if(a==r)continue;if(i&&xs[a].font!=null&&xs[a].MetCharWidth!=null&&xs[a].MetCharWidth.length==256&&xs[a].font.equals(xs[r].font)){xs[r].CharWidth=xs[a].MetCharWidth.slice(0);xs[r].MetCharWidth=xs[a].MetCharWidth.slice(0);break}else if(!i&&Xs[a].font!=null&&Xs[a].MetCharWidth!=null&&Xs[a].MetCharWidth.length==256&&Xs[a].font.equals(xs[r].font)){xs[r].CharWidth=Xs[a].MetCharWidth.slice(0);xs[r].MetCharWidth=Xs[a].MetCharWidth.slice(0);break}}if(a==Ys){var A=t.font;t.font=o.FontString;xs[r].CharWidth=[];for(a=0;a<256;a++){if(a<32){xs[r].CharWidth[a]=0;continue}T=wY(a,u);xs[r].CharWidth[a]=EH(t,T,o.FontString).width/u}t.font=A;xs[r].MetCharWidth=xs[r].CharWidth.slice(0)}if(f!=0){for(a=32;a<256;a++){xs[r].CharWidth[a]=xs[r].CharWidth[a]-f}}s=xs[r].expand;if(Nj(s)){if(s>tc.MAX_EXPAND)s=tc.MAX_EXPAND;if(i)s=dV(s);else s=DV(s);for(a=32;a<256;a++){c=s;n=xs[r].CharWidth[a];if(c<0&&-c>n/2)c=-n/2;xs[r].CharWidth[a]+=c}}_=xs[r].ScaleX;if(Nj(_)){for(a=32;a<256;a++){xs[r].CharWidth[a]=Mj(xs[r].CharWidth[a],_+100,100)}}xs[r].CharWidth[0]=0;xs[r].CharWidth[Bn]=xs[r].CharWidth[Nj(Zh&tc.TFLAG2_ALT_PARA_SYM)?tc.DISP_PARA_CHAR_ALT:tc.DISP_PARA_CHAR];xs[r].CharWidth[tc.LINE_CHAR]=xs[r].CharWidth[Nj(Zh&tc.TFLAG2_ALT_LINE_SYM)?tc.DISP_LINE_CHAR_ALT:tc.DISP_LINE_CHAR];xs[r].CharWidth[TR]=xs[r].CharWidth[tc.DISP_CELL_CHAR];xs[r].CharWidth[tc.NBSPACE_CHAR]=xs[r].CharWidth[tc.CHAR_SPACE];if(xs[r].CharSet==tc.CHINESEBIG5_CHARSET||xs[r].CharSet==tc.GB2312_CHARSET||xs[r].CharSet==tc.SHIFTJIS_CHARSET)xs[r].CharWidth[tc.NBSPACE_CHAR]=2*xs[r].CharWidth[tc.SPACE];xs[r].CharWidth[tc.NBDASH_CHAR]=xs[r].CharWidth["-".charCodeAt(0)];if(dS&&!Eu)xs[r].CharWidth[tc.HYPH_CHAR]=xs[r].CharWidth[tc.DISP_HYPH_CHAR];else xs[r].CharWidth[tc.HYPH_CHAR]=0;if(dS&&!Eu)xs[r].CharWidth[tc.HIDDEN_CHAR]=xs[r].CharWidth[tc.DISP_HIDDEN_CHAR];else xs[r].CharWidth[tc.HIDDEN_CHAR]=0;return true}function Ix(t,e){if(lstrcmpi(TypeFace,"Symbol")==0||lstrcmpi(TypeFace,n_)==0)CharSet=SYMBOL_CHARSET;return 0}_i.TerIsAvailableFont=function(t){var e;var r=false;if(!lv||!QD())_i.TerCreateControl();if(Ws.indexOf(t.toLowerCase())>=0)r=true;if(!r&&Vs>0){for(e=0;e<Vs;e++){if(Tk(Ks[e].typeface,t)==0){r=true;break}}}return r};function dx(t,e,r){var i=true;var f=0;var l=xs[t].style;t:{if(xs[t].CharSet==134){if(!Li&&!vr&&Tk(xs[t].TypeFace,"Arial Unicode MS")==0)f=.024;else f=.018;break t}if(Tk(xs[t].TypeFace,"Arial")==0||Tk(xs[t].TypeFace,"Times")==0||Tk(xs[t].TypeFace,"Gill Sans MT")==0||Tk(xs[t].TypeFace,"Times New Roman")==0)f=.015975;else if(Tk(xs[t].TypeFace,"Courier New")==0)f=.014;else if(Tk(xs[t].TypeFace,"Courier")==0)f=.0166;else if(Tk(xs[t].TypeFace,"SimSun")==0)f=.018;else if(!Li&&!vr&&Tk(xs[t].TypeFace,"Arial Unicode MS")==0)f=.024;else i=false}if(i&&r){var a=e*f;var n=a*xs[t].TwipsSize/20;var c=n;xs[t].height=c}return i}function Fx(t,e,r){var i=t;var f="Times New Roman";var l=true;var a=",symbol,wingdings,wingdings,wingdings2,wingdings3,webdings,";var n;if(t==null)t="Arial";n=","+t.toLowerCase()+",";if(Tk(t,"Courier")==0)i="Courier New";else if(t.indexOf("Helv")>=0&&!l)i="Arial";else if(Tk(t,"System")==0)i="Couier New";else if(Tk(t,"MS Sans Serif")==0)i="Arial";else if(Tk(t,"MS Serif")==0)i=f;else if(t.length>=f.length&&t.indexOf(f)==0)i="Times New Roman";return i}function gx(t,e,r){var i;if(t==null)t=Sx(r);if(t==null)return false;var f=t.length;for(i=0;i<f;i++)if(Tk(t[i],e)==0)return true;if(Vs>0){for(i=0;i<Vs;i++)if(Tk(Ks[i].typeface,e)==0)return true}return false}function Px(t,e){var r;if(t==null)t=Sx(e);if(t==null)return"Arial";if(t.length>0)return t[0];else return"Arial"}function Sx(t){return ys}_i.TerSetFontEtc=function(t,e,r,i,f,l,a){if(!lv||!QD())_i.TerCreateControl();if(k_>=0){if(t.length>0){W_[k_].TypeFace=t;W_[k_].CharMask|=tc.CMASK_FONT}if(e>0){W_[k_].TwipsSize=e;W_[k_].CharMask|=tc.CMASK_SIZE}if(i!=0){W_[k_].style=cj(W_[k_].style,i);W_[k_].StyleMask|=i}W_[k_].style|=r;W_[k_].StyleMask|=r;if(f){W_[k_].TextColor=l;W_[k_].CharMask|=tc.CMASK_TEXT_COLOR}return true}else{Ls=e;Ps=f;is=l;return qb(tc.CMASK_FONT_ETC,r,i,t,a)}};function hx(t,e,r,i,f,l){var a,n,c;var s=e;var _=r;var o=Ls;var u=i;var T=Ps;var A=is;var E;a=t;if(u.length==0)u=xs[a].TypeFace;if(o==0)o=xs[a].TwipsSize;c=xs[a].style;if(_!=0)c=cj(c,_);c|=s;if(!T)A=xs[a].TextColor;E=xs[a].CharSet;if(E==tc.SYMBOL_CHARSET)E=ks;if((n=Rb(Ti,a,u,o,c,A,xs[a].TextBkColor,xs[a].UlineColor,xs[a].FieldId,xs[a].AuxId,xs[a].Aux1Id,xs[a].CharStyId,xs[a].ParaStyId,xs[a].expand,xs[a].TempStyle,xs[a].lang,xs[a].FieldCode,xs[a].offset,E,xs[a].flags,xs[a].TextAngle))>=0){return n}else return t}_i.SetTerFont=function(t,e){if(!lv||!QD())_i.TerCreateControl();if(k_>=0){W_[k_].TypeFace=t;W_[k_].CharMask|=tc.CMASK_FONT;return true}else{nO|=tc.TOFLAG2_SET_TRACK_FONT;var r=qb(tc.CMASK_FONT,0,0,t,e);uj(tc.TOFLAG2_SET_TRACK_FONT);return r}};function Ox(t,e,r,i,f,l){var a,n;var c;var s;var _;s=i;a=t;c=xs[a].style;_=xs[a].CharSet;if(_==tc.SYMBOL_CHARSET)_=ks;if((n=Rb(Ti,a,s,xs[a].TwipsSize,c,xs[a].TextColor,xs[a].TextBkColor,xs[a].UlineColor,xs[a].FieldId,xs[a].AuxId,xs[a].Aux1Id,xs[a].CharStyId,xs[a].ParaStyId,xs[a].expand,xs[a].TempStyle,xs[a].lang,xs[a].FieldCode,xs[a].offset,_,xs[a].flags,xs[a].TextAngle))>=0){return n}else return t}_i.SetTerPointSize=function(t,e){var r;var i;if(!lv||!QD())_i.TerCreateControl();if(t>=0)r=t*20;else r=-t;if(k_>=0){W_[k_].TwipsSize=r;W_[k_].CharMask|=tc.CMASK_SIZE;return true}else{nO|=tc.TOFLAG2_SET_TRACK_FONT;var f=qb(tc.CMASK_SIZE,r,0,null,e);uj(tc.TOFLAG2_SET_TRACK_FONT);return f}};function vx(t,e,r,i,f,l){var a,n;var c;var s;s=e;a=t;c=xs[a].style;if((n=Rb(Ti,a,xs[a].TypeFace,s,c,xs[a].TextColor,xs[a].TextBkColor,xs[a].UlineColor,xs[a].FieldId,xs[a].AuxId,xs[a].Aux1Id,xs[a].CharStyId,xs[a].ParaStyId,xs[a].expand,xs[a].TempStyle,xs[a].lang,xs[a].FieldCode,xs[a].offset,xs[a].CharSet,xs[a].flags,xs[a].TextAngle))>=0){return n}else return t}_i.TerAdjustPointSize=function(t,e){var r;var i;if(!lv||!QD())_i.TerCreateControl();if(k_>=0){if(Nj(W_[k_].CharMask&tc.CMASK_SIZE)){var f,l;var a=false;f=W_[k_].TwipsSize*t/100;if(f<0){a=true;f=-f}l=f%10;f=f/10*10;if(l>=5)f+=10;if(a)f=-f;W_[k_].TwipsSize+=f;W_[k_].CharMask|=tc.CMASK_SIZE}return true}else{nO|=tc.TOFLAG2_SET_TRACK_FONT;var n=qb(tc.CMASK_SIZE_PERCENT,t,0,null,e);uj(tc.TOFLAG2_SET_TRACK_FONT);return n}};function px(t,e,r,i,f,l){var a,n;var c,s,_,o;var u=false;a=t;c=xs[a].TwipsSize;s=e;_=c*s/100;if(_<0){u=true;_=-_}o=_%10;_=_/10*10;if(o>=5)_+=10;if(u)_=-_;c=c+_;if((n=Rb(Ti,a,xs[a].TypeFace,c,xs[a].style,xs[a].TextColor,xs[a].TextBkColor,xs[a].UlineColor,xs[a].FieldId,xs[a].AuxId,xs[a].Aux1Id,xs[a].CharStyId,xs[a].ParaStyId,xs[a].expand,xs[a].TempStyle,xs[a].lang,xs[a].FieldCode,xs[a].offset,xs[a].CharSet,xs[a].flags,xs[a].TextAngle))>=0){return n}else return t}function Nx(){var t,e;if(i_>=0){e=i_;i_=-1;gb(e);Fb(e);return e}if(Pr&&!Eu&&!GR)Dx(false);for(t=0;t<Ys;t++){if(Dj(xs[t].InUse)){Fb(t);return t}}if(Ys>=f_){var r=f_+f_/3+1;Mx(r)}e=Ys;Ys++;Fb(e);return e}function Dx(t){var e=[f_+1];var r;var i,f,l,a,n;var c=[f_+1];var s=false;var _;var o;if(!t){i=0;for(f=0;f<Ys;f++)if(xs[f].InUse&&Dj(xs[f].style&tc.PICT))i++;if(i<=tc.MAX_FONT_HANDLES)return false}c[0]=0;for(f=1;f<f_;f++){c[f]=f;if(Nj(xs[f].style&tc.PICT))continue;for(l=0;l<=f;l++){if(Tk(xs[l].TypeFace,xs[f].TypeFace)==0&&xs[l].TwipsSize==xs[f].TwipsSize&&Dj(xs[l].style&tc.PICT)&&xs[l].style==xs[f].style&&xs[l].TempStyle==xs[f].TempStyle&&xs[l].TextColor==xs[f].TextColor&&xs[l].TextBkColor==xs[f].TextBkColor&&xs[l].AuxId==xs[f].AuxId&&xs[l].Aux1Id==xs[f].Aux1Id&&xs[l].flags==xs[f].flags&&xs[l].CharSet==xs[f].CharSet&&xs[l].CharStyId==xs[f].CharStyId&&xs[l].ParaStyId==xs[f].ParaStyId&&xs[l].expand==xs[f].expand&&xs[l].InsRev==xs[f].InsRev&&xs[l].DelRev==xs[f].DelRev&&xs[l].FmtRev==xs[f].FmtRev&&xs[l].InsTime==xs[f].InsTime&&xs[l].DelTime==xs[f].DelTime&&xs[l].FmtTime==xs[f].FmtTime&&xs[l].FmtOrigFont==xs[f].FmtOrigFont&&xs[l].lang==xs[f].lang&&xs[l].UlineColor==xs[f].UlineColor&&xs[l].HilightColor==xs[f].HilightColor&&xs[l].offset==xs[f].offset&&xs[l].FieldCode==xs[f].FieldCode&&xs[l].TextAngle==xs[f].TextAngle&&xs[l].ScaleX==xs[f].ScaleX&&xs[l].rtl==xs[f].rtl&&xs[l].rtlch==xs[f].rtlch&&xs[l].flow==xs[f].flow&&xs[l].FieldId==xs[f].FieldId){c[f]=l;break}}}for(f=0;f<f_;f++)e[f]=false;for(f=0;f<Ys;f++){if(!xs[f].InUse)continue;if(Dj(xs[f].style&tc.PICT)&&Nj(xs[f].flags&tc.FFLAG_USER)){e[f]=true;c[f]=f}else if(Nj(xs[f].style&tc.PICT)&&xs[f].PictType==tc.PICT_FORM){var u=xs[f].form;a=u.FontId;if(a>=0&&a<Ys&&xs[a].InUse){e[a]=true;c[a]=a}}else if(Nj(xs[f].style&tc.PICT)&&xs[f].ObjectType==tc.OBJ_OCX_EXT){e[f]=true;c[f]=f}else if(xs[f].FmtOrigFont>0){var T=xs[f].FmtOrigFont;if(T>=0&&T<Ys){e[T]=true;c[T]=T}}}for(f=1;f<Vc;f++){if(!Kc[f].InUse)continue;for(l=0;l<Kc[f].LevelCount;l++){o=Kc[f].level[l].FontId;e[o]=true;c[o]=o}}for(f=1;f<zc;f++){if(!Jc[f].InUse)continue;for(l=0;l<Jc[f].LevelCount;l++){o=Jc[f].level[l].FontId;e[o]=true;c[o]=o}}for(f=0;f<kc;f++){o=Uc[f].FontId;e[o]=true;c[o]=o}if(Oc>=0&&Oc<Ys&&xs[Oc].InUse){e[Oc]=true;c[Oc]=Oc}for(_=0;_<Ri;_++){if(ui[_].fmt==null){a=ui[_].UniFmt;n=c[a];ui[_].UniFmt=n;e[n]=true}else{r=ui[_].fmt;for(l=0;l<ui[_].len;l++){a=r[l];n=c[a];r[l]=n;e[n]=true}}}s=false;for(f=1;f<f_;f++){if(xs[f].InUse&&Nj(xs[f].style&tc.PICT))continue;if(xs[f].InUse&&c[f]!=f){gb(f);s=true}if(xs[f].InUse&&!e[f]){gb(f);s=true}}if(s)_i.TerShrinkFontTable();return s}function Mx(t){var e,r=f_;f_=t;for(e=r;e<t;e++){xs[e]=new tc.ClsFont;Xs[e]=new tc.ClsPrtFont;xs[e].CharWidth=Xs[e].CharWidth=null;xs[e].MetCharWidth=Xs[e].MetCharWidth=null;xs[e].InUse=false}return true}_i.TerShrinkFontTable=function(){var t;if(!lv||!QD())_i.TerCreateControl();if(false&&Nj(GlbFont)){for(t=0;t<TotalGlbFonts;t++){if(GlbFont[t].UseCount==0){GlbFont[t].font=null}}}return true};function Gx(t,e,r){var i;if(r>=256){return gJ(Ti,t,wY(r))}if(!dS&&Nj(xs[t].style&tc.PICT)&&xs[t].FrameType!=tc.PFRAME_NONE){var f=xs[t].ParaFID;var l=f>0&&f<Kl&&Nj(kl[f].flags2&tc.PF2_INLINE);if(!l)return 0}if(e||Go!=null)i=xs[t].CharWidth;else i=Xs[t].CharWidth;return i[r]}_i.TerLocateFontId=function(t,e,r){var i;var f;var l;if(!lv||!QD())_i.TerCreateControl();PC=i=e;SC=f=r;if(i<0||i>=Ri){i=br;f=jt}if(f>=ui[i].len)f=ui[i].len-1;t:{for(;i<Ri;i++,f=0){if(ui[i].len==0)continue;if(ui[i].fmt==null){if(ui[i].UniFmt==t)break t}else{l=ui[i].fmt;for(;f<ui[i].len;f++)if(l[f]==t)break t}}return false}PC=i;SC=f;return true};_i.TerSetTag=function(t,e,r,i,f,l){if(!lv||!QD())_i.TerCreateControl();return Bx(t,e,tc.TERTAG_USER,r,i,f)};_i.TerSetTag=function(t,e,r,i,f,l,a){var n;if(!lv||!QD())_i.TerCreateControl();n=Bx(t,e,tc.TERTAG_USER,r,i,f);if(n>0)ac[n].obj=l;return n};function Bx(t,e,r,i,f,l){var a=0,n;var c;var s=uE;if(t<0){t=br;e=jt}if(t<0||t>=Ri)return 0;if(e<0||e>=ui[t].len)return 0;if(-1==(a=Jx()))return 0;c=ub(t);if(Nj(c[e])){n=c[e];while(true){if(ac[n].type==r&&nV(ac[n].name,i)){a=n;kx(a);break}if(ac[n].next==0){ac[n].next=a;break}n=ac[n].next}}else c[e]=a;Tb(t);ac[a].InUse=true;ac[a].type=r;ac[a].name=i;ac[a].AuxText=f;ac[a].AuxInt=l;if(!TE&&(r==tc.TERTAG_BKM||r==tc.TERTAG_USER)){SE=ac[a].type;vE=ac[a].AuxInt;hE=ac[a].name;OE=ac[a].AuxText;uE=s;V8(t,e,t,e,tc.UNDO_TAG_INSERT)}oi.modified++;return a}_i.TerPosTag=function(t,e,r,i){return _i.TerPosTagEx(tc.TERTAG_USER,t,e,r,i)};_i.TerPosTagEx=function(t,e,r,i,f){if(!lv||!QD())_i.TerCreateControl();return Hx(e,r,t,i,f)};function Hx(t,e,r,i,f){var l;var a,n;var c=false,s;var _=0,o,u,T;if(i==tc.SCOPE_ANY){if(yx(t,e,r,f))return true;else i=tc.SCOPE_BEGIN}if(Nj(e)&&e.length>0)c=true;if(i==tc.SCOPE_BEGIN){n=0;T=0;i=tc.SCOPE_FORWARD}else{n=br;T=jt}s=i==tc.SCOPE_FORWARD;if(s){for(a=n;a<Ri;a++){if(Dj(ui[a].tag))continue;l=ui[a].tag;o=ui[a].len;for(_=a==n?T:0;_<o;_++){u=l[_];while(true){if(Dj(u))break;if(c){if((r==-1||ac[u].type==r)&&Nj(ac[u].name)&&nV(ac[u].name,e))break}else if(u==t)break;u=ac[u].next}if(Nj(u))break}if(_<o)break}if(a==Ri)return false}else{for(a=n;a>=0;a--){if(Dj(ui[a].tag))continue;l=ui[a].tag;o=ui[a].len;for(_=a==n?T:o-1;_>=0;_--){u=l[_];while(true){if(Dj(u))break;if(c){if((r==-1||ac[u].type==r)&&Nj(ac[u].name)&&nV(ac[u].name,e))break}else if(u==t)break;u=ac[u].next}if(Nj(u))break}if(_>=0)break}if(a<0)return false}jt=_;if(f)Iq(a+1);else br=a;return true}_i.TerGetTagPos=function(t,e,r){if(!bx(t,e,r))return-1;t=lI;return Lq(ac[t].line,ac[t].col)};_i.TerGetTagPos2=function(t,e,r){var i;PC=SC=0;i=bx(t,e,r);t=lI;if(i){PC=ac[t].line;SC=ac[t].col}return i};function mx(t,e,r){var i;var f,l;var a=false;var n=0,c,s,_;PC=SC=0;if(Nj(e)&&e.length>0)a=true;l=0;_=0;for(f=l;f<Ri;f++){if(Dj(ui[f].tag))continue;i=ui[f].tag;c=ui[f].len;for(n=f==l?_:0;n<c;n++){s=i[n];while(true){if(Dj(s))break;if(a){if((r==-1||ac[s].type==r)&&Nj(ac[s].name)&&ac[s].name==e)break}else if(s==t)break;s=ac[s].next}if(Nj(s))break}if(n<c)break}if(f==Ri)return false;PC=f;SC=n;return true}function wx(t,e,r,i){var f;var l;var a=false;var n,c;for(l=t;l<=r;l++){if(Dj(ui[l].tag))continue;f=ui[l].tag;c=ui[l].len;for(n=l==t?e:0;n<c;n++){if(l==r&&n>i)break;if(f[n]!=0){a=true;break}}if(a)break}return a}function bx(t,e,r){var i;var f;var l,a,n,c=0;lI=t;if(e!=null&&e.length>0){for(l=1;l<Ac;l++){if((r==-1||ac[l].type==r)&&ac[l].name!=null&&Tk(ac[l].name,e)==0){c=l;break}}t=c}else c=t;lI=t;if(c<=0||c>=Ac)return false;f=ac[c].line;n=ac[c].col;t:{if(f<0||f>=Ri)break t;if(n<0||n>=ui[f].len)break t;if(Dj(ui[f].tag))break t;i=ui[f].tag;a=i[n];if(a==0)break t;while(a!=0){if(a==c)return true;a=ac[a].next}}if(mx(c,"",-1)){ac[c].line=PC;ac[c].col=SC;return true}else return false}function xx(t){var e;var r,i,f;if(Dj(ui[t].tag))return true;e=ui[t].tag;i=ui[t].len;for(r=0;r<i;r++){f=e[r];while(f>0){ac[f].line=t;ac[f].col=r;if(ac[f].next>0&&ac[ac[f].next].next==f){ac[f].next=0;return false}f=ac[f].next}}return true}function yx(t,e,r,i){var f,l;var a,n;if(t==-1&&Nj(e)&&e.length>0){for(a=0;a<Ac;a++)if(ac[a].type==r&&Nj(ac[a].name)&&ac[a].name==e)break;if(a==Ac)return false;t=a}if(t<0||t>=Ac)return false;f=ac[t].line;if(f<0||f>=Ri)return false;t:{l=f;if((n=Wx(t,l))>=0)break t;l=f-1;if((n=Wx(t,l))>=0)break t;l=f+1;if((n=Wx(t,l))>=0)break t;l=f-2;if((n=Wx(t,l))>=0)break t;l=f+2;if((n=Wx(t,l))>=0)break t;return false}jt=n;if(i)Iq(l+1);else br=l;return true}function Wx(t,e){var r;var i,f,l;if(e<0||e>=Ri)return-1;if(Dj(ui[e].tag))return-1;r=ui[e].tag;f=ui[e].len;for(i=0;i<f;i++){l=r[i];while(true){if(l<=0)break;if(l==t)return i;l=ac[l].next}}return-1}_i.TerDeleteTag=function(t,e,r,i){if(!lv||!QD())_i.TerCreateControl();return Ux(t,e,r,i)};function Ux(t,e,r,i){var f,l=0,a;var n;var c=uE;if(t<0){t=br;e=jt}if(t<0||t>=Ri)return 0;if(e<0||e>=ui[t].len)return 0;n=ub(t);f=n[e];t:{if(f>=Ac){f=0;break t}if(f==0)break t;l=0;while(true){if((r==-1||ac[f].type==r)&&(Dj(i)||ac[f].name==i))break;l=f;f=ac[f].next;if(f==0)break t}if(!TE&&(r==tc.TERTAG_BKM||r==tc.TERTAG_USER)){SE=ac[f].type;vE=ac[f].AuxInt;hE=ac[f].name;OE=ac[f].AuxText;uE=c;V8(t,e,t,e,tc.UNDO_TAG_DELETE)}kx(f);a=ac[f].next;if(Nj(l))ac[l].next=a;else n[e]=a}Tb(t);oi.modified++;return f}function kx(t){if(t<0||t>=Ac||!ac[t].InUse)return true;ac[t].name=ac[t].AuxText=ac[t].HtmlInfo=null;ac[t].type=0;ac[t].InUse=false;if(Rc==0||t<Rc)Rc=t;return true}function Xx(t){if(t<0||t>=Vn||!Yn[t].InUse)return true;Yn[t].text=null;Yn[t].type=0;Yn[t].flags=0;Yn[t].page=0;Yn[t].InUse=false;if(Jn==0||t<Jn)Jn=t;return true}function Kx(t){var e;var r;if(Da>=Ri)Da=Ri-1;if(Da<0)Da=0;if(Ma>=ui[Da].len)Ma=ui[Da].len-1;if(Ma<0)Ma=0;e=ib(Da,Ma);if(xs[e].FieldId!=tc.FIELD_HLINK||xs[e].FieldCode==null)return false;if((r=IQ(xs[e].FieldCode,"\\l"))==null)return false;return Hx(0,r,tc.TERTAG_BKM,tc.SCOPE_ANY,t)}function Yx(t){var e;var r;var i,f;if(Da>=Ri)Da=Ri-1;if(Da<0)Da=0;if(Ma>=ui[Da].len)Ma=ui[Da].len-1;if(Ma<0)Ma=0;e=ib(Da,Ma);if(xs[e].FieldId!=tc.FIELD_PAGE_REF&&xs[e].FieldId!=tc.FIELD_REF||xs[e].FieldCode==null)return false;f=xs[e].FieldCode.length;var l=Uk(xs[e].FieldCode);for(i=0;i<f;i++)if(l[i]==tc.CHAR_SPACE)break;r=cV(xs[e].FieldCode,0,i);return Hx(0,r,tc.TERTAG_BKM,tc.SCOPE_ANY,t)}_i.TerGetNextTagId=function(t){if(!lv||!QD())_i.TerCreateControl();if(t<1||t>=Ac)return 0;return ac[t].next};_i.TerGetTag=function(t,e){return _i.TerGetTagEx(t,e,tc.TERTAG_USER)};_i.TerGetTagEx=function(t,e,r){if(!lv||!QD())_i.TerCreateControl();return Vx(t,e,r)};function Vx(t,e,r){var i;var f;LP="";EP="";WC=0;bP=null;if(t<0){t=br;e=jt}if(e>=0){if(t<0||t>=Ri)return 0;if(e>=ui[t].len)return 0;if(ui[t].tag==null)return 0;f=ub(t);i=f[e];Tb(t)}else i=t;if(i==0)return i;while(true){if(ac[i].type==r)break;i=ac[i].next;if(i==0)return 0}if(Nj(ac[i].name))LP=ac[i].name;if(Nj(ac[i].AuxText))EP=ac[i].AuxText;WC=ac[i].AuxInt;bP=ac[i].obj;return i}_i.TerAppendTag=function(t,e,r,i){var f=0,l;var a;var n;if(!MY(Ri+1))return false;l=Ri;Ri++;Ip(l);Tm(l,0,1);n=ui[l].txt;n[0]=tc.HIDDEN_CHAR;if(-1==(f=Jx()))return false;a=ub(l);a[0]=f;Tb(l);ac[f].InUse=true;ac[f].type=t;ac[f].name=e;ac[f].AuxText=r;ac[f].AuxInt=i;oi.modified++;return true};function jx(t,e){var r;var i;var f,l;var a,n;if(null==(a=ui[t].tag))return true;f=a[e];if(f==0)return true;r=t;i=e+1;if(i>=ui[r].len){r++;i=0;if(r>=Ri)return true}n=ub(r);l=n[i];if(l==0)n[i]=f;else{while(ac[l].next>0)l=ac[l].next;ac[l].next=f}a[e]=0;Tb(r);return true}function Jx(){var t;var e,r;e=Rc;if(e==0)e=Ac;for(t=e;t<Ac;t++){if(!ac[t].InUse){ac[t]=new tc.ClsCharTag;Rc=t+1;return t}}Rc=0;if(Ac>=Ec){r=Ec+Ec/2;ac=fV(ac,r);Ec=r}ac[Ac]=new tc.ClsCharTag;Ac++;return Ac-1}function zx(){var t;var e,r;e=Jn;if(e==0)e=Vn;for(t=e;t<Vn;t++){if(!Yn[t].InUse){Yn[t]=(new tc.ClsStory).init();Jn=t+1;return t}}Jn=0;if(Vn>=jn){r=jn+jn/2;Yn=fV(Yn,r);jn=r}Yn[Vn]=(new tc.ClsStory).init();Vn++;return Vn-1}function Zx(t,e){var r=false;var i,f,l=0,a,n;var c="",s="";if(e==null)e="";a=e.length;var _=Uk(e);for(i=f=0;i<=a;i++){if(i==a||_[i]==gk(",")){s=cV(e,l,f);if(s.length>0){n=LX(s);if(n>0){if(!r&&n>t){if(c.length>0)c+=",";c+=t.toString();r=true}if(c.length>0)c+=",";c+=mY(n)}}if(i==a){if(!r){if(c.length>0)c+=",";c+=mY(t)}break}else f=0}else{if(f==0)l=i;f++}}return c}function Qx(t,e){var r,i,f=0,l,a;var n="",c="";if(e==null)e="";l=e.length;var s=Uk(e);for(r=i=0;r<=l;r++){if(r==l||s[r]==gk(",")){c=cV(e,f,i);if(c.length>0){a=LX(c);if(a!=t){if(n.length>0)n+=",";n+=mY(a)}}if(r==l)break;else i=0}else{if(i==0)f=r;i++}}return n}function qx(t){var e;for(e=1;e<Vn;e++){if(Yn[e].InUse&&Yn[e].type==tc.STORY_COMMENT){var r=Yn[e].flags;Yn[e].flags=cj(Yn[e].flags,tc.FSTORY_VERT);$x(t,e,false);$x(t,e,true);Yn[e].flags|=tc.FSTORY_VERT;$x(t,e,true);$x(t,e,false);Yn[e].flags|=r}}return true}function $x(t,e,r){var i,f,l;var a=new tc.ClsFont;i=Yn[e].StyId;f=W_[i].CharMask;l=W_[i].StyleMask;a=xs[0].ShallowCopy();if(Nj(f&tc.CMASK_FONT)&&W_[i].TypeFace.length>0)a.TypeFace=W_[i].TypeFace;if(Nj(f&tc.CMASK_SIZE)&&W_[i].TwipsSize>0)a.TwipsSize=W_[i].TwipsSize;if(Nj(Yn[e].flags&tc.FSTORY_VERT))a.TwipsSize=10*20;else a.TwipsSize=8*20;if(Nj(f&tc.CMASK_TEXT_COLOR))a.TextColor=W_[i].TextColor;if(Nj(l))a.style=l;if(r)a.style|=tc.BOLD;a.TextAngle=0;if(Nj(Yn[e].flags&tc.FSTORY_VERT))a.TextAngle=270;var n=Lb(t,0,a);if(Yn[e].AuthorInit!=null&&Yn[e].text!=null){var c=Yn[e].AuthorInit+Yn[e].text;var s=hy(xs[n].font,c);if(!s.equals(xs[n].font)){a=xs[n].ShallowCopy();a.TypeFace=s.getFamily();n=Lb(t,n,a)}}return n}function ty(t,e,r){var i,f,l;var a="";if(t==null||t.length==0)return false;f=t.length;var n=Uk(t);for(i=0;i<=f;i++){if(i==f||n[i]==gk(",")){if(a.length>0){l=LX(a);if(l>0&&l<Vn){Yn[l].line=e;Yn[l].col=r;Yn[l].flags=cj(Yn[l].flags,tc.FSTORY_TEXT_POS_SET)}}if(i==f)break;else{a=""}}else{a+=cV(t,i,1)}}return true}_i.TerSetCommentMinRightMarg=function(t){var e=0;if(Nj(iO&tc.TFLAG9_NO_COMMENTS)&&!Ci)return-1;e=fc;fc=t;return e};_i.TerEditComment=function(t,i,e,r,f,l){var a="";var n="";var c;var s;if(!lv||!QD())_i.TerCreateControl();if(Nj(iO&tc.TFLAG9_NO_COMMENTS)&&!Ci)return false;if(i<=0){var _=Ga-rt.left+Ft;var o=Ba-rt.top+Gt;for(i=1;i<Vn;i++){if(!Yn[i].InUse&&Dj(Yn[i].flags&tc.FSTORY_DRAWN))continue;if(Yn[i].type!=tc.STORY_COMMENT)continue;if(_<Yn[i].x||_>Yn[i].x+Yn[i].width)continue;if(o<Yn[i].y||o>Yn[i].y+Yn[i].height)continue;break}if(i==Vn)return false}if(i<1||i>=Vn)return false;if(!Yn[i].InUse||Yn[i].type!=tc.STORY_COMMENT)return false;if(!t){if(e!=null&&e.length>0)a=e;if(r!=null&&r.length>0)n=r;return ey(i,a,n,f,l)}var u=_i.DlgCompHeight;var T=_i.DlgFont;var A=new $t.DialogBox(te,"Edit Comment",T,true,P);var E=A.cvs;var R=new $t.Label(E,0,0,T,"Comment Text");A.addComp(R,0,0,1,1,"left","bottom");var L=new $t.Label(E,0,0,T,"(Delete all text to delete comment)");A.addComp(L,0,2,1,3,"left","bottom");var C=new $t.TextBox(E,0,0,JV(500),u,Yn[i].text,T,_i.caret,false,true,null);A.addComp(C,1,0,1,5,"left","middle");var I=new $t.Label(E,0,0,T,"Your Name");A.addComp(I,3,0,1,1,"left","middle");var d=new $t.TextBox(E,0,0,JV(250),u,Yn[i].author,T,_i.caret,false,true,null);A.addComp(d,3,1,1,3,"left","middle");var F=new $t.Label(E,0,0,T,"Your Initials");A.addComp(F,4,0,1,1,"left","middle");var g=new $t.TextBox(E,0,0,JV(60),u,Yn[i].AuthorInit,T,_i.caret,false,true,null);A.addComp(g,4,1,1,1,"left","middle");A.show();C.setFocus();function P(t,e,r){if(t=="Cancel"){A.hide();return}else if(t=="OK"){a=d.getText();if(a.length==0){d.setFocus();return}n=g.getText();if(n.length==0){g.setFocus();return}f=C.getText();Gp(tg.UserNameStorageFile,a);A.hide();return ey(i,a,n,f,l)}else return}};function ey(t,e,r,i,f){var l;if(i==null||i.length==0){for(l=0;l<Ys;l++){if(xs[l].StoryIds!=null){var a="";a=Qx(t,xs[l].StoryIds);xs[l].StoryIds=null;if(a.length>0)xs[l].StoryIds=a}}Xx(t)}else{Yn[t].author=e;Yn[t].AuthorInit=r;Yn[t].text=i;Yn[t].StoryLines=[]}if(f)cG();return true}_i.TerApplyComment=function(t,e,r,f,l){var a="";var n="";if(!lv||!QD())_i.TerCreateControl();if(!oi.WordWrap||uA==tc.HILIGHT_OFF)return-1;if(k_>=0)return-1;a=Mp(tg.UserNameStorageFile);if(a==null)a="";len=a.length;n="";var c=Uk(a);for(i=0;i<len;i++){if(i==0||c[i-1]==tc.CHAR_SPACE&&c[i]!=tc.CHAR_SPACE)n+=cV(a,i,1)}if(!t){if(e!=null&&e.length>0)a=e;if(r!=null&&r.length>0)n=r;return ry(a,n,f,l)}var s=_i.DlgCompHeight;var _=_i.DlgFont;var o=new $t.DialogBox(te,"Apply Comment",_,true,I);var u=o.cvs;var T=new $t.Label(u,0,0,_,"Comment Text");o.addComp(T,0,0,1,1,"left","bottom");var A=new $t.TextBox(u,0,0,JV(500),s,"",_,_i.caret,false,true,null);o.addComp(A,1,0,1,5,"left","middle");var E=new $t.Label(u,0,0,_,"Your Name");o.addComp(E,3,0,1,1,"left","middle");var R=new $t.TextBox(u,0,0,250,s,a,_,_i.caret,false,true,null);o.addComp(R,3,1,1,3,"left","middle");var L=new $t.Label(u,0,0,_,"Your Initials");o.addComp(L,4,0,1,1,"left","middle");var C=new $t.TextBox(u,0,0,JV(60),s,n,_,_i.caret,false,true,null);o.addComp(C,4,1,1,1,"left","middle");o.show();A.setFocus();function I(t,e,r){if(t=="Cancel"){o.hide();return}else if(t=="OK"){a=R.getText();if(a.length==0){R.setFocus();return}n=C.getText();if(n.length==0){C.setFocus();return}f=A.getText();if(f.length==0){A.setFocus();return}Gp(tg.UserNameStorageFile,a);o.hide();return ry(a,n,f,l)}else return}};function ry(t,e,r,i){var f;var l,a,n,c=0;var s=false;if(r==null||r.length==0)return-1;if(!ON())return-1;if(_A==Ri-1&&AA>=ui[_A].len){AA--;if(AA<0)AA=0}a=zx();Yn[a]=new tc.ClsStory;Yn[a].InUse=true;Yn[a].type=tc.STORY_COMMENT;Yn[a].author=t;Yn[a].AuthorInit=e;Yn[a].text=r;Yn[a].line=_A;Yn[a].col=AA;Yn[a].time=new tc.ClsDate;Yn[a].time.dt=new Date;c=0;for(l=1;l<Vn;l++){if(!Yn[l].InUse||Yn[l].type!=tc.STORY_COMMENT||l==a)continue;if(Yn[l].RtfId>c)c=Yn[l].RtfId}Yn[a].RtfId=c+1;s=qb(tc.CMASK_STORY,a,1,null,i);if(i)cG();if(s)return a;else return-1}function iy(t,e,r,i,f,l){var a;var n;var c;var s="",_="";var o=new tc.ClsFont;n=e;c=r==1;o=xs[t].ShallowCopy();if(xs[t].StoryIds!=null)s=xs[t].StoryIds;if(c)_=Zx(n,s);else _=Qx(n,s);if(nV(s,_))return t;o.StoryIds=_;if((a=Lb(Ti,t,o))>=0){return a}else return t}function fy(t,e){var r;var i=new tc.ClsFont;i=xs[t].ShallowCopy();i.StoryIds=e;if((r=Lb(Ti,t,i))>=0){return r}else return t}function ly(t){var e,r,i=0,f,l;var a="";var n=xs[t].StoryIds;if(n==null||n.length==0)return false;f=n.length;var c=Uk(n);for(e=r=0;e<=f;e++){if(e==f||c[e]==gk(",")){a=cV(n,i,r);if(a.length>0){l=LX(a);if(l>0&&l<Vn&&Yn[l].InUse&&Yn[l].type==tc.STORY_COMMENT)return true}if(e==f)break;else r=0}else{if(r==0)i=e;r++}}return false}function ay(t,e,r){var i,f,l=0,a,n;var c="";var s=0;if(t==null||t.length==0)return 0;a=t.length;var _=Uk(t);for(i=f=0;i<=a;i++){if(i==a||_[i]==gk(",")){c=cV(t,l,f);if(c.length>0){n=LX(c);e[s]=n;s++;if(s>=r)return s}if(i==a)break;else f=0}else{if(f==0)l=i;f++}}return s}_i.TerGetStoryParam=function(t,e){var r="";if(!lv||!QD())TerCreateControl();if(t<=0||t>=Vn||!Yn[t].InUse)return"";if(e==tc.STP_AUTHOR)r=Yn[t].author;else if(e==tc.STP_AUTH_INIT)r=Yn[t].AuthorInit;else if(e==tc.STP_TEXT)r=Yn[t].text;else if(e==tc.STP_DATE){if(Yn[t].time!=null&&Yn[t].time.dt!=null){r=BX("","yyyyMMdd HH:mm",0,Yn[t].time.dt)}}else if(e==tc.STP_RTF_ID)r=Yn[t].RtfId.toString(16);else return"";return r};_i.TerIsSameStoryFont=function(t,e){var r,i;var f=500;var l=[];if(!lv||!QD())TerCreateControl();if(t<0||t>=Ys&&!xs[t].InUse)return false;if(e<0||e>=Ys&&!xs[e].InUse)return false;if(t==e)return true;r=xs[t].StoryIds;if(r==null)r="";i=xs[e].StoryIds;if(i==null)i="";if(r.length==0&&i.length==0)return true;if(_i.TerGetAddlStories(t,e,l,f)>0)return false;if(_i.TerGetAddlStories(e,t,l,f)>0)return false;return true};_i.TerGetAddlStories=function(t,e,r,i){var f=500;var l=[];var a=[];var n=0,c=0,s=0,_,o;if(!lv||!QD())TerCreateControl();if(t<0||t>=Ys&&!xs[t].InUse)return-1;if(e<0||e>=Ys&&!xs[e].InUse)return-1;if(t==e)return 0;n=ay(xs[t].StoryIds,l,f);c=ay(xs[e].StoryIds,a,f);for(_=0;_<n;_++){for(o=0;o<c;o++)if(l[_]==a[o])break;if(o==c){r[s]=l[_];s++}if(s>=i)break}return s};function ny(t,e,r,i,f,l,a){var n;var c="",s;var _;var o=[100];var u=0;var T=false;var A=0;var E=nO;nO|=tc.TOFLAG2_NO_COMPRESS_CFMT;t:{_=ib(e,r);if(xs[_].StoryIds==null||xs[_].StoryIds.length==0)break t;if(t){if(!(e==0&&r==0)){A=fb(e,r);if(A==_)break t;if(xs[A].StoryIds!=null){c=",";c+=xs[A].StoryIds;c+=","}}}else{var R=ui[Ri-1].len-1;if(!(e==Ri-1&&r==R)){A=lb(e,r);if(A==_)break t;if(xs[A].StoryIds!=null){c=",";c+=xs[A].StoryIds;c+=","}}}u=ay(xs[_].StoryIds,o,100);if(u==0)break t;if(a){for(n=0;n<Vn;n++)if(Yn[n].type==tc.STORY_COMMENT)Yn[n].flags=cj(Yn[n].flags,tc.FSTORY_BEGINS|tc.FSTORY_ENDS)}for(n=0;n<u;n++){var L=o[n];s=","+mY(o[n])+",";if(c.indexOf(s)<0){if(a){Yn[L].flags|=t?tc.FSTORY_BEGINS:tc.FSTORY_ENDS;if(i&&!t){Yn[L].x1=f;Yn[L].y1=l}}if(!t&&i){Yn[L].x1=f;Yn[L].y1=l;Yn[L].flags|=tc.FSTORY_TEXT_POS_SET;Yn[L].line=e;if(rc<0)rc=L;ec=ic=L}T=true}}}nO=E;return T}function cy(){var t;var e,r,i,f;var l;var a;l=[Ac+1];for(e=0;e<Ac;e++)l[e]=false;for(t=0;t<Ri;t++){if(Dj(ui[t].tag))continue;a=ui[t].tag;r=ui[t].len;for(i=0;i<r;i++){f=a[i];while(Nj(f)){l[f]=true;ac[f].line=t;ac[f].col=i;f=ac[f].next}}}for(e=1;e<Ac;e++){if(!l[e]&&ac[e].InUse)kx(e)}return true}function sy(t,e){var r,i;i=t.length;if(i==0)return false;var f=Uk(t);for(r=0;r<i;r++)if(f[r]==tc.CHAR_SPACE)return false;if(!e)return true;for(r=1;r<Ac;r++){if(ac[r].InUse&&ac[r].type==tc.TERTAG_BKM&&nV(ac[r].name,t))return true}return false}_i.TerGetBookmark=function(t){var e=0,r,i;if(!lv||!QD())_i.TerCreateControl();LP="";if(t<0)cy();for(r=1;r<Ac;r++)if(ac[r].InUse&&ac[r].type==tc.TERTAG_BKM)e++;if(e==0||t<0)return e;if(t>=e)return 0;i=-1;LP="";for(r=1;r<Ac;r++){if(!ac[r].InUse||ac[r].type!=tc.TERTAG_BKM)continue;i++;if(i==t){LP=ac[r].name;break}}return e};_i.TerGetTagName=function(t){if(!lv||!QD())_i.TerCreateControl();LP="";kC=-1;if(t<0){cy();return Ac}if(t<=0||t>=Ac)return-1;if(!ac[t].InUse)return-1;LP=ac[t].name;kC=ac[t].type;return Ac};function _y(){var l="";var t=_i.DlgCompHeight;var e=_i.DlgFont;var i=new $t.DialogBox(te,"Bookmark",e,true,E,2);var r=i.cvs;var a=new $t.TextBox(r,0,0,JV(400),t,"",e,_i.caret,false,true,L);i.addComp(a,1,0,1,2,"left","middle",0,0,JV(15));var n=new $t.ListBox(r,0,0,JV(400),JV(200),e,true,true,R);i.addComp(n,2,0,1,2,"Left","middle");FldInsert=new $t.Button(r,0,0,JV(175),t,e,"Insert",true,C);i.addComp(FldInsert,4,0,1,1,"left","middle");FldGoTo=new $t.Button(r,0,0,JV(175),t,e,"GoTo",true,I);i.addComp(FldGoTo,4,1,1,1,"right","middle");FldDelete=new $t.Button(r,0,0,JV(175),t,e,"Delete",true,d);i.addComp(FldDelete,5,0,1,1,"left","middle");FldPageRef=new $t.Button(r,0,0,JV(175),t,e,"Insert Page Reference",true,F);i.addComp(FldPageRef,5,1,1,1,"right","middle");var f="",c="",s;var _,o,u=-1;if(Vx(br,jt,tc.TERTAG_BKM)==0)f="";else f=LP;var T=[];var A=_i.TerGetBookmark(-1);for(_=0;_<A;_++){_i.TerGetBookmark(_);l=LP;T.push(l);if(l==f&&f.length>0){c=l;u=_}}n.setItems(T,null,u>=0?u:0);if(c.length>=0)a.setText(c);FldInsert.setEnabled(false);if(A==0){FldDelete.setEnabled(false);FldGoTo.setEnabled(false);FldPageRef.setEnabled(false)}i.hasOKIcon(false);i.show();a.setFocus();function E(t,e,r){if(t=="Cancel"){i.hide();return}else if(t=="OK"){}else return}function R(t,e,r){l=n.getSelectedItem();var i=sy(l,false);var f=sy(l,true);if(t=="dblclick"||t=="enter"){if(i){if(f)Ls=tc.IDC_GOTO;else Ls=tc.IDC_INSERT;g()}}}function L(t,e,r){l=a.getText();var i=sy(l,false);var f=sy(l,true);FldInsert.setEnabled(l.length>0&&i&&!f)}function C(t,e,r){l=a.getText();Ls=tc.IDC_INSERT;g()}function I(t,e,r){l=n.getSelectedItem();var i=sy(l,false);var f=sy(l,true);if(f){Ls=tc.IDC_GOTO;g()}}function d(t,e,r){l=n.getSelectedItem();var i=sy(l,false);var f=sy(l,true);if(f){Ls=tc.IDC_DELETE;g()}else vJ(0)}function F(t,e,r){l=n.getSelectedItem();Ls=tc.IDC_PAGE_REF;g()}function g(){i.hide();if(Ls==tc.IDC_INSERT)_i.TerInsertBookmark(-1,0,l);else if(Ls==tc.IDC_DELETE)_i.TerDeleteBookmark(l);else if(Ls==tc.IDC_GOTO)_i.TerPosBookmark(l,true);else if(Ls==tc.IDC_PAGE_REF)_i.TerInsertPageRef(l,true,false,true)}return true}_i.TerInsertBookmark=function(t,e,r){if(!lv||!QD())_i.TerCreateControl();if(!sy(r,false))return 0;_i.TerDeleteBookmark(r);return Bx(t,e,tc.TERTAG_BKM,r,null,0)};_i.TerPosBookmark=function(t,e){var r,i;var f;if(!lv||!QD())_i.TerCreateControl();r=br;f=jt;if(!Hx(-1,t,tc.TERTAG_BKM,tc.SCOPE_ANY,false))return false;if(e){i=br;br=r;Iq(i+1)}return true};_i.TerDeleteBookmark=function(t){var e;var r;var i=false;if(!lv||!QD())_i.TerCreateControl();e=br;r=jt;while(Hx(-1,t,tc.TERTAG_BKM,tc.SCOPE_BEGIN,false)){i=Nj(Ux(br,jt,tc.TERTAG_BKM,t))}br=e;jt=r;return i};function oy(){var t;var e,r,i;var f,l;var a,n;var c=-1;var s=100;var _=[s+1];var o;for(t=0;t<Ri;t++){e=ui[t].len;f=ui[t].txt;a=nb(t);for(r=0;r<e;r++){var u=0;var T=tc.FFLAG_FORCE_RTLCH|tc.FFLAG_FORCE_LTRCH;i=a[r];o=f[r];if(o==tc.OVR_RTLCH_CHAR||o==tc.OVR_LTRCH_CHAR){if(c+1<s){c++;_[c]=o==tc.OVR_RTLCH_CHAR}}else if(o==tc.LRE_CHAR||o==tc.RLE_CHAR){if(c+1<s){c++;_[c]=o==tc.RLE_CHAR}}else if(o==tc.OVR_POP_CHAR){if(c>=0)c--}if(c>=0){if(_[c])u|=tc.FFLAG_FORCE_RTLCH;else u|=tc.FFLAG_FORCE_LTRCH}if(u==0){if(Nj(xs[i].flags&T))a[r]=uy(i,T,false)}else if(u==tc.FFLAG_FORCE_RTLCH){if(Nj(xs[i].flags&tc.FFLAG_FORCE_LTRCH))a[r]=uy(i,tc.FFLAG_FORCE_LTRCH,false);if(Dj(xs[a[r]].flags&tc.FFLAG_FORCE_RTLCH))a[r]=uy(a[r],tc.FFLAG_FORCE_RTLCH,true)}else if(u==tc.FFLAG_FORCE_LTRCH){if(Nj(xs[i].flags&tc.FFLAG_FORCE_RTLCH))a[r]=uy(i,tc.FFLAG_FORCE_RTLCH,false);if(Dj(xs[a[r]].flags&tc.FFLAG_FORCE_LTRCH))a[r]=uy(a[r],tc.FFLAG_FORCE_LTRCH,true)}if(o==tc.LRM_CHAR||o==tc.RLM_CHAR){var A=t;var E=r-1;var R;var L;u=0;if(E<0&&A>0){A--;if(Nj(ui[A].flags&(tc.LFLAG_PARA|tc.LFLAG_BREAK)))continue;E=ui[A].len-1}if(E>0){if(t==A){l=f;n=a}else{l=ui[A].txt;n=nb(A)}R=n[E];if(o==tc.LRM_CHAR)u|=tc.FFLAG_FORCE_LTRCH;else u|=tc.FFLAG_FORCE_RTLCH;L=l[E];if(wq(L,R)){if(u==tc.FFLAG_FORCE_RTLCH){if(Nj(xs[R].flags&tc.FFLAG_FORCE_LTRCH))R=uy(R,tc.FFLAG_FORCE_LTRCH,false);if(Dj(xs[R].flags&tc.FFLAG_FORCE_RTLCH))R=uy(R,tc.FFLAG_FORCE_RTLCH,true)}else if(u==tc.FFLAG_FORCE_LTRCH){if(Nj(xs[R].flags&tc.FFLAG_FORCE_RTLCH))R=uy(R,tc.FFLAG_FORCE_RTLCH,false);if(Dj(xs[R].flags&tc.FFLAG_FORCE_LTRCH))R=uy(R,tc.FFLAG_FORCE_LTRCH,true)}n[E]=R}if(A!=t)sb(A)}}}sb(t)}return true}_i.TerSetWaveUnderline=function(t,e,r,i,f){return _i.TerSetWaveUnderline2(tc.CLR_AUTO,t,e,r,i,f)};_i.TerSetWaveUnderline2=function(t,e,r,i,f,l){return _i.TerSetWaveUnderline2(yK(t),e,r,i,f,l)};_i.TerSetWaveUnderline2=function(t,e,r,i,f,l){var a,n,c,s,_=0;var o;if(!lv||!QD())_i.TerCreateControl();c=ui[e].len;if(i>c-1)i=c-1;if(c<0)return true;o=nb(e);n=-1;for(s=r;s<=i;s++){a=o[s];if(a!=n){_=uy(a,tc.FFLAG_AUTO_SPELL,f);if(!MJ(xs[_].WlineColor,t))_=Ub(_,t);n=a}o[s]=_}aO|=tc.TOFLAG_EXT_SPELLER;if(l)cG();return true};function uy(t,e,r){var i;var f;if(Nj(xs[t].style&tc.PICT))return t;i=xs[t].flags;if(r)i|=e;else i=cj(i,e);f=xs[t].ShallowCopy();f.flags=i;return Lb(Ti,t,f)}_i.TerSetTextCase=function(t,e){var r,i=0;var f;var l;if(!lv||!QD())_i.TerCreateControl();if(uA==tc.HILIGHT_OFF)return false;if(!ON())return false;if(!pN())return false;if(uA==tc.HILIGHT_LINE){TA=0;AA=ui[_A].len;if(AA<0)AA=0}l=ui[sA].cid==0&&ui[_A].cid==0||ui[sA].cid==ui[_A].cid;f=uE;if(l)V8(sA,TA,_A,AA-1,tc.CHAR_D);t:{if(sA==_A){Ty(sA,TA,AA-1,t,i,!l,f);break t}Ty(sA,TA,ui[sA].len-1,t,i,!l,f);for(r=sA+1;r<_A;r++){if(!pm(r))continue;Ty(r,0,ui[r].len-1,t,i,!l,f)}Ty(_A,0,AA-1,t,i,!l,f)}if(l){uE=f;V8(sA,TA,_A,AA-1,tc.CHAR_I)}oi.modified++;if(e)cG();return true};function Ty(t,e,r,i,f,l,a){var n;var c;var s,_,o,u;var T=f;var A=tc.HIDDEN|tc.FNOTETEXT|tc.FNOTEREST;var E=false;XC=f;u=r;if(u==ui[t].len-1&&Nj(ui[t].flags&(tc.LFLAG_PARA|tc.LFLAG_BREAK))){if(u>0)u--;else l=false}if(l){uE=a;V8(t,e,t,u,tc.CHAR_D)}if(ui[t].fmt==null){o=ui[t].UniFmt;if(Dj(xs[o].style&A))E=true}n=ui[t].txt;if(E){_=r-e+1;if(_>0){for(s=e;s<=r&&s<ui[t].len;s++){if(i)n[s]=ok(n[s]);else n[s]=uk(n[s])}}}else{c=nb(t);_=0;for(s=e;s<=r&&s<ui[t].len;s++){if(Dj(xs[c[s]].style&A)){if(i)n[s]=ok(n[s]);else n[s]=uk(n[s]);_++}}sb(t)}T=T+_;XC=f=T;if(l){uE=a;V8(t,e,t,u,tc.CHAR_I)}return true}_i.TerSetInitTypeface=function(t){if(!lv||!QD())_i.TerCreateControl();InitFontFace=t;return true};_i.TerSetFontId=function(t){if(!lv||!QD())_i.TerCreateControl();if(t<0||t>=Ys||!xs[t].InUse)return false;i_=t;return true};_i.TerSetDefTextColor=function(t,e){return _i.TerSetDefTextColor(yK(t),e)};_i.TerSetDefTextColor=function(t,e){if(!lv||!QD())_i.TerCreateControl();if(t==JT)return true;JT=t;if(e){bG(true);cG()}return true};_i.TerSetDefLang=function(t){if(!lv||!QD())_i.TerCreateControl();MO=t;return true};function Ay(t){var e="";var r=[],i=[],f=0,l,a,n,c=999999;var s="",_="";var o;e=Ey(xs[t].TypeFace,true);if(e==""||e==null)return t;_=","+e+",";n=xs[t].TwipsSize;s=","+mY(n/20);if((n^20)>0)s+=".5";s+=",";if(_.indexOf(s)>=0)return t;f=dy(e,",",r,i,50);if(f==0)return t;for(l=0;l<f;l++){s=e.substr(r[l],i[l]);a=Math.round(CX(s)*20+.5);if(Math.abs(a-n)<Math.abs(c-n))c=a}if(c==n)return t;if((o=Rb(Ti,t,xs[t].TypeFace,c,xs[t].style,xs[t].TextColor,xs[t].TextBkColor,xs[t].UlineColor,xs[t].FieldId,xs[t].AuxId,xs[t].Aux1Id,xs[t].CharStyId,xs[t].ParaStyId,xs[t].expand,xs[t].TempStyle,xs[t].lang,xs[t].FieldCode,xs[t].offset,xs[t].CharSet,xs[t].flags,xs[t].TextAngle))>=0){cO|=TOFLAG3_UPDATE_TOOLBAR;return o}else return t}function Ey(t,e){var r;if(AO==null||EO==0)return"";for(r=0;r<EO;r++){if(Tk(AO[r].typeface,t)==0){if(AO[r].IsSizeProp==e){return AO[r].value}}}return""}function Ry(t,e){styles="";styles=Ey(e,false).trim();if(styles=="")return true;if(t==tc.ID_BOLD_ON)return styles.indexOf("bold")>=0;else if(t==tc.ID_ITALIC_ON)return styles.indexOf("italic")>=0;else if(t==tc.ID_ULINE_ON)return styles.indexOf("underline")>=0;return true}function Ly(t){var e;var r=[],i=[];var f=0,l,a,n,c=999999,s=xs[t].TwipsSize;var _=xs[t].TwipsSize;var o="",u="",T=xs[t].TypeFace;u=Ey(T,true);if(u=="")return t;f=dy(u,",",r,i,50);if(f==0)return t;for(l=0;l<f;l++){o=u.substr(r[l],i[l]);n=Math.round(CX(o)*20+.5);var A=n%10;n=Math.floor(n/10)*10;if(A>=5)n+=10;if(_==n)return t;if(Math.abs(_-n)<c){s=n;c=Math.abs(_-n)}}_i.SetTerPointSize(-s,true);return $w()}function Cy(t,e,r,i,f){var l;var a=[],n=[];var c=0,s,_,o,u=-1;var T="",A="";A=Ey(i,true);if(A=="")return[];c=dy(A,",",a,n,50);if(c==0)return[];var E=[];for(s=0;s<c;s++){T=A.substr(a[s],n[s]);E.push(T);o=Math.round(CX(T)*20+.5);var R=o%10;o=Math.floor(o/10)*10;if(R>=5)o+=10;if(f==o)u=s}if(t)r.setItems(E,null,u,false);else{e.setItems(E,null,u,false);e.setMaximumRowCount(E.length>10?10:E.length)}return E}function Iy(t){var e="";e=Ey(t,false).trim();if(e=="")return false;if(e.indexOf("bold")<0)_i.SetTerCharStyle(tc.BOLD,false,false);if(e.indexOf("italic")<0)_i.SetTerCharStyle(tc.ITALIC,false,false);if(e.indexOf("underline")<0)_i.SetTerCharStyle(tc.ULINE,false,false);return false}function dy(t,e,r,i,f){var l=0,a=0;var n,c=t.length;var s=e.length;var _=true;if(f>0)r[0]=0;var o=Uk(e);var u=Uk(t);for(n=0;n<c;n++){if(xY(o,u[n])){if(_){if(l+1<f)i[l]=a;a=0;_=false;l++}continue}if(!_){_=true;if(l+1<f)r[l]=n}a++}if(_&&l+1<f)i[l]=a;return l+1}_i.TerSetCharSet=function(t){if(!lv||!QD())_i.TerCreateControl();$S=t;return true};_i.TerSetCharLang=function(t,e){if(!lv||!QD())_i.TerCreateControl();if(t==MO)t=0;if(k_>=0)return true;else return qb(tc.CMASK_LANG,t,0,null,e)};function Fy(t,e,r,i,f,l){var a,n;var c;var s;s=e;a=t;c=xs[a].style;if(Nj(c&tc.PICT))return t;if((n=Rb(Ti,a,xs[a].TypeFace,xs[a].TwipsSize,xs[a].style,xs[a].TextColor,xs[a].TextBkColor,xs[a].UlineColor,xs[a].FieldId,xs[a].AuxId,xs[a].Aux1Id,xs[a].CharStyId,xs[a].ParaStyId,xs[a].expand,xs[a].TempStyle,s,xs[a].FieldCode,xs[a].offset,xs[a].CharSet,xs[a].flags,xs[a].TextAngle))>=0){return n}else return t}_i.TerGetFontStyleId=function(t){if(!lv||!QD())_i.TerCreateControl();if(t<0||t>=Ys||!xs[t].InUse)return-1;return xs[t].CharStyId};_i.TerSetFontStyleId=function(t,e,r){if(!lv||!QD())_i.TerCreateControl();if(t<0||t>=Ys||!xs[t].InUse)return false;if(e>=0&&e<X_&&W_[e].InUse&&W_[e].type==tc.SSTYPE_CHAR)xs[t].CharStyId=e;if(r>=0&&r<X_&&W_[r].InUse&&W_[r].type==tc.SSTYPE_PARA)xs[t].ParaStyId=r;return true};_i.TerGetTextColor=function(t){var e;if(!lv||!QD())_i.TerCreateControl();xP=tc.Color.black;yP=tc.Color.white;if(t>=0){if(t>=Ys||!xs[t].InUse)return false;xP=xs[t].TextColor;yP=xs[t].TextBkColor}else{if((e=Hk(t))<0)return false;xP=W_[e].TextColor;yP=W_[e].TextBkColor}return true};_i.TerGetFontParam=function(t,e){var r;if(!lv||!QD())_i.TerCreateControl();if(t>=0){if(t>=Ys||!xs[t].InUse)return-1;if(e==tc.FONTINFO_CHARSET)return xs[t].CharSet;if(e==tc.FONTINFO_PICT_WIDTH)return xs[t].PictWidth;if(e==tc.FONTINFO_PICT_HEIGHT)return xs[t].PictHeight;if(e==tc.FONTINFO_AUX_ID)return xs[t].AuxId;if(e==tc.FONTINFO_FLAGS)return xs[t].flags;if(e==tc.FONTINFO_FRAME_TYPE)return xs[t].FrameType;if(e==tc.FONTINFO_FRAME_ID)return xs[t].ParaFID;if(e==tc.FONTINFO_FRAME_ID)return xs[t].ParaFID;if(e==tc.FONTINFO_OFFSET)return xs[t].offset;if(e==tc.FONTINFO_IS_PICT)return Nj(xs[t].style&tc.PICT)?1:0;if(e==tc.FONTINFO_IS_CTL)return Nj(xs[t].style&tc.PICT)&&xs[t].ctl!=null?1:0;if(e==tc.FONTINFO_FIELD_ID)return xs[t].FieldId;if(e==tc.FONTINFO_INS_REV_ID)return xs[t].InsRev;if(e==tc.FONTINFO_DEL_REV_ID)return xs[t].DelRev;if(e==tc.FONTINFO_FMT_REV_ID)return xs[t].FmtRev;if(e==tc.FONTINFO_CHAR_SCALEX)return xs[t].ScaleX+100;if(e==tc.FONTINFO_CHAR_SPACE)return xs[t].expand;if(e==tc.FONTINFO_IS_RTL)return xs[t].rtl?1:0;if(e==tc.FONTINFO_FLOW)return xs[t].flow;if(e==tc.FONTINFO_SIZE)return xs[t].TwipsSize;if(e==tc.FONTINFO_STYLE)return xs[t].style;if(e==tc.FONTINFO_HAS_COMMENTS)return xs[t].StoryIds!=null&&xs[t].StoryIds.length>0?1:0}else{if((r=Hk(t))<0)return-1;if(e==tc.FONTINFO_OFFSET)return W_[r].offset;if(e==tc.FONTINFO_CHAR_SCALEX)return W_[r].CharScaleX+100;if(e==tc.FONTINFO_CHAR_SPACE)return W_[r].expand;if(e==tc.FONTINFO_FLOW)return tc.FLOW_DEF}return-1};_i.TerGetFontParamClr=function(t,e){var r;if(!lv||!QD())_i.TerCreateControl();var i=tc.Color.black;if(t>=0){if(t>=Ys||!xs[t].InUse)return tc.FONTINFO_ERROR;if(e==tc.FONTINFO_ULINE_COLOR){return xs[t].UlineColor}if(e==tc.FONTINFO_HILIGHT_COLOR){return xs[t].HilightColor}if(e==tc.FONTINFO_COLOR){return xs[t].TextColor}if(e==tc.FONTINFO_BK_COLOR){return xs[t].TextBkColor}if(e==tc.FONTINFO_WLINE_COLOR){return xs[t].WlineColor}}else{if((r=Hk(t))<0)return tc.FONTINFO_ERROR;if(e==tc.FONTINFO_ULINE_COLOR){return W_[r].UlineColor}if(e==tc.FONTINFO_COLOR){return W_[r].TextColor}if(e==tc.FONTINFO_BK_COLOR){return W_[r].TextBkColor}}return tc.FONTINFO_ERROR};_i.TerGetFieldFont=function(t,e,r){if(!lv||!QD())_i.TerCreateControl();if(t<0||t>=Ys||!xs[t].InUse)return-1;if(xs[t].FieldId==e&&Cw(xs[t].FieldCode,r))return t;if(Nj(xs[t].style&tc.PICT)){xs[t].FieldId=e;xs[t].FieldCode=r;return t}return Rw(t,e,0,r,0,0)};_i.TerGetFontFieldId=function(t){if(!lv||!QD())_i.TerCreateControl();if(t<0||t>=Ys||!xs[t].InUse)return 0;return xs[t].FieldId};_i.TerGetFontFieldCode=function(t){if(!lv||!QD())_i.TerCreateControl();if(t<0||t>=Ys||!xs[t].InUse)return"";if(xs[t].FieldCode!=null)return xs[t].FieldCode;return""};_i.TerSetFontField=function(t,e,r){if(!lv||!QD())_i.TerCreateControl();if(t<0||t>=Ys||!xs[t].InUse)return false;if(xs[t].FieldId==e&&Cw(xs[t].FieldCode,r))return true;xs[t].FieldId=e;xs[t].FieldCode=r;oi.modified++;return true};_i.TerGetFontLang=function(t){if(!lv||!QD())_i.TerCreateControl();if(t<0||t>=Ys||!xs[t].InUse||Nj(xs[t].style&tc.PICT))return 0;return Nj(xs[t].lang)?xs[t].lang:MO};_i.TerGetFontAux1Id=function(t){if(!lv||!QD())_i.TerCreateControl();if(t<0||t>=Ys||Dj(xs[t].InUse))return 0;return xs[t].Aux1Id};_i.TerSetNextFontAux1Id=function(t){if(!lv||!QD())_i.TerCreateControl();l_=t;return true};_i.TerSetCharAuxId=function(t,e){if(!lv||!QD())_i.TerCreateControl();if(k_>=0)return false;else return qb(tc.CMASK_AUX,t,0,null,e)};function gy(t,e,r,i,f,l){var a,n;var c;c=e;a=t;if(Nj(xs[a].style&tc.PICT)){xs[a].AuxId=c;return a}if((n=Rb(Ti,a,xs[a].TypeFace,xs[a].TwipsSize,xs[a].style,xs[a].TextColor,xs[a].TextBkColor,xs[a].UlineColor,xs[a].FieldId,c,xs[a].Aux1Id,xs[a].CharStyId,xs[a].ParaStyId,xs[a].expand,xs[a].TempStyle,xs[a].lang,xs[a].FieldCode,xs[a].offset,xs[a].CharSet,xs[a].flags,xs[a].TextAngle))>=0){return n}else return t}_i.SetTerDefaultFont=function(t,e,r,i,f){return _i.SetTerDefaultFont2(t,e,r,i,false,f)};_i.SetTerDefaultFont2=function(t,e,r,i,f,l){return _i.SetTerDefaultFont3(t,e,r,i,ks,f,l)};_i.SetTerDefaultFont3=function(t,e,r,i,f,l,a){var n;if(!lv||!QD())_i.TerCreateControl();n9();if(typeof i=="string")i=yK(i);if(e>=0)n=e*20;else n=-e;ks=f;gb(tc.DEFAULT_CFMT);Fb(tc.DEFAULT_CFMT);xs[0].InUse=true;if(t!=null&&t!="")xs[0].TypeFace=t;if(n>0)xs[0].TwipsSize=n;xs[0].style=r;if(!Rx(Ti,tc.DEFAULT_CFMT,true)){return QY(tc.MSG_ERR_FONT_CREATE,"SetTerDefaultFont")}F=V=xs[tc.DEFAULT_CFMT].font;g=xs[tc.DEFAULT_CFMT].hFont;xs[tc.DEFAULT_CFMT].TextColor=i;oi.FontTypeFace=t;oi.PointSize=n/20;if(l){var c=false;U_=W_[0].copy();if(t!=null&&t!=""&&Tk(W_[0].TypeFace,t)!=0){W_[0].TypeFace=t;W_[0].CharMask|=tc.CMASK_FONT;c=true}if(n>0&&W_[0].TwipsSize!=n){W_[0].TwipsSize=n;W_[0].CharMask|=tc.CMASK_SIZE;c=true}if(W_[0].style!=r){W_[0].style=r;W_[0].StyleMask=r;c=true}if(!MJ(W_[0].TextColor,i)){W_[0].TextColor=i;W_[0].CharMask|=tc.CMASK_TEXT_COLOR;c=true}if(c)yZ(0)}v=F.met;if(v==null){v=My(ee,F);F.met=v}iG();bG(true);kA=-1;if(oi.ShowStatus&&!GR)tB();if(a)cG();return true};_i.GetFontInfo=function(t){var e;var r;if(!lv||!QD())_i.TerCreateControl();r=_i.GetFontInfo2(t);VC=tj(YC);return r};_i.GetFontInfo2=function(t){var e;if(!lv||!QD())_i.TerCreateControl();RP="";YC=0;KC=0;if(t>=0){if(t>=Ys||!xs[t].InUse)return false;RP=jO[0]=xs[t].TypeFace;YC=VO[0]=xs[t].TwipsSize;KC=VO[1]=xs[t].style}else{if((e=Hk(t))<0)return false;RP=jO[0]=W_[e].TypeFace;YC=VO[0]=W_[e].TwipsSize;KC=VO[1]=W_[e].style}return true};function Py(t,e){var r=xs[t].TypeFace.toLowerCase();if(Nj(fO&tc.TFLAG10_DST)&&(nV(r,n_.toLowerCase())||nV(r,c_.toLowerCase())))return e;if(nV(r,"wingdings"))return RY(e);else if(nV(r,"symbol"))return AY(e);else if(xs[t].CharSet==2)return RY(e);else return e}function Sy(t,e){if(t<55296||t>56319)return e;if(e<56320||e>57343)return e;return Character.toCodePoint(t,e)}function hy(t,e){return t}function Oy(t,e){return true}function vy(t,e){if(Nj(xs[t].style&tc.PICT))return t;if(e<128)return t;var r=xs[t].font;var i=Sy(xs[t].UcBase,e);if(r.canDisplay(i))return t;py(i,t);return xb(t,RP,eF,rF)}function py(t,e){var r=t>>8;var i=t&255;var f=0,l,a;var n=0;if(r>=256){if(e>=0){var c=Character.toChars(t);var s=c[0];if(s==xs[e].UcBase&&xs[e].font.canDisplay(t)){RP=xs[e].TypeFace;eF=xs[e].CharSet;rF=xs[e].lang;return true}}n=ys.length;for(a=0;a<n;a++)if(ys[a].canDisplay(t))break;if(a<n){RP=ys[a];eF=f;rF=1033}else{RP="Arial";eF=0;rF=1033}return true}if(bs[r]==null){bs[r]=new tc.ClsCharFont;bs[r].typeface=[256];bs[r].CharSet=[256];bs[r].lang=[256]}if(bs[r].typeface[i]==null){if(e>=0){if(xs[e].font.canDisplay(t)){bs[r].typeface[i]=RP=xs[e].TypeFace;bs[r].CharSet[i]=eF=xs[e].CharSet;bs[r].lang[i]=rF=xs[e].lang;return true}}if(t>=1536&&t<=1791)f=tc.ARABIC_CHARSET;else if(t>=64336&&t<=64575)f=tc.ARABIC_CHARSET;else if(t>=65136&&t<=65279)f=tc.ARABIC_CHARSET;else if(t>=1872&&t<=1919)f=tc.ARABIC_CHARSET;else if(t>=1424&&t<=1535)f=tc.HEBREW_CHARSET;else if(t>=8448&&t<=8527)f=tc.HEBREW_CHARSET;else if(t>=64256&&t<=64335)f=tc.HEBREW_CHARSET;else if(t>=11776&&t<=40879||t>=63744&&t<64255||t>=65072&&t<65103||t>=65280&&t<65519){f=tc.GB2312_CHARSET}else if(t>=19968&&t<=43007)f=tc.SHIFTJIS_CHARSET;l=XK(f);n=ys.length;for(a=0;a<n;a++){if(t>=2433&&t<=2555){if(Tk(ys[a].getFamily(),"Vrinda")==0&&ys[a].canDisplay(t))break}}if(a==n){for(a=0;a<n;a++){var _=ys[a].toLowerCase();if(true||ys[a].canDisplay(t))break}}if(a<n){bs[r].typeface[i]=ys[a];bs[r].CharSet[i]=f;bs[r].lang[i]=l}else{bs[r].typeface[i]="Arial";bs[r].CharSet[i]=0;bs[r].lang[i]=1033}}RP=bs[r].typeface[i];eF=bs[r].CharSet[i];rF=bs[r].lang[i];return true}function Ny(t,e){if(Ys<500)return MJ(t,e);var r=8;var i=t.getRed();var f=t.getGreen();var l=t.getBlue();var a=e.getRed();var n=e.getGreen();var c=e.getBlue();if(i!=0&&i!=1&&i!=254&&i!=255)i=i/r*r;if(f!=0&&f!=1&&f!=254&&f!=255)f=f/r*r;if(l!=0&&l!=1&&l!=254&&l!=255)l=l/r*r;if(a!=0&&a!=1&&a!=254&&a!=255)a=a/r*r;if(n!=0&&n!=1&&n!=254&&n!=255)n=n/r*r;if(c!=0&&c!=1&&c!=254&&c!=255)c=c/r*r;return i==a&&f==n&&l==c}function Dy(t,e,r,i){var f=null;r=new tc.Color(r);f=new $t.DialogBox(te,t,_i.DlgFont,true,function(t,e,r){if(Tk(t,"cancel")===0)_();if(Tk(t,"OK")===0)o()});var l=f.cvs;var a=[];var n="TehColor"+e;var c=Mp(n);if(c==null)c="";if(c.length>0)a=c.split(",");var s=new $t.ColorBox(l,0,0,JV(400),JV(450),e,_i.DlgFont,r.toString(),a,true,null);f.addComp(s,0,0,1,1,"left","middle",0,0);f.show();function _(){f.hide()}function o(){var t=s.getSelectedColor();var e=s.getCustomColors();if(e.length==0)Gp(n,"");else Gp(n,e.toString());f.hide();if(i!=null)i(new tc.Color(t))}}_i.TerFontExists=function(t){return $t.DetectFont(_i.cvs,t)};$t.DetectFont=function(t,e,r){if(!r)r=true;if(e.toLowerCase()=="arial")return true;if(e.toLowerCase()=="times new roman")return true;var i=t.getContext("2d");var f=[""];var l="mmmmmmmmmmwwwijy";var a="100pt";var n;var c;var s;if($t.DefFontWidths.length===0){for(n=0;n<f.length;n++){c=a+" "+"dbsdldfbsdggasdh"+f[n];i.font=c;$t.DefFontWidths.push(EH(i,l,c).width)}}for(n=0;n<f.length;n++){c=a+" '"+e+f[n]+"'";i.font=c;if($t.DefFontWidths[n]!=EH(i,l,c).width)return true}if(!r){if($t.DefFontHeights.length===0){for(n=0;n<f.length;n++){c=a+" "+"dbsdldfbsdggasdh"+f[n];s=My(t,c);$t.DefFontHeights.push(s.height)}}for(n=0;n<f.length;n++){var _=a+" '"+e+f[n]+"'";c=a+" '"+e+f[n]+"'";s=My(t,c);if($t.DefFontHeights[n]!=s.height)return true}}return false};function My(t,e){if(e!=undefined&&typeof e!="string")e=e.FontString;if(arguments.length!=2||typeof e!="string")console.trace();var r=(new tc.ClsFontMetrics).init();var i=document.createElement("div");var f=t.parentNode;if(f==null){f=t.EditorCvs.parentNode}i.style.font=e;i.style.position="absolute";i.style.whiteSpace="nowrap";i.style.margin="0px";i.style.padding="0px";f.appendChild(i);i.innerText="x";var l=document.createElement("span");l.style.display="inline-block";l.style.overflow="hidden";l.style.width="1px";l.style.height="1px";l.style.margin="0px";l.style.padding="0px";i.appendChild(l);r.ascent=l.offsetTop+l.offsetHeight;r.height=i.offsetHeight;if(e.toLowerCase().indexOf("symbol dst")>=0)r.ascent=r.height*55/100;if(tg.InFireFox){r.height-=2;if(r.height<1)r.height=1;r.ascent-=1;if(r.ascent<1)r.ascent=1}else if(r.height>2)r.height--;if(r.height===0||r.ascent===0){var a="Ij";var n=0;var c=0;var s=document.createElement("canvas");var _=s.getContext("2d");_.font=e;n=Math.ceil(EH(_,a).width);c=n*10;s.width=n;s.height=c;var o=$t.GetFontHeight(_,a,"top",n,c);var u=CrInt1;o+=u;var T=$t.GetFontHeight(_,a,"alphabetic",n,c)+u;if(r.height==0){if(r.ascent>0)r.height=r.ascent+T;else r.height=o;if(r.ascent==0)r.ascent=r.height-T;r.descent=T}}else r.descent=r.height-r.ascent;f.removeChild(i);return r}$t.GetFontHeight=function(t,e,r,i,f){t.fillStyle="#ffffff";t.fillRect(0,0,i,f);t.textBaseline=r;t.fillStyle="black";t.fillText(e,0,0);var l=t.getImageData(0,0,i,f);var a=l.data;var n,c,s=0;var _=0;var o=false;var u=0;for(n=0;n<f;n++){s=n*(i*4);for(c=0;c<i;c++){_=a[s];if(a[s]!=255||a[s+1]!=255||a[s+2]!=255||a[s+3]!=255)break;if(_!=255)break;s+=4}if(c==i){if(!o)continue;else break}else{if(!o)u=n;o=true}}CrInt1=u;return n+1};function Gy(){var t=[];ys=[];t.push("Arial");t.push("Arial Black");t.push("Arial Narrow");t.push("Book Antigua");t.push("Calibri");t.push("Cambria");t.push("Century Gothic");t.push("Century Regular");t.push("Comic Sans MS");t.push("Copper Black");t.push("Cordia New");t.push("Courier New");t.push("Courier");t.push("David");t.push("DengXian");t.push("Elephant");t.push("FangSong");t.push("Fixedsys");t.push("Franklin Gothic");t.push("Freestyle Script");t.push("Gabriola");t.push("Garamond");t.push("Georgia");t.push("Gill Sans");t.push("Gisha");t.push("Goudy Old Style");t.push("Goudh Stout");t.push("Harrington");t.push("High Tower Text");t.push("Impact");t.push("Informal Roman");t.push("Japanese Text");t.push("Jokeman");t.push("Juice ITC");t.push("KaiTi");t.push("Klavika");t.push("Kokila");t.push("Kristen ITC");t.push("Kunstler Script");t.push("Latin Wide");t.push("Leelawadee");t.push("Leelawadee UI");t.push("Licida Bright");t.push("Lucida Console");t.push("Lucida Fax");t.push("Lucida Handwriting");t.push("Lucida Sans");t.push("Lucida Sans Typewriter");t.push("Lucida Sans Unicode");t.push("Magneta Bold");t.push("Maiandra GD");t.push("Malgun Gothic");t.push("Mangal");t.push("Matura MT Script");t.push("Meiryo");t.push("Meiryo UI");t.push("Microsoft Himalaya");t.push("Microsoft JhengHei");t.push("Microsoft New Tai Lue");t.push("Microsoft PhagPa");t.push("Microsoft Sans Seri");t.push("Microsoft Tai Le");t.push("Microsoft Uighur");t.push("Microsoft YaHei");t.push("Microsoft YaHei UI");t.push("Microsoft Yi Baiti");t.push("MingLiU_HKSCS-ExtB");t.push("MingLiU-ExtB ");t.push("Minion");t.push("Miriam Fixed");t.push("Miriam");t.push("Mistral");t.push("Modern No.20");t.push("Mongolian Baiti");t.push("Monotype Corsiva Italic");t.push("MS Outlook");t.push("MS Reference");t.push("MS Sans Serif");t.push("MS Serif");t.push("MT Extra");t.push("MV Boli");t.push("Myanmar Text");t.push("Narkisim");t.push("Niagara Engraved");t.push("Niagara Solid");t.push("Nian");t.push("Nirmala UI");t.push("Noto Snas");t.push("NSimSun");t.push("OCR A Extended");t.push("OCRATTRegular");t.push("Old English Text");t.push("Onyx");t.push("OpenSymbol");t.push("Palance Script MT");t.push("Palantino Linotype");t.push("Papyrus");t.push("Parchment");t.push("Perpetua");t.push("Perpetua Tilting");t.push("Playbill");t.push("PMingLiu-ExtB");t.push("Poor Richard");t.push("Pristina");t.push("Rage Italic");t.push("Ravie");t.push("Rockwell");t.push("Rod");t.push("Roman");t.push("Sakkal Majalla");t.push("Sanskrit Text");t.push("Script MT");t.push("Script Regular");t.push("Segoe");t.push("Segoe Marker");t.push("Segoe Print");t.push("Segoe MDL2 Assets");t.push("Segoe Script");t.push("Segoe UI");t.push("Segoe UI Emoji");t.push("Segoe UI Historic");t.push("Segoe UI Symbol");t.push("Showcard Gothic");t.push("SimHei");t.push("Simplified Arabic");t.push("Simplified Arabic Fixed");t.push("Simsun");t.push("SimSun-ExtB");t.push("Sitka Banner");t.push("Sitka Display");t.push("Sitka Heading");t.push("Sitka Small");t.push("Sitka Subheading");t.push("Sitka Text");t.push("SketchFlow Print");t.push("Small Fonts");t.push("Snap ITC");t.push("Stencil");t.push("SuomiHand Script Medium");t.push("Sylfaen");t.push("Symbol");t.push("System Bold");t.push("Tahoma");t.push("Tempus Sans ITC");t.push("Terminal");t.push("Times New Roman");t.push("TI-Nspire");t.push("TI-Nspire Sans");t.push("TINspireKeys");t.push("TINspireKeysChinese");t.push("TINspireKeysCX");t.push("TINspireKeysTouch");t.push("Traditional Arabic");t.push("Trebuchet MS");t.push("Tw Cen MIT");t.push("Urdu Typesetting");t.push("Utsaah");t.push("Verdana");t.push("Viner Hand ITC");t.push("Vivaldi Italic");t.push("VK TheSans");t.push("Vladimir Script");t.push("Webdings");t.push("Wingdings");t.push("Wingdings 2");t.push("Wingdings 3");t.push("Yu Gothic");t.push("Yu Gothic UI");t.push("ZWAdobeF");for(var e=0;e<t.length;e++){if($t.DetectFont(_i.cvs,t[e]))ys.push(t[e])}ys.sort();var r=ys.length;var i;for(i=0;i<r;i++)Ws[i]=ys[i].toLowerCase()}_i.TerGetAvailFonts=function(t){if(t==undefined)t=false;if(t)return ys.slice();else return Ws.slice()};function By(t,e,r){Hy(t,e,r,true)}function Hy(t,e,r,i){var f=0,l,a,n,c=0,s,_,o,u;var T,A,E,R;var L,C;var I,d,F,g,P;var S,h,O,v,p;var N,D,M,G;var B,H,m;var w,b,x,y=0;var W;var U,k,X=0,K=0,Y;var V=0;var j,J,z;var Z,Q,q;var $,tt;var et;var rt=0,it=0;var ft,lt=0,at=0;var nt=0,ct=0,st=0;var _t,ot=0,ut,Tt,At;var Et=new tc.ClsHdrFtr,Rt=new tc.ClsHdrFtr;var Lt=0,Ct;var It;var dt=0,Ft,gt,Pt=0,St=0;var ht=new tc.ClsFrameSet,Ot=new tc.ClsFrameSet,vt=new tc.ClsFrameSet;var pt=new tc.ClsFrameSet,Nt=new tc.ClsFrameSet,Dt=new tc.ClsFrameSet;var Mt=[],Gt=[],Bt=[];var Ht,mt=0;var wt=false,bt=false;var xt=-1,yt,Wt=0,Ut=0;var kt,Xt,Kt=0;var Yt,Vt;var jt,Jt,zt,Zt;var Qt,qt,$t,te,ee,re;var ie;var fe=false;var le=true;var ae=false;var ne=[];ZU("CreateFrames");Ul++;Dl=0;jl=false;Sr=false;$r=false;Ze=Y=0;if(e<0)e=0;qe=e;Ci=FS&&!oi.FittedView;ht=new tc.ClsFrameSet;Ot=new tc.ClsFrameSet;vt=new tc.ClsFrameSet;pt=new tc.ClsFrameSet;ql=tc.MAX_PICT_TEXT;Zl=[ql+1];Ql=0;t:while(true){f=m=Dl;lW(f);Je=0;ht.HdrHeight=ht.FtrHeight=L=0;q=false;$e=e;ht.HdrMargin=-1;It=false;tt=false;j=0;Ht=-1;Ql=0;xt=-1;if(e==Lo)kR=XR=KR=YR=0;mt=po[e].FrameCount;po[e].FrameCount=0;po[e].LastRowEndY=-1;po[e].flags=_j(po[e].flags,tc.PAGE_REPAGE);po[e].flags=_j(po[e].flags,tc.PAGE_LINKED_FRAMES);g=po[e].FirstLine;if(g>=Ri)g=Ri-1;if(Nj(ui[g].cid)){while(g>=0&&ui[g].page==e&&Nj(ui[g].cid))g--;g++;po[e].FirstLine=g}d=po[e].FirstLine;ht.TopSect=G5(d);ht.TopLeftMargin=Ai*to[ht.TopSect].LeftMargin;if(e==qe)lt=ht.TopLeftMargin;else at=ht.TopLeftMargin;ft=Ai*to[ht.TopSect].RightMargin;Ft=0;gt=ht.y;er=rr=ir=0;if(Ci){Yy(e,ht.y,Ot.y,f);ht.y=IF;Ot.y=FF;f=gF;nt=PF;ct=SF}Ft+=er;gt+=rr;ht.HiddenY=eo[ht.TopSect].HiddenY;if(ht.HdrMargin==-1){ht.sect=Cz(e);Et=jF;if(ht.sect<0)ht.sect=ht.TopSect;ht.HdrHeight=Fz(e,false,true);if(ht.HdrHeight>0)ht.HdrMargin=Ei*to[ht.sect].HdrMargin;else ht.HdrMargin=Ei*to[ht.sect].TopMargin;ht.sect=Iz(e);Rt=jF;if(ht.sect<0)ht.sect=ht.TopSect;ht.FtrHeight=gz(e,false);if(ht.FtrHeight>0)ht.FtrMargin=Ei*to[ht.sect].FtrMargin;else{if(false&&to[ht.TopSect].FtrMargin>to[ht.TopSect].BotMargin&&to[ht.TopSect].BotMargin>=0)ht.FtrMargin=Ei*to[ht.TopSect].FtrMargin;else ht.FtrMargin=Ei*to[ht.sect].BotMargin}L=Pz(e);ht.sect=ht.TopSect;if(Ci){X=eo[ht.sect].PgHeight*Ei+rr+ir;K=eo[ht.sect].PgWidth*Ai+2*er}else{X=eo[ht.sect].PgHeight*Oz()*Ei;if(yR)X-=2*ht.HiddenY;else X-=ht.HdrMargin+ht.FtrMargin+ht.HdrHeight+ht.FtrHeight;K=eo[ht.sect].PgWidth*Ai-ht.TopLeftMargin-ft}}e:while(true){r:{i:{j++;W=0;J=ht.y;z=f;g=po[e].FirstLine;if(g>=Ri)g=Ri-1;P=g;f=Dl;lW(f);R=0;if(j==tc.PASS_HDR){V=tc.PAGE_HDR;if(yR){ht.sect=Cz(e);Et=jF;if(ht.sect<0){ht.sect=ht.TopSect;q=false;break i}St=ht.sect;g=Et.FirstLine+1;P=Et.LastLine-1;if(!WR)W=tc.FRAME_DISABLED;if(e==Lo){kR=g;XR=P}if(P<g)continue e;N5(g,true);d=po[e].FirstLine;ht.sect=G5(d);if(!Ci&&(R=Qy(g,P,ht.sect))>0){pl[f].empty=true;pl[f].PageNo=e;pl[f].y=ht.y;pl[f].ScrY=Ot.y;pl[f].x=0;pl[f].width=Ai*(eo[ht.sect].PgWidth-to[ht.sect].LeftMargin-to[ht.sect].RightMargin);pl[f].flags=tc.FRAME_RIGHTMOST;pl[f].height=R;pl[f].ScrHeight=yV(R);ht.y+=pl[f].height;Ot.y+=pl[f].ScrHeight;Dl++;f++;lW(f)}}else continue e}else if(j==tc.PASS_TBL_HDR){Yt=0;if(po[e].TblHdrHt==0)continue e;g=po[e].TblHdrFirstLine;P=po[e].TblHdrLastLine;if(g>=Ri||P>=Ri)continue e;V=0;W=tc.FRAME_DISABLED|tc.FRAME_GRAY;ht.sect=G5(g);for(Yt=g;Yt<=P;Yt++){jt=ui[Yt].cid;$t=0;if(eR[jt].level>0)jt=E6(0,-jt);if(jt==0)continue e;$t=eR[jt].row;if(Dj($E[$t].flags&tc.ROWFLAG_HDR))continue e}if(GY(g,tc.INFO_ROW))continue e;if(!GY(P,tc.INFO_ROW))continue e}else if(j==tc.PASS_FTR){V=tc.PAGE_FTR;if(yR){E=ht.sect;ht.sect=Iz(e);Rt=jF;if(ht.sect<0){ht.sect=ht.TopSect;q=false;break i}g=Rt.FirstLine+1;P=Nj(Rt.LimitFtrLine)?Rt.LimitFtrLine:Rt.LastLine-1;if(e==Lo){KR=g;YR=P}if(P<g)break e;N5(g,true);if(yR){var ce=Rt.height-Rt.TextHeight;if(ht.sect!=ht.TopSect){var se=(to[ht.TopSect].BotMargin-to[ht.TopSect].FtrMargin)*Ei;ce=se-Rt.TextHeight;if(ce<0)ce=0}if(ce>0){pl[f].empty=true;pl[f].PageNo=e;pl[f].y=ht.y;pl[f].ScrY=Ot.y;pl[f].x=er;pl[f].width=Ai*eo[ht.sect].PgWidth;if(!Ci){pl[f].width-=Ai*(to[ht.sect].LeftMargin+to[ht.sect].RightMargin);pl[f].flags=tc.FRAME_RIGHTMOST}pl[f].height=ce;pl[f].ScrHeight=yV(pl[f].height);ht.y+=pl[f].height;Ot.y+=pl[f].ScrHeight;Dl++;f++;lW(f)}else{ht.y+=ce;ht.y+=yV(ce)}}ht.sect=E}else break r}else if(j==tc.PASS_BODY){var _e,oe;var ue;V=0;ht.sect=G5(g);if(e==To-1)P=Ri-1;else{P=po[e].LastLine;if(P>=Ri){P=Ri-1;if(Fo>P-1)Fo=P-1;if(Fo<0)Fo=0}oe=ui[P].cid;_e=oe>0?eR[oe].row:0;ue=Nj($E[_e].flags&tc.ROWFLAG_SPLIT);if(!Po&&_e>0&&!ue&&!GY(P,tc.INFO_ROW)){Yt=0;var Te=P;if(ui[P].cid>0&&P+1<Ri&&ui[P+1].cid>0&&Nj(ui[P+1].tabw)&&Nj(ui[P+1].tabw.type&tc.INFO_ROW)){P++;ui[P].page=e;if(po[e].LastLine==P-1)po[e].LastLine++;if(po[e+1].FirstLine==P)po[e+1].FirstLine++}else if(false){for(Yt=P;Yt>g;Yt--){if(ui[Yt].cid==0||Nj(ui[Yt].tabw)&&Nj(ui[Yt].tabw.type&tc.INFO_ROW))break}if(Yt==g){for(Yt=P;Yt+1<Ri;Yt++){if(ui[Yt].cid==0||Nj(ui[Yt].tabw)&&Nj(ui[Yt].tabw.type&tc.INFO_ROW))break}}P=Yt;po[e].LastLine=P;oe=ui[P].cid;_e=R6(0,eR[oe].row);if(P+1>=Ri||Dj($E[_e].flags&tc.ROWFLAG_SPLIT))po[e+1].FirstLine=P+1;for(I=P+1;I<=Te;I++)ui[I].page=e+1;po[e+1].flags=cj(po[e+1].flags,tc.PAGE_HARD)}}}if(P<g)P=g;if(P>=Ri)P=Ri-1}else{Qt=Zl[xt];g=kl[Qt].FirstLine;P=kl[Qt].LastLine;ht.y=kl[Qt].AnchorY;if(kl[Qt].NextId>0)po[e].flags|=tc.PAGE_LINKED_FRAMES}if(P>=Ri)P=Ri-1;if(g>P)g=P;if((j==tc.PASS_BODY||j==tc.PASS_TBL_HDR)&&Ht==-1&&Nj(to[ht.TopSect].flags&(tc.SECT_VALIGN_CTR|tc.SECT_VALIGN_BOT))){pl[f].empty=true;pl[f].PageNo=e;pl[f].y=ht.y;pl[f].ScrY=Ot.y;pl[f].x=0;pl[f].width=Ai*(eo[ht.sect].PgWidth-to[ht.sect].LeftMargin-to[ht.sect].RightMargin);pl[f].flags=tc.FRAME_RIGHTMOST;pl[f].height=0;pl[f].ScrHeight=0;ht.y+=pl[f].height;Ot.y+=pl[f].ScrHeight;Ht=f;Dl++;f++;lW(f)}Pt=g;f:while(true){if($l>0&&!tt){Vy(e,ht.y,f,ht.TopSect,ht.TopLeftMargin,ht.HiddenY,ht.HdrMargin,ht.HdrHeight);f=gF;tt=true}for(d=g;d<P;d++){if(Nj(ui[d].tabw)&&Nj(ui[d].tabw.type&tc.INFO_SECT))break}F=d;if(F>=Ri)F=Ri-1;if(F<0)F=0;if(Dj(V)){if(!yR&&e==Lo)kR=g;while(Nj(Nc[ui[g].pfmt].flags&(tc.PAGE_HDR|tc.PAGE_FTR))){g++;if(g>F)break}if(!yR&&e==Lo)XR=g-1;if(g>F)break i;ht.sect=G5(g)}a=Ai*to[ht.sect].LeftMargin;n=Ai*to[ht.sect].RightMargin;c=Ai*eo[ht.sect].PgWidth-a-n;if(c>Je)Je=c;if(oi.FittedView)c=wV(je);_=to[ht.sect].columns;if(Nj(V))_=1;ht.ColumnSpace=Ai*to[ht.sect].ColumnSpace;if(_==1)ht.ColumnSpace=0;ht.ColumnWidth=(c-(_-1)*ht.ColumnSpace)/_;if(_>1&&Nj(to[ht.sect].flags&tc.SECT_VAR_COL_WIDTH)){ht.ColumnWidth=DV(to[ht.sect].ColWidth[0]);ht.ColumnSpace=DV(to[ht.sect].ColSpace[0])}ie=F;if(Nj(V&tc.PAGE_HDR))s=Fz(e,false,true)+mV(40);else if(Nj(V&tc.PAGE_FTR))s=gz(e,false)+mV(40);else{if(to[ht.sect].LastPage==e&&eo[ht.sect].LastPageHeight>0)s=eo[ht.sect].LastPageHeight;else s=X-(ht.y-Ze);if(_>1){for(;ie>g;ie--){if(ui[ie].fid>0)continue;if(ui[ie].col==0)break}}}l=f;lW(f);ht.FrameHt=0;Ot.FrameHt=0;ht.CurColHeight=0;Ot.CurColHeight=0;ht.MaxColHeight=0;Ot.MaxColHeight=0;ht.ColumnX=ht.CellX=0;kt=ht.y;Xt=Ot.y;if(Ci)ht.ColumnX=ht.CellX=er+ht.TopLeftMargin;Mt[0]=ht.ColumnX;Bt[0]=f;Gt[0]=ht.ColumnWidth;ne[0]=ht.y;T=_t=0;fe=false;w=g-1;H=-1;B=0;U=0;Q=true;N=0;b=-1;ut=0;Lt=false;Ct=false;At=0;Jl=false;et=Xl=0;ae=false;for(I=g;;I++){if(I>0&&I<Ri&&ui[I].cid>0&&ui[I].cid==ui[I-1].cid&&ui[I].page<ui[I-1].page)ui[I].page=ui[I-1].page;if(I<Ri&&j==tc.PASS_BODY&&!ae){if(ui[I].cid>0){if(ui[I].page!=e)continue;if(_>1&&ui[I].col!=_t&&I<=ie&&ui[I].fid==0)continue}else{if(_>1&&ui[I].fid==0){var Ae=_t;if(!fe&&I>g&&ui[I-1].fid==ui[I].fid&&ui[I-1].col+1==ui[I].col)Ae++;if(Ae!=ui[I].col)continue}}}fe=false;if(j<tc.MAX_PASSES){wt=bt;bt=I<Ri&&ui[I].fid>0&&kl[ui[I].fid].pict>0;if(bt&&(I==0||ui[I].fid!=ui[I-1].fid))kl[ui[I].fid].FirstLine=kl[ui[I].fid].LastLine=I;if(bt)kl[ui[I].fid].LastLine=I;if(!wt&&bt){if(Xl>0){Nt=vt.copy();Dt=pt.copy()}else{Nt=ht.copy();Dt=Ot.copy()}Jl=true}else if(wt&&!bt&&Jl){ht=Nt.copy();Ot=Dt.copy();Jl=false}if(bt&&wt)continue;if(wt){N=Xl=0;b=-1;ht.CurColHeight+=ht.FrameHt;Ot.CurColHeight+=Ot.FrameHt;ht.FrameHt=Ot.FrameHt=0;if(_==1){if(ht.CurColHeight>ht.MaxColHeight)ht.MaxColHeight=ht.CurColHeight;if(Ot.CurColHeight>Ot.MaxColHeight)Ot.MaxColHeight=Ot.CurColHeight;if(_t==0){ht.y+=ht.MaxColHeight;Ot.y+=Ot.MaxColHeight}else{ht.y+=ht.CurColHeight;Ot.y+=Ot.CurColHeight}ht.MaxColHeight=Ot.MaxColHeight=0;ht.CurColHeight=Ot.CurColHeight=0}if(ui[I].cid==0&&ui[I].fid==0){ht.ColumnX=ht.CellX=Mt[_t];ht.ColumnWidth=Gt[_t]}}}else{if(I<=F)ui[I].page=e;bt=wt=false}Tt=0;if(I<Ri)Tt=ui[I].height;if(I<Ri)ui[I].frame=-1;if(b<0)b=y=I;x=y;y=I;if(b>=Ri)break;S=h=O=p=v=false;Z=$=false;if(Dj(V)&&I<Ri&&Nj(Nc[ui[I].pfmt].flags&(tc.PAGE_HDR|tc.PAGE_FTR)))F=I-1;M=N;if(I<Ri&&Nj(ui[I].cid))N=E6(0,I);else N=0;D=eR[N].row;G=eR[M].row;Lt=G>0&&o6(true,G,e);Ct=G>0&&o6(false,G,e);et=Xl;if(I<Ri)Xl=ui[I].fid;else Xl=0;if(M>0)p=true;else if(et>0)Z=true;else v=true;if(N!=M&&I>g)O=true;if(D!=G&&G!=0&&I>g)h=true;if(Xl!=et&&I>g)$=true;if(I>g&&Nj(ui[I-1].tabw)&&Nj(ui[I-1].tabw.type&tc.INFO_COL)&&T+1<_)S=true;if(Nj(to[ht.sect].flags&tc.SECT_VAR_COL_WIDTH)){if(I>0&&I<Ri&&ui[I].col>ui[I-1].col)S=true;Q=false}if(I>F||I>ie||ae){if(Lt||Ct)h=true;S=true;Q=false}ae=false;if(I<Ri&&Nj(ui[I].flags&tc.LFLAG_SOFT_COL)&&Q)S=true;if(Xl>0)S=false;if(I>0&&I<Ri&&I>ie)S=true;if(j==tc.PASS_TBL_HDR)S=false;if(b==x&&I<=x){S=O=h=$=false;if(I<Ri&&Nj(ui[I].flags&tc.LFLAG_SOFT_COL)&&Q&&I+1<Ri){ui[I].flags=_j(ui[I].flags,tc.LFLAG_SOFT_COL);ui[I+1].flags|=tc.LFLAG_SOFT_COL}}if(S)T++;if(S||O||h||$){if(p){$y(0,f,ht.y,Ot.y,ht.FrameHt,Ot.FrameHt,ht.CurColHeight,Ot.CurColHeight,H,B,U,ht.CellX,ot,e,ht.TopLeftMargin,_t,ht.sect,M,ut,b,x,W,h,st,c,_,ht.ColumnSpace,K,ht.ColumnX,ht.ColumnWidth,dt,et);f=gF;ht.FrameHt=OF;Ot.FrameHt=vF;H=pF;B=NF;U=DF;ht.CellX=MF;ut=GF;st=BF;if(et!=Xl&&et>0)Ky(dt,et,ht.CurColHeight+ht.FrameHt,x);if(bt&&!wt){Nt.y=ht.y;Nt.CurColHeight=ht.CurColHeight;Nt.FrameHt=ht.FrameHt}}else if(Z){var Ee=Xl!=et;Jt=0;var Re=kl[et].TextAngle;if(Dj(pl[dt].flags&tc.FRAME_NON_TEXT_DO)){pl[f]=pl[dt].copy();pl[f].empty=false;pl[f].PageNo=e;pl[f].PageFirstLine=kl[et].TextLine=b;pl[f].PageLastLine=x;pl[f].y=ht.y+ht.CurColHeight;pl[f].ScrY=Ot.y+Ot.CurColHeight;pl[f].x=ht.ColumnX;pl[f].height=ht.FrameHt;pl[f].SpaceTop=0;pl[f].SpaceBot=0;if(Re>0)pl[f].width=pl[dt].height;pl[f].width-=pl[f].SpaceLeft+pl[f].SpaceRight;pl[f].ScrHeight=yV(pl[f].height);pl[f].ScrWidth=bV(pl[f].width);for(Jt=0;Jt<4;Jt++)pl[f].BorderWidth[Jt]=0;pl[f].border=0;pl[f].SpaceLeft=pl[f].SpaceRight=0;pl[f].flags1=cj(pl[f].flags1,tc.FRAME1_PARA_FRAME_BOX);if(Ee){var Le,Ce;Ky(dt,et,ht.CurColHeight+ht.FrameHt,x);if(Re==0)Le=pl[dt].y+pl[dt].height;else Le=pl[dt].y+pl[dt].width;Ce=pl[f].y+pl[f].height;Le-=xV(1);if(Ce<Le){pl[f].height+=Le-Ce;pl[f].flags|=tc.FRAME_LAST_FRAME_OF_BOX_FRAME}else{pl[f].height-=Ce-Le;pl[f].flags1|=tc.FRAME1_OVERFLOWS_BOX}}rt=pl[f].y+pl[f].height;it=pl[f].ScrY+pl[f].ScrHeight;f++;lW(f)}}else{var Ie=true;if(j==tc.PASS_BODY&&b>F&&x>F&&b>po[e].LastLine)Ie=false;if(Ie){pl[f].empty=false;pl[f].PageNo=e;pl[f].sect=ht.sect;pl[f].PageFirstLine=b;pl[f].PageLastLine=x;if(b==x){if(ui[b].len==1){var de=ui[b].txt[0];if(hj(de))pl[f].empty=true}}pl[f].y=ht.y+ht.CurColHeight;pl[f].ScrY=Ot.y+Ot.CurColHeight;pl[f].x=ht.ColumnX;pl[f].width=ht.ColumnWidth;if(_==1||_t+1==_){if(Ci){pl[f].width=K-er-pl[f].x;pl[f].SpaceRight=ft}else pl[f].flags|=tc.FRAME_RIGHTMOST;if(_t+1==_)pl[f].flags|=tc.FRAME_LAST_COL}else{pl[f].width+=ht.ColumnSpace;pl[f].flags|=tc.FRAME_LINE_BET_COL}pl[f].height=ht.FrameHt;pl[f].ScrHeight=Ot.FrameHt;pl[f].TextHeight=Ot.FrameHt;if(S)pl[f].LastColumnFrame=true;f++;lW(f)}}It=false;b=y;if(p&&!h)ht.FrameHt=Ot.FrameHt=0;if(Dj(V)&&I<Ri&&ht.CurColHeight+ht.FrameHt+Tt>s&&(ht.CurColHeight>0||ht.FrameHt>0)&&F==P&&I<=F&&T>=_&&!Po&&Dj(po[e+1].flags&tc.PAGE_HARD)){po[e].LastLine=I-1;po[e+1].FirstLine=I;po[e+1].flags=cj(po[e+1].flags,tc.PAGE_HARD);F=P=I-1}ht.CurColHeight+=ht.FrameHt;Ot.CurColHeight+=Ot.FrameHt;if(ht.CurColHeight>ht.MaxColHeight)ht.MaxColHeight=ht.CurColHeight;if(Ot.CurColHeight>Ot.MaxColHeight)Ot.MaxColHeight=Ot.CurColHeight;if(S)ht.CurColHeight=Ot.CurColHeight=0;ht.FrameHt=Ot.FrameHt=0;if(S){ht.ColumnX=ht.CellX=ht.ColumnX+ht.ColumnWidth+ht.ColumnSpace}if(p)ht.CellX=ht.CellX+st;if(N==0)ht.CellX=ht.ColumnX;if(h)ht.CellX=ht.ColumnX;if(S&&!v){var Fe;for(Fe=f-1;Fe>=l;Fe--){if(pl[Fe].ParaFrameId==0&&pl[Fe].CellId==0)break}if(Fe>=l){pl[f].empty=true;pl[f].PageNo=e;pl[f].LastColumnFrame=true;pl[f].y=pl[Fe].y+pl[Fe].height;pl[f].ScrY=pl[Fe].ScrY+pl[Fe].ScrHeight;pl[f].x=pl[Fe].x;pl[f].width=pl[Fe].width;pl[f].height=0;pl[f].ScrHeight=0;pl[f].sect=pl[f-1].sect;if(!Ci&&(_==1||T==_))pl[f].flags|=tc.FRAME_RIGHTMOST;f++;lW(f)}}_t=T;if(S&&_t<_&&Nj(to[ht.sect].flags&tc.SECT_VAR_COL_WIDTH)){ht.ColumnWidth=DV(to[ht.sect].ColWidth[_t]);ht.ColumnSpace=DV(to[ht.sect].ColSpace[_t])}if(S){Bt[_t]=f;Mt[_t]=ht.ColumnX;Gt[_t]=ht.ColumnWidth;ne[_t]=ht.y;if(_t>0){for(Jt=Bt[_t-1];Jt<f;Jt++){if(pl[Jt].y+pl[Jt].height>ne[_t])ne[_t]=pl[Jt].y+pl[Jt].height}}if(_t<_){ht.y=kt;Ot.y=Xt}if(_>1&&_t<_){var ge=false;var Pe=0;if(I<Ri){if(ui[I].cid==0){if(I>0&&ui[I].page==e&&I<=F)I--}else{for(;I>g;I--){if(ui[I].page!=e)continue;if(ui[I].cid==0)break}}for(ie=F;ie>g;ie--){if(ui[ie].fid>0)continue;if(ui[ie].col==_t)break}}if((Pe=az(e,I,ge))>0){ge=hF;if(ge)ht.y-=Pe;Pe=wy(e,_t,f,ht.y,ht.ColumnX);f=gF;ht.y+=Pe;Ot.y+=yV(Pe)}H=-1;B=0;U=0;N=M=0;Lt=false;Ct=false;b=-1;fe=true}}if(I>F){if(!S){T++;if(!Ci&&f>0)pl[f-1].flags|=tc.FRAME_RIGHTMOST}if(et>0){Uy(et,ht,Ot,vt,pt,f,I,W,e,F,j);ht=xF.copy();Ot=bF.copy();vt=yF.copy();pt=WF.copy();f=gF}break}}if(bt)continue;if(I<Ri&&Nj(ui[I].flags2&tc.LFLAG2_PICT_TEXT))Ql=PW(I,ht.TopSect);if(Xl!=et){Uy(et,ht,Ot,vt,pt,f,I,W,e,F,j);ht=xF.copy();Ot=bF.copy();vt=yF.copy();pt=WF.copy();f=gF;It=Xl>0?true:false;dt=It?f-1:0}if(Xl==0)dt=0;if(I<Ri&&L6(I)>0){var Se;jt=0;var he,Oe;he=E6(0,I);Oe=eR[he].row;Se=ht.ColumnX+DV($E[Oe].indent);for(jt=$E[Oe].FirstCell;jt>0&&jt!=he;jt=eR[jt].NextCell)Se+=DV(eR[jt].width);I=qy(I,0,f,At,Se,e,ht.sect,ht.y+ht.CurColHeight+ht.FrameHt,Ot.y+Ot.CurColHeight+Ot.FrameHt,ht.HiddenY,ht.HdrMargin,ht.HdrHeight,ht.TopSect,ht.TopLeftMargin,_t,q,j,dt,ui[I].fid,true);f=gF;At=UF;q=XF;if(_>1&&_t+1<_&&I>ie){for(I=g;I<=ie;I++)if(ui[I].page==e&&ui[I].col==_t+1)break;if(I>0)I--;ae=true}ht.FrameHt+=At;Ot.FrameHt+=yV(At);continue}if(I<Ri){le=true;if(ui[I].fid==0&&_>1&&ui[I].col<_t)le=false;if(le){ky(I,ht.y,Ot.y,ht.FrameHt,Ot.FrameHt,ht.CurColHeight,ht.CellX,ot,e,ht.HiddenY,ht.HdrMargin,ht.HdrHeight,ht.TopSect,ht.TopLeftMargin,_t,q,ht.sect,Tt,b,ht.ColumnX);ht.FrameHt=OF;Ot.FrameHt=vF;ot=Tg;q=XF}}}Dl=f;o=k=0;for(Jt=l;Jt<Dl;Jt++){if(pl[Jt].LastColumnFrame&&pl[Jt].y+pl[Jt].height>o)o=pl[Jt].y+pl[Jt].height;if(pl[Jt].LastColumnFrame&&pl[Jt].ScrY+pl[Jt].ScrHeight>k)k=pl[Jt].ScrY+pl[Jt].ScrHeight}if(j==tc.PASS_BODY&&T>=2){if(Ci)A=Ei*eo[ht.TopSect].PgHeight+rr-ht.FtrMargin-ht.FtrHeight;else{if(yR)A=X-ht.FtrMargin;else A=X}if(o>Ze+A)o=Ze+A}if(_>1){var ve=0;if(T>0&&T<=_){for(Jt=Bt[T-1];Jt<f;Jt++){if(pl[Jt].y+pl[Jt].height>ne[T-1])ne[T-1]=pl[Jt].y+pl[Jt].height}}for(Jt=0;Jt<T;Jt++)if(ne[Jt]>ve)ve=ne[Jt];for(Jt=0;Jt<T;Jt++){if(ne[Jt]<ve){pl[f].empty=true;pl[f].PageNo=e;pl[f].y=ne[Jt];pl[f].ScrY=yV(ne[Jt]);pl[f].x=Mt[Jt];pl[f].width=Gt[Jt];pl[f].height=ve-ne[Jt];pl[f].ScrHeight=yV(pl[f].height);pl[f].sect=ht.sect;pl[f].LastColumnFrame=true;if(!Ci)pl[Jt].flags|=tc.FRAME_RIGHTMOST;f++;lW(f);Dl=f}}ht.MaxColHeight=ve-ht.y}if(T<_){if(T>0){Jt=0;for(Jt=Bt[T-1];Jt<f;Jt++)pl[Jt].flags=cj(pl[Jt].flags,tc.FRAME_LINE_BET_COL)}pl[f].empty=true;pl[f].PageNo=e;pl[f].y=ht.y;pl[f].ScrY=Ot.y;pl[f].x=ht.ColumnX;pl[f].width=K-er-ht.ColumnX;pl[f].height=ht.MaxColHeight;pl[f].ScrHeight=Ot.MaxColHeight;pl[f].sect=ht.sect;pl[f].LastColumnFrame=true;if(!Ci)pl[f].flags|=tc.FRAME_RIGHTMOST;ht.ColumnX+=pl[f].width;Gt[T]=ht.ColumnWidth*(_-T)+ht.ColumnSpace*(_-T-1);_=T+1;f++;lW(f);Dl=f}if(_>1&&uZ(tc.FLOW_DEF,tc.FLOW_DEF,to[ht.sect].flow,mr))yy(Bt,Mt,Gt,ht.ColumnSpace,f,_);ht.y+=ht.MaxColHeight;Ot.y+=Ot.MaxColHeight;if(F<P){g=F+1;continue f}break}}ht.sect=ht.TopSect;if(q)FW(e,ht.HiddenY,ht.HdrMargin,ht.TopLeftMargin,ht.HdrHeight,ht.TopSect,Pt,P,V);if(j==tc.PASS_BODY){var pe=J,Ne,De;for(Jt=z;Jt<Dl;Jt++){if(pl[Jt].empty||pl[Jt].height==0)continue;if(pl[Jt].ParaFrameId!=0){Qt=pl[Jt].ParaFrameId;if(kl[Qt].pict==0)De=pl[Jt].BoxFrame;else De=Jt}else De=Jt;Ne=pl[De].y+pl[De].height;if(Ne>pe)pe=Ne}po[e].BodyTextHt=pe-J}if(j==tc.PASS_TBL_HDR)continue e;lW(Dl);pl[Dl].empty=true;pl[Dl].y=ht.y;pl[Dl].ScrY=Ot.y;pl[Dl].width=c;pl[Dl].x=0;if(Dl==0)pl[Dl].sect=0;else pl[Dl].sect=pl[Dl-1].sect;if(Ci){pl[Dl].x=er+ht.TopLeftMargin;pl[Dl].width+=ft;if(Nj(V&tc.PAGE_HDR)){A=rr+ht.HdrMargin+ht.HdrHeight;if(St!=ht.TopSect&&to[ht.TopSect].TopMargin>to[St].TopMargin){if(A<rr+to[ht.TopSect].TopMargin*tg.UNITS_PER_INCH)A=rr+to[ht.TopSect].TopMargin*tg.UNITS_PER_INCH}}else if(Nj(V&tc.PAGE_FTR))A=Ei*eo[ht.sect].PgHeight*Oz()+rr-ht.FtrMargin;else{A=Ei*eo[ht.sect].PgHeight*Oz()+rr-ht.FtrMargin-ht.FtrHeight;if(!yR)A+=ht.FtrHeight}if(Nj(V&tc.PAGE_HDR))pl[Dl].flags|=tc.FRAME_DIVIDER_LINE;if(yR&&Dj(V))pl[Dl].flags|=tc.FRAME_DIVIDER_LINE}else{if(Nj(V&tc.PAGE_HDR)){A=ht.HdrMargin-ht.HiddenY+ht.HdrHeight;if(St!=ht.TopSect&&to[ht.TopSect].TopMargin>to[St].TopMargin){if(A<to[ht.TopSect].TopMargin*tg.UNITS_PER_INCH-ht.HiddenY)A=to[ht.TopSect].TopMargin*tg.UNITS_PER_INCH-ht.HiddenY}}else if(Nj(V&tc.PAGE_FTR))A=X;else{if(yR)A=X+ht.HiddenY-ht.FtrMargin-ht.FtrHeight;else A=X}pl[Dl].flags|=tc.FRAME_RIGHTMOST|tc.FRAME_DIVIDER_LINE;if(po[e].FnoteHt>0&&Dj(V))pl[Dl].flags=cj(pl[Dl].flags,tc.FRAME_DIVIDER_LINE)}if(Nj(Zh&tc.TFLAG2_HIDE_PAGE_BREAK)&&!Eu&&!Ci&&Dj(to[ht.TopSect].flags&(tc.SECT_VALIGN_CTR|tc.SECT_VALIGN_BOT))||oi.FittedView&&(e>=To-1||Dj(po[e+1].flags&tc.PAGE_HARD))){pl[Dl].height=pl[Dl].ScrHeight=0;if(ht.y<rt)pl[Dl].height=rt-ht.y;if(Ot.y<it)pl[Dl].ScrHeight=it-Ot.y}else{pl[Dl].height=A-(ht.y-Ze);pl[Dl].ScrHeight=yV(A)-(Ot.y-Y);if(Dj(V)&&po[e].FnoteHt>0){pl[Dl].height-=po[e].FnoteHt;pl[Dl].ScrHeight-=yV(po[e].FnoteHt)}if(false&&!Eu){if(pl[Dl].height<mV(40))pl[Dl].height=mV(40);if(pl[Dl].ScrHeight<hV(40))pl[Dl].ScrHeight=hV(40)}if(false&&Eu&&j==tc.PASS_HDR&&Nj(to[ht.TopSect].flags&tc.SECT_EXACT_MARGT)&&pl[Dl].height<0){pl[Dl].height=0;pl[Dl].ScrHeight=0}}ht.y+=pl[Dl].height;Ot.y+=pl[Dl].ScrHeight;if(j==tc.PASS_BODY&&Ht>=0&&pl[Dl].height>0){zt=pl[Dl].height;if(Nj(to[ht.TopSect].flags&tc.SECT_VALIGN_CTR))zt=zt/2;pl[Ht].height=zt;pl[Ht].ScrHeight=yV(zt);for(Jt=Ht+1;Jt<=Dl;Jt++){pl[Jt].y+=zt;pl[Jt].ScrY+=yV(zt)}pl[Dl].height-=zt;pl[Dl].ScrHeight-=yV(zt)}if(j==tc.PASS_BODY)tr=HV(pl[Dl].height);Dl++;lW(Dl);if(Dj(V)&&po[e].FnoteHt>0){Zy(e,ht.y,Ot.y,c,ht.TopLeftMargin,ft);ht.y=IF;Ot.y=FF}po[e].flags=cj(po[e].flags,tc.PAGE_BOXED);if(Ci||Eu){if(!yR||Nj(V&tc.PAGE_FTR))zy(e,Ft,gt,ht.TopSect,nt)}if(j==tc.PASS_HDR&&Nj(to[ht.TopSect].flags&tc.SECT_EXACT_MARGT)){qt=Fz(e,true,true)-Fz(e,false,true);ht.y-=qt;Ot.y-=yV(qt);if(Nj(qt))$r=true}if(j==tc.PASS_BODY&&Nj(to[ht.TopSect].flags&tc.SECT_EXACT_MARGB)){qt=gz(e,true)-gz(e,false);ht.y-=qt;Ot.y-=yV(qt);if(Nj(qt))$r=true}}if(j<=tc.MAX_PASSES&&Dl>Kt)Kt=Dl;if(j<tc.MAX_PASSES)continue e;else if(Ql>0){xt++;if(xt==0){Wt=ht.y;Ut=Ot.y}while(xt<Ql){Qt=Zl[xt];if(kl[Qt].PageNo==e+1)xt++;else break}if(xt<Ql)continue e;ht.y=Wt;Ot.y=Ut}break}if(Ci){if(true||!yR||Nj(V&tc.PAGE_FTR)){Jy(e,ht.y,Ot.y,nt,ct);ht.y=IF;Ot.y=FF;if(Dl>Kt)Kt=Dl}}if(e<r||qe==r){Qe=Dl;if(Dl>0){if(Dl>0){if(Kt>0){Ze=pl[Kt-1].y+pl[Kt-1].height;Y=pl[Kt-1].ScrY+pl[Kt-1].ScrHeight}else{Ze=pl[Dl-1].y+pl[Dl-1].height;Y=pl[Dl-1].ScrY+pl[Dl-1].ScrHeight}}}else Ze=Y=0}if(e==qe||Dl==0)po[e].ScrHt=Y;else po[e].ScrHt=pl[Dl-1].ScrY+pl[Dl-1].ScrHeight-Y;po[e].TextHt=0;for(Jt=m;Jt<Dl;Jt++){var Me=!pl[Jt].empty&&Dj(pl[Jt].flags&tc.FRAME_DISABLED)&&pl[Jt].ScrY+pl[Jt].TextHeight>po[e].TextHt;if(Nj(pl[Jt].flags&tc.FRAME_FNOTE))Me=true;if(pl[Jt].ParaFrameId!=0)pl[Jt].TextHeight=pl[Jt].ScrHeight;if(Me)po[e].TextHt=pl[Jt].ScrY+pl[Jt].TextHeight}if(m>=Qe)po[e].TextHt-=yV(Ze);if(mt!=po[e].FrameCount)po[e].flags|=tc.PAGE_REPAGE;e++;if(e<=r&&e<To)continue t;break}for(Jt=0;Jt<Dl;Jt++){jt=pl[Jt].CellId;if(jt>0)rR[jt].FrameId=Jt}for(Jt=0;Jt<Dl;Jt++){if(Ci){var Ge=Ai*eo[ht.TopSect].PgWidth;var Be=Ai*to[pl[Jt].sect].LeftMargin;ht.TopLeftMargin=Jt<Qe?lt:at;if(pl[Jt].ParaFrameId==0&&pl[Jt].level==0&&pl[Jt].x==er+ht.TopLeftMargin&&(pl[Jt].CellId==0||pl[Jt].empty)){pl[Jt].x=er;pl[Jt].SpaceLeft+=Be;pl[Jt].width+=Be;if(pl[Jt].width>Ge)pl[Jt].width=Ge}}if(pl[Jt].CellId>0){jt=pl[Jt].CellId;$t=eR[jt].row;te=Jt>=Qe?qe+1:qe;if(eR[jt].RowSpan>1){C=d8(jt,te);if(tR[$t].LastPage>tR[$t].FirstPage&&tR[$t].LastPage==pl[Jt].PageNo){if(C>pl[Jt].height){pl[Jt].height=C;pl[Jt].ScrHeight=yV(C)}}else{pl[Jt].height+=C;pl[Jt].ScrHeight+=yV(C)}}else if(Nj(eR[jt].flags&tc.CFLAG_ROW_SPANNED)){Vt=rR[jt].SpanningCell;if(rR[Vt].LastPage>=e){pl[Jt].height=0;pl[Jt].ScrHeight=0}else if(pl[Jt].height==0){if(eR[jt].PrevCell>0&&Nj(eR[jt].flags&tc.CFLAG_ROW_SPANNED)&&Jt>0&&pl[Jt-1].CellId==eR[jt].PrevCell)pl[Jt].height=pl[Jt-1].height}}if(eR[jt].level==0&&po[te].LastRowEndY>pl[Jt].y&&by(jt,te)){u=pl[Jt].sect;if(to[u].columns==1){pl[Jt].height=po[te].LastRowEndY-pl[Jt].y;pl[Jt].ScrHeight=yV(pl[Jt].height)}}if(Nj(eR[jt].flags&tc.CFLAG_ROW_SPANNED)){Vt=rR[jt].SpanningCell;var He=ui[pl[Jt].PageFirstLine].pfmt;if(pl[Jt].empty)He=0;if(Vt>0&&Vt<fR&&Dj(Nc[He].flags&tc.PAGE_HDR_FTR)){var me=rR[Vt].LastPage;if(me<te)pl[Jt].flags|=tc.FRAME_TOP_SPAN;if($t!=po[te].FirstRow){pl[Jt].border=cj(pl[Jt].border,tc.BORDER_TOP);pl[Jt].BorderWidth[tc.BORDER_INDEX_TOP]=0}if(Dj(eR[jt].flags&tc.CFLAG_ROW_SPANNED_LAST)&&$t!=po[te].LastRow){pl[Jt].border=cj(pl[Jt].border,tc.BORDER_BOT);pl[Jt].BorderWidth[tc.BORDER_INDEX_BOT]=0}}}}if(pl[Jt].CellId>0&&!pl[Jt].empty){jt=pl[Jt].CellId;$t=eR[jt].row;te=Jt>=Qe?qe+1:qe;if(eR[jt].TextAngle!=0){pl[Jt].SpaceLeft=pl[Jt].SpaceTop;pl[Jt].SpaceRight=pl[Jt].SpaceBot;if(eR[jt].TextAngle==90){pl[Jt].SpaceTop=x6(jt);pl[Jt].SpaceBot=y6(jt)}else{pl[Jt].SpaceTop=y6(jt);pl[Jt].SpaceBot=x6(jt)}if(pl[Jt].SpaceTop<20)pl[Jt].SpaceTop=20;pl[Jt].SpaceTop=DV(pl[Jt].SpaceTop);pl[Jt].SpaceBot=DV(pl[Jt].SpaceBot)}if(Nj(eR[jt].flags&(tc.CFLAG_VALIGN_CTR|tc.CFLAG_VALIGN_BOT|tc.CFLAG_VALIGN_BASE))&&Dj($E[$t].flags&tc.ROWFLAG_SPLIT)&&Dj(eR[jt].flags&tc.CFLAG_HAS_FRAMES)){var we;zt=0;var be,xe=0;var ye=false;for(we=pl[Jt].PageFirstLine;we<=pl[Jt].PageLastLine;we++){if(ui[we].cid!=jt){ee=ui[we].cid;re=0;var We=eR[ee].row;if(eR[ee].ParentCell!=jt)continue;if(We==xe)continue;re=rR[ee].FrameId;if(pl[Jt].PageNo!=pl[re].PageNo)continue;if(we==pl[re].PageLastLine){zt+=pl[re].height+$E[We].FrmSpcBef;xe=We}ye=true;continue}zt+=ui[we].height;if(L6(we)>pl[Jt].level)ye=true}if(true||!ye){if(Nj(eR[jt].flags&tc.CFLAG_VALIGN_BASE))pl[Jt].SpaceTop+=rR[jt].SpaceBefore;else{if(eR[jt].TextAngle==0)be=pl[Jt].height-zt-pl[Jt].SpaceTop-pl[Jt].SpaceBot;else be=pl[Jt].width-zt-pl[Jt].SpaceTop-pl[Jt].SpaceBot;if(Nj(eR[jt].flags&tc.CFLAG_VALIGN_CTR))be=be/2;be-=mV(40);if(be>0){if(true||eR[jt].TextAngle==0){for(we=pl[Jt].PageFirstLine;we<=pl[Jt].PageLastLine;we++){if(ui[we].cid!=jt){ee=ui[we].cid;re=0;re=rR[ee].FrameId;if(pl[Jt].PageNo!=pl[re].PageNo)continue;if(pl[re].empty||GY(we,tc.INFO_CELL))pl[re].y+=be}}pl[Jt].SpaceTop+=be}else if(eR[jt].TextAngle==90)pl[Jt].SpaceLeft+=be;else if(eR[jt].TextAngle==270)pl[Jt].SpaceRight+=be}}}}var Ue=$E[$t].MinHeight<0;pl[Jt].LimitY=pl[Jt].y+pl[Jt].height;if(eR[jt].level!=0){pl[Jt].LimitY=xy(Jt,jt,pl[Jt].LimitY,Ue);Ue=KF}if(!Ue||Nj(tO&tc.TFLAG6_ALLOW_CELL_OVERFLOW))pl[Jt].LimitY=-1;rR[jt].FrameId=Jt}if(oi.FittedView&&pl[Jt].CellId==0&&!pl[Jt].empty&&!Eu&&Dj(pl[Jt].flags&tc.FRAME_NON_TEXT_DO)){var ke;for(I=pl[Jt].PageFirstLine;I<=pl[Jt].PageLastLine;I++){ke=ib(I,0);if(Nj(zh&tc.TFLAG_NO_WRAP)||Nj(Nc[ui[I].pfmt].pflags&tc.PFLAG_NO_WRAP)){Zt=B$(I,false,false);if(pl[Jt].width<Zt)pl[Jt].width=Zt}else if(ke>=0&&ke<Ys&&Nj(xs[ke].style&tc.PICT)){Zt=DV(xs[ke].PictWidth);if(pl[Jt].width<Zt)pl[Jt].width=Zt}}}if(pl[Jt].CellId>0){jt=pl[Jt].CellId;var Xe;var Ke,Ye;$t=eR[jt].row;if((!pl[Jt].empty||Nj(pl[Jt].flags1&tc.FRAME1_PART_EMPTY_CELL))&&(Ye=c8(jt))>0){Ye/=2;Ye=DV(Ye);pl[Jt].x+=Ye;pl[Jt].width-=2*Ye;pl[Jt].y+=Ye;pl[Jt].height-=2*Ye;pl[Jt].SpaceTop-=Ye;pl[Jt].SpaceBot-=Ye;pl[Jt].SpaceLeft-=Ye;pl[Jt].SpaceRight-=Ye;if((Ke=rR[jt].LeftOlSpace)>0){Ke=DV(Ke);pl[Jt].x+=Ke;pl[Jt].width-=Ke;pl[Jt].SpaceLeft-=Ke}if((Ke=rR[jt].RightOlSpace)>0){Ke=DV(Ke);pl[Jt].width-=Ke;pl[Jt].SpaceRight-=Ke}if((Ke=rR[jt].TopOlSpace)>0){Ke=DV(Ke);pl[Jt].y+=Ke;pl[Jt].height-=Ke;pl[Jt].SpaceTop-=Ke}if((Ke=rR[jt].BotOlSpace)>0){Ke=DV(Ke);pl[Jt].height-=Ke;pl[Jt].SpaceBot-=Ke}pl[Jt].border=eR[jt].border;for(Xe=0;Xe<4;Xe++){pl[Jt].BorderWidth[Xe]-=$E[$t].CellSpacing;if(pl[Jt].BorderWidth[Xe]<0)pl[Jt].BorderWidth[Xe]=0}pl[Jt].CellSpacing=Ye}}if(pl[Jt].ParaFrameId>0){Qt=pl[Jt].ParaFrameId;if(Dj(kl[Qt].flags2&tc.PF2_INLINE)&&Dj(kl[Qt].flags&tc.PARA_FRAME_HPAGE)&&Nj(kl[Qt].flags&(tc.PARA_FRAME_HCOL|tc.PARA_FRAME_HCHAR))&&Nj(kl[Qt].flags&tc.PARA_FRAME_WRAP_IGNORE)){NW(Jt,ht.TopLeftMargin)}}if(!pl[Jt].empty&&Dj(pl[Jt].flags&tc.FRAME_PICT)){for(I=pl[Jt].PageFirstLine;I<=pl[Jt].PageLastLine;I++){if(pl[Jt].CellId!=ui[I].cid)continue;ui[I].frame=Jt}}if(!pl[Jt].empty&&yR&&Dj(WR)&&Nj(Nc[ui[pl[Jt].PageFirstLine].pfmt].flags&tc.PAGE_HDR_FTR))pl[Jt].flags|=tc.FRAME_DISABLED;if(Nj(Qh&tc.TFLAG3_SHOW_FRAMES))pl[Jt].border=tc.BORDER_ALL;pl[Jt].OrigX=pl[Jt].x}for(Jt=0;Jt<Dl;Jt++)Wy(Jt);for(Jt=0;Jt<Dl;Jt++){pl[Jt].ScrFirstLine=-1;pl[Jt].ScrLastLine=-1;pl[Jt].RowOffset=0;pl[Jt].ScrWidth=0;if(!pl[Jt].empty)ui[pl[Jt].PageFirstLine].flags2|=tc.LFLAG2_FRAME_TOP;if(!pl[Jt].empty&&!oi.FittedView){u=ht.TopSect;Qt=pl[Jt].ParaFrameId;if(Qt>0){var Ve=kl[Qt].ParaY>eo[u].PgHeight*Oz()*1440||kl[Qt].x>eo[u].PgWidth*1440;if(Ve)pl[Jt].empty=true}}}fa[0]=ra[0]=ia[0]=0;ze=0;for(Jt=0;Jt<Dl;Jt++){zt=pl[Jt].y+pl[Jt].height;if(zt>ze&&pl[Jt].ParaFrameId==0)ze=zt}if(i)tW();if(!t)Xy();if(!oi.PageMode){Dl=1;lW(0);pl[0].ScrFirstLine=pl[0].ScrLastLine=fr;pl[0].RowOffset=0;pl[0].PageFirstLine=0;pl[0].PageLastLine=Ri-1;pl[0].ScrFirstLine=pl[0].ScrLastLine=fr}ZU("CreateFrames - End");return}function my(t){var e,r;var i=Ri!=ke;var f;f=i||t||Dl==1||Nj(aO&tc.TOFLAG_FULL_PAINT)||Nj(nO&tc.TOFLAG2_FRAME_REFRESH);if(!Ii)return true;e=Lo;r=Lo+1;if(Lo>=qe&&Lo<=$e){if(qe==$e)By(false,Lo,Lo+1);else{var l=Gt+Mt/2;if(Lo==qe){if(l<Ze/2&&Lo>0){e=Lo-1;r=Lo;if(f||(e!=qe||r!=$e)){By(false,e,r)}Gt+=Ze;BG()}else{if(f||(e!=qe||r!=$e)){By(false,e,r)}}}else{var a=(ze-Ze)/2+Ze;if(l>a&&Lo+1<To){Gt-=Ze;if(Gt<0)Gt=0;if(f||(e!=qe||r!=$e)){By(false,e,r)}BG()}else{e=Lo-1;r=Lo;if(f||(e!=qe||r!=$e)){By(false,e,r)}}}}}else By(false,Lo,Lo+1);ke=Ri;uj(tc.TOFLAG2_FRAME_REFRESH);return true}function wy(t,e,r,i,f){var l=-1,a=-1,n;var c,s,_,o;for(n=r-1;n>=0;n--){if(pl[n].PageNo<t)break;if(pl[n].ParaFrameId>0)break;c=pl[n].CellId;if(c==0&&!pl[n].empty)break;s=eR[c].row;if(eR[c].level==0&&Nj($E[s].flags&tc.ROWFLAG_HDR)){if(a==-1)a=n;l=n}else if(a!=-1)break}if(a==-1)return 0;_=pl[l].y;o=pl[l].x;for(n=l;n<=a;n++){pl[r]=pl[n].copy();pl[r].y=i+pl[n].y-_;pl[r].x=f+pl[n].x-o;r++;lW(r)}gF=r;return pl[a].y+pl[a].height-pl[l].y}function by(t,e){var r,i=eR[t].row;var f=eR[t].level;var l=R6(f,po[e].LastRow);if(i==l)return true;else{if(eR[t].RowSpan==1)return false;else{for(r=$E[l].FirstCell;r>0;r=eR[r].NextCell)if(rR[r].SpanningCell==t)break;if(r>0)return true}}return false}function xy(t,e,r,i){var f,l,a=r;KF=i;e=eR[e].ParentCell;if(e<=0)return r;if(eR[e].RowSpan>1)return r;l=eR[e].row;if($E[l].MinHeight<0){var n=0;var c=Qe-1;if(t>Qe){n=Qe;c=Dl-1}for(f=n;f<=c;f++)if(pl[f].CellId==e)break;if(f<=c){if(pl[f].y+pl[f].height<a)a=pl[f].y+pl[f].height;t=f}i=true}KF=i;return xy(t,e,a,i)}function yy(t,e,r,i,f,l){var a,n,c,s=0,_,o,u,T,A;for(a=0;a<l;a++){if(a+1<l)r[a]+=i;s+=r[a]}u=s;for(a=0;a<l;a++){if(a+1<l)c=t[a+1]-1;else c=f-1;A=r[a];u=u-r[a];o=e[a]-e[0];T=u+e[0];for(n=t[a];n<=c;n++){if(pl[n].ParaFrameId>0)continue;_=pl[n].x-e[a];pl[n].x=T+_;if(pl[n].CellId==0){pl[n].width=A;pl[n].SpaceLeft=pl[n].SpaceRight=0;if(a+1<l)pl[n].SpaceLeft=i}else if(a!=0){pl[n].x-=i;if(Ci)pl[n].x-=i}}}return true}function Wy(t){var e;var r,i,f,l,a,n,c;if(false&&pl[t].ParaFrameId>0){var s;var _=pl[t].ParaFrameId;if(Nj(kl[_].flags&tc.PARA_FRAME_TEXT_BOX)||kl[_].ShapeType==tc.SHPTYPE_TEXT_BOX)return true;if(Dj(kl[_].flags&(tc.PARA_FRAME_HCOL|tc.PARA_FRAME_HCHAR)))return true;s=pl[t].PageFirstLine;if(s<0||s>=Ri)return true;n=ui[s].cid}else n=pl[t].CellId;if(n==0||Nj(pl[t].flags&tc.FRAME_RTL_CHECKED))return true;pl[t].flags|=tc.FRAME_RTL_CHECKED;f=eR[n].row;e=uZ(tc.FLOW_DEF,$E[f].flow,tc.FLOW_DEF,mr);if(e){r=$E[f].FirstFrame;l=pl[r].OrigX;i=$E[f].LastFrame;if(i<0)return true;a=pl[i].OrigX+pl[i].width-l;if(eR[n].level==0&&Ci){var o=pl[t].sect;a+=to[o].RightMargin*Ai}c=pl[t].OrigX-l;c=a-c-pl[t].width;if(eR[n].level>0){var u=eR[n].ParentCell;var T=rR[u].FrameId;if(Dj(pl[T].flags&tc.FRAME_RTL_CHECKED))Wy(T);pl[t].x=pl[T].x+pl[T].SpaceLeft+c}else pl[t].x=pl[r].OrigX+c;pl[t].flags|=tc.FRAME_RTL;$E[f].flags|=tc.ROWFLAG_RTL}else $E[f].flags=cj($E[f].flags,tc.ROWFLAG_RTL);return true}function Uy(t,e,r,i,f,l,a,n,c,s,_){var o=l,u,T;var A=0,E,R;var L;var C=false;var I=0,d=0;var F;xF=e.copy();bF=r.copy();yF=i.copy();WF=f.copy();gF=l;if(Xl>0){if(t==0){i=e.copy();f=r.copy()}else{e=i.copy();r=f.copy()}if(a>s&&_>=tc.MAX_PASSES)return true;jl=true;po[c].FrameCount++;pl[o].empty=true;pl[o].PageNo=c;pl[o].sect=e.sect;pl[o].PageFirstLine=kl[t].TextLine=a;pl[o].PageLastLine=a;pl[o].ParaFrameId=Xl;pl[o].ZOrder=kl[Xl].ZOrder;pl[o].flags|=n;pl[o].flags1|=tc.FRAME1_PARA_FRAME_BOX;pl[o].BoxFrame=o;kl[Xl].TextLine=a;if(Nj(kl[Xl].flags&(tc.PARA_FRAME_LINE|tc.PARA_FRAME_RECT))){pl[o].flags|=tc.FRAME_NON_TEXT_DO;pl[o].empty=false}if(Nj(kl[Xl].flags&tc.PARA_FRAME_OBJECT)&&kl[Xl].FillPattern==0)pl[o].flags|=tc.FRAME_TRANSPARENT;L=0;if(Nj(kl[Xl].flags&tc.PARA_FRAME_OBJECT)){if(Nj(kl[Xl].flags&tc.PARA_FRAME_BOXED))L=tc.PARA_BOX;else L=0}else{d=ui[pl[o].PageLastLine].cid;if(d==0){A=ui[pl[o].PageLastLine].pfmt;L=Nc[A].flags;pl[o].shading=Nc[A].shading/100;pl[o].BackColor=Nc[A].BkColor;if(Nj(L&tc.PARA_BOX)){C=true;BorderSpaceLeft=DV(Nc[A].BorderSpaceLeft);BorderSpaceRight=DV(Nc[A].BorderSpaceRight);BorderSpaceTop=mV(Nc[A].BorderSpaceTop);BorderSpaceBot=mV(Nc[A].BorderSpaceBot)}}}for(E=0;E<4;E++)pl[o].BorderWidth[E]=0;if(Nj(L&tc.PARA_BOX)){var g=1;if(Nj(L&tc.PARA_BOX_LEFT))pl[o].border|=tc.BORDER_LEFT;if(Nj(L&tc.PARA_BOX_RIGHT))pl[o].border|=tc.BORDER_RIGHT;if(Nj(L&tc.PARA_BOX_TOP))pl[o].border|=tc.BORDER_TOP;if(Nj(L&tc.PARA_BOX_BOT))pl[o].border|=tc.BORDER_BOT;if(Nj(kl[Xl].flags&(tc.PARA_FRAME_TEXT_BOX|tc.PARA_FRAME_RECT))){g=kl[Xl].LineWdth;if(g<1)g=1;pl[o].BorderWidth[tc.BORDER_INDEX_TOP]=g;pl[o].BorderWidth[tc.BORDER_INDEX_BOT]=g;pl[o].BorderWidth[tc.BORDER_INDEX_LEFT]=g;pl[o].BorderWidth[tc.BORDER_INDEX_RIGHT]=g}else{if(Nj(L&(tc.PARA_BOX_THICK|tc.PARA_BOX_DOUBLE)))g=2;if(Nj(L&tc.PARA_BOX_TOP))pl[o].BorderWidth[tc.BORDER_INDEX_TOP]=tc.FRAME_BORDER_WIDTH*g;if(Nj(L&tc.PARA_BOX_BOT))pl[o].BorderWidth[tc.BORDER_INDEX_BOT]=tc.FRAME_BORDER_WIDTH*g;if(Nj(L&tc.PARA_BOX_LEFT))pl[o].BorderWidth[tc.BORDER_INDEX_LEFT]=tc.FRAME_BORDER_WIDTH*g;if(Nj(L&tc.PARA_BOX_RIGHT))pl[o].BorderWidth[tc.BORDER_INDEX_RIGHT]=tc.FRAME_BORDER_WIDTH*g}}if(kl[Xl].TopMarg>pl[o].BorderWidth[tc.BORDER_INDEX_TOP])pl[o].SpaceTop=mV(kl[Xl].TopMarg);else pl[o].SpaceTop=mV(pl[o].BorderWidth[tc.BORDER_INDEX_TOP]);if(kl[Xl].BotMarg>pl[o].BorderWidth[tc.BORDER_INDEX_BOT])pl[o].SpaceBot=mV(kl[Xl].BotMarg);else pl[o].SpaceBot=mV(pl[o].BorderWidth[tc.BORDER_INDEX_BOT]);zW(Xl);u=hI;T=OI;pl[o].SpaceTop+=DV(vI);pl[o].SpaceBot+=DV(pI);pl[o].height=mV(kl[Xl].MinHeight);pl[o].ScrHeight=hV(kl[Xl].MinHeight);pl[o].height=mV(kl[Xl].MinHeight);pl[o].ScrHeight=hV(kl[Xl].MinHeight);if(kl[Xl].ShapeType==tc.SHPTYPE_TEXT_BOX)R=kl[Xl].AnchorY;else R=e.y+e.CurColHeight;$W(Xl,o,R,e.HiddenY,e.HdrMargin,e.HdrHeight,e.TopSect,a,c);pl[o].y=pl[o].y;pl[o].ScrY=pl[o].ScrY;if(Po){kl[Xl].flags|=tc.PARA_FRAME_POSITIONED;kl[Xl].InUse=true}kl[Xl].y=HV(pl[o].y-Ze);if(Nj(kl[Xl].flags&tc.PARA_FRAME_HPAGE))kl[Xl].x=kl[Xl].OrgX-jV(to[e.TopSect].LeftMargin);if(Nj(kl[Xl].flags&tc.PARA_FRAME_HCOL))kl[Xl].x=kl[Xl].OrgX;if(Nj(kl[Xl].flags&tc.PARA_FRAME_HCHAR)){var P=a,S=-1;for(P=a;P<Ri;P++)if(ui[P].fid==0)break;if(P<Ri)S=ui[P].pfmt;kl[Xl].x=kl[Xl].OrgX;if(S>=0){if(Nj(Nc[S].flags&(tc.CENTER|tc.RIGHT_JUSTIFY))){var h=gq(P,0);kl[Xl].x+=h}if(Nc[S].LeftIndentTwips!=0){kl[Xl].x+=Nc[S].LeftIndentTwips}}}pl[o].x=DV(kl[Xl].x);if(Nj(kl[Xl].flags2&tc.PF2_RIGHT_MARG)){var O=po[c].TopSect;pl[o].x+=(eo[O].PgWidth-to[O].LeftMargin-to[O].RightMargin)*Ai}if(kl[Xl].canvas>0){F=kl[Xl].canvas;pl[o].x=DV(kl[F].x+kl[Xl].OrgX)}if(Ci)pl[o].x+=er+e.TopLeftMargin;if(Nj(kl[Xl].flags&tc.PARA_FRAME_TEXT_BOX)&&Nj(kl[Xl].flags&tc.PARA_FRAME_HCOL)){pl[o].x+=pW(Xl,a,c)}pl[o].width=DV(kl[Xl].width);if(kl[Xl].margin>pl[o].BorderWidth[tc.BORDER_INDEX_LEFT])pl[o].SpaceLeft=DV(kl[Xl].margin);else pl[o].SpaceLeft=DV(pl[o].BorderWidth[tc.BORDER_INDEX_LEFT]);if(kl[Xl].margin>pl[o].BorderWidth[tc.BORDER_INDEX_RIGHT])pl[o].SpaceRight=DV(kl[Xl].margin);else pl[o].SpaceRight=DV(pl[o].BorderWidth[tc.BORDER_INDEX_RIGHT]);pl[o].SpaceLeft+=mV(u);pl[o].SpaceRight+=mV(T);if(Nj(kl[Xl].flags&tc.PARA_FRAME_SET_WIDTH)&&(true||a+1==Ri||ui[a].fid==ui[a+1].fid)){var v=0;var p;if(ui[a].cid>0){var N;d=ui[a].cid;while(eR[d].level>0&&eR[d].ParentCell>0)d=eR[d].ParentCell;N=eR[d].row;v=d6(N)+2*kl[Xl].margin;if(true||v>kl[Xl].width)kl[Xl].width=v}else{for(p=a;p<Ri&&ui[p].fid==ui[a].fid;p++)v+=B$(p,true,false);A=ui[a].pfmt;v=MV(v)+2*kl[Xl].margin+tc.MIN_FRAME_MARGIN+Nc[A].LeftIndentTwips+Nc[A].FirstIndentTwips+Nc[A].RightIndentTwips;v+=tc.RULER_TOLERANCE/3;if(v<kl[Xl].width)kl[Xl].width=v}}if(Nj(kl[Xl].flags&(tc.PARA_FRAME_RIGHT_JUST|tc.PARA_FRAME_CENTER))){F=kl[Xl].canvas;if(F>0){if(Nj(kl[Xl].flags&tc.PARA_FRAME_RIGHT_JUST))pl[o].x=kl[F].x-(kl[F].width-kl[Xl].width);else pl[o].x=kl[F].x-(kl[F].width-kl[Xl].width)/2}else{if(Nj(kl[Xl].flags&tc.PARA_FRAME_HPAGE)){kl[Xl].x=eo[e.TopSect].PgWidth*1440-kl[Xl].width;if(Nj(kl[Xl].flags&tc.PARA_FRAME_CENTER))kl[Xl].x/=2;kl[Xl].x-=to[e.TopSect].LeftMargin*1440}else{kl[Xl].x=(eo[e.TopSect].PgWidth-to[e.TopSect].LeftMargin-to[e.TopSect].RightMargin)*1440-kl[Xl].width;if(Nj(kl[Xl].flags&tc.PARA_FRAME_CENTER))kl[Xl].x/=2;if(kl[Xl].x+to[e.TopSect].LeftMargin*1440<3*tc.RULER_TOLERANCE)kl[Xl].x=-(to[e.TopSect].LeftMargin*1440)+3*tc.RULER_TOLERANCE}}pl[o].x=DV(kl[Xl].x);if(Ci)pl[o].x+=er+e.TopLeftMargin}else if(Nj(kl[Xl].flags2&tc.PF2_LEFT)){F=kl[Xl].canvas;var D=kl[Xl].CellId;if(D>0){var M=rR[D].FrameId;if(M>=0&&M<=Dl){kl[Xl].x=MV(pl[M].x);pl[o].x=pl[M].x;pl[o].y=pl[M].y}}else if(F>0)kl[Xl].x=kl[F].x;if(Ci)pl[o].x+=er+e.TopLeftMargin}if(kl[Xl].pict>0&&Nj(kl[Xl].flags2&tc.PF2_CALCX_SET)){pl[o].x=DV(kl[Xl].CalcX);if(Ci)pl[o].x+=er+e.TopLeftMargin}if(C){pl[o].SpaceTop+=BorderSpaceTop;pl[o].SpaceBot+=BorderSpaceBot;pl[o].y-=BorderSpaceTop;pl[o].height+=2*BorderSpaceBot;pl[o].SpaceLeft+=BorderSpaceLeft;pl[o].SpaceRight+=BorderSpaceRight;pl[o].x-=BorderSpaceLeft;pl[o].width+=BorderSpaceLeft+BorderSpaceRight;pl[o].AddedBorderSpace=BorderSpaceLeft}e.y=pl[o].y+pl[o].SpaceTop;r.y=yV(e.y);e.CellX=e.ColumnX=pl[o].x+pl[o].SpaceLeft;e.ColumnWidth=pl[o].width-pl[o].SpaceLeft-pl[o].SpaceRight;e.ColumnSpace=0;e.FrameHt=r.FrameHt=0;e.CurColHeight=r.CurColHeight=0;e.MaxColHeight=r.MaxColHeight=0;o++;lW(o)}else{e=i.copy();r=f.copy()}l=o;xF=e.copy();bF=r.copy();yF=i.copy();WF=f.copy();gF=l;return true}function ky(t,e,r,i,f,l,a,n,c,s,_,o,u,T,A,E,R,L,C,I){var d=i;var F=f;var g=ui[t].fid;OF=i;vF=f;Tg=n;XF=E;if(Nj(g)&&Nj(kl[g].flags&tc.PARA_FRAME_POSITIONED)){ui[t].y=mV(kl[g].y)+d}else ui[t].y=e+l+d-Ze;ui[t].x=a;if(Nj(ui[t].flags&tc.LFLAG_CONTROL))Sr=true;ui[t].flags2=sj(ui[t].flags2,tc.LFLAG2_FRAME_TOP);if(Nj(ui[t].cid)&&eR[ui[t].cid].PrevCell<=0&&(t==0||ui[t].cid!=ui[t-1].cid)){var P=eR[ui[t].cid].row;var S=$E[P].FrmSpcBef;ui[t].y+=S;e+=S;r+=yV(S);n=$E[P].CurIndent}if(Nj(ui[t].cid)&&eR[ui[t].cid].PrevCell<=0)ui[t].x+=n;if(Nj(ui[t].flags&tc.LFLAG_PICT)){var h=ui[t].fid;if(Po&&t<=po[c].LastLine){var O=ui[t].x;if(Ci)O-=er+T;SW(t,O,ui[t].y,s,_,o,u,c,C,I,T)}E=true}if(Dj(ui[t].tabw)||Dj(ui[t].tabw.type&tc.INFO_ROW)){var v=0;if(ui[t].fid==0)v=mW(t,R,true,c);d=d+L+v;F=yV(d);ui[t].y+=v}if(Nj(ui[t].tabw)&&Nj(ui[t].tabw.type&tc.INFO_DYN_FIELD)){var p=Fo;ow(t,c);Fo=p}ui[t].JustAdjX=0;if(Nj(ui[t].flags&tc.LFLAG_ASSUMED_TAB)){if(Nj(ui[t].tabw)&&ui[t].tabw.count>0)ui[t].JustAdjX=ui[t].tabw.width[0]}else if(Nj(Nc[ui[t].pfmt].flags&(tc.CENTER|tc.RIGHT_JUSTIFY))&&!GY(t,tc.INFO_FRAME)){var N=ui[t].pfmt;var D=to[u].columns==to[R].columns?u:R;var M=M9(t,D)-Nc[N].LeftIndent-(Nj(ui[t].flags&tc.LFLAG_PARA_FIRST)?Nc[N].FirstIndent:0)-Nc[N].RightIndent-B$(t,false,true);if(M>0){ui[t].JustAdjX=wV(M);if(Nj(Nc[N].flags&tc.CENTER))ui[t].JustAdjX=ui[t].JustAdjX/2}}i=d;f=F;OF=i;vF=f;Tg=n;XF=E;return true}function Xy(){var t,e,r,i=0,f=qe,l=0;var a;var n;var c=true;Yt=ze=0;for(t=0;t<Dl;t++){var s=pl[t].x;pl[t].ScrY=yV(pl[t].y);pl[t].ScrHeight=yV(pl[t].y+pl[t].height)-pl[t].ScrY;pl[t].CellSpacing=yV(pl[t].CellSpacing);if(pl[t].level>0&&pl[t].CellId>0&&!pl[t].empty){var _=pl[t].CellId;var o=eR[_].row;if(eR[_].RowSpan==1&&Dj(eR[_].flags&tc.CFLAG_ROW_SPANNED)&&$E[o].NextRow<=0){$E[o].height=xV(pl[t].ScrHeight)}}if(!pl[t].empty&&Dj(pl[t].flags&tc.FRAME_PICT)&&pl[t].PageFirstLine>=0){e=pl[t].y+pl[t].SpaceTop;for(a=pl[t].PageFirstLine;a<=pl[t].PageLastLine;a++){if(L6(a)!=pl[t].level)continue;if(Ei==wt)ui[a].ScrHt=ui[a].height;else{r=e+ui[a].height;ui[a].ScrHt=yV(r)-yV(e);e=r}}}if(pl[t].RowId>0&&Nj(pl[t].flags&tc.FRAME_RTL)){pl[t].width=bV(pl[t].width);if(Nj(pl[t].flags&tc.FRAME_FIRST_ROW_FRAME))pl[t].x=bV(pl[t].x);else pl[t].x=pl[t-1].x-pl[t].width}else{if(t>0&&pl[t].RowId>0&&pl[t-1].RowId==pl[t].RowId)pl[t].x=pl[t-1].x+pl[t-1].width+pl[t-1].CellSpacing+pl[t].CellSpacing;else pl[t].x=bV(pl[t].x);pl[t].width=bV(s+pl[t].width)-pl[t].x}pl[t].ScrX=pl[t].x;pl[t].ScrWidth=pl[t].width;pl[t].y=pl[t].ScrY;pl[t].height=pl[t].ScrHeight;if(pl[t].LimitY!=-1)pl[t].LimitY=yV(pl[t].LimitY);pl[t].SpaceTop=yV(pl[t].SpaceTop);pl[t].SpaceBot=yV(pl[t].SpaceBot);pl[t].SpaceLeft=bV(pl[t].SpaceLeft);pl[t].SpaceRight=bV(pl[t].SpaceRight);if((!pl[t].empty||Nj(pl[t].flags&tc.FRAME_FNOTE))&&pl[t].y+pl[t].TextHeight>Yt)Yt=pl[t].y+pl[t].TextHeight;if(pl[t].y+pl[t].height>ze&&pl[t].ParaFrameId==0)ze=pl[t].y+pl[t].height;if(t<Qe)Ze=pl[t].y+pl[t].height;if(l==0&&t>=Qe&&c){po[f].TextHt=l=i;po[f].ScrHt=po[f].TextHt;f++;i=0;c=false}n=!pl[t].empty&&Dj(pl[t].flags&tc.FRAME_DISABLED)&&pl[t].ScrY+pl[t].TextHeight>i;if(Nj(pl[t].flags&tc.FRAME_FNOTE))n=true;if(n)i=pl[t].ScrY+pl[t].TextHeight;if(Nj(pl[t].flags&(tc.FRAME_BORDER_LEFT|tc.FRAME_BORDER_RIGHT))){pl[t].y--;pl[t].height+=2}}po[f].TextHt=i;if(f>qe)po[f].TextHt-=l;po[f].ScrHt=po[f].TextHt;return}function Ky(t,e,r,i){var f=kl[e].TextAngle;var l,a;var n;var c;var s=pl[t];n=s.SpaceTop;c=s.SpaceBot;s.PageLastLine=i;if(f==0&&Dj(kl[e].flags&tc.PARA_FRAME_FIXED_HEIGHT)){a=mV(kl[e].MinHeight);if(Nj(kl[e].flags2&tc.PF2_SIZE_TO_TEXT))a=0;if(a==0||Dj(kl[e].flags&tc.PARA_FRAME_TEXT_BOX)||Nj(kl[e].flags2&(tc.PF2_SET_HEIGHT|tc.PF2_SIZE_TO_TEXT))){l=r+n+c;if(l>a)s.height=l;if(s.height!=mV(kl[e].height)){Br=tc.PAINT_WIN_RESET;if(s.height>=a)kl[e].height=HV(s.height)}}}s.ScrHeight=yV(s.height);s.TextHeight=0;pl[t]=s;return true}function Yy(t,e,r,i){var f,l,a,n,c,s,_,o,u;var T;var A=0,E=0;IF=e;FF=r;gF=i;f=e;l=r;a=i;T=po[t].FirstLine;n=G5(T);er=DV(ch);u=Ai*eo[n].PgWidth;if(u+2*er<wV(je))er=(wV(je)-u)/2;pl[a].empty=true;pl[a].PageNo=t;pl[a].y=f;pl[a].ScrY=l;pl[a].x=0;pl[a].width=u+2*er;pl[a].height=rr=mV(ch);ir=rr/4;if(ir<mV(tc.PAGE_BORDER_MARGIN)/4)ir=mV(tc.PAGE_BORDER_MARGIN)/4;pl[a].ScrHeight=yV(rr);pl[a].LeftBorderWdth=er;f+=pl[a].height;l+=pl[a].ScrHeight;pl[a].flags=tc.FRAME_RIGHTMOST|tc.FRAME_BORDER_TOP;Dl++;a++;lW(a);c=f;s=l;_=a;pl[a].empty=true;pl[a].PageNo=t;pl[a].y=c;pl[a].ScrY=s;pl[a].x=0;pl[a].width=er;pl[a].height=Ei*eo[n].PgHeight;pl[a].ScrHeight=yV(pl[a].height);pl[a].flags=tc.FRAME_BORDER_LEFT;Dl++;a++;lW(a);o=a;pl[a].empty=true;pl[a].PageNo=t;pl[a].y=c;pl[a].ScrY=s;pl[a].x=er+u;pl[a].width=er;pl[a].height=Ei*eo[n].PgHeight;pl[a].ScrHeight=yV(pl[a].height);pl[a].flags=tc.FRAME_BORDER_RIGHT|tc.FRAME_RIGHTMOST;Dl++;a++;lW(a);pl[a].empty=true;pl[a].PageNo=t;pl[a].y=c;pl[a].ScrY=s;pl[a].x=pl[_].x+pl[_].width;pl[a].width=pl[o].x-pl[a].x;if(yR){var R=Fz(t,false,true);var L;if(R>0)L=Ei*to[n].HdrMargin;else L=Ei*to[n].TopMargin;pl[a].height=L}else pl[a].height=Ei*to[n].TopMargin;pl[a].ScrHeight=yV(pl[a].height);c+=pl[a].height;s+=pl[a].ScrHeight;Dl++;a++;lW(a);IF=c;FF=s;gF=a;PF=_;SF=o;return true}function Vy(t,e,r,i,f,l,a,n){var c;gF=r;if($l<=0)return true;c=$l;if(!Po)XJ(t);pl[r].empty=true;$W(c,r,e,l,a,n,i,-1,t);pl[r].x=DV(kl[c].x);if(Ci)pl[r].x+=er+f;pl[r].width=mV(kl[c].width);pl[r].height=mV(kl[c].height);pl[r].ScrHeight=yV(pl[r].height);pl[r].BoxFrame=r;pl[r].flags=tc.FRAME_WATERMARK;pl[r].ParaFrameId=c;Dl++;r++;lW(r);gF=r;return true}function jy(t,e,r,i,f,l,a,n,c){var s,_,o,u,T,A,E,R,L;var C=[4];var I=true;GF=e;dF=i;gF=a;if(Dj($E[t].flags&tc.ROWFLAG_SPLIT))return true;if(c<tR[t].FirstPage||c>tR[t].LastPage)return true;_=e;o=a;L=i;if(Nj(_))u=eR[_].NextCell;else u=$E[t].FirstCell;if(c>0){for(s=$E[t].NextRow;s>0;s=$E[s].NextRow){if(tR[s].FirstPage>c)break;if(tR[s].FirstPage<c){I=false;break}}}while(u!=r&&u>0){pl[o].empty=true;pl[o].PageNo=c;pl[o].y=f;pl[o].ScrY=yV(f);pl[o].x=L;pl[o].width=DV(eR[u].width);pl[o].height=l;pl[o].ScrHeight=yV(f+l)-yV(f);pl[o].sect=n;pl[o].RowId=t;pl[o].CellId=u;if(I){pl[o].shading=eR[u].shading;pl[o].BackColor=eR[u].BackColor}pl[o].level=eR[u].level;if(Nj(eR[u].flags&tc.CFLAG_FORCE_BKND_CLR))pl[o].flags|=tc.FRAME_FORCE_BKND_CLR;pl[o].flags1|=tc.FRAME1_PART_EMPTY_CELL;if(I){pl[o].border=EW(u,c,C);pl[o].BorderWidth[tc.BORDER_INDEX_LEFT]=Eg;pl[o].BorderWidth[tc.BORDER_INDEX_RIGHT]=Rg;pl[o].BorderWidth[tc.BORDER_INDEX_TOP]=Lg;pl[o].BorderWidth[tc.BORDER_INDEX_BOT]=Cg;for(s=0;s<4;s++)pl[o].BorderColor[s]=C[s]}_=u;L+=pl[o].width;u=eR[u].NextCell;o++;lW(o)}a=o;e=_;i=L;GF=e;dF=i;gF=a;return true}function Jy(t,e,r,i,f){var l,a,n,c;var s;var _;IF=e;FF=r;l=e;a=r;n=Dl;s=po[t].FirstLine;c=G5(s);pl[n].empty=true;pl[n].PageNo=t;pl[n].y=l;pl[n].ScrY=a;pl[n].x=pl[i].x+pl[i].width;pl[n].width=pl[f].x-pl[n].x;pl[n].height=Ei*to[c].FtrMargin;pl[n].ScrHeight=yV(pl[n].height);l+=pl[n].height;a+=pl[n].ScrHeight;Dl++;n++;lW(n);pl[i].height=pl[f].height=l-pl[i].y;pl[i].ScrHeight=pl[f].ScrHeight=a-pl[i].ScrY;if(yR){for(_=n-1;_>=0;_--){if(pl[_].PageNo==t&&Nj(pl[_].flags&tc.FRAME_BORDER_TOP)){l=pl[_].y+pl[_].height+eo[c].PgHeight*Ei;a=pl[_].y+pl[_].ScrHeight+eo[c].PgHeight*wt;break}}}pl[n].empty=true;pl[n].PageNo=t;pl[n].y=l;pl[n].ScrY=a;pl[n].x=0;pl[n].width=Ai*eo[c].PgWidth+2*er;pl[n].LeftBorderWdth=er;pl[n].height=t+1>=To?rr:ir;pl[n].ScrHeight=yV(pl[n].height);l+=pl[n].height;a+=pl[n].ScrHeight;pl[n].flags=tc.FRAME_RIGHTMOST|tc.FRAME_BORDER_BOT|tc.FRAME_DIVIDER_LINE;Dl++;n++;lW(n);e=l;r=a;IF=e;FF=r;return true}function zy(t,e,r,i,f){var l,a,n,c,s,_;var o=true;a=r;l=e;n=Dl;c=i;if(to[c].BorderOpts!=32)o=false;if(Dj(to[c].border))return true;if(!Eu&&!Ci)return true;po[t].flags|=tc.PAGE_BOXED;if(o){a+=mV(to[c].BorderSpace[tc.BORDER_INDEX_TOP]);l+=DV(to[c].BorderSpace[tc.BORDER_INDEX_LEFT]);s=Ei*eo[c].PgHeight-(to[c].BorderSpace[tc.BORDER_INDEX_TOP]+to[c].BorderSpace[tc.BORDER_INDEX_BOT]);_=Ai*eo[c].PgWidth;_-=DV(to[c].BorderSpace[tc.BORDER_INDEX_LEFT]+to[c].BorderSpace[tc.BORDER_INDEX_RIGHT])}else{a+=Ei*to[c].TopMargin;a-=mV(to[c].BorderSpace[tc.BORDER_INDEX_TOP]);l+=Ei*to[c].LeftMargin;l-=DV(to[c].BorderSpace[tc.BORDER_INDEX_LEFT]);s=Ei*(eo[c].PgHeight-to[c].TopMargin-to[c].BotMargin)+mV(to[c].BorderSpace[tc.BORDER_INDEX_TOP]+to[c].BorderSpace[tc.BORDER_INDEX_BOT]);_=Ai*(eo[c].PgWidth-to[c].LeftMargin-to[c].RightMargin)+DV(to[c].BorderSpace[tc.BORDER_INDEX_LEFT]+to[c].BorderSpace[tc.BORDER_INDEX_RIGHT])}pl[n].empty=true;pl[n].PageNo=t;pl[n].y=a;pl[n].ScrY=yV(a);pl[n].x=l;pl[n].width=_;pl[n].height=s;pl[n].ScrHeight=yV(pl[n].height);pl[n].sect=c;pl[n].flags=tc.FRAME_RIGHTMOST|tc.FRAME_PAGE_BOX;Dl++;n++;lW(n);return true}function Zy(t,e,r,i,f,l){var a,n,c,s;var _;IF=e;FF=r;a=e;n=r;c=Dl;_=po[t].FirstLine;s=G5(_);pl[c].empty=true;pl[c].PageNo=t;pl[c].y=a;pl[c].ScrY=n;pl[c].PageFirstLine=po[t].FirstLine;pl[c].PageLastLine=po[t].LastLine;pl[c].width=i;pl[c].height=po[t].FnoteHt;pl[c].ScrHeight=pl[c].TextHeight=yV(pl[c].height);pl[c].sect=s;pl[c].flags|=tc.FRAME_FNOTE;if(Ci){pl[c].x=er;pl[c].width+=f+l;pl[c].SpaceLeft=f}else{pl[c].x=0;pl[c].flags|=tc.FRAME_RIGHTMOST}a+=pl[c].height;n+=pl[c].ScrHeight;Dl++;c++;lW(c);e=a;r=n;IF=e;FF=r;return true}_i.TerGetPageBorderDim=function(){if(!lv||!QD())_i.TerCreateControl();zI=MV(er);ZI=MV(rr);return true};function Qy(t,e,r){var i,f=0;i=to[r].HdrMargin*Ei;f=eo[r].HiddenY;return i-f}function qy(t,e,r,i,f,l,a,n,c,s,_,o,u,T,A,E,R,L,C,I){var d,F;var g=r,P,S=e+1,h,O;var v=0,p,N,D,M;var G,B;var H=0;var m,w=0,b;var x,y,W,U,k;var X=false,K,Y;var V,j=0,J;var z,Z,Q,q;var $=0;var tt=0,et=0,rt=0,it=0;var ft=-1;var lt;var at=[4];ZU("CreateSubTableFrames");gF=r;UF=i;XF=E;i=0;if(ui[t].cid==0)return t;h=0;for(F=t;F<Ri;F++){if(L6(F)==e)return F-1;if(L6(F)==e+1){h=ui[F].cid;break}}if(h==0)return Ri-1;P=eR[h].ParentCell;O=eR[P].row;x=DV(x6(P));y=DV(y6(P));M=DV(eR[P].width)-x-y;f+=x;if(eR[P].PrevCell<=0&&eR[P].level>0){var nt=eR[P].row;f+=$E[nt].CurIndent}N=0;B=0;if(c6(t)){EW(P,l,at);tt=Eg;et=Rg;rt=Lg;it=Cg;rt+=W6(P);it+=U6(P);if(!I)rt=it=0;if(Nj(rR[P].flags&tc.CAUX_SET_TOP_SPACE))rt=eR[P].margin;N=mV(rt);B=yV(N)}v=g;lW(g);p=0;G=0;D=f;H=t-1;W=-1;U=0;k=0;h=0;V=-1;b=0;m=0;lt=0;for(F=t;;F++){if(L6(F)<S)X=true;if(F<Ri&&R==tc.PASS_BODY&&Nj(ui[F].cid)&&!X){var ct=to[a].columns;if(ui[F].page!=l)continue;if(ct>1&&A!=ui[F].col)continue}if(V<0)V=j=F;J=j;j=F;z=0;if(F<Ri)z=ui[F].height;K=Y=false;Z=h;if(F<Ri&&!X)h=E6(S,F);else h=0;if(X&&Z==0&&h==0)break;Q=eR[h].row;q=eR[Z].row;if(h!=Z&&Z!=0)Y=true;if(Q!=q&&q!=0&&Z!=0)K=true;if(X)Y=K=true;if(Y||K){var st=D;$y(S,g,n,c,p,G,N,B,W,U,k,D,m,l,T,A,a,Z,lt,V,J,$,K,w,M,1,0,M,f,M,L,C);if(D>st&&ft>=0){for(d=ft;d<g;d++){var _t=pl[d].CellId;if(_t>0&&eR[_t].level>S)pl[d].x+=D-st}ft=-1}g=gF;p=OF;G=vF;W=pF;U=NF;k=DF;D=MF;lt=GF;w=BF;V=j;if(!K)p=G=0;N+=p;B+=G;p=G=0;D=D+w;if(K)D=f}if(X)break;if(F<Ri&&L6(F)>S){var ot=D;var ut=0;var Tt=false;if(t<Ri)ut=E6(S,t);if(ut>0&&eR[h].PrevCell>0){if(Z==0){O=eR[ut].row;for(cl=$E[O].FirstCell;cl>0&&cl!=ut;cl=eR[cl].NextCell)ot+=DV(eR[cl].width);Tt=true}if(Z>0&&Z!=h&&eR[Z].row==eR[h].row){for(cl=eR[Z].NextCell;cl>0&&cl!=h;cl=eR[cl].NextCell)ot+=DV(eR[cl].width);Tt=true}}if(ft<0&&!Tt)ft=g;F=qy(F,S,g,b,ot,l,a,n+N+p,c+B+G,s,_,o,u,T,A,E,R,L,C,false);g=gF;b=UF;E=XF;p+=b;G+=yV(b);continue}if(F<Ri){ky(F,n,c,p,G,N,D,m,l,s,_,o,u,T,A,E,a,z,t,f);p=OF;G=vF;m=Tg;E=XF}if(F<Ri&&Nj(ui[F].flags2&tc.LFLAG2_PICT_TEXT)){var At=ui[F].fid>0&&kl[ui[F].fid].pict>0;if(!At)Ql=PW(F,u)}}r=g;i=N;gF=r;UF=i;XF=E;return F-1}function $y(t,e,r,i,f,l,a,n,c,s,_,o,u,T,A,E,R,L,C,I,d,F,g,P,S,h,O,v,p,N,D,M){var G,B,H,m,w,b,x,y;var W,U,k,X,K;var Y=false;var V,j,J;var z,Z;var Q,q,$,tt=eR[L].row,et;var rt=[4];var it;var ft;gF=e;vF=l;OF=f;pF=c;NF=s;DF=_;MF=o;GF=C;BF=P;if(eR[L].level>0){if(I>=po[T].TblHdrFirstLine&&I<=po[T].TblHdrLastLine)F|=tc.FRAME_DISABLED|tc.FRAME_GRAY}if(t>0){ft=eR[L].ParentCell;z=DV(x6(ft));Z=DV(y6(ft))}else z=Z=0;W=eR[L].row;K=$E[W].FrmSpcBef;if(K>0){r+=K;i+=yV(K)}if(c==-1){var lt;c=e;lt=$E[tt].MinHeight;if(lt<0&&Nj(tR[tt].flags&tc.TAUX_IGNORE_EXACT_HEIGHT))lt=0;if(Nj($E[tt].flags&tc.ROWFLAG_SPLIT)&&lt>0&&Dj(tR[tt].flags&tc.TAUX_MIN_HEIGHT_USED))lt=0;if(lt<0)lt=-lt;if(lt!=0){if($E[tt].MinHeight>0)lt+=W6(L)+U6(L);else if($E[tt].MinHeight<0){if(Dj(fO&tc.TFLAG10_DONT_PAD_TABLE_HEIGHT)){lt+=U6(L)}}}if(Dj($E[W].flags&tc.ROWFLAG_SPLIT)){if($E[tt].MinPictHeight>lt)lt=$E[tt].MinPictHeight}s=mV(lt);_=hV(lt);Y=true}V=EW(L,T,rt);H=Eg;m=Rg;w=Lg;b=Cg;if(eR[L].PrevCell>0){var at=eR[L].PrevCell;if(Nj(eR[at].border&tc.BORDER_TOP)&&Nj(eR[L].border&tc.BORDER_TOP)){if(eR[at].BorderWidth[tc.BORDER_INDEX_TOP]==eR[L].BorderWidth[tc.BORDER_INDEX_TOP])w=rR[at].FrameTopWidth}else if(Dj(eR[at].border&tc.BORDER_TOP)&&Dj(eR[L].border&tc.BORDER_TOP)){if(rR[at].FrameTopWidth==0)w=0}if(Nj(eR[at].border&tc.BORDER_BOT)&&Nj(eR[L].border&tc.BORDER_BOT)){if(eR[at].BorderWidth[tc.BORDER_INDEX_BOT]==eR[L].BorderWidth[tc.BORDER_INDEX_BOT])b=rR[at].FrameBotWidth}else if(Dj(eR[at].border&tc.BORDER_BOT)&&Dj(eR[L].border&tc.BORDER_BOT)){if(eR[L].RowSpan==1&&rR[at].FrameBotWidth==0)b=0}}rR[L].FrameTopWidth=w;rR[L].FrameBotWidth=b;if(Nj(rR[L].flags&tc.CAUX_SET_TOP_SPACE))x=mV(eR[L].margin);else{Q=W6(L);x=mV(w+Q)}Q=U6(L);y=mV(b+Q);f+=x+y;l+=yV(x+y);if(f<mV(rR[L].MinHeight)&&eR[L].RowSpan==1&&Dj(eR[L].flags&tc.CFLAG_ROW_SPANNED)){var nt=true;if($E[tt].MinHeight>0&&Nj($E[tt].flags&tc.ROWFLAG_SPLIT))nt=false;if(nt&&rR[L].FirstPage==rR[L].LastPage){f=mV(rR[L].MinHeight);l=yV(f)}}B=0;if(Dj($E[tt].flags&tc.ROWFLAG_SPLIT)&&C8(L))B=F8(L,T);else if((eR[L].RowSpan==1||Lz(eR[L].row,T))&&Dj(eR[L].flags&tc.CFLAG_ROW_SPANNED)){B=f;if(eR[L].TextAngle!=0)B=mV(tc.MIN_VTEXT_CELL_HEIGHT);if(Nj(eR[L].flags&tc.CFLAG_VALIGN_BASE))B+=rR[L].SpaceBefore}if($E[tt].MinHeight>=0||Nj(tR[tt].flags&tc.TAUX_IGNORE_EXACT_HEIGHT)){if(B>s)s=B}if(g&&s==0&&eR[L].RowSpan>1&&T==rR[L].LastPage&&Nj($E[tt].flags&tc.ROWFLAG_SPLIT)&&rR[L].LastPage!=rR[L].FirstPage){s=rR[L].LastPageHt}if(Nj($E[tt].flags&tc.ROWFLAG_SPLIT)&&tR[tt].FirstPage==T&&tR[tt].FirstCol==E&&tR[tt].FirstPageHt>0){if(tR[tt].FirstPageHt<s)s=tR[tt].FirstPageHt}if(Nj($E[tt].flags&tc.ROWFLAG_SPLIT)&&tR[tt].LastPage==T&&tR[tt].LastCol==E&&tR[tt].TopRowHt>0){if(tR[tt].TopRowHt>s)s=tR[tt].TopRowHt}var ct=zJ(tt,T,E);if(ct>=0)s=ct;_=yV(s);rR[L].PageFrameHt=f;if(g){it=eR[L].row;for(q=c;q<=e;q++){var st=pl[q].PageLastLine;var _t=pl[q].PageFirstLine;if(pl[q].empty)continue;if(q==e){_t=I;st=d}for(G=_t;G<=st;G++){var ot=ui[G].height;if(ot>0&&ui[G].len==1&&GY(G,tc.INFO_CELL)&&vm(G))ot=0;if(ot!=0)break}if(G<=st)break}if(q>e)_=s=0;$E[it].height=s;tR[it].height=s;if(Nj($E[W].flags&tc.ROWFLAG_SPLIT)&&tR[W].FirstPage==T)tR[W].BotRowHt=s;for(q=c;q<=e;q++){if(pl[q].level!=t)continue;pl[q].height=s;pl[q].ScrHeight=_;if(q<e&&!pl[q].empty){j=pl[q].PageFirstLine;J=ui[j].pfmt;if(Dj(Nc[J].flags&tc.PAGE_HDR_FTR)){if(pl[q].y+pl[q].height>po[T].LastRowEndY)po[T].LastRowEndY=pl[q].y+pl[q].height}}}}if(Y){it=eR[L].row;if($E[it].FrmSpcBef>0){var ut=$E[it].FrmSpcBef;pl[e].empty=true;pl[e].PageNo=T;pl[e].level=t;pl[e].sect=R;pl[e].x=o;pl[e].y=r+a-ut;pl[e].ScrY=i+n-yV(ut);pl[e].width=S;pl[e].BoxFrame=D;pl[e].ParaFrameId=M;if(M>0)pl[e].ZOrder=kl[M].ZOrder;if(!Ci&&t==0)pl[e].flags|=tc.FRAME_RIGHTMOST;pl[e].height=ut;pl[e].ScrHeight=yV(ut);e++;lW(e);if(c>=0)c=e}$E[tt].FirstFrame=e;pl[e].empty=true;pl[e].PageNo=T;pl[e].level=t;pl[e].sect=R;pl[e].y=r+a;pl[e].ScrY=i+n;pl[e].BoxFrame=D;pl[e].ParaFrameId=M;if(M>0)pl[e].ZOrder=kl[M].ZOrder;pl[e].CellId=L;pl[e].width=$E[tt].CurIndent;pl[e].x=o;pl[e].border=0;pl[e].RowId=tt;pl[e].height=f=s;pl[e].ScrHeight=l=_;pl[e].flags|=tc.FRAME_FIRST_ROW_FRAME;o=o+pl[e].width;if(Y)tR[tt].FrmBegX=pl[e].x;e++;lW(e)}jy(tt,C,L,o,r+a,s,e,R,T);C=GF;o=dF;e=gF;X=DV(eR[L].margin);U=DV(x6(L));k=DV(y6(L));P=DV(eR[L].width);pl[e].empty=false;pl[e].PageNo=T;pl[e].level=t;pl[e].sect=R;pl[e].PageFirstLine=I;pl[e].PageLastLine=d;pl[e].y=r+a;pl[e].ScrY=i+n;pl[e].BoxFrame=D;pl[e].ParaFrameId=M;if(M>0)pl[e].ZOrder=kl[M].ZOrder;pl[e].shading=eR[L].shading;pl[e].BackColor=eR[L].BackColor;if(eR[L].BackColor==tc.CLR_WHITE&&eR[L].ParentCell>0&&Dj(eR[L].flags&tc.CFLAG_FORCE_BKND_CLR)){ft=eR[L].ParentCell;while(ft>0){if(eR[ft].BackColor!=tc.CLR_WHITE||Nj(eR[ft].flags&tc.CFLAG_FORCE_BKND_CLR))break;ft=eR[ft].ParentCell}if(ft>0){pl[e].BackColor=eR[L].BackColor;pl[e].flags|=tc.FRAME_FORCE_BKND_CLR}}pl[e].flags|=F;if(Nj(eR[L].flags&tc.CFLAG_FORCE_BKND_CLR))pl[e].flags|=tc.FRAME_FORCE_BKND_CLR;if(Nj(eR[L].flags&tc.CFLAG_ROW_SPANNED)){pl[e].BackColor=tc.CLR_WHITE;pl[e].flags=cj(pl[e].flags,tc.FRAME_FORCE_BKND_CLR)}pl[e].x=o;pl[e].width=P;pl[e].SpaceLeft=U+DV(rR[L].LeftOlSpace);if(false&&Li&&Y&&Nj(V&tc.BORDER_LEFT))pl[e].SpaceLeft+=wV(3);pl[e].SpaceRight=k+DV(rR[L].LeftOlSpace);tR[tt].FrmEndX=pl[e].x+pl[e].width;pl[e].border=V;pl[e].BorderWidth[tc.BORDER_INDEX_LEFT]=H;pl[e].BorderWidth[tc.BORDER_INDEX_RIGHT]=m;pl[e].BorderWidth[tc.BORDER_INDEX_TOP]=w;pl[e].BorderWidth[tc.BORDER_INDEX_BOT]=b;for(q=0;q<4;q++)pl[e].BorderColor[q]=rt[q];pl[e].RowId=tt;if(Nj(eR[L].flags&tc.CFLAG_ROW_SPANNED))pl[e].TextHeight=pl[e].height=pl[e].ScrHeight=0;else{pl[e].TextHeight=l-yV(y);pl[e].height=s;pl[e].ScrHeight=_}f=s;l=_;pl[e].SpaceTop=x;pl[e].SpaceBot=y;pl[e].CellId=L;C=L;e++;lW(e);$=pl[e-1].x+pl[e-1].width;if(g){if(true||t==0){jy(tt,C,0,$,pl[e-1].y,pl[e-1].height,e,R,T);C=GF;$=dF;e=gF}$E[tt].LastFrame=e;pl[e].empty=true;pl[e].PageNo=T;pl[e].level=t;pl[e].y=pl[e-1].y;pl[e].ScrY=pl[e-1].ScrY;pl[e].x=$;pl[e].BoxFrame=D;pl[e].ParaFrameId=M;if(M>0)pl[e].ZOrder=kl[M].ZOrder;pl[e].width=p+N+O-$;if(t==0){if(M>0){var Tt=pl[D].x+pl[D].width-pl[D].BorderWidth[tc.BORDER_INDEX_RIGHT];pl[e].width=Tt-pl[e].x}else if(Ci){if(h==1||E+1==h){var At=pl[e-1].sect;pl[e].width=v-er-to[At].RightMargin*Ai-$}else pl[e].flags|=tc.FRAME_LINE_BET_COL}else{pl[e].flags|=tc.FRAME_RIGHTMOST;if(E+1<h)pl[e].flags|=tc.FRAME_LINE_BET_COL}}if(pl[e].width<0)pl[e].width=0;pl[e].height=pl[e-1].height;pl[e].ScrHeight=pl[e-1].ScrHeight;pl[e].sect=pl[e-1].sect;pl[e].RowId=pl[e-1].RowId;pl[e].CellId=pl[e-1].CellId;pl[e].flags|=F|tc.FRAME_LAST_ROW_FRAME;C=0;for(q=c;q<=e;q++){if(pl[q].level!=t)continue;if(!pl[q].empty){j=pl[q].PageFirstLine;J=ui[j].pfmt;if(Dj(Nc[J].flags&tc.PAGE_HDR_FTR)){var Et=pl[q].CellId;var Rt=eR[Et].RowSpan>1?rR[Et].PageFrameHt:pl[q].height;if(pl[q].y+Rt>po[T].LastRowEndY)po[T].LastRowEndY=pl[q].y+Rt}}}e++;lW(e);c=-1}f+=K;l+=yV(K);if(ct<0&&eR[L].RowSpan>1&&rR[L].LastPage>rR[L].FirstPage&&rR[L].LastPage==T){if(Dj(rR[L].flags&tc.CAUX_ADD_TOP_SPANNING_CELL_HT)){l=0;f=0;s=0;_=0}}gF=e;vF=l;OF=f;pF=c;NF=s;DF=_;MF=o;GF=C;BF=P;return true}function tW(){var t,e,r;var i=false,_;var o;var f=[];var l;var a=false;var u,T;bl=false;for(t=0;t<Dl;t++){pl[t].DispFrame=t;if(pl[t].ZOrder!=0||pl[t].level>0)i=true;l=pl[t].ParaFrameId;if(l>0)i=true}if(!i)return true;f=[];for(t=0;t<Dl;t++){f[t]=new tc.ClsZOrder;f[t].line=-1}for(t=0;t<Dl;t++){f[t].ZOrder=pl[t].ZOrder;f[t].level=pl[t].level;f[t].FrameId=t;l=pl[t].ParaFrameId;if(!pl[t].empty){if(l>0&&kl[l].ShapeType>0)f[t].line=kl[l].AnchorLine;else if(!pl[t].empty)f[t].line=pl[t].PageFirstLine;if(l>0&&pl[t].BoxFrame!=t){var n=pl[t].BoxFrame;f[n].line=f[t].line}else if(pl[t].CellId>0){if(t>0&&pl[t-1].empty&&pl[t-1].CellId==pl[t].CellId)f[t-1].line=f[t].line;if(t+1<Dl&&pl[t+1].empty&&pl[t+1].CellId==pl[t].CellId)f[t+1].line=f[t].line}}f[t].ParaFID=pl[t].ParaFrameId;if(pl[t].ParaFrameId>0&&f[t].ZOrder==0){if(kl[l].pict>0)f[t].ZOrder=.2;if(Nj(kl[l].flags&tc.PARA_FRAME_OBJECT))f[t].ZOrder=.2;if(kl[l].canvas>0){r=kl[l].canvas;f[t].ZOrder=kl[r].ZOrder+.1}if(kl[l].FillPict>0)f[t].ZOrder=-1}f[t].TextPos=0;if(pl[t].ParaFrameId>0&&f[t].ZOrder==0){l=pl[t].ParaFrameId;if(kl[l].pict>0)f[t].ZOrder=.2;if(Nj(kl[l].flags&tc.PARA_FRAME_OBJECT))f[t].ZOrder=.2;if(kl[l].canvas>0){r=kl[l].canvas;f[t].ZOrder=kl[r].ZOrder+.1}if(kl[l].FillPict>0)f[t].ZOrder=-1}if(false&&!pl[t].empty){var c=ui[pl[t].PageFirstLine].pfmt;l=pl[t].ParaFrameId;if(Nj(Nc[c].flags&tc.PAGE_HDR)&&Nj(kl[l].flags&(tc.PARA_FRAME_RECT|tc.PARA_FRAME_LINE))){f[t].ZOrder-=16384;if(f[t].ZOrder>=0)f[t].ZOrder=-1}}if(Nj(pl[t].flags&tc.FRAME_BORDER))f[t].ZOrder=3e4;if(Nj(pl[t].flags&tc.FRAME_BORDER_BOT))f[t].ZOrder=30001;if(pl[t].ParaFrameId>0&&pl[t].BoxFrame==t&&Dj(pl[t].flags&tc.FRAME_NON_TEXT_DO)&&pl[t].empty)f[t].ZOrder=f[t].ZOrder-.1;if(pl[t].ParaFrameId>0&&pl[t].BoxFrame>0&&Dj(pl[t].flags&tc.FRAME_NON_TEXT_DO))a=true;var s=f[t].ParaFID;var A=f[t].line;var E=A>=0&&A<Ri?ui[A].pfmt:0;var R=Nj(kl[s].flags&tc.PARA_FRAME_BEHIND_TEXT);if(R&&kl[s].ZOrder>0)R=false;if(Nj(kl[s].flags2&tc.PF2_BEHIND_DOC))R=true;f[t].ParaId=E;f[t].BehindText=R}f.sort(L);function L(t,e){u=t.FrameId;T=e.FrameId;var r=t.ParaFID;var i=e.ParaFID;var f=t.line;var l=e.line;var a=t.ParaId;var n=e.ParaId;var c=t.BehindText;var s=e.BehindText;_=false;if(Nj(pl[u].flags&tc.FRAME_BORDER)&&Nj(pl[T].flags&tc.FRAME_BORDER)){_=t.ZOrder>e.ZOrder}else if((Nc[n].flags&tc.PAGE_HDR_FTR)!=(Nc[a].flags&tc.PAGE_HDR_FTR)){if(Nj(Nc[n].flags&tc.PAGE_HDR)&&Dj(Nc[a].flags&tc.PAGE_HDR))_=true;else _=false}else if(pl[u].ParaFrameId>0&&pl[u].ParaFrameId==pl[T].ParaFrameId&&pl[u].BoxFrame==T)_=true;else if(i>0&&r>0&&!c&&s)_=true;else if(i>0&&r>0&&c&&!s)_=false;else if(i>0&&r==0&&s)_=true;else if(r>0&&i==0&&c)_=false;else if(r>0&&i==0&&!c&&Dj(pl[T].flags&tc.FRAME_BORDER)&&kl[r].ZOrder>=0)_=true;else{_=false;o=e.ZOrder-t.ZOrder;if(o<0)_=true;else if(o==0){o=e.level-t.level;if(o<0)_=true;else if(o==0){o=e.ParaFID-t.ParaFID;if(o<0&&(e.ParaFID>0||t.ParaFID>0))_=true}if(!_&&e.line<t.line)_=true}}if(_)return 1;else return-1}if(a){for(t=0;t<Dl;t++){for(e=t+1;e<Dl;e++){if(f[t].ParaFID>0&&f[t].ParaFID==f[e].ParaFID){u=f[t].FrameId;T=f[e].FrameId;if(pl[u].BoxFrame>0&&pl[u].BoxFrame==pl[T].BoxFrame){if(pl[T].BoxFrame==T){var C=f[t];f[t]=f[e];f[e]=C}}}}}}for(t=0;t<Dl;t++)pl[t].DispFrame=f[t].FrameId;bl=true;return true}function eW(){var t,e;var r;var i;if(!qE)return true;if(Nj(Nc[ui[br].pfmt].flags&tc.PAGE_HDR_FTR)&&!WR){oV();return true}r=ui[br].fid;if(Dj(r))return true;if(Nj(kl[r].flags2&tc.PF2_NO_DELETE))return true;if(kl[r].NextId>0&&kl[r].PrevId==0){oV();return true}if(Nj(kl[r].flags&tc.PARA_FRAME_OBJECT))i=tg.MsgString[tc.MSG_DEL_DRAW_OBJ];else i=tg.MsgString[tc.MSG_DEL_FRAME];if(Dj(zh&tc.TFLAG_RETURN_MSG_ID)){if(tc.MSGRESULT_CANCEL==qk(i,Ri>tc.UNDO_LINE_LIMIT?tg.MsgString[tc.MSG_IRREVERSIBLE_DEL]:"",tc.MSGTYPE_OK_CANCEL))return true}if(Ri<=tc.UNDO_LINE_LIMIT)V8(r,0,0,0,tc.UNDO_FRAME);else n9();var f=nO;nO|=tc.TOFLAG2_NO_SAVE_UNDO;for(t=br-1;t>=0;t--)if(ui[t].fid!=r)break;sA=e=t+1;TA=0;for(t=br+1;t<Ri;t++)if(ui[t].fid!=r)break;_A=t-1;AA=ui[_A].len;uA=tc.HILIGHT_LINE;MN(false);uA=tc.HILIGHT_OFF;oi.modified++;if(kl[r].pict>0){var l=0,a=0;if(_i.TerLocateFontId(kl[r].pict,l,a)){fw(PC,SC,1,tc.CHAR_D)}}nO=f;kl[r].InUse=false;if(kl[r].PrevId>0){var n=kl[r].PrevId;var c=kl[r].NextId;kl[n].NextId=c;kl[c].PrevId=n;if(c==0&&n>0&&e>0&&ui[e-1].fid==n){t=e-1;var s=ui[t].len;if(Dj(ui[t].flags&tc.LFLAG_PARA)){Tm(t,t,s+1);var _=ui[t].txt;var o=nb(t);_[s]=Bn;o[s]=s>0?o[s-1]:0;sb(t)}}}yJ(false,true,0,true);return true}function rW(t){var e=0,r=0,i=0;if(t<0){var f=-t;return I$(f)}else{if(t>=Ri)return 0;else{e=ui[t].fid;r=ui[t].cid}if(e!=0)i=kl[e].TextAngle;if(i==0&&r>0)i=eR[r].TextAngle}return i}function iW(t){var e,r=-1,i;var f=false;if(!oi.PageMode)return 0;if(t>=0&&t<Ri&&Nj(Nc[ui[t].pfmt].flags&tc.PAGE_HDR_FTR))f=true;t:{if(!f&&t>=0&&t<Ri){i=ui[t].frame;if(i==-1)return r;if(i<0||i>=Dl)break t;if(pl[i].empty||Nj(pl[i].flags&tc.FRAME_DISABLED))break t;if(Nj(pl[i].flags&tc.FRAME_PICT))break t;if(t>=pl[i].PageFirstLine&&t<=pl[i].PageLastLine)return i}}for(e=0;e<Dl;e++){if(pl[e].empty)continue;if(Nj(pl[e].flags&tc.FRAME_PICT))continue;if(t>=pl[e].PageFirstLine&&t<=pl[e].PageLastLine){if(f){r=e;if(Lo==qe&&pl[e].y<Ze)return e}else return e}}return r}function fW(t){if(t<0){var e=-t;if(e<0||e>=Ys)return false;t=xs[e].ParaFID}if(Dj(kl[t].flags2&tc.PF2_HTML))return false;if(Nj(kl[t].flags2&(tc.PF2_LEFT|tc.PF2_HTML_RULE)))return false;if(Nj(kl[t].flags&(tc.PARA_FRAME_VPAGE|tc.PARA_FRAME_VMARG|tc.PARA_FRAME_CENTER|tc.PARA_FRAME_RIGHT_JUST)))return false;return true}function lW(t){var e=0,r=10;if(t+r>=Ml){while(t>=Ml){if(Ml+r<100)Ml+=20;else Ml+=50}}pl[t]=new tc.ClsFrame;pl[t].width=pl[t].ScrWidth=9999;pl[t].height=pl[t].ScrHeight=Mt;pl[t].BackColor=tc.CLR_WHITE;pl[t].LimitY=-1;pl[t].BorderWidth=[4];pl[t].BorderColor=[4];for(e=0;e<4;e++)pl[t].BorderColor[e]=tc.CLR_AUTO;return true}function aW(t,e,r,i,f){var l=0;if(t>=0){l=pl[t].ParaFrameId;e=i=r=f=0;if(pl[t].empty||Dj(kl[l].flags&tc.PARA_FRAME_LINE))return true;e=pl[t].x;i=pl[t].x+pl[t].width;r=pl[t].y;f=pl[t].y+pl[t].height}else l=-t;if(Nj(kl[l].flags2&tc.PF2_FLIPH)){e=WY(e,i);i=JC}if(Nj(kl[l].flags2&tc.PF2_FLIPV)){r=WY(r,f);f=JC}rd=e;id=i;fd=r;ld=f;return true}function nW(t,e){var r,i,f=0,l,a=0,n=0;var c;var s;if(!oi.PageMode)return false;r=ui[t].fid;if(r==0)return false;if((i=iW(t))==-1)return false;if(pl[i].ParaFrameId!=r)return false;for(c=pl[i].PageFirstLine;c<=pl[i].PageLastLine;c++){f+=ui[c].len;if(f>2)return false}c=pl[i].PageFirstLine;if(ui[c].len==0)return false;s=nb(c);l=s[0];sb(c);if(Dj(xs[l].style&tc.PICT))return false;if(e){var _,o=0;_=kl[r].width-2*kl[r].margin-gV(a);if(kl[r].MinHeight>0)o=kl[r].MinHeight-2*kl[r].margin-vV(n);if(Nj(zh&tc.TFLAG_KEEP_PICT_ASPECT)&&_>0&&o>0){var u=xs[l].PictWidth;var T=xs[l].PictHeight;if(u>=Mj(_,T,o)){xs[l].PictWidth=_;xs[l].PictHeight=Mj(T,xs[l].PictWidth,u)}else{xs[l].PictHeight=o;xs[l].PictWidth=Mj(u,xs[l].PictHeight,T)}}else{if(_>0)xs[l].PictWidth=_;if(o>0)xs[l].PictHeight=o}HN(l,hV(xs[l].PictHeight),dV(xs[l].PictWidth),true);mN(l)}else{kl[r].width=xs[l].PictWidth+2*kl[r].margin;kl[r].MinHeight=0;if(Nj(jh))bG(true);if(t<Fo)Fo=t}return true}function cW(t,e){var r;r=Nc[t].flags;r=cj(r,tc.PAGE_HDR_FTR);r|=e;return ZZ(t,Nc[t].LeftIndentTwips,Nc[t].RightIndentTwips,Nc[t].FirstIndentTwips,Nc[t].TabId,0,Nc[t].AuxId,Nc[t].Aux1Id,Nc[t].StyId,Nc[t].shading,Nc[t].pflags,Nc[t].SpaceBefore,Nc[t].SpaceAfter,Nc[t].SpaceBetween,Nc[t].LineSpacing,Nc[t].BkColor,Nc[t].BorderSpaceLeft,Nc[t].flow,r)}function sW(t){var e;if(Ci){t-=HV(er);e=_i.TerGetPageSect(Lo);t-=to[e].LeftMargin*1440}return t}function _W(t){if(t>vV(Ze))t-=vV(Ze);if(Ci)t-=HV(rr);else if(!yR){var e=_i.TerGetPageSect(Lo);t+=to[e].TopMargin*1440}return t}function oW(t){if(Ci)t+=HV(rr);else if(!yR){var e=_i.TerGetPageSect(Lo);t-=to[e].TopMargin*1440}if(Lo>qe)t+=vV(Ze);return t}function uW(t){var e,r,i,f;e=r=i=f=0;rd=fd=id=ld=0;if(Dj(kl[t].flags&tc.PARA_FRAME_LINE))return true;e=kl[t].x;i=kl[t].x+kl[t].width;r=kl[t].y;f=kl[t].y+kl[t].MinHeight;if(kl[t].LineType==tc.DOL_DIAG){r=WY(r,f);f=JC}if(kl[t].LineType==tc.DOL_HORZ)f=r;if(kl[t].LineType==tc.DOL_VERT)i=e;rd=e;id=i;fd=r;ld=f;return true}function TW(t,e,r,i,f){var l=false,a=false;if(Dj(kl[t].flags&tc.PARA_FRAME_LINE))return true;if(i<e){e=WY(e,i);i=JC;l=true}if(f<r){r=WY(r,f);f=JC;a=true}kl[t].x=kl[t].OrgX=e;kl[t].width=i-e;kl[t].y=r;kl[t].MinHeight=f-r;kl[t].height=kl[t].MinHeight;kl[t].flags2=cj(kl[t].flags2,tc.PF2_FLIPH|tc.PF2_FLIPV);if(l)kl[t].flags2|=tc.PF2_FLIPH;if(a)kl[t].flags2|=tc.PF2_FLIPV;return true}function AW(t,e,r){var i,f,l=t;var a;f=I6(t,r);if(f<=0){if(r&&eR[t].RowSpan>1){a=eR[t].row;for(i=1;i<eR[t].RowSpan;i++){a=$E[a].NextRow;if(a<=0)return 0}t=$E[a].FirstCell}f=F6(t,r);if(f>0&&F6(f,!r)<=0)f=0;if(f<=0){var n=eR[t].x;var c=n+eR[t].width;a=eR[t].row;a=r?$E[a].NextRow:$E[a].PrevRow;if(a>0){var s,_,o,u=-1,T,A=0,E=0,R=tc.RULER_TOLERANCE;for(s=$E[a].FirstCell;s>0;s=eR[s].NextCell){_=eR[s].x;o=_+eR[s].width;if(o<=n+R)continue;if(_>=c-R)break;if(_<n-R&&o>n+R&&o<c-R)break;if(_>n+R&&_<c-R&&o>c+R)break;T=0;if(r&&Nj(eR[s].border&tc.BORDER_TOP))T=eR[s].BorderWidth[tc.BORDER_INDEX_TOP];if(!r&&Nj(eR[s].border&tc.BORDER_BOT))T=eR[s].BorderWidth[tc.BORDER_INDEX_BOT];if(u==-1)T=u;else if(T!=u)break;if(A<=0)A=s;E=eR[s].x+eR[s].width}if(E>=c-R&&u>0)f=A}}}if(f>0&&e>=0){a=eR[t].row;var L=$E[a].PrevRow;var C=$E[a].NextRow;if(r){if(Lz(a,e))f=0;if(C>0&&Dj($E[C].flags&tc.ROWFLAG_HDR)&&Nj($E[a].flags&tc.ROWFLAG_HDR))f=0}if(!r){if(o6(true,eR[t].row,e))f=0;if(eR[t].row==po[e].FirstRow)f=0;if(L>0&&Nj($E[L].flags&tc.ROWFLAG_HDR)&&Dj($E[a].flags&tc.ROWFLAG_HDR))f=0}}return f}function EW(t,e,r){var i=eR[t].border;var f,l=0,a=0,n=0,c=0;var s=[4];var _,o,u,T;_=o=u=T=0;Eg=Rg=Lg=Cg=0;l=RW(t,i);i=kP;s[tc.BORDER_INDEX_LEFT]=UP;a=LW(t,i);i=kP;s[tc.BORDER_INDEX_RIGHT]=UP;n=CW(t,i,e);i=kP;s[tc.BORDER_INDEX_TOP]=UP;rR[t].LastSpannedCell=0;if(eR[t].RowSpan<=1){c=IW(t,i,e);i=kP;s[tc.BORDER_INDEX_BOT]=UP}else{var A=K8(t);var E=eR[A].border;rR[t].LastSpannedCell=A;c=IW(A,E,e);E=kP;s[tc.BORDER_INDEX_BOT]=UP;i=cj(i,tc.BORDER_BOT);if(Nj(E&tc.BORDER_BOT))i|=tc.BORDER_BOT}if(r!=null)for(f=0;f<4;f++)r[f]=s[f];if(ER){var R=eR[t].row;i=i|tc.BORDER_BOT|tc.BORDER_RIGHT;if(P6(t,false,false)==-1&&F6(t,false)==0)i=i|tc.BORDER_TOP;i|=tc.BORDER_TOP;if(eR[t].PrevCell==-1)i=i|tc.BORDER_LEFT}Eg=l;Rg=a;Lg=n;Cg=c;return i}function RW(t,e){var r=0,i,f,l;var a=eR[t].BorderColor[tc.BORDER_INDEX_LEFT];var n;var c;kP=e;UP=c=a;var s=eR[t].row;if((l=c8(t))>0){r=eR[t].BorderWidth[tc.BORDER_INDEX_LEFT]+l/2;if(eR[t].PrevCell<=0)rR[t].LeftOlSpace=l/2+$E[s].BorderWidth[tc.BORDER_INDEX_LEFT];else rR[t].LeftOlSpace=0;r+=rR[t].LeftOlSpace}else if(Li&&Dj(Qh&tc.TFLAG3_PLAIN_TABLE_BORDER)&&Nj(eR[t].flags&tc.CFLAG_3D)){r=eR[t].BorderWidth[tc.BORDER_INDEX_TOP];if(r>0){f=eR[t].PrevCell;if(f<=0)r=r*3}}else{if(Nj(e&tc.BORDER_LEFT))r=eR[t].BorderWidth[tc.BORDER_INDEX_LEFT];f=eR[t].PrevCell;if(r==0&&eR[t].RowSpan>1){if(f>0&&eR[f].RowSpan!=eR[t].RowSpan)return 0}if(f>0&&Nj(rO&tc.TFLAG8_HIDE_EMPTY_CELLS_ON_PRINT)&&Nj(rR[f].flags&tc.CAUX_EMPTY_CELL))f=0;if(f>0&&Nj(eR[f].flags&tc.CFLAG_ROW_SPANNED)&&rR[f].SpanningCell>0)f=rR[f].SpanningCell;if(f>0){if(r>0)r=(r+1)/2;if(Nj(eR[f].border&tc.BORDER_RIGHT))i=eR[f].BorderWidth[tc.BORDER_INDEX_RIGHT]/2;else i=0;n=Dj(qh&tc.TFLAG4_NO_SHARE_BORDER);if(n){if(r==0&&i>0)a=eR[f].BorderColor[tc.BORDER_INDEX_RIGHT];if(i>r)r=i}else r=r*2;if(r>0)e|=tc.BORDER_LEFT;if(r>x6(t)){var _=f>0?y6(f):0;if(r>_)r=x6(t)}}}c=a;kP=e;UP=c=a;return r}function LW(t,e){var r,i=0,f,l;var a=eR[t].BorderColor[tc.BORDER_INDEX_RIGHT];var n;kP=e;UP=a;var c=eR[t].row;if((r=c8(t))>0){i=eR[t].BorderWidth[tc.BORDER_INDEX_RIGHT]+r/2;if(eR[t].NextCell<=0)rR[t].RightOlSpace=r/2+$E[c].BorderWidth[tc.BORDER_INDEX_RIGHT];else rR[t].RightOlSpace=0;i+=rR[t].RightOlSpace}else if(Li&&Dj(Qh&tc.TFLAG3_PLAIN_TABLE_BORDER)&&Nj(eR[t].flags&tc.CFLAG_3D)){i=eR[t].BorderWidth[tc.BORDER_INDEX_TOP];if(i>0){l=eR[t].NextCell;if(l<=0)i=i*3}}else{if(Nj(e&tc.BORDER_RIGHT))i=eR[t].BorderWidth[tc.BORDER_INDEX_RIGHT];if(i==0&&eR[t].RowSpan>1)return 0;l=eR[t].NextCell;if(l>0&&Nj(rO&tc.TFLAG8_HIDE_EMPTY_CELLS_ON_PRINT)&&Nj(rR[l].flags&tc.CAUX_EMPTY_CELL))l=0;if(l>0&&Nj(eR[l].flags&tc.CFLAG_ROW_SPANNED)&&rR[l].SpanningCell>0)l=rR[l].SpanningCell;if(l>0){i=i/2;if(Nj(eR[l].border&tc.BORDER_LEFT))f=eR[l].BorderWidth[tc.BORDER_INDEX_LEFT]/2;else f=0;n=Dj(qh&tc.TFLAG4_NO_SHARE_BORDER);if(n){if(i==0&&f>0)a=eR[l].BorderColor[tc.BORDER_INDEX_LEFT];if(f>i)i=f}else{if(f>0)i=0;else i=i*2}if(i>0)e|=tc.BORDER_RIGHT}if(i==0)e=cj(e,tc.BORDER_RIGHT);if(i>y6(t)){var s=l>0?x6(l):0;if(i>s)i=y6(t)}}kP=e;UP=a;return i}function CW(t,e,r){var i,f,l,a;var n=0;var c=eR[t].BorderColor[tc.BORDER_INDEX_TOP];var s=Dj(qh&tc.TFLAG4_NO_SHARE_BORDER);kP=e;UP=c;a=eR[t].row;if((i=c8(t))>0){n=eR[t].BorderWidth[tc.BORDER_INDEX_TOP]+i/2;if(s6(a))rR[t].TopOlSpace=i/2+$E[a].BorderWidth[tc.BORDER_INDEX_TOP];else rR[t].TopOlSpace=0;n+=rR[t].TopOlSpace}else if(Li&&Dj(Qh&tc.TFLAG3_PLAIN_TABLE_BORDER)&&Nj(eR[t].flags&tc.CFLAG_3D)){n=eR[t].BorderWidth[tc.BORDER_INDEX_TOP];if(n>0){a=eR[t].row;if($E[a].PrevRow<=0)n=n*3}}else{if(Nj(e&tc.BORDER_TOP))n=eR[t].BorderWidth[tc.BORDER_INDEX_TOP];if(n==0&&Li){r=-1;s=true}f=AW(t,r,false);if(f>0){n=(n+1)/2;if(Nj(eR[f].border&tc.BORDER_BOT))l=eR[f].BorderWidth[tc.BORDER_INDEX_BOT]/2;else l=0;if(s){if(n==0&&l>0)c=eR[f].BorderColor[tc.BORDER_INDEX_BOT];if(l>n)n=l}else n=n*2;if(n>0)e|=tc.BORDER_TOP}}kP=e;UP=c;return n}function IW(t,e,r){var i,f,l,a,n;var c=0;var s=eR[t].BorderColor[tc.BORDER_INDEX_BOT];var _=Dj(qh&tc.TFLAG4_NO_SHARE_BORDER);kP=e;UP=s;a=eR[t].row;if((i=c8(t))>0){c=eR[t].BorderWidth[tc.BORDER_INDEX_BOT]+i/2;if(u6(a))rR[t].BotOlSpace=i/2+$E[a].BorderWidth[tc.BORDER_INDEX_BOT];else rR[t].BotOlSpace=0;c+=rR[t].BotOlSpace}else if(Li&&Dj(Qh&tc.TFLAG3_PLAIN_TABLE_BORDER)&&Nj(eR[t].flags&tc.CFLAG_3D)){c=eR[t].BorderWidth[tc.BORDER_INDEX_BOT];if(c>0){c+=c;a=eR[t].row;n=eR[t].RowSpan;while(n>1){if(a>0)a=$E[a].NextRow;n--}if(a>0)a=$E[a].NextRow;if(a<=0)c+=c}}else{if(Nj(e&tc.BORDER_BOT))c=eR[t].BorderWidth[tc.BORDER_INDEX_BOT];if(c==0&&Li){r=-1;_=true}f=AW(t,r,true);if(f>0){c=c/2;if(Nj(eR[f].border&tc.BORDER_TOP))l=eR[f].BorderWidth[tc.BORDER_INDEX_TOP]/2;else l=0;if(_){if(c==0&&l>0)s=eR[f].BorderColor[tc.BORDER_INDEX_TOP];if(l>c)c=l}else{if(l>0)c=0;else c=c*2}if(c>0)e|=tc.BORDER_BOT}if(c==0)e=cj(e,tc.BORDER_BOT)}kP=e;UP=s;return c}function dW(t){var e;if(!Ci)return 0;if(t<0)t=cz(-t);e=_i.TerGetPageSect(t);return er+Ai*to[e].LeftMargin}function FW(t,e,r,i,f,l,a,n,c){var s;var _,o,u,T,A;var E;if(a>=Ri)a=Ri-1;if(n>=Ri)n=Ri-1;for(s=a;s<=n;s++){if(Dj(ui[s].flags&tc.LFLAG_PICT))continue;if(ui[s].page!=t&&c==0)continue;if((Nc[ui[s].pfmt].flags&tc.PAGE_HDR_FTR)!=c)continue;A=ui[s].fid;if(Nj(A)&&Dj(kl[A].flags&tc.PARA_FRAME_POSITIONED))continue;E=nb(s);for(o=0;o<ui[s].len;o++){u=E[o];if(Dj(xs[u].InUse)||Dj(xs[u].style&tc.PICT)||xs[u].FrameType==tc.PFRAME_NONE||xs[u].ParaFID==0)continue;T=xs[u].ParaFID;if(kl[T].ShapeType==tc.SHPTYPE_TEXT_BOX)continue;if(Nj(kl[T].flags2&tc.PF2_INLINE))continue;_=Dl;pl[_].empty=false;pl[_].sect=G5(s);pl[_].PageFirstLine=s;pl[_].PageLastLine=s;pl[_].ParaFrameId=T;pl[_].flags|=tc.FRAME_PICT;if(xs[u].PictType==tc.PICT_SHAPE)pl[_].flags|=tc.FRAME_NON_TEXT_DO;pl[_].ZOrder=kl[T].ZOrder;pl[_].TextPos=Lq(s,o);pl[_].width=DV(kl[T].width);pl[_].SpaceLeft=DV(kl[T].margin);pl[_].SpaceRight=DV(kl[T].margin);pl[_].SpaceTop=mV(kl[T].margin);pl[_].SpaceBot=mV(kl[T].margin);pl[_].height=mV(kl[T].height);pl[_].ScrHeight=hV(kl[T].height);pl[_].TextHeight=pl[_].ScrHeight;pl[_].x=DV(kl[T].x);if(Ci)pl[_].x+=er+i;$W(T,_,ui[s].y+Ze,e,r,f,l,s,t);jl=true;Dl++;lW(Dl)}sb(s)}return true}function gW(t){if(t>=0&&t<Ys&&xs[t].InUse&&Nj(xs[t].style&tc.PICT)&&xs[t].FrameType!=tc.PFRAME_NONE){var e=xs[t].ParaFID;if(e>=0&&e<Kl)return true}return false}function PW(t,e){var r;var i,f,l,a;var n;if(Dj(ui[t].flags2&tc.LFLAG2_PICT_TEXT))return Ql;r=nb(t);for(i=0;i<ui[t].len;i++){l=r[i];a=xs[l].ParaFID;if(!xs[l].InUse||Dj(xs[l].style&tc.PICT)||a==0)continue;if(kl[a].ShapeType!=tc.SHPTYPE_TEXT_BOX)continue;for(f=0;f<Ql;f++)if(Zl[f]==a)break;if(f<Ql)continue;if(Ql>=ql){var c=Ql+1+ql/3;Zl=fV(Zl,c+1);ql=c}n=kl[a].ParaY>eo[e].PgHeight*1440||kl[a].x>eo[e].PgWidth*1440;if(!n){Zl[Ql]=a;Ql++}}sb(t);return Ql}function SW(t,e,r,i,f,l,a,n,c,s,_){var o;var u;var T=false,A;var E,R,L,C,I,d;var F,g;var P,S=0,h=0;var O=false;var v=null;var p;var N=new tc.RECT;var D=0;var M,G;var B,H;if(Dj(ui[t].flags&tc.LFLAG_PICT))return false;o=nb(t);P=ui[t].fid;if(Nj(P)&&Dj(kl[P].flags&tc.PARA_FRAME_POSITIONED))return false;for(L=0;L<ui[t].len;L++){u=o[L];if(Dj(xs[u].InUse)||Dj(xs[u].style&tc.PICT)||xs[u].FrameType==tc.PFRAME_NONE||xs[u].ParaFID==0){continue}C=xs[u].ParaFID;if(Po&&Dj(kl[C].flags&(tc.PARA_FRAME_VPAGE|tc.PARA_FRAME_VMARG))&&kl[C].ParaY<0)continue;kl[C].flags=cj(kl[C].flags,tc.PARA_FRAME_POSITIONED)}for(L=0;L<ui[t].len;L++){u=o[L];if(Dj(xs[u].InUse)||Dj(xs[u].style&tc.PICT)||xs[u].FrameType==tc.PFRAME_NONE||xs[u].ParaFID==0){O=true;continue}C=xs[u].ParaFID;xs[u].InLine=t;kl[C].AnchorX=e;kl[C].AnchorY=r;if(Dj(kl[C].flags&(tc.PARA_FRAME_VPAGE|tc.PARA_FRAME_VMARG|tc.PARA_FRAME_VLINE))){for(g=t;g>0&&g>c;g--){if(Nj(ui[g].flags&tc.LFLAG_PARA_FIRST))break;kl[C].AnchorY-=ui[g-1].height}}A=xs[u].FrameType!=tc.PFRAME_FLOAT||Nj(kl[C].flags&(tc.PARA_FRAME_CENTER|tc.PARA_FRAME_RIGHT_JUST))||Nj(kl[C].flags2&tc.PF2_LEFT);if(Nj(kl[C].flags2&tc.PF2_INLINE))A=false;if(xs[u].PictType!=tc.PICT_SHAPE){kl[C].width=xs[u].PictWidth+2*kl[C].margin;kl[C].height=xs[u].PictHeight+2*kl[C].margin;kl[C].MinHeight=kl[C].height}kl[C].TextLine=t;kl[C].AnchorLine=t;kl[C].CellId=ui[t].cid;R=r;if(Li&&Dj(kl[C].flags2&tc.PF2_HTML_RULE)){if(O)R+=ui[t].height+mV(50)}if(kl[C].PctWidth>0){I=gV(M9(t,-1));xs[u].PictWidth=kl[C].width=Mj(I,kl[C].PctWidth,100);HN(u,hV(xs[u].PictHeight),dV(xs[u].PictWidth),true);mN(u)}if(A){E=MV(e);if(ui[t].cid>0){d=ui[t].cid;F=eR[d].border;E+=x6(d);R+=mV(CW(d,F,n))}if(xs[u].FrameType==tc.PFRAME_RIGHT||Nj(kl[C].flags&tc.PARA_FRAME_RIGHT_JUST)){if(kl[C].canvas>0){B=kl[C].canvas;I=kl[B].width;E=kl[B].x+I-kl[C].width}else if(Nj(kl[C].flags&tc.PARA_FRAME_IN_CELL)&&ui[t].cid>0&&Dj(kl[C].flags&tc.PARA_FRAME_WRAP_IGNORE)){d=ui[t].cid;M=eR[d].width-x6(d)-y6(d);E=E+(M-kl[C].width)}else{E=E+(eo[a].PgWidth-to[a].LeftMargin-to[a].RightMargin)*1440-kl[C].width}E-=h}else if(Nj(kl[C].flags&tc.PARA_FRAME_CENTER)){if(Nj(kl[C].flags&tc.PARA_FRAME_IN_CELL)&&ui[t].cid>0&&Dj(kl[C].flags&tc.PARA_FRAME_WRAP_IGNORE)){d=ui[t].cid;M=eR[d].width-x6(d)-y6(d);E=E+(M-kl[C].width)/2}else{if(Nj(kl[C].flags&tc.PARA_FRAME_HPAGE)){E-=to[a].LeftMargin*1440;E=E+(eo[a].PgWidth*1440-kl[C].width)/2}else{E=E+((eo[a].PgWidth-to[a].LeftMargin-to[a].RightMargin)*1440-kl[C].width)/2}}E-=h}else if(kl[C].canvas>0&&(xs[u].FrameType==tc.PFRAME_LEFT||Nj(kl[C].flags2&tc.PF2_LEFT))){B=kl[C].canvas;E=kl[B].x+S+kl[C].x}else E+=S;kl[C].x=E;if(xs[u].FrameType!=tc.PFRAME_FLOAT&&Dj(kl[C].flags&(tc.PARA_FRAME_VMARG|tc.PARA_FRAME_VPAGE))&&Dj(kl[C].flags2&tc.PF2_HTML_RULE)){kl[C].ParaY=0;if(Dj(ui[t].flags&tc.LFLAG_PARA_FIRST))kl[C].ParaY=HV(ui[t].height)}if(xs[u].FrameType==tc.PFRAME_RIGHT)h+=kl[C].width;else if(xs[u].FrameType==tc.PFRAME_LEFT||Nj(kl[C].flags2&tc.PF2_LEFT))S+=kl[C].width}else{E=DV(kl[C].OrgX);if(Nj(kl[C].flags2&tc.PF2_INLINE)){var m;E=e;G=ui[t].pfmt;d=ui[t].cid;if(d>0)E+=DV(eR[d].margin);E+=DV(Nc[G].LeftIndentTwips+Nc[G].FirstIndentTwips);if(v==null)v=vq(t);for(m=0;m<L;m++){if(Eu)E+=v[m];else E+=wV(v[m])}if(Nj(Nc[G].flags&(tc.CENTER|tc.RIGHT_JUSTIFY)))E+=ui[t].JustAdjX}else if(kl[C].canvas>0){B=kl[C].canvas;E=DV(kl[B].x+kl[C].OrgX)}else{if(ui[t].cid>0&&Nj(kl[C].flags&tc.PARA_FRAME_IN_CELL)&&Dj(kl[C].flags&tc.PARA_FRAME_WRAP_IGNORE)){var w,b;E+=e;if(E<e)E=e;d=ui[t].cid;M=eR[d].width-x6(d)-y6(d);w=e+DV(M);b=DV(kl[C].width);if(E+b>w&&(xs[u].FrameType==tc.PFRAME_LEFT||xs[u].FrameType==tc.PFRAME_RIGHT)){E=w-b;if(E<e)E=e}eR[d].flags|=tc.CFLAG_HAS_FRAMES;if(Nj(kl[C].flags&tc.PARA_FRAME_HCHAR)){G=ui[t].pfmt;if(L>0||Nj(Nc[G].flags&(tc.CENTER|tc.RIGHT_JUSTIFY))){H=gq(t,L);E+=DV(H)}}}else if(Nj(kl[C].flags2&tc.PF2_RIGHT_MARG)){E+=(eo[a].PgWidth-to[a].LeftMargin-to[a].RightMargin)*Ai}else if(Nj(kl[C].flags&tc.PARA_FRAME_HCHAR)){G=ui[t].pfmt;E+=e;E-=D;if(L>0||Nj(Nc[G].flags&(tc.CENTER|tc.RIGHT_JUSTIFY))){H=gq(t,L);E+=DV(H)}if(Nc[G].LeftIndentTwips!=0){E+=DV(Nc[G].LeftIndentTwips)}}else if(Nj(kl[C].flags&tc.PARA_FRAME_HCOL)){var x=true;if(ui[t].cid>0&&Dj(kl[C].flags&tc.PARA_FRAME_IN_CELL)&&Dj(kl[C].flags&tc.PARA_FRAME_WRAP_IGNORE))x=false;if(x)E+=e;else{E+=s;if(Ci)E-=er+_}}if(Nj(kl[C].flags&tc.PARA_FRAME_HPAGE)){E-=Ai*to[a].LeftMargin}if(false&&Nj(kl[C].flags&(tc.PARA_FRAME_HCHAR|tc.PARA_FRAME_HCOL))&&ui[t].tabw!=null&&ui[t].tabw.FrameCharPos==0&&ui[t].tabw.FrameSpaceWidth>0){var y,W,U;DW(t,N);if(OF==0)E+=mF}if(false&&Nj(kl[C].flags&tc.PARA_FRAME_SHPGRP))E+=DV(kl[C].GroupX)}kl[C].x=MV(E)}kl[C].CalcX=kl[C].x;kl[C].flags2|=tc.PF2_CALCX_SET;if(!Po||Nj(kl[C].flags&(tc.PARA_FRAME_VPAGE|tc.PARA_FRAME_VMARG))||kl[C].ParaY>=0){kl[C].flags=cj(kl[C].flags,tc.PARA_FRAME_POSITIONED)}$W(C,-1,R,i,f,l,a,t,n);po[n].FrameCount++;D++}sb(t);return T}_i.TerMovePictFrame=function(t,e,r){var i;if(!lv||!QD())_i.TerCreateControl();if(!oi.PageMode)return false;if(t<0||t>=Ys)return false;if(!xs[t].InUse||Dj(xs[t].style&tc.PICT)||xs[t].FrameType==tc.PFRAME_NONE)return false;i=xs[t].ParaFID;if(!kl[i].InUse)return false;V8(i,0,0,0,tc.UNDO_FRAME_LIMITED);if(e!=tc.PARAM_IGNORE){var f=e-kl[i].x;kl[i].x+=f;kl[i].OrgX+=f}if(r!=tc.PARAM_IGNORE)kl[i].ParaY=r;kl[i].OrgY=kl[i].ParaY;oi.modified++;yJ(false,true,0,true);return true};_i.TerMovePictFrame2=function(t,e,r){var i,f,l,a,n,c,s,_,o,u;var T,A;var E=false;if(!lv||!QD())_i.TerCreateControl();if(!oi.PageMode)return false;if(t<0||t>=Ys)return false;if(!xs[t].InUse||Dj(xs[t].style&tc.PICT)||xs[t].FrameType==tc.PFRAME_NONE)return false;f=xs[t].ParaFID;if(!kl[f].InUse)return false;a=kl[f].y+r;a=hV(a);if(kl[f].PageNo>qe)a+=Ze;s=a+hV(kl[f].height);n=0;c=Ze;u=kl[f].PageNo;if(u>qe){n=c;c=ze}E=s>n&&s<=c;if(!E&&a>=n&&kl[f].PageNo+1==To)E=true;if(E)return _i.TerMovePictFrame(t,kl[f].x+e,kl[f].ParaY+r);if(Ri<=tc.UNDO_LINE_LIMIT)V8(f,0,0,0,tc.UNDO_FRAME);else n9();kl[f].x+=e;kl[f].OrgX+=e;l=dV(kl[f].x);for(_=0;_<Dl;_++)if(!pl[_].empty&&pl[_].ParaFrameId==f)break;if(_<Dl)pl[_].empty=true;A=Jq(l,a);Ez(a);if(_<Dl)pl[_].empty=false;T=WW(A);o=yW(T);if(o>c)o-=c;hW(t,T,0);if(Lo==0&&a<0)a=0;i=_W(vV(a));if(i-kl[f].height<0)i=kl[f].height;if(Nj(kl[f].flags&(tc.PARA_FRAME_VMARG|tc.PARA_FRAME_VPAGE))){kl[f].ParaY=i;if(Nj(kl[f].flags&tc.PARA_FRAME_VMARG)){var R=G5(T);kl[f].ParaY-=jV(to[R].TopMargin)}}else kl[f].ParaY=i-vV(o);kl[f].OrgY=kl[f].ParaY;kl[f].PageNo=ui[T].page;oi.modified++;br=T;jt=0;_i.TerRepaginate(true);return true};function hW(t,e,r){var i=0;var f=0;var l;var a;if(!_i.TerLocateFontId(t,i,f))return false;i=PC;f=SC;fw(i,f,1,tc.CHAR_D);fw(e,r,1,gk("B"));l=ui[e].txt;a=nb(e);l[r]=tc.PICT_CHAR;a[r]=t;sb(e);n9();return true}function OW(){var t,e;var r,i;var f,l,a;var n=oi.modified;for(t=0;t<Ys;t++){if(!xs[t].InUse||Dj(xs[t].style&tc.PICT)||xs[t].FrameType!=tc.PFRAME_FLOAT)continue;a=xs[t].ParaFID;if(Dj(kl[a].flags&(tc.PARA_FRAME_VPAGE|tc.PARA_FRAME_VMARG))&&Dj(nO&tc.TOFLAG2_REPOS_PICT_FRAMES))continue;if(Nj(kl[a].flags2&tc.PF2_INLINE)||kl[a].canvas>0)continue;i=f=0;if(!_i.TerLocateFontId(t,i,f))continue;i=PC;f=SC;var c=ib(i,0);var s=ib(i,f);if(xs[c].FieldId!=0||xs[s].FieldId!=0)continue;l=ui[i].page;for(r=i;r>=0&&Dj(ui[r].flags&tc.LFLAG_PARA_FIRST)&&r!=po[l].FirstLine;r--);if(r==po[l].FirstLine)continue;if(r<0)r=0;if(i!=r||f!=0){var _=Lq(i,f);var o=Lq(r,0);var u=Lq(br,jt);var T=nb(i);for(e=0;e<f;e++){var A=T[e];if(Nj(xs[A].style&tc.PICT)&&xs[A].ParaFID>0)continue}if(e<f){hW(t,r,0);if(u>=o&&u<=_){jt++;if(jt>=ui[br].len&&ui[br].len>0)jt=ui[br].len-1}}}}oi.modified=n;uj(tc.TOFLAG2_REPOS_PICT_FRAMES);return true}function vW(t,e){return wW(t,e)+b6(t,e)}function pW(t,e,r){var i=0,f=0,l;var a=new tc.RECT;if(Nj(kl[t].flags&tc.PARA_FRAME_TEXT_BOX)){for(;e<Ri;e++)if(ui[e].fid==0)break;if(e>Ri)return 0}if(!GW(e,a,-1,false,false,false,r,t,0))return 0;if(OF>0)HF=mF=0;if(HF==0)return mF;else return 0}function NW(t,e){var r=new tc.RECT;var i=pl[t].PageFirstLine;var f=pl[t].ParaFrameId;if(f==0)return false;if(Nj(kl[f].flags&tc.PARA_FRAME_TEXT_BOX)){for(;i<Ri;i++)if(ui[i].fid==0)break;if(i>Ri)return false}r.left=kl[f].x;r.right=r.left+DV(kl[f].width);r.top=kl[f].y;r.bottom=r.left+DV(kl[f].height);if(!GW(i,r,-1,false,false,false,kl[f].PageNo,f,0))return false;if(OF>0||mF==0)return false;if(Ci)HF+=er+e;if(HF+mF>pl[t].x)pl[t].x=HF+mF;return true}function DW(t,e){var r=0;HF=mF=OF=0;if(t>=0){r=mW(t,-1,false,-1);OF=r;GW(t,e,-1,false,false,false,-1,0,r)}else if(!GW(t,e,-1,false,false,false,-1,0,r))return true;if(OF>0)OF=HF=mF=0;return true}function MW(t,e,r,i,f,l,a){return GW(t,e,r,i,f,l,a,0,0)}function GW(t,e,r,i,f,l,a,n,c){var s,_,o,u,T,A,E,R=0,L=0,C,I,d;var F,g,P,S=0,h=0,O,v,p=0,N;var D=true,M=false;var G=0,B=0,H=0,m,w,b=1,x=0;var y,W,U=false;var k=0,X;var K,Y=t;var V=i||f,j=n>0;var J=false;var z,Z=0,Q;var q,$,tt;var et=!i&&!f&&!l;pRect=null;var rt=null;var it=0,ft=0,lt,at,nt;var ct=null;q=$=tt=0;HF=mF=OF=wF=0;if(!oi.PageMode)return false;if(l&&i)return false;if(t>=Ri)t=Ri-1;X=t>=0?ui[t].fid:0;if(n>0)X=0;W=t>=0&&ui[t].cid>0?true:false;if(W)p=ui[t].cid;if(i||l)p=eR[p].ParentCell;if((i||l)&&!Po)return false;if(t>=0){if(Nj(ui[t].flags&tc.LFLAG_HDRS_FTRS))return false;o=ui[t].y+c;if(o==0&&yR&&!oi.FittedView)return false;if(a<0){var st;a=ui[t].page;if(Po)a=Co;if(Nj(Nc[ui[t].pfmt].flags&tc.PAGE_HDR_FTR)){Z=K5(t);if(Nj(Z&tc.LFLAG_HDR_FTR)){for(st=po[a].FirstLine;st<=po[a].LastLine;st++){if(st>=Ri||Dj(Nc[ui[st].pfmt].flags&tc.PAGE_HDR_FTR))break;if(Nj(Z&tc.LFLAG_HDR)&&Nj(ui[st].flags&tc.LFLAG_FHDR)||Nj(Z&tc.LFLAG_FTR)&&Nj(ui[st].flags&tc.LFLAG_FFTR)){a++;break}}}}}P=ui[t].height;if(Y>t)o+=P;k=K5(t);if(Nj(k))return false;J=Nj(ui[t].flags2&tc.LFLAG2_RTL);if(j){o=mV(kl[n].y);P=mV(kl[n].height);J=false}if(i&&ui[t].cid>0&&ui[t].fid==0){nt=eR[ui[t].cid].row;P=tR[nt].height}}else{o=xV(e.top);if(a<0)a=Lo;P=xV(e.bottom-e.top);J=false}if(P==0)return false;if(i||l){nt=eR[ui[t].cid].row;var _t=$E[nt].FirstCell;if(i){G=ui[t].x+DV($E[nt].indent);if(Ci)G-=dW(a)}else G=ui[t].x;B=G;while(_t>0){B+=DV(eR[_t].width);_t=eR[_t].NextCell}H=B-G}if(t>=0){if(r<0)r=G5(t);if(ui[t].fid>0){d=DV(kl[X].width-2*kl[X].margin)}else if(p>0){d=eR[p].width-x6(p)-y6(p);d=DV(d)}else{if(i||l){d=wV(M9(-1,r));if(to[r].columns>1&&Dj(Nc[ui[t].pfmt].flags&tc.PAGE_HDR_FTR)){d=d-Ai*(to[r].ColumnSpace*(to[r].columns-1));d=d/to[r].columns}}else d=wV(M9(t,r))}g=ui[t].x;if(Nj(ui[t].cid))g+=DV(x6(ui[t].cid));if(Nj(ui[t].cid))C=DV(de/4);else C=DV(de);if(f)x=B$(t,false,false);b=to[r].columns;if(X>0||p>0)b=1;Z=K5(t);if(Nj(ui[t].flags2&tc.LFLAG2_SPACE_TAKING_FRAME))U=true}else{d=wV(e.right-e.left);g=wV(e.left);C=0;Z=0}I=C;if(Ci)g-=dW(a);if(f&&t>=0)ct=nb(t);Q=0;t:while(true){D=true;M=false;O=w=o;v=o+P;m=mV(tc.FRAME_DIST_FROM_TEXT)*3/4;if(m>P/2)m=P/2;F=mV(5);if(Nj(zh&tc.TFLAG_NO_PRINTER)||!Iu)F=1;for(s=1;s<Kl;s++){kl[s].flags&=~tc.PARA_FRAME_SELECT;if(s==n)continue;if(n>0&&kl[n].canvas>0&&kl[n].canvas==kl[s].canvas)continue;if(n>0&&kl[s].ShapeType>0&&Dj(kl[s].flags2&tc.PF2_WRAP_AROUND))continue;if(Nj(kl[s].flags2&tc.PF2_OVERLAY))continue;if(!kl[s].InUse)continue;if((kl[s].flags&tc.PARA_FRAME_WATERMARK)!=0)continue;if(kl[s].ShapeType==tc.SHPTYPE_LINE||(kl[s].flags&tc.PARA_FRAME_LINE)!=0)continue;if(kl[s].canvas!=X)continue;if((kl[s].flags2&tc.PF2_INLINE)!=0)continue;if((kl[s].flags&tc.PARA_FRAME_POSITIONED)==0)continue;if(t>0&&f&&Nj(ui[t].flags&tc.LFLAG_PICT)){var ot=ui[t].len;for(_=0;_<ot;_++){if(xs[ct[_]].ParaFID==s){if(Dj(kl[s].flags&(tc.PARA_FRAME_VPAGE|tc.PARA_FRAME_VMARG))){if(Nj(mV(kl[s].ParaY)>=ui[t].height))break}}}if(_<ot)continue}K=kl[s].TextLine;if(K>=0&&K<Ri&&(Nc[ui[K].pfmt].flags&tc.PAGE_HDR_FTR)!=0)z=K5(K);else z=0;if(kl[s].PageNo==a&&Nj(z&tc.LFLAG_HDR_FTR)){var ut=po[a].TopSect;if(Nj(to[ut].flags&tc.SECT_HAS_TITLE_PAGE)){if(Nj(z&(tc.LFLAG_HDR|tc.LFLAG_RHDR|tc.LFLAG_LHDR))&&eo[ut].fhdr.FirstLine>=0)continue;if(Nj(z&(tc.LFLAG_FTR|tc.LFLAG_RFTR|tc.LFLAG_LFTR))&&eo[ut].fftr.FirstLine>=0)continue}}if(kl[s].PageNo!=a){var Tt=kl[s].PageNo;if(Nj(z)&&Tt>=0){if(Tt>a)continue;if(Nj(z&(tc.LFLAG_HDR|tc.LFLAG_RHDR|tc.LFLAG_LHDR))&&po[Tt].TopSect!=po[a].HdrSect)continue;if(Nj(z&(tc.LFLAG_FTR|tc.LFLAG_RFTR|tc.LFLAG_LFTR))&&po[Tt].TopSect!=po[a].FtrSect)continue;if(Nj(z&tc.LFLAG_FHDR)||Nj(z&tc.LFLAG_FFTR))continue}else continue}if(Nj(Z)&&Nj(z)&&Z!=z)continue;if(z!=0&&Z==z&&kl[s].ShapeType==0&&Dj(kl[s].flags&tc.PARA_FRAME_OBJECT))continue;if(Nj(kl[s].flags&tc.PARA_FRAME_WRAP_IGNORE))continue;N=0;if(kl[s].pict>0)N=kl[s].CellId;if(W&&p!=N)continue;if(!W&&N>0)continue;if(K>=0&&K<Ri){if(z!=k){if(Nj(z&tc.LFLAG_HDRS)&&Nj(k&tc.LFLAG_FTRS))continue;if(Nj(z&tc.LFLAG_FTRS)&&Nj(k&tc.LFLAG_HDRS))continue}if(false&&Nj(z)&&Dj(k)){if(kl[s].ShapeType!=tc.SHPTYPE_PICT_FRAME)continue}if(Nj(k)&&Dj(z&tc.LFLAG_HDRS_FTRS))continue;if(Nj(k&tc.LFLAG_FTR)&&Nj(z&tc.LFLAG_HDR))continue;if(Nj(z)&&z==k){if(kl[s].ShapeType!=0&&kl[s].ShapeType!=tc.SHPTYPE_PICT_FRAME)continue;if(Nj(kl[s].flags&tc.PARA_FRAME_OBJECT))continue}}if(Nj(kl[s].flags2&tc.PF2_WRAP_TIGHT))lt=at=0;else{lt=kl[s].DistFromTextLeft;at=kl[s].DistFromTextRight;if(kl[s].ShapeType!=0||Nj(kl[s].flags&tc.PARA_FRAME_OBJECT)){}}u=DV(kl[s].x+kl[s].width);if(u<=g)continue;u=DV(kl[s].x-at);if(u>g+d)continue;if(false&&f&&u>g+x&&Dj(kl[s].flags&tc.PARA_FRAME_NO_WRAP))continue;if(n>0){if(kl[s].x>kl[n].x+kl[n].width)continue;if(kl[n].x>kl[s].x+kl[s].width)continue;F=360}A=mV(kl[s].y);E=mV(kl[s].y+kl[s].height);if(Dj(kl[s].flags2&tc.PF2_WRAP_TIGHT)){A-=mV(kl[s].DistFromTextTop);E+=mV(kl[s].DistFromTextBot)}if(f){if(O>=E-F)continue}else if(v<=A+F||O>=E-F)continue;y=false;if(i||f&&Q>0){if(A-m<O){O=A-2*m;y=true}if(E+m>v){v=E+2*m;y=true}}if(y){s=0;continue}var At=Nj(kl[s].flags&tc.PARA_FRAME_IN_CELL)&&Dj(kl[s].flags&tc.PARA_FRAME_WRAP_IGNORE);if(At){u=DV(kl[s].x);T=DV(kl[s].x+kl[s].width)}else{u=DV(kl[s].x-lt);if(Nj(n)&&Nj(kl[s].flags2&tc.PF2_WRAP_AROUND))T=DV(kl[s].x+kl[s].width);else T=DV(kl[s].x+kl[s].width+at)}if(Nj(kl[s].flags&tc.PARA_FRAME_NO_WRAP)||U){if(u>g)u=g;if(T<g+d)T=g+d}if(i){if(T<G)continue;if(u>B)continue}if((b>1||X>0)&&(u>g+d||T<g))continue;if(J){var Et=g+d-T;var Rt=T-u;u=g+Et;T=u+Rt}if(u-C<=g&&T+I>=g+d){if(f){u=g;T=g+d}M=true;if(E>w)w=E;if(et)continue}if(!At){if(u-C<=g)u-=C;if(T+I>=g+d)T+=I}if(f){if(pRect==null){ft=10;pRect=[ft+1];rt=[ft+1];it=0}else if(it>=ft){ft=it*3/2;pRect=fV(pRect,ft+1);rt=fV(rt,ft+1)}pRect[it]=new tc.RECT;pRect[it].left=u;pRect[it].right=T;pRect[it].top=A;pRect[it].bottom=E;rt[it]=s;it++}if(D){R=u;L=T;S=A;h=E}else{if(u<R)R=u;if(T>L)L=T;if(A<S)S=A;if(E>h)h=E}D=false;kl[s].flags|=tc.PARA_FRAME_SELECT;if(Nj(kl[s].flags&tc.PARA_FRAME_NO_WRAP))M=true}if(D)return false;if(false&&Q==0&&f){var Lt=L+I>d;if(Lt){Q++;continue t}}break}if(false&&f&&R>g+x)return false;if(f){if(pRect==null||rt==null)return false;OF=tt=bW(t,pRect,rt,it,O,g,d,x,P,0,0);return true}if(i){if(L+H<d)return false}if(t>=0&&R<0){var Ct=ui[t].pfmt;var It=Nc[Ct].LeftIndentTwips;if(Nj(ui[t].flags&tc.LFLAG_PARA_FIRST))It+=Nc[Ct].FirstIndentTwips;It=DV(It);if(It<R)R=It+1}R-=g;L-=g;if(L<R)L=R;if(L>d)L=d;if(R<C&&R>0)R=0;if(L>d)L=d;if(t>=0&&L>R&&L<d&&Nj(ui[t].flags2&tc.LFLAG2_SPACE_TAKING_FRAME)){var dt=ib(t,0);if(dt>=0&&dt<Ys&&xs[dt].ParaFID>0){var Ft=xs[dt].ParaFID;var gt=DV(kl[Ft].width);if(L+gt>=d){R=0;L=d;h=w}}}if(t>=0&&R==0){if(L+xs[0].CharWidth[tc.CHAR_W]>=d)L=d}q=R;$=L-R;if(R<=0&&L>=d||M||i){if(M)h=w;if(h>o){var Pt=P/3;if(Pt>100)Pt=100;if(!i)Pt=Pt/2;tt=h-o+mV(Pt)}}HF=q;mF=$;OF=tt;return true}function BW(t,e){var r,i,f;if(t<0)return 0;if(MW(t,new tc.RECT,e,false,false,true,-1)){if(HF<0){mF+=HF;HF=0;if(mF<0)mF=0}if(OF==0&&HF==0)return mF}return 0}function HW(t,e){var r,i,f;var l=0;if(t<0)return 0;if(MW(t,new tc.RECT,e,true,false,false,-1))l=OF;return l}function mW(t,e,r,i){var f,l,a;var n=0;if(t<0)return 0;if(MW(t,new tc.RECT,e,false,true,false,i))n=OF;if(r){if(n>0){if(Dj(ui[t].tabw)&&(ui[t].tabw=new tc.TejTabw)!=null)ui[t].tabw.section=e;if(Nj(ui[t].tabw)){ui[t].tabw.type|=tc.INFO_FRM_SPC_BEF;ui[t].tabw.height=n}}else if(Nj(ui[t].tabw)){ui[t].tabw.type=cj(ui[t].tabw.type,tc.INFO_FRM_SPC_BEF);ui[t].tabw.height=0}}return n}function wW(t,e){var r=0;if(!oi.PageMode)return 0;if(t<0||t>=Ri||Nj(ui[t].fid))return 0;if(Nj(ui[t].tabw)&&Nj(ui[t].tabw.type&tc.INFO_FRM_SPC_BEF))r=ui[t].tabw.height;if(e&&Nj(r))r=yV(r);return r}function bW(t,e,r,i,f,l,a,n,c,s,_){var o,u,T,A,E,R=0;var L=null;var C=0,I=0,d=0;var F=DV(360);HF=mF=wF=0;T=f;for(o=0;o<i;o++)if(e[o].bottom>T)T=e[o].bottom;if(T==f)return 0;R=T;I=3;L=[I+1];L[0]=new tc.RECT;L[0].left=l;L[0].top=f;L[0].right=l+a;L[0].bottom=LastFrameY=T;C=1;if(f+c>LastFrameY){c=LastFrameY-f-1}for(o=0;o<i;o++){A=C-1;for(u=0;u<=A;u++){var g=false;if(L[u].top==L[u].bottom)continue;if(e[o].bottom<=L[u].top)continue;if(e[o].top>=L[u].bottom)continue;if(e[o].right<=L[u].left)continue;if(e[o].left>=L[u].right)continue;if(e[o].top<=L[u].top&&e[o].bottom>=L[u].bottom&&e[o].left<=L[u].left&&e[o].right>=L[u].right){L[u].bottom=L[u].top;continue}if(C+4>=I){I=C+4;L=fV(L,I+1)}if(e[o].top>L[u].top){L[C]=L[u].copy();L[C].bottom=e[o].top;C++;g=true}if(e[o].bottom<L[u].bottom){L[C]=L[u].copy();L[C].top=e[o].bottom;C++;g=true}if(e[o].left>L[u].left){L[C]=L[u].copy();L[C].right=e[o].left;if(e[o].top>L[u].top)L[C].top=e[o].top;if(e[o].bottom<L[u].bottom)L[C].bottom=e[o].bottom;C++;g=true}if(e[o].right<L[u].right){L[C]=L[u].copy();L[C].left=e[o].right;if(e[o].top>L[u].top)L[C].top=e[o].top;if(e[o].bottom<L[u].bottom)L[C].bottom=e[o].bottom;C++;g=true}if(g){L[u].bottom=L[u].top}}}for(o=0;o<C;o++){for(u=o+1;u<C;u++){var P=L[u].top<L[o].top;if(!P&&L[u].top==L[o].top&&L[u].left==L[o].left)P=true;if(P){var S=L[u];L[u]=L[o];L[o]=S}}}for(o=0;o<C;o++){if(L[o].top==L[o].bottom)continue;for(u=o+1;u<C;u++){if(L[u].top==L[u].bottom)continue;if(L[o].left==L[u].left&&L[o].right==L[u].right&&Math.abs(L[o].bottom-L[u].top)<1){L[o].bottom=L[u].bottom;L[u].bottom=L[u].top}else if(L[o].left==L[u].left&&Math.abs(L[o].bottom-L[u].top)<1){var h=l+n;if(l>=L[o].left&&h<=L[o].right&&l>=L[u].left&&h<=L[u].right){L[o].bottom=L[u].bottom;L[u].bottom=L[u].top}}}}E=0;if(false&&n>0){var O=ui[t].txt;var v=nb(t);var p=ui[t].len;for(o=0;o<p;o++){var N=v[o];if(Nj(xs[N].style&tc.PICT)){if(xs[N].ParaFID==0)continue;E=DV(xs[N].PictWidth);break}else{if(um(N))continue;else break}}}E=G$(t,false);if(E==0&&Nj(ui[t].flags&tc.LFLAG_PICT))c=0;if(F<E)F=E;for(o=0;o<C;o++){var D=L[o].right-L[o].left;var M=L[o].bottom-L[o].top;if(L[o].top==L[o].bottom)continue;if(M<c){if(o+1<C){for(u=o+1;u<C;u++){if(L[u].top==L[o].bottom){var G=L[u].bottom-L[u].top;var B=c-M;if(G>=B){if(L[u].left<=L[o].left&&L[u].right>=L[o].right)break}}}if(u==C)continue}}if(D==0)continue;if(L[o].left==l){if(D<s)continue;else break}else if(L[o].right==l+a){if(D<_)continue;else break}else{if(D>F||L[o].left<=l&&D<E||L[o].right<=l+a&&D<E){wF=D;break}}}if(o<C){d=L[o].top-f;if(L[o].left==l){var H;HF=L[o].right;H=-1;for(u=o+1;u<C;u++){if(L[u].top==L[u].bottom)continue;if(L[o].top>=L[u].top&&L[o].top+c<=L[u].bottom)H=u}if(H==-1)mF=l+a-HF;else{var m=L[H].left;if(m+_>=l+a)m=l+a+1;mF=m-HF}}else{HF=l;mF=L[o].left-l}HF-=l}else d=R-f;return d}function xW(t){if(t==0)return false;if(kl[t].pict>0){var e=0,r=0;var i=kl[t].pict;if(_i.TerLocateFontId(i,e,r)){e=PC;r=SC;sA=e;TA=r;_A=e;AA=r+1;OA=false;uA=tc.HILIGHT_CHAR}}else{var f;for(f=0;f<Ri;f++)if(ui[f].fid==t)break;sA=f;TA=0;for(;f+1<Ri-1;f++)if(ui[f+1].fid!=t)break;_A=f;AA=ui[f].len;OA=false;uA=tc.HILIGHT_CHAR}return true}_i.TerSelectFrameText=function(t){var e;var r;if(!_i.TerCreateControl())return false;e=ui[br].fid;if(e==0)return false;for(r=br;r>0;r--)if(ui[r-1].fid!=e)break;sA=r;TA=0;for(r=br;r<Ri-1;r++)if(ui[r+1].fid!=e)break;_A=r;AA=ui[r].len-1;if(AA<0)AA=0;OA=false;uA=tc.HILIGHT_CHAR;if(t)cG();return true};_i.TerSetNewFrameDim=function(t,e,r,i,f){if(!lv||!QD())_i.TerCreateControl();Hl=t;ml=e;if(r>0)Gl=r;if(i>0)Bl=i;wl=f;return true};_i.TerMoveParaFrame=function(t,e,r,i,f){return _i.TerMoveParaFrame2(t,e,r,i,f,-1)};_i.TerMoveParaFrame2=function(t,e,r,i,f,l){var a,n,c,s,_;var o,u,T,A,E=0,R;var L=new tc.Point;var C;var I=true,d=false;var F=r;if(!lv||!QD())_i.TerCreateControl();if(!oi.PageMode)return false;if(!kl[t].InUse)return false;if(Ci)r+=HV(rr);a=dV(e);n=hV(r);for(_=0;_<Dl;_++)if(!pl[_].empty&&pl[_].ParaFrameId==t)break;if(_<Dl)pl[_].empty=true;if(_<Dl){o=pl[_].PageFirstLine;if(l<0)l=ui[o].page;if(l==qe+1)n+=Ze}u=Jq(a,n);Ez(n);if(_<Dl)pl[_].empty=false;if(Nj(kl[t].flags&(tc.PARA_FRAME_VPAGE|tc.PARA_FRAME_VMARG))){for(o=0;o<Ri;o++)if(ui[o].fid==t)break;if(o<Ri&&(Nj(Nc[ui[o].pfmt].flags&tc.PAGE_HDR_FTR)||nz(o,-1)==Lo))I=false;E=o}T=WW(u);c=yW(T);B5();if(Nj(kl[t].flags&(tc.PARA_FRAME_VPAGE|tc.PARA_FRAME_VMARG))){var g=G5(I?T:E);var P=jV(to[g].TopMargin);L.y=HV(eo[g].HiddenY);if(Lo>qe)s=r-vV(Ze);else s=r;if(Nj(kl[t].flags&tc.PARA_FRAME_VPAGE)){if(Ci)s-=HV(rr);else if(yR)s+=L.y;else s+=P;if(!yR){if(!Ci)F+=P}}else{if(Ci)s-=HV(rr)+P;else if(yR)s-=P-L.y;if(yR){F-=P}}}else s=vV(n-c);for(o=br-1;o>=0;o--)if(ui[o].fid!=t)break;E=o+1;for(o=br+1;o<Ri;o++)if(ui[o].fid!=t)break;R=o-1;t:{if(!I||T>=E&&T<=R+1){V8(t,0,0,0,tc.UNDO_FRAME_LIMITED);break t}if(Ri<=tc.UNDO_LINE_LIMIT)V8(t,0,0,0,tc.UNDO_FRAME);else d=n9();C=Nc[ui[T].pfmt].flags&tc.PAGE_HDR_FTR;A=R-E+1;if(!MY(Ri+A))return true;iw(T,A,gk("B"));if(E>T){E+=A;R+=A}for(o=0;o<A;o++){dp(T+o);ui[T+o]=ui[E+o];ui[E+o]=null;ui[T+o].pfmt=cW(ui[T+o].pfmt,C)}iw(E,A,tc.CHAR_D);if(E<T)T-=A;br=T;jt=0}kl[t].x=kl[t].OrgX=e;kl[t].y=r;if(Nj(kl[t].flags&(tc.PARA_FRAME_VPAGE|tc.PARA_FRAME_VMARG)))kl[t].ParaY=F;else kl[t].ParaY=s;if(i>0)kl[t].width=i;if(f>=0)kl[t].MinHeight=f;if(Nj(kl[t].flags&tc.PARA_FRAME_OBJECT))kl[t].height=kl[t].MinHeight;if(kl[t].ShapeType==tc.SHPTYPE_PICT_FRAME&&(i>0||f>0)){var S=kl[t].pict;if(S>0){if(i>0)xs[S].PictWidth=i;if(f>0)xs[S].PictHeight=f;HN(S,hV(xs[S].PictHeight),dV(xs[S].PictWidth),false);mN(S)}}if(Nj(jh))bG(true);if(d)n9();_i.TerRepaginate(true);return true};function yW(t){var e;var r,i;if(t<0){r=-t;for(e=0;e<Ri;e++)if(ui[e].fid==r)break;if(e==Ri)return 0;t=e}for(;t<Ri;t++)if(ui[t].fid==0)break;if(t==Ri)t=Ri-1;i=Pq(t);if(GY(t,tc.INFO_FRM_SPC_BEF))i-=yV(ui[t].tabw.height);if(Nj(ui[t].cid)){var f=eR[ui[t].cid].row;i-=yV($E[f].FrmSpcBef)}return i}function WW(t){var e,r,i,f;var l,a=ui[t].fid,n=0;var c;var s;var _;var o;var u;c=Nc[ui[t].pfmt].flags&tc.PAGE_HDR_FTR;i=po[Lo].FirstLine;if(Lo+1==To)f=Ri-1;else f=po[Lo].LastLine;if(i<Fo)Fo=i;if(ui[t].fid==0)o=false;else o=true;while(n<2){if(o){if(Nj(c)){for(e=t;e<Ri&&(Nc[ui[e].pfmt].flags&tc.PAGE_HDR_FTR)==c;e++){if(ui[e].page!=Lo)continue;if(!UW(e,a))continue;if(e+1<Ri&&(Nc[ui[e+1].pfmt].flags&tc.PAGE_HDR_FTR)==c)return e+1}}else{for(e=t;e<=f;e++){if(ui[e].page!=Lo)continue;if(Nj(Nc[ui[e].pfmt].flags&tc.PAGE_HDR_FTR))continue;if(!UW(e,a))continue;if(e+1<=f)return e+1}}}else{if(Nj(c)){for(e=t-1;e>=0&&(Nc[ui[e].pfmt].flags&tc.PAGE_HDR_FTR)==c;e--){if(ui[e].page!=Lo)continue;if(!UW(e,a))continue;if(e+1<Ri&&(Nc[ui[e+1].pfmt].flags&tc.PAGE_HDR_FTR)==c)return e+1}}else{if(t==0&&ui[t].fid==0)return t;for(e=t-1;e>=i-1&&e>=0;e--){if(ui[e].page!=Lo)continue;if(!UW(e,a))continue;if(e+1<=f)return e+1}}}o=!o;n++}if(t==0&&ui[t].fid==0)return t;for(e=t-1;e>=i-1&&e>=0;e--){if(ui[e].page!=Lo)continue;if(Dj(ui[e].flags&tc.LFLAG_PARA_FIRST))continue;if(Nj(lO&tc.TFLAG11_FRAME_BEF_TABLE)&&Nj(ui[e].cid))continue;if(Nj(ui[e].cid)&&(Dj(ui[e].tabw)||Dj(ui[e].tabw.type&tc.INFO_ROW)))continue;if(Nj(ui[e].fid))if(e>0&&ui[e-1].fid==ui[e].fid)continue;return e}if(Nj(lO&tc.TFLAG11_FRAME_BEF_TABLE)&&e<0)return 0;if(t>0&&Dj(ui[t-1].flags&tc.LFLAG_HDRS_FTRS)){r=t-1;l=ui[r].len;s=ui[r].txt;if(l>0)u=s[l-1];else u=0;if(u!=Bn&&u!=TR&&!xY(qS,u)){Tm(r,l,l+1);s=ui[r].txt;_=nb(r);s[l]=Bn;_[l]=tc.DEFAULT_CFMT;sb(r)}}return t}function UW(t,e){var r;var i;var f;if(ui[t].len==0)return false;f=ui[t].len;r=ui[t].txt;i=r[f-1];if(i!=Bn&&!xY(qS,i))return false;if(Nj(lO&tc.TFLAG11_FRAME_BEF_TABLE)&&Nj(ui[t].cid))return false;if(Nj(ui[t].cid)&&(Dj(ui[t].tabw)||Dj(ui[t].tabw.type&tc.INFO_ROW)))return false;if(t+1<Ri&&Nj(ui[t+1].flags&tc.LFLAG_HDRS_FTRS))return false;if(t<Ri-1&&(ui[t+1].fid==0||ui[t+1].fid!=e))return true;else return false}function kW(){var t,e;var r;var i;if(!GR&&Pr){for(t=1;t<Kl;t++)kl[t].InUse=false;for(i=0;i<Ri;i++){e=ui[i].fid;kl[e].InUse=true}for(t=0;t<Ys;t++){if(xs[t].InUse&&Nj(xs[t].style&tc.PICT)&&xs[t].FrameType!=tc.PFRAME_NONE){e=xs[t].ParaFID;kl[e].InUse=true}}for(t=1;t<Kl;t++){if(!kl[t].InUse){kl[t]=new tc.ClsParaFrame;return t}}}if(Kl>=Yl){r=Yl+Yl/2;kl=fV(kl,r);Yl=r}if(Kl<Yl){Kl++;kl[Kl-1]=new tc.ClsParaFrame;return Kl-1}QY(tc.MSG_OUT_OF_PARAFID_SLOT,"GetParaFrameSlot");return-1}_i.TerSetFrameMarginDist=function(t){if(!lv||!QD())_i.TerCreateControl();de=t;return true};_i.TerSetFrameTextDist=function(t,e){if(!lv||!QD())_i.TerCreateControl();if(t<=0)t=ui[br].fid;if(t<=0||t>=Kl||!kl[t].InUse)return false;kl[t].DistFromTextLeft=e;kl[t].DistFromTextRight=e;_z(true);return true};_i.TerGetDrawObjectInfo=function(t){zI=ZI=ad=0;LF=CF=tc.CLR_WHITE;YI=0;if(!lv||!QD())_i.TerCreateControl();if(t<0||t>=Kl||!kl[t].InUse)return false;zI=kl[t].width;ZI=kl[t].height;ad=kl[t].LineWdth;LF=kl[t].LineColor;CF=kl[t].BackColor;YI=kl[t].flags;return true};_i.TerGetFrameParam=function(t,e){var r;if(!lv||!QD())_i.TerCreateControl();if(t<0){t=ui[br].fid;if(t==0)return tc.FP_ERROR}if(t<0||t>=Kl||!kl[t].InUse)return tc.FP_ERROR;if(e==tc.FP_TEXT_ROTATION){var i=kl[t].TextAngle;if(i==270)return tc.TEXT_TOP_TO_BOT;else if(i==90)return tc.TEXT_BOT_TO_TOP;else return tc.TEXT_HORZ}else if(e==tc.FP_WRAP_STYLE){r=kl[t].flags;if(Nj(r&tc.PARA_FRAME_NO_WRAP))return tc.SWRAP_NO_WRAP;else if(Nj(r&tc.PARA_FRAME_WRAP_IGNORE))return tc.SWRAP_THRU;else return tc.SWRAP_AROUND}else if(e==tc.FP_YBASE){r=kl[t].flags;if(Nj(r&tc.PARA_FRAME_VPAGE))return tc.BASE_PAGE;else if(Nj(r&tc.PARA_FRAME_VMARG))return tc.BASE_MARG;else return tc.BASE_PARA}else if(e==tc.FP_FILL_PATTERN)return kl[t].FillPattern;else if(e==tc.FP_TEXT_DIST)return(kl[t].DistFromTextLeft+kl[t].DistFromTextRight)/2;else if(e==tc.FP_ARROW_TYPE)return kl[t].flags2&(tc.PF2_START_ARROW|tc.PF2_END_ARROW);else if(e==tc.FP_X)return kl[t].x;else if(e==tc.FP_Y)return kl[t].ParaY;else if(e==tc.FP_ZORDER)return kl[t].ZOrder;else if(e==tc.FP_PICT)return kl[t].pict;else if(e==tc.FP_SHAPE_TYPE)return kl[t].ShapeType;else if(e==tc.FP_FLAGS)return kl[t].flags;else if(e==tc.FP_FLAGS2)return kl[t].flags2;else if(e==tc.FP_PAGE_NO)return kl[t].PageNo;else if(e==tc.FP_LINE_THICKNESS)return kl[t].LineWdth;else if(e==tc.FP_WIDTH)return kl[t].width;else if(e==tc.FP_HEIGHT)return kl[t].height;else if(e==tc.FP_LINE_TYPE)return kl[t].LineType;else if(e==tc.FP_CANVAS)return kl[t].canvas;else if(e==tc.FP_SIDE_MARGIN)return kl[t].margin;else if(e==tc.FP_TOP_MARGIN)return kl[t].TopMarg;else if(e==tc.FP_BOT_MARGIN)return kl[t].BotMarg;return tc.FP_ERROR};_i.TerGetFrameParamClr=function(t,e){if(!lv||!QD())_i.TerCreateControl();if(t<0){t=ui[br].fid;if(t==0)return tc.CLR_ERROR}if(t<0||t>=Kl||!kl[t].InUse)return tc.CLR_ERROR;if(e==tc.FP_LINE_COLOR)return kl[t].LineColor;else if(e==tc.FP_FILL_COLOR)return kl[t].BackColor;return tc.CLR_ERROR};_i.TerSetFrameParam=function(t,e,r){if(!lv||!QD())_i.TerCreateControl();if(t<0){t=ui[br].fid;if(t==0)return false}if(t<0||t>=Kl||!kl[t].InUse)return false;if(e==tc.FP_TEXT_ROTATION)kl[t].TextAngle=r;else if(e==tc.FP_WRAP_STYLE){kl[t].flags=cj(kl[t].flags,tc.PARA_FRAME_NO_WRAP|tc.PARA_FRAME_WRAP_IGNORE);if(r==tc.SWRAP_NO_WRAP)kl[t].flags|=tc.PARA_FRAME_NO_WRAP;else if(r==tc.SWRAP_THRU)kl[t].flags|=tc.PARA_FRAME_WRAP_IGNORE}else if(e==tc.FP_YBASE){kl[t].flags=cj(kl[t].flags,tc.PARA_FRAME_VPAGE|tc.PARA_FRAME_VMARG);if(r==tc.BASE_PAGE)kl[t].flags|=tc.PARA_FRAME_VPAGE;else if(r==tc.BASE_MARG)kl[t].flags|=tc.PARA_FRAME_VMARG}else if(e==tc.FP_FILL_PATTERN)kl[t].FillPattern=r;else if(e==tc.FP_TEXT_DIST)kl[t].DistFromTextLeft=kl[t].DistFromTextRight=r;else if(e==tc.FP_ARROW_TYPE)kl[t].flags2|=r;else if(e==tc.FP_X)kl[t].x=r;else if(e==tc.FP_Y)kl[t].ParaY=r;else if(e==tc.FP_ZORDER)kl[t].ZOrder=r;else if(e==tc.FP_PICT)kl[t].pict=r;else if(e==tc.FP_SHAPE_TYPE)kl[t].ShapeType=r;else if(e==tc.FP_FLAGS)kl[t].flags=r;else if(e==tc.FP_FLAGS2)kl[t].flags2=r;else if(e==tc.FP_PAGE_NO)kl[t].PageNo=r;else if(e==tc.FP_LINE_THICKNESS)kl[t].LineWdth=r;else if(e==tc.FP_WIDTH)kl[t].width=r;else if(e==tc.FP_HEIGHT)kl[t].height=r;else if(e==tc.FP_LINE_TYPE)kl[t].LineType=r;else if(e==tc.FP_CANVAS){kl[t].canvas=r;if(r>0&&r<Kl)kl[r].flags|=tc.PARA_FRAME_SHPGRP}else if(e==tc.FP_SIDE_MARGIN)kl[t].margin=r;else if(e==tc.FP_TOP_MARGIN)kl[t].TopMarg=r;else if(e==tc.FP_BOT_MARGIN)kl[t].BotMarg=r;else return false;return true};_i.TerSetFrameParamClr=function(t,e,r){if(!lv||!QD())_i.TerCreateControl();if(t<0||t>=Kl||!kl[t].InUse)return false;if(e==tc.FP_LINE_COLOR)kl[t].LineColor=r;else if(e==tc.FP_FILL_COLOR)kl[t].BackColor=r;else return false;return true};_i.TerConnectTextBoxes=function(t,e){var r,i,f,l,a,n,c,s,_;if(!lv||!QD())_i.TerCreateControl();if(t<0||t>=Kl||!kl[t].InUse)return false;if(e<0||e>=Kl||!kl[e].InUse)return false;if(kl[e].NextId>0||kl[e].PrevId>0)return false;if(Dj(kl[t].flags&tc.PARA_FRAME_TEXT_BOX)&&Dj(kl[t].flags2&tc.PF2_EMPTY_TEXT_BOX))return false;if(Dj(kl[e].flags&tc.PARA_FRAME_TEXT_BOX)&&Dj(kl[e].flags2&tc.PF2_EMPTY_TEXT_BOX))return false;if(kl[t].ShapeType!=tc.SHPTYPE_TEXT_BOX&&!XW(t))return false;if(kl[e].ShapeType!=tc.SHPTYPE_TEXT_BOX&&!XW(e))return false;i=t;while((f=kl[i].PrevId)>0)i=f;l=i;for(a=0;a<Ri;a++){i=ui[a].fid;if(i>0&&i!=l&&l==aU(a))ui[a].fid=l}for(i=kl[l].NextId;i>0;i=kl[i].NextId){kl[i].flags=cj(kl[i].flags,tc.PARA_FRAME_TEXT_BOX);kl[i].flags|=tc.PARA_FRAME_RECT;kl[i].flags2|=tc.PF2_EMPTY_TEXT_BOX;kl[i].ShapeType=tc.SHPTYPE_RECT}kl[e].flags=cj(kl[e].flags,tc.PARA_FRAME_TEXT_BOX);kl[e].flags|=tc.PARA_FRAME_RECT;kl[e].flags2|=tc.PF2_EMPTY_TEXT_BOX;kl[e].ShapeType=tc.SHPTYPE_RECT;c=s=-1;for(a=0;a<Ri;a++){if(ui[a].fid==e){if(c==-1)c=a;s=a}}if(c>=0)iw(c,s-c+1,tc.CHAR_D);if(kl[t].ShapeId==0||kl[e].ShapeId==0){_=0;for(r=1;r<Kl;r++)if(kl[r].ShapeId>_)_=kl[r].ShapeId;_++;if(_<1100)_=1100;if(kl[t].ShapeId==0){kl[t].ShapeId=_;_++}if(kl[e].ShapeId==0){kl[e].ShapeId=_;_++}}n=kl[t].NextId;kl[t].NextId=e;kl[t].NextShapeId=kl[e].ShapeId;kl[e].NextId=n;kl[e].PrevId=t;if(kl[e].NextId==0)kl[e].NextShapeId=kl[e].ShapeId;else kl[e].NextShapeId=kl[n].ShapeId;oi.modified++;_i.TerRepaginate(true);return true};_i.TerDrawObjectToShape=function(t,e){if(!lv||!QD())TerCreateControl();return KW(t,e)};function XW(t){return KW(t,-1)}function KW(t,e){var r=Pr;var i,f,l,a;if(Dj(kl[t].flags&tc.PARA_FRAME_OBJECT))return false;l=a=-1;for(i=0;i<Ri;i++){if(ui[i].fid==t){if(l==-1)l=i;a=i}}if(l<0)return false;if(a==Ri-1)return false;Pr=false;if((f=Nx())==-1){Pr=r;return false}Pr=r;xs[f].InUse=true;xs[f].style=tc.PICT;xs[f].PictType=tc.PICT_SHAPE;xs[f].PictHeight=kl[t].height;xs[f].PictWidth=kl[t].width;xs[f].ParaFID=t;xs[f].FrameType=tc.PFRAME_FLOAT;r=Pr;Pr=false;HN(f,hV(xs[f].PictHeight),dV(xs[f].PictWidth),true);mN(f);if(e>=0&&e<Ri)br=e;else if(e==-1){if(Nj(kl[t].flags&(tc.PARA_FRAME_RECT|tc.PARA_FRAME_LINE))){ui[l].fid=0;br=l}else br=a+1}while(br+1<Ri&&ui[br].fid>0)br++;jt=0;_i.TerInsertObjectId(f,false);kl[t].pict=f;kl[t].OrgX=kl[t].x;if(Nj(kl[t].flags&tc.PARA_FRAME_TEXT_BOX))kl[t].ShapeType=tc.SHPTYPE_TEXT_BOX;else if(Nj(kl[t].flags&tc.PARA_FRAME_RECT))kl[t].ShapeType=tc.SHPTYPE_RECT;else if(Nj(kl[t].flags&tc.PARA_FRAME_LINE))kl[t].ShapeType=tc.SHPTYPE_LINE;oi.modified++;_i.TerFlushUndo();return true}_i.TerCreateShape=function(t,e,r,i,f,l,a,n,c,s,_,o){var u;var T=false,A=false;var E;var R;if(!lv||!QD())_i.TerCreateControl();nd=R=0;if(i<0){var L=G9(-1,0,true,-1);i=Mj(gV(L),-i,100)}if(i==0){T=true;i=G9(-1,0,true,-1);i=gV(i)}if(f==0){A=true;f=vV(xs[0].height)}E=Pr;Pr=false;if((u=Nx())==-1){Pr=E;return 0}Pr=E;xs[u].InUse=true;xs[u].style=tc.PICT;xs[u].PictType=tc.PICT_SHAPE;xs[u].PictHeight=f;if(i<0){var C=M9(0,0);if(i<-100)i=-100;C=gV(C);xs[u].PictWidth=Mj(C,-i,100)}else xs[u].PictWidth=i;xs[u].PictHeight=f;E=Pr;Pr=false;if((R=kW())<0){gb(u);Pr=E;return 0}Pr=E;kl[R]=new tc.ClsParaFrame;kl[R].InUse=true;kl[R].DistFromTextLeft=tc.FRAME_DIST_FROM_TEXT;kl[R].DistFromTextRight=tc.FRAME_DIST_FROM_TEXT;kl[R].margin=0;kl[R].BackColor=tc.CLR_WHITE;kl[R].FillPattern=1;kl[R].margin=tc.MIN_FRAME_MARGIN;kl[R].canvas=l;xs[u].ParaFID=R;xs[u].FrameType=tc.PFRAME_FLOAT;kl[R].pict=u;kl[R].ShapeType=t;kl[R].width=xs[u].PictWidth+2*kl[R].margin;if(i<0)kl[R].PctWidth=-i;kl[R].height=f;kl[R].MinHeight=kl[R].height;kl[R].LineWdth=a;kl[R].LineColor=n;kl[R].flags|=c;if(Nj(c&tc.PARA_FRAME_IN_CELL))kl[R].flags|=tc.PARA_FRAME_HCOL;if(T)kl[R].flags|=tc.PARA_FRAME_SET_WIDTH;kl[R].flags2|=s;if(A)kl[R].flags2|=tc.PF2_SET_HEIGHT;kl[R].ParaY=kl[R].y=kl[R].PageY=kl[R].OrgY=r;kl[R].x=kl[R].OrgX=e;HN(u,hV(xs[u].PictHeight),dV(xs[u].PictWidth),true);mN(u);if(_){var I;var d;for(I=br;I>=0;I--)if(Nj(ui[I].flags&tc.LFLAG_PARA_FIRST))break;if(I==0)I=0;br=I;jt=0;d=String.fromCharCode(tc.PARA_CHAR);_i.TerInsertLine(d,-1,-1,-1,-1,false);if(br>0)br--;jt=0;V8(br,0,br,ui[br].len-1,tc.CHAR_I);uE--;_i.TerInsertObjectId(u,o)}nd=R;return u};_i.TerInsertArrowLineObject=function(t,e,r,i,f){var l,a,n,c,s;var _=0;if(!lv||!QD())_i.TerCreateControl();if(!oi.PrintView)return 0;_=tc.PARA_FRAME_LINE|tc.PARA_FRAME_WRAP_IGNORE;c=Math.abs(t-r);s=Math.abs(e-i);a=t<r?t:r;n=e<i?e:i;if(0==(l=VW(a,n,c,s,false,_,true)))return 0;kl[l].BackColor=tc.Color.white;kl[l].LineColor=tc.Color.black;kl[l].FillPattern=1;kl[l].margin=tc.MIN_FRAME_MARGIN;kl[l].margin=0;kl[l].LineWdth=20;kl[l].flags|=tc.PARA_FRAME_BOXED;TW(l,t,e,r,i);if(f)kl[l].flags2|=tc.PF2_START_ARROW;else kl[l].flags2|=tc.PF2_END_ARROW;cG();return l};_i.TerInsertLineObject=function(t,e,r,i){var f,l,a,n,c;var s=0;if(!lv||!QD())_i.TerCreateControl();if(!oi.PrintView)return 0;s=tc.PARA_FRAME_LINE|tc.PARA_FRAME_WRAP_IGNORE;n=Math.abs(t-r);c=Math.abs(e-i);l=t<r?t:r;a=e<i?e:i;if(0==(f=VW(l,a,n,c,false,s,true)))return 0;kl[f].BackColor=tc.Color.white;kl[f].LineColor=tc.Color.black;kl[f].FillPattern=1;kl[f].margin=tc.MIN_FRAME_MARGIN;kl[f].margin=0;kl[f].LineWdth=20;kl[f].flags|=tc.PARA_FRAME_BOXED;TW(f,t,e,r,i);cG();return f};_i.TerInsertDrawObject=function(t,e,r,i,f){return _i.TerInsertDrawObject2(t,e,r,i,f,true)};_i.TerInsertDrawObject2=function(t,e,r,i,f,l){return _i.TerInsertDrawObject3(t,e,r,i,f,tc.PARA_FRAME_WRAP_IGNORE,0,l)};_i.TerInsertDrawObject3=function(t,i,f,l,a,n,c,s){if(!lv||!QD())_i.TerCreateControl();if(!oi.PrintView)return 0;if(t>0)return YW(t,i,f,l,a,n,c,s);var e=_i.DlgCompHeight;var r=_i.DlgFont;var _=new $t.DialogBox(te,"Insert Drawing Object",r,true,R,2);var o=_.cvs;var u=new $t.Label(o,0,0,r,"Object Type");_.addComp(u,0,0,1,1,"Left","middle",0,JV(-7));var T=new $t.RadioButton(o,0,0,JV(15),r,"Text Box",true,null,null);_.addComp(T,1,0,1,1,"left","middle",JV(15));var A=new $t.RadioButton(o,0,0,JV(15),r,"Rectangle",false,T,null);_.addComp(A,2,0,1,1,"left","middle",JV(15));var E=new $t.RadioButton(o,0,0,JV(15),r,"Line",false,A,null);_.addComp(E,3,0,1,1,"left","middle",JV(15));_.show();T.setFocus();function R(t,e,r){if(t=="Cancel"){_.hide();return}else if(t=="OK"){if(T.isSelected())t=tc.DOB_TEXT_BOX;else if(A.isSelected())t=tc.DOB_RECT;else t=tc.DOB_LINE;_.hide();return YW(t,i,f,l,a,n,c,s)}else return}};function YW(t,e,r,i,f,l,a,n){var c;var s=false,_=false;if(i<-1){var o=G9(-1,0,true,-1);i=Mj(gV(o),-i,100)}if(i==0){s=true;i=G9(-1,0,true,-1);i=gV(i)}if(f==0){_=true;f=vV(xs[0].height)}if(t==tc.DOB_TEXT_BOX)l|=tc.PARA_FRAME_TEXT_BOX;else if(t==tc.DOB_RECT)l|=tc.PARA_FRAME_RECT;else if(t==tc.DOB_LINE)l|=tc.PARA_FRAME_LINE;if(0==(c=VW(e,r,i,f,false,l,n)))return 0;kl[c].BackColor=tc.Color.white;kl[c].LineColor=tc.Color.black;kl[c].FillPattern=1;kl[c].margin=tc.MIN_FRAME_MARGIN;if(t==tc.DOB_RECT||t==tc.DOB_LINE)kl[c].margin=0;if(t==tc.DOB_LINE&&r==-1){kl[c].ParaY=MV(ui[br].height);_i.TerRepaginate(true)}kl[c].LineWdth=20;kl[c].flags|=tc.PARA_FRAME_BOXED;kl[c].flags2|=a;if(t==tc.DOB_RECT)kl[c].MinHeight=kl[c].height;else if(t==tc.DOB_LINE)kl[c].MinHeight=kl[c].height=0;if(s)kl[c].flags|=tc.PARA_FRAME_SET_WIDTH;if(_)kl[c].flags2|=tc.PF2_SET_HEIGHT;if(n)cG();return c}_i.TerDeleteParaFrame=function(t){var e,r,i=-1,f=-1;if(!lv||!QD())_i.TerCreateControl();if(t<0)t=ui[br].fid;if(t<0)return false;for(e=1;e<Ys;e++)if(xs[e].ParaFID==t)break;if(e<Ys){var l=0,a=0;if(_i.TerLocateFontId(e,l,a)){l=PC;a=SC;_i.SelectTerText(l,a,l,a+1,false);_i.TerDeleteBlock(false)}}for(r=0;r<Ri;r++){if(i<0&&ui[r].fid==t)i=r;if(i>0&&ui[r].fid!=t){f=r;break}}if(i>=0&&f>i){var n=f-1;_i.SelectTerText(i,0,n,ui[n].len,false);_i.TerDeleteBlock(false)}kl[t].InUse=false;_i.TerRepaginate(true);return true};_i.TerInsertParaFrame=function(t,e,r,i,f){if(!lv||!QD())_i.TerCreateControl();return VW(t,e,r,i,f,0,true)};_i.TerCreateParaFrameId=function(t,e,r,i){if(!lv||!QD())_i.TerCreateControl();return VW(t,e,r,i,false,0,false)};function VW(t,e,r,i,f,l,a){var n,c,s;var _,o;var u;var T;var A;if(!oi.PrintView)return 0;if(!MY(Ri+1)){QY(tc.MSG_MAX_LINES_EXCEEDED,tg.MsgString[tc.MSG_ERR_BLOCK_SIZE]);return 0}if((n=kW())<0)return 0;if(t==-1)t=Hl;if(e==-1)e=ml;if(t==-1){t=Fq(jt,br,tc.LEFT);t=gV(t);if(Ci)t-=MV(dW(Lo))}if(r<0)r=Gl;if(i<0)i=Bl;kl[n]=new tc.ClsParaFrame;kl[n].InUse=true;kl[n].x=t;kl[n].width=r;kl[n].height=i;kl[n].margin=tc.MIN_FRAME_MARGIN*2;kl[n].MinHeight=i;kl[n].DistFromTextLeft=tc.FRAME_DIST_FROM_TEXT;kl[n].DistFromTextRight=tc.FRAME_DIST_FROM_TEXT;kl[n].PageNo=Lo;kl[n].flags=l;kl[n].ZOrder=1;if(wl)kl[n].flags|=tc.PARA_FRAME_VPAGE;_=WW(br);o=_;while(o<Ri){if(ui[o].fid==0)break;o++}if(o==Ri)o--;c=Pq(o);c=vV(c);s=Pq(br);s=vV(s);if(Nj(kl[n].flags&tc.PARA_FRAME_VPAGE)){if(e==-1)e=_W(s);kl[n].ParaY=kl[n].y=e}else{if(e==-1)e=s-c;kl[n].ParaY=e;kl[n].y=kl[n].ParaY+c}if(!a)return n;A=Nc[ui[_].pfmt].flags;A=cj(A,tc.PARA_BOX_ATTRIB|tc.BULLET);if(f)A|=tc.PARA_BOX;iw(_,1,gk("B"));ui[_].fid=n;ui[_].cid=0;ui[_].pfmt=ZZ(ui[_].pfmt,Nc[ui[_].pfmt].LeftIndentTwips,Nc[ui[_].pfmt].RightIndentTwips,Nc[ui[_].pfmt].FirstIndentTwips,Nc[ui[_].pfmt].TabId,0,Nc[ui[_].pfmt].AuxId,Nc[ui[_].pfmt].Aux1Id,Nc[ui[_].pfmt].StyId,Nc[ui[_].pfmt].shading,Nc[ui[_].pfmt].pflags|tc.PFLAG_FRAME,Nc[ui[_].pfmt].SpaceBefore,Nc[ui[_].pfmt].SpaceAfter,Nc[ui[_].pfmt].SpaceBetween,Nc[ui[_].pfmt].LineSpacing,Nc[ui[_].pfmt].BkColor,Nc[ui[_].pfmt].BorderSpaceLeft,Nc[ui[_].pfmt].flow,A);Tm(_,0,1);u=ui[_].txt;T=nb(_);u[0]=Bn;T[0]=tc.DEFAULT_CFMT;sb(_);n9();br=_;jt=0;yJ(false,true,0,true);return n}_i.TerGetFrameSize=function(t){var e,r,i,f;var l,a,n,c;if(!lv||!QD())_i.TerCreateControl();l=a=n=c=0;td=ed=zI=ZI=0;if(!oi.PageMode)return false;if(t>0&&!kl[t].InUse)return false;if(t<=0){t=ui[br].fid;if(t<=0)return false}e=kl[t].x;r=kl[t].y;i=_i.TerGetPageSect(Lo);f=to[i].LeftMargin*1440;e+=f;r=hV(r);r=r-Gt+rt.top;_i.TerScrToTwipsY(r);r=sd;td=e;ed=r;zI=kl[t].width;ZI=kl[t].height;return true};function jW(t){if(t<0){var e=-t;if(e>0&&e<Dl)t=pl[e].ParaFrameId;else return false}if(t<=0||t>=Kl)return false;if(kl[t].FillOpacity>0){var r=kl[t].ShapeType==tc.SHPTYPE_TEXT_BOX||Nj(kl[t].flags&tc.PARA_FRAME_TEXT_BOX);if(!r&&JW(t))r=true;return r}return false}function JW(t){var e=0;if(t==0)return false;if(t>0)e=kl[t].OrigShapeType;else e=-t;return e==tc.SHPTYPE_ARROW||e==tc.SHPTYPE_ROUND_RECT||e==tc.SHPTYPE_ELLIPSE||e==tc.SHPTYPE_CHART_DECISION||e==tc.SHPTYPE_RR_CALLOUT||e==tc.SHPTYPE_CHART_ALT_PROCESS||e==tc.SHPTYPE_CHART_MAG_DRUM||e==tc.SHPTYPE_CHART_ONLINE_STORAGE||e==tc.SHPTYPE_CROSSED_CIRCLE}function zW(t){var e=0;vI=pI=hI=OI=0;if(t==0)return true;if(kl[t].OrigShapeType==tc.SHPTYPE_ARROW){var r=22e3;var i=kl[t].AdjVal1==0?16500:kl[t].AdjVal1;var f=kl[t].AdjVal2==0?5500:kl[t].AdjVal2;var l=Mj(kl[t].width,i,r);var a=Mj(kl[t].height,f,r);hI=0;OI=(kl[t].width-l)*6/10;vI=pI=a}else if(kl[t].OrigShapeType==tc.SHPTYPE_ROUND_RECT){e=kl[t].width;if(kl[t].height<e)e=kl[t].height;e=e/4;if(kl[t].AdjVal1>0)e=kl[t].AdjVal1;vI=pI=hI=OI=e}else if(kl[t].OrigShapeType==tc.SHPTYPE_ELLIPSE){vI=pI=kl[t].height*.2928;hI=OI=kl[t].width*.2928-kl[t].margin}else if(kl[t].OrigShapeType==tc.SHPTYPE_CHART_DECISION){vI=pI=kl[t].height/4;hI=OI=kl[t].width/4-kl[t].margin}else if(kl[t].OrigShapeType==tc.SHPTYPE_RR_CALLOUT){e=0;if(kl[t].width<kl[t].height)e=kl[t].width/12;else e=kl[t].height/12;vI=pI=hI=OI=e}else if(kl[t].OrigShapeType==tc.SHPTYPE_CHART_ALT_PROCESS){e=0;if(kl[t].width<kl[t].height)e=kl[t].width/7;else e=kl[t].height/7;vI=pI=hI=OI=e}else if(kl[t].OrigShapeType==tc.SHPTYPE_CHART_MAG_DRUM){e=kl[t].height/2;if(e>kl[t].width/6)e=kl[t].width/6;hI=e;OI=2*e;vI=kl[t].height/10;pI=0}else if(kl[t].OrigShapeType==tc.SHPTYPE_CHART_ONLINE_STORAGE){e=kl[t].width/6;hI=e;OI=e;vI=kl[t].height/10;pI=0}return true}_i.TerSetFrameYBase=function(i,f){var t,l;if(!lv||!QD())_i.TerCreateControl();if(!oi.PageMode)return false;if(i>=0){if(i<=0||i>=Kl||Dj(kl[i].InUse))return false;for(t=0;t<Ri;t++){if(ui[t].fid==i)break}if(t==Ri)return false;l=t;return ZW(i,f,l)}l=br;i=ui[br].fid;if(i<=0){var e=ib(br,jt);if(Dj(xs[e].style&tc.PICT)||xs[e].FrameType==tc.PFRAME_NONE)return false;i=xs[e].ParaFID}var r=kl[i].flags;var a=_i.DlgCompHeight;var n=_i.DlgFont;var c=new $t.DialogBox(te,"Object Position",n,true,A,JV(2));var s=c.cvs;var _=new $t.Label(s,0,0,n,"Vertical Position Relative to");c.addComp(_,0,0,1,1,"Left","middle",0,JV(-7),JV(10),0);var o=new $t.RadioButton(s,0,0,JV(15),n,"Top of the Page",Nj(r&tc.PARA_FRAME_VPAGE),null,null);c.addComp(o,1,0,1,1,"left","middle",JV(15));var u=new $t.RadioButton(s,0,0,JV(15),n,"Top Margin",Nj(r&tc.PARA_FRAME_VMARG),o,null);c.addComp(u,2,0,1,1,"left","middle",JV(15));var T=new $t.RadioButton(s,0,0,JV(15),n,"Current Paragraph",Dj(r&(tc.PARA_FRAME_VPAGE|tc.PARA_FRAME_VMARG)),u,null);c.addComp(T,3,0,1,1,"left","middle",JV(15));c.show();o.setFocus();function A(t,e,r){if(t=="Cancel"){c.hide();return}else if(t=="OK"){if(o.isSelected())f=tc.BASE_PAGE;else if(u.isSelected())f=tc.BASE_MARG;else f=tc.BASE_PARA;c.hide();return ZW(i,f,l)}else return}};function ZW(t,e,r){var i,f,l,a,n;var c;var s;if(e!=tc.BASE_PAGE&&e!=tc.BASE_MARG&&e!=tc.BASE_PARA)return false;s=kl[t].flags;if(Nj(s&tc.PARA_FRAME_VPAGE)&&e==tc.BASE_PAGE)return true;if(Nj(s&tc.PARA_FRAME_VMARG)&&e==tc.BASE_MARG)return true;if(Dj(s&(tc.PARA_FRAME_VMARG|tc.PARA_FRAME_VPAGE))&&e==tc.BASE_PARA)return true;oi.modified++;f=G5(r);n=nz(r,-1);a=eo[f].HiddenY;if(e==tc.BASE_PAGE||e==tc.BASE_MARG){if(Ci)i=kl[t].y-HV(rr);else if(yR)i=kl[t].y+HV(a);else i=kl[t].y+jV(to[f].HdrMargin)+HV(Fz(n,false,true));if(e==tc.BASE_PAGE)kl[t].ParaY=i;else kl[t].ParaY=i-jV(to[f].TopMargin)}else{var _=yW(-t);if((l=iW(r))<0)return false;kl[t].ParaY=vV(pl[l].y-_)}kl[t].flags=cj(kl[t].flags,tc.PARA_FRAME_VPAGE|tc.PARA_FRAME_VMARG);if(e==tc.BASE_PAGE)kl[t].flags|=tc.PARA_FRAME_VPAGE;else if(e==tc.BASE_MARG)kl[t].flags|=tc.PARA_FRAME_VMARG;kl[t].flags=cj(kl[t].flags,tc.PARA_FRAME_IGNORE_Y);yJ(false,true,0,true);return true}_i.TerSetObjectAttrib=function(t,e,r,i,f,l){return _i.TerSetObjectAttribEx(t,e,r,i,f,l,-9999)};_i.TerSetObjectAttrib=function(t,e,r,i,f,l){if(!lv||!QD())_i.TerCreateControl();return _i.TerSetObjectAttribEx(t,e,r,i,f,l,-9999)};_i.TerSetObjectAttribEx=function(t,e,r,i,f,l,a){return _i.TerSetObjectAttribEx(t,e,r,yK(i),f,yK(l),a)};_i.TerSetObjectAttribEx=function(f,l,a,n,c,s,_){var o=0;if(!lv||!QD())_i.TerCreateControl();if(!oi.PageMode)return false;if(f>=0){if(f==0||f>=Kl||Dj(kl[f].InUse))return false;if(Dj(kl[f].flags&tc.PARA_FRAME_OBJECT)&&kl[f].pict==0)return false;o=kl[f].flags&(tc.PARA_FRAME_NO_WRAP|tc.PARA_FRAME_WRAP_IGNORE);s=new tc.Color(s);n=new tc.Color(n);return QW(f,l,a,n,c,s,_,o)}f=ui[br].fid;if(f<=0){var t=ib(br,jt);if(Dj(xs[t].style&tc.PICT)||xs[t].FrameType==tc.PFRAME_NONE)return false;f=xs[t].ParaFID}if(Dj(kl[f].flags&tc.PARA_FRAME_OBJECT))return false;var e=kl[f].flags;var r=_i.DlgCompHeight;var i=_i.DlgFont;var u=new $t.DialogBox(te,"Drawing Object Parameters",i,true,v,2);var T=u.cvs;u.addGroupBox(0,0,10,2,"Line Attributes",i,0,JV(10),0,JV(5));var A=new $t.CheckBox(T,0,0,JV(15),JV(16),i,"Draw Line or Border",false,p);u.addComp(A,1,0,1,2,"Left","middle",15);var E=new $t.Label(T,0,0,i,"Thickness (twips)");u.addComp(E,3,0,1,1,"Left","middle");var R=new $t.TextBox(T,0,0,JV(60),r,mY(kl[f].LineWdth),i,_i.caret,false,true,null);u.addComp(R,3,1,1,1,"left","middle",JV(10),0);FldLineColor=new $t.Button(T,0,0,JV(200),r,i,"Line Color...",true,N);u.addComp(FldLineColor,5,0,1,2,"left","middle");var L=new $t.Label(T,0,0,i,"Line Type");u.addComp(L,7,0,1,1,"Left","middle");var C=new $t.RadioButton(T,0,0,JV(15),i,"Solid Line",true,null,null);u.addComp(C,8,0,1,2,"left","middle",JV(15));var I=new $t.RadioButton(T,0,0,JV(15),i,"Dotted Line",false,C,null);u.addComp(I,9,0,1,2,"left","middle",JV(15));u.addGroupBox(0,2,2,3,"Fill Attributes",i,0,JV(10),0,JV(5));var d=new $t.CheckBox(T,0,0,JV(15),JV(16),i,"Transparent",false,null);u.addComp(d,1,2,1,1,"Left","middle",15);FldFillColor=new $t.Button(T,0,0,JV(70),r,i,"Color...",true,M);u.addComp(FldFillColor,1,4,1,1,"left","middle",JV(-30),0);u.addGroupBox(3,2,4,3,"Text Wrapping",i,0,JV(10),0,JV(5));var F=new $t.RadioButton(T,0,0,JV(15),i,"Wrap Through",true,null,null);u.addComp(F,4,2,1,3,"left","middle",15);var g=new $t.RadioButton(T,0,0,JV(15),i,"No Wrap",false,F,null);u.addComp(g,5,2,1,3,"left","middle",JV(15));var P=new $t.RadioButton(T,0,0,JV(15),i,"Wrap Around Object",false,g,null);u.addComp(P,6,2,1,3,"left","middle",JV(15),0,JV(30),0);u.addGroupBox(8,2,2,3,"",i,0,JV(10),0,JV(5));var S=kl[f].ZOrder;if(((kl[f].flags&tc.PARA_FRAME_BEHIND_TEXT)!=0||(kl[f].flags2&tc.PF2_BEHIND_DOC)!=0)&&S>=0){S=-S;if(S==0)S=-100}var h=new $t.Label(T,0,0,i,"Z Order");u.addComp(h,9,2,1,1,"Left","middle",JV(15),0);var O=new $t.TextBox(T,0,0,JV(60),r,mY(S),i,_i.caret,false,true,null);u.addComp(O,9,3,1,1,"left","middle",0);u.show();if(Nj(e&tc.PARA_FRAME_BOXED)){A.setSelected(true);C.setSelected(Dj(e&tc.PARA_FRAME_DOTTED));I.setSelected(Nj(e&tc.PARA_FRAME_DOTTED))}else{C.setSelected(true);C.setEnabled(false);I.setEnabled(false);FldLineColor.setEnabled(false);R.setEnabled(false)}d.setSelected(kl[f].FillPattern==0);if(kl[f].FillPattern==0)FldFillColor.setEnabled(false);if(Nj(e&(tc.PARA_FRAME_RECT|tc.PARA_FRAME_TEXT_BOX))){F.setSelected(Nj(e&tc.PARA_FRAME_WRAP_IGNORE));g.setSelected(Nj(e&tc.PARA_FRAME_NO_WRAP));P.setSelected(Dj(e&(tc.PARA_FRAME_NO_WRAP|tc.PARA_FRAME_WRAP_IGNORE)))}n=kl[f].LineColor;s=kl[f].BackColor;A.setFocus();function v(t,e,r){if(t=="Cancel"){u.hide();return}else if(t=="OK"){a=LX(R);_=LX(O);l=tc.DOB_LINE_NONE;var i=A.isSelected();if(i){if(C.isSelected())l=tc.DOB_LINE_SOLID;else l=tc.DOB_LINE_DOTTED}c=!d.isSelected();o=0;if(F.isSelected())o=tc.PARA_FRAME_WRAP_IGNORE;if(g.isSelected())o=tc.PARA_FRAME_NO_WRAP;u.hide();return QW(f,l,a,n,c,s,_,o)}else return}function p(t,e,r){var i=A.isSelected();C.setEnabled(i);I.setEnabled(i);FldLineColor.setEnabled(i);R.setEnabled(i)}function N(t,e,r){Dy("Line Color","line",n,D)}function D(t){n=t}function M(t,e,r){Dy("Background Color","bknd",s,G)}function G(t){s=t}};function QW(t,e,r,i,f,l,a,n){if(r<0)return false;if(e!=tc.DOB_LINE_NONE&&e!=tc.DOB_LINE_SOLID&&e!=tc.DOB_LINE_DOTTED)return false;kl[t].LineWdth=r;kl[t].flags=cj(kl[t].flags,tc.PARA_FRAME_BOXED|tc.PARA_FRAME_DOTTED);if(e==tc.DOB_LINE_SOLID)kl[t].flags|=tc.PARA_FRAME_BOXED;else if(e==tc.DOB_LINE_DOTTED)kl[t].flags|=tc.PARA_FRAME_BOXED|tc.PARA_FRAME_DOTTED;kl[t].LineColor=i;if(f)kl[t].FillPattern=1;else kl[t].FillPattern=0;kl[t].BackColor=l;if(a!=-9999){kl[t].ZOrder=a;kl[t].flags=cj(kl[t].flags,tc.PARA_FRAME_BEHIND_TEXT);kl[t].flags2=cj(kl[t].flags2,tc.PF2_BEHIND_DOC);if(a<0){kl[t].flags|=tc.PARA_FRAME_BEHIND_TEXT;kl[t].flags2|=tc.PF2_BEHIND_DOC}}_i.TerFixZOrder();if(Dj(kl[t].flags&tc.PARA_FRAME_LINE)){if((kl[t].flags&(tc.PARA_FRAME_NO_WRAP|tc.PARA_FRAME_WRAP_IGNORE))!=n)_z(true);kl[t].flags=cj(kl[t].flags,tc.PARA_FRAME_NO_WRAP|tc.PARA_FRAME_WRAP_IGNORE);kl[t].flags|=n}Br=tc.PAINT_WIN_RESET;if(Dj(Qh&tc.TFLAG3_HTML_READ))cG();return true}function qW(t){var e,r,i=0,f;var l;var a=[Kl+1];for(e=1;e<Kl;e++){if(!kl[e].InUse)continue;if(kl[e].ShapeType==0&&Dj(kl[e].flags&tc.PARA_FRAME_OBJECT))continue;if(Nj(kl[e].flags2&tc.PF2_TABLE_FRAME))continue;if(Nj(kl[e].InHdrFtr))continue;if(Nj(kl[e].flags&tc.PARA_FRAME_SHPGRP))return false;a[i]=new tc.ClsOrd;a[i].FrameId=e;a[i].ZOrder=kl[e].ZOrder;a[i].IsBkndFrame=Nj(kl[e].flags&tc.PARA_FRAME_BEHIND_TEXT)||Nj(kl[e].flags2&tc.PF2_BEHIND_DOC);i++}if(i==0)return false;l=true;for(e=0;e<i;e++){for(r=e+1;r<i;r++){if(a[r].ZOrder<a[e].ZOrder){var n;n=a[e];a[e]=a[r];a[r]=n}}if(a[e].ZOrder!=e){l=false;break}}if(!l&&t){for(e=0;e<i;e++){var c=a[e].FrameId;kl[c].ZOrder=0+1}}return l}_i.TerFixZOrder=function(){var t,e,r=0;var i=-9999;var f=9999;var l,a=0;var n=[Kl+1];t:{for(t=1;t<Kl;t++){if(!kl[t].InUse)continue;if(kl[t].ShapeType==0&&Dj(kl[t].flags&tc.PARA_FRAME_OBJECT))continue;if(Nj(kl[t].flags2&tc.PF2_TABLE_FRAME))continue;l=kl[t].TextLine;if(l>=0&&l<Ri&&(Nc[ui[l].pfmt].flags&tc.PAGE_HDR_FTR)!=0)a=K5(l);else a=0;if(a!=0)continue;n[r]=new tc.ClsOrd;n[r].FrameId=t;n[r].ZOrder=kl[t].ZOrder+r/Kl;n[r].IsBkndFrame=Nj(kl[t].flags&tc.PARA_FRAME_BEHIND_TEXT)||Nj(kl[t].flags2&tc.PF2_BEHIND_DOC);if(n[r].IsBkndFrame){if(kl[t].ZOrder>i)i=kl[t].ZOrder}else{if(kl[t].ZOrder<f)f=kl[t].ZOrder}r++}if(r==0)break t;if(i>=0){for(t=0;t<r;t++){if(n[t].IsBkndFrame)n[t].ZOrder-=i+1}}if(f<=0){for(t=0;t<r;t++){if(!n[t].IsBkndFrame)n[t].ZOrder+=f+1}}for(t=0;t<r;t++){for(e=t+1;e<r;e++){if(n[e].ZOrder<n[t].ZOrder){var c;c=n[t];n[t]=n[e];n[e]=c}}}for(t=0;t<r;t++){var s=n[t].FrameId;kl[s].ZOrder=t}}return true};_i.TerSetObjectWrapStyle=function(t,e){var r;if(!lv||!QD())_i.TerCreateControl();if(!oi.PageMode)return false;if(e!=tc.SWRAP_NO_WRAP&&e!=tc.SWRAP_AROUND&&e!=tc.SWRAP_THRU)return false;if(t<0)t=ui[br].fid;if(t==0||t>=Kl||!kl[t].InUse)return false;if(Dj(kl[t].flags&tc.PARA_FRAME_OBJECT)&&kl[t].pict==0)return false;if(Nj(kl[t].flags&tc.PARA_FRAME_LINE))return false;r=0;if(e==tc.SWRAP_NO_WRAP)r=tc.PARA_FRAME_NO_WRAP;if(e==tc.SWRAP_THRU)r=tc.PARA_FRAME_WRAP_IGNORE;if((kl[t].flags&(tc.PARA_FRAME_NO_WRAP|tc.PARA_FRAME_WRAP_IGNORE))!=r)_z(true);kl[t].flags=cj(kl[t].flags,tc.PARA_FRAME_NO_WRAP|tc.PARA_FRAME_WRAP_IGNORE);kl[t].flags|=r;Br=tc.PAINT_WIN_RESET;cG();return true};function $W(t,e,r,i,f,l,a,n,c){var s,_=0,o;var u=r;var T=0,A;var E=0;var R=0,L=0,C=0;var I=false;var d=0;if(n>=0&&t!=ui[n].fid&&!eU(t,n)){var F=wW(n,false);if(F>0){T=ui[n].pfmt;if(Dj(Nc[T].flags&(tc.PAGE_HDR|tc.PAGE_FTR)))r=Ze+ui[n].OrgY}}if(Po&&kl[t].RepageAnchorY<0){if(kl[t].AnchorLine<po[c].LastLine){if(r>0)kl[t].RepageAnchorY=r;else if(n>=0&&ui[n].y==0)kl[t].RepageAnchorY=r}}if(kl[t].RepageAnchorY>=0)r=kl[t].RepageAnchorY;t:{if(Nj(kl[t].flags2&tc.PF2_INLINE))break t;if(kl[t].canvas>0)break t;if(kl[t].HeightFactor>0){d=n>=0&&ui[n].cid>0;if(!d||Dj(kl[t].flags&tc.PARA_FRAME_IN_CELL)){var g=eo[a].PgHeight*1440;kl[t].height=Mj(g,kl[t].HeightFactor,1e3)}}var P=false,S=false,h=false;if(n>=0&&Nj(Nc[ui[n].pfmt].flags&tc.PAGE_HDR_FTR))P=true;if(n>=0&&Nj(Nc[ui[n].pfmt].flags&tc.PAGE_HDR))S=true;h=false;if(n>=0){if(!P)h=true;else if(Nj(kl[t].flags&tc.PARA_FRAME_VPAGE))h=true;else if(S||Nj(kl[t].flags&(tc.PARA_FRAME_VPAGE|tc.PARA_FRAME_VMARG)))h=true}else h=true;if(n>=0&&h&&(Nj(kl[t].flags&tc.PARA_FRAME_VCENTER)||Nj(kl[t].flags2&(tc.PF2_VTOP|tc.PF2_VBOTTOM|tc.PF2_VBOT_MARG)))){R=0;T=ui[n].pfmt;var O=Nj(kl[t].flags&(tc.PARA_FRAME_VPAGE|tc.PARA_FRAME_VMARG));if(Nj(Nc[T].flags&tc.PAGE_HDR)&&!O){E=to[a].TopMargin;R=jV(E);if(Nj(kl[t].flags&tc.PARA_FRAME_VCENTER))kl[t].ParaY=(R-kl[t].height)/2;else kl[t].ParaY=R-kl[t].height}else if(Nj(Nc[T].flags&tc.PAGE_FTR)&&!O){L=to[a].IsPortrait?to[a].PprHeight:to[a].PprWidth;var v;E=to[a].BotMargin;R=jV(E);if(Nj(kl[t].flags&tc.PARA_FRAME_VCENTER))kl[t].ParaY=(R-kl[t].height)/2;else kl[t].ParaY=R-kl[t].height;v=L-to[a].BotMargin;kl[t].ParaY+=jV(v)}else{d=n>=0&&ui[n].cid>0;if(!d||Dj(kl[t].flags&tc.PARA_FRAME_IN_CELL)||Nj(kl[t].flags&tc.PARA_FRAME_WRAP_IGNORE)){E=to[a].IsPortrait?to[a].PprHeight:to[a].PprWidth;kl[t].ParaY=0;if(Dj(kl[t].flags&tc.PARA_FRAME_VPAGE)&&Dj(kl[t].flags2&tc.PF2_PVPARA))kl[t].flags|=tc.PARA_FRAME_VMARG;if(Nj(kl[t].flags&tc.PARA_FRAME_VMARG))E=E-to[a].TopMargin-to[a].BotMargin;else kl[t].flags|=tc.PARA_FRAME_VPAGE;R=jV(E);if(Nj(kl[t].flags2&tc.PF2_VBOT_MARG)){kl[t].ParaY=R}else{if(Nj(kl[t].flags2&tc.PF2_VBOTTOM))kl[t].ParaY=R-kl[t].height;else kl[t].ParaY=(R-kl[t].height)/2}}else if(d&&Nj(kl[t].flags&tc.PARA_FRAME_IN_CELL)&&Dj(kl[t].flags&tc.PARA_FRAME_WRAP_IGNORE)){A=ui[n].cid;var p=eR[A].row;kl[t].ParaY=0;R=HV($E[p].height);if(Nj(kl[t].flags2&tc.PF2_VBOTTOM))kl[t].ParaY+=R-kl[t].height;else kl[t].ParaY+=(R-kl[t].height)/2}}}if(Nj(kl[t].flags&(tc.PARA_FRAME_VPAGE|tc.PARA_FRAME_VMARG))){I=false;var N=kl[t].ShapeType>0||Nj(kl[t].flags&tc.PARA_FRAME_OBJECT);A=0;if(n>=0&&n<Ri)A=ui[n].cid;if(A==0&&kl[t].ShapeType==tc.SHPTYPE_TEXT_BOX)A=kl[t].CellId;if(N&&Nj(kl[t].flags&tc.PARA_FRAME_IN_CELL)&&A>0&&Dj(kl[t].flags&tc.PARA_FRAME_WRAP_IGNORE)){for(s=0;s<Dl;s++){if(s==e)continue;if(pl[s].CellId==A){_=pl[s].y+mV(kl[t].ParaY);I=true;break}}}if(!I){var D=mV(kl[t].ParaY);if(Nj(kl[t].flags&tc.PARA_FRAME_VMARG))D+=f+l;kl[t].PageY=HV(D);tU(t,c);D=mV(kl[t].PageY);if(Ci)_=D+rr;else{if(yR)_=D-i;else _=D-f-l}kl[t].FramePageY=HV(_);if(e>=0&&e>=Qe)_+=Ze}if(e>=0){pl[e].y=_;pl[e].ScrY=yV(_)}kl[t].y=HV(_-Ze);if(Po)kl[t].flags|=tc.PARA_FRAME_POSITIONED;return true}}o=ui[n].height;o=HV(o);if(Nj(kl[t].flags&tc.PARA_FRAME_POSITIONED)){T=ui[n].pfmt;if(Nj(Nc[T].flags&tc.PAGE_FTR)&&r!=kl[t].AnchorY)kl[t].flags=cj(kl[t].flags,tc.PARA_FRAME_POSITIONED)}if(Dj(kl[t].flags&tc.PARA_FRAME_POSITIONED)||Po&&kl[t].ParaY>o){if(Nj(kl[t].flags2&tc.PF2_HTML)){kl[t].PageY=HV(r)+kl[t].ParaY}else if(kl[t].canvas>0){var M=kl[t].canvas;kl[t].PageY=kl[M].y+kl[t].ParaY}else{if(Nj(kl[t].flags2&tc.PF2_INLINE)){var G=HV(ui[n].BaseHt);if(G<kl[t].height)G=kl[t].height;kl[t].PageY=HV(r)+G-kl[t].height-HV(Ze)}else{var B=0;if(n>=0&&n<Ri&&Nj(Nc[ui[n].pfmt].flags&tc.PAGE_HDR_FTR)&&r<Ze)B=Ze;kl[t].PageY=HV(r+B)+kl[t].ParaY-HV(Ze);if(Nj(kl[t].flags&tc.PARA_FRAME_IN_CELL)&&(n>=0&&n<Ri)&&ui[n].cid>0&&kl[t].ShapeType!=tc.SHPTYPE_TEXT_BOX&&Dj(kl[t].flags&tc.PARA_FRAME_WRAP_IGNORE)){C=0;A=ui[n].cid;I=false;for(s=0;s<Dl;s++){if(s==e)continue;if(pl[s].CellId==A){C=HV(pl[s].y)-HV(Ze);I=true;break}}if(!I){var H,m=u;for(H=n-1;H>=0&&ui[H].cid==ui[n].cid;H--)m-=ui[H].height;C=HV(m)-HV(Ze)}if(kl[t].PageY<C)kl[t].PageY=C}tU(t,c)}}if(kl[t].canvas==0&&(n<0||ui[n].cid==0)){var w=false;if(kl[t].pict>0&&Nj(kl[t].flags&tc.PARA_FRAME_IN_CELL)&&Nj(kl[t].flags2&tc.PF2_ANCHOR_IN_CELL)&&kl[t].CellId>0&&Dj(kl[t].flags&tc.PARA_FRAME_WRAP_IGNORE)){A=kl[t].CellId;if(rR[A].FirstPage==rR[A].LastPage){var b=HV(rR[A].height);if(kl[t].height>b&&kl[t].ParaY>b)kl[t].flags2|=tc.PF2_HIDDEN}w=true}if(!w){var x=kl[t].PageY+kl[t].height;L=to[a].IsPortrait?to[a].PprHeight:to[a].PprWidth;var y=jV(L);if(x>y){if(kl[t].PageY>=y)kl[t].flags2|=tc.PF2_HIDDEN}}}if(kl[t].pict>0&&Nj(kl[t].flags&tc.PARA_FRAME_IN_CELL)&&Nj(kl[t].flags2&tc.PF2_ANCHOR_IN_CELL)&&kl[t].CellId>0&&Nj(kl[t].flags&tc.PARA_FRAME_WRAP_IGNORE)&&Nj(kl[t].flags&tc.PARA_FRAME_HPAGE))kl[t].flags2|=tc.PF2_HIDDEN;kl[t].FramePageY=kl[t].PageY;if(Ci)kl[t].PageY-=HV(rr);else if(!oi.FittedView){if(yR)kl[t].PageY+=HV(i);else kl[t].PageY+=HV(f+l)}if(Po)kl[t].flags|=tc.PARA_FRAME_POSITIONED}if(Ci)_=mV(kl[t].PageY)+rr;else if(!oi.FittedView){if(yR)_=mV(kl[t].PageY)-i;else _=mV(kl[t].PageY)-f-l}else _=mV(kl[t].PageY);kl[t].y=HV(_);if(e>=0){pl[e].y=_;if(e>=Qe)pl[e].y+=Ze;pl[e].ScrY=yV(pl[e].y)}return true}function tU(t,e){var r=false;if(Dj(kl[t].flags2&tc.PF2_NO_OVERLAP)&&zl){for(i=0;i<Kl;i++){if(i==t||Dj(kl[i].flags&tc.PARA_FRAME_POSITIONED)||kl[i].PageNo!=e)continue;if(kl[t].GroupId==kl[i].GroupId)continue;if(Nj(kl[i].flags&tc.PARA_FRAME_NO_WRAP))break}if(i<Kl)r=true}if(Nj(kl[t].flags2&tc.PF2_NO_OVERLAP)||r){BegY=kl[t].PageY;var f=kl[t].PageY+kl[t].height;if(Nj(kl[t].flags&tc.PARA_FRAME_SHPGRP)){BegY-=kl[t].GrpRelY;f=BegY+kl[t].GrpHeight}for(i=0;i<Kl;i++){var l=false;var a,n;if(i==t||Dj(kl[i].flags&tc.PARA_FRAME_POSITIONED)||kl[i].PageNo!=e)continue;var c=kl[t].GroupId==kl[i].GroupId&&kl[t].GroupId>0;if(Nj(kl[t].flags&tc.PARA_FRAME_NO_WRAP)){if(c)continue;if(Dj(kl[i].flags&tc.PARA_FRAME_NO_WRAP)&&Dj(kl[i].flags2&tc.PF2_NO_OVERLAP))continue}else{if(c||kl[t].ZOrder!=kl[i].ZOrder)continue}if(kl[i].TextLine>kl[t].TextLine)continue;a=kl[i].PageY;n=kl[i].PageY+kl[i].height;if(Nj(kl[i].flags&tc.PARA_FRAME_SHPGRP)){a-=kl[i].GrpRelY;n=a+kl[i].GrpHeight}if(BegY>=a&&BegY<n)l=true;else if(f>=kl[i].PageY&&f<n)l=true;else if(BegY<=kl[i].PageY&&f>=n)l=true;if(l){var s=kl[t].PageY;kl[t].PageY=n;if(Nj(kl[t].flags&tc.PARA_FRAME_SHPGRP))kl[t].PageY+=kl[t].GrpRelY;kl[t].OverlapAddedY=kl[t].PageY-s}}}return true}function eU(t,e){var r;var i;var f;if(t==0)return false;if(Dj(ui[e].flags&tc.LFLAG_PICT))return false;r=nb(e);for(f=0;f<ui[e].len;f++){i=r[f];if(xs[i].InUse&&Nj(xs[i].style&tc.PICT)&&xs[i].FrameType!=tc.PFRAME_NONE&&xs[i].ParaFID==t)return true}return false}_i.TerRotateFrameText=function(t,e,r,i){var f,l;if(!lv||!QD())_i.TerCreateControl();if(e>=Ri)return false;if(e>=0){if(Nj(ui[e].cid))return false;f=ui[e].fid}else f=-e;if(f<0||f>=Kl)return false;if(Nj(kl[f].flags&(tc.PARA_FRAME_LINE|tc.PARA_FRAME_RECT)))return false;if(!t){l=0;if(r==tc.TEXT_TOP_TO_BOT)l=270;else if(r==tc.TEXT_BOT_TO_TOP)l=90;return rU(f,l,i)}l=kl[f].TextAngle;var a=_i.DlgCompHeight;var n=_i.DlgFont;var c=new $t.DialogBox(te,"Text Rotation",n,true,T,2);var s=c.cvs;var _=new $t.RadioButton(s,0,0,JV(15),n,"Horizontal",l==0,null,null);c.addComp(_,1,0,1,1,"left","middle",JV(15));var o=new $t.RadioButton(s,0,0,JV(15),n,"Top to Bottom",l!=0&&l!=90,_,null);c.addComp(o,2,0,1,1,"left","middle",JV(15));var u=new $t.RadioButton(s,0,0,JV(15),n,"Bottom to Top",l==90,o,null);c.addComp(u,3,0,1,1,"left","middle",JV(15));c.show();_.setFocus();function T(t,e,r){if(t=="Cancel"){c.hide();return}else if(t=="OK"){if(_.isSelected())l=0;else if(u.isSelected())l=90;else l=270;c.hide();return rU(f,l,i)}else return}};function rU(t,e,r){kl[t].TextAngle=e;kl[t].MinHeight=kl[t].height;oi.modified++;if(br<Fo)Fo=br;if(r)cG();return true}_i.TerPosFrame=function(t,e,r){var i;var f;if(!lv||!QD())_i.TerCreateControl();if(!oi.PageMode)return false;if(e!=tc.POS_BEG&&e!=tc.POS_END)return false;if(t==-1)t=ui[br].fid;if(t<1||t>=Kl)return false;for(i=0;i<Ri;i++)if(ui[i].fid==t)break;if(i==Ri)return false;if(e==tc.POS_BEG){_i.SetTerCursorPos(i,0,r);return true}for(;i<Ri;i++)if(ui[i].fid!=t)break;i--;if(i>=0){f=ui[i].len-1;if(f<0)f=0;_i.SetTerCursorPos(i,f,r);return true}return false};function iU(t){var e;if(t<=0||t>=Kl)return 0;while(true){e=kl[t].PrevId;if(e<=0||e>=Kl||e==t)return t;t=e}}function fU(t){var e;if(t<=0||t>=Kl)return 0;e=kl[t].PrevId;if(e<=0||e>=Kl||e==t)return 0;else return e}function lU(t){var e;if(t<=0||t>=Kl)return 0;e=kl[t].NextId;if(e<=0||e>=Kl||e==t)return 0;else return e}function aU(t){var e,r;e=ui[t].fid;if(e==0||kl[e].PrevId==0)return e;while((r=kl[e].PrevId)>0)e=r;return e}function nU(t){var e,r;e=kl[t].height;if(Nj(kl[t].flags&tc.PARA_FRAME_BOXED))r=kl[t].LineWdth;else r=0;if(kl[t].TopMarg>r)e-=kl[t].TopMarg;else e-=r;if(kl[t].BotMarg>r)e-=kl[t].BotMarg;else e-=r;return e}function cU(){var t=_i.DlgCompHeight;var e=_i.DlgFont;var l=new $t.DialogBox(te,"Hyperlink",e,true,c,JV(2));var r=l.cvs;var i=new $t.Label(r,0,0,e,"Field Name");l.addComp(i,0,0,1,3,"Left","bottom");var a=new $t.TextBox(r,0,0,JV(400),t,"",e,_i.caret,false,true,null);l.addComp(a,1,0,1,3,"left","middle");var f=new $t.Label(r,0,0,e,"Field Data");l.addComp(f,3,0,1,3,"Left","bottom");var n=new $t.TextBox(r,0,0,JV(400),t,"",e,_i.caret,false,true,null);l.addComp(n,4,0,1,3,"left","middle");l.show();a.setFocus();function c(t,e,r){if(t=="Cancel"){l.hide();return}else if(t=="OK"){var i=a.getText();if(i.length==0){a.setFocus();return}var f=n.getText();if(f.length==0){n.setFocus();return}l.hide();return _i.TerInsertHyperlink(i,f,0,true)}else return}if(ns.length==0||cs.length==0)return false;_i.TerInsertHyperlink(ns,cs,0,true);return true}_i.TerSetLinkDblClick=function(t){var e;e=Nh;Nh=t;return e};_i.TerInsertHyperlink=function(t,e,r,i){var f=-1;var l;if(!lv||!QD())_i.TerCreateControl();if(Dj(e)||e.length==0)return-1;var a=uE;if(uA!=tc.HILIGHT_OFF){_i.TerDeleteBlock(false);uE=a}if(r>0){if(r>=Ys||!xs[r].InUse||Dj(xs[r].style&tc.PICT))return-1;_i.TerGetFieldFont(r,tc.FIELD_HLINK,e);_i.TerInsertObjectId(r,i);return r}if(Dj(t)||t.length==0)return-1;l=wh;l=cj(l,tc.HLINK);cO|=tc.TOFLAG3_DONT_UPDATE_PARA_FONT;if(Nj(l))_i.SetTerCharStyle(l,true,false);_i.SetTerColor(bh,false);Tj(tc.TOFLAG3_DONT_UPDATE_PARA_FONT);f=$w();Oc=f=_i.TerGetFieldFont(f,tc.FIELD_HLINK,e);_i.InsertTerText(t,i);Oc=-1;oi.modified++;return f};_i.TerApplyHyperlink=function(t,e){var r;var i;var f,l;var a;if(!lv||!QD())_i.TerCreateControl();if(Dj(t)||t.length==0)return false;if(uA==tc.HILIGHT_OFF)return false;if(!ON())return false;if(!pN())return false;if(uA==tc.HILIGHT_LINE){TA=0;AA=ui[_A].len;if(AA<0)AA=0}V8(sA,TA,_A,AA-1,tc.CHAR_F);for(i=sA;i<=_A;i++){f=i==sA?TA:0;l=i==_A?AA:ui[i].len;a=nb(i);for(r=f;r<l;r++){a[r]=_i.TerGetFieldFont(a[r],tc.FIELD_HLINK,t)}sb(i)}oi.modified++;if(e)cG();return true};_i.TerUpdateHyperlinkText=function(t,e){var r,i,f;var l;var a,n,c,s;if(!lv||!QD())_i.TerCreateControl();if(Dj(t))return false;r=ib(br,jt);if(xs[r].FieldId!=tc.FIELD_HLINK)return false;if(Nj(xs[r].FieldCode))l=xs[r].FieldCode;else l="";a=n=br;i=f=jt;if(_i.TerLocateFieldChar(tc.FIELD_HLINK,l,false,a,i,false)){a=zC;i=ZC;Rm(a,i);a=PC;i=SC}else a=i=0;c=Lq(a,i);_i.TerLocateFieldChar(tc.FIELD_HLINK,l,false,n,f,true);n=zC;f=ZC;Em(n,f);n=PC;f=SC;s=Lq(n,f);dK(t,c,s);oi.modified++;if(e)cG();return true};_i.TerUpdateHyperlinkCode=function(t){var e,r,i,f,l,a,n,c=0;var s;var _,o,u;var T;if(!lv||!QD())_i.TerCreateControl();e=ib(br,jt);if(xs[e].FieldId!=tc.FIELD_HLINK)return false;if(Nj(xs[e].FieldCode))s=xs[e].FieldCode;else s="";o=u=br;r=i=jt;if(!_i.TerLocateFieldChar(tc.FIELD_HLINK,s,false,o,r,false)){o=0;r=0}else{o=zC;r=ZC;Rm(o,r);o=PC;r=SC}_i.TerLocateFieldChar(tc.FIELD_HLINK,s,false,u,i,true);u=zC;i=ZC;Em(u,i);u=PC;i=SC;V8(o,r,u,i,tc.CHAR_F);t:{n=-1;e=0;for(_=o;_<=u;_++){f=_==o?r:0;l=_==u?i:ui[_].len-1;T=nb(_);for(a=f;a<=l;a++){e=T[a];if(e==n){T[a]=c;continue}if(xs[e].FieldId!=tc.FIELD_HLINK)break t;if(t==null||t.length==0)c=_i.TerGetFieldFont(e,0,null);else c=_i.TerGetFieldFont(e,tc.FIELD_HLINK,t);if(c<0)break t;n=e;T[a]=c}sb(_)}}oi.modified++;return true};_i.TerFindHlinkField=function(t,e,r,i){var f;if(!lv||!QD())_i.TerCreateControl();PC=r;SC=i;if(t==null&&e==null)t="";while(_i.TerLocateFieldChar(tc.FIELD_HLINK,null,true,r,i,true)){r=zC;i=ZC;f=ib(r,i);if(Nj(xs[f].FieldCode)){var l=false;if(Nj(t)&&(t==""||xs[f].FieldCode.indexOf(t)>=0))l=true;if(Nj(e)&&(e==""||xs[f].FieldCode.indexOf(e)>=0))l=true;if(l){PC=zC;SC=ZC;return true}}if(!_i.TerLocateFieldChar(tc.FIELD_HLINK,xs[f].FieldCode,false,r,i,true))break;PC=r=zC;SC=i=ZC}return false};_i.TerGetHypertext=function(){if(!lv||!QD())_i.TerCreateControl();vP=NP="";if(Ir)return false;return _i.TerGetHypertextEx(false)};_i.TerGetHypertextEx=function(t){var e=-1;var r=0;if(uA!=tc.HILIGHT_OFF){e=sA;r=TA}return _i.TerGetHypertext2(e,r,t)};_i.TerGetHypertext2=function(t,e,r){var i=0,f,l,a,n,c,s,_,o,u=0;var T;var A;var E,R,L,C,I;var d;var F;if(!lv||!QD())_i.TerCreateControl();vP=NP="";if(t<0){t=br;e=jt}if(ui[t].len==0)return false;d=Nj(Zh&tc.TFLAG2_CURSOR_BEF_HIDDEN)?true:false;F=Nj(qh&tc.TFLAG4_TEXT_HIDDEN)?true:false;t:{a=ib(t,e);if(!oU(a)){if(d&&Nj(xs[a].style&tc.HIDDEN))break t;else return false}}if(r)uA=tc.HILIGHT_OFF;C=R=t;o=n=e;if(a==WL&&UL>0){var g=xL[UL];var P=g.pMapRect[kL];vP="Image Map: ";vP+=g.name;var S=wY(tc.QUOTE);NP="";if(P.LinkInfo.length>0)NP="href="+S+P.LinkInfo+S;f=NP.length;if(P.target.length>0&&P.LinkInfo.length>0)NP+=" target="+S+P.target+S;if(r){sA=_A=R;TA=n;AA=n+1;uA=tc.HILIGHT_CHAR;cG()}return true}if(xs[a].FieldId==tc.FIELD_HLINK){if(Nj(xs[a].FieldCode))NP+=xs[a].FieldCode;hw(t,e,true);R=PC;n=SC;hw(t,e,false);L=PC;c=SC;var h;f=0;for(E=R;E<=L;E++){s=E==R?n:0;_=E==L?c:ui[E].len;l=_-s;h=[l+1];aw(E,s,_-s,h,null,null);vP=vP+Wk(h,0,l);f+=l}if(r){sA=R;_A=L;TA=n;AA=c;uA=tc.HILIGHT_CHAR;cG()}return true}if(d&&Nj(xs[a].style&tc.HIDDEN)){for(E=R;E<Ri;E++){f=ui[E].len;if(f==0)continue;T=nb(E);if(E==R)s=n+1;else s=0;for(i=s;i<f;i++){a=T[i];if(oU(a)){C=E;o=i;break}else{if(Dj(xs[a].style&tc.HIDDEN))return false;R=E;n=i}}sb(E);if(i<f)break}}else{for(E=R;E>=0;E--){f=ui[E].len;if(f==0)continue;T=nb(E);if(E==R)s=n-1;else s=f-1;for(i=s;i>=0;i--){a=T[i];if(!oU(a)){R=E;n=i;break}else{C=E;o=i}}sb(E);if(i>=0)break}}I=-1;for(E=C;E<Ri;E++){f=ui[E].len;if(f==0)continue;T=nb(E);A=ui[E].txt;if(E==C)s=o;else s=0;for(i=s;i<f;i++){a=T[i];if(!oU(a)){I=E;u=i;break}else vP+=wY(A[i])}sb(E);if(i<f)break}if(r){if(F){sA=C;TA=o}else{_A=E;AA=i}}if(F){if(I<0)return true;a=ib(I,u);if(Dj(xs[a].style&tc.HYPER_CODE))return true}else{if(C==0&&o==0)return true;a=ib(R,n);if(Dj(xs[a].style&tc.HYPER_CODE))return true;I=R;u=n;for(E=R;E>=0;E--){f=ui[E].len;if(f==0)continue;T=nb(E);if(E==R)s=n-1;else s=f-1;for(i=s;i>=0;i--){a=T[i];if(Dj(xs[a].style&tc.HYPER_CODE))break;else{I=E;u=i}}sb(E);if(i>=0)break}if(r){sA=I;TA=u}}for(E=I;E<Ri;E++){f=ui[E].len;if(f==0)continue;T=nb(E);A=ui[E].txt;if(E==I)s=u;else s=0;for(i=s;i<f;i++){a=T[i];if(oU(a)||Dj(xs[a].style&tc.HYPER_CODE)){if(F){_A=E;AA=i}break}else NP+=wY(A[i])}sb(E);if(i<f)break}if(r){uA=tc.HILIGHT_CHAR;cG()}return true};function sU(t){var e=new tc.TejHyperlink;e.DoubleClick=t;e.code=e.text="";if(!_i.TerGetHypertext())return false;e.text=vP;e.code=NP;if(AU(e.code))return false;if(Nj(iO&tc.TFLAG9_INVOKE_HYPERLINK)){var r=e.code.indexOf("http://");if(r<0)r=e.code.indexOf("https://");if(r<0)r=e.code.indexOf("www://");if(r>=0){var i;var f=Uk(e.code);for(i=r+1;i<e.code.length;i++)if(f[i]==tc.SPACE||f[i]=='"')break;var l=cV(e.code,r,i-r);window.open(l)}}return kD(e)}_i.TerDeleteHypertext=function(t,e,r){if(!lv||!QD())_i.TerCreateControl();if(t<0){t=br;e=jt}if(t<0||t>=Ri)return false;if(e<0||e>=ui[t].len)return false;if(!oU(ib(t,e)))return false;uA=tc.HILIGHT_OFF;var i=t;var f=e;EU(i,f);i=PC;f=SC;sA=i;TA=f;_A=t;AA=e+1;if(TA<AA)AA--;i=_A;f=AA;RU(i,f);i=PC;f=SC;_A=i;AA=f;uA=tc.HILIGHT_CHAR;OA=false;return _i.TerDeleteBlock(r)};function _U(t,e){var r,i;r=ib(t,e);if(oU(r)){i=fb(t,e);if(Nj(xs[i].style&tc.HIDDEN)){var f=lb(t,e);if(!oU(f))return true}}return false}function oU(t){return uU(t,true)}function uU(t,e){return TU(t,e,false)}function TU(t,e,r){var i;if(xs[t].FieldId==tc.FIELD_HLINK){if(e)return true;else if(!AU(xs[t].FieldCode))return true}if(r&&xs[t].FieldId==tc.FIELD_PAGE_REF&&xs[t].FieldCode!=null){if(xs[t].FieldCode.indexOf("\\h")>=0)return true}if(r&&xs[t].FieldId==tc.FIELD_REF&&xs[t].FieldCode!=null){if(xs[t].FieldCode.indexOf("\\h")>=0)return true}if(Nj($h&tc.TFLAG5_OLD_HLINK)){if(Nj(wh&tc.HLINK)&&Nj(xs[t].style&tc.HLINK))return true;if(Dj(xs[t].style&wh)&&Dj(wh&tc.PICT)&&wh!=0)return false;if(Nj(xs[t].style&tc.PICT)){if((xs[t].style&wh)==wh&&wh!=0)return true;return dU(t)}i=xs[t].TextColor;if(i==tc.CLR_AUTO)i=tc.CLR_BLACK;if(MJ(i,bh)&&Dj(wh&tc.HLINK))return true}return false}function AU(t){var e;if(Dj(t))return false;e=t.toUpperCase();if(e.indexOf("tc.NAME =")==-1&&e.indexOf("tc.NAME=")==-1)return false;if(e.indexOf("tc.HREF")>=0)return false;return true}function EU(t,e){var r=t;var i=e;var f,l;var a;var n=0,c;var s,_;PC=t;SC=e;f=ib(r,i);s=Nj(xs[f].style&tc.HIDDEN);_=xs[f].FieldId==tc.FIELD_HLINK;for(a=r;a>=0;a--){if(a==r)c=i;else c=ui[a].len-1;for(n=c;n>=0;n--){l=fb(a,n);if(_&&!Lw(l,f))break;if(s&&Dj(xs[l].style&tc.HIDDEN))break;else if(!oU(l))s=true}if(n>=0)break}if(a<0){a=0;n=0}PC=a;SC=n;return true}function RU(t,e){var r=t;var i=e;var f,l,a;var n;var c=0,s;var _=true,o;PC=t;SC=e;l=ib(r,i);o=xs[l].FieldId==tc.FIELD_HLINK;for(n=r;n<Ri;n++){if(n==r)s=i;else s=0;a=ui[n].len;for(c=s;c<a;c++){f=ib(n,c);if(o&&!Lw(f,l))break;if(_&&Dj(xs[f].style&tc.HIDDEN))_=false;if(!_&&!oU(ib(n,c)))break}if(c<a)break}if(n>=Ri){n=Ri-1;c=ui[n].len}PC=n;SC=c;return true}function LU(t,e,r){var i=ib(e,r);var f=0,l,a=999999,n;var c;if(xs[i].FieldId==tc.FIELD_TOC){var s=0,_,o=ui[e].len;var u=ui[e].txt;for(_=0;_<o;_++){if(u[_]==tc.TAB)a=_;if(0!=(s=Vx(e,_,tc.TERTAG_TOC)))break}if(_==o||r<=a)return false;f=ac[s].AuxInt}if(f<=0||f>=Ac)return false;if(!t)return true;l=ac[f].AuxInt;_i.TerPosLineAtTop(l,false);_i.SetTerCursorPos(l,0,true);return true}function CU(t,e,r){var i;var f,l,a,n,c,s,_;var o,u;var T;var A,E,R;var L;if(Nj(tO&tc.TFLAG6_NO_LINK_MSG))return false;if(e<0||e>=Ri)return false;if(r>=ui[e].len)return false;u=e;for(e=u;e>0;e--){if(Nj(ui[e-1].flags&(tc.LFLAG_PARA|tc.LFLAG_LINE|tc.LFLAG_BREAK)))break;i=ui[e-1].txt;a=ui[e-1].len;if(a==0)break;if(i[a-1]==tc.SPACE||i[a-1]==tc.TAB)break;i=ui[e].txt;if(e<u)r=ui[e].len-1;for(f=r;f>=0;f--)if(i[f]==tc.SPACE)break;if(f>=0)break}if(e<u)r=ui[e].len-1;i=ui[e].txt;a=ui[e].len;if(r<0||r>=a)return false;s=ib(e,r);if(xs[s].FieldId!=0)return false;E=Wk(i,0,a);t:{T="http://";if((f=IU(e,r,E,T))>=0)break t;T="https://";if((f=IU(e,r,E,T))>=0)break t;T="www.";if((f=IU(e,r,E,T))>=0)break t;return false}if(!t)return true;c=f;o=e;_=0;for(e=o;e<=u;e++)_+=ui[e].len;L=[_+1];l=0;for(e=o;e<Ri;e++){if(e>o)c=0;a=ui[e].len;i=ui[e].txt;for(f=c;f<a;f++,l++){if(i[f]==tc.SPACE||i[f]<32&&i[f]==tc.NBSPACE_CHAR||i[f]==gk("<")||i[f]==gk(">"))break;if(i[f]==gk("(")||i[f]==tc.RIGHT_PAREN)break;if(i[f]==gk("[")||i[f]==gk("]"))break;if(i[f]==tc.LEFT_BRACE||i[f]==tc.RIGHT_BRACE)break;if(i[f]==gk('"')||i[f]==","||i[f]==tc.SEMI_COLON)break;if(i[f]==Bn||i[f]==TR||i[f]==tc.LINE_CHAR||i[f]==tc.SECT_CHAR||i[f]==tc.COL_CHAR||i[f]==tc.PAGE_CHAR)break;if(l>=_){_=l+100;L=fV(L,_)}L[l]=i[f];if(L[l]==tc.NBSPACE_CHAR)L[l]=tc.SPACE}if(f<a)break}A=Wk(L,0,l);try{Runtime.getRuntime().exec("rundll32 url.dll,FileProtocolHandler "+A)}catch(t){}return true}function IU(t,e,r,i){var f=-1,l,a,n;r=r.toLowerCase();i=i.toLowerCase();var c=r.length;l=i.length;if(l<c){n=e;if(n+l>c)n=c-l;if((a=r.lastIndexOf(i,n))>=0){f=ib(t,a);if(xs[f].FieldId!=0)return-1;return a}}return-1}_i.TerCreateImageMap=function(t){var e;if(yL>=tc.MAX_IMAGE_MAPS){QY(tc.MSG_OUT_OF_IMAGE_MAP_TABLE,"TerCreateImageMap");return 0}e=[yL];e=new tc.ClsImageMap;e.name=t;xL[yL]=e;yL++;return yL-1};_i.TerAddImageMapRect=function(t,e,r,i,f,l,a,n){var c;var s;if(t<=0||t>=yL)return false;c=xL[t];if(c.TotalRects==0)c.pMapRect=[1];s=c.pMapRect[c.TotalRects];s.name=e;s.LinkInfo=r;s.target=i;s.rect.left=f;s.rect.top=l;s.rect.right=a;s.rect.bottom=n;c.pMapRect[c.TotalRects]=s;c.TotalRects++;xL[t]=c;return true};_i.TerSetMapRectInfo=function(t,e,r,i,f){var l;var a;if(UL>0){if(t<0){t=UL;e=kL}else if(e<0)e=kL}if(t<=0||t>=yL)return false;l=xL[t];if(e<0||e>=l.TotalRects)return false;a=l.pMapRect[e];a.name=r;a.LinkInfo=i;a.target=f;l.pMapRect[e]=a;xL[t]=l;return true};_i.TerImageMapNameToId=function(t){var e;for(e=1;e<yL;e++){if(Nj(xL[e].name)&&Tk(xL[e].name,t)==0)return e}return 0};_i.TerGetPictMapId=function(t){if(t<0||t>=Ys)return 0;if(!xs[t].InUse||Dj(xs[t].style&tc.PICT))return 0;return xs[t].MapId};_i.TerSetPictMapId=function(t,e){if(e<0||e>=yL)return false;if(t<0||t>=Ys)return false;if(!xs[t].InUse||Dj(xs[t].style&tc.PICT))return false;xs[t].MapId=e;return true};_i.TerGetImageMapInfo=function(t){LP="";pC=0;if(t<0||t>=yL)return false;LP=xL[t].name;pC=xL[t].TotalRects;return true};_i.TerGetImageMapRectInfo=function(t,e){var r;var i;LP=DP=MP="";hI=OI=vI=pI=0;if(UL>0){if(t<0){t=UL;e=kL}else if(e<0)e=kL}if(t<0||t>=yL)return false;r=xL[t];if(e<0||e>=r.TotalRects)return false;i=r.pMapRect[e];LP=i.name;DP=i.LinkInfo;MP=i.target;hI=i.rect.left;OI=i.rect.right;vI=i.rect.top;pI=i.rect.bottom;return true};function dU(t){var e,r,i,f;var l;var a;WL=UL=kL=0;if(yL==1)return false;if(Dj(xs[t].InUse)||Dj(xs[t].style&tc.PICT))return false;if(xs[t].MapId==0)return false;r=Ga;i=Ba;r=r-rt.left;i=i-rt.top;r-=xs[t].PictX;i-=xs[t].PictY;f=xs[t].MapId;if(f<=0||f>=yL)return false;l=xL[f];for(e=0;e<l.TotalRects;e++){a=l.pMapRect[e];if(r>=a.rect.left&&r<=a.rect.right&&i>=a.rect.top&&i<=a.rect.bottom){WL=t;UL=f;kL=e;return true}}return false}function FU(){var t;for(t=1;t<yL;t++){xL[t]=new tc.ClsImageMap}yL=1;return true}function gU(t,e,r){var i=null;if(e==undefined)e=false;if(r==undefined)r=null;if(r==null)asycn=false;t=OU(t);if(!Lk(t,"http://")&&!Lk(t,"https://"))return null;if(e&&!hU(t))return null;var f=new XMLHttpRequest;f.onload=function(t){i=f.responseText;if(!e)return i;else if(r)r(i)};f.onerror=function(t){if(!e)return null;else if(r)r(null)};f.onabort=function(t){if(!e)return null;else if(r)r(null)};f.open("GET",t,e);f.send();return i}function PU(t,e,f){var l=null;var a=null;if(e==undefined)e=false;if(f==undefined)f=null;t=OU(t);if(!hU(t)){if(e&&f)f(null);return null}var n=new XMLHttpRequest;n.onload=function(t){l=n.response;var e=new Uint8Array(l);var r=e.length,i;a="";for(i=0;i<r;i++)a+=String.fromCharCode(e[i]);if(f)f(a)};n.onerror=function(t){if(e&&f)f(null);return null};n.onabort=function(t){if(e&&f)f(null);return null};n.open("GET",t,e);n.responseType="arraybuffer";n.send();return a}function SU(t,e){e=OU(e);if(!Lk(e,"http://")&&!Lk(e,"https://"))return false;if(!hU(e))return null;var r=new FormData;r.append("data",t);var i=window.XMLHttpRequest?new XMLHttpRequest:new activeXObject("Microsoft.XMLHTTP");i.open("post",e,true);i.send(r);return true}function hU(t){var e=new XMLHttpRequest;e.open("HEAD",t,false);e.send();return e.status==200}function OU(t){if(Lk(t,"http://"))return t;if(Lk(t,"https://"))return t;if(Lk(t,"file://"))return t;var e=window.location.href;var r=e.length;var i;for(i=r-1;i>=0;i--)if(e.charAt(i)=="/")break;if(i<r-1)e=e.substr(0,i+1);if(t.charAt(0)=="/")t=t.substr(1);return e+t}function vU(t,e,r,i,f,l){KQ(true);if(GS!=null){document.body.removeChild(GS);GS=null}GS=document.createElement("input");GS.setAttribute("type","file");GS.defaultValue=r;GS.accept=f;GS.value=null;GS.addEventListener("change",function(t){var e=GS.value;if(e==null)e="";if(l!=null){l(GS.files,e)}document.body.removeChild(GS);GS=null});document.body.appendChild(GS);GS.focus();GS.click()}function pU(t,l,a){var n=_i.DlgLevel;var c=null;if(l!="text"&&l!="binary"&&l!="array"&&l!="url")return false;var s=new FileReader;if(!s)return false;s.onload=function(t){e(t.target.result)};s.onerror=function(t){e(null)};s.onabort=function(t){e(null)};function e(t){if(t!=null){if(l=="binary"&&!s.readAsBinaryString){var e="";var r=new Uint8Array(t);var f=r.length;for(i=0;i<f;i++)e+=String.fromCharCode(r[i]);t=e}}_i.DlgLevel=n;Rk(te,c);if(a)a(t)}_i.DlgLevel++;c=Ek(te,true);if(l=="binary"){if(s.readAsBinaryString)s.readAsBinaryString(t);else s.readAsArrayBuffer(t)}else if(l=="array")s.readAsArrayBuffer(t);else if(l=="url")s.readAsDataURL(t);else s.readAsText(t);XQ(U);return true}_i.TerSaveToLocalFile=function(t,e,r){if(r==undefined)r="text/plain";var i=null;var f=window.navigator.msSaveBlob||window.saveAs||window.saveBlob||window.navigator.saveAs||window.navigator.saveBlob;if(f){var l=t;if(typeof l=="string")l=ck(l);i=null;try{i=new Blob(l,{type:r})}catch(t){}if(i==null){BBuilder=window.BlobBuilder||window.WebKitBlobBuilder||window.MozBlobBuilder||window.MSBlobBuilder;if(BBuilder){bb=new BBuilder;bb.append(l);i=bb.getBlob(r)}}if(i!=null){var a=true;if(window.navigator.msSaveBlob)window.navigator.msSaveBlob(i,e);else if(window.saveAs)window.saveAs(i,e);else if(window.saveBlob)window.saveBlob(i,e);else if(window.navigator.saveAs)window.navigator.saveAs(i,e);else if(window.navigator.saveBlob)window.navigator.saveBlob(i,e);else a=false;if(a)return true}}if(true){i=new Blob([t],{type:"text/plain"});var n=document.createElement("a");n.download=e;n.href=(window.webkitURL||window.URL).createObjectURL(i);n.dataset.downloadurl=["text/plain",n.download,n.href].join(":");n.click()}else{var c=btoa(t);var s="data:"+r+";base64,"+c;var _=document.createElement("a");_.setAttribute("href",s);_.setAttribute("download",e);if(document.createEvent){var o=document.createEvent("MouseEvents");o.initEvent("click",true,true);_.dispatchEvent(o)}else{_.click()}}};_i.TerSaveToLocalFile1=function(t,e,r){if(r==undefined)r="text/plain";var i=btoa(t);var f="data:"+r+";base64,"+i;var l=document.createElement("a");document.body.appendChild(l);l.style="display: none";l.href=f;l.download=e;l.click();return true};_i.TerSaveToLocalFile2=function(t,e,r){if(r==undefined)r="Image";if(typeof t=="string")t=ck(t);var i=null;try{i=new Blob(t,{type:r})}catch(t){}if(i==null){BBuilder=window.BlobBuilder||window.WebKitBlobBuilder||window.MozBlobBuilder||window.MSBlobBuilder;if(BBuilder){bb=new BBuilder;bb.append(t);i=bb.getBlob(r)}}if(i==null)return false;var f=window.URL.createObjectURL(i);window.open(f,"_blank","");if(false){var l=document.createElement("a");document.body.appendChild(l);l.style="display: none";l.href=f;l.download=e;l.click();window.URL.revokeObjectURL(f)}return true};function NU(t,i){if(Nj(oi.modified)){if(qk(tg.MsgString[tc.MSG_SAVE_MODS],"",tc.MSGTYPE_OK_CANCEL)==tc.MSGRESULT_OK){if(ih.length>0)return BU(ih,true);else return MU(ih)}}if(t==null||i==""){_i.SetTerBuffer("","");ih="";return true}if(!pU(t,"text",e))return;function e(t){if(_i.SetTerBuffer(t,"")){_i.TerShrinkFontTable();ih=i;var e="\\fakepath\\";var r=ih.indexOf(e);if(r>=0)ih=ih.substr(r+e.length);if(Ck(i.toLowerCase(),".txt"))oi.InputType=tc.SAVE_TEXT;else if(Ck(i.toLowerCase(),".rtf"))oi.InputType=tc.SAVE_RTF;_i.TerSetFocus()}KQ(false)}return true}function DU(){var t="";var f="text/rtf";if(oi.InputType==tc.SAVE_TEXT||oi.InputType==tc.SAVE_UTEXT)f="text/plain";vU("Open File",true,"","",f,l);function l(t,e){var r=t[0];if(e.length==0)return;var i=e.toLowerCase();if(Ck(i,".docx")||Ck(i,".doc")){qk(tg.MsgString[tc.MSG_INVALID_FILE_SELECTION],tg.MsgString[tc.MSG_SELECT_FILE_TYPES],tc.MSGTYPE_ALERT);vU("Open File",true,"","",f,l)}else return NU(r,e)}return true}function MU(a){var t;var e;var r=_i.DlgCompHeight;var i=_i.DlgFont;var f=[];var n=[];if(a==null||a=="")a="new.rtf";if(Ck(a.toLowerCase(),".rtf"))OutputFormat=tc.SAVE_RTF;else{if(oi.SaveFormat==tc.SAVE_DEFAULT)OutputFormat=lh;else OutputFormat=oi.SaveFormat}var l=-1,c=0;f.push("Rich Text Format(*.RTF)");n.push(tc.SAVE_RTF);if(OutputFormat==tc.SAVE_RTF)l=c;c++;f.push("Plain Text(*.TXT)");n.push(tc.SAVE_UTF8TEXT);if(OutputFormat==tc.SAVE_TEXT||OutputFormat==tc.SAVE_TEXT_LINES||OutputFormat==tc.SAVE_UTF7TEXT||OutputFormat==tc.SAVE_UTF8TEXT)l=c;c++;f.push("Unicode Text(*.TXT)");n.push(tc.SAVE_UTEXT);if(OutputFormat==tc.SAVE_UTEXT)l=c;c++;e=c;if(l==-1)l=0;a=GU(a,n[l]);var s=new $t.DialogBox(te,"Save File Name",i,true,function(t,e,r){E(t,e,r)});var _=s.cvs;var o=new $t.Label(_,0,0,i,"File Name");s.addComp(o,0,0,1,3,"Left","bottom");var u=new $t.TextBox(_,0,0,JV(400),r,a,i,_i.caret,false,true,null);s.addComp(u,1,0,1,3,"left","middle");var T=new $t.Label(_,0,0,i,"File Format");s.addComp(T,2,0,1,1,"left","bottom");var A=new $t.ComboBox(_,0,0,JV(250),r,true,JV(200),true,i,true,true,function(t,e){R(t,e,te)});A.setItems(f,n,l,false);A.setMaximumRowCount(e);s.addComp(A,2,1,1,2,"left","bottom",JV(-30));s.show();u.setFocus();function E(t,e,r){if(t=="Cancel"){s.hide();return}else if(t=="OK"){a=u.getText();if(a==""){u.setFocus();return}ih=a;var i=A.getSelectedIndex();lh=n[i];oi.SaveFormat=lh;s.hide();var f=Ek(te);KQ(true);HS=true;window.setTimeout(l,1)}else return;function l(){BU(a,true);KQ(false);Rk(te,f)}}function R(t,e,r){if(t!="selected")return;var i=e.getSelectedIndex();var f=n[i];var l=u.getText();l=GU(l,f);u.setText(l)}}function GU(t,e){var r=t,i="";var f=r.lastIndexOf(".");if(f>=0){i=r.substring(f).toLowerCase();r=r.substring(0,f)}if(e==tc.SAVE_TEXT||e==tc.SAVE_TEXT_LINES||e==tc.SAVE_UTF7TEXT||e==tc.SAVE_UTF8TEXT||e==tc.SAVE_UTEXT){if(i==".txt")return t;else{if(r.charCodeAt(0)>=tc.CHAR_A&&r.charCodeAt(0)<=tc.CHAR_Z)return r+".TXT";else return r+".txt"}}else{if(i==".rtf")return t;else{if(r.charCodeAt(0)>=tc.CHAR_A&&r.charCodeAt(0)<=tc.CHAR_Z)return r+".RTF";else return r+".rtf"}}return t}function BU(t,e){var r,i,f;var l,a=0,n,c=0;var s="",_;var o;var u=[];var T;var A=null;var E;var R=0;var L="tc.US-tc.ASCII";var C=false;var I="";if(e&&(t==null||t.length==0))return MU(t);if(e&&oi.InputType!=tc.CHAR_F){R=oi.InputType;oi.InputType=tc.CHAR_F;oi.hBuffer=null;oi.BufferLen=0}B5();if(oi.SaveFormat==tc.SAVE_DEFAULT)f=lh;else f=oi.SaveFormat;E=f==tc.SAVE_TEXT||f==tc.SAVE_TEXT_LINES||f==tc.SAVE_UTEXT||f==tc.SAVE_UTF7TEXT||f==tc.SAVE_UTF8TEXT;oi.hBuffer="";if(f==tc.SAVE_RTF){C=l3(tc.RTF_BUF,null);if(e)return _i.TerSaveToLocalFile(oi.hBuffer,t,"text/rtf");else return true}n=oi.BufferLen;oi.BufferLen=0;if(oi.delim!=13)CS=false;if(f==tc.SAVE_UTEXT){oi.BufferLen=1;for(l=0;l<Ri;l++){oi.BufferLen+=ui[l].len+1;if(!oi.WordWrap)oi.BufferLen++}}else{for(l=0;l<Ri;l++)oi.BufferLen+=ui[l].len+1;if(CS)oi.BufferLen=oi.BufferLen+Ri}u=[];if(Dj(zh&tc.TFLAG_NO_HOUR_GLASS)&&oi.InputType==tc.CHAR_F){A=XQ(U)}var d=f;if(f==tc.SAVE_UTEXT||f==tc.SAVE_UTF7TEXT||f==tc.SAVE_UTF8TEXT)f=tc.SAVE_TEXT;if(f==tc.SAVE_TEXT_LINES)_i.TerRewrap();for(l=0;l<Ri;l++){T=ui[l].txt;qY(T,0,u,a,ui[l].len);for(r=0;r<ui[l].len;r++){if(u[a+r]==0)u[a+r]=1;if(d==tc.SAVE_UTEXT&&u[a+r]==tc.NBSPACE_CHAR)u[a+r]=160}a+=ui[l].len;if(f==tc.SAVE_TEXT_LINES&&oi.WordWrap&&ui[l].len>0){o=u[a-1];if(o==Bn||o==TR||o==tc.LINE_CHAR||BY(o)&&o!=tc.PAGE_CHAR)a--}if(f!=tc.SAVE_TEXT_LINES&&oi.WordWrap){if(ui[l].len>0){o=u[a-1];if(o==Bn||o==tc.LINE_CHAR||o==TR||BY(o)&&o!=tc.PAGE_CHAR){u[a-1]=oi.delim;if(CS){u[a]=10;a++}}}}else{u[a]=oi.delim;a++;if(CS){u[a]=10;a++}}}if(oi.InputType==tc.CHAR_F){if(oi.SaveFormat==tc.SAVE_DEFAULT)f=lh;else f=oi.SaveFormat;var F="";if(f==tc.SAVE_UTEXT)F=wU(Wk(u,0,a),true);else F=HU(Wk(u,0,a),true);if(e)_i.TerSaveToLocalFile(F,t,"text/plain");else{oi.hBuffer=F;oi.BufferLen=F.length}}if(Ri==0){Ip(0);Ri=1}if(oi.modified!=Ro)Ro=-1;oi.modified=0;lr=0;if(oi.InputType==tc.CHAR_B){oi.BufferLen=a;if(oi.BufferLen==0){oi.hBuffer=wY(oi.delim);oi.BufferLen=1;if(CS){oi.hBuffer+=wY(10);oi.BufferLen++}}else oi.hBuffer=Wk(u,0,a)}else{}return true}function HU(t,e){var r=unescape(encodeURIComponent(t));var i="";if(e)i=Wk([239,187,191],3);return i+r}function mU(t){var e=unescape(encodeURIComponent(t));if(e.length>=3&&e.charCodeAt(0)==239&&e.charCodeAt(1)==187&&e.charCodeAt(2)==191)e=e.substring(3);return decodeURIComponent(escape(e))}function wU(t,e){var r=[];var i,f=t.length;for(i=0;i<f;i++)r.push(t.charCodeAt(i));return bU(r,e)}function bU(t,e){var r,i=t.length;var f="";if(e)f=String.fromCharCode(255)+String.fromCharCode(254);for(r=0;r<i;r++){var l=t[r];var a=l&255;var n=l>>8&255;f+=String.fromCharCode(a)+String.fromCharCode(n)}return f}function xU(t){var e=0,r=t.length;var i=[];if(r>=2&&t.charCodeAt(0)==255&&t.charCodeAt(1)==254)e=2;for(;e+1<r;e=e+2){var f=t.charCodeAt(e);var l=t.charCodeAt(e+1);var a=(l<<8)+f;i.push(a)}return i}_i.ReadTerFileLocal=function(t){var e=t.name;if(Ck(e.toLowerCase(),".docx"))pU(t,"binary",i);else if(EndWith(e.toLowerCase(),".doc"))pU(t,"binary",f);else pU(t,"text",r);function r(t){if(t!=null){_i.SetTerBuffer(t,"");ih=e}}function i(t){if(FileText!=null){}}function f(t){}};_i.ReadTerFileServer=function(t,e){t=OU(t);if(!hU(t)){if(e)e(false);return false}if(Ck(t.toLowerCase(),"docx")){if(e)e(false);return false}else if(Ck(t.toLowerCase(),"doc")){if(e)e(false);return false}else{gU(t,true,r)}function r(t){if(t!=null&&t.length>0){_i.SetTerBuffer(t,"");ih="";if(e)e(true)}else if(e)e(true)}return true};_i.SaveTerFile=function(t){var e=false;var r;var i;if(!lv||!QD())_i.TerCreateControl();if(oi.SaveFormat==tc.SAVE_HTML){if(!PK())return false;e=SK(true,t);return e}r=oi.InputType;if(oi.InputType!=tc.CHAR_F){oi.InputType=tc.CHAR_F;oi.hBuffer=null;oi.BufferLen=0}if(t!=null&&t.length>0)ih=t;if(BU(ih,false))e=true;oi.InputType=r;return e};function yU(t){var e,r,i;var f=false,l=false;var a,n=0;var c=null;var s;var _=[tc.MAX_WIDTH+1];var o,u=0;var T=null;var A=true,E,R=false;var L=tc.CHAR_B;var C="";var I=0;i=Ic.length;uO=null;qD();if(oi.InputType!=tc.CHAR_B)return false;if(oi.hBuffer==null&&oi.DocX==null)return true;if(oi.DocX!=null){var d=H9(tc.RTF_FILE,"",oi.DocX);oi.DocX=null;return d}if(oi.hBuffer!=null){if(Z0(tc.RTF_BUF,null,oi.hBuffer,oi.BufferLen))return true}c=Uk(oi.hBuffer);if(oi.BufferLen>c.length)oi.BufferLen=c.length;if(oi.delim==13)CS=true;else CS=false;if(Dj(zh&tc.TFLAG_NO_HOUR_GLASS)){T=XQ(U)}for(a=0;a<Ri;a++)dp(a);Ri=0;if(MO!=tc.ENGLISH)u=Zb(0,null);var F=-1;if(Nj(iO&tc.TFLAG9_RTL_UNICODE_FILE)){var g=0;var P=Nc[g].flow;var S=Nc[g].flags;if(P!=tc.FLOW_RTL||Dj(S&tc.RIGHT_JUSTIFY)){var h;P=tc.FLOW_RTL;S=cj(S,tc.LEFT|tc.CENTER|tc.RIGHT_JUSTIFY|tc.JUSTIFY);S|=tc.RIGHT_JUSTIFY;h=Nc[g].copy();h.flow=tc.FLOW_RTL;h.flags=S;F=QZ(g,h)}}var O=[];O.length=65536;if(O.fill==undefined){var v=O.length;for(r=0;r<v;r++)O[r]=-1}else O.fill(-1);t:{e:while(true){e=0;if(n>=oi.BufferLen)break t;r=e;while(n<oi.BufferLen&&c[n]!=oi.delim&&r<tc.MAX_WIDTH-2){_[r]=c[n];r++;n++}_[r]=0;if(n<oi.BufferLen&&c[n]==oi.delim){_[r]=10;r++;_[r]=0}if(A){if(oi.delim==13&&n<oi.BufferLen&&c[n]==oi.delim&&n+1<oi.BufferLen&&c[n+1]!=10)CS=false;A=false}if(CS&&n<oi.BufferLen&&c[n]==oi.delim&&n+1<oi.BufferLen&&c[n+1]==10)n++;if(r>0&&_[r-1]==10)n++;e=jY(_);for(r=0;r<e;r++){if(_[r]==160)_[r]=tc.NBSPACE_CHAR}E=false;if(e>0&&_[e-1]==10){if(oi.WordWrap)E=true;e--}_[e]=0;if(e==i&&nV(Ic,Wk(_,0,e))){f=true;break t}if(E){_[e]=Bn;e++;_[e]=0}if(l)continue e;if(e>tc.MAX_WIDTH){QY(tc.MSG_LINE_TRUNCATED,"TerRead");e=tc.MAX_WIDTH-1}if(!MY(Ri+1)){pr=true;QY(tc.MSG_LINE_TRUNCATED,"TerRead");pr=false;l=true;continue e}Ri++;br=Ri-1;Ip(br);if(e==1){if(_[0]==tc.ROW_CHAR||_[0]==TR){xX(br);if(Nj(ui[br].tabw)){if(_[0]==tc.ROW_CHAR)ui[br].tabw.type|=tc.INFO_ROW;if(_[0]==TR)ui[br].tabw.type|=tc.INFO_CELL}}X5(br,_[0])}Tm(br,0,e);s=ui[br].txt;if(e>0)qY(_,s,e);if(MO!=tc.ENGLISH&&ui[br].fmt==null&&lh==tc.SAVE_TEXT){var p=nb(br);for(r=0;r<ui[br].len;r++){if(!db(s,r,ui[br].len))p[r]=u}sb(br)}if(F>=0)ui[br].pfmt=F;WU(br,O)}}if(Ri==0){Ri=1;Ip(0)}if(Ri==1&&ui[0].len==0)lh=tc.SAVE_RTF;br=we=jt=0;Ro=-1;if(oi.WordWrap){var N=false;GR=true;nO|=tc.TOFLAG2_SSE_READ;if(oi.PageMode)yJ(false,false,0,true);else return T9(0,Ri);if(oi.PageMode){for(r=1;r<Kl;r++){if(kl[r].InUse){N=true;break}}}U5(false);if(N&&!yR&&oi.PageMode&&Dj(Zh&tc.TFLAG2_NO_AUTO_HDR_FTR)){var D=si;si=false;W5();si=D}if(N){_i.TerRepaginate(true)}if(yR&&oi.PageMode){var M=false;for(a=0;a<Ri;a++){if(Nj(Nc[ui[a].pfmt].flags&tc.PAGE_HDR)&&Dj(ui[a].flags&tc.LFLAG_HDRS)){if(!M)br=a;M=true;if(a>0&&Nj(ui[a-1].flags&tc.LFLAG_FHDR)){br=a;break}}if(Dj(Nc[ui[a].pfmt].flags&tc.PAGE_HDR_FTR))break}}if(N){_i.TerRepaginate(true);Fo=0}GR=false;uj(tc.TOFLAG2_SSE_READ)}FN(true);oi.modified=0;Fo=0;Ro=oi.modified-1;if(Nj(T))XQ(T);return true}function WU(t,e){var r;var i;var f,l,a,n,c;var s;i=ui[t].txt;r=nb(t);a=ui[t].len;for(f=0;f<a;f++){s=i[f];c=xs[r[f]].CharSet;if(s<256)continue;else if(e[s]>=0)r[f]=e[s];else{py(s,-1);r[f]=xb(r[f],RP,eF,rF);e[s]=r[f]}}sb(t);return true}function UU(t){return 0}function kU(t){return PU(t,false,null)}_i.TerSetDefDir=function(t,e){if(!lv||!QD())_i.TerCreateControl();hO=t;vO=e;return true};_i.TerSetLinkPictDir=function(t){u_=t;return true};_i.TerSetPlaceHolderPict=function(t){T_=t;return true};_i.TerGetPlaceHolderPict=function(){return T_};_i.TerSetWebFolder=function(t){fv=t;return true};_i.TerGetTextSel=function(){if(!lv||!QD())_i.TerCreateControl();if(uA==tc.HILIGHT_OFF)return null;if(!ON())return null;if(JN(tc.ID_COPY,false)){var t=Wk(vs);vs=null;return t}else return null};_i.TerInsertLine=function(t,e,r,i,f,l){var a,n=null;var c,s;var _;var o=false;var u=0;if(!lv||!QD())_i.TerCreateControl();s=t.length;if(!MY(Ri+1))return true;n=Uk(t);iw(br,1,tc.CHAR_B);_=br;br++;jt=0;Tm(_,0,s);a=ui[_].txt;for(c=0;c<s;c++){a[c]=n[c]}if(s>=2&&a[s-2]==13){if(oi.WordWrap){a[s-2]=Bn;Tm(_,s,s-1)}else return Tm(_,s,s-2);o=true}else if(s>0&&n[s-1]==tc.PARA_CHAR)o=true;else if(s>0&&n[s-1]==TR)u|=tc.INFO_CELL;else if(s>0&&n[s-1]==tc.ROW_CHAR)u|=tc.INFO_ROW;ui[_].fmt=null;if(e>=0&&e<Ys&&xs[e].InUse)ui[_].UniFmt=e;else if(Oc>=0)ui[_].UniFmt=Oc;else ui[_].UniFmt=tc.DEFAULT_CFMT;if(r>=0&&r<Dc)ui[_].pfmt=r;if(i>=0&&i<fR)ui[_].cid=i;if(f>=0&&f<Kl)ui[_].fid=f;if(Nj(u)){if(xX(_))ui[_].tabw.type=u}if(o||Nj(u&tc.INFO_CELL))ui[_].flags=tc.LFLAG_PARA;if(!GR)V8(br-1,0,br-1,ui[br-1].len-1,gk("I"));if(l){Dt=Mt/xs[0].height;cG()}return true};_i.TerInsertText=function(t,e,r,i){var f=null,l=[2];var a;var n;if(!lv||!QD())_i.TerCreateControl();a=Oc;if(e>=0&&e<Ys&&xs[e].InUse){if(r>=0&&r<Dc&&Nc[r].StyId>0){e=Bb(e,xs[e].CharStyId,Nc[r].StyId)}Oc=e}if(Oc==-1)Oc=$w();if(r>=0&&r<Dc){l[0]=r;l[1]=-1;f=l}n=br;qN(t,null,f,false);Oc=a;if(i){Dt=Mt/xs[0].height;cG()}else if(oi.WordWrap)T9(n,br-n+1);return true};_i.TerGetLineInfo=function(t){var e=0;if(!lv||!QD())_i.TerCreateControl();bI=xI=nd=td=ed=ZI=WI=yI=0;if(t==-1)t=br;if(t<0||t>=Ri)return false;bI=ui[t].pfmt;xI=ui[t].cid;nd=ui[t].fid;td=ui[t].x;ed=ui[t].y;if(oi.PageMode){if(Ci)ed-=rr;else if(!yR){e=G5(t);var r=Ei*to[e].TopMargin;ed+=r}else{e=G5(t);ed+=eo[e].HiddenY}}ZI=ui[t].height;WI=ui[t].flags;if(Nj(ui[t].tabw))yI=ui[t].tabw.type;else yI=0;return true};_i.TerGetLineParam=function(t,e){var r;if(!lv||!QD())_i.TerCreateControl();if(t>=Ri)return tc.LP_ERROR;if(t<0)t=br;if(e==tc.LP_LINE_FLAGS)return ui[t].flags;else if(e==tc.LP_PARA_ID)return ui[t].pfmt;else if(e==tc.LP_LINE_FLAGS2)return ui[t].flags2;else if(e==tc.LP_LINE_LEN)return ui[t].len;else if(e==tc.LP_LINE_NUM)return t;else if(e==tc.LP_LIST_NBR){if(Dj(ui[t].tabw)||ui[t].tabw.ListTextWidth==0)return tc.LP_ERROR;else return ui[t].tabw.ListNbr}else if(e==tc.LP_LIST_FONT){if(Dj(ui[t].tabw)||ui[t].tabw.ListTextWidth==0)return tc.LP_ERROR;else return ui[t].tabw.ListFontId}else if(e==tc.LP_LIST_TEXT_WIDTH){if(Dj(ui[t].tabw))return tc.LP_ERROR;else{var i=ui[t].tabw.ListTextWidth;if(oi.PageMode&&!oi.FittedView)return MV(i);else return gV(i)}}else if(e==tc.LP_LIST_BULLET_SYM){if(Dj(ui[t].tabw))return tc.LP_ERROR;else{var f=ui[t].tabw.ListText;if(f!=null&&f.length==1)return Uk(f)[0];else return tc.LP_ERROR}}else if(e==tc.LP_CELL_ID)return ui[t].cid;else if(e==tc.LP_PARA_FRAME_ID)return ui[t].fid;else if(e==tc.LP_LIST_ID||e==tc.LP_LIST_OR_ID||e==tc.LP_LIST_LEVEL){var l=ui[t].pfmt;var a=Nc[l].BltId;var n=xc[a].ls;if(a==0)return 0;if(e==tc.LP_LIST_ID)return Jc[n].ListIdx;if(e==tc.LP_LIST_OR_ID)return n;if(e==tc.LP_LIST_LEVEL)return xc[a].lvl}else if(e==tc.LP_PARA_MARK){var c=ui[t].len;if(c>0&&ui[t].txt[c-1]==Bn)return 1;else return 0}else if(e==tc.LP_HEIGHT)return HV(ui[t].height);else if(e==tc.LP_PARA_FIRST_LINE){if(t==0)return t;for(r=t;r>0;r--){if(Nj(ui[r-1].flags&(tc.LFLAG_PARA|tc.LFLAG_BREAK)))return r}return 0}else if(e==tc.LP_PARA_LAST_LINE){if(t>=Ri-1)return t;for(r=t;r<Ri;r++){if(Nj(ui[r].flags&(tc.LFLAG_PARA|tc.LFLAG_BREAK)))return r}return Ri-1}else if(e==tc.LP_SECT_ID)return G5(t);return tc.LP_ERROR};_i.TerGetLineParamStr=function(t,e){if(!lv||!QD())_i.TerCreateControl();if(t>=Ri)return"";if(t<0)t=br;if(e==tc.LP_LIST_TEXT){if(Dj(ui[t].tabw)||ui[t].tabw.ListText==null)return null;else return ui[t].tabw.ListText}return""};_i.TerGetLine=function(t){var e;var r;var i;if(!lv||!QD())_i.TerCreateControl();vP="";Qg=[1];if(t<0||t>=Ri)return-1;e=ui[t].txt;if(e!=null)vP=Wk(e,0,ui[t].len);r=nb(t);Qg=[ui[t].len];for(i=0;i<ui[t].len;i++)Qg[i]=r[i];sb(t);return ui[t].len};_i.TerGetLineText=function(t){var e;var r="";if(!lv||!QD())_i.TerCreateControl();if(t<0||t>=Ri)return"";e=ui[t].txt;if(e!=null)r=Wk(e,0,ui[t].len);return r};_i.TerSetLine=function(t,e,r){var i;var f;var l,a,n;if(!lv||!QD())_i.TerCreateControl();if(t==Ri){if(!MY(Ri+1)){return QY(tc.MSG_MAX_LINES_EXCEEDED,"SetTerLine")}Ri++;Ip(t);oi.modified++}a=e.length;if(t>=0&&t<Ri){if(a<0)a=0;n=ui[t].len;Tm(t,ui[t].len,a);if(a>0){i=ui[t].txt;var c=Uk(e);for(l=0;l<ui[t].len;l++){i[l]=c[l]}f=nb(t);if(a>n){for(l=n;l<a;l++){if(n>0)f[l]=f[n-1];else f[l]=tc.DEFAULT_CFMT;if(Nj(xs[f[l]].style&tc.PICT))f[l]=tc.DEFAULT_CFMT}}if(r!=null){for(l=0;l<ui[t].len;l++){var s=Math.floor(r[l]);if(s<=Ys&&xs[s].InUse)f[l]=s}}sb(t);oi.modified++}}return true};_i.TerAppendText=function(t,e,r,i){return _i.TerAppendTextEx(t,e,r,-1,-1,i)};_i.TerAppendTextEx=function(t,e,r,i,f,l){return _i.TerAppendText2(t,e,r,i,f,l)};_i.TerAppendTextEx2=function(t,e,r,i,f,l,a,n){return _i.TerAppendText3(t,e,r,i,f,l,a,n)};_i.TerAppendText2=function(t,e,r,i,f,l){return _i.TerAppendText3(t,e,r,i,f,0,0,l)};_i.TerAppendText3=function(t,e,r,i,f,l,a,n){var c=null;var s=[2];var _,o;var u,T,A,E=0;var R,L,C,I,d=0,F=0,g;var P=0,S=0,h=-1;var O,v=null;var p,N=0,D=-1;var M;if(!lv||!QD())_i.TerCreateControl();e=Math.floor(e);r=Math.floor(r);i=Math.floor(i);f=Math.floor(f);if(l>0||a>0){if(i==l)i=0;if(f==a)f=0;for(p=Ri-1;p>=0;p--){if(f>0&&ui[p].fid==f)break;if(i>0&&ui[p].cid==i)break;if(l>0&&ui[p].cid>0)continue;if(ui[p].fid>0&&ui[p].fid!=f)continue;break}D=p+1}v=Uk(t);if(e>=0&&ui[0]>255&&xs[e].CharSet==0&&Yq(ui[0])){var G=kq(ui[0])?tc.ARABIC_CHARSET:tc.HEBREW_CHARSET;e=yb(e,G,0)}t:{if(oi.WordWrap)I=ft/3;else I=ft-2;g=v.length;for(R=0;R<g;R++){if(ui[R]==0)break;if(ui[R]==13)d++;if(ui[R]==Bn||ui[R]==TR||ui[R]==tc.LINE_CHAR)F++;if(ui[R]==TR)N|=tc.INFO_CELL;if(ui[R]==tc.ROW_CHAR)N|=tc.INFO_ROW;if(d==1&&h<0)h=R}if(g==0)break t;e:{r:{M=h>=0&&h<g-2;if(i>0||f>0)break r;if(g>=ft&&!oi.WordWrap||d+F>1)break e;if(d==1&&g>=2&&ui[g-2]!=13)break e;if(F==1&&g>=1&&ui[g-1]!=Bn&&ui[g-1]!=tc.LINE_CHAR&&ui[g-1]!=TR)break e}_=0;g=v.length;while(_<g){o=g-_;if(o>I)o=I;if(ui[_+o-1]==13&&o==I)o-=1;if(M){for(R=0;R<o-2;R++){if(ui[_+R]==13&&ui[_+R+1]==10){o=R+2;break}}}if(!MY(Ri+1))break t;if(D>=0){iw(D,1,tc.CHAR_B);A=D}else{A=Ri;Ri++}Ip(A);Tm(A,0,o);O=ui[A].txt;var B=nb(A);for(R=0;R<o;R++){O[R]=v[_+R];if(e>=0&&e<Ys&&xs[e].InUse)ui[A].fmt[R]=e;else if(Oc>=0)ui[A].fmt[R]=Oc;else ui[A].fmt[R]=0;ui[A].fmt[R]=vy(ui[A].fmt[R],O[R])}if(o>=2&&O[o-2]==13){if(oi.WordWrap){O[o-2]=Bn;Tm(A,o,o-1)}else Tm(A,o,o-2)}if(Nj(Qh&tc.TFLAG3_HTML_READ)&&F>0&&e>=0&&xs[e].FieldId==tc.FIELD_HLINK){var H;B=nb(A);O=ui[A].txt;H=ui[A].len;for(R=0;R<H;R++){if(O[R]==Bn||O[R]==TR)B[R]=_i.TerGetFieldFont(B[R],0,null)}}if(r>=0&&r<Dc)ui[A].pfmt=r;if(i>=0&&i<fR)ui[A].cid=i;if(f>=0&&f<Kl)ui[A].fid=f;if(Nj(N)){if(xX(A))ui[A].tabw.type=N}if(F>0&&_+o==g)ui[A].flags=tc.LFLAG_PARA;_+=o}break t}C=Oc;if(e>=0&&e<Ys&&xs[e].InUse)Oc=e;if(r>=0&&r<Dc){s[0]=r;s[1]=-1;c=s}u=br;T=we;L=jt;if(D>=0){br=D;jt=0}else{br=Ri-1;jt=ui[br].len;E=br;P=ui[E].cid;if(i>=0)ui[br].cid=i;S=ui[E].fid;if(f>=0)ui[br].fid=f}qN(v,null,c,false);if(D>=0){for(p=D;p<br;p++){ui[p].cid=i;ui[p].fid=f}}else{if(i>=0)ui[E].cid=P;if(f>=0)ui[E].fid=S}br=u;we=T;jt=L;Oc=C}if(n){Dt=Mt/xs[0].height;cG()}return true};_i.TerDocName=function(t,e){if(!lv||!QD())_i.TerCreateControl();LP=e;if(t)LP=ih;else ih=e;return true};_i.TerSetOutputFormat=function(t){if(!lv||!QD())_i.TerCreateControl();if(t!=tc.SAVE_DEFAULT&&t!=tc.SAVE_TEXT&&t!=tc.SAVE_TEXT_LINES&&t!=tc.SAVE_RTF&&t!=tc.SAVE_HTML&&t!=tc.SAVE_UTEXT)return false;if(t==tc.SAVE_HTML&&!gK())return false;oi.SaveFormat=t;oi.modified++;lr=oi.modified;return true};_i.GetData=function(){return _i.GetTerBuffer()};_i.GetTerBuffer=function(){var t;var e=null;var r;if(!lv||!QD())_i.TerCreateControl();if(oi.SaveFormat==tc.SAVE_HTML){r=null;if(!PK())return null;if(!SK(false,null))return null;r=AP;return r}t=oi.InputType;if(oi.InputType!=tc.CHAR_B){oi.InputType=tc.CHAR_B;oi.hBuffer=null;oi.BufferLen=0;oi.delim=13}t:{oi.hBuffer=null;if(Nj(oi.modified)||oi.hBuffer==null){if(!BU(ih,false))break t}if(Dj(oi.modified)&&oi.hBuffer!=null){e=oi.hBuffer;r=Uk(e);oi.hBuffer=null;oi.BufferLen=0}}oi.InputType=t;return e};_i.SetData=function(t){return _i.SetTerBuffer(t,null,ih)};_i.SetTerBuffer=function(t,e){var r=null;if(typeof t!="string"){r=t;t=""}return _i.SetTerBuffer2(t,r,e)};_i.SetTerBuffer2=function(t,e,r){var i;var f=null;var l;var a=false;var n=new tc.ClsFont;var c=new tc.ClsPrtFont;var s=0;var _=false;var o=tc.CHAR_B;var u="";var T=0;if(!_i.TerCreateControl())return false;if(tg.expired)return false;qD();if(Nj(qh&tc.TFLAG4_HTML_INPUT)){if(!PK())return false;for(i=0;i<Ri;i++)dp(i);fp();oi.hBuffer=null;oi.BufferLen=0;vr=true;a=hK(false,"",t);if(!a)vr=false;return a}l=oi.InputType;if(oi.InputType!=tc.CHAR_B){oi.InputType=tc.CHAR_B;oi.hBuffer=null;oi.BufferLen=0;oi.delim=13}if(Dj(zh&tc.TFLAG_NO_HOUR_GLASS)){f=XQ(U)}for(i=0;i<Ri;i++)dp(i);if(f!=null)XQ(f);if(Nj(jh)){eb(false,jh,n,c);n=$d;c=tF;s=jh;jh=0}fp();oi.hBuffer=null;oi.hBuffer=t;oi.DocX=e;oi.BufferLen=t.length;oi.InputType=tc.CHAR_B;t:{if(e!=null){_=false;if(tg.WrsFound){o=oi.InputType;u=oi.hBuffer;T=oi.BufferLen;_=mK("",e);if(_&&!yU(ih))break t}if(!_&&!H9(tc.RTF_BUF,"",e))break t}else{if(!yU(ih))break t}if(Nj(Qh&tc.TFLAG3_SELECT_FIRST_FIELD)||mh)Gw();if(oi.ShowHorBar||oi.ShowVerBar)h$();a=true}if(tg.WrsFound&&_){oi.InputType=o;oi.hBuffer=u;oi.BufferLen=T}oi.InputType=l;if(Nj(s)){if(Ys>=f_){var A=f_+f_/3+1;Mx(A)}xs[Ys].CharWidth=null;xs[Ys].hidden=null;Xs[Ys].CharWidth=null;Xs[Ys].hidden=null;eb(true,Ys,n,c);n=$d;c=tF;Ys++;_i.TerSetBkPictId(Ys-1,Jh,true)}else return cG();return a};_i.TerSetHtmlInput=function(t){vr=t;return true};_i.TerDebug=function(t){NS=t};_i.TerTest=function(t,e,r){var i=tc.GetElementPosition(ee)};_i.TerTest2=function(t,e,r){var i=XQ(U);var f=function(){var t=0;this.y=0;this.fct1=function(){this.z=0};function e(){t=y}};obj=new f;for(var l in obj){console.log("attr: ",l,"type: ",typeof obj[l],"has own property: ",obj.hasOwnProperty(l))}};var XU;_i.TerTest3=function(t,e,r){ZeroClipboard.config({swfPath:"http://www.subsystems.com/ZeroClipboard.swf"});if(ZeroClipboard.isFlashUnusable())console.log("flash not usable!");XU=new ZeroClipboard(document.getElementById("copy-button"));console.log("got client",XU.toString());XU.on("ready",YU);XU.on("error",KU);XU.on("copy",VU);XU.on("paste",jU)};function KU(t){console.log("ZeroClipboard SWF Error!",t.name,t.message)}function YU(t){console.log("ZeroClipboard SWF is ready!")}function VU(t){t.target.style.display="none";console.log("Copied text to clipboard: ",t.data["text/plain"])}function jU(t){console.log("Past from clipboard: ",t.data["text/plain"])}$t.TerTest4=function(t,e,r){var i="This is a test line. ";para1=i+i+i;para2="new para: "+i+i+i+i+i+i+i+i+i+i+"\r\n";para3=para1+para2+para2+para2+para2+para2;qN(para3+para3+para3+para3,null,0,false);cG();_i.TerRepaginate(true);_i.TerSetFocus()};function JU(){return true}function zU(t,e){return tc.GetElementPosition(t,e)}$t.TerSetDebugMode=function(t){tg.DebugMode=t};function ZU(t){if(tg.DebugMode)PY(t);return true}function QU(){if(document.activeElement==null||document.activeElement==undefined||document.activeElement.id==undefined)return false;if(_i.DlgLevel>0)return false;return document.activeElement.id===te||document.activeElement.id=="textareafor"+te||document.activeElement===_i.VirtTextarea}function qU(){}function $U(t){if(t==undefined){PY("Undefined variable used!");console.trace();return t}else if(typeof t=="number"&&isNaN(t)){PY("NaN value number used!");console.trace();return t}else return t}function tk(t,e){if(arguments.length!=2||typeof t!="object"||typeof e!="number"){PY("invalid call to CheckParamCount!");console.trace();return false}if(t.length!=e){PY("Expected ",e,",but found ",t.length," parameter(s)!")}return true}function ek(t,e){if(arguments.length!=2||typeof e!="string"){PY("invalid call to ParamIsNumber!");console.trace();return false}if(typeof t!="number"){var r=typeof t;if(r=="object"&&t.ObjType!=undefined)r=t.ObjType;PY("Invalid parameter ",e,",expected object of type: Number, but found: ",r,"!");console.trace();return false}else if(isNaN(t)){PY("NaN value found for the number parameter!",e);console.trace();return false}return true}function rk(t,e){if(arguments.length!=2||typeof e!="string"){PY("invalid call to ParamIsBoolean!");console.trace();return false}if(typeof t!="boolean"){var r=typeof t;if(r=="object"&&t.ObjType!=undefined)r=t.ObjType;PY("Invalid parameter ",e,",expected object of type: boolean, but found: ",r,"!");console.trace();return false}else return true}function ik(t,e){if(arguments.length!=2||typeof e!="string"){PY("invalid call to ParamIsNumber!");console.trace();return false}if(typeof t!="string"){var r=typeof t;if(r=="object"&&t.ObjType!=undefined)r=t.ObjType;PY("Invalid parameter ",e,",expected object of type: String, but found: ",r,"!");console.trace();return false}return true}function fk(t,e,r){if(arguments.length!=3||typeof e!="string"||typeof r!="string"){PY("invalid call to ParamIsObject!");console.trace();return false}if(t==null||typeof t!="object"||t.ObjType!=r){var i=typeof t;if(i=="object"&&t!=null&&t.ObjType!=undefined)i=t.ObjType;PY("Invalid parameter ",e,",expected object of type: ",r,", but found: ",i,", value: ",t);console.trace();return false}return true}function lk(t){var e=(new Date).getTime();while((new Date).getTime()<e+t);}function ak(t){if(t>=tc.CHAR_A&&t<=tc.CHAR_Z)return true;else if(t>=tc.CHAR_a&&t<=tc.CHAR_z)return true;else return false}function nk(t){var e=tg.FromText.indexOf(t);if(e>=0)return tg.ToText[e];else return t}function ck(t){var e=new ArrayBuffer(t.length);var r=new Uint8Array(e);for(var i=0,f=t.length;i<f;i++){r[i]=t.charCodeAt(i)}return e}function sk(t){return t>=tc.CHAR_a&&t<=tc.CHAR_z}function _k(t){return t>=tc.CHAR_A&&t<=tc.CHAR_Z}function ok(t){if(!sk(t))return t;return t-tc.CHAR_a+tc.CHAR_A}function uk(t){if(!_k(t))return t;return t-tc.CHAR_A+tc.CHAR_a}function Tk(t,e,r){if(typeof r=="undefined")r=false;if(typeof t!="string"){console.log("str1: ",t);console.trace()}if(typeof e!="string"){console.log("str2: ",e);console.trace()}if(typeof r!="boolean"){console.log("UseLocale: ",r);console.trace()}if(r){t=t.toLocaleLowerCase();e=e.toLocaleLowerCase()}else{t=t.toLowerCase();e=e.toLowerCase()}return t==e?0:t>e?1:-1}function Ak(t,e){if(!t&&!e)return true;if(!t||!e)return false;if(!t.dt&&!e.dt)return true;if(!t.dt||!e.dt)return false;return t.dt.valueOf()==e.dt.valueOf()}function Ek(t){var e=document.createElement("div");e.style.position="absolute";e.style.left="0px";e.style.top="0px";e.style.width=window.innerWidth+"px";e.style.height=window.innerHeight+"px";e.style.backgroundColor="#000";e.style.opacity=".03";e.style.zIndex=_i.cvs.style.zIndex+_i.DlgLevel*1e3-1;var r=document.body||document.documentElement;r.appendChild(e);return e}function Rk(t,e){var r=$t.GetTerData(t);var i=document.body||document.documentElement;i.removeChild(e)}function Lk(t,e){if(e==null||e==undefined)console.trace();var r=t.length;var i=e.length;return r>=i&&t.substr(0,i)==e}function Ck(t,e){var r=t.length;var i=e.length;return r>=i&&t.substr(r-i,r)==e}_i.TerSetJnaPictQuality=function(t){pe=t};_i.TerPrintVars=function(){var t,e;var r;PY("********* Begins info ******************************************************");PY("CurLine/CurCol: ",br,jt);PY("Total: Lines: ",Ri," Fonts: ",Ys,"Para Ids: ",Dc,"Cells: ",fR,"Table Rows: ",iR);PY("       Para frames: %d, Sections: %d",Kl,ro);PY("Hilight Type: ",uA," Begin row/col ",sA,TA," end: row/col: ",_A,AA," Stretch: ",OA);var i=iW(br);PY("Screen frame no: ",i,"beg-line: ",pl[i].PageFirstLine,"end-line: ",pl[i].PageLastLine,"x/y: ",pl[i].x,pl[i].y,"w/h: ",pl[i].width,pl[i].height);if(ui[br].cid>0){PY(" ");PY("** cell info **");var f=ui[br].cid;var l=eR[f].row;PY("cid: ",f,"PrevCell: ",eR[f].PrevCell,"NextCell: ",eR[f].NextCell," level: ",eR[f].level,"ParentCell: ",eR[f].ParentCell);PY("         col-span: ",eR[f].ColSpan," row-span: ",eR[f].RowSpan);PY("row: ",l,"PrevRow: ",$E[l].PrevRow,"NextRow: ",$E[l].NextRow)}PY(" ");PY("** line info **");PY("ParaId: ",ui[br].pfmt," CellId: ",ui[br].cid,"ParaFrameId: ",ui[br].fid);PY("line.length: ",ui[br].len,"height: ",ui[br].height);if(ui[br].tabw!=null){PY("Frame space before: ",ui[br].tabw.height)}t=" Char codes: ";e="   var Font Ids:  ";var a=ui[br].txt;var n=nb(br);for(r=0;r<ui[br].len;r++){t+=bJ(a[r]);e+=mY(n[r]);if(r+1<ui[br].len){t+=" ";e+=" "}}PY(t);PY(e);PY(" **Current font info **");var c=ib(br,jt);PY("Font id: ",c," tf: ",xs[c].TypeFace,"ts: ",xs[c].TwipsSize," cs: ",xs[c].CharSet," lang: ",c,xs[c].lang);PY("   Font string: ",xs[c].font.FontString);PY("     field-id: ",xs[c].FieldId," is-pict: ",Nj(xs[c].style&tc.PICT));if(Nj(xs[c].style&tc.PICT))PY("  pict twips w/pict w/prt pict w: ",xs[c].PictWidth,xs[c].CharWidth[tc.PICT_CHAR],Xs[c].CharWidth[tc.PICT_CHAR]);PY("  **Current para info ***");var s=ui[br].pfmt;var _=Nc[s].TabId;PY("  para-id: ",s," tab-id: ",_," tab-count: ",B_[_].count);PY("      indents,left/right/first(twips): ",Nc[s].LeftIndentTwips,Nc[s].RightIndentTwips,Nc[s].FirstIndentTwips);PY("   ***");PY("   *** Other info ***");PY("TerWinOrgX/Y: ",Ft,Gt,"TerWinWidth/Height: ",je,Mt,"TerWinVisibleHeight",Tt);PY("Caret engaged: ",VR);PY("********* End info ***********************")};function Ik(t){return null}function dk(t){if(t>=tc.CHAR_0&&t<=tc.CHAR_9)return true;else if(t>=tc.CHAR_a&&t<=tc.CHAR_F)return true;else if(t>=tc.CHAR_A&&t<=tc.CHAR_F)return true;else return false}function Fk(t){if(t>=gk("0")&&t<=gk("9"))return t-gk("0");else if(t>=gk("a")&&t<=gk("f"))return t-gk("a")+10;else if(t>=gk("A")&&t<=gk("F"))return t-gk("A")+10;else return 0}function gk(t){return t.charCodeAt(0)}function Pk(t){var e=t;if(e<128||e>255)return t;if(jS==null){jS=[128];for(i=0;i<128;i++)jS[i]=128+i;jS[0]=196;jS[1]=197;jS[2]=199;jS[3]=201;jS[4]=209;jS[5]=214;jS[6]=220;jS[7]=225;jS[8]=224;jS[9]=226;jS[10]=228;jS[11]=227;jS[12]=229;jS[13]=231;jS[14]=233;jS[15]=232;jS[16]=234;jS[17]=235;jS[18]=237;jS[19]=236;jS[20]=238;jS[21]=239;jS[22]=241;jS[23]=243;jS[24]=242;jS[25]=244;jS[26]=246;jS[27]=245;jS[28]=250;jS[29]=249;jS[30]=251;jS[31]=252;jS[64]=191;jS[65]=161;jS[66]=172;jS[67]=8730;jS[68]=402;jS[69]=8776;jS[70]=8710;jS[71]=171;jS[72]=187;jS[73]=8230;jS[74]=tc.CHAR_SPACE;jS[75]=192;jS[76]=195;jS[77]=213;jS[78]=tc.CHAR_SPACE;jS[79]=tc.CHAR_SPACE}return jS[e-128]}function Sk(t){var e=t;if(e<128||e>255)return t;if(JS==null){JS=[128];for(i=0;i<128;i++)JS[i]=128+i;JS[30]=382;JS[102]=269;JS[104]=263}return JS[e-128]}_i.TerHtmlNegativeIndent=function(){var t,e,r=0,i=0;if(!lv||!QD())_i.TerCreateControl();for(t=0;t<Dc;t++){e=Nc[t].LeftIndentTwips;if(Nc[t].FirstIndentTwips<0){if(Nc[t].BltId==0||Dj(Nc[t].pflags&tc.PFLAG_NO_NUM_LIST))e+=Nc[t].FirstIndentTwips}if(e<r)r=e}for(t=0;t<iR;t++){var f;if(!$E[t].InUse)continue;if($E[t].AddedIndent==0&&$E[t].CurIndent>=0)continue;if(Nj($E[t].flags&(tc.CENTER|tc.RIGHT_JUSTIFY)))continue;f=$E[t].FirstCell;if(eR[f].level>0)continue;e=-$E[t].AddedIndent;if($E[t].CurIndent<0){var l=MV($E[t].CurIndent);if(l<e)e=l}if(e<r)r=e}for(t=0;t<Kl;t++){if(Nj(kl[t].flags&(tc.PARA_FRAME_CENTER|tc.PARA_FRAME_RIGHT_JUST)))continue;if(kl[t].x+kl[t].width<0)continue;if(kl[t].x<r)r=kl[t].x}i=to[0].LeftMargin*1440;if(-r>i)r=-i;return-r};_i.TerSetNativeFileFolder=function(t){if(t==null)t="";KS=t;return true};function hk(t){var e;if(D_==null)return true;for(e=1;e<M_;e++){if(D_[e].exp!=null)Ok(D_[e].exp,D_[e].ExpCount)}if(t){M_=G_=0}else M_=1;return true}function Ok(t,e){var r;if(t==null)return true;for(r=0;r<e;r++)vk(t[r]);return true}function vk(t){if(t==null)return true;if(t.exp!=null)Ok(t.exp,t.ExpCount);return true}_i.TerSetAutoWidth=function(){var t=0;var e=0;var r;var i,f;var l=0,a=0;var n,c=0;if(!lv||!QD())_i.TerCreateControl();for(n=0;n<Ri;n++){e+=H$(n,false,true,true);f=ui[n].pfmt;e+=Nc[f].LeftIndent;if(Nj(ui[n].flags&tc.LFLAG_PARA_FIRST))e+=Nc[f].FirstIndent;if(Nj(ui[n].flags&(tc.LFLAG_PARA|tc.LFLAG_BREAK))){if(e>t)t=e;e=0}}t=gV(t)+c;for(i=0;i<ro;i++){if(to[i].LeftMargin>l)l=to[i].LeftMargin;if(to[i].RightMargin>a)a=to[i].RightMargin}r=t+jV(l+a);_i.SelectTerText(0,0,Ri-1,ui[Ri-1].len-1,false);_i.TerSetPflags(tc.PFLAG_NO_WRAP,true,false);_i.DeselectTerText(false);_i.TerSetSectPageSize(tc.SECT_ALL,0,r,jV(to[0].PprHeight),true);return true};_i.TerGetOutStr=function(t){if(!lv||!QD())_i.TerCreateControl();if(Tk(t,"Search")==0)return TP;if(Tk(t,"OutBuf")==0)return AP;if(Tk(t,"AuxText")==0)return EP;if(Tk(t,"Typeface")==0)return RP;if(Tk(t,"Name")==0)return LP;if(Tk(t,"ListText")==0)return CP;if(Tk(t,"ListName")==0)return IP;if(Tk(t,"ListPrefix")==0)return dP;if(Tk(t,"OutRtf")==0)return FP;if(Tk(t,"FileName")==0)return gP;if(Tk(t,"Info")==0)return PP;if(Tk(t,"NewText")==0)return SP;if(Tk(t,"Items")==0)return hP;if(Tk(t,"Data")==0)return OP;if(Tk(t,"Text")==0)return vP;if(Tk(t,"UniText")==0)return pP;if(Tk(t,"FieldCode")==0)return NP;if(Tk(t,"LinkInfo")==0)return DP;if(Tk(t,"Target")==0)return MP;if(Tk(t,"Msg")==0)return GP;if(Tk(t,"Str")==0)return BP;if(Tk(t,"OutData")==0)return HP;if(Tk(t,"BkColor")==0)return WP.toString();if(Tk(t,"Color")==0)return UP.toString();if(Tk(t,"FieldCode")==0)return NP;if(Tk(t,"ListText")==0)return CP;return""};_i.TerGetOutInt=function(t){if(!lv||!QD())_i.TerCreateControl();if(Tk(t,"Line")==0)return PC;if(Tk(t,"Col")==0)return SC;if(Tk(t,"StartLine")==0)return zC;if(Tk(t,"StartCol")==0)return ZC;if(Tk(t,"ParaId")==0)return bI;if(Tk(t,"ParaFID")==0)return nd;if(Tk(t,"X")==0)return td;if(Tk(t,"Y")==0)return ed;if(Tk(t,"Width")==0)return zI;if(Tk(t,"Height")==0)return ZI;if(Tk(t,"LFlags")==0)return WI;if(Tk(t,"InfoFlags")==0)return yI;if(Tk(t,"TwipsSize")==0)return YC;if(Tk(t,"Style")==0)return KC;if(Tk(t,"PointSize")==0)return VC;if(Tk(t,"StringLen")==0)return yC;if(Tk(t,"LeftIndent")==0)return NI;if(Tk(t,"RightIndent")==0)return DI;if(Tk(t,"FirstIndent")==0)return MI;if(Tk(t,"TabId")==0)return GI;if(Tk(t,"StyId")==0)return BI;if(Tk(t,"AuxId")==0)return HI;if(Tk(t,"Shading")==0)return mI;if(Tk(t,"Pflags")==0)return wI;if(Tk(t,"SpaceBefore")==0)return UI;if(Tk(t,"SpaceAfter")==0)return kI;if(Tk(t,"SpaceBetween")==0)return XI;if(Tk(t,"Flags")==0)return YI;if(Tk(t,"Aux1Id")==0)return VI;if(Tk(t,"LineSpacing")==0)return KI;if(Tk(t,"TabPos")==0)return aI;if(Tk(t,"TabType")==0)return cI;if(Tk(t,"TabFlags")==0)return nI;if(Tk(t,"LeftMargin")==0)return Ig;if(Tk(t,"RightMargin")==0)return dg;if(Tk(t,"TopMargin")==0)return Fg;if(Tk(t,"BotMargin")==0)return gg;if(Tk(t,"HeaderY")==0)return Pg;if(Tk(t,"FooterY")==0)return Sg;if(Tk(t,"BorderType")==0)return Ng;if(Tk(t,"BorderWidth")==0)return pg;if(Tk(t,"BorderSpace")==0)return Dg;if(Tk(t,"NumCols")==0)return hg;if(Tk(t,"ColSpace")==0)return Og;if(Tk(t,"FirstPageNo")==0)return vg;if(Tk(t,"HiddenX")==0)return gd;if(Tk(t,"HiddenY")==0)return Pd;if(Tk(t,"BegLine")==0)return rI;if(Tk(t,"BegCol")==0)return $C;if(Tk(t,"EndLine")==0)return iI;if(Tk(t,"EndCol")==0)return eI;if(Tk(t,"TwipsX")==0)return cd;if(Tk(t,"TwipsY")==0)return sd;if(Tk(t,"LeftWidth")==0)return Eg;if(Tk(t,"RightWidth")==0)return Rg;if(Tk(t,"TopWidth")==0)return Lg;if(Tk(t,"BotWidth")==0)return Cg;if(Tk(t,"CellRow")==0)return fg;if(Tk(t,"PrevCell")==0)return lg;if(Tk(t,"NextCell")==0)return ag;if(Tk(t,"CellWidth")==0)return BF;if(Tk(t,"CellBorder")==0)return ng;if(Tk(t,"CellShading")==0)return cg;if(Tk(t,"RowSpan")==0)return sg;if(Tk(t,"ColSpan")==0)return _g;if(Tk(t,"CellFlags")==0)return og;if(Tk(t,"CellMargin")==0)return ug;if(Tk(t,"RowHeight")==0)return JF;if(Tk(t,"RowMinHeight")==0)return zF;if(Tk(t,"RowFixWidth")==0)return ZF;if(Tk(t,"RowPrevRow")==0)return QF;if(Tk(t,"RowNextRow")==0)return qF;if(Tk(t,"RowIndent")==0)return $F;if(Tk(t,"RowFlags")==0)return eg;if(Tk(t,"RowBorder")==0)return rg;if(Tk(t,"RowCurWidth")==0)return ig;if(Tk(t,"TableNo")==0)return xg;if(Tk(t,"RowNo")==0)return yg;if(Tk(t,"ColNo")==0)return Wg;if(Tk(t,"Align")==0)return Gd;if(Tk(t,"LineWidth")==0)return ad;if(Tk(t,"AuxInt")==0)return WC;if(Tk(t,"ListStart")==0)return sI;if(Tk(t,"ListLevel")==0)return oI;if(Tk(t,"ListSymbol")==0)return TI;if(Tk(t,"ListFlags")==0)return AI;if(Tk(t,"ListOrId")==0)return RI;if(Tk(t,"ListLevelCount")==0)return uI;if(Tk(t,"ListRtfId")==0)return LI;if(Tk(t,"ListTmplId")==0)return CI;if(Tk(t,"ListNumType")==0)return II;if(Tk(t,"ListFontId")==0)return FI;if(Tk(t,"ListCharAft")==0)return dI;if(Tk(t,"ListId")==0)return EI;if(Tk(t,"Type")==0)return kC;if(Tk(t,"MaxChars")==0)return lP;if(Tk(t,"TwipsSize")==0)return YC;if(Tk(t,"TotalPages")==0)return Id;if(Tk(t,"CurPage")==0)return dd;return 0};_i.TerGetOutIntArray=function(t){if(!lv||!QD())_i.TerCreateControl();if(Tk(t,"FontArray")==0)return Qg;return null};_i.TerGetOutBool=function(t){if(!lv||!QD())_i.TerCreateControl();if(Tk(t,"StartPage")==0)return Mg;if(Tk(t,"IsBullet")==0)return cP;if(Tk(t,"IsChecked")==0)return TF;if(Tk(t,"HasBorder")==0)return uF;return false};_i.TerGetOutColor=function(t){if(!lv||!QD())_i.TerCreateControl();if(Tk(t,"TextColor")==0)return xP;if(Tk(t,"TextBackColor")==0)return yP;if(Tk(t,"BkColor")==0)return WP;if(Tk(t,"Color")==0)return UP;if(Tk(t,"LeftColor")==0)return Hg;if(Tk(t,"RightColor")==0)return mg;if(Tk(t,"TopColor")==0)return wg;if(Tk(t,"BotColor")==0)return bg;if(Tk(t,"CellBackColor")==0)return Ag;if(Tk(t,"BackColor")==0)return CF;if(Tk(t,"LineColor")==0)return LF;return tc.Color.black};_i.TerGetOutMediaTray=function(t){if(!lv||!QD())_i.TerCreateControl();if(Tk(t,"FirstPageBin")==0)return Gg;if(Tk(t,"NextPageBin")==0)return Bg;return null};_i.TerGetOutObject=function(t){if(!lv||!QD())_i.TerCreateControl();if(Tk(t,"Object")==0)return bP;return null};_i.TerGetOutRect=function(t){if(!lv||!QD())_i.TerCreateControl();if(Tk(t,"Rectangle")==0)return RF;return null};_i.TerGetRefParam=function(t){if(!lv||!QD())_i.TerCreateControl();if(t<0||t>=tc.MAX_RETURN_PARAMS)return tc.LP_ERROR;return VO[t]};_i.TerGetRefParamStr=function(t){if(!lv||!QD())_i.TerCreateControl();if(t<0||t>=tc.MAX_STR_RETURN_PARAMS)return"";return jO[t]==null?"":jO[t]};_i.TerSetHtmlAutoSpacing=function(t){var e;if(!lv||!QD())_i.TerCreateControl();e=Di;Di=t;return e};function pk(t){var e=[2];var r=[2];if(t<256)return false;e[0]=t;e[1]=0;return Nj(r[0]&tc.C3_IDEOGRAPH)}function Nk(t,e,r){t=t<<31-e;t=t>>>32-r;return t}function Dk(t,e,r,i){i=i<<e+1-r;return t|i}_i.TerTab2Spaces=function(t,e){var r;var i,f,l,a,n;var c;var s;if(!lv||!QD())_i.TerCreateControl();if(t<0||t>=Ri)return 0;if(e<0||e>=ui[t].len)return 0;r=ui[t].txt;if(r[e]!=tc.TAB)return 0;s=nb(t);l=0;if(e>0&&b_==t&&x_==e-1&&r[e-1]==tc.TAB&&s[e-1]==s[e])l=y_;c=vq(t);f=c[e]+l;s=nb(t);n=s[e];sb(t);a=xs[n].CharWidth[tc.CHAR_SPACE];if(a==0)return 0;i=Mj(f,1,a);b_=t;x_=e;y_=f-i*a;return i};_i.TerLineInfoFlags=function(t,e){return GY(t,e)};function Mk(){if(IO==null){FO=10;dO=0;IO=[FO+1]}if(dO+1>=FO){FO=dO+10;IO=fV(IO,FO+1)}IO[dO]=new tc.ClsUserProp;dO++;return dO-1}function Gk(){if(IO==null)return true;IO=null;return true}_i.TerAddAutoCompWord=function(t,e){if(!lv||!QD())_i.TerCreateControl();if(Rl+1>Ll){Ll=Rl+50+Rl/5;Il=fV(Il,Ll);dl=fV(dl,Ll)}if(t==null)t="";if(e==null)e="";if(t.length==0)return false;Il[Rl]=t;dl[Rl]=e;Rl++;return true};_i.TerClearAutoCompList=function(){if(!lv||!QD())_i.TerCreateControl();Rl=0;return true};_i.TerGetRtfDocInfo=function(t){if(!lv||!QD())_i.TerCreateControl();if(t<0||t>=tc.INFO_MAX)return"";if(CO[t]==null)return"";return CO[t]};_i.TerSetRtfDocInfo=function(t,e){if(!lv||!QD())_i.TerCreateControl();if(t<0||t>=tc.INFO_MAX)return false;CO[t]=e;oi.modified++;return true};_i.TerSetWinBorder=function(t,e){return true};_i.TerGetVersion=function(){return tc.VERSION};_i.TerGetParam=function(t){var e=0,r=0;if(!lv||!QD())_i.TerCreateControl();if(t==tc.TP_TOTAL_LINES)return Ri;if(t==tc.TP_TOTAL_PFMTS)return Dc;if(t==tc.TP_TOTAL_FONTS)return Ys;if(t==tc.TP_TOTAL_STYLES)return X_;if(t==tc.TP_TOTAL_SECTS)return ro;if(t==tc.TP_TOTAL_PAGES)return To;if(t==tc.TP_TOTAL_PARA_FRAMES)return Kl;if(t==tc.TP_TOTAL_CHAR_TAGS)return Ac;if(t==tc.TP_TOTAL_BLTS)return yc;if(t==tc.TP_TOTAL_LISTS)return Vc;if(t==tc.TP_TOTAL_LIST_OR)return zc;if(t==tc.TP_TOTAL_TABS)return H_;if(t==tc.TP_TOTAL_TABLE_ROWS)return iR;if(t==tc.TP_TOTAL_CELLS)return fR;if(t==tc.TP_TOTAL_IMAGE_MAPS)return yL;if(t==tc.TP_CUR_LINE)return br;if(t==tc.TP_CUR_COL)return jt;if(t==tc.TP_CUR_SECT)return G5(br);if(t==tc.TP_SELECTION_TYPE)return uA;if(t==tc.TP_SELECTION_START_LINE)return sA;if(t==tc.TP_SELECTION_START_COL)return TA;if(t==tc.TP_SELECTION_END_LINE)return _A;if(t==tc.TP_SELECTION_END_COL)return AA;if(t==tc.TP_WATERMARK_WASH)return ea?1:0;if(t==tc.TP_TOTAL_REVIEWERS)return Al;if(t==tc.TP_MOUSE_ON_TEXT_LINE)return Xa?1:0;if(t==tc.TP_IS_ASIAN_SYS)return rh?1:0;if(t==tc.TP_WIN_ORG_Y)return Gt;if(t==tc.TP_INIT_LIST_INDENT)return Qc;if(t==tc.TP_FIXED_BULLET_SIZE)return qc;if(t==tc.TP_WATERMARK_PICT){if($l>0)return kl[$l].pict;else return-1}if(t>=tc.TP_MOUSE_FIRST&&t<=tc.TP_MOUSE_LAST){var i=false;var f,l,a=0,n=-99999,c,s,_=-1;if(t==tc.TP_MOUSE_X)return ba;if(t==tc.TP_MOUSE_Y)return xa;if(t==tc.TP_MOUSE_COMMENT_ID){var o=ba-rt.left+Ft;var u=xa-rt.top+Gt;var T;for(T=1;T<Vn;T++){if(!Yn[T].InUse&&Dj(Yn[T].flags&tc.FSTORY_DRAWN))continue;if(Yn[T].type!=tc.STORY_COMMENT)continue;if(o<Yn[T].x||o>Yn[T].x+Yn[T].width)continue;if(u<Yn[T].y||u>Yn[T].y+Yn[T].height)continue;break}if(T<1||T>=Vn)return-1;else return T}for(f=0;f<Dl;f++){if(pl[f].empty||pl[f].ParaFrameId==0)continue;s=pl[f].ParaFrameId;c=kl[s].pict;if(kl[s].ZOrder>n||kl[s].ZOrder==n&&_>=0&&pl[f].DispOrder>pl[_].DispOrder){var A=ba-rt.left+Ft;var E=xa-rt.top+Gt;var R=pl[f].width;var L=pl[f].height;if(Nj(kl[s].flags&tc.PARA_FRAME_LINE)){if(R==0)R=dV(kl[s].LineWdth);if(L==0)L=dV(kl[s].LineWdth)}if(A>=pl[f].x&&E>=pl[f].y&&A<pl[f].x+R&&E<pl[f].y+L){a=c;n=kl[s].ZOrder;_=f}}}if(t==tc.TP_MOUSE_FRAME_ID){if(_>=0)return pl[_].ParaFrameId;else return 0}if(a>0){e=0;r=0;if(_i.TerLocateFontId(a,e,r)){ma=PC;wa=SC}else a=0}if(a==0){i=ma<0||ma>=Ri||wa<0;if(!i&&wa>=ui[ma].len)i=true;if(i){e=0;r=0;_i.TerPixToTextPos(tc.REL_WINDOW,ba,xa,false);ma=PC;wa=SC}}if(t==tc.TP_MOUSE_LINE)return ma;if(t==tc.TP_MOUSE_COL)return wa;l=ib(ma,wa);if(t==tc.TP_MOUSE_FONT_ID)return l;if(t==tc.TP_MOUSE_FIELD_ID)return xs[l].FieldId;if(t==tc.TP_MOUSE_PICT_ID){if(Nj(xs[l].style&tc.PICT))return l;else return 0}}if(t==tc.TP_TOTAL_CHARS){var C,I=0;for(C=0;C<Ri;C++){I+=ui[C].len;if(Nj(ui[C].flags&(tc.LFLAG_PARA|tc.LFLAG_BREAK)))I--}return I}if(t==tc.TP_PREVIEW_ZOOM_PCT)return Hu;if(t==tc.TP_TABLE_COLS_SELECTED){if(uA==tc.HILIGHT_OFF)return 0;else return k8(sA,_A)?1:0}if(t==tc.TP_TABLE_ROWS_SELECTED){if(uA==tc.HILIGHT_OFF)return 0;else return X8()?1:0}if(t==tc.TP_HAS_TRACK_CHANGES){e=0;r=0;var d=_i.TerLocateChangedChar3(-1,-1,-1,-1,true,e,r,true);e=zC;r=ZC;if(d&&e==Ri-1&&r==ui[Ri-1].len)d=false;return d?1:0}if(t==tc.TP_CUR_REV_ID)return q_;if(t==tc.TP_DRAGGING_TEXT)return Xr?1:0;if(t==tc.TP_SHOW_HIDDEN_TEXT)return pE?1:0;if(t==tc.TP_JUST_LINE_BREAK_LINE)return $i?1:0;if(t==tc.TP_UNDO_REF)return uE;if(t==tc.TP_LINK_STYLE)return wh;if(t==tc.TP_LINK_COLOR)return bh;if(t==tc.TP_USE_W2016_FEATURES)return Bi?1:0;return-1};_i.TerGetParamColor=function(t){if(!lv||!QD())_i.TerCreateControl();if(t==tc.TP_PAGE_BK_COLOR)return $T;return Color.white};_i.TerSetParam=function(t,e){if(t==tc.TPS_INIT_LIST_INDENT)Qc=e;else if(t==tc.TPS_FIXED_BULLET_SIZE)qc=e;else if(t==tc.TPS_JUST_LINE_BREAK_LINE)$i=Nj(e);else if(t==tc.TPS_LINK_STYLE)wh=e;else if(t==tc.TPS_LINK_COLOR)bh=e;else if(t==tc.TPS_USE_W2016_FEATURES)Bi=Nj(e)};_i.TerSetParamStr=function(t,e){if(t==tc.TPS_PAGE_NUM_FORMAT)vo=e};_i.TerSetParamColor=function(t,e){if(typeof e=="string")e=yK(e);if(t==tc.TPS_TABLE_GRID_COLOR)rA=e};_i.TerGetLastCallResult=function(t){if(t==tc.CR_LINE)return PC;else if(t==tc.CR_COL)return SC;else if(t==tc.CR_ABS_POS)return MC;return tc.CR_ERROR};_i.TerGetLastMessageCode=function(){if(!lv||!QD())_i.TerCreateControl();return QO};_i.TerGetLastMessage=function(){if(!lv||!QD())_i.TerCreateControl();return tg.MsgString[QO]+","+qO};_i.TerResetLastMessage=function(){if(!lv||!QD())_i.TerCreateControl();QO=0;qO="";return true};_i.TerSetCustomMessage=function(t,e){if(t<0||t>=tc.MAX_MSGS)return false;tg.MsgString[t]=e;ZO[t]=true;return true};function Bk(t){return false}_i.TerEnableSpeedKey=function(t,e){var r=false;if(!lv||!QD())_i.TerCreateControl();if(t>=tc.ID_FIRST_COMMAND&&t<tc.ID_FIRST_COMMAND+tc.MAX_SPEED_KEYS){var i;for(i=0;i<hh;i++){if(Ph[i]==t){r=Ch[i];Ch[i]=e}}}return r};_i.TerAnd=function(t,e){return t&e};_i.TerOr=function(t,e){return t|e};_i.TerSetFocus=function(){ee.focus({preventScroll:true});_i.HasFocus=true;if(!zR&&sq())_q();if(zR&&!ZR&&_i.dialog==null)_i.caret.show();return true};function Hk(t){var e;if(t==tc.SID_NORMAL)e=0;else if(t==tc.SID_CUR)e=k_;else e=-t;if(e>=X_)e=-1;return e}function mk(){Z=0;J=0;z=0;H=null;p=null;return true}_i.TerSetDocTextFlow=function(t,i,f){if(!lv||!QD())_i.TerCreateControl();if(!oi.WordWrap)return false;if(!t)wk(i,f);var e=_i.DlgCompHeight;var r=_i.DlgFont;var l=new $t.DialogBox(te,"Document Text Flow",r,true,_,JV(2));var a=l.cvs;var n=new $t.RadioButton(a,0,0,JV(15),r,"Left-to-Right",mr==tc.FLOW_LTR,null,null);l.addComp(n,0,0,1,1,"left","middle",JV(15));var c=new $t.RadioButton(a,1,0,JV(15),r,"Right-to-Left",mr==tc.FLOW_RTL,n,null);l.addComp(c,1,0,1,1,"left","middle",JV(15));var s=new $t.RadioButton(a,2,0,JV(15),r,"Default",mr==tc.FLOW_DEF,c,null);l.addComp(s,2,0,1,1,"left","middle",JV(15));l.show();n.setFocus();function _(t,e,r){if(t=="Cancel"){l.hide();return}else if(t=="OK"){i=tc.FLOW_DEF;if(c.isSelected())i=tc.FLOW_RTL;else if(n.isSelected())i=tc.FLOW_LTR;l.hide();return wk(i,f)}else return}};function wk(t,e){if(t!=tc.FLOW_DEF&&t!=tc.FLOW_RTL&&t!=tc.FLOW_LTR)return true;if(mr!=t){var r,i;V8(0,0,Ri-1,0,"P".charCodeAt(0));for(r=0;r<=Ri-1;r++){i=Nc[ui[r].pfmt].flags;if(t==tc.FLOW_RTL&&(Nj(i&tc.LEFT)||Dj(i&(tc.CENTER|tc.RIGHT_JUSTIFY|tc.JUSTIFY)))){i=cj(i,tc.LEFT|tc.CENTER|tc.RIGHT_JUSTIFY|tc.JUSTIFY);i|=tc.RIGHT_JUSTIFY}if(t==tc.FLOW_LTR&&Nj(i&tc.RIGHT_JUSTIFY)){i=cj(i,tc.LEFT|tc.CENTER|tc.RIGHT_JUSTIFY|tc.JUSTIFY);i|=tc.LEFT}ui[r].pfmt=ZZ(ui[r].pfmt,Nc[ui[r].pfmt].LeftIndentTwips,Nc[ui[r].pfmt].RightIndentTwips,Nc[ui[r].pfmt].FirstIndentTwips,Nc[ui[r].pfmt].TabId,Nc[ui[r].pfmt].BltId,Nc[ui[r].pfmt].AuxId,Nc[ui[r].pfmt].Aux1Id,Nc[ui[r].pfmt].StyId,Nc[ui[r].pfmt].shading,Nc[ui[r].pfmt].pflags,Nc[ui[r].pfmt].SpaceBefore,Nc[ui[r].pfmt].SpaceAfter,Nc[ui[r].pfmt].SpaceBetween,Nc[ui[r].pfmt].LineSpacing,Nc[ui[r].pfmt].BkColor,Nc[ui[r].pfmt].BorderSpaceLeft,t,i)}}mr=t;if(e){_z(true);cG()}return true}function bk(){if(!FX(new terdlg_font_ex(_i)))return false;return true}function xk(t,e,r){e[t]=13;if(r!=null){if(t>0)r[t]=r[t-1];else r[t]=0;if(Nj(xs[r[t]].style&tc.PICT))r[t]=0}t++;e[t]=10;if(r!=null)r[t]=r[t-1];t++;return t}_i.GetTerFields=function(){return _i.GetTerFieldsAlt(-1)};_i.GetTerFieldsAlt=function(t){var e;var r;var i,f,l;fld=new TejTerField;if(!lv||!QD())_i.TerCreateControl();if(t<0)t=br;fld.hTerWnd=S;fld.TerGr=Ti;fld.TerRect=YY(K);fld.TerWinRect=YY(rt);fld.TotalLines=Ri;fld.TotalPfmts=Dc;fld.TotalFonts=Ys;fld.TotalStyles=X_;fld.WinWidth=tt;fld.WinHeight=Dt;fld.TerWinOrgX=Ft;fld.MouseCol=Ma;fld.MouseLine=Da;fld.MaxColBlock=RA;fld.modified=Nj(oi.modified);fld.WordWrap=oi.WordWrap;f=ui[t].pfmt;fld.e.ParaLeftIndent=Nc[f].LeftIndentTwips;fld.e.ParaRightIndent=Nc[f].RightIndentTwips;fld.ParaFirstIndent=Nc[f].FirstIndentTwips;fld.ParaFlags=Nc[f].flags;fld.pflags=Nc[f].pflags;fld.ParaTabId=Nc[f].TabId;fld.ParaCellId=ui[t].cid;fld.ParaFrameId=ui[t].fid;fld.ParaShading=Nc[f].shading;fld.ParaSpaceBefore=Nc[f].SpaceBefore;fld.ParaSpaceAfter=Nc[f].SpaceAfter;fld.ParaSpaceBetween=Nc[f].SpaceBetween;fld.ParaStyleId=Nc[f].StyId;fld.ParaAuxId=Nc[f].AuxId;fld.CurSect=l=G5(t);fld.LeftMargin=jV(to[l].LeftMargin);fld.RightMargin=jV(to[l].RightMargin);fld.TopMargin=jV(to[l].TopMargin);fld.BotMargin=jV(to[l].BotMargin);fld.columns=to[l].columns;fld.CurPage=Lo;fld.TotalPages=To;fld.MouseX=Ga;fld.MouseY=Ba;fld.PrintView=oi.PrintView;fld.PageMode=oi.PageMode;fld.FittedView=oi.FittedView;fld.ShowParaMark=dS;fld.ShowHiddenText=pE;fld.CurCtlId=Uh;fld.ParaFrameFlags=kl[fld.ParaFrameId].flags;if(false&&uA==tc.HILIGHT_OFF){sA=_A=0;TA=AA=0}if(false&&uA==tc.HILIGHT_LINE){TA=AA=0}fld.CurRow=we;fld.CurCol=jt;fld.CurLine=br;fld.BeginLine=fr;fld.PaintEnabled=si;fld.WrapFlag=yn;fld.ReclaimResources=Pr;if(!oi.WordWrap)fld.WrapFlag=tc.WRAP_OFF;fld.TextBkColor=jT;fld.StatusBkColor=zT;fld.StatusColor=ZT;fld.LinkColor=bh;fld.SnapToGrid=Gh;fld.HtmlMode=Li;fld.ShowTableGridLines=ER;fld.ModifyProtectColor=ph;fld.HilightType=uA;fld.HilightBegRow=sA;fld.HilightEndRow=_A;fld.HilightBegCol=TA;fld.HilightEndCol=AA;fld.StretchHilight=OA;fld.LinkStyle=wh;fld.LinkDblClick=Nh;fld.ShowProtectCaret=QR;fld.LineLen=ui[t].len;e=ui[t].txt;fld.text=[fld.LineLen];for(i=0;i<ui[t].len;i++)fld.text[i]=e[i];r=nb(t);fld.font=[fld.LineLen];for(i=0;i<ui[t].len;i++)fld.font[i]=r[i];sb(t);fld.pfmt=ui[t].pfmt;fld.TextApply=tc.APPLY_IGNORE;return fld};_i.SetTerFields=function(t){var e;var r;var i;var f;var l=false;if(!lv||!QD())_i.TerCreateControl();Br=tc.PAINT_LINE;we=t.CurRow;jt=t.CurCol;br=t.CurLine;fr=t.BeginLine;if(br>=Ri){br=Ri-1;Br=tc.PAINT_WIN}if(br<0){br=0;Br=tc.PAINT_WIN}if(br-fr>Dt){fr=br-Dt;Br=tc.PAINT_WIN}if(fr<0){fr=0;Br=tc.PAINT_WIN}if(we!=br-fr)Br=tc.PAINT_WIN;we=br-fr;if(jt<0){jt=0;Br=tc.PAINT_WIN}if(ZT!=t.StatusColor||jT!=t.TextBkColor||zT!=t.StatusBkColor)Br=tc.PAINT_WIN;if(ZT!=t.StatusColor||zT!=t.StatusBkColor){if(oi.ShowStatus)l=true;if(zT!=t.StatusBkColor){ai=true}}if(jT!=t.TextBkColor)_i.TerSetBkColor(t.TextBkColor);zT=t.StatusBkColor;ZT=t.StatusColor;if(l)tB();bh=t.LinkColor;Gh=t.SnapToGrid;Li=t.HtmlMode;if(ER!=t.ShowTableGridLines)Br=tc.PAINT_WIN;ER=t.ShowTableGridLines;ph=t.ModifyProtectColor;uA=t.HilightType;sA=t.HilightBegRow;_A=t.HilightEndRow;TA=t.HilightBegCol;AA=t.HilightEndCol;OA=t.StretchHilight;wh=t.LinkStyle;Nh=t.LinkDblClick;QR=t.ShowProtectCaret;f=-1;if(t.TextApply==tc.APPLY_MOD_CUR_LINE){f=br}else if(t.TextApply==tc.APPLY_BEF_CUR_LINE){iw(br,1,tc.CHAR_B);f=br}else if(t.TextApply==tc.APPLY_AFT_CUR_LINE){iw(br,1,tc.CHAR_A);f=br+1}if(f>=0){if(t.LineLen<0)t.LineLen=0;Tm(f,ui[f].len,t.LineLen);e=ui[f].txt;for(i=0;i<ui[f].len;i++)e[i]=t.text[i];r=nb(f);for(i=0;i<ui[f].len;i++){r[i]=tc.DEFAULT_CFMT;if(t.font[i]<=Ys&&xs[t.font[i]].InUse)r[i]=t.font[i]}sb(f);ui[f].pfmt=tc.DEFAULT_PFMT;if(t.pfmt>=0&&t.pfmt<=Dc)ui[f].pfmt=t.pfmt;oi.modified++;Br=tc.PAINT_WIN}yn=t.WrapFlag;Pr=t.ReclaimResources;if(!si&&t.PaintEnabled)Br=tc.PAINT_WIN;si=t.PaintEnabled;cG();return true};function yk(t,e){var r=t.length;var i,f;var l=[r+1];var a=Uk(t);for(i=f=0;i<r;i++){if(a[i]==e)continue;l[f]=a[i];f++}return Wk(l,0,f)}function Wk(t,e,r){var f="";if(typeof t=="number")return String.fromCharCode(t);if(t==undefined||t.length==0)return"";if(e==undefined)e=0;if(r==undefined)r=t.length-e;else if(e+r>t.length)r=t.length-e;for(i=e;i<e+r;i++)f+=String.fromCharCode(t[i]);return f}function Uk(t){var e=[];if(t==null)return e;var r=t.length,i;for(i=0;i<r;i++)e.push(t.charCodeAt(i));return e}function kk(t){return Uk(t)}function Xk(t){return Kk(t,true)}function Kk(t,e){var r=t.length,i=0;var f,l;var a=false;var n=[r+1];var c;var s=kk(t);for(f=l=0;f<r;f++){if(s[f]==tc.BACK_SLASH){i++;if(i%2!=1)continue}else i=0;if(s[f]==gk('"')&&e){if(a)break;a=true;continue}n[l]=s[f];l++}c=Wk(n,0,l);return c}function Yk(t,e,r){var i,f,l;i=Vk(t.getRed(),e.getRed(),r);f=Vk(t.getGreen(),e.getGreen(),r);l=Vk(t.getBlue(),e.getBlue(),r);return new tc.Color(i,f,l)}function Vk(t,e,r){var i;var f;if(t==e)return t;f=e-t;i=e-Mj(f,r,100);return i}function jk(t,e){var r=[1];r[0]=e;return t+Wk(r,0,1)}function Jk(t){var e;if((e=t.indexOf(tc.QUOTE))<0)return t;t=t.substring(e+1);if((e=t.indexOf(tc.QUOTE))>=0)t=cV(t,0,e);return t}function zk(t){var e=[1];e[0]=tc.QUOTE;var r=Wk(e,0,1);return r+t+r}function Zk(t,e){var r=t.length;var i,f;if(r==0)return t;var l=[];var a=kk(t);for(i=0;i<r;i++){l.push(a[i]);if(a[i]==tc.BACK_SLASH){for(f=0;f<e-1;f++){l.push(a[i])}}}return Wk(l)}function Qk(){var t;var e;var r;if(br>0&&ui[br].len>0&&ui[br-1].len>0){var i=ib(br,0);var f=ib(br-1,ui[br-1].len-1);if(Nj(xs[i].style&tc.PROTECT)&&Nj(xs[f].style&tc.PROTECT)){oV();return false}}if(jt>0&&_m(br,jt,0)){br++;jt=0}if(br>0&&(t=ui[br-1].len)>0&&Dj(ui[br-1].flags&tc.LFLAG_HDRS_FTRS)){e=ui[br-1].txt;if(e[t-1]!=Bn&&e[t-1]!=TR&&e[t-1]!=tc.ROW_CHAR&&e[t-1]!=tc.SECT_CHAR&&e[t-1]!=tc.COL_CHAR&&e[t-1]!=tc.PAGE_CHAR){Tm(br-1,t,t+1);e=ui[br-1].txt;r=nb(br-1);e[t]=Bn;r[t]=r[t-1];if(Nj(xs[r[t]].style&tc.PICT))r[t]=0;if(Z_){if(Nj(xs[r[t]].DelRev))r[t]=V4(r[t],tc.TRACK_NONE);r[t]=V4(r[t],tc.TRACK_INS)}else if(Nj(xs[r[t]].InsRev)||Nj(xs[r[t]].DelRev))r[t]=V4(r[t],tc.TRACK_NONE);V8(br-1,t,br-1,t,"O".charCodeAt(0))}}return true}function qk(t,e,r){if(r==undefined)r=tc.MSGTYPE_ALERT;var i=t;if(e!=null&&e.length>0)i+="\n"+e;if(r==tc.MSGTYPE_ALERT){alert(i);return tc.MSGRESULT_NONE}else if(r==tc.MSGTYPE_OK_CANCEL){if(confirm(i))return tc.MSGRESULT_OK;else return tc.MSGRESULT_CANCEL}return tc.MSGRESULT_NONE}function $k(){if(ES)ES=false;else ES=true;if(Z_)ES=true;tB();return true}function tX(){oi.ShowStatus=!oi.ShowStatus;_i.TerRepaint(true);return true}function eX(){oi.ruler=!oi.ruler;if(oi.open){Ti.save();Ti.setTransform(1,0,0,1,0,0);var t=Ti.fillStyle;var e=xO+wA;var r=Mt+rt.top-e;Ti.fillStyle=jT.toString();Ti.fillRect(0,e,_i.cvs.width,r);Ti.fillStyle=t;Ti.restore()}_i.TerRepaint(true);op(true);fB(Ti);return true}function rX(){$A=!$A;_i.TerRepaint(true);return true}function iX(){var t,e;var r=false;dS=!dS;if(vi)Ex(Ti);for(t=0;t<Ys;t++){if(Dj(xs[t].InUse)||Dj(xs[t].style&tc.PICT)||xs[t].FrameType==tc.PFRAME_NONE)continue;e=xs[t].ParaFID;if(Nj(kl[e].flags2&tc.PF2_INLINE))continue;if(e!=$l)HN(t,0,0,true);r=true}bG(true);if(r&&oi.PageMode)_i.TerRepaginate(true);cG();return true}_i.TerQueryExit=function(){var t;if(!lv||!QD())_i.TerCreateControl();if(Mh)return false;if(Nj(oi.modified)&&(!oi.ReadOnly||mh)){if(qk(tg.MsgString[tc.MSG_SAVE_MODS],"",tc.MSGTYPE_OK_CANCEL)==tc.MSGRESULT_OK){if(ih.length>0)return BU(ih,true);else return MU(ih)}else{if(qk(tg.MsgString[tc.MSG_EXIT_WITHOUT_SAVING],"",tc.MSGTYPE_OK_CANCEL)==tc.MSGRESULT_CANCEL)return false}}return true};_i.TerSetZoom=function(i){var t,e;var r,f,l,a;if(!lv||!QD())_i.TerCreateControl();if(i==-2)return nh;if(i>=0)return fX(i);var n=_i.DlgCompHeight;var c=_i.DlgFont;var s=new $t.DialogBox(te,"Zoom Parameters",c,true,A,2);var _=s.cvs;var o=new $t.Label(_,0,0,c,"Zoom Percent (10 to 500)     ");s.addComp(o,0,0,1,1,"Left","middle");var u=new $t.TextBox(_,0,0,JV(60),n,nh.toString(),c,_i.caret,false,true,null);s.addComp(u,0,1,1,1,"left","middle");var T=new $t.Label(_,0,0,c,"%");s.addComp(T,0,2,1,1,"Left","middle");s.show();u.setFocus();function A(t,e,r){if(t=="Cancel"){s.hide();return}else if(t=="OK"){i=LX(u);if(i<10||i>500){Percent.setFocus();return}s.hide();return fX(i)}else return}};function fX(t){var e,r;var i,f,l,a;i=Lo;l=Gt;f=nh;r=nh;if(nh==t)return nh;if(t<10)t=10;if(t>1e3)t=1e3;lX(t);Ex(Ti);for(e=0;e<Ys;e++){if(Xw(e)){var n=xs[e].CharWidth[tc.PICT_CHAR];var c=xs[e].height;xs[e].ctl.setSize(n,c)}}if(oi.PageMode)_i.TerRepaginate(true);_i.TerRepaint(true);if(Dj(iO&tc.TFLAG9_SAME_CURSOR_POS_AFTER_ZOOM)){if(f<=0)f=0;a=Mj(l,nh,f);_i.TerSetPagePos(i,a)}return r}function lX(t){var e;Nt=Mj(yt,t,100);wt=Mj(Wt,t,100);for(e=0;e<Dc;e++){Nc[e].LeftIndent=dV(Nc[e].LeftIndentTwips);Nc[e].RightIndent=dV(Nc[e].RightIndentTwips);Nc[e].FirstIndent=dV(Nc[e].FirstIndentTwips)}nh=t;return true}function aX(t,e,r,i,f){var l=[4,6,7,8,9,10,11,12,14,16,18,20,24,30,36,72];var a;var n,c=0;var s=[];s=Cy(t,e,r,i,f);if(s.length>0)return s;c=l.length;for(n=0;n<c;n++){point=l[n];if(point*20<Qs)continue;if(qs>0&&point*20>qs)continue;a=XX(point.toString()," ",2);s.push(a)}if(t)r.setItems(s,null,-1,false);else{e.setItems(s,null,-1,false);e.setMaximumRowCount(s.length>10?10:s.length)}return s}function nX(t,e,r){var i;if(TO!=null&&TO.length>0)return vb(t,e,r);if(t)r.setItems(ys,null,0,true);else{e.setItems(ys,null,0,false);if(ys.length<10)e.setMaximumRowCount(ys.length)}return ys}function cX(t){return new tc.Point(rt.left+(t.x-Ft),rt.top+(t.y-Gt))}function sX(t,e){var r=false;var i="";var f=function(){if(r===true)e(i);else setTimeout(f,1e3)};f();var l=new FileReader;l.onloadend=function(t){i=t.target.result;r=true};l.readAsBinaryString(t);return true}function _X(t,e,r){PY("Use GetUserColor function instead");return e}function oX(t,e,r){var i;if(Dj(rO&tc.TFLAG8_NO_TWIPS))return true;i=e;if(r)i+=" (points)";else if(Nj(zh&tc.TFLAG_METRIC))i+=" (cm)";else i+=" (inches)";t.setText(i);return true}function uX(t,e,r,i,f){var l;var a=0;var n;t:{n=0;if(Dj(rO&tc.TFLAG8_NO_TWIPS)){a=LX(e.getText());if(!aP)break t}else{l=CX(e.getText());if(!aP)break t;if(r)a=l*20;else if(Nj(zh&tc.TFLAG_METRIC))a=jV(l/2.54);else a=jV(l)}n=a;if(i!=0&&f!=0&&f>=i){if(a<i||a>f)break t}aP=true;return n}qk(tg.MsgString[tc.MSG_INVALID_NUMBER],tg.MsgString[tc.MSG_OUT_OF_RANGE],tc.MSGTYPE_ALERT);aP=false;return n}function TX(t,e,r){var f;var l,a;if(Nj(rO&tc.TFLAG8_NO_TWIPS)){if(r){l=e/20;f=AX(l,1);if(f==".0")f="0";else if(Ck(f,".0")){a=f.length;if(a>2)f=f.substring(0,a-2)}}else{if(Nj(zh&tc.TFLAG_METRIC))l=e*2.54/1440;else l=e/1440;f=AX(l,2)}}else f=AX(l,0);if(Nj(zh&tc.TFLAG_SWAP_DECIMAL)&&f.length>0){a=f.length;var n=Uk(f);for(i=0;i<a;i++){if(n[i]==gk(","))n[i]=".".charCodeAt(0);else if(n[i]==".".charCodeAt(0))n[i]=gk(",")}f=Wk(n)}t.setText(f);return true}function AX(t,e){var r;var i;var f=1,l;for(l=0;l<e;l++)f=f*10;t=Math.round((t+1e-8)*f)/f;r=t.toString();if(Nj(zh&tc.TFLAG_SWAP_DECIMAL)&&r.length>0){var a=r.length;var n=Uk(r);for(l=0;l<a;l++){if(n[l]==gk(","))n[l]=".".charCodeAt(0);else if(n[l]==".".charCodeAt(0))n[l]=gk(",")}r=Wk(n)}return r}function EX(t,e,r,i,f){var l;var a=false;t:{if(e==tc.CHAR_I)l=LX(r.getText());else l=CX(r.getText());if(l<i||l>f)break t;return true}qk(tg.MsgString[tc.MSG_INVALID_NUMBER],tg.MsgString[tc.MSG_OUT_OF_RANGE],tc.MSGTYPE_ALERT);return false}function RX(t){return t!=undefined&&typeof t=="number"&&t%1==0}function LX(t,e){if(arguments.length>2||arguments.length==0){PY("invalid number of parameter, expected 1 or 2 parameters");console.trace();return 0}if(typeof t=="boolean")return r?1:0;if(typeof t=="string")return parseInt(t);if(typeof t!="object"||t.ObjType!="TextBox"){PY("TextBox expected");console.trace()}var r=parseInt(t.getText());if(arguments.length>1){if(typeof e=="number"){if(e==1)Ls=r;else if(e==2)Cs=r;else if(e==3)Is=r;else if(e==4)ds=r;else if(e==5)Fs=r;else if(e==6)gs=r;else return false}else return false}else return r}function CX(t,e){var r,i;if(e==undefined)e=false;aP=true;if(typeof t=="string")r=t;else if(typeof t=="object"&&t.ObjType=="TextBox")r=t.getText();else{aP=false;return 0}r=IX(r);i=parseFloat(r);if(isNaN(i)){aP=false;i=0}if(aP&&e)i=fj(i);return i}function IX(t){var e;if(Nj(zh&tc.TFLAG_SWAP_DECIMAL)&&t.length>0){var r=t.length;var i=Uk(t);for(e=0;e<r;e++){if(i[e]==",")i[e]=".";else if(i[e]==".")i[e]=","}t=Wk(i)}return t}function dX(){pE=!pE;if(!pE&&Nj(qh&tc.TFLAG4_HIDE_HIDDEN_PARA_MARK))$0();Ex(Ti);Ro=-1;Fo=0;cG();return true}function FX(t){PY("Dialog box not used");console.trace();return false}function gX(){return null}function PX(t){return true}function SX(){console.trace()}_i.PrintStr=function(t){PY(t);return true};_i.TerSetDefTabType=function(t){if(t!=tc.TAB_LEFT&&t!=tc.TAB_RIGHT&&t!=tc.TAB_DECIMAL&&t!=tc.TAB_CENTER)return false;w_=t;return true};function hX(t,e,r){var i,f,l,a,n,c,s,_,o;var u=new tc.Point;if(!oi.WordWrap)return true;if(k_>=0&&!Y_){oV();return true}f=HJ(e);l=mJ(e);u.x=f-rt.left+Ft;u.y=l-rt.top+Gt;iq(u);_=GC;o=BC;if(_>=0&&XE[_].type==tc.DRAG_TYPE_TAB_TYPE){if(w_==tc.TAB_LEFT)w_=tc.TAB_CENTER;else if(w_==tc.TAB_CENTER)w_=tc.TAB_RIGHT;else if(w_==tc.TAB_RIGHT)w_=tc.TAB_DECIMAL;else if(w_==tc.TAB_DECIMAL)w_=tc.TAB_LEFT;lB(false);return true}if(!VR)_i.TerEngageCaret(false);f=HJ(e);a=f-rt.left+Ft;s=iW(br);if(Nj(ui[br].flags2&tc.LFLAG2_RTL))a=E$(a,0,Nl,new tc.ClsLineSeg);else a-=pl[s].x+pl[s].SpaceLeft;if(a<0)a=0;a=gV(a);if(Gh){if(Nj(zh&tc.TFLAG_METRIC))a=HY(a,tc.SNAP_DIST_METRIC);else a=HY(a,tc.SNAP_DIST)}if(r.shiftKey){if(Nj(t==tc.BUTTON_LEFT))n=tc.TAB_CENTER;else n=tc.TAB_DECIMAL}else{if(Nj(t==tc.BUTTON_LEFT))n=w_;else n=tc.TAB_RIGHT}c=Nc[ui[br].pfmt].TabId;for(i=0;i<B_[c].count;i++){if(Math.abs(B_[c].pos[i]-a)<tc.SNAP_DIST/2)break}if(i<B_[c].count||a<=0)_i.ClearTab(B_[c].pos[i],true);else _i.SetTab(n,a,true);return true}function OX(t){if(t>=tc.IDP_FIRST_SPELL&&t<=tc.IDP_LAST_SPELL)return L4(t);return true}function vX(t,e,r){if(!oi.open)return true;if(Ru||!si)return true;if(Ri==0)return true;if(Ri==1&&ui[0].len==0)return true;if(!FR&&!Li&&oi.modified>IR&&br>=0&&br<Ri&&ui[br].cid>0){var i=ui[br].cid;if(Nj(eR[i].flags&tc.CFLAG_AUTO_WIDTH))FR=true;var f=eR[i].row;if(Nj($E[f].flags&tc.ROWFLAG_AUTO_FIT))FR=true}if(Nj(qh&tc.TFLAG4_UNDO_WINDOW_OVERFLOW)&&(Qt==tc.WM_COMMAND||Qt==tc.WM_CHAR))kN();if(_i.UseVirtKeyboard&&nL!=Lq(br,jt))qD();rJ();if(t!=tc.WM_COMMAND||HJ(e)!=tc.ID_UP&&HJ(e)!=tc.ID_DOWN&&HJ(e)!=tc.ID_PGUP&&HJ(e)!=tc.ID_PGDN)Vt=-1;if(!qR)uq();pX();if(UR)U5(true);if(Gc!=ui[br].pfmt||Pt!=G5(br))fB(true);var l=false;if(t==tc.WM_CHAR&&!Sh[tc.ID_UNDO-tc.ID_FIRST_COMMAND])l=true;else if(t!=tc.WM_CHAR&&(!sK()||Zt!=0))l=true;if(l)FN(false);if(oi.PrintView&&(Fo<Ri||Ro!=oi.modified)&&Dj(Zh&tc.TFLAG2_NO_AUTO_REPAGE)){var a=false;if(Oo){yJ(true,false,0,true);a=true}else if(Ri>=tc.SMALL_FILE&&!PS&&Dj(Zh&tc.TFLAG2_IGNORE_TIMER)){tl=window.setInterval(bp,1e3);PS=true}if(Ri<tc.SMALL_FILE||!PS){if(!a&&Dl<20&&yJ(true,false,0,true)){repaginate=true;return true}}if(!a&&!PS){tl=window.setInterval(bp,1e3);PS=true}}if(lo&&!cK()&&B5()){cG();vX(t,e,r);return true}return true}function pX(){if(Dj(oi.modified))lr=0;if(Nj(oi.modified)&&(!oi.ReadOnly||mh)){var t=Dj(lr);if(!t&&Nj(eO&tc.TFLAG7_ALWAYS_FIRE_MODIFY)&&lr!=oi.modified)t=true;lr=oi.modified;if(t)UD(tc.TER_MODIFIED,S,0,false)}return true}function NX(t,e,r){if(xi)return false;if(Mr){if(t==tc.WM_COMMAND)UD(tc.TER_ACTION,tc.ACTION_COMMAND,HJ(e),false);else if(t==tc.WM_VSCROLL)UD(tc.TER_ACTION,tc.ACTION_VSCROLL,HJ(e),false);else if(t==tc.WM_HSCROLL)UD(tc.TER_ACTION,tc.ACTION_HSCROLL,HJ(e),false);else if(t==tc.WM_CHAR)UD(tc.TER_ACTION,tc.ACTION_CHAR,e,false);else if(t==tc.WM_KEYDOWN)UD(tc.TER_ACTION,tc.ACTION_KEYDOWN,e,false);else if(t==tc.WM_KEYUP)UD(tc.TER_ACTION,tc.ACTION_KEYUP,e,false);else if(t==tc.WM_LBUTTONDOWN)UD(tc.TER_ACTION,tc.ACTION_LBUTTONDOWN,r,false);else if(t==tc.WM_RBUTTONDOWN)UD(tc.TER_ACTION,tc.ACTION_RBUTTONDOWN,r,false);else if(t==tc.WM_LBUTTONUP)UD(tc.TER_ACTION,tc.ACTION_LBUTTONUP,r,false);else if(t==tc.WM_RBUTTONUP)UD(tc.TER_ACTION,tc.ACTION_RBUTTONUP,r,false);else if(t==tc.WM_LBUTTONDBLCLK)UD(tc.TER_ACTION,tc.ACTION_LBUTTONDBLCLK,r,false);else if(t==tc.WM_RBUTTONDBLCLK)UD(tc.TER_ACTION,tc.ACTION_RBUTTONDBLCLK,r,false);else if(t==tc.WM_SIZE)UD(tc.TER_ACTION,tc.ACTION_SIZE,r,false);else if(t==tc.WM_SETFOCUS)UD(tc.TER_ACTION,tc.ACTION_SETFOCUS,e,false);else if(t==tc.WM_KILLFOCUS)UD(tc.TER_ACTION,tc.ACTION_KILLFOCUS,e,false);else if(t==tc.WM_MOUSEMOVE)UD(tc.TER_ACTION,tc.ACTION_MOUSEMOVE,r,false);else if(t==-tc.ACTION_STYLE)UD(tc.TER_PREPROCESS,tc.ACTION_STYLE,e,false);else if(t==-tc.ACTION_LONG_PRESS)UD(tc.TER_PREPROCESS,tc.ACTION_LONG_PRESS,e,false);else if(t==-tc.ACTION_TOUCH_MOVE)UD(tc.TER_PREPROCESS,tc.ACTION_TOUCH_MOVE,e,false)}Mr=true;return true}function DX(t,e,r){if(zr)return false;if(xi)return false;zr=true;Jr=false;if(t>=tc.WM_MOUSEFIRST&&t<=tc.WM_MOUSELAST){ba=HJ(r);xa=mJ(r);ma=-1}if(t==tc.WM_COMMAND)UD(tc.TER_PREPROCESS,tc.ACTION_COMMAND,HJ(e),false);else if(t==tc.WM_VSCROLL)UD(tc.TER_PREPROCESS,tc.ACTION_VSCROLL,HJ(e),false);else if(t==tc.WM_HSCROLL)UD(tc.TER_PREPROCESS,tc.ACTION_HSCROLL,HJ(e),false);else if(t==tc.WM_CHAR)UD(tc.TER_PREPROCESS,tc.ACTION_CHAR,e,false);else if(t==tc.WM_KEYDOWN)UD(tc.TER_PREPROCESS,tc.ACTION_KEYDOWN,e,false);else if(t==tc.WM_KEYUP)UD(tc.TER_PREPROCESS,tc.ACTION_KEYUP,e,false);else if(t==tc.WM_LBUTTONDOWN)UD(tc.TER_PREPROCESS,tc.ACTION_LBUTTONDOWN,r,false);else if(t==tc.WM_RBUTTONDOWN)UD(tc.TER_PREPROCESS,tc.ACTION_RBUTTONDOWN,r,false);else if(t==tc.WM_LBUTTONUP)UD(tc.TER_PREPROCESS,tc.ACTION_LBUTTONUP,r,false);else if(t==tc.WM_RBUTTONUP)UD(tc.TER_PREPROCESS,tc.ACTION_RBUTTONUP,r,false);else if(t==tc.WM_LBUTTONDBLCLK)UD(tc.TER_PREPROCESS,tc.ACTION_LBUTTONDBLCLK,r,false);else if(t==tc.WM_RBUTTONDBLCLK)UD(tc.TER_PREPROCESS,tc.ACTION_RBUTTONDBLCLK,r,false);else if(t==tc.WM_SIZE)UD(tc.TER_PREPROCESS,tc.ACTION_SIZE,r,false);else if(t==tc.WM_SETFOCUS)UD(tc.TER_PREPROCESS,tc.ACTION_SETFOCUS,e,false);else if(t==tc.WM_KILLFOCUS)UD(tc.TER_PREPROCESS,tc.ACTION_KILLFOCUS,e,false);else if(t==tc.WM_MOUSEMOVE)UD(tc.TER_PREPROCESS,tc.ACTION_MOUSEMOVE,r,false);else if(t==-tc.ACTION_STYLE)UD(tc.TER_PREPROCESS,tc.ACTION_STYLE,e,false);else if(t==-tc.ACTION_LONG_PRESS)UD(tc.TER_PREPROCESS,tc.ACTION_LONG_PRESS,e,false);else if(t==-tc.ACTION_TOUCH_MOVE)UD(tc.TER_PREPROCESS,tc.ACTION_TOUCH_MOVE,e,false);zr=false;return Jr}function MX(t){var e=rW(br);var r=t;if(Nj(ui[br].flags2&tc.LFLAG2_RTL)){if(Nj(ui[br].flags2&tc.LFLAG2_PARA_RTL)){if(t==tc.ID_LEFT)r=tc.ID_RIGHT;if(t==tc.ID_RIGHT)r=tc.ID_LEFT;if(t==tc.ID_LEFT_INDENT)r=tc.ID_RIGHT_INDENT;if(t==tc.ID_RIGHT_INDENT)r=tc.ID_LEFT_INDENT;if(t==tc.ID_PREV_WORD)r=tc.ID_NEXT_WORD;if(t==tc.ID_NEXT_WORD)r=tc.ID_PREV_WORD}}t=r;if(e==0)return t;if(t==tc.ID_UP)r=e==90?tc.ID_RIGHT:tc.ID_LEFT;if(t==tc.ID_DOWN){if(e==90){if(jt==0)return tc.ID_DOWN;else return tc.ID_LEFT}else r=tc.ID_RIGHT}if(t==tc.ID_LEFT)r=e==90?tc.ID_UP:tc.ID_DOWN;if(t==tc.ID_RIGHT)r=e==90?tc.ID_DOWN:tc.ID_UP;return r}function GX(t,e,r){return BX(t,e,r,null)}function BX(t,e,r,i){var f,l,a,n=0;var c="";if(e==null)e="";var s=kk(e);l=e.length;for(f=0;f<l;f++)if(s[f]==gk('"'))break;if(f<l){a=f+1;for(f=a;f<l;f++)if(s[f]==gk('"'))break;c=cV(e,a,f-a);c=c.replace('"'," ").trim()}else{var _="\\* MERGEFORMAT";e=e.trim();if(e.length>=_.length&&e.indexOf(_)>=0){e=e.replace(_,"")}c=e}var o=i==null?new Date:i;if(c==XS)t=o.toLocaleDateString();else{var u,T;var A=o.getDate();var E=o.getDay();var R=o.getFullYear().toString();var L=o.getMonth();var C=o.getHours();var I=o.getMinutes();var d=o.getSeconds();if(c==null||c==""){if(Tk(t,"TIME")==0)c="hh:mm";else c="MM/dd/yyyy"}t=c;if(t.indexOf("yyyy")>=0)t=t.replace("yyyy",R);if(t.indexOf("yy")>=0)t=t.replace("yy",R.substring(2));if(t.indexOf("M")>=0){u=tg.MonthNames[L];t=t.replace("MMMM",u);t=t.replace("MMM",u.substr(0,3));u=T=(L+1).toString();if(L<9)T="0"+u;t=t.replace("MM",T);t=t.replace("M",u)}if(t.indexOf("d")>=0){u=T=A.toString();if(A<10)T="0"+u;t=t.replace("dd",T);t=t.replace("d",u)}if(t.indexOf("H")>=0){u=T=C.toString();if(L<10)T="0"+u;t=t.replace("HH",T);t=t.replace("H",u)}if(t.indexOf("h")>=0){var F=C;if(F==0)F=12;else if(F>13)F=F-12;u=T=F.toString();if(F<10)T="0"+u;t=t.replace("hh",T);t=t.replace("h",u)}if(t.indexOf("am/pm")>=0){u="am";if(C>12)u="pm";t=t.replace("am/pm",u)}if(t.indexOf("AM/PM")>=0){u="AM";if(C>12)u="PM";t=t.replace("AM/PM",u)}if(t.indexOf("m")>=0){u=T=I.toString();if(I<10)T="0"+u;t=t.replace("mm",T)}if(t.indexOf("s")>=0){u=T=d.toString();if(d<10)T="0"+u;t=t.replace("ss",T);t=t.replace("s",u)}if(t.indexOf("w")>=0){u=tg.WeekDays[E];t=t.replace("wwww",u);t=t.replace("www",u.substr(0,3))}}if(e.indexOf("\\* FirstCap")>=0){var g=kk(t);var P=g[0];if(sk(P)){t=Wk(ChartoUpperCase(P))+t.substring(1)}}return t}function HX(){var t;for(t=0;t<Ys;t++){if(xs[t].InUse&&Dj(xs[t].style&tc.PICT)){if(xs[t].lang==MO)return xs[t].rtl;if(xs[t].lang==0&&xs[t].rtl)return true}}return false}function mX(t,e){return gJ(t,t.font,e)}function wX(t){var e=la,r;la+=50;if(la<=t)la=t+50;fa=fV(fa,la);ra=fV(ra,la);ia=fV(ia,la);for(r=e;r<la;r++)fa[r]=ra[r]=ia[r]=0;return true}_i.TerSetPictPctSize=function(t,e,r,i,f){var l;if(!lv||!QD())_i.TerCreateControl();if(t<0||t>Ys||Dj(xs[t].InUse))return true;if(e>0||r>0){if(e>100)e=100;if(r>100)r=100;xs[t].PctWidth=e;xs[t].PctHeight=r;if(!i&&!f&&e>0){var a=xs[t].PictWidth;if(oi.FittedView||!oi.PageMode){l=Mj(je,e,100);xs[t].PictWidth=gV(l)}else{var n=(eo[0].PgWidth-to[0].LeftMargin-to[0].RightMargin)*1440;xs[t].PictWidth=Mj(n,e,100);l=dV(xs[t].PictWidth)}if(a!=xs[t].PictWidth){xs[t].PictHeight=Mj(xs[t].PictHeight,xs[t].PictWidth,a);xs[t].height=hV(xs[t].PictHeight)}HN(t,xs[t].height,l,true);mN(t)}}mN(t);return true};function bX(t){var e;if(Dj(ui[t].tabw)&&!xX(t))return false;ui[t].tabw.CharFlags=[ui[t].len];ui[t].tabw.CharFlagsLen=ui[t].len;for(e=0;e<ui[t].len;e++)ui[t].tabw.CharFlags[e]=0;return true}function xX(t){ui[t].tabw=new tc.TejTabw;return true}function yX(t){if(Nj(ui[t].tabw)){WX(t);ui[t].tabw=null}return true}function WX(t){if(Nj(ui[t].tabw)){ui[t].tabw.CharFlags=null;ui[t].tabw.ListText=null;ui[t].tabw.pListnum=null}return true}function UX(t,e){if(Nj(ui[e].tabw))WX(e);else xX(e);ui[e].tabw=ui[t].tabw.copy();return true}function kX(t,e){var r=[tc.MAX_WIDTH];JY(r,e);zY(r,t);JY(t,r)}function XX(t,e,r){var i,f=t.length;var l="";for(i=0;i<r-f;i++)l+=e.charAt(0);l+=t;return l}function KX(t,e){var r=Math.floor((t-1)/26),i;var f=(e?tc.CHAR_A:tc.CHAR_a)+(t-1)%26;var l=[tc.MAX_WIDTH];for(i=0;i<r+1;i++)l[i]=f;l[i]=0;return Wk(l,0,i)}function YX(t,e){var r="";var i=1;while(t>0){var f=Math.floor(t/10);var l=t-10*f;t=f;if(i==1){switch(l){case 1:r="I";break;case 2:r="II";break;case 3:r="III";break;case 4:r="IV";break;case 5:r="V";break;case 6:r="VI";break;case 7:r="VII";break;case 8:r="VIII";break;case 9:r="IX";break;default:break}}else if(i==2){switch(l){case 1:r="X"+r;break;case 2:r="XX"+r;break;case 3:r="XXX"+r;break;case 4:r="XL"+r;break;case 5:r="L"+r;break;case 6:r="LX"+r;break;case 7:r="LXX"+r;break;case 8:r="LXXX"+r;break;case 9:r="XC"+r;break;default:break}}else if(i==3){switch(l){case 1:r="C"+r;break;case 2:r="CC"+r;break;case 3:r="CCC"+r;break;case 4:r="CD"+r;break;case 5:r="D"+r;break;case 6:r="DC"+r;break;case 7:r="DCC"+r;break;case 8:r="DCCC"+r;break;case 9:r="CM"+r;break;default:break}}else if(i==4){while(l-- >0)r="M"+r}else r="!"+r;i++}if(!e)r=r.toLowerCase();return r}function VX(t,e){var r=21313;var i,f,l,a;var n=[50];var c="";if(t<0)t=-t;n[0]=0;if(t<10){n[0]=jX(t);n[1]=0}else if(t==10){n[0]=r;n[1]=0}else if(t<20){n[0]=r;n[1]=jX(t-10);n[2]=0}else if(t<100){n[0]=jX(Math.floor(t/10));n[1]=r;if(t%10>0){n[2]=jX(t%10);n[3]=0}else n[2]=0}else if(t<1e4){i=0;if(t>=1e3){f=Math.floor(t/1e3);n[i]=jX(f);i++;t-=f*1e3}l=Math.floor(t/100);n[i]=jX(l);i++;t-=l*100;a=t/10;n[i]=jX(a);i++;t-=a*10;n[i]=jX(t);i++;n[i]=0}else c=Integer.toString(t);if(c.length==0){for(i=0;i<50;i++)if(n[i]==0)break;c=Wk(n,0,i)}return c}function jX(t){if(t==0)return 9675;else if(t==1)return 19968;else if(t==2)return 20108;else if(t==3)return 19977;else if(t==4)return 22235;else if(t==5)return 20116;else if(t==6)return 20845;else if(t==7)return 19971;else if(t==8)return 20843;else if(t==9)return 20061;else return tc.CHAR_E}function JX(t,e){var r=25342;var i=30334;var f,l,a;var n=[50];var c="";if(t<0)t=-t;n[0]=0;if(t<10){n[0]=zX(t);n[1]=0}else if(t<100){a=t/10;n[0]=zX(a);n[1]=r;if(t%10>0){n[2]=zX(t%10);n[3]=0}else n[2]=0}else if(t<1e3){f=0;l=t/100;n[f]=zX(l);f++;n[f]=i;f++;t-=l*100;a=t/10;if(a>0){if(a>1){n[f]=zX(a);f++}n[f]=r;f++}t-=a*10;if(t>0){n[f]=zX(t);f++}n[f]=0}else c=Integer.toString(t);if(c.length==0){for(f=0;f<50;f++)if(n[f]==0)break;c=Wk(n,0,f)}return c}function zX(t){if(t==0)return 12295;else if(t==1)return 22769;else if(t==2)return 24336;else if(t==3)return 21442;else if(t==4)return 22235;else if(t==5)return 20237;else if(t==6)return 20845;else if(t==7)return 19971;else if(t==8)return 20843;else if(t==9)return 20061;else return tc.CHAR_E}function ZX(t){var e=0;if(t<=0)return wY(t);t=(t-1)%14+1;if(t==1)e=65536-21504;else if(t==2)e=65536-20328;else if(t==3)e=65536-19740;else if(t==4)e=65536-18564;else if(t==5)e=65536-17976;else if(t==6)e=65536-17388;else if(t==7)e=65536-16212;else if(t==8)e=65536-15036;else if(t==9)e=65536-14448;else if(t==10)e=65536-13272;else if(t==11)e=65536-12684;else if(t==12)e=65536-12096;else if(t==13)e=65536-11508;else if(t==14)e=65536-10920;if(e==0)return wY(t);else return wY(e)}function QX(t,e){var r,i;var f=t;var l=[50];var a="";if(t<0)t=-t;if(t<10){l[0]=qX(t);l[1]=0}else if(t<1e3){r=0;if(t>=110){l[r]=qX(100);r++;t=t/10}i=t/10;if(t==15||t==16)l[r]=qX(t);else l[r]=qX(i*10);r++;if(t%10>0){t=t%10;if(f==15||f==16)l[r]=qX(t+1);else l[r]=qX(t);r++}l[r]=0}else a=Integer.toString(t);if(a.length==0){for(r=0;r<50;r++)if(l[r]==0)break;a=Wk(l,0,r)}return a}function qX(t){if(t==0)return 1497;else if(t==1)return 1488;else if(t==2)return 1489;else if(t==3)return 1490;else if(t==4)return 1491;else if(t==5)return 1492;else if(t==6)return 1493;else if(t==7)return 1494;else if(t==8)return 1495;else if(t==9)return 1496;else if(t==10)return 1497;else if(t==15)return 1496;else if(t==16)return 1496;else if(t==20)return 1499;else if(t==30)return 1500;else if(t==40)return 1502;else if(t==50)return 1504;else if(t==60)return 1505;else if(t==70)return 1506;else if(t==80)return 1508;else if(t==90)return 1510;else if(t==100)return 1511;else return tc.CHAR_E}function $X(t){var e,r;var i=Uk(t);r=t.length;for(e=0;e<r;e++)if(i[e]!=tc.CHAR_SPACE)break;if(e==0)return t;else return cV(t,e)}function tK(t){var e,r;var i=Uk(t);r=t.length;if(r==0)return t;for(e=r-1;e>=0;e--)if(i[e]!=tc.CHAR_SPACE)break;if(e<0)return t;else return cV(t,0,e+1)}function eK(t,e,r,i){var f="";if(i==1036)f=rK(f,t);if(f==""){if(t>999999)f=Integer.toString(t);else if(t==0)f="Zero";else f=aK(t,e)}f=f.trim();if(r)f=f.toUpperCase();return f}function rK(t,e){t="";if(e==0)t="Z�ro";else if(e==1)t="Premier";else if(e==2)t="Deuxi�me";else if(e==3)t="Troisi�me";else if(e==4)t="Quatri�me";else if(e==5)t="Cinqui�me";else if(e==6)t="Sixi�me";else if(e==7)t="Septi�me";else if(e==8)t="Huiti�me";else if(e==9)t="Neuvi�me";else if(e==10)t="Dixi�me";else if(e==11)t="Onzi�me";else if(e==12)t="Douzi�me";else if(e==13)t="Treizi�me";else if(e==14)t="Quatorzi�me";else if(e==15)t="Quinzi�me";else if(e==16)t="Seizi�me";else if(e==17)t="Dix-septi�me";else if(e==18)t="Dix-huiti�me";else if(e==19)t="Dix-neuvi�me";else if(e==20)t="Vingti�me";else if(e==21)t="Vingt et uni�me";else if(e==22)t="Vingt-deuxi�me";else if(e==23)t="Vingt-troisi�me";else if(e==24)t="Vingt-quatri�me";else if(e==25)t="Vingt-cinqui�me";else if(e==26)t="Vingt-sixi�me";else if(e==27)t="Vingt-septi�me";else if(e==28)t="Vingt-huiti�me";else if(e==29)t="Vingt-neuvi�me";else if(e==30)t="Trenti�me";else if(e==31)t="Trente et uni�me";else if(e==32)t="Trente-deuxi�me";else if(e==33)t="Trente-troisi�me";else if(e==34)t="Trente-quatri�me";else if(e==35)t="Trente-cinqui�me";else if(e==36)t="Trente-sixi�me";else if(e==37)t="Trente-septi�me";else if(e==38)t="Trente-huiti�me";else if(e==39)t="Trente-neuvi�me";else if(e==40)t="Quaranti�me";else if(e==41)t="Quarante et uni�me";else if(e==42)t="Quarante-deuxi�me";else if(e==43)t="Quarante-troisi�me";else if(e==44)t="Quarante-quatri�me";else if(e==45)t="Quarante-cinqui�me";else if(e==46)t="Quarante-sixi�me";else return"";return t}function iK(t,e){var r="";if(e){switch(t){case 1:r="First";break;case 2:r="Second";break;case 3:r="Third";break;case 4:r="Fourth";break;case 5:r="Fifth";break;case 6:r="Sixth";break;case 7:r="Seventh";break;case 8:r="Eighth";break;case 9:r="Ninth";break;case 10:r="Tenth";break;case 11:r="Eleventh";break;case 12:r="Twelfth";break;case 13:r="Thirteenth";break;case 14:r="Fourteenth";break;case 15:r="Fifteenth";break;case 16:r="Sixteenth";break;case 17:r="Seventeenth";break;case 18:r="Eighteenth";break;case 19:r="Nineteenth";break;case 20:r="Twentieth";break;default:break}}else{switch(t){case 1:r="One ";break;case 2:r="Two ";break;case 3:r="Three ";break;case 4:r="Four ";break;case 5:r="Five ";break;case 6:r="Six ";break;case 7:r="Seven ";break;case 8:r="Eight ";break;case 9:r="Nine ";break;case 10:r="Ten ";break;case 11:r="Eleven ";break;case 12:r="Twelve ";break;case 13:r="Thirteen ";break;case 14:r="Fourteen ";break;case 15:r="Fifteen ";break;case 16:r="Sixteen ";break;case 17:r="Seventeen ";break;case 18:r="Eighteen ";break;case 19:r="Nineteen ";break;case 20:r="Twenty ";break;default:break}}return r}function fK(t,e){var r="";var i,f;if(t<=20)return iK(t,e);if(t>99)return r;i=t/10;f=t%10;switch(i){case 2:r="Twenty ";break;case 3:r="Thirty ";break;case 4:r="Forty ";break;case 5:r="Fifty ";break;case 6:r="Sixty ";break;case 7:r="Seventy ";break;case 8:r="Eighty ";break;case 9:r="Ninety ";break;default:break}return r+iK(f,e)}function lK(t,e){var r="";var i,f;if(t<=99)return fK(t,e);if(t>999)return r;i=t/100;f=t%100;r=iK(i,false);var l="Hundred ";if(f==0&&e)l="Hundredth";r+=l;if(f>0)r+="And "+fK(f,e);return r}function aK(t,e){var r="";var i,f;if(t<=999)return lK(t,e);if(t>999999)return r;i=t/1e3;f=t%1e3;r=lK(i,false);var l="Thousand ";if(f==0&&e)l="Thousandth";r+=l;if(f>0)r+="And "+lK(f,e);return r}function nK(t){var e;var r;if(t<0||t>=Ri)return false;if(ui[t].len==0)return false;e=ui[t].txt;r=e[ui[t].len-1];return BY(r)}function cK(){return true}function sK(){return true}_i.TerSetFlags=function(t,e){if(!rk(t,"set"))return false;if(!ek(e,"flags"))return false;if(t)zh|=e;else zh=Aj(e);return zh};_i.TerSetFlags2=function(t,e){if(!rk(t,"set"))return false;if(!ek(e,"flags"))return false;if(t)Zh|=e;else Zh=Ej(e);return Zh};_i.TerSetFlags3=function(t,e){if(!rk(t,"set"))return false;if(!ek(e,"flags"))return false;if(t){Qh|=e;if(Nj(e&tc.TFLAG3_CURSOR_IN_CELL))cR=ui[br].cid}else{Qh=Rj(e);if(Nj(e&tc.TFLAG3_CURSOR_IN_CELL))cR=0}return Qh};_i.TerSetFlags4=function(t,e){if(!rk(t,"set"))return false;if(!ek(e,"flags"))return false;if(t)qh|=e;else qh=Lj(e);return qh};_i.TerSetFlags5=function(t,e){if(!rk(t,"set"))return false;if(!ek(e,"flags"))return false;if(t)$h|=e;else $h=Cj(e);return $h};_i.TerSetFlags6=function(t,e){if(!rk(t,"set"))return false;if(!ek(e,"flags"))return false;if(t)tO|=e;else tO=Ij(e);return tO};_i.TerSetFlags7=function(t,e){if(!rk(t,"set"))return false;if(!ek(e,"flags"))return false;if(t)eO|=e;else eO=dj(e);return eO};_i.TerSetFlags8=function(t,e){if(!rk(t,"set"))return false;if(!ek(e,"flags"))return false;if(t)rO|=e;else rO=Fj(e);return rO};_i.TerSetFlags9=function(t,e){if(!rk(t,"set"))return false;if(!ek(e,"flags"))return false;if(t)iO|=e;else iO=gj(e);return iO};_i.TerSetFlags10=function(t,e){if(!rk(t,"set"))return false;if(!ek(e,"flags"))return false;if(t)fO|=e;else fO=gj(e);return fO};_i.TerSetFlags11=function(t,e){if(!rk(t,"set"))return false;if(!ek(e,"flags"))return false;if(t)lO|=e;else lO=gj(e);return lO};function _K(t){return true}function oK(){var t=false;var e,r=0,i;var f;var l,a;var n;var c=39;if(Ir||ui[br].len==0)return true;if(tJ(false))return true;if(Nh&&(Kx(true)||sU(true)))return true;if(Nj(Qh&tc.TFLAG3_NO_MOUSE_SEL))return true;if(Nj(iO&tc.TFLAG9_TREAT_DATA_FIELD_AS_ATOM)){r=ib(br,jt);if(xs[r].FieldId!=tc.FIELD_NAME&&xs[r].FieldId!=tc.FIELD_DATA){i=fb(br,jt);if(xs[i].FieldId!=tc.FIELD_NAME||xs[i].FieldId!=tc.FIELD_DATA){jt--;if(jt<0&&br>0){br--;jt=ui[br].len-1}if(jt<0)jt=0}}}if(QE){r=ib(br,jt);if(Nj(xs[r].style&tc.PICT))return true}f=ui[br].txt;n=nb(br);l=false;for(e=jt;e>=0;e--){i=r;r=n[e];if(e<jt&&xs[r].FieldId!=xs[i].FieldId){l=true;break}t=f[e]>=33&&f[e]<=46||f[e]>=58&&f[e]<=64;if(t&&f[e]==c)t=false;if(l&&(f[e]==tc.CHAR_SPACE||t||f[e]==tc.TAB||f[e]==tc.NBSPACE_CHAR))break;if(f[e]!=tc.CHAR_SPACE&&f[e]!=tc.TAB)l=true}if(l)TA=e+1;else{for(e=jt;e<ui[br].len;e++){if(f[e]!=tc.CHAR_SPACE&&f[e]!=tc.TAB)break}if(e==ui[br].len)return true;TA=e}a=false;for(e=TA;e<ui[br].len;e++){i=r;r=n[e];if(e>TA&&xs[r].FieldId!=xs[i].FieldId){a=true;break}if(e>TA&&Nj(xs[r].style&tc.PICT)){a=true;break}t=f[e]>=33&&f[e]<=46||f[e]>=58&&f[e]<=64;if(t&&f[e]==c)t=false;if(f[e]==tc.TAB||f[e]==Bn||f[e]==tc.LINE_CHAR||f[e]==TR||f[e]==tc.PAGE_CHAR||f[e]==tc.COL_CHAR||f[e]==tc.SECT_CHAR||f[e]==tc.NBSPACE_CHAR||t){a=true;break}if(a&&f[e]!=tc.CHAR_SPACE)break;if(f[e]==tc.CHAR_SPACE)a=true}if(a)AA=e;else AA=ui[br].len;if(AA>=ui[br].len&&br+1==Ri&&oi.WordWrap)AA--;sb(br);if(AA<=TA||TA==-1)return true;sA=_A=br;jt=AA;uA=tc.HILIGHT_CHAR;OA=true;Ua=false;MA=true;oA=_A;EA=AA;cG();FN(false);return true}_i.TerGetReadOnly=function(){return oi.ReadOnly};_i.TerSetReadOnly=function(t){var e;var r;if(!lv||!QD())_i.TerCreateControl();e=oi.ReadOnly;oi.ReadOnly=t;_q();if(WA!=null){Yp(!t);FN(true)}if(Nj(qh&tc.TFLAG4_READONLY_CONTROLS)){for(r=0;r<Ys;r++){if(Xw(r)&&xs[r].ctl!=null){var i=!t;if(i&&Nj(xs[r].style&tc.PROTECT))i=false;xs[r].ctl.setEnabled(i)}}}return e};_i.TerSetModify=function(t){if(!lv||!QD())_i.TerCreateControl();if(t)oi.modified++;else{oi.modified=0;lr=0}return true};_i.TerIsModified=function(){if(!lv||!QD())_i.TerCreateControl();return Nj(oi.modified)};function uK(t,e){var r=false;var i,f=t.length;var l=Uk(t);for(i=0;i<f;i++){var a=l[i];if(a==tc.QUOTE){r=!r;continue}if(r)continue;if(i>=1&&a==e&&l[i-1]==tc.BACK_SLASH){if(i>=2&&l[i-2]!=tc.SPACE)continue;if(i+1==f)return true;if(l[i+1]==tc.SPACE||l[i+1]==tc.BACK_SLASH)return true}}return false}function TK(t,e,r){var i,f,l;var a;if(t==null)return"";a=[t.length+1];l=t.length;var n=kk(t);for(i=0;i<l;i++){if(i>0&&n[i-1]==r)e--;if(e==0)break}if(i==l)return"";f=i;for(i=f;i<l;i++){if(n[i]==r)break;a[i-f]=n[i]}return Wk(a,0,i-f)}_i.TerGetExt=function(t){var e,r;var i;var f;f="";e=t.length;if(e==0)return f;var l=kk(t);for(r=e-1;r>=0;r--){i=l[r];if(i==":".charCodeAt(0)||i==gk(tc.BACK_SLASH))return f;if(i==".".charCodeAt(0))break}if(r<0)return f;while(r<e){i=l[r];f=_V(f,i);r++}return f};_i.TerGetDir=function(t){var e,r;var i;var f;f="";e=t.length;if(e==0)return f;var l=kk(t);for(r=e-1;r>=0;r--){i=l[r];if(i==":".charCodeAt(0)||i==gk(tc.BACK_SLASH))break}if(r<0)return f;e=r+1;r=0;while(r<e){i=l[r];f=_V(f,i);r++}return f};function AK(){cE|=tc.SRCH_SCROLL|tc.SRCH_SKIP_HIDDEN_TEXT;var t=_i.DlgCompHeight;var e=_i.DlgFont;var f=new $t.DialogBox(te,"Search Text",e,true,function(t,e,r){o(t,e,r)});var r=f.cvs;var i=new $t.Label(r,0,0,e,"Locate");f.addComp(i,0,0,1,3,"Left","bottom");var l=new $t.TextBox(r,0,0,JV(400),t,rE,e,_i.caret,false,true,null);f.addComp(l,1,0,1,3,"left","middle");var a=new $t.RadioButton(r,0,0,JV(15),e,"From Beginning of File",true,null,null);f.addComp(a,2,0,1,1,"left","bottom");var n=new $t.RadioButton(r,0,0,JV(15),e,"Forward",false,a,null);f.addComp(n,3,0,1,1,"left","middle");var c=new $t.RadioButton(r,0,0,JV(15),e,"Backward",false,n,null);f.addComp(c,4,0,1,1,"left","top");var s=new $t.CheckBox(r,0,0,JV(15),JV(16),e,"Case Sensitive",Nj(cE&tc.SRCH_CASE),null);f.addComp(s,3,2,1,1,"Left","bottom",-20);var _=new $t.CheckBox(r,0,0,JV(15),JV(16),e,"Whole Word",Nj(cE&tc.SRCH_WORD),null);f.addComp(_,4,2,1,1,"Left","middle",-20);f.show();l.setFocus();function o(t,e,r){if(t=="Cancel"){f.hide();return}else if(t=="OK"){rE=l.getText();if(rE==""){l.setFocus();return}if(a.isSelected())lE=tc.CHAR_E;else if(n.isSelected())lE=tc.CHAR_F;else lE=tc.CHAR_B;cE=_j(cE,tc.SRCH_CASE|tc.SRCH_WORD);if(s.isSelected())cE|=tc.SRCH_CASE;if(_.isSelected())cE|=tc.SRCH_WORD;f.hide()}else return;if(lE==tc.CHAR_F)Rm();var i=IK(rE,lE,0,0,0,0);if(!i){QY(tc.MSG_NO_STRING,"");if(br>=Ri)br=Ri-1}}return true}function EK(){if(rE.length==0){AK();return true}jt++;if(!IK(rE,tc.CHAR_F,0,0,0,0)){QY(tc.MSG_NO_STRING,tg.MsgString[tc.MSG_END_FORWARD_SEARCH]);if(jt>0)jt--;else if(br>0&&ui[br-1].len>0){br--;jt=ui[br].len-1}}return true}function RK(){if(rE.length==0){AK();return true}if(!IK(rE,tc.CHAR_B,0,0,0,0)){QY(tc.MSG_NO_STRING,tg.MsgString[tc.MSG_END_BACKWARD_SEARCH]);jt++}return true}function LK(){if(!ON())return true;var t=_i.DlgCompHeight;var e=_i.DlgFont;var i=new $t.DialogBox(te,"Search Text",e,true,function(t,e,r){o(t,e,r)});var r=i.cvs;var f=new $t.Label(r,0,0,e,"Replace");i.addComp(f,0,0,1,3,"Left","bottom");var l=new $t.TextBox(r,0,0,JV(400),t,iE,e,_i.caret,false,true,null);i.addComp(l,1,0,1,3,"left","middle");var a=new $t.Label(r,0,0,e,"With");i.addComp(a,2,0,1,3,"Left","bottom");var n=new $t.TextBox(r,0,0,JV(400),t,fE,e,_i.caret,false,true,null);i.addComp(n,3,0,1,3,"left","middle");var c=new $t.RadioButton(r,0,0,JV(15),e,"All",uA==tc.HILIGHT_OFF,null,null);i.addComp(c,4,0,1,1,"left","bottom");var s=new $t.RadioButton(r,0,0,JV(15),e,"Selected Text",uA!=tc.HILIGHT_OFF,c,null);i.addComp(s,5,0,1,1,"left","middle");var _=new $t.CheckBox(r,0,0,JV(15),JV(16),e,"Verify Each Replace",Nj(aE),null);i.addComp(_,5,2,1,1,"Left","middle",JV(-100));i.show();l.setFocus();function o(t,e,r){if(t=="Cancel"){i.hide();return}else if(t=="OK"){iE=l.getText();fE=n.getText();aE=_.isSelected();nE=s.isSelected();if(nE&&uA!=tc.HILIGHT_LINE&&uA!=tc.HILIGHT_CHAR){qk(tg.MsgString[tc.MSG_INVALID_SELECT],"");s.setFocus();return}i.hide()}else return;return CK()}return}function CK(){var t,e,r,i,f=0;var l;var a,n;var c,s;var _;var o,u=false,T;var A=null;var E,R;var L=uE;var C;var I=0,d=0,F=0,g=0,P=0;if(iE.length==0)return true;t=iE.length;r=fE.length;if(nE)_=tc.CHAR_R;else _=tc.CHAR_E;if(_==tc.CHAR_E){c=0;a=0;s=Ri-1;n=ui[s].len-1}else{I=uA;d=sA;F=TA;g=_A;P=AA;c=sA;if(uA==tc.HILIGHT_CHAR)a=TA;else a=0;s=_A;if(uA==tc.HILIGHT_CHAR)n=AA-1;else n=ui[_A].len-1}if(n<0)n=0;cE=tc.SRCH_CASE|tc.SRCH_SKIP_HIDDEN_TEXT;if(aE)cE|=tc.SRCH_SCROLL;else if(Dj(zh&tc.TFLAG_NO_HOUR_GLASS)){A=XQ(U)}t:while(true){if(_=="R"){uA=I;sA=d;TA=F;_A=g;AA=P}o=IK(iE,_,c,a,s,n);if(!o){if(!aE&&A!=null)XQ(A);if(br>=Ri)br=Ri-1;if(!u){QY(tc.MSG_NO_STRING,"");cG()}if(u){jt=f;Iq(br+1);if(r>0){uA=tc.HILIGHT_CHAR;sA=_A=br;TA=jt;AA=jt+r;if(AA>ui[br].len){C=Lq(br,jt);Cq(C+r,tc.CHAR_E)}}cG()}return true}uA=tc.HILIGHT_CHAR;sA=_A=br;TA=jt;AA=jt+t;if(AA>ui[br].len){C=Lq(br,jt);Cq(C+t,tc.CHAR_E)}T=wN(false,true);uA=tc.HILIGHT_OFF;if(T){f=jt;jt=jt+t;c=_A;a=AA;if(_==tc.CHAR_E)_=tc.CHAR_F;continue t}if(aE){uA=tc.HILIGHT_CHAR;sA=_A=br;TA=jt;AA=jt+t;if(AA>ui[br].len){C=Lq(br,jt);Cq(C+t,tc.CHAR_E)}Iq(br+1);cG();if(qk(_i,tg.MsgString[tc.MSG_REPLACE_STRING],"",tc.MSGTYPE_OK_CANCEL)==tc.MSGRESULT_OK){f=jt;jt=jt+t;if(jt>ft)jt=ft;c=br;a=jt;if(_==tc.CHAR_E)_=tc.CHAR_F;continue t}else return true}u=true;if(jt+t>ui[br].len&&br<Ri-1){var S;e=ui[br].len-jt;S=t-e;while(S>0&&br+1<Ri){if(S>=ui[br+1].len){S-=ui[br+1].len;uE=L;if(ui[br+1].len>0)V8(br+1,0,br+1,ui[br+1].len-1,tc.CHAR_D);iw(br+1,1,tc.CHAR_D)}else{uE=L;V8(br+1,0,br+1,S-1,tc.CHAR_D);fw(br+1,0,S,tc.CHAR_D);break}}}else e=t;uE=L;V8(br,jt,br,jt+e-1,tc.CHAR_D);if(r>e)fw(br,jt+e-1,r-e,tc.CHAR_A);if(r<e)fw(br,jt+r,e-r,tc.CHAR_D);sw(fE,br,jt);ab(br);E=uP;R=oP;for(i=e;i<r;i++){E[jt+i]=E[jt+e-1];R[jt+i]=0}cb(br);if(ui[br].len>ft)Tm(br,ui[br].len,ft);uE=L;if(r>0)V8(br,jt,br,jt+r-1,tc.CHAR_I);oi.modified++;if(_==tc.CHAR_E)_=tc.CHAR_F;f=jt;jt=jt+r;if(jt>=ft)jt=ft;c=br;a=jt;if(_==tc.CHAR_R&&c==s&&a>n){cG();return true}}}function IK(t,e,r,i,f,l){var a,n,c;var s,_;var o;var u;var T;var A,E,R,L,C,I,d,F;var g=Nj(cE&tc.SRCH_SKIP_HIDDEN_TEXT);var P=!yR&&Nj(cE&tc.SRCH_SKIP_HIDDEN_TEXT);var S=false,h;var O=false;var v;var p,N=0;var D,M;var G=e;var B=false,H=false;if((L=t.length)==0)return false;if(Dj(cE&tc.SRCH_CASE))t=t.toLowerCase();if(L==1){var m=kk(t);O=pk(m[0])}if(L>0){var w=kk(t);B=pk(w[0]);if(L==1)H=B;else{H=pk(w[L-1])}}o=" .,:<>?;'!@#$%^&*()-+=|\\/~01234567890\"";for(a=0;qS[a]!=0;a++)o=_V(o,qS[a]);o=_V(o,tc.TAB);o=_V(o,Bn);o=_V(o,TR);o=_V(o,tc.LINE_CHAR);if(e==tc.CHAR_E||e==tc.CHAR_F||e==tc.CHAR_B){r=br;i=jt}if(e==tc.CHAR_E){r=0;i=0;e=tc.CHAR_F}if(e==tc.CHAR_F){f=Ri-1;l=ui[f].len-1}if(e==tc.CHAR_B){f=0;l=0}if(e==tc.CHAR_R)e=tc.CHAR_F;if(e==tc.CHAR_S)e=tc.CHAR_B;if(i>=ft)i=ft-1;if(i<0)i=0;if(l>=ft)l=ft-1;if(l<0)l=0;t:{if(e==tc.CHAR_F){for(s=r;s<=f;s++){if(G==tc.CHAR_R&&!pm(s))continue;if(i>=ui[s].len){i=0;continue}if(P&&Nj(Nc[ui[s].pfmt].flags&tc.PAGE_HDR_FTR))continue;v=ui[s].len;T=Wk(ui[s].txt,0,v);Pc=[v+1];u=nb(s);qY(u,0,Pc,0,v);sb(s);C=ui[s].len;_=s+1;E=ui[s].len+L;while(_<=f&&C<E){if(ui[_].len>0){A=ui[_].len;if(C+A>E)A=E-C;T+=Wk(ui[_].txt,0,A);I=C;u=nb(_);Pc=fV(Pc,Pc.length+A);qY(u,0,Pc,I,A);sb(_);C=T.length}_++}if(C==ui[s].len+L)C--;if(Dj(cE&tc.SRCH_CASE))T=T.toLowerCase();n=C-i;if(s==f)c=l-i-L+1;else c=C-L-i;R=T.indexOf(t,i);R-=i;if(R>=0&&R<=c){if(Nj(cE&tc.SRCH_WORD)&&!O){h=true;p=kk(T);if(!B&&i+R>0&&o.indexOf(String.fromCharCode(p[i+R-1]))<0){d=Pc[i+R-1];F=Pc[i+R];D=pk(p[i+R-1]);if(!D&&xs[d].FieldId==xs[F].FieldId)h=false}if(!H&&R<c&&o.indexOf(String.fromCharCode(p[i+R+L]))<0){d=Pc[i+R+L-1];F=Pc[i+R+L];if(F==undefined)F=d;M=pk(p[i+R+L]);if(!M&&xs[d].FieldId==xs[F].FieldId)h=false}if(!h){if(R+L<ui[s].len){i=i+R+L;s--}continue}}if(g){for(a=0;a<L;a++)if(um(Pc[i+R+a]))break;if(a<L){for(;a<L;a++)if(!um(Pc[i+R+a]))break;i=i+R+a;while(s<Ri&&i>=ui[s].len){i-=ui[s].len;s++}s--;continue}}jt=i+R;br=s;if(Nj(cE&tc.SRCH_SCROLL)){uA=tc.HILIGHT_CHAR;OA=false;sA=_A=br;TA=jt;AA=jt+L;if(AA>ui[s].len){N=Lq(br,jt);Cq(N+L,tc.CHAR_E)}if(Nj(Nc[ui[br].pfmt].flags&tc.PAGE_HDR_FTR)&&yR&&!WR&&VR)cq();Iq(br+1);cG()}S=true;break t}i=0}}if(e==tc.CHAR_B){var b=0;for(s=r;s>=f;s--){if(ui[s].len==0)continue;if(P&&Nj(Nc[ui[s].pfmt].flags&tc.PAGE_HDR_FTR))continue;v=ui[s].len;T=Wk(ui[s].txt,0,v);Pc=[v+1];u=nb(s);qY(u,0,Pc,0,v);sb(s);C=ui[s].len;_=s+1;E=ui[s].len+L;while(_<=f&&C<E){if(ui[_].len>0){A=ui[_].len;if(C+A>E)A=E-C;T+=Wk(ui[_].txt,0,A);I=C;u=nb(_);Pc=fV(Pc,Pc.length+A);qY(u,0,Pc,I,A);sb(_);C=T.length}_++}if(C==ui[s].len+L)C--;if(Dj(cE&tc.SRCH_CASE))T=T.toLowerCase();if(s!=r)i=C;if(i<=0)continue;n=i;if(s==f)c=l;else c=0;var x=n-b;R=T.lastIndexOf(t,x-1);b=0;if(R>=0&&R>=c){if(Nj(cE&tc.SRCH_WORD)&&!O){h=true;p=kk(T);if(!B&&R>c&&o.indexOf(String.fromCharCode(p[R-1]))<0){d=Pc[R-1];F=Pc[R];D=pk(p[R-1]);if(!D&&xs[d].FieldId==xs[F].FieldId)h=false}if(!H&&R+L<=i&&o.indexOf(String.fromCharCode(p[R+L]))<0){d=Pc[R+L-1];F=Pc[R+L];M=pk(p[R+L]);if(!M&&xs[d].FieldId==xs[F].FieldId)h=false}if(!h){if(R>0){b=i-R+1;s++}continue}}jt=R;br=s;if(Nj(cE&tc.SRCH_SCROLL)){uA=tc.HILIGHT_CHAR;OA=false;sA=_A=br;TA=jt;AA=jt+L;if(AA>ui[s].len){N=Lq(br,jt);Cq(N+L,tc.CHAR_E)}Iq(br+1);cG()}S=true;break t}}}}return S}function dK(t,e,r){var i,f,l,a,n,c,s,_=0;var o,u,T,A,E,R,L,C;var I,d,F;var g,P=null;var S;var h=0,O=uE,v;Cq(e);a=PC;o=SC;e=Lq(a,o);r++;Cq(r);n=PC;u=SC;r=Lq(n,u);i=r-e;if(i<0)return false;P=Uk(t);f=t.length;if(i<f)l=i;else l=f;if(Z_)l=0;Cq(e+l);c=PC;T=SC;L=0;oi.modified++;t:{if(l>0){V8(a,o,c,T-1,tc.CHAR_D);for(s=a;s<=c;s++){if(ui[s].len==0)continue;E=0;R=ui[s].len;if(s==a)E=o;if(s==c)R=T;g=ui[s].txt;S=nb(s);for(A=E;A<R;A++,L++){if(L<f){g[A]=P[L]}}sb(s)}uE=O;V8(a,o,c,T-1,tc.CHAR_I)}if(i==f&&!Z_)break t;h=0;_=0;if(i>f||Z_){uA=tc.HILIGHT_CHAR;sA=c;TA=T;_A=n;AA=u;_=ib(sA,TA);if(Z_){for(s=sA;s<=_A;s++){if(ui[s].len==0)continue;E=0;R=ui[s].len;if(s==sA)E=TA;if(s==_A)R=AA;S=nb(s);for(A=E;A<R;A++){if(xs[S[A]].InsRev==q_)h++}sb(s)}}uE=O;var p=nO;nO|=tc.TOFLAG2_NO_NORMALIZE;GN(false,false);nO=p;uA=tc.HILIGHT_OFF}if(i<f||Z_){I=br;F=we;C=jt;d=fr;v=Oc;if(Z_){br=n;jt=u;if(h>0){var N=r-h;Cq(N,"C".charCodeAt(0))}}else{br=c;jt=T}if(Z_)Oc=V4(_,tc.TRACK_NONE);else Oc=fb(c,T);if(Z_&&Oc>=0){if(xs[Oc].FieldId==tc.FIELD_HLINK&&xs[_].FieldId!=tc.FIELD_HLINK){Oc=Db(Oc,wh,false);Oc=fx(Oc,pJ(xs[0].TextColor),0,"",br,jt);Oc=_i.TerGetFieldFont(Oc,0,null)}}uE=O;qN(lV(P,L),null,null,false);br=I;we=F;jt=C;Oc=v;fr=d}}return true}_i.TerSetSearchString=function(t,e){if(!lv||!QD())_i.TerCreateControl();rE=t;if(e)cE|=tc.SRCH_CASE;else cE=_j(cE,tc.SRCH_CASE);cE|=tc.SRCH_SCROLL;return true};_i.TerSearchReplace2=function(t,e,r,i,f){var l;var a;if(!lv||!QD())_i.TerCreateControl();a=_i.TerSearchReplace(t,e,r,i,f);f=mC;if(Nj(r&tc.SRCH_REPLACE))return 1;if(a)return f;else return-1};_i.TerSearchReplace=function(t,e,r,i,f){var l;var a,n;var c,s;var _;var o;if(!lv||!QD())_i.TerCreateControl();TP=t;mC=f;HC=0;cE=r;if(Nj(cE&tc.SRCH_SEARCH)){if((_=FK(t))=="")return false;rE=_;Cq(i);a=PC;c=SC;n=br;s=jt;if(Nj(cE&tc.SRCH_BACK))l=IK(rE,tc.CHAR_S,a,c,0,0);else l=IK(rE,tc.CHAR_R,a,c,Ri-1,ui[Ri-1].len);rE="";if(!l)return false;f=Lq(br,jt);if(Dj(cE&tc.SRCH_SCROLL)){br=n;jt=s}mC=f;return true}if(Nj(cE&tc.SRCH_REPLACE)){if(Nj(r&tc.SRCH_NO_REPLACE_PROT_TEXT)){Cq(i,tc.CHAR_B);Cq(f+1,tc.CHAR_E);uA=tc.HILIGHT_CHAR;OA=false;if(wN(false,true))return false}var u;if((u=FK(e))==""&&e!="")return false;if(!dK(u,i,f))return false;cG();return true}if(Nj(cE&tc.SRCH_RETRIEVE)){var T,A;var E,R,L;var C;Cq(i);a=PC;c=SC;Cq(f+1);T=PC;E=SC;for(A=a;A<=T;A++){if(ui[A].len==0)continue;R=0;L=ui[A].len;if(A==a)R=c;if(A==T)L=E;C=ui[A].txt;t+=Wk(C,R,L-R)}HC=t.length;TP=t}return true};function FK(t){var e,r;var i=[];e=t.length;if(e==0)return"";var f=Uk(t);for(r=0;r<e;r++){if(f[r]=="^".charCodeAt(0)&&r<e-1){if(f[r+1]=="p".charCodeAt(0))i.push(Bn);else if(f[r+1]=="t".charCodeAt(0))i.push(tc.TAB);else if(f[r+1]=="^".charCodeAt(0))i.push("^".charCodeAt(0));else if(f[r+1]=="+".charCodeAt(0))i.push(151);else if(f[r+1]=="-".charCodeAt(0))i.push(150);else if(f[r+1]=="m".charCodeAt(0))i.push(tc.PAGE_CHAR);else if(f[r+1]==tc.CHAR_B)i.push(tc.SECT_CHAR);else{i.push(f[r]);continue}r++}else if(f[r]==13&&r+1<e&&f[r+1]==10){i.push(Bn);r++}else i.push(f[r])}return Wk(i)}function gK(){return PK()}_i.TerGetHtmlDocTitle=function(){if(!lv||!QD())_i.TerCreateControl();if(fh==null)return"";else return fh};_i.TerSetHtmlDocTitle=function(t){if(!lv||!QD())_i.TerCreateControl();fh=t;return true};function PK(){if(!HtnSearched)vK();return false}function SK(t,e){}function hK(t,e,r){return false}function OK(){StSearched=false;return true}function vK(){return true}_i.TerSetHtnObject=function(t){return true};_i.TerSetHtnLicenseKey=function(t){return};function pK(t){}function NK(t){}function DK(t){}function MK(){return true}function GK(){var t;for(t=0;t<Ys;t++){if(!xs[t].InUse||Dj(xs[t].style&tc.PICT)||xs[t].PctWidth==0)continue;if(xs[t].InCellId==0&&xs[t].InParaFID==0)_i.TerSetPictPctSize(t,xs[t].PctWidth,0,false,false)}return true}function BK(t){var e=9,r=3;var i=7;var f=Nc[t].AuxId;f=f>>e&i;return f==r?true:false}function HK(t){return true}_i.TerWrsSetLicenseKey=function(t){var e=false;return e};function mK(t,e){return false}function wK(t,e){return""}function bK(r,t){var e=function(t){var e=new Blob([t],{type:"txt/plain"});if(r!==null){window.URL.revokeObjectURL(r)}r=window.URL.createObjectURL(e);return r};e(t);return null}function xK(){var t=document.getElementById("inputTextToSave").value;var e=new Blob([t],{type:"text/plain"});var r=document.getElementById("inputFileNameToSaveAs").value;var i=document.createElement("a");i.download=r;i.innerHTML="Download File";if(window.webkitURL!=null){i.href=window.webkitURL.createObjectURL(e)}else{i.href=window.URL.createObjectURL(e);i.onclick=destroyClickedElement;i.style.display="none";document.body.appendChild(i)}i.click()}function yK(t){var e=0,r,i,f,l;var a=[3];var n;t=t.trim();if(t=="")return tc.CLR_WHITE;if(Tk(t,"aqua")==0)return new tc.Color(16776960);else if(Tk(t,"black")==0)return new tc.Color(0);else if(Tk(t,"blue")==0)return new tc.Color(16711680);else if(Tk(t,"fuchsia")==0)return new tc.Color(16711935);else if(Tk(t,"gray")==0)return new tc.Color(8421504);else if(Tk(t,"grayText")==0)return new tc.Color(8421504);else if(Tk(t,"darkgray")==0)return new tc.Color(11119017);else if(Tk(t,"darkslategray")==0)return new tc.Color(5197615);else if(Tk(t,"lightgray")==0)return new tc.Color(12632256);else if(Tk(t,"green")==0)return new tc.Color(32768);else if(Tk(t,"lime")==0)return new tc.Color(65280);else if(Tk(t,"maroon")==0)return new tc.Color(128);else if(Tk(t,"navy")==0)return new tc.Color(8388608);else if(Tk(t,"olive")==0)return new tc.Color(32896);else if(Tk(t,"purple")==0)return new tc.Color(8388736);else if(Tk(t,"red")==0)return new tc.Color(255);else if(Tk(t,"silver")==0)return new tc.Color(12632256);else if(Tk(t,"teal")==0)return new tc.Color(8421376);else if(Tk(t,"white")==0)return new tc.Color(16777215);else if(Tk(t,"yellow")==0)return new tc.Color(65535);else if(Tk(t,"aliceblue")==0)return new tc.Color(16775408);else if(Tk(t,"aquamarine")==0)return new tc.Color(13959039);else if(Tk(t,"beige")==0)return new tc.Color(14480885);else if(Tk(t,"blanchedalmond")==0)return new tc.Color(13495295);else if(Tk(t,"brown")==0)return new tc.Color(2763429);else if(Tk(t,"cadetblue")==0)return new tc.Color(10526303);else if(Tk(t,"chocolate")==0)return new tc.Color(1993170);else if(Tk(t,"cornflowerblue")==0)return new tc.Color(15570276);else if(Tk(t,"crimson")==0)return new tc.Color(3544284);else if(Tk(t,"darkblue")==0)return new tc.Color(9109504);else if(Tk(t,"darkgoldenrod")==0)return new tc.Color(755384);else if(Tk(t,"darkgreen")==0)return new tc.Color(25600);else if(Tk(t,"darkmagenta")==0)return new tc.Color(9109643);else if(Tk(t,"darkorange")==0)return new tc.Color(36095);else if(Tk(t,"darkred")==0)return new tc.Color(139);else if(Tk(t,"darkseagreen")==0)return new tc.Color(9419919);else if(Tk(t,"darkslategrey")==0)return new tc.Color(5197615);else if(Tk(t,"darkviolet")==0)return new tc.Color(13828244);else if(Tk(t,"deepskyblue")==0)return new tc.Color(16760576);else if(Tk(t,"dodgerblue")==0)return new tc.Color(16748574);else if(Tk(t,"floralwhite")==0)return new tc.Color(15792895);else if(Tk(t,"gainsboro")==0)return new tc.Color(14474460);else if(Tk(t,"antiquewhite")==0)return new tc.Color(14150650);else if(Tk(t,"azure")==0)return new tc.Color(16777200);else if(Tk(t,"bisque")==0)return new tc.Color(12903679);else if(Tk(t,"blueviolet")==0)return new tc.Color(14822282);else if(Tk(t,"burlywood")==0)return new tc.Color(8894686);else if(Tk(t,"chartreuse")==0)return new tc.Color(65407);else if(Tk(t,"coral")==0)return new tc.Color(5275647);else if(Tk(t,"cornsilk")==0)return new tc.Color(14481663);else if(Tk(t,"cyan")==0)return new tc.Color(16776960);else if(Tk(t,"darkcyan")==0)return new tc.Color(9145088);else if(Tk(t,"darkgrey")==0)return new tc.Color(11119017);else if(Tk(t,"darkkhaki")==0)return new tc.Color(7059389);else if(Tk(t,"darkolivegreen")==0)return new tc.Color(3107669);else if(Tk(t,"darkorchid")==0)return new tc.Color(13382297);else if(Tk(t,"darksalmon")==0)return new tc.Color(8034025);else if(Tk(t,"darkslateblue")==0)return new tc.Color(9125192);else if(Tk(t,"darkturquoise")==0)return new tc.Color(13749760);else if(Tk(t,"deeppink")==0)return new tc.Color(9639167);else if(Tk(t,"dimgrey")==0)return new tc.Color(6908265);else if(Tk(t,"firebrick")==0)return new tc.Color(2237106);else if(Tk(t,"forestgreen")==0)return new tc.Color(2263842);else if(Tk(t,"ghostwhite")==0)return new tc.Color(16775416);else if(Tk(t,"gold")==0)return new tc.Color(55295);else if(Tk(t,"greenyellow")==0)return new tc.Color(3145645);else if(Tk(t,"hotpink")==0)return new tc.Color(11823615);else if(Tk(t,"indigo")==0)return new tc.Color(8519755);else if(Tk(t,"khaki")==0)return new tc.Color(9234160);else if(Tk(t,"lavenderblush")==0)return new tc.Color(16118015);else if(Tk(t,"lemonchiffon")==0)return new tc.Color(13499135);else if(Tk(t,"lightcoral")==0)return new tc.Color(8421616);else if(Tk(t,"lightgoldenrodyellow")==0)return new tc.Color(13826810);else if(Tk(t,"lightgrey")==0)return new tc.Color(13882323);else if(Tk(t,"lightsalmon")==0)return new tc.Color(8036607);else if(Tk(t,"lightskyblue")==0)return new tc.Color(16436871);else if(Tk(t,"lightsteelblue")==0)return new tc.Color(14599344);else if(Tk(t,"limegreen")==0)return new tc.Color(3329330);else if(Tk(t,"magenta")==0)return new tc.Color(16711935);else if(Tk(t,"mediumblue")==0)return new tc.Color(13434880);else if(Tk(t,"mediumpurple")==0)return new tc.Color(14381203);else if(Tk(t,"mediumslateblue")==0)return new tc.Color(15624315);else if(Tk(t,"mediumturquoise")==0)return new tc.Color(13422920);else if(Tk(t,"midnightblue")==0)return new tc.Color(7346457);else if(Tk(t,"mistyrose")==0)return new tc.Color(14804223);else if(Tk(t,"navajowhite")==0)return new tc.Color(11394815);else if(Tk(t,"olivedrab")==0)return new tc.Color(2330219);else if(Tk(t,"orangered")==0)return new tc.Color(17919);else if(Tk(t,"goldenrod")==0)return new tc.Color(2139610);else if(Tk(t,"honeydew")==0)return new tc.Color(15794160);else if(Tk(t,"indianred")==0)return new tc.Color(6053069);else if(Tk(t,"ivory")==0)return new tc.Color(15794175);else if(Tk(t,"lavender")==0)return new tc.Color(16443110);else if(Tk(t,"lawngreen")==0)return new tc.Color(64636);else if(Tk(t,"lightblue")==0)return new tc.Color(15128749);else if(Tk(t,"lightcyan")==0)return new tc.Color(16777184);else if(Tk(t,"lightgreen")==0)return new tc.Color(9498256);else if(Tk(t,"lightpink")==0)return new tc.Color(12695295);else if(Tk(t,"lightseagreen")==0)return new tc.Color(11186720);else if(Tk(t,"lightslategrey")==0)return new tc.Color(10061943);else if(Tk(t,"lightyellow")==0)return new tc.Color(14745599);else if(Tk(t,"linen")==0)return new tc.Color(15134970);else if(Tk(t,"mediumaquamarine")==0)return new tc.Color(11193702);else if(Tk(t,"mediumorchid")==0)return new tc.Color(13850042);else if(Tk(t,"mediumseagreen")==0)return new tc.Color(7451452);else if(Tk(t,"mediumspringgreen")==0)return new tc.Color(10156544);else if(Tk(t,"mediumvioletred")==0)return new tc.Color(8721863);else if(Tk(t,"mintcream")==0)return new tc.Color(16449525);else if(Tk(t,"moccasin")==0)return new tc.Color(11920639);else if(Tk(t,"oldlace")==0)return new tc.Color(15136253);else if(Tk(t,"orange")==0)return new tc.Color(42495);else if(Tk(t,"orchid")==0)return new tc.Color(14053594);else if(Tk(t,"palegoldenrod")==0)return new tc.Color(11200750);else if(Tk(t,"paleturquoise")==0)return new tc.Color(15658671);else if(Tk(t,"papayawhip")==0)return new tc.Color(14020607);else if(Tk(t,"peru")==0)return new tc.Color(4163021);else if(Tk(t,"plum")==0)return new tc.Color(14524637);else if(Tk(t,"rosybrown")==0)return new tc.Color(9408444);else if(Tk(t,"saddlebrown")==0)return new tc.Color(1262987);else if(Tk(t,"sandybrown")==0)return new tc.Color(6333684);else if(Tk(t,"seashell")==0)return new tc.Color(15660543);else if(Tk(t,"skyblue")==0)return new tc.Color(15453831);else if(Tk(t,"slategrey")==0)return new tc.Color(9470064);else if(Tk(t,"springgreen")==0)return new tc.Color(8388352);else if(Tk(t,"tan")==0)return new tc.Color(9221330);else if(Tk(t,"tomato")==0)return new tc.Color(4678655);else if(Tk(t,"violet")==0)return new tc.Color(15631086);else if(Tk(t,"whitesmoke")==0)return new tc.Color(16119285);else if(Tk(t,"palegreen")==0)return new tc.Color(10025880);else if(Tk(t,"palevioletred")==0)return new tc.Color(9662683);else if(Tk(t,"peachpuff")==0)return new tc.Color(12168703);else if(Tk(t,"pink")==0)return new tc.Color(13353215);else if(Tk(t,"powderblue")==0)return new tc.Color(15130800);else if(Tk(t,"royalblue")==0)return new tc.Color(14772545);else if(Tk(t,"salmon")==0)return new tc.Color(7504122);else if(Tk(t,"seagreen")==0)return new tc.Color(5737262);else if(Tk(t,"sienna")==0)return new tc.Color(2970272);else if(Tk(t,"slateblue")==0)return new tc.Color(13458026);else if(Tk(t,"snow")==0)return new tc.Color(16448255);else if(Tk(t,"steelblue")==0)return new tc.Color(11829830);else if(Tk(t,"thistle")==0)return new tc.Color(14204888);else if(Tk(t,"turquoise")==0)return new tc.Color(13688896);else if(Tk(t,"wheat")==0)return new tc.Color(11788021);else if(Tk(t,"yellowgreen")==0)return new tc.Color(3329434);else if(Tk(t,"transparent")==0)return new tc.Color(16777215);var c=Uk(t);if(t.length>3&&c[0]==tc.CHAR_R&&c[1]=="g".charCodeAt(0)&&c[2]==tc.CHAR_B&&c[3]=="(".charCodeAt(0)){a[0]=a[1]=a[2]=255;l=4;f=t.length;if(f>50)f=50;n="";for(i=0;i<3;i++){for(r=l;r<f;r++){if(c[r]==gk(",")||c[r]==")".charCodeAt(0))break;n+=c[r]}a[i]=LX(n);n="";l=r+1}return new tc.Color(a[0],a[1],a[2])}if(c[0]=="#".charCodeAt(0)){e=1}f=t.substring(e).length;if(f>=2)a[0]=WK(cV(t,e),2);if(f>=4)a[1]=WK(cV(t,e+2),2);if(f>=6)a[2]=WK(cV(t,e+4),2);return new tc.Color(a[0],a[1],a[2])}function WK(t,e){var r=0,i=1;var f;var l;t=t.toUpperCase();var a=Uk(t);for(l=e-1;l>=0;l--){f=a[l];if(f>=tc.CHAR_0&&f<=tc.CHAR_9)r+=i*(f-tc.CHAR_0);if(f>=tc.CHAR_A&&f<=tc.CHAR_F)r+=i*(f-tc.CHAR_A+10);i*=16}return r}function UK(t){var e;if(d_==null)$K();for(e=0;e<F_;e++)if(d_[e].lcid==t)break;if(e<F_)return d_[e].locale;else return Locale.getDefault()}function kK(t){var e;if(d_==null)$K();for(e=0;e<F_;e++)if(d_[e].lcid==t)break;if(e<F_)return d_[e].CharSet;else return 0}function XK(t){var e;if(d_==null)$K();for(e=0;e<F_;e++)if(d_[e].CharSet==t)break;if(e<F_)return d_[e].lcid;else return 1033}function KK(t){var e;if(d_==null)$K();for(e=0;e<F_;e++)if(d_[e].CharSet==t)break;if(e<F_)return d_[e].locale;else return Locale.getDefault()}function YK(t,e){var r;if(d_==null)$K();for(r=0;r<F_;r++)if(d_[r].CharSet==t&&d_[r].lcid==e)break;if(r<F_)return d_[r].locale;else return KK(t)}function VK(t){var e;if(d_==null)$K();for(e=0;e<F_;e++)if(d_[e].CharSet==t)break;if(e<F_)return d_[e].CodePage;else return 1252}function jK(t){return 1033}function JK(t){return 0}function zK(t){return"US-en"}function ZK(t){return 1252}function QK(t){return"US-en"}function qK(t){return"US-en"}function $K(){return true}function tY(){return true}function eY(t,e){if(e==tc.ANSI_CHARSET)return rY(t);else if(e==ks)return rY(t);else if(e==tc.SYMBOL_CHARSET)return AY(t);else if(e==tc.MAC_CHARSET)return iY(t);else if(e==tc.BALTIC_CHARSET)return fY(t);else if(e==tc.EASTEUROPE_CHARSET)return lY(t);else if(e==tc.GREEK_CHARSET)return aY(t);else if(e==tc.OEM_CHARSET)return nY(t);else if(e==tc.RUSSIAN_CHARSET)return cY(t);else if(e==tc.TURKISH_CHARSET)return sY(t);else if(e==tc.VIETNAMESE_CHARSET)return _Y(t);else if(e==tc.HEBREW_CHARSET)return oY(t);else if(e==tc.ARABIC_CHARSET)return uY(t);else if(e==tc.THAI_CHARSET)return TY(t);else return-1}function rY(t){if(t<128||t>255)return t;if(tg.ansi.length==0){tg.ansi[0]=8364;tg.ansi[1]=129;tg.ansi[2]=8218;tg.ansi[3]=402;tg.ansi[4]=8222;tg.ansi[5]=8230;tg.ansi[6]=8224;tg.ansi[7]=8225;tg.ansi[8]=710;tg.ansi[9]=8240;tg.ansi[10]=352;tg.ansi[11]=8249;tg.ansi[12]=338;tg.ansi[13]=141;tg.ansi[14]=381;tg.ansi[15]=143;tg.ansi[16]=144;tg.ansi[17]=8216;tg.ansi[18]=8217;tg.ansi[19]=8220;tg.ansi[20]=8221;tg.ansi[21]=8226;tg.ansi[22]=8211;tg.ansi[23]=8212;tg.ansi[24]=732;tg.ansi[25]=8482;tg.ansi[26]=353;tg.ansi[27]=8250;tg.ansi[28]=339;tg.ansi[29]=157;tg.ansi[30]=382;tg.ansi[31]=376;tg.ansi[32]=160;tg.ansi[33]=161;tg.ansi[34]=162;tg.ansi[35]=163;tg.ansi[36]=164;tg.ansi[37]=165;tg.ansi[38]=166;tg.ansi[39]=167;tg.ansi[40]=168;tg.ansi[41]=169;tg.ansi[42]=170;tg.ansi[43]=171;tg.ansi[44]=172;tg.ansi[45]=173;tg.ansi[46]=174;tg.ansi[47]=175;tg.ansi[48]=176;tg.ansi[49]=177;tg.ansi[50]=178;tg.ansi[51]=179;tg.ansi[52]=180;tg.ansi[53]=181;tg.ansi[54]=182;tg.ansi[55]=183;tg.ansi[56]=184;tg.ansi[57]=185;tg.ansi[58]=186;tg.ansi[59]=187;tg.ansi[60]=188;tg.ansi[61]=189;tg.ansi[62]=190;tg.ansi[63]=191;tg.ansi[64]=192;tg.ansi[65]=193;tg.ansi[66]=194;tg.ansi[67]=195;tg.ansi[68]=196;tg.ansi[69]=197;tg.ansi[70]=198;tg.ansi[71]=199;tg.ansi[72]=200;tg.ansi[73]=201;tg.ansi[74]=202;tg.ansi[75]=203;tg.ansi[76]=204;tg.ansi[77]=205;tg.ansi[78]=206;tg.ansi[79]=207;tg.ansi[80]=208;tg.ansi[81]=209;tg.ansi[82]=210;tg.ansi[83]=211;tg.ansi[84]=212;tg.ansi[85]=213;tg.ansi[86]=214;tg.ansi[87]=215;tg.ansi[88]=216;tg.ansi[89]=217;tg.ansi[90]=218;tg.ansi[91]=219;tg.ansi[92]=220;tg.ansi[93]=221;tg.ansi[94]=222;tg.ansi[95]=223;tg.ansi[96]=224;tg.ansi[97]=225;tg.ansi[98]=226;tg.ansi[99]=227;tg.ansi[100]=228;tg.ansi[101]=229;tg.ansi[102]=230;tg.ansi[103]=231;tg.ansi[104]=232;tg.ansi[105]=233;tg.ansi[106]=234;tg.ansi[107]=235;tg.ansi[108]=236;tg.ansi[109]=237;tg.ansi[110]=238;tg.ansi[111]=239;tg.ansi[112]=240;tg.ansi[113]=241;tg.ansi[114]=242;tg.ansi[115]=243;tg.ansi[116]=244;tg.ansi[117]=245;tg.ansi[118]=246;tg.ansi[119]=247;tg.ansi[120]=248;tg.ansi[121]=249;tg.ansi[122]=250;tg.ansi[123]=251;tg.ansi[124]=252;tg.ansi[125]=253;tg.ansi[126]=254;tg.ansi[127]=255}return tg.ansi[t-128]}function iY(t){if(t<128||t>255)return t;if(tg.mac.length==0){tg.mac[0]=8364;tg.mac[1]=129;tg.mac[2]=8218;tg.mac[3]=402;tg.mac[4]=8222;tg.mac[5]=8230;tg.mac[6]=8224;tg.mac[7]=8225;tg.mac[8]=710;tg.mac[9]=8240;tg.mac[10]=352;tg.mac[11]=8249;tg.mac[12]=338;tg.mac[13]=141;tg.mac[14]=381;tg.mac[15]=143;tg.mac[16]=144;tg.mac[17]=8216;tg.mac[18]=8217;tg.mac[19]=8220;tg.mac[20]=8221;tg.mac[21]=8226;tg.mac[22]=8211;tg.mac[23]=8212;tg.mac[24]=732;tg.mac[25]=8482;tg.mac[26]=353;tg.mac[27]=8250;tg.mac[28]=339;tg.mac[29]=157;tg.mac[30]=382;tg.mac[31]=376;tg.mac[32]=160;tg.mac[33]=161;tg.mac[34]=162;tg.mac[35]=163;tg.mac[36]=164;tg.mac[37]=165;tg.mac[38]=166;tg.mac[39]=167;tg.mac[40]=168;tg.mac[41]=169;tg.mac[42]=170;tg.mac[43]=171;tg.mac[44]=172;tg.mac[45]=173;tg.mac[46]=174;tg.mac[47]=175;tg.mac[48]=176;tg.mac[49]=177;tg.mac[50]=178;tg.mac[51]=179;tg.mac[52]=180;tg.mac[53]=181;tg.mac[54]=182;tg.mac[55]=183;tg.mac[56]=184;tg.mac[57]=185;tg.mac[58]=186;tg.mac[59]=187;tg.mac[60]=188;tg.mac[61]=189;tg.mac[62]=190;tg.mac[63]=191;tg.mac[64]=192;tg.mac[65]=193;tg.mac[66]=194;tg.mac[67]=195;tg.mac[68]=196;tg.mac[69]=197;tg.mac[70]=198;tg.mac[71]=199;tg.mac[72]=200;tg.mac[73]=201;tg.mac[74]=202;tg.mac[75]=203;tg.mac[76]=204;tg.mac[77]=205;tg.mac[78]=206;tg.mac[79]=207;tg.mac[80]=208;tg.mac[81]=209;tg.mac[82]=210;tg.mac[83]=211;tg.mac[84]=212;tg.mac[85]=213;tg.mac[86]=214;tg.mac[87]=215;tg.mac[88]=216;tg.mac[89]=217;tg.mac[90]=218;tg.mac[91]=219;tg.mac[92]=220;tg.mac[93]=221;tg.mac[94]=222;tg.mac[95]=223;tg.mac[96]=224;tg.mac[97]=225;tg.mac[98]=226;tg.mac[99]=227;tg.mac[100]=228;tg.mac[101]=229;tg.mac[102]=230;tg.mac[103]=231;tg.mac[104]=232;tg.mac[105]=233;tg.mac[106]=234;tg.mac[107]=235;tg.mac[108]=236;tg.mac[109]=237;tg.mac[110]=238;tg.mac[111]=239;tg.mac[112]=240;tg.mac[113]=241;tg.mac[114]=242;tg.mac[115]=243;tg.mac[116]=244;tg.mac[117]=245;tg.mac[118]=246;tg.mac[119]=247;tg.mac[120]=248;tg.mac[121]=249;tg.mac[122]=250;tg.mac[123]=251;tg.mac[124]=252;tg.mac[125]=253;tg.mac[126]=254;tg.mac[127]=255}return tg.mac[t-128]}function fY(t){if(t<128||t>255)return t;if(tg.baltic.length==0){tg.baltic[0]=8364;tg.baltic[1]=129;tg.baltic[2]=8218;tg.baltic[3]=131;tg.baltic[4]=8222;tg.baltic[5]=8230;tg.baltic[6]=8224;tg.baltic[7]=8225;tg.baltic[8]=136;tg.baltic[9]=8240;tg.baltic[10]=138;tg.baltic[11]=8249;tg.baltic[12]=140;tg.baltic[13]=168;tg.baltic[14]=711;tg.baltic[15]=184;tg.baltic[16]=144;tg.baltic[17]=8216;tg.baltic[18]=8217;tg.baltic[19]=8220;tg.baltic[20]=8221;tg.baltic[21]=8226;tg.baltic[22]=8211;tg.baltic[23]=8212;tg.baltic[24]=152;tg.baltic[25]=8482;tg.baltic[26]=154;tg.baltic[27]=8250;tg.baltic[28]=156;tg.baltic[29]=175;tg.baltic[30]=731;tg.baltic[31]=159;tg.baltic[32]=160;tg.baltic[33]=63740;tg.baltic[34]=162;tg.baltic[35]=163;tg.baltic[36]=164;tg.baltic[37]=63741;tg.baltic[38]=166;tg.baltic[39]=167;tg.baltic[40]=216;tg.baltic[41]=169;tg.baltic[42]=342;tg.baltic[43]=171;tg.baltic[44]=172;tg.baltic[45]=173;tg.baltic[46]=174;tg.baltic[47]=198;tg.baltic[48]=176;tg.baltic[49]=177;tg.baltic[50]=178;tg.baltic[51]=179;tg.baltic[52]=180;tg.baltic[53]=181;tg.baltic[54]=182;tg.baltic[55]=183;tg.baltic[56]=248;tg.baltic[57]=185;tg.baltic[58]=343;tg.baltic[59]=187;tg.baltic[60]=188;tg.baltic[61]=189;tg.baltic[62]=190;tg.baltic[63]=230;tg.baltic[64]=260;tg.baltic[65]=302;tg.baltic[66]=256;tg.baltic[67]=262;tg.baltic[68]=196;tg.baltic[69]=197;tg.baltic[70]=280;tg.baltic[71]=274;tg.baltic[72]=268;tg.baltic[73]=201;tg.baltic[74]=377;tg.baltic[75]=278;tg.baltic[76]=290;tg.baltic[77]=310;tg.baltic[78]=298;tg.baltic[79]=315;tg.baltic[80]=352;tg.baltic[81]=323;tg.baltic[82]=325;tg.baltic[83]=211;tg.baltic[84]=332;tg.baltic[85]=213;tg.baltic[86]=214;tg.baltic[87]=215;tg.baltic[88]=370;tg.baltic[89]=321;tg.baltic[90]=346;tg.baltic[91]=362;tg.baltic[92]=220;tg.baltic[93]=379;tg.baltic[94]=381;tg.baltic[95]=223;tg.baltic[96]=261;tg.baltic[97]=303;tg.baltic[98]=257;tg.baltic[99]=263;tg.baltic[100]=228;tg.baltic[101]=229;tg.baltic[102]=281;tg.baltic[103]=275;tg.baltic[104]=269;tg.baltic[105]=233;tg.baltic[106]=378;tg.baltic[107]=279;tg.baltic[108]=291;tg.baltic[109]=311;tg.baltic[110]=299;tg.baltic[111]=316;tg.baltic[112]=353;tg.baltic[113]=324;tg.baltic[114]=326;tg.baltic[115]=243;tg.baltic[116]=333;tg.baltic[117]=245;tg.baltic[118]=246;tg.baltic[119]=247;tg.baltic[120]=371;tg.baltic[121]=322;tg.baltic[122]=347;tg.baltic[123]=363;tg.baltic[124]=252;tg.baltic[125]=380;tg.baltic[126]=382;tg.baltic[127]=729}return tg.baltic[t-128]}function lY(t){if(t<128||t>255)return t;if(tg.easteurope.length==0){tg.easteurope[0]=8364;tg.easteurope[1]=129;tg.easteurope[2]=8218;tg.easteurope[3]=131;tg.easteurope[4]=8222;tg.easteurope[5]=8230;tg.easteurope[6]=8224;tg.easteurope[7]=8225;tg.easteurope[8]=136;tg.easteurope[9]=8240;tg.easteurope[10]=352;tg.easteurope[11]=8249;tg.easteurope[12]=346;tg.easteurope[13]=356;tg.easteurope[14]=381;tg.easteurope[15]=377;tg.easteurope[16]=144;tg.easteurope[17]=8216;tg.easteurope[18]=8217;tg.easteurope[19]=8220;tg.easteurope[20]=8221;tg.easteurope[21]=8226;tg.easteurope[22]=8211;tg.easteurope[23]=8212;tg.easteurope[24]=152;tg.easteurope[25]=8482;tg.easteurope[26]=353;tg.easteurope[27]=8250;tg.easteurope[28]=347;tg.easteurope[29]=357;tg.easteurope[30]=382;tg.easteurope[31]=378;tg.easteurope[32]=160;tg.easteurope[33]=711;tg.easteurope[34]=728;tg.easteurope[35]=321;tg.easteurope[36]=164;tg.easteurope[37]=260;tg.easteurope[38]=166;tg.easteurope[39]=167;tg.easteurope[40]=168;tg.easteurope[41]=169;tg.easteurope[42]=350;tg.easteurope[43]=171;tg.easteurope[44]=172;tg.easteurope[45]=173;tg.easteurope[46]=174;tg.easteurope[47]=379;tg.easteurope[48]=176;tg.easteurope[49]=177;tg.easteurope[50]=731;tg.easteurope[51]=322;tg.easteurope[52]=180;tg.easteurope[53]=181;tg.easteurope[54]=182;tg.easteurope[55]=183;tg.easteurope[56]=184;tg.easteurope[57]=261;tg.easteurope[58]=351;tg.easteurope[59]=187;tg.easteurope[60]=317;tg.easteurope[61]=733;tg.easteurope[62]=318;tg.easteurope[63]=380;tg.easteurope[64]=340;tg.easteurope[65]=193;tg.easteurope[66]=194;tg.easteurope[67]=258;tg.easteurope[68]=196;tg.easteurope[69]=313;tg.easteurope[70]=262;tg.easteurope[71]=199;tg.easteurope[72]=268;tg.easteurope[73]=201;tg.easteurope[74]=280;tg.easteurope[75]=203;tg.easteurope[76]=282;tg.easteurope[77]=205;tg.easteurope[78]=206;tg.easteurope[79]=270;tg.easteurope[80]=272;tg.easteurope[81]=323;tg.easteurope[82]=327;tg.easteurope[83]=211;tg.easteurope[84]=212;tg.easteurope[85]=336;tg.easteurope[86]=214;tg.easteurope[87]=215;tg.easteurope[88]=344;tg.easteurope[89]=366;tg.easteurope[90]=218;tg.easteurope[91]=368;tg.easteurope[92]=220;tg.easteurope[93]=221;tg.easteurope[94]=354;tg.easteurope[95]=223;tg.easteurope[96]=341;tg.easteurope[97]=225;tg.easteurope[98]=226;tg.easteurope[99]=259;tg.easteurope[100]=228;tg.easteurope[101]=314;tg.easteurope[102]=263;tg.easteurope[103]=231;tg.easteurope[104]=269;tg.easteurope[105]=233;tg.easteurope[106]=281;tg.easteurope[107]=235;tg.easteurope[108]=283;tg.easteurope[109]=237;tg.easteurope[110]=238;tg.easteurope[111]=271;tg.easteurope[112]=273;tg.easteurope[113]=324;tg.easteurope[114]=328;tg.easteurope[115]=243;tg.easteurope[116]=244;tg.easteurope[117]=337;tg.easteurope[118]=246;tg.easteurope[119]=247;tg.easteurope[120]=345;tg.easteurope[121]=367;tg.easteurope[122]=250;tg.easteurope[123]=369;tg.easteurope[124]=252;tg.easteurope[125]=253;tg.easteurope[126]=355;tg.easteurope[127]=729}return tg.easteurope[t-128]}function aY(t){if(t<128||t>255)return t;if(tg.greek.length==0){tg.greek[0]=8364;tg.greek[1]=129;tg.greek[2]=8218;tg.greek[3]=402;tg.greek[4]=8222;tg.greek[5]=8230;tg.greek[6]=8224;tg.greek[7]=8225;tg.greek[8]=136;tg.greek[9]=8240;tg.greek[10]=138;tg.greek[11]=8249;tg.greek[12]=140;tg.greek[13]=141;tg.greek[14]=142;tg.greek[15]=143;tg.greek[16]=144;tg.greek[17]=8216;tg.greek[18]=8217;tg.greek[19]=8220;tg.greek[20]=8221;tg.greek[21]=8226;tg.greek[22]=8211;tg.greek[23]=8212;tg.greek[24]=152;tg.greek[25]=8482;tg.greek[26]=154;tg.greek[27]=8250;tg.greek[28]=156;tg.greek[29]=157;tg.greek[30]=158;tg.greek[31]=159;tg.greek[32]=160;tg.greek[33]=901;tg.greek[34]=902;tg.greek[35]=163;tg.greek[36]=164;tg.greek[37]=165;tg.greek[38]=166;tg.greek[39]=167;tg.greek[40]=168;tg.greek[41]=169;tg.greek[42]=63737;tg.greek[43]=171;tg.greek[44]=172;tg.greek[45]=173;tg.greek[46]=174;tg.greek[47]=8213;tg.greek[48]=176;tg.greek[49]=177;tg.greek[50]=178;tg.greek[51]=179;tg.greek[52]=900;tg.greek[53]=181;tg.greek[54]=182;tg.greek[55]=183;tg.greek[56]=904;tg.greek[57]=905;tg.greek[58]=906;tg.greek[59]=187;tg.greek[60]=908;tg.greek[61]=189;tg.greek[62]=910;tg.greek[63]=911;tg.greek[64]=912;tg.greek[65]=913;tg.greek[66]=914;tg.greek[67]=915;tg.greek[68]=916;tg.greek[69]=917;tg.greek[70]=918;tg.greek[71]=919;tg.greek[72]=920;tg.greek[73]=921;tg.greek[74]=922;tg.greek[75]=923;tg.greek[76]=924;tg.greek[77]=925;tg.greek[78]=926;tg.greek[79]=927;tg.greek[80]=928;tg.greek[81]=929;tg.greek[82]=63738;tg.greek[83]=931;tg.greek[84]=932;tg.greek[85]=933;tg.greek[86]=934;tg.greek[87]=935;tg.greek[88]=936;tg.greek[89]=937;tg.greek[90]=938;tg.greek[91]=939;tg.greek[92]=940;tg.greek[93]=941;tg.greek[94]=942;tg.greek[95]=943;tg.greek[96]=944;tg.greek[97]=945;tg.greek[98]=946;tg.greek[99]=947;tg.greek[100]=948;tg.greek[101]=949;tg.greek[102]=950;tg.greek[103]=951;tg.greek[104]=952;tg.greek[105]=953;tg.greek[106]=954;tg.greek[107]=955;tg.greek[108]=956;tg.greek[109]=957;tg.greek[110]=958;tg.greek[111]=959;tg.greek[112]=960;tg.greek[113]=961;tg.greek[114]=962;tg.greek[115]=963;tg.greek[116]=964;tg.greek[117]=965;tg.greek[118]=966;tg.greek[119]=967;tg.greek[120]=968;tg.greek[121]=969;tg.greek[122]=970;tg.greek[123]=971;tg.greek[124]=972;tg.greek[125]=973;tg.greek[126]=974;tg.greek[127]=63739}return tg.greek[t-128]}function nY(t){if(t<128||t>255)return t;if(tg.oem.length==0){tg.oem[0]=8364;tg.oem[1]=129;tg.oem[2]=8218;tg.oem[3]=402;tg.oem[4]=8222;tg.oem[5]=8230;tg.oem[6]=8224;tg.oem[7]=8225;tg.oem[8]=710;tg.oem[9]=8240;tg.oem[10]=352;tg.oem[11]=8249;tg.oem[12]=338;tg.oem[13]=141;tg.oem[14]=381;tg.oem[15]=143;tg.oem[16]=144;tg.oem[17]=8216;tg.oem[18]=8217;tg.oem[19]=8220;tg.oem[20]=8221;tg.oem[21]=8226;tg.oem[22]=8211;tg.oem[23]=8212;tg.oem[24]=732;tg.oem[25]=8482;tg.oem[26]=353;tg.oem[27]=8250;tg.oem[28]=339;tg.oem[29]=157;tg.oem[30]=382;tg.oem[31]=376;tg.oem[32]=160;tg.oem[33]=161;tg.oem[34]=162;tg.oem[35]=163;tg.oem[36]=164;tg.oem[37]=165;tg.oem[38]=166;tg.oem[39]=167;tg.oem[40]=168;tg.oem[41]=169;tg.oem[42]=170;tg.oem[43]=171;tg.oem[44]=172;tg.oem[45]=173;tg.oem[46]=174;tg.oem[47]=175;tg.oem[48]=176;tg.oem[49]=177;tg.oem[50]=178;tg.oem[51]=179;tg.oem[52]=180;tg.oem[53]=181;tg.oem[54]=182;tg.oem[55]=183;tg.oem[56]=184;tg.oem[57]=185;tg.oem[58]=186;tg.oem[59]=187;tg.oem[60]=188;tg.oem[61]=189;tg.oem[62]=190;tg.oem[63]=191;tg.oem[64]=192;tg.oem[65]=193;tg.oem[66]=194;tg.oem[67]=195;tg.oem[68]=196;tg.oem[69]=197;tg.oem[70]=198;tg.oem[71]=199;tg.oem[72]=200;tg.oem[73]=201;tg.oem[74]=202;tg.oem[75]=203;tg.oem[76]=204;tg.oem[77]=205;tg.oem[78]=206;tg.oem[79]=207;tg.oem[80]=208;tg.oem[81]=209;tg.oem[82]=210;tg.oem[83]=211;tg.oem[84]=212;tg.oem[85]=213;tg.oem[86]=214;tg.oem[87]=215;tg.oem[88]=216;tg.oem[89]=217;tg.oem[90]=218;tg.oem[91]=219;tg.oem[92]=220;tg.oem[93]=221;tg.oem[94]=222;tg.oem[95]=223;tg.oem[96]=224;tg.oem[97]=225;tg.oem[98]=226;tg.oem[99]=227;tg.oem[100]=228;tg.oem[101]=229;tg.oem[102]=230;tg.oem[103]=231;tg.oem[104]=232;tg.oem[105]=233;tg.oem[106]=234;tg.oem[107]=235;tg.oem[108]=236;tg.oem[109]=237;tg.oem[110]=238;tg.oem[111]=239;tg.oem[112]=240;tg.oem[113]=241;tg.oem[114]=242;tg.oem[115]=243;tg.oem[116]=244;tg.oem[117]=245;tg.oem[118]=246;tg.oem[119]=247;tg.oem[120]=248;tg.oem[121]=249;tg.oem[122]=250;tg.oem[123]=251;tg.oem[124]=252;tg.oem[125]=253;tg.oem[126]=254;tg.oem[127]=255}return tg.oem[t-128]}function cY(t){if(t<128||t>255)return t;if(tg.russian.length==0){tg.russian[0]=1026;tg.russian[1]=1027;tg.russian[2]=8218;tg.russian[3]=1107;tg.russian[4]=8222;tg.russian[5]=8230;tg.russian[6]=8224;tg.russian[7]=8225;tg.russian[8]=8364;tg.russian[9]=8240;tg.russian[10]=1033;tg.russian[11]=8249;tg.russian[12]=1034;tg.russian[13]=1036;tg.russian[14]=1035;tg.russian[15]=1039;tg.russian[16]=1106;tg.russian[17]=8216;tg.russian[18]=8217;tg.russian[19]=8220;tg.russian[20]=8221;tg.russian[21]=8226;tg.russian[22]=8211;tg.russian[23]=8212;tg.russian[24]=152;tg.russian[25]=8482;tg.russian[26]=1113;tg.russian[27]=8250;tg.russian[28]=1114;tg.russian[29]=1116;tg.russian[30]=1115;tg.russian[31]=1119;tg.russian[32]=160;tg.russian[33]=1038;tg.russian[34]=1118;tg.russian[35]=1032;tg.russian[36]=164;tg.russian[37]=1168;tg.russian[38]=166;tg.russian[39]=167;tg.russian[40]=1025;tg.russian[41]=169;tg.russian[42]=1028;tg.russian[43]=171;tg.russian[44]=172;tg.russian[45]=173;tg.russian[46]=174;tg.russian[47]=1031;tg.russian[48]=176;tg.russian[49]=177;tg.russian[50]=1030;tg.russian[51]=1110;tg.russian[52]=1169;tg.russian[53]=181;tg.russian[54]=182;tg.russian[55]=183;tg.russian[56]=1105;tg.russian[57]=8470;tg.russian[58]=1108;tg.russian[59]=187;tg.russian[60]=1112;tg.russian[61]=1029;tg.russian[62]=1109;tg.russian[63]=1111;tg.russian[64]=1040;tg.russian[65]=1041;tg.russian[66]=1042;tg.russian[67]=1043;tg.russian[68]=1044;tg.russian[69]=1045;tg.russian[70]=1046;tg.russian[71]=1047;tg.russian[72]=1048;tg.russian[73]=1049;tg.russian[74]=1050;tg.russian[75]=1051;tg.russian[76]=1052;tg.russian[77]=1053;tg.russian[78]=1054;tg.russian[79]=1055;tg.russian[80]=1056;tg.russian[81]=1057;tg.russian[82]=1058;tg.russian[83]=1059;tg.russian[84]=1060;tg.russian[85]=1061;tg.russian[86]=1062;tg.russian[87]=1063;tg.russian[88]=1064;tg.russian[89]=1065;tg.russian[90]=1066;tg.russian[91]=1067;tg.russian[92]=1068;tg.russian[93]=1069;tg.russian[94]=1070;tg.russian[95]=1071;tg.russian[96]=1072;tg.russian[97]=1073;tg.russian[98]=1074;tg.russian[99]=1075;tg.russian[100]=1076;tg.russian[101]=1077;tg.russian[102]=1078;tg.russian[103]=1079;tg.russian[104]=1080;tg.russian[105]=1081;tg.russian[106]=1082;tg.russian[107]=1083;tg.russian[108]=1084;tg.russian[109]=1085;tg.russian[110]=1086;tg.russian[111]=1087;tg.russian[112]=1088;tg.russian[113]=1089;tg.russian[114]=1090;tg.russian[115]=1091;tg.russian[116]=1092;tg.russian[117]=1093;tg.russian[118]=1094;tg.russian[119]=1095;tg.russian[120]=1096;tg.russian[121]=1097;tg.russian[122]=1098;tg.russian[123]=1099;tg.russian[124]=1100;tg.russian[125]=1101;tg.russian[126]=1102;tg.russian[127]=1103}return tg.russian[t-128]}function sY(t){if(t<128||t>255)return t;if(tg.turkish.length==0){tg.turkish[0]=8364;tg.turkish[1]=129;tg.turkish[2]=8218;tg.turkish[3]=402;tg.turkish[4]=8222;tg.turkish[5]=8230;tg.turkish[6]=8224;tg.turkish[7]=8225;tg.turkish[8]=710;tg.turkish[9]=8240;tg.turkish[10]=352;tg.turkish[11]=8249;tg.turkish[12]=338;tg.turkish[13]=141;tg.turkish[14]=142;tg.turkish[15]=143;tg.turkish[16]=144;tg.turkish[17]=8216;tg.turkish[18]=8217;tg.turkish[19]=8220;tg.turkish[20]=8221;tg.turkish[21]=8226;tg.turkish[22]=8211;tg.turkish[23]=8212;tg.turkish[24]=732;tg.turkish[25]=8482;tg.turkish[26]=353;tg.turkish[27]=8250;tg.turkish[28]=339;tg.turkish[29]=157;tg.turkish[30]=158;tg.turkish[31]=376;tg.turkish[32]=160;tg.turkish[33]=161;tg.turkish[34]=162;tg.turkish[35]=163;tg.turkish[36]=164;tg.turkish[37]=165;tg.turkish[38]=166;tg.turkish[39]=167;tg.turkish[40]=168;tg.turkish[41]=169;tg.turkish[42]=170;tg.turkish[43]=171;tg.turkish[44]=172;tg.turkish[45]=173;tg.turkish[46]=174;tg.turkish[47]=175;tg.turkish[48]=176;tg.turkish[49]=177;tg.turkish[50]=178;tg.turkish[51]=179;tg.turkish[52]=180;tg.turkish[53]=181;tg.turkish[54]=182;tg.turkish[55]=183;tg.turkish[56]=184;tg.turkish[57]=185;tg.turkish[58]=186;tg.turkish[59]=187;tg.turkish[60]=188;tg.turkish[61]=189;tg.turkish[62]=190;tg.turkish[63]=191;tg.turkish[64]=192;tg.turkish[65]=193;tg.turkish[66]=194;tg.turkish[67]=195;tg.turkish[68]=196;tg.turkish[69]=197;tg.turkish[70]=198;tg.turkish[71]=199;tg.turkish[72]=200;tg.turkish[73]=201;tg.turkish[74]=202;tg.turkish[75]=203;tg.turkish[76]=204;tg.turkish[77]=205;tg.turkish[78]=206;tg.turkish[79]=207;tg.turkish[80]=286;tg.turkish[81]=209;tg.turkish[82]=210;tg.turkish[83]=211;tg.turkish[84]=212;tg.turkish[85]=213;tg.turkish[86]=214;tg.turkish[87]=215;tg.turkish[88]=216;tg.turkish[89]=217;tg.turkish[90]=218;tg.turkish[91]=219;tg.turkish[92]=220;tg.turkish[93]=304;tg.turkish[94]=350;tg.turkish[95]=223;tg.turkish[96]=224;tg.turkish[97]=225;tg.turkish[98]=226;tg.turkish[99]=227;tg.turkish[100]=228;tg.turkish[101]=229;tg.turkish[102]=230;tg.turkish[103]=231;tg.turkish[104]=232;tg.turkish[105]=233;tg.turkish[106]=234;tg.turkish[107]=235;tg.turkish[108]=236;tg.turkish[109]=237;tg.turkish[110]=238;tg.turkish[111]=239;tg.turkish[112]=287;tg.turkish[113]=241;tg.turkish[114]=242;tg.turkish[115]=243;tg.turkish[116]=244;tg.turkish[117]=245;tg.turkish[118]=246;tg.turkish[119]=247;tg.turkish[120]=248;tg.turkish[121]=249;tg.turkish[122]=250;tg.turkish[123]=251;tg.turkish[124]=252;tg.turkish[125]=305;tg.turkish[126]=351;tg.turkish[127]=255}return tg.turkish[t-128]}function _Y(t){if(t<128||t>255)return t;if(tg.viet.length==0){tg.viet[0]=8364;tg.viet[1]=129;tg.viet[2]=8218;tg.viet[3]=402;tg.viet[4]=8222;tg.viet[5]=8230;tg.viet[6]=8224;tg.viet[7]=8225;tg.viet[8]=710;tg.viet[9]=8240;tg.viet[10]=138;tg.viet[11]=8249;tg.viet[12]=338;tg.viet[13]=141;tg.viet[14]=142;tg.viet[15]=143;tg.viet[16]=144;tg.viet[17]=8216;tg.viet[18]=8217;tg.viet[19]=8220;tg.viet[20]=8221;tg.viet[21]=8226;tg.viet[22]=8211;tg.viet[23]=8212;tg.viet[24]=732;tg.viet[25]=8482;tg.viet[26]=154;tg.viet[27]=8250;tg.viet[28]=339;tg.viet[29]=157;tg.viet[30]=158;tg.viet[31]=376;tg.viet[32]=160;tg.viet[33]=161;tg.viet[34]=162;tg.viet[35]=163;tg.viet[36]=164;tg.viet[37]=165;tg.viet[38]=166;tg.viet[39]=167;tg.viet[40]=168;tg.viet[41]=169;tg.viet[42]=170;tg.viet[43]=171;tg.viet[44]=172;tg.viet[45]=173;tg.viet[46]=174;tg.viet[47]=175;tg.viet[48]=176;tg.viet[49]=177;tg.viet[50]=178;tg.viet[51]=179;tg.viet[52]=180;tg.viet[53]=181;tg.viet[54]=182;tg.viet[55]=183;tg.viet[56]=184;tg.viet[57]=185;tg.viet[58]=186;tg.viet[59]=187;tg.viet[60]=188;tg.viet[61]=189;tg.viet[62]=190;tg.viet[63]=191;tg.viet[64]=192;tg.viet[65]=193;tg.viet[66]=194;tg.viet[67]=258;tg.viet[68]=196;tg.viet[69]=197;tg.viet[70]=198;tg.viet[71]=199;tg.viet[72]=200;tg.viet[73]=201;tg.viet[74]=202;tg.viet[75]=203;tg.viet[76]=768;tg.viet[77]=205;tg.viet[78]=206;tg.viet[79]=207;tg.viet[80]=272;tg.viet[81]=209;tg.viet[82]=777;tg.viet[83]=211;tg.viet[84]=212;tg.viet[85]=416;tg.viet[86]=214;tg.viet[87]=215;tg.viet[88]=216;tg.viet[89]=217;tg.viet[90]=218;tg.viet[91]=219;tg.viet[92]=220;tg.viet[93]=431;tg.viet[94]=771;tg.viet[95]=223;tg.viet[96]=224;tg.viet[97]=225;tg.viet[98]=226;tg.viet[99]=259;tg.viet[100]=228;tg.viet[101]=229;tg.viet[102]=230;tg.viet[103]=231;tg.viet[104]=232;tg.viet[105]=233;tg.viet[106]=234;tg.viet[107]=235;tg.viet[108]=769;tg.viet[109]=237;tg.viet[110]=238;tg.viet[111]=239;tg.viet[112]=273;tg.viet[113]=241;tg.viet[114]=803;tg.viet[115]=243;tg.viet[116]=244;tg.viet[117]=417;tg.viet[118]=246;tg.viet[119]=247;tg.viet[120]=248;tg.viet[121]=249;tg.viet[122]=250;tg.viet[123]=251;tg.viet[124]=252;tg.viet[125]=432;tg.viet[126]=8363;tg.viet[127]=255}return tg.viet[t-128]}function oY(t){if(t<128||t>255)return t;if(tg.hebrew.length==0){tg.hebrew[0]=8364;tg.hebrew[1]=129;tg.hebrew[2]=8218;tg.hebrew[3]=402;tg.hebrew[4]=8222;tg.hebrew[5]=8230;tg.hebrew[6]=8224;tg.hebrew[7]=8225;tg.hebrew[8]=710;tg.hebrew[9]=8240;tg.hebrew[10]=138;tg.hebrew[11]=8249;tg.hebrew[12]=140;tg.hebrew[13]=141;tg.hebrew[14]=142;tg.hebrew[15]=143;tg.hebrew[16]=144;tg.hebrew[17]=8216;tg.hebrew[18]=8217;tg.hebrew[19]=8220;tg.hebrew[20]=8221;tg.hebrew[21]=8226;tg.hebrew[22]=8211;tg.hebrew[23]=8212;tg.hebrew[24]=732;tg.hebrew[25]=8482;tg.hebrew[26]=154;tg.hebrew[27]=8250;tg.hebrew[28]=156;tg.hebrew[29]=157;tg.hebrew[30]=158;tg.hebrew[31]=159;tg.hebrew[32]=160;tg.hebrew[33]=161;tg.hebrew[34]=162;tg.hebrew[35]=163;tg.hebrew[36]=8362;tg.hebrew[37]=165;tg.hebrew[38]=166;tg.hebrew[39]=167;tg.hebrew[40]=168;tg.hebrew[41]=169;tg.hebrew[42]=215;tg.hebrew[43]=171;tg.hebrew[44]=172;tg.hebrew[45]=173;tg.hebrew[46]=174;tg.hebrew[47]=175;tg.hebrew[48]=176;tg.hebrew[49]=177;tg.hebrew[50]=178;tg.hebrew[51]=179;tg.hebrew[52]=180;tg.hebrew[53]=181;tg.hebrew[54]=182;tg.hebrew[55]=183;tg.hebrew[56]=184;tg.hebrew[57]=185;tg.hebrew[58]=247;tg.hebrew[59]=187;tg.hebrew[60]=188;tg.hebrew[61]=189;tg.hebrew[62]=190;tg.hebrew[63]=191;tg.hebrew[64]=1456;tg.hebrew[65]=1457;tg.hebrew[66]=1458;tg.hebrew[67]=1459;tg.hebrew[68]=1460;tg.hebrew[69]=1461;tg.hebrew[70]=1462;tg.hebrew[71]=1463;tg.hebrew[72]=1464;tg.hebrew[73]=1465;tg.hebrew[74]=1466;tg.hebrew[75]=1467;tg.hebrew[76]=1468;tg.hebrew[77]=1469;tg.hebrew[78]=1470;tg.hebrew[79]=1471;tg.hebrew[80]=1472;tg.hebrew[81]=1473;tg.hebrew[82]=1474;tg.hebrew[83]=1475;tg.hebrew[84]=1520;tg.hebrew[85]=1521;tg.hebrew[86]=1522;tg.hebrew[87]=1523;tg.hebrew[88]=1524;tg.hebrew[89]=63629;tg.hebrew[90]=63630;tg.hebrew[91]=63631;tg.hebrew[92]=63632;tg.hebrew[93]=63633;tg.hebrew[94]=63634;tg.hebrew[95]=63635;tg.hebrew[96]=1488;tg.hebrew[97]=1489;tg.hebrew[98]=1490;tg.hebrew[99]=1491;tg.hebrew[100]=1492;tg.hebrew[101]=1493;tg.hebrew[102]=1494;tg.hebrew[103]=1495;tg.hebrew[104]=1496;tg.hebrew[105]=1497;tg.hebrew[106]=1498;tg.hebrew[107]=1499;tg.hebrew[108]=1500;tg.hebrew[109]=1501;tg.hebrew[110]=1502;tg.hebrew[111]=1503;tg.hebrew[112]=1504;tg.hebrew[113]=1505;tg.hebrew[114]=1506;tg.hebrew[115]=1507;tg.hebrew[116]=1508;tg.hebrew[117]=1509;tg.hebrew[118]=1510;tg.hebrew[119]=1511;tg.hebrew[120]=1512;tg.hebrew[121]=1513;tg.hebrew[122]=1514;tg.hebrew[123]=63636;tg.hebrew[124]=63637;tg.hebrew[125]=8206;tg.hebrew[126]=8207;tg.hebrew[127]=63638}return tg.hebrew[t-128]}function uY(t){if(t<128||t>255)return t;if(tg.arabic.length==0){tg.arabic[0]=8364;tg.arabic[1]=1662;tg.arabic[2]=8218;tg.arabic[3]=402;tg.arabic[4]=8222;tg.arabic[5]=8230;tg.arabic[6]=8224;tg.arabic[7]=8225;tg.arabic[8]=710;tg.arabic[9]=8240;tg.arabic[10]=1657;tg.arabic[11]=8249;tg.arabic[12]=338;tg.arabic[13]=1670;tg.arabic[14]=1688;tg.arabic[15]=1672;tg.arabic[16]=1711;tg.arabic[17]=8216;tg.arabic[18]=8217;tg.arabic[19]=8220;tg.arabic[20]=8221;tg.arabic[21]=8226;tg.arabic[22]=8211;tg.arabic[23]=8212;tg.arabic[24]=1705;tg.arabic[25]=8482;tg.arabic[26]=1681;tg.arabic[27]=8250;tg.arabic[28]=339;tg.arabic[29]=8204;tg.arabic[30]=8205;tg.arabic[31]=1722;tg.arabic[32]=160;tg.arabic[33]=1548;tg.arabic[34]=162;tg.arabic[35]=163;tg.arabic[36]=164;tg.arabic[37]=165;tg.arabic[38]=166;tg.arabic[39]=167;tg.arabic[40]=168;tg.arabic[41]=169;tg.arabic[42]=1726;tg.arabic[43]=171;tg.arabic[44]=172;tg.arabic[45]=173;tg.arabic[46]=174;tg.arabic[47]=175;tg.arabic[48]=176;tg.arabic[49]=177;tg.arabic[50]=178;tg.arabic[51]=179;tg.arabic[52]=180;tg.arabic[53]=181;tg.arabic[54]=182;tg.arabic[55]=183;tg.arabic[56]=184;tg.arabic[57]=185;tg.arabic[58]=1563;tg.arabic[59]=187;tg.arabic[60]=188;tg.arabic[61]=189;tg.arabic[62]=190;tg.arabic[63]=1567;tg.arabic[64]=1729;tg.arabic[65]=1569;tg.arabic[66]=1570;tg.arabic[67]=1571;tg.arabic[68]=1572;tg.arabic[69]=1573;tg.arabic[70]=1574;tg.arabic[71]=1575;tg.arabic[72]=1576;tg.arabic[73]=1577;tg.arabic[74]=1578;tg.arabic[75]=1579;tg.arabic[76]=1580;tg.arabic[77]=1581;tg.arabic[78]=1582;tg.arabic[79]=1583;tg.arabic[80]=1584;tg.arabic[81]=1585;tg.arabic[82]=1586;tg.arabic[83]=1587;tg.arabic[84]=1588;tg.arabic[85]=1589;tg.arabic[86]=1590;tg.arabic[87]=215;tg.arabic[88]=1591;tg.arabic[89]=1592;tg.arabic[90]=1593;tg.arabic[91]=1594;tg.arabic[92]=1600;tg.arabic[93]=1601;tg.arabic[94]=1602;tg.arabic[95]=1603;tg.arabic[96]=224;tg.arabic[97]=1604;tg.arabic[98]=226;tg.arabic[99]=1605;tg.arabic[100]=1606;tg.arabic[101]=1607;tg.arabic[102]=1608;tg.arabic[103]=231;tg.arabic[104]=232;tg.arabic[105]=233;tg.arabic[106]=234;tg.arabic[107]=235;tg.arabic[108]=1609;tg.arabic[109]=1610;tg.arabic[110]=238;tg.arabic[111]=239;tg.arabic[112]=1611;tg.arabic[113]=1612;tg.arabic[114]=1613;tg.arabic[115]=1614;tg.arabic[116]=244;tg.arabic[117]=1615;tg.arabic[118]=1616;tg.arabic[119]=247;tg.arabic[120]=1617;tg.arabic[121]=249;tg.arabic[122]=1618;tg.arabic[123]=251;tg.arabic[124]=252;tg.arabic[125]=8206;tg.arabic[126]=8207;tg.arabic[127]=1746}return tg.arabic[t-128]}function TY(t){if(t<128||t>255)return t;if(tg.thai.length==0){tg.thai[0]=8364;tg.thai[1]=129;tg.thai[2]=130;tg.thai[3]=131;tg.thai[4]=132;tg.thai[5]=8230;tg.thai[6]=134;tg.thai[7]=135;tg.thai[8]=136;tg.thai[9]=137;tg.thai[10]=138;tg.thai[11]=139;tg.thai[12]=140;tg.thai[13]=141;tg.thai[14]=142;tg.thai[15]=143;tg.thai[16]=144;tg.thai[17]=8216;tg.thai[18]=8217;tg.thai[19]=8220;tg.thai[20]=8221;tg.thai[21]=8226;tg.thai[22]=8211;tg.thai[23]=8212;tg.thai[24]=152;tg.thai[25]=153;tg.thai[26]=154;tg.thai[27]=155;tg.thai[28]=156;tg.thai[29]=157;tg.thai[30]=158;tg.thai[31]=159;tg.thai[32]=160;tg.thai[33]=3585;tg.thai[34]=3586;tg.thai[35]=3587;tg.thai[36]=3588;tg.thai[37]=3589;tg.thai[38]=3590;tg.thai[39]=3591;tg.thai[40]=3592;tg.thai[41]=3593;tg.thai[42]=3594;tg.thai[43]=3595;tg.thai[44]=3596;tg.thai[45]=3597;tg.thai[46]=3598;tg.thai[47]=3599;tg.thai[48]=3600;tg.thai[49]=3601;tg.thai[50]=3602;tg.thai[51]=3603;tg.thai[52]=3604;tg.thai[53]=3605;tg.thai[54]=3606;tg.thai[55]=3607;tg.thai[56]=3608;tg.thai[57]=3609;tg.thai[58]=3610;tg.thai[59]=3611;tg.thai[60]=3612;tg.thai[61]=3613;tg.thai[62]=3614;tg.thai[63]=3615;tg.thai[64]=3616;tg.thai[65]=3617;tg.thai[66]=3618;tg.thai[67]=3619;tg.thai[68]=3620;tg.thai[69]=3621;tg.thai[70]=3622;tg.thai[71]=3623;tg.thai[72]=3624;tg.thai[73]=3625;tg.thai[74]=3626;tg.thai[75]=3627;tg.thai[76]=3628;tg.thai[77]=3629;tg.thai[78]=3630;tg.thai[79]=3631;tg.thai[80]=3632;tg.thai[81]=3633;tg.thai[82]=3634;tg.thai[83]=3635;tg.thai[84]=3636;tg.thai[85]=3637;tg.thai[86]=3638;tg.thai[87]=3639;tg.thai[88]=3640;tg.thai[89]=3641;tg.thai[90]=3642;tg.thai[91]=63681;tg.thai[92]=63682;tg.thai[93]=63683;tg.thai[94]=63684;tg.thai[95]=3647;tg.thai[96]=3648;tg.thai[97]=3649;tg.thai[98]=3650;tg.thai[99]=3651;tg.thai[100]=3652;tg.thai[101]=3653;tg.thai[102]=3654;tg.thai[103]=3655;tg.thai[104]=3656;tg.thai[105]=3657;tg.thai[106]=3658;tg.thai[107]=3659;tg.thai[108]=3660;tg.thai[109]=3661;tg.thai[110]=3662;tg.thai[111]=3663;tg.thai[112]=3664;tg.thai[113]=3665;tg.thai[114]=3666;tg.thai[115]=3667;tg.thai[116]=3668;tg.thai[117]=3669;tg.thai[118]=3670;tg.thai[119]=3671;tg.thai[120]=3672;tg.thai[121]=3673;tg.thai[122]=3674;tg.thai[123]=3675;tg.thai[124]=63685;tg.thai[125]=63686;tg.thai[126]=63687;tg.thai[127]=63688}return tg.thai[t-128]}function AY(t){var e=t;if(e>=256)return e;if(e<0)e+=128;if(VS==null)EY();var r=VS[e];return r==0?e:r}function EY(){var t;VS=[];for(t=0;t<256;t++)VS[t]=0;VS[tc.CHAR_A]=913;VS[tc.CHAR_B]=914;VS["G".charCodeAt(0)]=915;VS["D".charCodeAt(0)]=916;VS[tc.CHAR_E]=917;VS[tc.CHAR_Z]=918;VS["H".charCodeAt(0)]=919;VS["Q".charCodeAt(0)]=920;VS["I".charCodeAt(0)]=921;VS["K".charCodeAt(0)]=922;VS["L".charCodeAt(0)]=923;VS["M".charCodeAt(0)]=924;VS["N".charCodeAt(0)]=925;VS["X".charCodeAt(0)]=926;VS["O".charCodeAt(0)]=927;VS["P".charCodeAt(0)]=928;VS[tc.CHAR_R]=929;VS[tc.CHAR_S]=931;VS["T".charCodeAt(0)]=932;VS["U".charCodeAt(0)]=933;VS[tc.CHAR_F]=934;VS["C".charCodeAt(0)]=935;VS["Y".charCodeAt(0)]=936;VS["W".charCodeAt(0)]=937;VS[tc.CHAR_a]=945;VS[tc.CHAR_B]=946;VS["g".charCodeAt(0)]=947;VS["d".charCodeAt(0)]=948;VS[tc.CHAR_E]=949;VS[tc.CHAR_z]=950;VS["h".charCodeAt(0)]=951;VS["q".charCodeAt(0)]=952;VS["i".charCodeAt(0)]=953;VS["k".charCodeAt(0)]=954;VS["l".charCodeAt(0)]=955;VS["m".charCodeAt(0)]=956;VS["n".charCodeAt(0)]=957;VS["x".charCodeAt(0)]=958;VS["o".charCodeAt(0)]=959;VS["p".charCodeAt(0)]=960;VS[tc.CHAR_R]=961;VS["V".charCodeAt(0)]=962;VS[tc.CHAR_S]=963;VS["t".charCodeAt(0)]=964;VS["u".charCodeAt(0)]=965;VS[tc.CHAR_F]=966;VS["c".charCodeAt(0)]=967;VS["y".charCodeAt(0)]=968;VS["w".charCodeAt(0)]=969;VS["J".charCodeAt(0)]=977;VS["j".charCodeAt(0)]=981;VS["v".charCodeAt(0)]=982;VS[176]=176;VS[177]=177;VS[180]=215;VS[184]=247;VS[210]=174;VS[211]=169;VS[216]=172;VS[226]=174;VS[227]=169;VS[166]=402;VS[162]=8242;VS[164]=8260;VS[178]=8243;VS[188]=8230;VS[192]=8501;VS[193]=8465;VS[194]=8476;VS[195]=8472;VS[212]=8482;VS[228]=8482;VS[240]=8364;VS[171]=8596;VS[172]=8592;VS[173]=8593;VS[174]=8594;VS[175]=8595;VS[191]=8629;VS[219]=8660;VS[220]=8656;VS[221]=8657;VS[222]=8658;VS[223]=8659;VS[34]=8704;VS[36]=8707;VS[39]=8717;VS[42]=8727;VS[45]=8722;VS[64]=8773;VS[92]=8756;VS[94]=8869;VS[126]=8764;VS[163]=8804;VS[165]=8734;VS[179]=8805;VS[181]=8733;VS[182]=8706;VS[183]=8729;VS[185]=8800;VS[186]=8801;VS[187]=8776;VS[196]=8855;VS[197]=8853;VS[198]=8709;VS[199]=8745;VS[200]=8746;VS[201]=8835;VS[202]=8839;VS[203]=8836;VS[204]=8834;VS[205]=8838;VS[206]=8712;VS[207]=8713;VS[208]=8736;VS[209]=8711;VS[213]=8719;VS[214]=8730;VS[215]=8901;VS[217]=8743;VS[218]=8744;VS[229]=8721;VS[242]=8747;VS[189]=9168;VS[190]=9135;VS[225]=9001;VS[230]=9115;VS[231]=9116;VS[232]=9117;VS[233]=9121;VS[234]=9122;VS[235]=9123;VS[236]=9127;VS[237]=9128;VS[238]=9129;VS[239]=9130;VS[241]=9002;VS[243]=8992;VS[244]=9134;VS[245]=8993;VS[246]=9118;VS[247]=9119;VS[248]=9120;VS[249]=9124;VS[250]=9125;VS[251]=9126;VS[252]=9131;VS[253]=9132;VS[254]=9133;VS[224]=9674;VS[167]=9827;VS[168]=9830;VS[169]=9829;VS[170]=9824;VS[161]=978;VS[183]=61623}function RY(t){var e=t;var r;if(YS==null)LY();if(e>=65280&&e<=65535)e-=65280;if(e<=0||e>=256)return t;r=YS[e];if(r==0)return t;return r}function LY(){var t;YS=[];for(t=0;t<256;t++)YS[t]=0;YS[32]=32;YS[33]=9999;YS[34]=9986;YS[35]=9985;YS[36]=128083;YS[37]=9086;YS[38]=128214;YS[40]=9742;YS[41]=9990;YS[42]=9993;YS[44]=128234;YS[45]=128235;YS[46]=128236;YS[47]=128237;YS[48]=128193;YS[49]=128194;YS[50]=128196;YS[54]=8987;YS[55]=9e3;YS[58]=128187;YS[60]=128190;YS[62]=9991;YS[63]=9997;YS[65]=9996;YS[66]=128076;YS[67]=128077;YS[68]=128078;YS[69]=9756;YS[70]=9758;YS[71]=9757;YS[72]=9759;YS[73]=9995;YS[74]=9786;YS[75]=128528;YS[76]=9785;YS[77]=128163;YS[78]=9760;YS[79]=9872;YS[80]=128681;YS[81]=9992;YS[82]=9788;YS[83]=128167;YS[84]=10052;YS[86]=10014;YS[88]=10016;YS[89]=10017;YS[90]=9770;YS[91]=9775;YS[92]=2384;YS[93]=9784;YS[94]=9800;YS[95]=9801;YS[96]=9802;YS[97]=9803;YS[98]=9804;YS[99]=9805;YS[100]=9806;YS[101]=9807;YS[102]=9808;YS[103]=9809;YS[104]=9810;YS[105]=9811;YS[106]=38;YS[107]=38;YS[108]=9679;YS[109]=10061;YS[110]=9632;YS[111]=9633;YS[113]=10065;YS[114]=10066;YS[115]=11047;YS[116]=10731;YS[117]=9670;YS[118]=10070;YS[119]=11045;YS[120]=8999;YS[121]=9043;YS[122]=8984;YS[123]=10048;YS[124]=10047;YS[125]=10077;YS[126]=10078;YS[127]=9647;YS[128]=9450;YS[129]=9312;YS[130]=9313;YS[131]=9314;YS[132]=9315;YS[133]=9316;YS[134]=9317;YS[135]=9318;YS[136]=9319;YS[137]=9320;YS[138]=9321;YS[139]=9471;YS[140]=10102;YS[141]=10103;YS[142]=10104;YS[143]=10105;YS[144]=10106;YS[145]=10107;YS[146]=10108;YS[147]=10109;YS[148]=10110;YS[149]=10111;YS[158]=183;YS[159]=8226;YS[160]=9642;YS[161]=9675;YS[162]=11093;YS[164]=9673;YS[165]=9678;YS[167]=9642;YS[168]=9723;YS[170]=10022;YS[171]=9733;YS[172]=10038;YS[173]=10036;YS[174]=10041;YS[175]=10037;YS[177]=8982;YS[178]=10209;YS[179]=8977;YS[181]=10026;YS[182]=10032;YS[183]=128336;YS[184]=128337;YS[185]=128338;YS[186]=128339;YS[187]=128340;YS[188]=128341;YS[189]=128342;YS[190]=128343;YS[191]=128344;YS[192]=128345;YS[193]=128346;YS[194]=128347;YS[213]=9003;YS[214]=8998;YS[216]=10146;YS[220]=10162;YS[224]=10132;YS[232]=10132;YS[239]=8678;YS[240]=8680;YS[241]=8679;YS[242]=8681;YS[243]=11012;YS[244]=8691;YS[245]=11008;YS[246]=11009;YS[247]=11011;YS[248]=11010;YS[249]=9645;YS[250]=9643;YS[251]=10007;YS[252]=10003;YS[253]=9746;YS[254]=9745}function CY(){return false}function IY(){return 0}function dY(){var t=arguments.length;var e="";var r="";for(var i=0;i<t;i++){if(arguments[i]instanceof Object){var f=arguments[i];r="\nObject Param# "+i+"\n";for(var l in f){if(typeof f[l]!="function")r+=l+": "+f[l]+"\n"}}else r=arguments[i]+"";if(e.length>0)e+=" ";e+=r}console.log(e)}function FY(){var t=arguments.length;var e="";var r="";for(var i=0;i<t;i++){if(arguments[i]instanceof Object){var f=arguments[i];r="\nObject Param# "+i+"\n";for(var l in f){if(typeof f[l]!="function")r+=l+": "+f[l]+"\n"}}else r=arguments[i]+"";if(e.length>0)e+=" ";e+=r}console.log(e)}function gY(){var t=arguments.length;var e="";var r="";if(!_i.UseVirtKeyboard)return;for(var i=0;i<t;i++){if(arguments[i]instanceof Object){var f=arguments[i];r="\nObject Param# "+i+"\n";for(var l in f){if(typeof f[l]!="function")r+=l+": "+f[l]+"\n"}}else r=arguments[i]+"";if(e.length>0)e+=" ";e+=r}_i.InsertTerText(e+"\n",true)}function PY(){var t=arguments.length;var e="";for(var r=0;r<t;r++){var i=arguments[r]+"";if(e.length>0)e+=" ";e+=i}console.log(e)}function SY(t){var e=arguments.length,r;var i="";var f=1;while((r=t.indexOf("%"))>=0){i=t.substr(0,r);if(t.substr(r+1,1)=="c")i+=String.fromCharCode(arguments[f]);else i+=arguments[f]+"";f++;t=i+t.substr(r+2,t.length-(r+2))}return t}function hY(t){var e=arguments.length,r;var i="";var f=1;while((r=t.indexOf("%"))>=0){i=t.substr(0,r);i+=arguments[f]+"";f++;t=i+t.substr(r+2,t.length-(r+2))}console.log(t)}_i.TerPrintTicks=function(t,e){OY(t,e)};function OY(t,e){var r=new Date;if(e!=undefined&&e)ZS=r.getTime();console.log(t,r.getTime()-ZS)}function vY(t,e){if(t)$t.TerInitFlags|=e;else $t.TerInitFlags=$t.ResetUintFlag($t.TerInitFlags,e);return $t.TerInitFlags}function pY(t,e){if(t)$t.TerInitFlags2|=e;else $t.TerInitFlags2=$t.ResetUintFlag($t.TerInitFlags2,e);return $t.TerInitFlags2}function NY(t,e){if(t)$t.TerInitFlags3|=e;else $t.TerInitFlags3=$t.ResetUintFlag($t.TerInitFlags3,e);return $t.TerInitFlags3}function DY(t,e){if(t)$t.TerInitFlags4|=e;else $t.TerInitFlags4=$t.ResetUintFlag($t.TerInitFlags4,e);return $t.TerInitFlags4}function MY(t){var e=0;var r=0;if(oi.LineLimit>0&&t>oi.LineLimit&&!(aO&tc.TOFLAG_WRAPPING))return false;if(t<xe)return true;e=xe+xe/4;if(e<=t)e=t+1;if(oi.LineLimit>0&&e>oi.LineLimit&&!(aO&tc.TOFLAG_WRAPPING))e=oi.LineLimit;xe=e;return true}function GY(t,e){return t>=0&&t<Ri&&ui[t].tabw&&Nj(ui[t].tabw.type&e)}function BY(t){return t==Bn||t==TR||xY(qS,t)}function HY(t,e){var r=false;var i;if(t<0){t=-t;r=true}e=Math.round(e);var f=Math.round(t/e);i=f*e;if(r)return-i;else return i}function mY(t){if(t==undefined||t==null)console.trace();return t.toString()}function wY(t,e){var r,i="";var f;if(e==undefined)e=1;r=String.fromCharCode(t);if(e<=1)return r;for(f=0;f<e;f++)i+=r;return i}function bY(t){if(t.length==0)return 0;return t.charCodeAt(0)}function xY(t,e){var r;var i=t.length;for(r=0;r<i&&t[r]!=0;r++){if(t[r]==e)return true}return false}function yY(t,e){var r=e-t.length;if(r<=0)return t;var i="",f;for(f=0;f<r;f++)i+=" ";return i+t}function WY(t,e){JC=t;return e}function UY(t,e){YF=t;return e}function kY(t,e){VF=t;return e}function XY(t){var e=new tc.RECT;e.left=t.x;e.top=t.y;e.right=t.x+t.width;e.bottom=t.y+t.height;return e}function KY(t){return new tc.Rectangle(t.left,t.top,t.right-t.left,t.bottom-t.top)}function YY(t){return new tc.Rectangle(t.left,t.top,t.right-t.left,t.bottom-t.top)}function VY(t,e,r,i){var f=new tc.RECT;f.left=t;f.top=e;f.right=r;f.bottom=i;return f}function jY(t){var e,r;if(!t)return 0;r=t.length;for(e=0;e<r&&t[e]!=0;e++);return e}function JY(t,e){var r,i=$t.lstrlen(e);if(i>0){for(r=0;r<i;r++)t[r]=e[r];t[r]=0}else t[0]=0}function zY(t,e){var r,i=jY(e);if(i>0){var f=jY(t);for(r=0;r<i;r++)t[f+r]=e[r];t[f+r]=0}}function ZY(t){return String.fromCharCode(t)}function QY(t,e){var r=false;if(zh&tc.TFLAG_RETURN_MSG_ID||$t.InServer)r=true;QO=t;if(r){qO=e}else qk(tg.MsgString[t],e,tc.MSGTYPE_ALERT);return false}function qY(t,e,r,i,f){if(i==undefined)$Y(t,e,r);else tV(t,e,r,i,f)}function $Y(e,r,i){var t;try{for(t=0;t<i;t++)r[t]=e[t]}catch(t){console.log("dest: ",r,"src: ",e,"count: ",i);console.trace();throw new Error(t)}}function tV(e,t,r,i,f){var l;try{for(l=0;l<f;l++)r[i+l]=e[t+l]}catch(t){console.log("dest: ",r,"src: ",e,"count: ",f);console.trace();throw new Error(t)}}function eV(t,e,r,i){if(arguments.length==5)return rV(arguments[0],arguments[1],arguments[2],arguments[3],arguments[4]);var f;if(r>e)for(f=i-1;f>=0;f--)t[r+f]=t[e+f];else for(f=0;f<i;f++)t[r+f]=t[e+f]}function rV(t,e,r,i,f){var l=[f];var a;for(a=0;a<f;a++)l[a]=t[e+a];for(a=0;a<f;a++)r[i+a]=l[a]}function iV(t,e,r,i){var f;for(f=r;f<r+i;f++)t[f]=e}function fV(t,e){return t}function lV(t,e,r){if(r==undefined)r=t.length-e;return t.slice(e,e+r)}function aV(t,e,r,i){return i+t.slice(e,e+r)}function nV(t,e){if(t==null&&e==null)return true;if(t==null&&e!=null)return false;if(t!=null&&e==null)return false;return t===e}function cV(t,e,r){if(r==undefined)r=t.length-e;if(r<=0)return"";else return t.substring(e,e+r)}function sV(t,e,r){if(r==undefined)r=t.length-e;if(r<=0)return"";else return t.substring(e,e+r)}function _V(t,e){return t+String.fromCharCode(e)}function oV(){}function uV(t){return t*Nt/72}function TV(t){return t*72/Nt}function AV(t){return t*wt/72}function EV(t){return t*72/wt}function RV(t){return t*Ai/72}function LV(t){return t*72/Ai}function CV(t){return t*Ei/72}function IV(t){return t*72/Ei}function dV(t){return t*Nt/1440}function FV(t){return t*yt/1440}function gV(t){return t*1440/Nt}function PV(t){return Math.round(t*1440/yt)}function SV(t){return t*Ai/yt}function hV(t){return t*wt/1440}function OV(t){return t*Wt/1440}function vV(t){return t*1440/wt}function pV(t){return Math.round(t*1440/Wt)}function NV(t){return t*Ei/Wt}function DV(t){return t*Ai/1440}function MV(t){return Math.round(t*1440/Ai)}function GV(t){return t/635}function BV(t){return t*635}function HV(t){return t*1440/Ei}function mV(t){return t*Ei/1440}function wV(t){return t*Ai/Nt}function bV(t){return t*Nt/Ai}function xV(t){return t*Ei/wt}function yV(t){return t*wt/Ei}function WV(t){return t*bt/1440}function UV(t){return Math.round(t*1440/bt)}function kV(t){return t*1440/xt}function XV(t){return t*xt/1440}function KV(t){return t*Ai*10/254}function YV(t){return t*Ei*10/254}function VV(t){return t/1440}function jV(t){return Math.round(t*1440)}function JV(t){return t*I}function zV(t){return t/I}function ZV(t){return t*254/(1440*100)}function QV(t){return Math.round(t*1440*100/254)}function qV(t){return t/72}function $V(t){return t*72}function tj(t){return t/20}function ej(t){return Math.round(t*20)}function rj(t){return t/25.4}function ij(t){return t*25.4}function fj(t){return t/2.54}function lj(t){return t*2.54}function aj(t){return t/Ut}function nj(t){return t/kt}function cj(t,e){return t&~e}function sj(t,e){return t&~e}function _j(t,e){return t&~e}function oj(t){return aO=aO&~t}function uj(t){return nO=nO&~t}function Tj(t){return cO=cO&~t}function Aj(t){return zh=zh&~t}function Ej(t){return Zh=Zh&~t}function Rj(t){return Qh=Qh&~t}function Lj(t){return qh=qh&~t}function Cj(t){return $h=$h&~t}function Ij(t){return tO=tO&~t}function dj(t){return eO=eO&~t}function Fj(t){return rO=rO&~t}function gj(t){return iO=iO&~t}function Pj(t){return fO=fO&~t}function Sj(t,e){return t<<8|e}function hj(t){return t==tc.HDR_CHAR||t==tc.FHDR_CHAR||t==tc.RHDR_CHAR||t==tc.LHDR_CHAR||t==tc.FTR_CHAR||t==tc.FFTR_CHAR||t==tc.RFTR_CHAR||t==tc.LFTR_CHAR}function Oj(t){return t>=tc.CHAR_a&&t<=tc.CHAR_z}function vj(t){return(t&tc.FNOTETEXT)!==0&&(t&tc.ENOTETEXT)===0}function pj(t){return t>=tc.BORDER_SECT_TOP&&t<=tc.BORDER_SECT_RIGHT}function Nj(t){if(!t)return false;if(t instanceof Number){return t!==0}if(t instanceof Boolean){return t}return true}function Dj(t){return!Nj(t)}function Mj(t,e,r){return Math.round(t*e/r)}var Gj=0,Bj=0,Hj=0;_i.TerShowPopupMenu=function(t,e){var r,i,f,l;var a;if(t>=0)_i.SetTerCursorPos(t,e,true);else{t=br;e=jt}f=ib(t,e);l=ui[t].pfmt;var n=new tc.JMenuItem;iv=rv;rv=null;zj(n,"Cut",tc.ID_CUT,false,null,true);zj(n,"Copy",tc.ID_COPY,false,null,true);zj(n,"Paste",tc.ID_PASTE,false,null,true);zj(n,"Paste Text",tc.ID_PASTE_TEXT,false,null,true);Zj(n,true);if(Nj(xs[f].style&tc.PICT)){zj(n,"Edit Picture...",tc.ID_EDIT_PICT,false,null,true)}else{if((a=jj(n,"Font",true))!=null){zj(a,"Normal",tc.ID_CHAR_NORMAL,false,null,false);Zj(a,false);zj(a,"Bold",tc.ID_BOLD_ON,true,null,false);zj(a,"Underline",tc.ID_ULINE_ON,true,null,false);zj(a,"Double Underline",tc.ID_ULINED_ON,true,null,false);zj(a,"Italic",tc.ID_ITALIC_ON,true,null,false);zj(a,"Superscript",tc.ID_SUPSCR_ON,true,null,false);zj(a,"Subscript",tc.ID_SUBSCR_ON,true,null,false);zj(a,"Strike",tc.ID_STRIKE_ON,true,null,false);zj(a,"Double Strike",tc.ID_DOUBLE_STRIKE_ON,true,null,false);zj(a,"All Caps",tc.ID_CAPS_ON,true,null,false);zj(a,"Small Caps",tc.ID_SCAPS_ON,true,null,false);Zj(a,false);zj(a,"Fonts...",tc.ID_FONTS,true,null,false);zj(a,"Style...",tc.ID_CHAR_STYLE,true,null,false);Zj(a,false);zj(a,"Text Color...",tc.ID_COLOR,true,null,false);zj(a,"Background Color...",tc.ID_BK_COLOR,true,null,false);zj(a,"Underline Color...",tc.ID_ULINE_COLOR,true,null,false);zj(a,"Highlight Color...",tc.ID_HILIGHT_TEXT,true,null,false);Zj(a,false);zj(a,"Spacing...",tc.ID_CHAR_SPACE,true,null,false);zj(a,"Horizontal Scaling...",tc.ID_CHAR_SCALEX,true,null,false);zj(a,"Hidden",tc.ID_HIDDEN_ON,true,null,false);zj(a,"Boxed",tc.ID_BOX_ON,true,null,false);zj(a,"Protect",tc.ID_PROTECT_ON,true,null,false)}if((a=jj(n,"Paragraph",true))!=null){zj(a,"Normal",tc.ID_PARA_NORMAL,false,null,false);Zj(a,false);zj(a,"Center",tc.ID_CENTER,true,null,false);zj(a,"Right Justify",tc.ID_RIGHT_JUSTIFY,true,null,false);zj(a,"Justify Both",tc.ID_JUSTIFY,false,null,false);zj(a,"Double Space",tc.ID_DOUBLE_SPACE,false,null,false);Zj(a,false);zj(a,"Indent Left",tc.ID_LEFT_INDENT,false,null,false);zj(a,"Indent Right",tc.ID_RIGHT_INDENT,false,null,false);zj(a,"Hanging Indent",tc.ID_HANGING_INDENT,false,null,false);Zj(a,false);zj(a,"Keep Together",tc.ID_PARA_KEEP,false,null,false);zj(a,"Keep with Next",tc.ID_PARA_KEEP_NEXT,false,null,false);zj(a,"Widow/Orphan Control",tc.ID_WIDOW_ORPHAN,false,null,false);zj(a,"Page Break Before",tc.ID_PAGE_BREAK_BEFORE,false,null,false);Zj(a,false);zj(a,"Border and Shading...",tc.ID_PARA_BORDER,false,null,false);zj(a,"Paragraph Spacing...",tc.ID_PARA_SPACING,false,null,false);zj(a,"Background Color...",tc.ID_PARA_BK_COLOR,false,null,false);Zj(a,false);zj(a,"Bullet",tc.ID_BULLET,false,null,false);zj(a,"Numbering",tc.ID_PARA_NBR,false,null,false);zj(a,"Increase Level",tc.ID_LIST_LEVEL_INC,false,null,false);zj(a,"Decrease Level",tc.ID_LIST_LEVEL_DEC,false,null,false);zj(a,"List Numbering...",tc.ID_PARA_LIST,false,null,false);Zj(a,false);zj(a,"Set Tab...",tc.ID_TAB_SET,false,null,false);zj(a,"Clear Tab...",tc.ID_TAB_CLEAR,false,null,false);zj(a,"Clear All Tabs",tc.ID_TAB_CLEAR_ALL,false,null,false);Zj(a,false);zj(a,"Style...",tc.ID_PARA_STYLE,false,null,false);zj(a,"Text Flow...",tc.ID_PARA_RTL,false,null,false)}if(ui[t].cid>0&&(a=jj(n,"Table",true))!=null){zj(a,"Insert &Table...",tc.ID_TABLE_INSERT,false,null,false);Zj(a,false);zj(a,"&Insert Row",tc.ID_TABLE_INSERT_ROW,false,null,false);zj(a,"Insert Column",tc.ID_TABLE_INSERT_COL,false,null,false);zj(a,"&Merge Cells",tc.ID_TABLE_MERGE_CELLS,false,null,false);zj(a,"&Split Cell Horizontally",tc.ID_TABLE_SPLIT_CELL,false,null,false);zj(a,"Split Cell Vertically",tc.ID_TABLE_SPLIT_CELL_VERT,false,null,false);zj(a,"Split Table",tc.ID_TABLE_SPLIT,false,null,false);zj(a,"&Delete Cells...",tc.ID_TABLE_DEL_CELLS,false,null,false);Zj(a,false);zj(a,"&Row Position...",tc.ID_TABLE_ROW_POS,false,null,false);zj(a,"Row &Height...",tc.ID_TABLE_ROW_HEIGHT,false,null,false);zj(a,"&Header Row",tc.ID_TABLE_HDR_ROW,false,null,false);zj(a,"&Keep Row Together",tc.ID_TABLE_ROW_KEEP,false,null,false);zj(a,"Row Text &Flow...",tc.ID_TABLE_ROW_RTL,false,null,false);Zj(a,false);zj(a,"Cell &Width...",tc.ID_TABLE_CELL_WIDTH,false,null,false);zj(a,"Cell &Border Width...",tc.ID_TABLE_CELL_BORDER,false,null,false);zj(a,"Cell &Border Color...",tc.ID_TABLE_CELL_BORDER_COLOR,false,null,false);zj(a,"Cell S&hading...",tc.ID_TABLE_CELL_SHADE,false,null,false);zj(a,"Cell &Color...",tc.ID_TABLE_CELL_COLOR,false,null,false);zj(a,"Cell Vertical Align...",tc.ID_TABLE_CELL_VALIGN,false,null,false);zj(a,"Cell Rotate Text...",tc.ID_TABLE_CELL_VTEXT,false,null,false);Zj(a,false);zj(a,"Select Current Column",tc.ID_TABLE_SEL_COL,false,null,false);zj(a,"Show &Gridlines",tc.ID_TABLE_SHOW_GRID,false,null,false)}Zj(n,true);if(_i.TerMenuEnable2(tc.ID_EDIT_INPUT_FIELD))zj(n,"Edit Input Field...",tc.ID_EDIT_INPUT_FIELD,false,null,true);if(ui[t].fid>0&&(a=jj(n,"Edit Frame/Drawing Object",true))!=null){zj(a,"Edit Drawing Object...",tc.ID_EDIT_DOB,false,null,false);zj(a,"Vertical Base Position...",tc.ID_FRAME_YBASE,false,null,false);zj(a,"Rotate Text...",tc.ID_FRAME_ROTATE_TEXT,false,null,false)}if(Nc[l].BltId>0&&(a=jj(n,"List and Overrides",true))!=null){zj(a,"Create List Item...",tc.ID_CREATE_LIST,false,null,false);zj(a,"Edit List Item...",tc.ID_EDIT_LIST,false,null,false);Zj(a,false);zj(a,"Create List Override...",tc.ID_CREATE_LIST_OR,false,null,false);zj(a,"Edit List Override...",tc.ID_EDIT_LIST_OR,false,null,false);Zj(a,false);zj(a,"Edit List Level...",tc.ID_EDIT_LIST_LEVEL,false,null,false)}if((a=jj(n,"Track Changes",true))!=null){zj(a,"Enable Tracking",tc.ID_TRACK_CHANGES,false,null,false);zj(a,"Find Next Change\tCtrl+N",tc.ID_NEXT_CHANGE,false,null,false);zj(a,"Find Prev Change\tCtrl+P",tc.ID_PREV_CHANGE,false,null,false);Zj(a,false);zj(a,"Accept Change",tc.ID_ACCEPT_CHANGE,false,null,false);zj(a,"Accept All Changes...",tc.ID_ACCEPT_ALL_CHANGES,false,null,false);Zj(a,false);zj(a,"Reject Change",tc.ID_REJECT_CHANGE,false,null,false);zj(a,"Reject All Changes...",tc.ID_REJECT_ALL_CHANGES,false,null,false);Zj(a,false);zj(a,"Hide Changes",tc.ID_HIDE_CHANGES,false,null,false)}if(_i.TerMenuEnable2(tc.ID_APPLY_COMMENT))zj(n,"Apply Comment...",tc.ID_APPLY_COMMENT,false,null,true);Zj(n,true);if(_i.TerMenuEnable2(tc.ID_PRINT))zj(n,"Print...\tF4",tc.ID_PRINT,false,null,true);zj(n,"Print Preview",tc.ID_PRINT_PREVIEW,false,null,true)}_i.TerTextPosToPix(tc.REL_WINDOW,t,e);r=Ga;i=ed+_i.TerScrLineHeight(t);xj(r,i,n.item,-1);rv=iv;return true};_i.TerBuildMenu=function(){var t=[];var e=Vj(t,"&File",tc.MENU_FILE);mj(e,tc.MENU_FILE,false,false);var r=Vj(t,"&Edit",tc.MENU_EDIT);mj(r,tc.MENU_EDIT,false,false);var i=Vj(t,"&View",tc.MENU_VIEW);mj(i,tc.MENU_VIEW,false,false);var f=Vj(t,"&Insert",tc.MENU_INSERT);mj(f,tc.MENU_INSERT,false,false);var l=Vj(t,"&Font",tc.MENU_FONT);mj(l,tc.MENU_FONT,false,false);var a=Vj(t,"&Paragraph",tc.MENU_PARAGRAPH);mj(a,tc.MENU_PARAGRAPH,false,false);var n=Vj(t,"&Table",tc.MENU_TABLE);mj(n,tc.MENU_TABLE,false,false);var c=Vj(t,"&Other",tc.MENU_OTHER);mj(c,tc.MENU_OTHER,false,false);HO=t;return t};function mj(t,e,r,i){if(e==tc.MENU_FILE){zj(t,"&New",tc.ID_NEW,false,null,i);zj(t,"&Open...",tc.ID_OPEN,false,null,i);zj(t,"&Save...",tc.ID_SAVE,false,null,i);zj(t,"Save&As...",tc.ID_SAVEAS,false,null,i);Zj(t,i);zj(t,"Page &Layout...",tc.ID_PAGE_OPTIONS,false,null,i);zj(t,"Print...\tF4",tc.ID_PRINT,false,null,i);zj(t,"Print Preview",tc.ID_PRINT_PREVIEW,false,null,i)}else if(e==tc.MENU_EDIT){zj(t,"Cut\tCtrl+X",tc.ID_CUT,false,null,i);zj(t,"Copy\tCtrl+C",tc.ID_COPY,false,null,i);zj(t,"Paste\tCtrl+V",tc.ID_PASTE,false,null,i);zj(t,"Paste Text",tc.ID_PASTE_TEXT,false,null,i);zj(t,"Paste Special...",tc.ID_PASTE_SPEC,false,null,i);Zj(t,i);zj(t,"Edit Picture...",tc.ID_EDIT_PICT,false,null,i);zj(t,"&Undo\tCtrl+Z",tc.ID_UNDO,false,null,i);zj(t,"&Redo\tCtrl+Y",tc.ID_REDO,false,null,i);Zj(t,i);zj(t,"Select All\tCtrl+A",tc.ID_SELECT_ALL,false,null,i);Zj(t,i);zj(t,"&Repaginate",tc.ID_REPAGINATE,false,null,i);zj(t,"&Edit Section...",tc.ID_SECT_OPTIONS,false,null,i);zj(t,"Edit Style...",tc.ID_EDIT_STYLE,false,null,i);zj(t,"Edit Input Field...",tc.ID_EDIT_INPUT_FIELD,false,null,i);var f=jj(t,"Edit Frame/Drawing Object",i);if(f!=null){zj(f,"Edit Drawing Object...",tc.ID_EDIT_DOB,false,null,false);zj(f,"Vertical Base Position...",tc.ID_FRAME_YBASE,false,null,false);zj(f,"Rotate Text...",tc.ID_FRAME_ROTATE_TEXT,false,null,false)}var l=jj(t,"List and Overrides",i);if(l!=null){zj(l,"Create List Item...",tc.ID_CREATE_LIST,false,null,false);zj(l,"Edit List Item...",tc.ID_EDIT_LIST,false,null,false);Zj(l,false);zj(l,"Create List Override...",tc.ID_CREATE_LIST_OR,false,null,false);zj(l,"Edit List Override...",tc.ID_EDIT_LIST_OR,false,null,false);Zj(l,false);zj(l,"Edit List Level...",tc.ID_EDIT_LIST_LEVEL,false,null,false)}Zj(t,i);zj(t,"Edit Page Header/Footer",tc.ID_EDIT_HDR_FTR,false,null,i);var a=jj(t,"First Page Header/Footer",i);if(a!=null){zj(a,"Create First Page Header",tc.ID_CREATE_FIRST_HDR,false,null,false);zj(a,"Create First Page Footer",tc.ID_CREATE_FIRST_FTR,false,null,false);Zj(a,false);zj(a,"Delete First Page Header",tc.ID_DELETE_FIRST_HDR,false,null,false);zj(a,"Delete First Page Footer",tc.ID_DELETE_FIRST_FTR,false,null,false)}var n=jj(t,"Left Page Header/Footer",i);if(n!=null){zj(n,"Create Left Page Header",tc.ID_CREATE_LEFT_HDR,false,null,false);zj(n,"Create Left Page Footer",tc.ID_CREATE_LEFT_FTR,false,null,false);Zj(n,false);zj(n,"Delete Left Page Header",tc.ID_DELETE_LEFT_HDR,false,null,false);zj(n,"Delete Left Page Footer",tc.ID_DELETE_LEFT_FTR,false,null,false)}var c=jj(t,"Right Page Header/Footer",i);if(c!=null){zj(c,"Create Right Page Header",tc.ID_CREATE_RIGHT_HDR,false,null,false);zj(c,"Create Right Page Footer",tc.ID_CREATE_RIGHT_FTR,false,null,false);Zj(c,false);zj(c,"Delete Right Page Header",tc.ID_DELETE_RIGHT_HDR,false,null,false);zj(c,"Delete Right Page Footer",tc.ID_DELETE_RIGHT_FTR,false,null,false)}Zj(t,i);var s=jj(t,"Edit Footnote/Endnote",i);if(s!=null){zj(s,"Edit Footnote Text",tc.ID_EDIT_FNOTE,false,null,false);zj(s,"Edit Endnote Text",tc.ID_EDIT_ENOTE,false,null,false)}var _=jj(t,"Track Changes",i);if(_!=null){zj(_,"Enable Tracking",tc.ID_TRACK_CHANGES,false,null,false);zj(_,"Find Next Change\tCtrl+N",tc.ID_NEXT_CHANGE,false,null,false);zj(_,"Find Prev Change\tCtrl+P",tc.ID_PREV_CHANGE,false,null,false);Zj(_,false);zj(_,"Accept Change",tc.ID_ACCEPT_CHANGE,false,null,false);zj(_,"Accept All Changes...",tc.ID_ACCEPT_ALL_CHANGES,false,null,false);Zj(_,false);zj(_,"Reject Change",tc.ID_REJECT_CHANGE,false,null,false);zj(_,"Reject All Changes...",tc.ID_REJECT_ALL_CHANGES,false,null,false);Zj(_,false);zj(_,"Hide Changes",tc.ID_HIDE_CHANGES,false,null,false)}Zj(t,i);zj(t,"Apply Comment...",tc.ID_APPLY_COMMENT,false,null,i);zj(t,"Virtual Keyboard",tc.ID_INLINE_IME,false,null,i);zj(t,"Touch Screen",tc.ID_HAS_TOUCH_SCREEN,false,null,i);zj(t,"Document Text Flow...",tc.ID_DOC_RTL,false,null,i)}else if(e==tc.MENU_VIEW){zj(t,"Page Layout Mode",tc.ID_SHOW_PAGE_BORDER,false,null,i);Zj(t,i);zj(t,"&Horizontal Ruler",tc.ID_RULER,false,null,i);zj(t,"&Vertical Ruler",tc.ID_VRULER,false,null,i);zj(t,"&Tool Bar",tc.ID_TOOL_BAR,false,null,i);zj(t,"&Status Ribbon",tc.ID_STATUS_RIBBON,false,null,i);zj(t,"&Paragraph &Marker",tc.ID_SHOW_PARA_MARK,false,null,i);Zj(t,i);zj(t,"&Hidden Text",tc.ID_SHOW_HIDDEN,false,null,i);zj(t,"&Field Names",tc.ID_SHOW_FIELD_NAMES,false,null,i);zj(t,"Hyper&link Cursor",tc.ID_SHOW_HYPERLINK_CURSOR,false,null,i);Zj(t,i);zj(t,"Page Header/&Footer",tc.ID_VIEW_HDR_FTR,false,null,i);Zj(t,i);zj(t,"Zoom...",tc.ID_ZOOM,false,null,i)}else if(e==tc.MENU_INSERT){var o=jj(t,"Insert Break",i);if(o!=null){zj(o,"&Page Break\tCtrl+Enter",tc.ID_PAGE_BREAK,false,null,false);zj(o,"&Section Break",tc.ID_SECT_BREAK,false,null,false);zj(o,"&Column Break",tc.ID_COL_BREAK,false,null,false)}Zj(t,i);zj(t,"Embed Picture...",tc.ID_EMBED_PICT,false,null,i);zj(t,"Link Picture...",tc.ID_LINK_PICT,false,null,i);Zj(t,i);zj(t,"Frame",tc.ID_INSERT_PARA_FRAME,false,null,i);zj(t,"Drawing Objects...",tc.ID_INSERT_DRAW_OBJECT,false,null,i);Zj(t,i);zj(t,"Page Number",tc.ID_INSERT_PAGE_NUMBER,false,null,i);zj(t,"Page Count",tc.ID_INSERT_PAGE_COUNT,false,null,i);zj(t,"Date and Time...",tc.ID_INSERT_DATE_TIME,false,null,i);var u=jj(t,"Footnote/Endnote",i);if(u!=null){zj(u,"Footnote...",tc.ID_INSERT_FNOTE,false,null,false);zj(u,"Endnote...",tc.ID_INSERT_ENOTE,false,null,false)}zj(t,"Bookmark...",tc.ID_INSERT_BOOKMARK,false,null,i);zj(t,"Table of Contents",tc.ID_INSERT_TOC,false,null,i);Zj(t,i);zj(t,"Data Field...",tc.ID_INSERT_DATA_FIELD,false,null,i);zj(t,"Text Input Field...",tc.ID_INSERT_INPUT_FIELD,false,null,i);zj(t,"CheckBox Field...",tc.ID_INSERT_CHECKBOX,false,null,i);zj(t,"Selection Field...",tc.ID_INSERT_COMBOBOX,false,null,i);zj(t,"Hyperlink...",tc.ID_INSERT_HLINK,false,null,i);Zj(t,i);zj(t,"Non-breaking Space",tc.ID_INSERT_NBSPACE,false,null,i);zj(t,"Non-breaking Dash",tc.ID_INSERT_NBDASH,false,null,i);zj(t,"Optional Hyphen",tc.ID_INSERT_HYPH,false,null,i)}else if(e==tc.MENU_FONT){zj(t,"Normal",tc.ID_CHAR_NORMAL,false,null,i);Zj(t,i);zj(t,"Bold",tc.ID_BOLD_ON,false,null,i);zj(t,"Underline",tc.ID_ULINE_ON,false,null,i);zj(t,"Double Underline",tc.ID_ULINED_ON,false,null,i);zj(t,"Italic",tc.ID_ITALIC_ON,false,null,i);zj(t,"Superscript",tc.ID_SUPSCR_ON,false,null,i);zj(t,"Subscript",tc.ID_SUBSCR_ON,false,null,i);zj(t,"Strike",tc.ID_STRIKE_ON,false,null,i);zj(t,"Double Strike",tc.ID_DOUBLE_STRIKE_ON,false,null,i);zj(t,"All Caps",tc.ID_CAPS_ON,false,null,i);zj(t,"Small Caps",tc.ID_SCAPS_ON,false,null,i);Zj(t,i);zj(t,"Fonts...",tc.ID_FONTS,false,null,i);zj(t,"Style...",tc.ID_CHAR_STYLE,false,null,i);Zj(t,i);zj(t,"Text Color...",tc.ID_COLOR,true,null,i);zj(t,"Background Color...",tc.ID_BK_COLOR,true,null,i);zj(t,"Underline Color...",tc.ID_ULINE_COLOR,true,null,i);zj(t,"Highlight Color...",tc.ID_HILIGHT_TEXT,true,null,i);Zj(t,i);zj(t,"Spacing...",tc.ID_CHAR_SPACE,true,null,i);zj(t,"Horizontal Scaling...",tc.ID_CHAR_SCALEX,true,null,i);zj(t,"Hidden",tc.ID_HIDDEN_ON,true,null,i);zj(t,"Boxed",tc.ID_BOX_ON,true,null,i);zj(t,"Protect",tc.ID_PROTECT_ON,true,null,i)}else if(e==tc.MENU_PARAGRAPH){zj(t,"Normal",tc.ID_PARA_NORMAL,false,null,i);Zj(t,i);zj(t,"Center",tc.ID_CENTER,true,null,i);zj(t,"Right Justify",tc.ID_RIGHT_JUSTIFY,true,null,i);zj(t,"Justify Both",tc.ID_JUSTIFY,false,null,i);zj(t,"Double Space",tc.ID_DOUBLE_SPACE,false,null,i);Zj(t,i);zj(t,"Indent Left",tc.ID_LEFT_INDENT,false,null,i);zj(t,"Indent Right",tc.ID_RIGHT_INDENT,false,null,i);zj(t,"Hanging Indent",tc.ID_HANGING_INDENT,false,null,i);Zj(t,i);zj(t,"Keep Together",tc.ID_PARA_KEEP,false,null,i);zj(t,"Keep with Next",tc.ID_PARA_KEEP_NEXT,false,null,i);zj(t,"Widow/Orphan Control",tc.ID_WIDOW_ORPHAN,false,null,i);zj(t,"Page Break Before",tc.ID_PAGE_BREAK_BEFORE,false,null,i);Zj(t,i);zj(t,"Border and Shading...",tc.ID_PARA_BORDER,false,null,i);zj(t,"Paragraph Spacing...",tc.ID_PARA_SPACING,false,null,i);zj(t,"Background Color...",tc.ID_PARA_BK_COLOR,false,null,i);Zj(t,i);zj(t,"Bullet",tc.ID_BULLET,false,null,i);zj(t,"Numbering",tc.ID_PARA_NBR,false,null,i);zj(t,"Increase Level",tc.ID_LIST_LEVEL_INC,false,null,i);zj(t,"Decrease Level",tc.ID_LIST_LEVEL_DEC,false,null,i);zj(t,"List Numbering...",tc.ID_PARA_LIST,false,null,i);Zj(t,i);zj(t,"Set Tab...",tc.ID_TAB_SET,false,null,i);zj(t,"Clear Tab...",tc.ID_TAB_CLEAR,false,null,i);zj(t,"Clear All Tabs",tc.ID_TAB_CLEAR_ALL,false,null,i);Zj(t,i);zj(t,"Style...",tc.ID_PARA_STYLE,false,null,i);zj(t,"Text Flow...",tc.ID_PARA_RTL,false,null,i)}else if(e==tc.MENU_TABLE){zj(t,"Insert &Table...",tc.ID_TABLE_INSERT,false,null,i);Zj(t,i);zj(t,"&Insert Row",tc.ID_TABLE_INSERT_ROW,false,null,i);zj(t,"Insert Column",tc.ID_TABLE_INSERT_COL,false,null,i);zj(t,"&Merge Cells",tc.ID_TABLE_MERGE_CELLS,false,null,i);zj(t,"&Split Cells Horizontally",tc.ID_TABLE_SPLIT_CELL,false,null,i);zj(t,"Split Cells &Vertically",tc.ID_TABLE_SPLIT_CELL_VERT,false,null,i);zj(t,"Split Table",tc.ID_TABLE_SPLIT,false,null,i);zj(t,"&Delete Cells...",tc.ID_TABLE_DEL_CELLS,false,null,i);Zj(t,i);zj(t,"&Row Position...",tc.ID_TABLE_ROW_POS,false,null,i);zj(t,"Row &Height...",tc.ID_TABLE_ROW_HEIGHT,false,null,i);zj(t,"&Header Row",tc.ID_TABLE_HDR_ROW,false,null,i);zj(t,"&Keep Row Together",tc.ID_TABLE_ROW_KEEP,false,null,i);zj(t,"Row Text &Flow...",tc.ID_TABLE_ROW_RTL,false,null,i);Zj(t,i);zj(t,"Cell &Width...",tc.ID_TABLE_CELL_WIDTH,false,null,i);zj(t,"Cell &Border Width...",tc.ID_TABLE_CELL_BORDER,false,null,i);zj(t,"Cell &Border Color...",tc.ID_TABLE_CELL_BORDER_COLOR,false,null,i);zj(t,"Cell S&hading...",tc.ID_TABLE_CELL_SHADE,false,null,i);zj(t,"Cell &Color...",tc.ID_TABLE_CELL_COLOR,false,null,i);zj(t,"Cell Vertical Align...",tc.ID_TABLE_CELL_VALIGN,false,null,i);zj(t,"Cell Rotate Text...",tc.ID_TABLE_CELL_VTEXT,false,null,i);Zj(t,i);zj(t,"Select Current Column",tc.ID_TABLE_SEL_COL,false,null,i);zj(t,"Show &Gridlines",tc.ID_TABLE_SHOW_GRID,false,null,i)}else if(e==tc.MENU_OTHER){zj(t,"&Search...\tCtrl+F",tc.ID_SEARCH,false,null,i);zj(t,"Search &Forward\tF3",tc.ID_SEARCH_FOR,false,null,i);zj(t,"Search &Backward\tCtrl+F3",tc.ID_SEARCH_BACK,false,null,i);zj(t,"&Replace...\tCtrl+H",tc.ID_REPLACE,false,null,i);Zj(t,i);zj(t,"&Jump...\tF10",tc.ID_JUMP,false,null,i);zj(t,"&Protection Lock",tc.ID_PROTECTION_LOCK,false,null,i);zj(t,"Protect Form",tc.ID_PROTECT_FORM,false,null,i);zj(t,"Snap to &Grid",tc.ID_SNAP_TO_GRID,false,null,i);zj(t,"Background Picture...",tc.ID_BKND_PICT,false,null,i);zj(t,"Watermark Picture...",tc.ID_WATERMARK,false,null,i);if(!tg.StSearched)c4();if(tg.stj!=null){Zj(t,i);zj(t,"Auto Spell",tc.ID_AUTO_SPELL,false,null,i)}}else return false;return true}_i.TerAddToolbarMenuItem=function(t,e,r){if(wO==null){wO=new tc.JMenuItem;wO.IsToolbarMenu=true}if(t==null)t=wO;if(r==null)r="";if(r!="")r=nk(r);if(e==0)Zj(t,false);else if(e==-1)return jj(t,r,false);else if(e==-2)t=wO=null;else zj(t,r,e,false,null,false);return t};_i.TerShowToolbarMenu=function(){var t;if(wO==null||wO.item.length==0)return false;iv=rv;rv=null;var e=wO.item;var r=wO.item.length;var i=0;for(t=0;t<e.length;t++)if(e[t].width>i)i=e[t].width;if(i<Nt*1.5)i=Nt*1.5;else if(i<Nt*2.5)i=Nt*2.5;var f=_i.cvs.width-i-Y;var l=rt.top;rv=iv;xj(f,l,e,-1,true);rv=iv};function wj(t,e){var r=kj(t,e);if(r<0)return bj(t,e);mO[0]=xj(HO[r].x,yO,HO[r].item,0);return true}function bj(t,e){var r,i,f=-1;if(bO==0)return false;for(i=0;i<bO;i++){f=Xj(i,t,e);if(f>=0)break}if(i==bO||f<0){if(bO>0){yj(0);Yj()}return false}var l=mO[i].item;if(l[f].IsSepLine||l[f].HasSubMenu)return true;yj(0);Yj();_i.TerSetFocus();if(l[f].CmdId>0){_i.TerCommand(l[f].CmdId);_i.ForgetMouseUp=true}}function xj(t,e,r,i,f){var l,a,n=0;var c=0;var s=false;if(f==undefined)f=false;if(i<0){s=true;i=0}var _=tc.GetElementPosition(_i.cvs,false);a=r.length;for(l=0;l<a;l++){if(r[l].width>n)n=r[l].width;c+=r[l].height}if(f&&n<Nt*1.5)n=Nt*1.5;else if(i==0&&n<Nt*2.5)n=Nt*2.5;if(i+1==bO){if(mO[i].x==t&&mO[i].y==e&&mO[i].width==n&&mO[i].height==c)return mO[i]}if(bO>0)yj(i);var o=document.createElement("div");o.style.position="absolute";o.style.width=zV(n)+"px";o.style.height=zV(c)+"px";o.style.backgroundColor="#000";o.style.border="solid 1px #b0b0b0";o.style.boxShadow="5px 5px 5px #888888";o.style.zIndex="2000";o.style.left=zV(t)+_.x+"px";o.style.top=zV(e)+_.y+"px";var u=document.createElement("canvas");u.width=n;u.height=c;u.style.width=zV(n)+"px";u.style.height=zV(c)+"px";o.appendChild(u);u.addEventListener("mousemove",function(t){var e=t.offsetX;var r=t.offsetY;var i=tc.GetElementPosition(o);var f=tc.GetElementPosition(_i.cvs);e=e+i.x-f.x;r=r+i.y-f.y;Uj(e,r)});u.addEventListener("click",function(t){var e=t.offsetX;var r=t.offsetY;var i=tc.GetElementPosition(o);var f=tc.GetElementPosition(_i.cvs);e=e+i.x-f.x;r=r+i.y-f.y;wj(e,r)});for(l=0;l<r.length;l++){if(r[l].CmdId>0){r[l].IsGrayed=!_i.TerMenuEnable2(r[l].CmdId);r[l].IsChecked=_i.TerMenuSelect2(r[l].CmdId)}r[l].MouseOver=false}var T=new tc.ClsSubMenu;T.x=zV(t)+_.x;T.y=zV(e)+_.y;T.width=zV(n);T.height=zV(c);T.level=i;T.item=r;T.IsContextMenu=s;T.MouseEntered=false;T.div=o;T.canvas=u;T.gr=u.getContext("2d");mO[i]=T;if(i+1>bO)bO=i+1;Wj(i);var A=document.body||document.documentElement;A.appendChild(o);return T}function yj(t){var e;var r=document.body||document.documentElement;for(e=t;e<bO;e++){var i=mO[e].div;i.removeChild(mO[e].canvas);mO[e].canvas=null;mO[e].gr=0;r.removeChild(i)}bO=t;return true}function Wj(t){var e=mO[t].gr;var r=JV(mO[t].width);var i=JV(mO[t].height);var f=mO[t].item;var l,a=f.length;var n=e.fillStyle;var c=cA==null?WO:cA;e.fillStyle=c.toString();e.fillRect(0,0,r,i);var s=0;for(l=0;l<a;l++){var _=f[l].IsGrayed;var o=new tc.Brush(_?new tc.Color(11579568):new tc.Color(4210752));if(f[l].MouseOver&&!f[l].IsSepLine){c=new tc.Color(16750899);e.fillStyle=c.toString();e.fillRect(0,s,r,f[l].height);o=new tc.Brush(tc.CLR_WHITE)}if(f[l].IsSepLine){var u=s+f[l].height/2;var T=f[l].xmargin-5;_J(e,new tc.Pen(new tc.Color(11579568)),T,u,r-5,u)}else{sJ(e,f[l].title,O,o,new tc.Point(f[l].xmargin,s+f[l].ymargin));if(f[l].KeyText.length>0){sJ(e,f[l].KeyText,O,o,new tc.Point(r-f[l].xmargin-f[l].KeyTextWidth,s+f[l].ymargin))}if(f[l].HasSubMenu){var A=r-f[l].xmargin/4;var E=s+f[l].height/2;var R=JV(5);if(f[l].IsToolbarMenu){A-=R;_J(e,new tc.Pen(new tc.Color(11579568)),A,E,A+R,E-R);_J(e,new tc.Pen(new tc.Color(11579568)),A,E,A+R,E+R)}else{_J(e,new tc.Pen(new tc.Color(11579568)),A,E,A-R,E-R);_J(e,new tc.Pen(new tc.Color(11579568)),A,E,A-R,E+R)}}else if(f[l].IsChecked){var L=1;var C=s;var I=f[l].xmargin-JV(5);var d=f[l].height;if(l+1==f.length)d--;c=new tc.Color(16173200);e.fillStyle=c.toString();e.fillRect(L,C,I,d);var F=L+I/2-JV(2);var g=C+d*6/9;var P=JV(4),S=JV(7);var h=new tc.Pen(new tc.Color(3158064));_J(e,h,F,g,F-P,g-P);_J(e,h,F,g,F+S,g-S)}}s+=f[l].height}e.fillStyle=n;return true}function Uj(t,e){var r=-1;var i=-1;if(oi.ShowMenu&&JV(e)<yO){i=kj(t,e);for(r=0;r<HO.length;r++){if(HO[r].MouseOver)break}if(r>=HO.length)r=-1;if(i!=r){if(r>=0)HO[r].MouseOver=false;if(i>=0)HO[i].MouseOver=true;Kj();if(bO>0&&i>=0){yj(0);mO[0]=xj(HO[i].x,yO,HO[i].item,0)}}else if(i<0&&bO>0)yj(0);return i>=0}else if(bO>0){i=-1;r=-1;for(lvl=0;lvl<bO;lvl++){i=Xj(lvl,t,e);if(i>=0)break}if(lvl==bO){if(mO[0].IsContextMenu&&!mO[0].MouseEntered)return false;yj(0)}else{var f=mO[lvl].item;mO[lvl].MouseEntered=true;if(lvl+1<bO&&!f[i].HasSubMenu)yj(lvl+1);var l,a=f.length;for(l=0;l<a;l++)if(f[l].MouseOver)break;if(l<a)r=l;if(f[i].IsSepLine)i=r;if(i!=r){if(r>=0)f[r].MouseOver=false;if(i>=0)f[i].MouseOver=true;Wj(lvl)}if(i>=0&&f[i].HasSubMenu){var n=!f[i].IsToolbarMenu;var c=tc.GetElementPosition(_i.cvs);var s=mO[lvl].x-c.x;var _=mO[lvl].y-c.y+f[i].y;if(n)s+=mO[lvl].width;else{var o=0;a=f[i].item.length;for(l=0;l<a;l++)if(f[i].item[l].width>o)o=f[i].item[l].width;if(f[i].IsToolbarMenu){if(o<Nt*1.5)o=Nt*1.5;else if(o<Nt*2.5)o=Nt*2.5}s-=o}var u=f[i].item;xj(JV(s),_,u,lvl+1)}}}else{yj(0);Yj()}return false}function kj(t,e){t=JV(t);e=JV(e);for(i=0;i<HO.length;i++){if(WH(t,e,HO[i].x,0,HO[i].width,yO))return i}return-1}function Xj(t,e,r){var f=mO[t].item;var l=tc.GetElementPosition(_i.cvs);e+=l.x;r+=l.y;e-=mO[t].x;r-=mO[t].y;e=JV(e);r=JV(r);for(i=0;i<f.length;i++){if(WH(e,r,0,f[i].y,JV(mO[t].width),f[i].height))return i}return-1}function Kj(){var t;var e=Ti;var r=Ft-rt.left;var i=Gt-rt.top;var f=e.fillStyle;var l=cA==null?WO:cA;e.fillStyle=l.toString();e.fillRect(r,i,_i.cvs.width,yO+(oi.ToolBar?1:0));var a=i+(xO-ht)/2;for(t=0;t<HO.length;t++){var n=r+HO[t].x;var c=n+HO[t].margin;var s=new tc.Brush(tc.CLR_BLACK);if(HO[t].MouseOver){l=new tc.Color(16750899);e.fillStyle=l.toString();e.fillRect(n,i,HO[t].width,xO);s=new tc.Brush(tc.CLR_WHITE)}sJ(e,HO[t].title,O,s,new tc.Point(c,a))}e.fillStyle=f;return true}function Yj(){var t=false;if(!oi.ShowMenu)return true;for(i=0;i<HO.length;i++){if(HO[i].MouseOver){HO[i].MouseOver=false;t=true}}if(t)Kj()}function Vj(t,e,r){var i=tc.CHAR_SPACE;var f;if((f=e.indexOf("&"))>=0&&f<e.length-1){var l=Uk(e);i=l[f+1];if(f==0)e=cV(e,1);else e=cV(e,0,f)+cV(e,f+1)}if(dh[r]!=null)e=dh[r];else e=nk(e);var a=new tc.JMenu;a.title=e;a.id=r;a.MouseOver=false;a.margin=tg.MENU_MARGIN;a.width=2*a.margin+gJ(Ti,O,a.title);if(t.length==0)a.x=0;else{count=t.length;a.x=t[count-1].x+t[count-1].width}t.push(a);return a}function jj(t,e,r){if(arguments.length==2)return Jj(t,e);return zj(t,e,0,false,null,r)}function Jj(t,e){return zj(t,e,0,false,null,false)}_i.TerAddMenuItem=function(t,e,r){if(e=="-")Zj(t);else zj(t,e,r,false,null,false)};_i.TerAddCustomMenuItem=function(t,e,r){var i=HO[t];if(r==="-"){Zj(i,false)}else{zj(i,r,e,false,null,false)}};function zj(t,e,r,i,f,l){var a=gk(" ");var n;var c=null;if(r>=tc.ID_FIRST_COMMAND&&r<tc.ID_FIRST_COMMAND+tc.MAX_SPEED_KEYS){n=r-tc.ID_FIRST_COMMAND;if(Ih[n]!=null){e=Ih[n]}else e=nk(e)}else e=nk(e);if(nV(e,""))return null;if((n=e.indexOf("&"))>=0&&n<e.length-1){var s=Uk(e);a=s[n+1];if(n==0)e=cV(e,1);else e=cV(e,0,n)+cV(e,n+1)}var _="";n=e.indexOf("\t");if(n>0){_=e.substring(n+1);e=cV(e,0,n)}var o=new tc.JMenuItem(e);o.KeyText=_;o.CmdId=r;if(r==0)o.HasSubMenu=true;o.MouseOver=false;o.xmargin=tg.MENU_XMARGIN;o.width=2*o.xmargin+gJ(Ti,O,o.title);if(o.KeyText.length>0){o.KeyTextWidth=gJ(Ti,O,o.KeyText);o.width+=o.KeyTextWidth+50}o.ymargin=(yO-ht)/2;o.height=yO;if(e=="-"){o.height=10;o.IsSepLine=true}if(t!=null){if(t.item.length==0)o.y=0;else{count=t.item.length;o.y=t.item[count-1].y+t.item[count-1].height}t.item.push(o);o.IsToolbarMenu=t.IsToolbarMenu}uh++;return o}function Zj(t,e){if(uh>0)zj(t,"-",0,false,null,e);uh=0}function Qj(t){zj(t,"-",0,false,null,false)}function qj(t){zj(t,"-",0,false,null,false)}_i.TerSetMenuItemDesc=function(t,e){var r;if(t>=tc.ID_FIRST_COMMAND&&t<tc.ID_FIRST_COMMAND+tc.MAX_SPEED_KEYS){r=t-tc.ID_FIRST_COMMAND;Ih[r]=e;return true}else if(t>=tc.MENU_FILE&&t<=tc.MENU_HELP){dh[t]=e}return false};_i.TerCommand=function(t){return _i.TerCommand2(t,true)};_i.TerCommand2=function(t,e){if(!lv||!QD())_i.TerCreateControl();if(_i.TerMenuEnable(t)==tc.MF_ENABLED){$j(t)}return true};function $j(t){var e,r;var i;if(LS||pr||mT||!oi.open)return true;Qt=tc.WM_COMMAND;Zt=t;if(t!=0)Bf=Hf=false;if(Ru){if(t!=tc.ID_PGUP&&t!=tc.ID_PGDN&&t!=tc.ID_PRINT_PREVIEW)return true}if(br>=0&&br<Ri&&(rW(br)!=0||(ui[br].flags2&tc.LFLAG2_RTL)!=0))t=Zt=MX(t);if(DX(tc.WM_COMMAND,t,0))return true;e=!oi.ReadOnly;r=oi.WordWrap;qR=false;if(t!=tc.ID_RETURN&&t!=tc.ID_BACK_SPACE&&t!=tc.ID_SPACE)El=false;if((qh&tc.TFLAG4_UNDO_WINDOW_OVERFLOW)!=0)Xe=UN();Mr=true;t:{if(t>=tc.IDP_FIRST_POPUP&&t<=tc.IDP_LAST_POPUP){OX(t);break t}if(t>=tc.ID_FIRST_USER_CMD&&t<=tc.ID_LAST_USER_CMD){break t}if(RS){RS=false;break t}if(uA!=tc.HILIGHT_OFF&&(OA||Bh)&&!Ua){oV();break t}if(!zR&&sq())_q();if(!VR&&!Ru)nq(t);if(Ka)HB();if(t!=tc.ID_RETURN)ef=false;switch(t){case tc.ID_PGUP:mm(true);break;case tc.ID_PGDN:wm(true);break;case tc.ID_UP:Nm();break;case tc.ID_CTRL_UP:Dm();break;case tc.ID_DOWN:Mm();break;case tc.ID_CTRL_DOWN:Gm();break;case tc.ID_LEFT:Hm();break;case tc.ID_RIGHT:Bm();break;case tc.ID_RETURN:if(e||ww(true,false))lm();break;case tc.ID_TAB:case tc.ID_CTRL_TAB:am();break;case tc.ID_BACK_TAB:nm();break;case tc.ID_SPACE:if(e||ww(true,false))jH(tc.SPACE);break;case tc.ID_LINE_BEGIN:jm();break;case tc.ID_LINE_END:Jm();break;case tc.ID_FILE_BEGIN:zm();break;case tc.ID_FILE_END:Zm();break;case tc.ID_NEXT_WORD:Qm();break;case tc.ID_PREV_WORD:qm(true);break;case tc.ID_DEL_PREV_WORD:if(e)$m();break;case tc.ID_DEL_NEXT_WORD:if(e)tw();break;case tc.ID_NUM_TO_CHAR:if(e)qH();break;case tc.ID_DEL:if(e||ww(true,false))QH();break;case tc.ID_BACK_SPACE:if(e||ww(false,true))ZH();break;case tc.ID_COPY:JN(false,null,true);break;case tc.ID_CUT:if(e||ww(true,false))JN(true,null,true);break;case tc.ID_PASTE:if(_i.TerMenuEnable2(tc.ID_PASTE)&&(e||ww(false,false)))YN("",null);break;case tc.ID_PASTE_TEXT:if(e||ww(false,false))YN("text/plain",null);break;case tc.ID_PASTE_SPEC:if(e)QN();break;case tc.ID_PAINT_FORMAT:if(e)jN();break;case tc.ID_EDIT_PICT:if(e)lD();break;case tc.ID_APPLY_COMMENT:if(e)_i.TerApplyComment(true,"","","",true);break;case tc.ID_SELECT_ALL:if(Nj(rO&tc.TFLAG8_DONT_SELECT_LAST_CHAR)){if(Ri>1||ui[0].len>1){uA=tc.HILIGHT_CHAR;sA=TA=0;_A=Ri-1;AA=ui[_A].len-1;if(AA<=0&&_A>0&&_A>sA){_A--;AA=ui[_A].len}OA=false;cG()}}else{uA=tc.HILIGHT_CHAR;sA=TA=0;_A=Ri-1;AA=ui[_A].len;OA=false;cG()}break;case tc.ID_PAGE_BREAK:if(e)_i.TerPageBreak(true);break;case tc.ID_COL_BREAK:if(e)_i.TerColBreak(true);break;case tc.ID_SECT_BREAK:if(e)_i.TerSectBreak(true);break;case tc.ID_EMBED_PICT:if(e)_i.TerInsertPictureFile(null,true,tc.ALIGN_BOT,true);break;case tc.ID_LINK_PICT:if(e)_i.TerInsertPictureFile(null,false,tc.ALIGN_BOT,true);break;case tc.ID_INSERT_PARA_FRAME:if(e)_i.TerInsertParaFrame(-1,-1,-1,-1,true);break;case tc.ID_INSERT_DRAW_OBJECT:if(e)_i.TerInsertDrawObject(-1,-1,-1,-1,-1);break;case tc.ID_INSERT_PAGE_NUMBER:if(e)_w(tc.FIELD_PAGE_NUMBER,vo);break;case tc.ID_INSERT_PAGE_COUNT:if(e)_w(tc.FIELD_PAGE_COUNT,vo);break;case tc.ID_INSERT_DATE_TIME:if(e)_i.TerInsertDate(null,true);break;case tc.ID_INSERT_TOC:if(e)_i.TerInsertToc(true);break;case tc.ID_INSERT_FNOTE:if(e)_i.TerInsertFootnote(null,null,0,true);break;case tc.ID_INSERT_ENOTE:if(e)_i.TerInsertFootnote2(null,null,0,false,true);break;case tc.ID_INSERT_BOOKMARK:if(e)_y();break;case tc.ID_INSERT_DATA_FIELD:if(e)_i.TerInsertField(null,null,true);break;case tc.ID_INSERT_INPUT_FIELD:if(e)_i.TerInsertTextInputField(null,null,0,true,null,0,0,tc.Color.black,true,true);break;case tc.ID_INSERT_CHECKBOX:if(e)_i.TerInsertCheckboxField(null,0,false,true,true);break;case tc.ID_INSERT_COMBOBOX:if(e)_i.TerInsertComboBoxField("","","",true,true);break;case tc.ID_INSERT_HLINK:if(e)cU();break;case tc.ID_INSERT_NBSPACE:if(e)jH(tc.NBSPACE_CHAR);break;case tc.ID_INSERT_NBDASH:if(e)jH(tc.NBDASH_CHAR);break;case tc.ID_INSERT_HYPH:if(e)jH(tc.HYPH_CHAR);break;case tc.ID_SEARCH:AK();break;case tc.ID_SEARCH_FOR:EK();break;case tc.ID_SEARCH_BACK:RK();break;case tc.ID_REPLACE:if(e)LK();break;case tc.ID_NEW:if(e)NU(null,"");break;case tc.ID_OPEN:DU();break;case tc.ID_SAVE:if(e||mh){if(ih.length>0)BU(ih,true);else MU(ih)}break;case tc.ID_SAVEAS:MU(ih);break;case tc.ID_QUIT:return true;case tc.ID_PRINT:_i.TerPrint(true);break;case tc.ID_PRINT_PREVIEW:G0(Ju);NX(tc.WM_COMMAND,t,0);return true;case tc.ID_PAGE_OPTIONS:k$();break;case tc.ID_PRINT_OPTIONS:X$();break;case tc.ID_CHAR_NORMAL:if(e){i=tc.BOLD|tc.ULINE|tc.ULINED|tc.ITALIC|tc.STRIKE|tc.DOUBLE_STRIKE|tc.SUPSCR|tc.SUBSCR;if(pE)i|=tc.HIDDEN;if(!IS)i|=tc.PROTECT;_i.SetTerCharStyle(i,false,true)}break;case tc.ID_BOLD_ON:if(NS)PY("bolding");if(e)_i.SetTerCharStyle(tc.BOLD,tc.MF_UNCHECKED==_i.TerMenuSelect(t),true);break;case tc.ID_ULINE_ON:if(e)_i.SetTerCharStyle(tc.ULINE,tc.MF_UNCHECKED==_i.TerMenuSelect(t),true);break;case tc.ID_ULINED_ON:if(e)_i.SetTerCharStyle(tc.ULINED,tc.MF_UNCHECKED==_i.TerMenuSelect(t),true);break;case tc.ID_ITALIC_ON:if(e)_i.SetTerCharStyle(tc.ITALIC,tc.MF_UNCHECKED==_i.TerMenuSelect(t),true);break;case tc.ID_STRIKE_ON:if(e)_i.SetTerCharStyle(tc.STRIKE,tc.MF_UNCHECKED==_i.TerMenuSelect(t),true);break;case tc.ID_DOUBLE_STRIKE_ON:if(e)_i.SetTerCharStyle(tc.DOUBLE_STRIKE,tc.MF_UNCHECKED==_i.TerMenuSelect(t),true);break;case tc.ID_SUPSCR_ON:if(e)_i.SetTerCharStyle(tc.SUPSCR,tc.MF_UNCHECKED==_i.TerMenuSelect(t),true);break;case tc.ID_SUBSCR_ON:if(e)_i.SetTerCharStyle(tc.SUBSCR,tc.MF_UNCHECKED==_i.TerMenuSelect(t),true);break;case tc.ID_CHAR_SPACE:if(e)_i.TerSetCharSpace(true,0,true);break;case tc.ID_CHAR_SCALEX:if(e)_i.TerSetCharScaleX(true,0,true);break;case tc.ID_HIDDEN_ON:if(e)_i.SetTerCharStyle(tc.HIDDEN,tc.MF_UNCHECKED==_i.TerMenuSelect(t),true);break;case tc.ID_BOX_ON:if(e)_i.SetTerCharStyle(tc.CHAR_BOX,tc.MF_UNCHECKED==_i.TerMenuSelect(t),true);break;case tc.ID_PROTECT_ON:if(e)_i.SetTerCharStyle(tc.PROTECT,tc.MF_UNCHECKED==_i.TerMenuSelect(t),true);break;case tc.ID_CAPS_ON:if(e)_i.SetTerCharStyle(tc.CAPS,tc.MF_UNCHECKED==_i.TerMenuSelect(t),true);break;case tc.ID_SCAPS_ON:if(e)_i.SetTerCharStyle(tc.SCAPS,tc.MF_UNCHECKED==_i.TerMenuSelect(t),true);break;case tc.ID_FONTS:if(e)Ax();break;case tc.ID_COLOR:if(e)ex(true);break;case tc.ID_BK_COLOR:if(e)ex(false);break;case tc.ID_ULINE_COLOR:if(e)_i.TerSetUlineColor(true,tc.CLR_AUTO,true);break;case tc.ID_HILIGHT_TEXT:if(e)_i.TerSetHilightColor(true,tc.CLR_AUTO,true,true);break;case tc.ID_RESET_CHAR_STYLES:if(e)hZ();break;case tc.ID_PARA_NORMAL:if(e)_i.ParaNormal(true);break;case tc.ID_CENTER:if(e)_i.SetTerParaFmt(tc.CENTER,tc.MF_UNCHECKED==_i.TerMenuSelect(tc.ID_CENTER),true);break;case tc.ID_LEFT_JUSTIFY:if(e)_i.SetTerParaFmt(tc.LEFT,tc.MF_UNCHECKED==_i.TerMenuSelect(tc.ID_LEFT_JUSTIFY),true);break;case tc.ID_RIGHT_JUSTIFY:if(e)_i.SetTerParaFmt(tc.RIGHT_JUSTIFY,tc.MF_UNCHECKED==_i.TerMenuSelect(tc.ID_RIGHT_JUSTIFY),true);break;case tc.ID_JUSTIFY:if(e)_i.SetTerParaFmt(tc.JUSTIFY,tc.MF_UNCHECKED==_i.TerMenuSelect(tc.ID_JUSTIFY),true);break;case tc.ID_DOUBLE_SPACE:if(e)_i.SetTerParaFmt(tc.DOUBLE_SPACE,tc.MF_UNCHECKED==_i.TerMenuSelect(tc.ID_DOUBLE_SPACE),true);break;case tc.ID_PARA_KEEP:if(e)_i.SetTerParaFmt(tc.PARA_KEEP,tc.MF_UNCHECKED==_i.TerMenuSelect(tc.ID_PARA_KEEP),true);break;case tc.ID_PARA_KEEP_NEXT:if(e)_i.SetTerParaFmt(tc.PARA_KEEP_NEXT,tc.MF_UNCHECKED==_i.TerMenuSelect(tc.ID_PARA_KEEP_NEXT),true);break;case tc.ID_WIDOW_ORPHAN:if(e)_i.TerSetPflags(tc.PFLAG_WIDOW,tc.MF_UNCHECKED==_i.TerMenuSelect(tc.ID_WIDOW_ORPHAN),true);break;case tc.ID_PAGE_BREAK_BEFORE:if(e)_i.TerSetPflags(tc.PFLAG_PAGE_BREAK,tc.MF_UNCHECKED==_i.TerMenuSelect(tc.ID_PAGE_BREAK_BEFORE),true);break;case tc.ID_LEFT_INDENT:if(e)_i.ParaLeftIndent(true,true);break;case tc.ID_LEFT_INDENT_DEC:if(e)_i.ParaLeftIndent(false,true);break;case tc.ID_RIGHT_INDENT:if(e)_i.ParaRightIndent(true,true);break;case tc.ID_HANGING_INDENT:if(e)_i.ParaHangingIndent(true,true);break;case tc.ID_PARA_BORDER:if(e)LZ();break;case tc.ID_PARA_SPACING:if(e)FZ();break;case tc.ID_BULLET:if(e){if(_i.TerMenuSelect2(tc.ID_PARA_NBR))_i.TerSetListBullet(false,tc.LIST_DEC,-1,1,"",".",false);_i.TerSetListBullet(tc.MF_UNCHECKED==_i.TerMenuSelect(tc.ID_BULLET),tc.LIST_BLT,-1,1,"","",true)}break;case tc.ID_BULLET_DROPDOWN:if(e)uN();break;case tc.ID_PARA_NBR:if(e){if(_i.TerMenuSelect2(tc.ID_BULLET))_i.TerSetListBullet(false,tc.LIST_BLT,-1,1,"","",false);if(Yc!=null&&Yc[0]!=null&&Yc[0].txt!=null){var f="";f=oQ(Yc[0].txt);_i.TerSetListBullet2(tc.MF_UNCHECKED==_i.TerMenuSelect(tc.ID_PARA_NBR),Yc[0].NumType,-1,1,"","",f,true)}else _i.TerSetListBullet(tc.MF_UNCHECKED==_i.TerMenuSelect(tc.ID_PARA_NBR),tc.LIST_DEC,-1,1,"",".",true)}break;case tc.ID_LIST_LEVEL_INC:if(e)_i.TerSetListLevel(-1,1,true);break;case tc.ID_LIST_LEVEL_DEC:if(e)_i.TerSetListLevel(-1,-1,true);break;case tc.ID_PARA_LIST:if(e)_i.TerSetParaList(true,-1,0,0,true);break;case tc.ID_PARA_BK_COLOR:if(e)_i.TerSetParaBkColor(true,tc.Color.white,true);break;case tc.ID_PARA_RTL:if(e)_i.TerSetParaTextFlow(true,0,true);break;case tc.ID_PARA_RTL_KEY:if(e)_i.TerSetParaTextFlow(false,tc.FLOW_RTL,true);break;case tc.ID_PARA_LTR_KEY:if(e)_i.TerSetParaTextFlow(false,tc.FLOW_LTR,true);break;case tc.ID_EDIT_STYLE:if(e)_i.TerEditStyle(true,null,true,0,true);break;case tc.ID_CHAR_STYLE:if(e)_i.TerSelectCharStyle(-1,true);break;case tc.ID_PARA_STYLE:if(e)_i.TerSelectParaStyle(-1,true);break;case tc.ID_CREATE_LIST:if(e)_i.TerEditList(true,-1,true,null,true,0);break;case tc.ID_EDIT_LIST:if(e)_i.TerEditList(false,-1,true,null,false,0);break;case tc.ID_CREATE_LIST_OR:if(e)_i.TerEditListOr(true,-1,true,1,true,0);break;case tc.ID_EDIT_LIST_OR:if(e)_i.TerEditListOr(false,-1,true,1,true,0);break;case tc.ID_EDIT_LIST_LEVEL:if(e)_i.TerEditListLevel(true,-1,0,1,0,0,"",0,0);break;case tc.ID_TABLE_INSERT:if(e)_i.TerCreateTable(-1,-1,true);break;case tc.ID_TABLE_INSERT_ROW:if(e)_i.TerInsertTableRow(true,true);break;case tc.ID_TABLE_SPLIT_CELL:if(e)$6();break;case tc.ID_TABLE_SPLIT_CELL_VERT:if(e)e8();break;case tc.ID_TABLE_SPLIT:if(e)t8();break;case tc.ID_TABLE_MERGE_CELLS:if(e)r8();break;case tc.ID_TABLE_DEL_CELLS:if(e)_i.TerDeleteCells(0,true);break;case tc.ID_TABLE_ROW_POS:if(e)_i.TerRowPosition(0,true,true);break;case tc.ID_TABLE_HDR_ROW:if(e)_i.TerSetHdrRow(0,tc.MF_UNCHECKED==_i.TerMenuSelect(tc.ID_TABLE_HDR_ROW),true);break;case tc.ID_TABLE_ROW_KEEP:if(e)_i.TerSetRowKeep(0,tc.MF_UNCHECKED==_i.TerMenuSelect(tc.ID_TABLE_ROW_KEEP),true);break;case tc.ID_TABLE_ROW_HEIGHT:if(e)_i.TerRowHeight(-1,true,true);break;case tc.ID_TABLE_INSERT_COL:if(e)_i.TerInsertTableCol(true,true,true);break;case tc.ID_TABLE_CELL_BORDER:if(e)_i.TerCellBorder(0,0,0,0,0,true);break;case tc.ID_TABLE_CELL_WIDTH:if(e)_i.TerCellWidth(0,0,0,true);break;case tc.ID_TABLE_CELL_BORDER_COLOR:if(e)_i.TerCellBorderColor(0,tc.Color.black,tc.Color.black,tc.Color.black,tc.Color.black,true);break;case tc.ID_TABLE_CELL_SHADE:if(e)_i.TerCellShading(0,0,true);break;case tc.ID_TABLE_CELL_COLOR:if(e)_i.TerCellColor(0,tc.Color.black,true);break;case tc.ID_TABLE_CELL_VALIGN:if(e)_i.TerCellVertAlign(0,0,true);break;case tc.ID_TABLE_CELL_VTEXT:if(e)_i.TerCellRotateText(0,0,true);break;case tc.ID_TABLE_SEL_COL:if(e)_i.TerSelectCol(true);break;case tc.ID_TABLE_SHOW_GRID:A8();break;case tc.ID_TABLE_ROW_RTL:if(e)_i.TerSetRowTextFlow(true,true,0,true);break;case tc.ID_TAB_SET:if(e)_i.SetTab(0,-1,true);break;case tc.ID_TAB_CLEAR:if(e)KZ();break;case tc.ID_TAB_CLEAR_ALL:if(e)_i.ClearAllTabs(true);break;case tc.ID_PAGE_MODE:Gz();break;case tc.ID_FITTED_VIEW:Bz();break;case tc.ID_VIEW_HDR_FTR:W5();break;case tc.ID_TOOL_BAR:Vp();break;case tc.ID_RULER:eX();break;case tc.ID_VRULER:rX();break;case tc.ID_STATUS_RIBBON:tX();break;case tc.ID_SHOW_FIELD_NAMES:Ow();break;case tc.ID_SHOW_HIDDEN:dX();break;case tc.ID_EDIT_FNOTE:Z5(true);break;case tc.ID_EDIT_ENOTE:Z5(false);break;case tc.ID_SHOW_PARA_MARK:iX();break;case tc.ID_SHOW_PAGE_BORDER:Hz();break;case tc.ID_SHOW_HYPERLINK_CURSOR:vh=!vh;break;case tc.ID_FRAME_YBASE:if(e)_i.TerSetFrameYBase(-1,0);break;case tc.ID_FRAME_ROTATE_TEXT:if(e)_i.TerRotateFrameText(true,br,0,true);break;case tc.ID_EDIT_DOB:if(e)_i.TerSetObjectAttrib(-1,0,0,tc.Color.black,true,tc.Color.black);break;case tc.ID_TER_HELP:if(tg.ResourceUrl!="")window.open(tg.ResourceUrl+"/ter_hlp.pdf");else window.open("ter_hlp.pdf");break;case tc.ID_UNDO:if(e)o9(true);break;case tc.ID_REDO:if(e)o9(false);break;case tc.ID_INSERT:if(e)$k();break;case tc.ID_JUMP:m$();break;case tc.ID_RESET:hp();break;case tc.ID_BKND_PICT:if(jh==0)_i.TerSetBkPictId(-1,tc.BKPICT_STRETCH,true);else _i.TerSetBkPictId(0,0,true);break;case tc.ID_WATERMARK:if($l<=0)_i.TerSetWatermarkPict(-1,true,true);else _i.TerSetWatermarkPict(0,true,true);break;case tc.ID_ZOOM:_i.TerSetZoom(-1);break;case tc.ID_REPAGINATE:yJ(false,false,0,true);cG();break;case tc.ID_INLINE_IME:if(e){_i.UseVirtKeyboard=!_i.UseVirtKeyboard;if(_i.UseVirtKeyboard)iM()}break;case tc.ID_HAS_TOUCH_SCREEN:_i.HasTouchScreen=!_i.HasTouchScreen;break;case tc.ID_TOOLBAR_MENU:_i.TerShowToolbarMenu();break;case tc.ID_MENU:oi.ShowMenu=!oi.ShowMenu;_i.TerRepaint(true);if(_i.TerMenuSelect2(tc.ID_TOOL_BAR))_i.TerRecreateToolbar(true);break;case tc.ID_DOC_RTL:if(e)_i.TerSetDocTextFlow(true,0,true);break;case tc.ID_SECT_OPTIONS:_i.TerSetSect(0,0,true);break;case tc.ID_PROTECTION_LOCK:if(e)IS=!IS;break;case tc.ID_TRACK_CHANGES:if(e)_i.TerEnableTracking(!Z_,null,true,0,tc.CLR_AUTO,0,tc.CLR_AUTO);break;case tc.ID_HIDE_CHANGES:M4();break;case tc.ID_NEXT_CHANGE:_i.TerFindNextChange(true,true);break;case tc.ID_PREV_CHANGE:_i.TerFindNextChange(false,true);break;case tc.ID_ACCEPT_CHANGE:if(e)_i.TerAcceptChanges(false,false,true);break;case tc.ID_ACCEPT_ALL_CHANGES:if(e)_i.TerAcceptChanges(true,true,true);break;case tc.ID_REJECT_CHANGE:if(e)_i.TerRejectChanges(false,false,true);break;case tc.ID_REJECT_ALL_CHANGES:if(e)_i.TerRejectChanges(true,true,true);break;case tc.ID_SNAP_TO_GRID:if(e)Gh=!Gh;break;case tc.ID_BORDER_MARGIN:oi.BorderMargin=!oi.BorderMargin;_i.TerRepaint(true);break;case tc.ID_PROTECT_FORM:mh=!mh;_i.TerSetReadOnly(mh);break;case tc.ID_EDIT_HDR_FTR:y5();break;case tc.ID_CREATE_FIRST_HDR:_i.TerCreateFirstHdrFtr(true);break;case tc.ID_CREATE_FIRST_FTR:_i.TerCreateFirstHdrFtr(false);break;case tc.ID_DELETE_FIRST_HDR:_i.TerDeleteFirstHdrFtr(true,true);break;case tc.ID_DELETE_FIRST_FTR:_i.TerDeleteFirstHdrFtr(false,true);break;case tc.ID_CREATE_LEFT_HDR:_i.TerCreateLeftRightHdrFtr(tc.LHDR_CHAR);break;case tc.ID_CREATE_LEFT_FTR:_i.TerCreateLeftRightHdrFtr(tc.LFTR_CHAR);break;case tc.ID_DELETE_LEFT_HDR:_i.TerDeleteHdrFtr(tc.LHDR_CHAR,true);break;case tc.ID_DELETE_LEFT_FTR:_i.TerDeleteHdrFtr(tc.LFTR_CHAR,true);break;case tc.ID_CREATE_RIGHT_HDR:_i.TerCreateLeftRightHdrFtr(tc.RHDR_CHAR);break;case tc.ID_CREATE_RIGHT_FTR:_i.TerCreateLeftRightHdrFtr(tc.RFTR_CHAR);break;case tc.ID_DELETE_RIGHT_HDR:_i.TerDeleteHdrFtr(tc.RHDR_CHAR,true);break;case tc.ID_DELETE_RIGHT_FTR:_i.TerDeleteHdrFtr(tc.RFTR_CHAR,true);break;case tc.ID_EDIT_INPUT_FIELD:xw();break;case tc.ID_SPELL:_i.TerSpellCheck(false,true);break;case tc.ID_AUTO_SPELL:if(kO!=null){if(Nj(qh&tc.TFLAG4_AUTO_SPELL))qh=_j(qh,tc.TFLAG4_AUTO_SPELL);else qh|=tc.TFLAG4_AUTO_SPELL;cG()}break;default:break}}var l=Mr;vX(tc.WM_COMMAND,t,0);Mr=l;NX(tc.WM_COMMAND,t,0);return true}_i.TerMenuEnable2=function(t){var e=_i.TerMenuEnable(t);return e==tc.MF_ENABLED?true:false};_i.TerCanEdit=function(){if(Ru)return false;var t=true;if(oi.ReadOnly||k_>=0)t=false;return t};_i.TerMenuEnable=function(t){var e=true,r,i,f;var l,a,n,c,s,_,o=0,u;var T=false,A,E,R=false,L,C,I;var d,F,g=0,P,S=0;var h=0,O=0;if(!oi.open)return tc.MF_GRAYED;if(Ru)return t==tc.ID_PRINT_PREVIEW||t==tc.ID_PGUP||t==tc.ID_PGDN?tc.MF_ENABLED:tc.MF_GRAYED;r=oi.ReadOnly;A=!r;if(!r&&(k_<0||W_[k_].type==tc.SSTYPE_PARA)&&oi.WordWrap)T=true;if(r||k_>=0)e=false;i=oi.WordWrap;l=G5(br);P=br;if(uA!=tc.HILIGHT_OFF)P=_A>=sA?_A:sA;c=ui[P].pfmt;s=ui[br].fid;_=ib(br,jt);if(AO!=null&&EO>=0){O=$w();if(Nj(xs[O].style&tc.PROTECT)){Oc=-1;O=$w()}}if(Nj(xs[_].style&tc.PICT)&&xs[_].FrameType!=tc.PFRAME_NONE)o=xs[_].ParaFID;if(s==0)s=o;f=!Lm(br,jt);E=f&&Nj(Zh&tc.TFLAG2_PROTECT_FORMAT);if(E)A=false;L=Cm(br,jt);C=Im(br,jt);I=dm(br,jt);for(a=1;a<Vc;a++)if(Kc[a].InUse)break;for(n=1;n<zc;n++)if(Jc[n].InUse)break;if(t==tc.ID_NEW)return e||Nj(lO&tc.TFLAG11_ALWAYS_ENABLE_NEW_CMD)?tc.MF_ENABLED:tc.MF_GRAYED;if(t==tc.ID_OPEN)return tc.MF_ENABLED;if(t==tc.ID_SAVE)return e||mh?tc.MF_ENABLED:tc.MF_GRAYED;if(t==tc.ID_SAVEAS)return tc.MF_ENABLED;if(t==tc.ID_PRINT)return Iu?tc.MF_ENABLED:tc.MF_GRAYED;if(t==tc.ID_PRINT_PREVIEW)return tc.MF_ENABLED;if(t==tc.ID_PRINT_OPTIONS)return Iu?tc.MF_ENABLED:tc.MF_GRAYED;if(t==tc.ID_PAGE_OPTIONS)return e?tc.MF_ENABLED:tc.MF_GRAYED;if(t==tc.ID_QUIT)return true?tc.MF_ENABLED:tc.MF_GRAYED;if(t==tc.ID_INS_AFT)return e&&!i&&!GE?tc.MF_ENABLED:tc.MF_GRAYED;if(t==tc.ID_INS_BEF)return e&&!i&&!GE?tc.MF_ENABLED:tc.MF_GRAYED;if(t==tc.ID_JOIN_LINE)return e&&!i&&!GE?tc.MF_ENABLED:tc.MF_GRAYED;if(t==tc.ID_SPLIT_LINE)return e&&!i&&!GE?tc.MF_ENABLED:tc.MF_GRAYED;if(t==tc.ID_DEL_LINE)return e&&!GE?tc.MF_ENABLED:tc.MF_GRAYED;if(t==tc.ID_NUM_TO_CHAR)return e&&!GE?tc.MF_ENABLED:tc.MF_GRAYED;if(t==tc.ID_SELECT_ALL)return tc.MF_ENABLED;if(t==tc.ID_UNDO)return e&&_E>0?tc.MF_ENABLED:tc.MF_GRAYED;if(t==tc.ID_REDO)return e&&oE>_E?tc.MF_ENABLED:tc.MF_GRAYED;if(t==tc.ID_INLINE_IME)return e?tc.MF_ENABLED:tc.MF_GRAYED;if(t==tc.ID_HAS_TOUCH_SCREEN)return tc.MF_ENABLED;if(t==tc.ID_DOC_RTL)return e?tc.MF_ENABLED:tc.MF_GRAYED;if(t==tc.ID_CUT)return e&&(uA==tc.HILIGHT_CHAR||uA==tc.HILIGHT_LINE)?tc.MF_ENABLED:tc.MF_GRAYED;if(t==tc.ID_COPY)return uA==tc.HILIGHT_CHAR||uA==tc.HILIGHT_LINE?tc.MF_ENABLED:tc.MF_GRAYED;if(t==tc.ID_PASTE||t==tc.ID_PASTE_TEXT||t==tc.ID_PASTE_SPEC)Np();if(t==tc.ID_PASTE)return(e||ww(false,false))&&!GE&&!f&&(tg.ClipDataText!=null&&tg.ClipDataText!=""||tg.ClipDataRtf!=null&&tg.ClipDataRtf!=""||window.clipboardData!=null)?tc.MF_ENABLED:tc.MF_GRAYED;if(t==tc.ID_PASTE_TEXT)return e&&!GE&&!f&&xJ(tc.CF_TEXT)?tc.MF_ENABLED:tc.MF_GRAYED;if(t==tc.ID_PASTE_SPEC){if(e&&oi.WordWrap&&!f&&!GE){if(xJ(tc.CF_TEXT)||xJ(xT))return tc.MF_ENABLED;else return tc.MF_GRAYED}else return tc.MF_GRAYED}if(t==tc.ID_PAINT_FORMAT)return e||ww(true,false)&&k_<0?tc.MF_ENABLED:tc.MF_GRAYED;if(t==tc.ID_EMBED_PICT)return e&&!GE?tc.MF_ENABLED:tc.MF_GRAYED;if(t==tc.ID_LINK_PICT)return e&&!GE?tc.MF_ENABLED:tc.MF_GRAYED;if(t==tc.ID_EDIT_PICT||t==tc.ID_EDIT_OLE){var v=ib(br,jt);var p=xs[v].ParaFID;var N=p>0&&Nj(kl[p].flags&tc.PARA_FRAME_LINE);if(t==tc.ID_EDIT_PICT)return e&&!N&&!GE&&Nj(xs[v].style&tc.PICT)?tc.MF_ENABLED:tc.MF_GRAYED;else return e&&!GE&&Nj(xs[v].style&tc.PICT)&&xs[v].ObjectType!=tc.OBJ_NONE&&Dj(zh&tc.TFLAG_NO_EDIT_OLE)?tc.MF_ENABLED:tc.MF_GRAYED}if(t==tc.ID_EDIT_INPUT_FIELD)return e&&(Hw(_,0)||xs[_].FieldId==tc.FIELD_TEXTBOX)?tc.MF_ENABLED:tc.MF_GRAYED;if(t==tc.ID_SECT_OPTIONS)return e?tc.MF_ENABLED:tc.MF_GRAYED;if(t==tc.ID_EDIT_STYLE)return!r?tc.MF_ENABLED:tc.MF_GRAYED;if(t==tc.ID_CREATE_LIST)return!r?tc.MF_ENABLED:tc.MF_GRAYED;if(t==tc.ID_EDIT_LIST)return!r&&a<Vc?tc.MF_ENABLED:tc.MF_GRAYED;if(t==tc.ID_CREATE_LIST_OR)return!r&&a<Vc?tc.MF_ENABLED:tc.MF_GRAYED;if(t==tc.ID_EDIT_LIST_OR)return!r&&n<zc?tc.MF_ENABLED:tc.MF_GRAYED;if(t==tc.ID_EDIT_LIST_LEVEL)return!r&&a<Vc?tc.MF_ENABLED:tc.MF_GRAYED;if(t==tc.ID_BLOCK_COPY)return e&&uA==tc.HILIGHT_LINE?tc.MF_ENABLED:tc.MF_GRAYED;if(t==tc.ID_BLOCK_MOVE)return e&&uA==tc.HILIGHT_LINE?tc.MF_ENABLED:tc.MF_GRAYED;if(t==tc.ID_BOLD_ON||t==tc.ID_ULINE_ON||t==tc.ID_ITALIC_ON){if(AO!=null&&EO>=0){O=$w();if(Nj(xs[O].style&tc.PROTECT)){Oc=-1;O=$w()}if(!Ry(t,xs[O].TypeFace))return tc.MF_GRAYED}}if(t==tc.ID_CHAR_NORMAL)return A?tc.MF_ENABLED:tc.MF_GRAYED;if(t==tc.ID_RESET_CHAR_STYLES)return A?tc.MF_ENABLED:tc.MF_GRAYED;if(t==tc.ID_BOLD_ON)return A?tc.MF_ENABLED:tc.MF_GRAYED;if(t==tc.ID_ULINE_ON)return A?tc.MF_ENABLED:tc.MF_GRAYED;if(t==tc.ID_ULINED_ON)return A?tc.MF_ENABLED:tc.MF_GRAYED;if(t==tc.ID_ITALIC_ON)return A?tc.MF_ENABLED:tc.MF_GRAYED;if(t==tc.ID_STRIKE_ON)return A?tc.MF_ENABLED:tc.MF_GRAYED;if(t==tc.ID_DOUBLE_STRIKE_ON)return A?tc.MF_ENABLED:tc.MF_GRAYED;if(t==tc.ID_SUPSCR_ON)return A?tc.MF_ENABLED:tc.MF_GRAYED;if(t==tc.ID_SUBSCR_ON)return A?tc.MF_ENABLED:tc.MF_GRAYED;if(t==tc.ID_PROTECT_ON)return!r&&!IS?tc.MF_ENABLED:tc.MF_GRAYED;if(t==tc.ID_COLOR)return A?tc.MF_ENABLED:tc.MF_GRAYED;if(t==tc.ID_ULINE_COLOR)return A?tc.MF_ENABLED:tc.MF_GRAYED;if(t==tc.ID_BK_COLOR)return A?tc.MF_ENABLED:tc.MF_GRAYED;if(t==tc.ID_HILIGHT_TEXT)return A?tc.MF_ENABLED:tc.MF_GRAYED;if(t==tc.ID_FONTS)return A?tc.MF_ENABLED:tc.MF_GRAYED;if(t==tc.ID_HIDDEN_ON)return A?tc.MF_ENABLED:tc.MF_GRAYED;if(t==tc.ID_CHAR_SPACE)return A?tc.MF_ENABLED:tc.MF_GRAYED;if(t==tc.ID_CHAR_SCALEX)return A?tc.MF_ENABLED:tc.MF_GRAYED;if(t==tc.ID_BOX_ON)return A&&k_<0?tc.MF_ENABLED:tc.MF_GRAYED;if(t==tc.ID_HLINK_ON)return A?tc.MF_ENABLED:tc.MF_GRAYED;if(t==tc.ID_CAPS_ON)return A?tc.MF_ENABLED:tc.MF_GRAYED;if(t==tc.ID_SCAPS_ON)return A?tc.MF_ENABLED:tc.MF_GRAYED;if(t==tc.ID_CHAR_STYLE)return!r&&!E&&k_<0?tc.MF_ENABLED:tc.MF_GRAYED;if(Y_){d=W_[k_].ParaFlags;F=W_[k_].BltId;u=W_[k_].LeftIndentTwips;if(W_[k_].FirstIndentTwips<0)u+=W_[k_].FirstIndentTwips}else{d=Nc[c].flags;F=Nc[c].BltId;u=Nc[c].LeftIndentTwips;if(Nc[c].FirstIndentTwips<0)u+=Nc[c].FirstIndentTwips}if(Nj(d&tc.BULLET)&&xc[F].ls>0){g=xc[F].ls}if(t==tc.ID_PARA_NORMAL)return T?tc.MF_ENABLED:tc.MF_GRAYED;if(t==tc.ID_DOUBLE_SPACE)return T?tc.MF_ENABLED:tc.MF_GRAYED;if(t==tc.ID_PARA_KEEP)return T?tc.MF_ENABLED:tc.MF_GRAYED;if(t==tc.ID_PARA_KEEP_NEXT)return T?tc.MF_ENABLED:tc.MF_GRAYED;if(t==tc.ID_WIDOW_ORPHAN)return T?tc.MF_ENABLED:tc.MF_GRAYED;if(t==tc.ID_PAGE_BREAK_BEFORE)return T?tc.MF_ENABLED:tc.MF_GRAYED;if(t==tc.ID_CENTER)return T?tc.MF_ENABLED:tc.MF_GRAYED;if(t==tc.ID_LEFT_JUSTIFY)return T?tc.MF_ENABLED:tc.MF_GRAYED;if(t==tc.ID_RIGHT_JUSTIFY)return T?tc.MF_ENABLED:tc.MF_GRAYED;if(t==tc.ID_JUSTIFY)return T?tc.MF_ENABLED:tc.MF_GRAYED;if(t==tc.ID_LEFT_INDENT)return T?tc.MF_ENABLED:tc.MF_GRAYED;if(t==tc.ID_LEFT_INDENT_DEC)return T&&u>0?tc.MF_ENABLED:tc.MF_GRAYED;if(t==tc.ID_RIGHT_INDENT)return T?tc.MF_ENABLED:tc.MF_GRAYED;if(t==tc.ID_HANGING_INDENT)return T?tc.MF_ENABLED:tc.MF_GRAYED;if(t==tc.ID_PARA_BORDER)return T?tc.MF_ENABLED:tc.MF_GRAYED;if(t==tc.ID_PARA_SPACING)return T?tc.MF_ENABLED:tc.MF_GRAYED;if(t==tc.ID_BULLET)return T?tc.MF_ENABLED:tc.MF_GRAYED;if(t==tc.ID_BULLET_DROPDOWN)return T&&uA==tc.HILIGHT_OFF?tc.MF_ENABLED:tc.MF_GRAYED;if(t==tc.ID_LIST_LEVEL_INC)return T&&g>0?tc.MF_ENABLED:tc.MF_GRAYED;if(t==tc.ID_LIST_LEVEL_DEC)return T&&g>0?tc.MF_ENABLED:tc.MF_GRAYED;if(t==tc.ID_PARA_NBR)return T?tc.MF_ENABLED:tc.MF_GRAYED;if(t==tc.ID_PARA_LIST)return T&&n<zc?tc.MF_ENABLED:tc.MF_GRAYED;if(t==tc.ID_PARA_BK_COLOR)return T?tc.MF_ENABLED:tc.MF_GRAYED;if(t==tc.ID_PARA_RTL)return T?tc.MF_ENABLED:tc.MF_GRAYED;if(t==tc.ID_PARA_RTL_KEY)return T?tc.MF_ENABLED:tc.MF_GRAYED;if(t==tc.ID_PARA_LTR_KEY)return T?tc.MF_ENABLED:tc.MF_GRAYED;if(t==tc.ID_PARA_STYLE)return!r&&k_<0?tc.MF_ENABLED:tc.MF_GRAYED;if(t==tc.ID_TAB_SET)return T?tc.MF_ENABLED:tc.MF_GRAYED;if(t==tc.ID_TAB_CLEAR){h=0;if(oi.WordWrap)h=Nc[ui[br].pfmt].TabId;return T&&B_[h].count>0?tc.MF_ENABLED:tc.MF_GRAYED}if(t==tc.ID_TAB_CLEAR_ALL){h=0;if(oi.WordWrap)h=Nc[ui[br].pfmt].TabId;return T&&B_[h].count>0?tc.MF_ENABLED:tc.MF_GRAYED}if(uA==tc.HILIGHT_CHAR&&(ui[sA].cid>0||ui[_A].cid>0))R=n6(ui[sA].cid,ui[_A].cid);else R=Nj(ui[br].cid);if(!e||!oi.PrintView)R=false;var D=0;if(R){var M=ui[br].cid;D=eR[M].row;S=$E[D].PrevRow}if(t==tc.ID_TABLE_INSERT)return e&&z4(br,jt)&&oi.PrintView?tc.MF_ENABLED:tc.MF_GRAYED;if(t==tc.ID_TABLE_INSERT_ROW)return R?tc.MF_ENABLED:tc.MF_GRAYED;if(t==tc.ID_TABLE_MERGE_CELLS)return R?tc.MF_ENABLED:tc.MF_GRAYED;if(t==tc.ID_TABLE_DEL_CELLS)return R?tc.MF_ENABLED:tc.MF_GRAYED;if(t==tc.ID_TABLE_SPLIT_CELL)return R&&uA==tc.HILIGHT_OFF?tc.MF_ENABLED:tc.MF_GRAYED;if(t==tc.ID_TABLE_SPLIT_CELL_VERT)return R&&uA==tc.HILIGHT_OFF?tc.MF_ENABLED:tc.MF_GRAYED;if(t==tc.ID_TABLE_SPLIT)return R&&$E[D].PrevRow>0&&uA==tc.HILIGHT_OFF?tc.MF_ENABLED:tc.MF_GRAYED;if(t==tc.ID_TABLE_ROW_POS)return R?tc.MF_ENABLED:tc.MF_GRAYED;if(t==tc.ID_TABLE_HDR_ROW)return R&&(S<=0||Nj($E[S].flags&tc.ROWFLAG_HDR))?tc.MF_ENABLED:tc.MF_GRAYED;if(t==tc.ID_TABLE_ROW_KEEP)return R?tc.MF_ENABLED:tc.MF_GRAYED;if(t==tc.ID_TABLE_ROW_HEIGHT)return R?tc.MF_ENABLED:tc.MF_GRAYED;if(t==tc.ID_TABLE_ROW_RTL)return R?tc.MF_ENABLED:tc.MF_GRAYED;if(t==tc.ID_TABLE_INSERT_COL)return R?tc.MF_ENABLED:tc.MF_GRAYED;if(t==tc.ID_TABLE_CELL_BORDER)return R?tc.MF_ENABLED:tc.MF_GRAYED;if(t==tc.ID_TABLE_CELL_BORDER_COLOR)return R?tc.MF_ENABLED:tc.MF_GRAYED;if(t==tc.ID_TABLE_CELL_WIDTH)return R?tc.MF_ENABLED:tc.MF_GRAYED;if(t==tc.ID_TABLE_CELL_SHADE)return R?tc.MF_ENABLED:tc.MF_GRAYED;if(t==tc.ID_TABLE_CELL_COLOR)return R?tc.MF_ENABLED:tc.MF_GRAYED;if(t==tc.ID_TABLE_CELL_VALIGN)return R?tc.MF_ENABLED:tc.MF_GRAYED;if(t==tc.ID_TABLE_CELL_VTEXT)return R?tc.MF_ENABLED:tc.MF_GRAYED;if(t==tc.ID_TABLE_SEL_COL)return e&&oi.PrintView&&uA==tc.HILIGHT_OFF&&ui[br].cid>0?tc.MF_ENABLED:tc.MF_GRAYED;if(t==tc.ID_TABLE_SHOW_GRID)return oi.PageMode?tc.MF_ENABLED:tc.MF_GRAYED;if(t==tc.ID_PAGE_MODE)return oi.PrintView?tc.MF_ENABLED:tc.MF_GRAYED;if(t==tc.ID_FITTED_VIEW)return oi.PrintView?tc.MF_ENABLED:tc.MF_GRAYED;if(t==tc.ID_VIEW_HDR_FTR)return oi.PrintView?tc.MF_ENABLED:tc.MF_GRAYED;if(t==tc.ID_SHOW_HIDDEN)return e?tc.MF_ENABLED:tc.MF_GRAYED;if(t==tc.ID_SHOW_FIELD_NAMES)return e?tc.MF_ENABLED:tc.MF_GRAYED;if(t==tc.ID_EDIT_FNOTE)return e&&!oi.FittedView?tc.MF_ENABLED:tc.MF_GRAYED;if(t==tc.ID_EDIT_ENOTE)return e&&!oi.FittedView?tc.MF_ENABLED:tc.MF_GRAYED;if(t==tc.ID_SHOW_PARA_MARK)return oi.WordWrap?tc.MF_ENABLED:tc.MF_GRAYED;if(t==tc.ID_SHOW_PAGE_BORDER)return oi.WordWrap&&oi.PageMode&&!oi.FittedView?tc.MF_ENABLED:tc.MF_GRAYED;if(t==tc.ID_INSERT_OBJECT)return e&&!GE&&Dj(zh&tc.TFLAG_NO_OLE)?tc.MF_ENABLED:tc.MF_GRAYED;if(t==tc.ID_FRAME_YBASE)return e&&i&&oi.PageMode&&s>0?tc.MF_ENABLED:tc.MF_GRAYED;if(t==tc.ID_EDIT_DOB)return e&&i&&oi.PageMode&&s>0&&Nj(kl[s].flags&tc.PARA_FRAME_OBJECT)?tc.MF_ENABLED:tc.MF_GRAYED;if(t==tc.ID_FRAME_ROTATE_TEXT)return e&&i&&oi.PageMode&&s>0&&Dj(kl[s].flags&(tc.PARA_FRAME_LINE|tc.PARA_FRAME_RECT))?tc.MF_ENABLED:tc.MF_GRAYED;if(t==tc.ID_REPAGINATE)return e&&i&&oi.PrintView?tc.MF_ENABLED:tc.MF_GRAYED;if(t==tc.ID_PAGE_BREAK)return e&&mz(br,jt)&&i?tc.MF_ENABLED:tc.MF_GRAYED;if(t==tc.ID_INSERT_PARA_FRAME)return e&&!GE&&oi.PrintView?tc.MF_ENABLED:tc.MF_GRAYED;if(t==tc.ID_INSERT_DRAW_OBJECT)return e&&!GE&&oi.PrintView?tc.MF_ENABLED:tc.MF_GRAYED;if(t==tc.ID_INSERT_INPUT_FIELD)return e&&I?tc.MF_ENABLED:tc.MF_GRAYED;if(t==tc.ID_INSERT_DATA_FIELD)return e&&I?tc.MF_ENABLED:tc.MF_GRAYED;if(t==tc.ID_INSERT_CHECKBOX)return e&&I?tc.MF_ENABLED:tc.MF_GRAYED;if(t==tc.ID_INSERT_COMBOBOX)return e&&I?tc.MF_ENABLED:tc.MF_GRAYED;if(t==tc.ID_INSERT_HLINK)return e&&I?tc.MF_ENABLED:tc.MF_GRAYED;if(t==tc.ID_INSERT_PAGE_NUMBER)return e&&!GE?tc.MF_ENABLED:tc.MF_GRAYED;if(t==tc.ID_INSERT_PAGE_COUNT)return e&&!GE?tc.MF_ENABLED:tc.MF_GRAYED;if(t==tc.ID_INSERT_DATE_TIME)return e&&!GE?tc.MF_ENABLED:tc.MF_GRAYED;if(t==tc.ID_INSERT_TOC)return e&&!GE&&EL?tc.MF_ENABLED:tc.MF_GRAYED;if(t==tc.ID_INSERT_NBSPACE)return e&&!f?tc.MF_ENABLED:tc.MF_GRAYED;if(t==tc.ID_INSERT_NBDASH)return e&&!f?tc.MF_ENABLED:tc.MF_GRAYED;if(t==tc.ID_INSERT_HYPH)return e&&!f?tc.MF_ENABLED:tc.MF_GRAYED;if(t==tc.ID_INSERT_FNOTE)return e&&!GE&&Dj(Nc[c].flags&tc.PAGE_HDR_FTR)?tc.MF_ENABLED:tc.MF_GRAYED;if(t==tc.ID_INSERT_ENOTE)return e&&!GE&&Dj(Nc[c].flags&tc.PAGE_HDR_FTR)?tc.MF_ENABLED:tc.MF_GRAYED;if(t==tc.ID_INSERT_BOOKMARK)return e?tc.MF_ENABLED:tc.MF_GRAYED;if(t==tc.ID_SECT_BREAK)return e&&L&&oi.PrintView&&!WR?tc.MF_ENABLED:tc.MF_GRAYED;if(t==tc.ID_COL_BREAK)return e&&L&&oi.PrintView&&to[l].columns>1?tc.MF_ENABLED:tc.MF_GRAYED;if(t==tc.ID_REPLACE)return e?tc.MF_ENABLED:tc.MF_GRAYED;if(t==tc.ID_DEL_PREV_WORD)return e?tc.MF_ENABLED:tc.MF_GRAYED;if(t==tc.ID_DEL_NEXT_WORD)return e?tc.MF_ENABLED:tc.MF_GRAYED;if(t==tc.ID_PROTECTION_LOCK)return e?tc.MF_ENABLED:tc.MF_GRAYED;if(t==tc.ID_WATERMARK)return e?tc.MF_ENABLED:tc.MF_GRAYED;if(t==tc.ID_TRACK_CHANGES)return e?tc.MF_ENABLED:tc.MF_GRAYED;if(t==tc.ID_APPLY_COMMENT)return e&&uA!=tc.HILIGHT_OFF&&Dj(iO&tc.TFLAG9_NO_COMMENTS)?tc.MF_ENABLED:tc.MF_GRAYED;if(t==tc.ID_HIDE_CHANGES)return tc.MF_ENABLED;if(t==tc.ID_ACCEPT_CHANGE)return e&&!Z_&&H4(_,c)?tc.MF_ENABLED:tc.MF_GRAYED;if(t==tc.ID_ACCEPT_ALL_CHANGES)return e&&!Z_?tc.MF_ENABLED:tc.MF_GRAYED;if(t==tc.ID_REJECT_CHANGE)return e&&!Z_&&H4(_,c)?tc.MF_ENABLED:tc.MF_GRAYED;if(t==tc.ID_REJECT_ALL_CHANGES)return e&&!Z_?tc.MF_ENABLED:tc.MF_GRAYED;if(t==tc.ID_SNAP_TO_GRID)return e?tc.MF_ENABLED:tc.MF_GRAYED;if(t==tc.ID_EDIT_HDR_FTR)return e&&oi.PageMode?tc.MF_ENABLED:tc.MF_GRAYED;if(t==tc.ID_CREATE_FIRST_HDR)return e&&eo[l].fhdr.FirstLine==-1?tc.MF_ENABLED:tc.MF_GRAYED;if(t==tc.ID_CREATE_FIRST_FTR)return e&&eo[l].fftr.FirstLine==-1?tc.MF_ENABLED:tc.MF_GRAYED;if(t==tc.ID_DELETE_FIRST_HDR)return e&&eo[l].fhdr.FirstLine>=0?tc.MF_ENABLED:tc.MF_GRAYED;if(t==tc.ID_DELETE_FIRST_FTR)return e&&eo[l].fftr.FirstLine>=0?tc.MF_ENABLED:tc.MF_GRAYED;if(t==tc.ID_CREATE_LEFT_HDR)return e&&eo[l].lhdr.FirstLine==-1?tc.MF_ENABLED:tc.MF_GRAYED;if(t==tc.ID_CREATE_LEFT_FTR)return e&&eo[l].lftr.FirstLine==-1?tc.MF_ENABLED:tc.MF_GRAYED;if(t==tc.ID_DELETE_LEFT_HDR)return e&&eo[l].lhdr.FirstLine>=0?tc.MF_ENABLED:tc.MF_GRAYED;if(t==tc.ID_DELETE_LEFT_FTR)return e&&eo[l].lftr.FirstLine>=0?tc.MF_ENABLED:tc.MF_GRAYED;if(t==tc.ID_CREATE_RIGHT_HDR)return e&&eo[l].rhdr.FirstLine==-1?tc.MF_ENABLED:tc.MF_GRAYED;if(t==tc.ID_CREATE_RIGHT_FTR)return e&&eo[l].rftr.FirstLine==-1?tc.MF_ENABLED:tc.MF_GRAYED;if(t==tc.ID_DELETE_RIGHT_HDR)return e&&eo[l].rhdr.FirstLine>=0?tc.MF_ENABLED:tc.MF_GRAYED;if(t==tc.ID_DELETE_RIGHT_FTR)return e&&eo[l].rftr.FirstLine>=0?tc.MF_ENABLED:tc.MF_GRAYED;if(t==tc.ID_SPELL)return e&&kO!=null?tc.MF_ENABLED:tc.MF_GRAYED;if(t==tc.ID_AUTO_SPELL)return e&&kO!=null?tc.MF_ENABLED:tc.MF_GRAYED;return tc.MF_ENABLED};_i.TerMenuSelect2=function(t){var e=_i.TerMenuSelect(t);return e==tc.MF_CHECKED?true:false};_i.TerMenuSelect=function(t){var e=tc.DEFAULT_CFMT;var r,i,f,l,a,n,c,s,_,o,u,T,A,E=tc.FLOW_DEF;var R,L,C,I=0;var d=new tc.ClsListLevel;var F;var g=null;if(!oi.open)return tc.MF_UNCHECKED;if(t==tc.ID_PRINT_PREVIEW)return Ru||pu!=null?tc.MF_CHECKED:tc.MF_UNCHECKED;if(t==tc.ID_PAGE_MODE)return oi.PageMode?tc.MF_CHECKED:tc.MF_UNCHECKED;if(t==tc.ID_FITTED_VIEW)return oi.PageMode&&oi.FittedView?tc.MF_CHECKED:tc.MF_UNCHECKED;if(t==tc.ID_VIEW_HDR_FTR)return yR?tc.MF_CHECKED:tc.MF_UNCHECKED;if(t==tc.ID_SHOW_HIDDEN)return pE?tc.MF_CHECKED:tc.MF_UNCHECKED;if(t==tc.ID_SHOW_FIELD_NAMES)return NE?tc.MF_CHECKED:tc.MF_UNCHECKED;if(t==tc.ID_EDIT_FNOTE)return DE?tc.MF_CHECKED:tc.MF_UNCHECKED;if(t==tc.ID_EDIT_ENOTE)return ME?tc.MF_CHECKED:tc.MF_UNCHECKED;if(t==tc.ID_TOOL_BAR)return oi.ToolBar?tc.MF_CHECKED:tc.MF_UNCHECKED;if(t==tc.ID_MENU)return oi.ShowMenu?tc.MF_CHECKED:tc.MF_UNCHECKED;if(t==tc.ID_RULER)return oi.ruler?tc.MF_CHECKED:tc.MF_UNCHECKED;if(t==tc.ID_VRULER)return $A?tc.MF_CHECKED:tc.MF_UNCHECKED;if(t==tc.ID_STATUS_RIBBON)return oi.ShowStatus?tc.MF_CHECKED:tc.MF_UNCHECKED;if(t==tc.ID_SHOW_PARA_MARK)return dS?tc.MF_CHECKED:tc.MF_UNCHECKED;if(t==tc.ID_SHOW_PAGE_BORDER)return FS?tc.MF_CHECKED:tc.MF_UNCHECKED;if(t==tc.ID_PROTECTION_LOCK)return IS?tc.MF_CHECKED:tc.MF_UNCHECKED;if(t==tc.ID_PROTECT_FORM)return mh?tc.MF_CHECKED:tc.MF_UNCHECKED;if(t==tc.ID_TRACK_CHANGES)return Z_?tc.MF_CHECKED:tc.MF_UNCHECKED;if(t==tc.ID_HIDE_CHANGES)return Q_?tc.MF_CHECKED:tc.MF_UNCHECKED;if(t==tc.ID_SNAP_TO_GRID)return Gh?tc.MF_CHECKED:tc.MF_UNCHECKED;if(t==tc.ID_BORDER_MARGIN)return oi.BorderMargin?tc.MF_CHECKED:tc.MF_UNCHECKED;if(t==tc.ID_PROTECT_FORM)return mh?tc.MF_CHECKED:tc.MF_UNCHECKED;if(t==tc.ID_BOLD_ON||t==tc.ID_ULINE_ON||t==tc.ID_ULINED_ON||t==tc.ID_ITALIC_ON||t==tc.ID_STRIKE_ON||t==tc.ID_DOUBLE_STRIKE_ON||t==tc.ID_SUPSCR_ON||t==tc.ID_SUBSCR_ON||t==tc.ID_PROTECT_ON||t==tc.ID_HIDDEN_ON||t==tc.ID_BOX_ON||t==tc.ID_CHAR_STYLE||t==tc.ID_HLINK_ON||t==tc.ID_INSERT_PAGE_NUMBER||t==tc.ID_INSERT_PAGE_COUNT||t==tc.ID_INSERT_DATE_TIME||t==tc.ID_INSERT_TOC||t==tc.ID_CHAR_SPACE||t==tc.ID_CHAR_SCALEX||t==tc.ID_CAPS_ON||t==tc.ID_SCAPS_ON){e=$w();if(Nj(xs[e].style&tc.PROTECT)){Oc=-1;e=$w()}}if(k_>=0)L=W_[k_].style&W_[k_].StyleMask|xs[0].style&~W_[k_].StyleMask;else L=xs[e].style;if(k_>=0){if(Nj(W_[k_].CharMask&tc.CMASK_EXPAND))o=W_[k_].expand;else o=xs[0].expand}else o=xs[e].expand;if(k_>=0){if(Nj(W_[k_].CharMask&tc.CMASK_SCALE_X))u=W_[k_].CharScaleX;else u=xs[0].ScaleX}else u=xs[e].ScaleX;if(t==tc.ID_BOLD_ON)return Nj(L&tc.BOLD)?tc.MF_CHECKED:tc.MF_UNCHECKED;if(t==tc.ID_ULINE_ON)return Nj(L&tc.ULINE)?tc.MF_CHECKED:tc.MF_UNCHECKED;if(t==tc.ID_ULINED_ON)return Nj(L&tc.ULINED)?tc.MF_CHECKED:tc.MF_UNCHECKED;if(t==tc.ID_ITALIC_ON)return Nj(L&tc.ITALIC)?tc.MF_CHECKED:tc.MF_UNCHECKED;if(t==tc.ID_STRIKE_ON)return Nj(L&tc.STRIKE)?tc.MF_CHECKED:tc.MF_UNCHECKED;if(t==tc.ID_DOUBLE_STRIKE_ON)return Nj(L&tc.DOUBLE_STRIKE)?tc.MF_CHECKED:tc.MF_UNCHECKED;if(t==tc.ID_SUPSCR_ON)return Nj(L&tc.SUPSCR)?tc.MF_CHECKED:tc.MF_UNCHECKED;if(t==tc.ID_SUBSCR_ON)return Nj(L&tc.SUBSCR)?tc.MF_CHECKED:tc.MF_UNCHECKED;if(t==tc.ID_PROTECT_ON)return Nj(L&tc.PROTECT)?tc.MF_CHECKED:tc.MF_UNCHECKED;if(t==tc.ID_HIDDEN_ON)return Nj(L&tc.HIDDEN)?tc.MF_CHECKED:tc.MF_UNCHECKED;if(t==tc.ID_CHAR_SPACE)return Nj(o)?tc.MF_CHECKED:tc.MF_UNCHECKED;if(t==tc.ID_CHAR_SCALEX)return Nj(u)?tc.MF_CHECKED:tc.MF_UNCHECKED;if(t==tc.ID_BOX_ON)return Nj(L&tc.CHAR_BOX)?tc.MF_CHECKED:tc.MF_UNCHECKED;if(t==tc.ID_HLINK_ON)return Nj(L&tc.HLINK)?tc.MF_CHECKED:tc.MF_UNCHECKED;if(t==tc.ID_CAPS_ON)return Nj(L&tc.CAPS)?tc.MF_CHECKED:tc.MF_UNCHECKED;if(t==tc.ID_SCAPS_ON)return Nj(L&tc.SCAPS)?tc.MF_CHECKED:tc.MF_UNCHECKED;if(t==tc.ID_HILIGHT_TEXT)return Ah?tc.MF_CHECKED:tc.MF_UNCHECKED;if(t==tc.ID_CHAR_STYLE)return xs[e].CharStyId>1?tc.MF_CHECKED:tc.MF_UNCHECKED;if(t==tc.ID_INSERT_PAGE_NUMBER)return xs[e].FieldId==tc.FIELD_PAGE_NUMBER?tc.MF_CHECKED:tc.MF_UNCHECKED;if(t==tc.ID_INSERT_PAGE_COUNT)return xs[e].FieldId==tc.FIELD_PAGE_COUNT?tc.MF_CHECKED:tc.MF_UNCHECKED;if(t==tc.ID_INSERT_DATE_TIME)return xs[e].FieldId==tc.FIELD_DATE||xs[e].FieldId==tc.FIELD_TIME||xs[e].FieldId==tc.FIELD_PRINTDATE?tc.MF_CHECKED:tc.MF_UNCHECKED;if(t==tc.ID_INSERT_TOC)return xs[e].FieldId==tc.FIELD_TOC?tc.MF_CHECKED:tc.MF_UNCHECKED;if(t==tc.ID_INSERT_NBSPACE){g=ui[br].txt;return jt<ui[br].len&&g[jt]==tc.NBSPACE_CHAR?tc.MF_CHECKED:tc.MF_UNCHECKED}if(t==tc.ID_INSERT_NBDASH){g=ui[br].txt;return jt<ui[br].len&&g[jt]==tc.NBDASH_CHAR?tc.MF_CHECKED:tc.MF_UNCHECKED}if(t==tc.ID_INSERT_HYPH){g=ui[br].txt;return jt<ui[br].len&&g[jt]==tc.HYPH_CHAR?tc.MF_CHECKED:tc.MF_UNCHECKED}r=ui[br].pfmt;if(br>0&&jt==0&&uA!=tc.HILIGHT_OFF){if(_A==br-1&&AA==ui[_A].len)r=ui[br-1].pfmt;if(_A==br&&AA==0&&sA<br)r=ui[br-1].pfmt}if(Y_){R=W_[k_].ParaFlags;i=W_[k_].LeftIndentTwips;f=W_[k_].RightIndentTwips;l=W_[k_].FirstIndentTwips;a=W_[k_].SpaceBefore;n=W_[k_].SpaceAfter;c=W_[k_].SpaceBetween;s=W_[k_].LineSpacing;_=W_[k_].BltId;C=W_[k_].pflags;F=W_[k_].ParaBkColor}else{R=Nc[r].flags;i=Nc[r].LeftIndentTwips;f=Nc[r].RightIndentTwips;if(Nj(ui[br].flags2&tc.LFLAG2_RTL)){i=WY(i,f);f=JC}l=Nc[r].FirstIndentTwips;a=Nc[r].SpaceBefore;n=Nc[r].SpaceAfter;c=Nc[r].SpaceBetween;s=Nc[r].LineSpacing;_=Nc[r].BltId;C=Nc[r].pflags;F=Nc[r].BkColor;E=Nc[r].flow}if(Nj(R&tc.BULLET)&&xc[_].ls>0){d=sQ(xc[_].ls,xc[_].lvl);I=xc[_].ls}if(t==tc.ID_DOUBLE_SPACE)return Nj(R&tc.DOUBLE_SPACE)?tc.MF_CHECKED:tc.MF_UNCHECKED;if(t==tc.ID_PARA_KEEP)return Nj(R&tc.PARA_KEEP)?tc.MF_CHECKED:tc.MF_UNCHECKED;if(t==tc.ID_PARA_KEEP_NEXT)return Nj(R&tc.PARA_KEEP_NEXT)?tc.MF_CHECKED:tc.MF_UNCHECKED;if(t==tc.ID_WIDOW_ORPHAN)return Nj(C&tc.PFLAG_WIDOW)?tc.MF_CHECKED:tc.MF_UNCHECKED;if(t==tc.ID_PAGE_BREAK_BEFORE)return Nj(C&tc.PFLAG_PAGE_BREAK)?tc.MF_CHECKED:tc.MF_UNCHECKED;if(t==tc.ID_CENTER)return Nj(R&tc.CENTER)?tc.MF_CHECKED:tc.MF_UNCHECKED;if(t==tc.ID_LEFT_JUSTIFY)return Dj(R&(tc.RIGHT_JUSTIFY|tc.CENTER|tc.JUSTIFY))?tc.MF_CHECKED:tc.MF_UNCHECKED;if(t==tc.ID_RIGHT_JUSTIFY)return Nj(R&tc.RIGHT_JUSTIFY)?tc.MF_CHECKED:tc.MF_UNCHECKED;if(t==tc.ID_JUSTIFY)return Nj(R&tc.JUSTIFY)?tc.MF_CHECKED:tc.MF_UNCHECKED;if(t==tc.ID_LEFT_INDENT)return i!=0?tc.MF_CHECKED:tc.MF_UNCHECKED;if(t==tc.ID_LEFT_INDENT_DEC)return tc.MF_UNCHECKED;if(t==tc.ID_RIGHT_INDENT)return f!=0?tc.MF_CHECKED:tc.MF_UNCHECKED;if(t==tc.ID_HANGING_INDENT)return l!=0?tc.MF_CHECKED:tc.MF_UNCHECKED;if(t==tc.ID_PARA_BORDER)return Nj(R&tc.PARA_BOX)?tc.MF_CHECKED:tc.MF_UNCHECKED;if(t==tc.ID_PARA_SPACING)return Nj(a)||Nj(n)||Nj(c)||Nj(s)?tc.MF_CHECKED:tc.MF_UNCHECKED;if(t==tc.ID_BULLET)return Nj(R&tc.BULLET)&&(I==0&&xc[_].IsBullet||I!=0&&d.NumType==tc.LIST_BLT)?tc.MF_CHECKED:tc.MF_UNCHECKED;if(t==tc.ID_PARA_NBR)return Nj(R&tc.BULLET)&&(I==0&&!xc[_].IsBullet||I!=0&&d.NumType!=tc.LIST_BLT)?tc.MF_CHECKED:tc.MF_UNCHECKED;if(t==tc.ID_PARA_LIST)return Nj(R&tc.BULLET)&&xc[_].ls!=0?tc.MF_CHECKED:tc.MF_UNCHECKED;if(t==tc.ID_PARA_BK_COLOR)return F!=tc.CLR_WHITE?tc.MF_CHECKED:tc.MF_UNCHECKED;if(t==tc.ID_PARA_RTL)return E==tc.FLOW_RTL?tc.MF_CHECKED:tc.MF_UNCHECKED;if(t==tc.ID_PARA_RTL_KEY)return E==tc.FLOW_RTL?tc.MF_CHECKED:tc.MF_UNCHECKED;if(t==tc.ID_PARA_LTR_KEY)return E!=tc.FLOW_RTL?tc.MF_CHECKED:tc.MF_UNCHECKED;if(t==tc.ID_PARA_STYLE)return Nc[r].StyId>0?tc.MF_CHECKED:tc.MF_UNCHECKED;A=ui[br].cid;T=A>0&&A<=fR?eR[A].row:0;if(t==tc.ID_TABLE_SHOW_GRID)return ER&&oi.PageMode?tc.MF_CHECKED:tc.MF_UNCHECKED;if(t==tc.ID_TABLE_HDR_ROW)return T>0&&Nj($E[T].flags&tc.ROWFLAG_HDR)?tc.MF_CHECKED:tc.MF_UNCHECKED;if(t==tc.ID_TABLE_ROW_KEEP)return T>0&&Nj($E[T].flags&tc.ROWFLAG_KEEP)?tc.MF_CHECKED:tc.MF_UNCHECKED;if(t==tc.ID_TABLE_ROW_RTL)return T>0&&$E[T].flow==tc.FLOW_RTL?tc.MF_CHECKED:tc.MF_UNCHECKED;if(t==tc.ID_SHOW_HYPERLINK_CURSOR)return vh?tc.MF_CHECKED:tc.MF_UNCHECKED;if(t==tc.ID_EDIT_STYLE)return k_>=0?tc.MF_CHECKED:tc.MF_UNCHECKED;if(t==tc.ID_EDIT_HDR_FTR)return WR?tc.MF_CHECKED:tc.MF_UNCHECKED;if(t==tc.ID_PAINT_FORMAT)return _h>=0?tc.MF_CHECKED:tc.MF_UNCHECKED;if(t==tc.ID_ZOOM)return nh!=100?tc.MF_CHECKED:tc.MF_UNCHECKED;if(t==tc.ID_BKND_PICT)return jh>0?tc.MF_CHECKED:tc.MF_UNCHECKED;if(t==tc.ID_WATERMARK)return $l>0?tc.MF_CHECKED:tc.MF_UNCHECKED;if(t==tc.ID_INSERT)return ES?tc.MF_CHECKED:tc.MF_UNCHECKED;if(t==tc.ID_INLINE_IME)return _i.UseVirtKeyboard?tc.MF_CHECKED:tc.MF_UNCHECKED;if(t==tc.ID_HAS_TOUCH_SCREEN)return _i.HasTouchScreen?tc.MF_CHECKED:tc.MF_UNCHECKED;if(t==tc.ID_DOC_RTL)return mr==tc.FLOW_RTL?tc.MF_CHECKED:tc.MF_UNCHECKED;if(t==tc.ID_AUTO_SPELL)return tg.stj!=null&&Nj(qh&tc.TFLAG4_AUTO_SPELL)?tc.MF_CHECKED:tc.MF_UNCHECKED;return tc.MF_UNCHECKED};_i.TerIgnoreCommand=function(){if(!lv||!QD())_i.TerCreateControl();Jr=true;return true};function tJ(t){return false}function eJ(){return true}function rJ(){return true}function iJ(t,e,r,i,f,l,a,n,c,s,_){if(arguments.length==11)return cJ(t,e,r,i,f,l,a,n,c,s,_);else if(arguments.length==10)return nJ(t,e,r,i,f,l,a,n,c,s);else if(arguments.length==9)return aJ(t,e,r,i,f,l,a,n,c);else if(arguments.length==8){if(typeof n=="number")return lJ(t,e,r,i,f,l,a,n);else return fJ(t,e,r,i,f,l,a,n)}else{PY("invalid nummber of arguments to ExtTextOut method");console.trace();return 0}}function fJ(t,e,r,i,f,l,a,n){return aJ(t,e,r,i,f,l,a,n,0)}function lJ(t,e,r,i,f,l,a,n){return aJ(t,e,r,i,f,l,a,null,n)}function aJ(t,e,r,i,f,l,a,n,c){return nJ(t,e,r,i,f,null,l,a,n,c)}function nJ(t,e,r,i,f,l,a,n,c,s){return cJ(t,e,r,i,f,l,a,n,c,s,true)}function cJ(t,e,r,i,f,l,a,n,c,s,_){var o,u,T,A;var E=0;var R;var L=f==null?null:f.copy();var C=false;var I;var d;var F=false;if(typeof e!="number"){console.log("invalid parameter, x: ",e);console.trace()}if(typeof r!="number"){console.log("invalid parameter, y: ",r);console.trace()}if(typeof n!="number"){console.log("invalid parameter, count: ",n);console.trace()}if(typeof s!="number"){console.log("invalid parameter, extra: ",s);console.trace()}if(L!=null&&!fk(f,"OrigRect","RECT"))return 0;if(a!=null&&a.length==0)a=null;if(l!=null&&l.length==0)l=null;if(c==undefined)c=null;var g=hc;var P=a==null&&l==null||n==0;if(!P&&g>=0&&g<Ys&&xs[g].InUse&&Dj(fO&tc.TFLAG10_UPRIGHT_CHARS)&&(xs[g].TextAngle==90||xs[g].TextAngle==270)){F=true;if(xs[g].TextAngle==270){if(L.right<L.left){L.left=WY(L.left,L.right);L.right=JC}if(L.bottom<L.top){L.top=WY(L.top,L.bottom);L.bottom=JC}}}if(P){if(Nj(i&tc.ETO_OPAQUE)&&L!=null){if(Go!=null)q$(L.left,L.top,L.right-L.left,L.bottom-L.top,fA);else{d=t.fillStyle;t.fillStyle=fA.toString();t.fillRect(L.left,L.top,L.right-L.left+1,L.bottom-L.top+1);t.fillStyle=d}}if(C)t.restore();return 1}if(c!=null&&n>c.length)n=c.length;var S=t.font.FontString;if(n>0){if(a!=null)E=n;else{E=n;a=[];for(o=0;o<n;o++){if(l[o]>65535){I=String.fromCharCode(l[o]);a[o]=I.charCodeAt(0)}else a[o]=l[o]}}}var h=0;var O=false;if(Nj(i&tc.ETO_RTLREADING)){for(o=0;o<n;o++)if(Yq(a[o]))break;if(o<n)O=true;if(!O&&n==1){I=String.fromCharCode(a[0]);if(I=="(".charCodeAt(0)||I==")".charCodeAt(0)||I=="[".charCodeAt(0)||I=="]".charCodeAt(0))O=true}}if(E>a.length)E=a.length;if(Nj(nO&tc.TOFLAG2_ADJUST_FONT_BEF_DRAW)){}if(c!=null){u=T=0;var v=0;var p=[c.length];if(!O){for(o=0;o<c.length;o++)p[o]=c[o];for(o=p.length-1;o>0;o--){var N=a[o-1]>=768&&a[o-1]<=879;if(p[o]>0&&p[o-1]==0&&!N){p[o-1]=p[o];p[o]=0}}}}else if(s>0){}var D=false;if(Nj(i&tc.ETO_OPAQUE)&&L!=null){if(Go!=null)q$(L.left,L.top,L.right-L.left,L.bottom-L.top,fA);else{d=t.fillStyle;t.fillStyle=fA.toString();t.fillRect(L.left,L.top,L.right-L.left+1,L.bottom-L.top+1);t.fillStyle=d;if(Nj(i&tc.ETO_CLIPPED)){if(!C){t.save();C=true}t.beginPath();t.rect(L.left,L.top,L.right-L.left,L.bottom-L.top);t.closePath();t.clip()}}}var M="";M=String.fromCharCode.apply(this,a);if(Go!=null)z$(M,e,r,L,iA.toString(),bo,hc);else{if(F){if(!C){t.save();C=true}if(Eu){t.translate(e,r);t.rotate(-(xs[g].TextAngle*tc.PI)/180);t.translate(-e,-r)}else{t.translate(e,r);t.rotate(-(xs[g].TextAngle*tc.PI)/180);t.translate(-e,-r)}}R=t.fillStyle;t.fillStyle=iA.toString();if(_){t.textBaseline="alphabetic";r+=xs[g].BaseHeight}else t.textBaseline="top";if(tg.InFireFox)r++;if(xs[g].ScaleX==0)t.fillText(M,e,r);else{t.save();var G=(xs[g].ScaleX+100)/100;t.scale(G,1);t.fillText(M,e/G,r);t.restore()}t.fillStyle=R}if(C)t.restore();return 1}function sJ(t,e,r,i,f){if(!tk(arguments,5))return;if(!ik(e,"str"))return;var l=t.font;t.font=r.FontString;var a=t.fillStyle;t.fillStyle=i.color.toString();t.textBaseline="top";var n=f.y;if(tg.InFireFox)n++;t.fillText(e,f.x,n);t.font=l;t.fillStyle=a;return}function _J(t,e,r,i,f,l){if(e!=null&&e.thick<=1)return CH(t,r,i,f,l,e.color,e.DottedLine);if(!tk(arguments,6))return;if(!fk(e,"pen","Pen"))return;if(e!=null&&e.DottedLine){t.save();t.setLineDash([3,6])}var a=t.strokeStyle;if(e!=null)t.strokeStyle=e.color.toString();var n=t.lineWidth;if(e!=null)t.lineWidth=e.thick;t.beginPath();t.moveTo(r,i);t.lineTo(f,l);t.closePath();t.stroke();t.strokeStyle=a;t.lineWidth=n;if(e!=null&&e.DottedLine)t.restore();return}function oJ(t,e,r){if(!tk(arguments,3))return;if(!fk(e,"brush","Brush"))return;var i=t.fillStyle;t.fillStyle=e.color.toString();t.fillRect(r.left,r.top,r.width,r.height);t.fillStyle=i;return}function uJ(t,e,r){if(!tk(arguments,3))return;if(!fk(e,"pen","Pen"))return;var i=t.strokeStyle;t.strokeStyle=e.color.toString();var f=t.lineWidth;t.lineWidth=e.thick;t.strokeRect(r.left,r.top,r.width,r.height);t.strokeStyle=i;t.lineWidth=f}function TJ(t,e,r,i,f,l){if(!tk(arguments,6))return;if(!fk(e,"brush","Brush"))return;var a=null;var n=r,c=i;if(Go!=null){a=document.createElement("canvas");a.width=f;a.height=l;t=a.getContext("2d");r=i=0}t.save();var s=r+f/2;var _=i+l/2;t.scale(1,l/f);t.translate(s,_*f/l);kH(t,0,0,f/2,e.color.toString());t.restore();if(Go!=null){var o=a.toDataURL("image/png");Q$(o,n,c)}return}function AJ(t,e,r,i,f,l){if(!tk(arguments,6))return;if(!fk(e,"pen","Pen"))return;var a=null;var n=r,c=i;if(Go!=null){a=document.createElement("canvas");a.width=f;a.height=l;t=a.getContext("2d");r=i=0}t.save();var s=r+f/2;var _=i+l/2;t.scale(1,l/f);t.translate(s,_*f/l);UH(t,0,0,f/2,e.color.toString(),e.thick);t.restore();if(Go!=null){var o=a.toDataURL("image/png");Q$(o,n,c)}return}function EJ(t,e,r){var i=null;var f;var l=0,a=0;var n=r.length;if(Go!=null){i=document.createElement("canvas");var c=0,s=0;l=c=r[0].x;a=s=r[0].y;for(f=1;f<n;f++){if(r[f].x<l)l=r[f].x;if(r[f].y<a)a=r[f].y;if(r[f].x>c)c=r[f].x;if(r[f].y>s)s=r[f].y}i.width=c-l;i.height=s-a;t=i.getContext("2d")}var _=t.fillStyle;t.fillStyle=e.color.toString();t.beginPath();t.moveTo(r[0].x-l,r[0].y-a);for(f=1;f<n;f++){t.lineTo(r[f].x-l,r[f].y-a)}t.closePath();t.fill();t.fillStyle=_;if(Go!=null){var o=i.toDataURL("image/png");Q$(o,l,a)}return}function RJ(t,e,r,i){var f=null;var l;var a=0,n=0;if(i==undefined)i=true;var c=r.length;if(Go!=null){f=document.createElement("canvas");var s=0,_=0;a=s=r[0].x;n=_=r[0].y;for(l=1;l<c;l++){if(r[l].x<a)a=r[l].x;if(r[l].y<n)n=r[l].y;if(r[l].x>s)s=r[l].x;if(r[l].y>_)_=r[l].y}f.width=s-a;f.height=_-n;t=f.getContext("2d")}var o=t.fillStyle;t.strokeStyle=e.color.toString();var u=t.lineWidth;t.lineWidth=e.thick;t.beginPath();t.moveTo(r[0].x-a,r[0].y-n);for(l=1;l<c;l++){t.lineTo(r[l].x-a,r[l].y-n)}if(i)t.closePath();t.stroke();t.strokeStyle=o;t.lineWidth=u;if(Go!=null){var T=f.toDataURL("image/png");Q$(T,a,n)}return}function LJ(t,e,r,i){var f=e.length;var l=document.createElement("canvas");var a=l.getContext("2d");a.beginPath();a.moveTo(e[0].x,e[0].y);for(var n=1;n<f;n++){a.lineTo(e[n].x,e[n].y)}a.closePath();return a.isPointInPath(r,i)}function CJ(t,e,r,i){return r>=e.left&&r<=e.left+e.width&&(i>=e.top&&i<=e.top+e.height)}function IJ(t,e){var r=t.fillStyle;t.fillStyle=e.toString();t.fill();t.fillStyle=r}function dJ(t,e){var r=t.strokeStyle;t.strokeStyle=e.color.toString();t.stroke();t.strokeStyle=r}function FJ(t,e){var r=0;if(t==null)console.trace();r=t.font;t.font=e.FontString;if(Go!=null)bo=e;return r}function gJ(t,e,r){if(!tk(arguments,3))return;if(!ik(r,"str"))return;var i=t.font;t.font=e.FontString;var f=EH(t,r,e.FontString).width;t.font=i;return f}function PJ(t,e,r){if(!tk(arguments,3))return;if(!ik(r,"str"))return;var i=My(ee,e.FontString);return i.getHeight()}function SJ(t,e,r){if(!tk(arguments,3))return;if(!ik(r,"str"))return;var i=new tc.SIZE;i.cx=gJ(t,e,r);i.cy=PJ(t,e,r);return i}function hJ(t,e){}function OJ(t,e){}function vJ(t){oV()}function pJ(t){var e=t.getRed();var r=t.getBlue();var i=t.getGreen();return(r<<16)+(i<<8)+e}function NJ(t,e,r){if(typeof e=="number"&&typeof r=="number"){return new tc.Color(t,e,r)}else{var i=t;t=i&255;e=(i&65280)>>8;r=(i&16711680)>>16;return new tc.Color(t,e,r)}}function DJ(t){var e=t.getRed();var r=t.getBlue();var i=t.getGreen();e=255-e;r=255-r;i=255-i;return new tc.Color(e,i,r)}function MJ(t,e){if(!tk(arguments,2))return;if(t===0)t=null;if(e===0)e=null;if(t==null&&e==null)return true;if(t==null||e==null)return false;if(!fk(t,"clr1","Color"))return;if(!fk(e,"clr2","Color"))return;return t.getRed()==e.getRed()&&t.getBlue()==e.getBlue()&&t.getGreen()==e.getGreen()}function GJ(t,e){var r=16;var i,f,l,a,n,c;if(t==null&&e==null)return true;if(t!=null&&e==null)return false;if(t==null&&e!=null)return false;if(MJ(t,tc.CLR_AUTO))t=tc.CLR_BLACK;if(MJ(e,tc.CLR_AUTO))e=tc.CLR_BLACK;i=t.getRed();l=t.getGreen();n=t.getBlue();f=e.getRed();a=e.getGreen();c=e.getBlue();return Math.abs(i-f)<r&&Math.abs(l-a)<r&&Math.abs(n-c)<r}function BJ(t,e){var r=t.getRed()^e.getRed();var i=t.getBlue()^e.getBlue();var f=t.getGreen()^e.getGreen();return new tc.Color(r,f,i)}function HJ(t){return t&65535}function mJ(t){return t>>16}function wJ(t){var e=t.length;var r;var i="";for(r=0;r<e;r++){var f=t.charCodeAt(r).toString(16);if(f.length==1)i+="0"+f;else i+=f}return i}function bJ(t){return"0x"+Number(t).toString(16)}function xJ(t){if(t==tc.CF_TEXT){if(tg.ClipDataText!=null&&tg.ClipDataText!="")return true;if(window.clipboardData!=null)return true}else if(t==xT){if(tg.ClipDataRtf!=null&&tg.ClipDataRtf!="")return true}return false}_i.TerRepaginate=function(t){if(!lv||!QD())_i.TerCreateControl();if(Nj(qh&tc.TFLAG4_NO_REPAGINATE))return true;if(oi.PrintView)yJ(false,false,0,false);else _i.TerRewrap();if(t)cG();return true};function yJ(t,e,r,i){var f,l;var a,n;var c=null;var s=Fo;var _,o,u,T,A;var E=Lo;var R,L;var C=false,I=true;var d,F;var g=false,P=false,S=false,h=false;var O;var v=To;var p=(new Date).getTime();ZU("Repaginate");if(!oi.PrintView)return false;if(oi.FittedView&&!t&&!e&&r==0&&!hi)iG();if(!t&&Dj(zh&tc.TFLAG_NO_HOUR_GLASS)){c=XQ(U)}if(Fo<0||Nj(nO&tc.TOFLAG2_FULL_REPAGE))Fo=0;if(t&&oi.modified==Ro)return false;if(t&&Fo>=Ri)return false;if(!t)Q5();if(!t||Nj(aO&tc.TOFLAG_UPDATE_ENOTE))Xz();if(!t&&!GR||Nj(nO&tc.TOFLAG2_REPOS_PICT_FRAMES))OW();l=Lq(br,jt);E9();d=jI;F=JI;g=fF;P=lF;S=qg;h=$g;Eo=To;a=oi.modified;if(!t&&!e&&r==0)C=true;if(Ri==1)C=true;if(C)t=false;if(C||Nj(nO&tc.TOFLAG2_FULL_REPAGE))Q4();T=0;if(t){T=nz(Fo,-1);A=ui[Fo].cid;if(T>0&&A>0)T=tR[eR[A].row].FirstPage;for(_=0;_<To;_++)if(po[_].FirstLine>=Ri)break;if(_<To)T=0;if(T>0&&Fo==po[T].FirstLine)T--;if(po[T].FirstLine>=Ri)T=0}else{if(e){var N;n=nz(br,-1);for(N=n;N>0;N--)if(Nj(po[N].flags&tc.PAGE_HARD))break;T=N-1;if(T<0)T=0;for(N=n+1;N<To;N++)if(Nj(po[N].flags&tc.PAGE_HARD))break;r=N-1}}Po=true;go=-1;ho=false;R=qe;L=$e;b5();u=G5(0);if(Nj(to[u].flags&tc.SECT_RESTART_PAGE_NO))po[0].DispNbr=to[u].FirstPageNo;else po[0].DispNbr=1;if(C)eo[u].PrevSect=-1;if(T==0){for(_=0;_<ro;_++){if(C||_==u){eo[_].hdr.height=Ei*(to[_].TopMargin-to[_].HdrMargin);eo[_].ftr.height=Ei*(to[_].BotMargin-to[_].FtrMargin);if(eo[_].hdr.height<0)eo[_].hdr.height=0;if(eo[_].ftr.height<0)eo[_].ftr.height=0;eo[_].hdr.TextHeight=0;eo[_].ftr.TextHeight=0;eo[_].rhdr.height=eo[_].rftr.height=0;eo[_].rhdr.TextHeight=eo[_].rftr.TextHeight=0;eo[_].rhdr.FirstLine=eo[_].rftr.FirstLine=-1;eo[_].lhdr.height=eo[_].lftr.height=0;eo[_].lhdr.TextHeight=eo[_].lftr.TextHeight=0;eo[_].lhdr.FirstLine=eo[_].lftr.FirstLine=-1;eo[_].hdr.used=false;eo[_].ftr.used=false;eo[_].fhdr.used=false;eo[_].fftr.used=false;eo[_].lhdr.used=false;eo[_].lftr.used=false;eo[_].rhdr.used=false;eo[_].rftr.used=false}}}H5();if(tf)oy();if(FR)_i.TerAdjustHtmlTable();FR=false;IR=oi.modified;if(C){zl=false;for(_=1;_<Kl;_++){kl[_].InUse=false;kl[_].flags=cj(kl[_].flags,tc.PARA_FRAME_POSITIONED|tc.PARA_FRAME_PAGE_BREAK);kl[_].flags2=cj(kl[_].flags2,tc.PF2_CALCX_SET);kl[_].RepageAnchorY=-1;if(Nj(kl[_].flags&tc.PARA_FRAME_NO_WRAP))zl=true}for(_=1;_<iR;_++){tR[_].TopRowHt=0;tR[_].BotRowHt=0;tR[_].TotalPageCols=0;tR[_].flags=cj(tR[_].flags,tc.TAUX_HEIGHT_ADDED|tc.TAUX_HAS_EMPTY_CELL|tc.TAUX_MIN_HEIGHT_USED)}}else{for(_=1;_<Kl;_++)if(Dj(kl[_].flags&tc.PARA_FRAME_OBJECT))break;if(_<Kl){for(_=1;_<Kl;_++)kl[_].InUse=false;for(f=0;f<Ri;f++){if(Nj(ui[f].fid))kl[ui[f].fid].InUse=true;if(Nj(ui[f].flags&tc.LFLAG_PICT)){O=nb(f);for(_=0;_<ui[f].len;_++){if(gW(O[_])){o=xs[O[_]].ParaFID;kl[o].InUse=true;if(ui[f].page>=T){kl[o].flags=cj(kl[o].flags,tc.PARA_FRAME_POSITIONED|tc.PARA_FRAME_PAGE_BREAK);kl[o].flags2=cj(kl[o].flags2,tc.PF2_CALCX_SET)}}}sb(f)}}}}Un=-1;n=T;So=false;while(!So&&(r==0||n<=r)){var D=false;WJ(n,C);if(Nj(po[n].flags&tc.PAGE_REPAGE_PREV)){po[n].flags=cj(po[n].flags,tc.PAGE_REPAGE_PREV);if(n>0){n--;continue}}n++;if(n<To&&po[n].FirstLine>0&&po[n].FirstLine<Ri){var M=po[n].FirstLine;if(ui[M].col>0)D=true}if(t&&!D){var G=(new Date).getTime();var B=G-p>Na;if(Ri<tc.SMALL_FILE){if(B){ho=true;break}}else{if(B){ho=true;I=false;break}}}}Cq(l,gk("C"));if(fr>=Ri)fr=Ri-1;if(fr>br)fr=br;we=br-fr;if(we>=Dt){we=Dt-1;fr=br-we}R9(d,F,g,P,S,h);q5();Z4(false);B5();if(So){Ro=oi.modified=a;Fo=Ri;if(Nj(aO&tc.TOFLAG_UPDATE_ENOTE))oj(tc.TOFLAG_UPDATE_ENOTE);Oo=false}else{oi.modified=a;if(n==To)Fo=Ri;else Fo=po[n].FirstLine}if(c!=null)XQ(c);Lo=E;if(Lo>=To)Lo=To-1;Lo=nz(br,Lo);Eo=To;Po=false;nO=_j(nO,tc.TOFLAG2_FULL_REPAGE);if(Lo>=R&&Lo<=L)By(false,R,L);else{if(E==Lo-1)By(false,Lo-1,Lo);else By(false,Lo,Lo)}if(Nj($h&tc.TFLAG5_VARIABLE_PAGE_SIZE)&&VJ())return true;if(i)cG();if(!GR&&v!=To)hD(_i);return I}function WJ(t,e){var r,i,f,l=-1,a,n,c;var s,_,o,u,T,A,E,R,L,C=0,I=0;var d,F,g,P=false,S,h=false,O=false;var v,p,N=0,D;var M,G,B;var H,m,w;var b,x,y,W;var U,k,X=0,K=0;var Y;var V,j,J,z,Z,Q;var q,$,tt=0,et=0,rt=0,it=0;var ft;var lt=0,at,nt,ct,st,_t;var ot,ut,Tt,At,Et,Rt;var Lt=false,Ct,It,dt=false;var Ft=0,gt,Pt,St=0,ht;var Ot=false,vt=false,pt,Nt,Dt,Mt=false;var Gt=[tc.MAX_TBL_LEVELS];var Bt=[tc.MAX_TBL_LEVELS];var Ht=[tc.MAX_TBL_LEVELS];var mt=[tc.MAX_TBL_LEVELS];var wt=[tc.MAX_TBL_LEVELS];var bt=[tc.MAX_TBL_LEVELS];var xt=[tc.MAX_TBL_LEVELS];var yt=[tc.MAX_TBL_LEVELS];var Wt=[tc.MAX_TBL_LEVELS];var Ut=[tc.MAX_TBL_LEVELS];var kt=[tc.MAX_TBL_LEVELS];var Xt=[tc.MAX_TBL_LEVELS];var Kt=[tc.MAX_TBL_LEVELS];var Yt=[tc.MAX_TBL_LEVELS];var Vt,jt;var Jt,zt,Zt,Qt,qt,$t,te,ee;var re,ie,fe,le;var ae=false,ne=false,ce=false;var se=false;var _e=false;var oe,ue,Te;var Ae=false,Ee,Re;var Le=0,Ce,Ie,de,Fe;var ge=false;var Pe=0,Se=0;var he=false;var Oe=0;var ve=false;var pe=0;var Ne=0,De=0;var Me=false;ZU("CreateOnePage: "+t.toString());hz(t);So=false;ut=Rt=0;q=po[t].FirstLine;if(t+1>=To)$=Ri-1;else $=po[t].LastLine;if(!e){for(s=1;s<Kl;s++){if(kl[s].PageNo==t){kl[s].flags=cj(kl[s].flags,tc.PARA_FRAME_POSITIONED|tc.PARA_FRAME_PAGE_BREAK);kl[s].flags2=cj(kl[s].flags2,tc.PF2_CALCX_SET);kl[s].RepageAnchorY=-1}}Un=q-1}kz(q);lz(t);t:while(true){if($+1>=Ri)$=Ri-1;for(r=q;r<=$;r++){var Ge=ui[r].fid;if(ui[r].page!=t)continue;ui[r].flags=cj(ui[r].flags,tc.LFLAG_SOFT_COL);if(Ge>0&&Ge<Kl)kl[Ge].InUse=true}a=q;_=U=G5(q);po[t].TopSect=U;if(t==0||po[t-1].TopSect!=U&&_!=G5(q-1))po[t].flags|=tc.PAGE_FIRST_SECT_PAGE;else po[t].flags=cj(po[t].flags,tc.PAGE_FIRST_SECT_PAGE);ft=Nj(po[t].flags&tc.PAGE_FIRST_SECT_PAGE);R=Fz(t,false,true);L=gz(t,false);M=0;Y=0;ae=ne=false;H=0;m=0;w=0;b=0;x=0;y=0;W=0;g=true;i=q;f=q;S=false;po[t].FnoteHt=Pe=0;se=false;_e=false;MaxCurPgHeight=0;po[t].FirstRow=po[t].LastRow=0;Tt=-1;nt=ct=L6(q);st=0;Kn=false;Et=0;N=0;rt=0;Dt=false;Co=t;C=-1;Mt=false;ve=false;pe=0;for(s=0;s<tc.MAX_TBL_LEVELS;s++){Gt[s]=q;Bt[s]=q;bt[s]=0;yt[s]=0;xt[s]=0;Ht[s]=0;mt[s]=0;wt[s]=0;Yt[s]=0;kt[s]=false;Kt[s]=false;Xt[s]=false;if(s<=nt&&q>0&&ui[q].cid>0){var Be=E6(s,q);var He=E6(s,q-1);if(eR[Be].row==eR[He].row)Kt[s]=true}}ht=eo[_].PgHeight/2*Ei;var me=to[_].FtrMargin;Iz(t);oe=jF.copy();var we=oe.FirstLine>=0;if(we&&oe.LastLine<Ri&&oe.FirstLine+2==oe.LastLine&&ui[oe.FirstLine+1].len==1)we=false;if(!we){if(to[_].FtrMargin>to[_].BotMargin&&to[_].BotMargin>=0){me=to[_].BotMargin-L/Ei;if(me<0)me=0}}T=Pt=(eo[_].PgHeight-me)*Ei;if(R>0)T-=to[_].HdrMargin*Ei;else T-=to[_].TopMargin*Ei;if(oi.FittedView&&!Eu)T*=Oz();po[t].BodyHt=T-L-Se-R;M5(_,_,R);J=_d;z=od;V=ud;Z=Td;go=0;A=0;d=false;F=false;p=0;D=0;ce=false;Q=po[t].TblHdrHt;if(Q>=T-R-L-mV(1440))Q=0;po[t].TblHdrHt=Q;o=E=R+Q;u=o;De=q;Ne=Se;XJ(t);for(s=1;s<iR;s++){tR[s].MinEndY=0;tR[s].flags=cj(tR[s].flags,tc.TAUX_PAGE_BREAK)}if(ui[q].cid>0){zt=ui[q].cid;for(;zt>0;zt=eR[zt].ParentCell){Zt=eR[zt].row;tR[Zt].TopRowHt=0;tR[Zt].BotRowHt=0;tR[Zt].CurPgHeight=0;tR[Zt].EndPgHeight=0;tR[Zt].flags=cj(tR[Zt].flags,tc.TAUX_HEIGHT_ADDED|tc.TAUX_HAS_EMPTY_CELL|tc.TAUX_MIN_HEIGHT_USED)}}for(s=1;s<iR;s++)tR[s].flags|=tc.TAUX_INIT_ROW;if(false&&t==0){console.clear();hY("**** starting CurPgHeight: %d, Page overflow height: %d, ph/fh/fnh: %d %d %d",o,T-L-Se,T,L,Se)}e:for(r=q;r<Ri;r++){if(Ae){zt=ui[r].cid;PY("*********************************");PY("**Line: ",r,"ln: ",ui[r].len,"lh: ",ui[r].height,"tl: ",Ri,"row: ",eR[zt].row,"rb: ",GY(r,tc.INFO_ROW),"cl: ",zt,"lvl: ",eR[zt].level,"rs: ",eR[zt].RowSpan,"pof: ",Nj(rR[zt].flags&tc.CAUX_PAGE_OVERFLOW),"pc: ",eR[zt].ParentCell,"p: ",t,ui[r].page,"cph: ",o,"fl: ",q,"col: ",go,ui[r].col,r>0?ui[r-1].col:0,"balancing cols: ",ve,"ColAdj: ",pe)}if(ge||Me){var be;var xe=false;qt=r;if(ge){ge=false;r=vz(r,f,_==U);if(ui[r].fid>0)r=qt;else at=ui[r].height;go++;if(go+1>=to[_].columns)pe=0;if(r>f){ui[r].flags|=tc.LFLAG_SOFT_COL;V+=J+z}}f=r;if(Nj(to[_].flags&tc.SECT_VAR_COL_WIDTH))Un=r-1;Oe=az(t,f,xe);xe=hF;if(xe)Oe=0;o=E+Oe;A=Oe;se=false;_e=false;ce=false;for(s=1;s<iR;s++){tR[s].MinEndY=0;tR[s].flags=cj(tR[s].flags,tc.TAUX_PAGE_BREAK)}for(s=0;s<tc.MAX_TBL_LEVELS;s++){Gt[s]=f;Bt[s]=f;bt[s]=0;yt[s]=0;xt[s]=0;Ht[s]=0;mt[s]=0;wt[s]=0;Yt[s]=0;kt[s]=false;Kt[s]=_i.RepageCol==0?false:true;Xt[s]=false}if(Me)be=i;else be=q;if(ui[be].cid>0){zt=ui[be].cid;for(;zt>0;zt=eR[zt].ParentCell){Zt=eR[zt].row;tR[Zt].TopRowHt=0;tR[Zt].BotRowHt=0;tR[Zt].CurPgHeight=0;tR[Zt].EndPgHeight=0;tR[Zt].flags=cj(tR[Zt].flags,tc.TAUX_HEIGHT_ADDED|tc.TAUX_HAS_EMPTY_CELL|tc.TAUX_MIN_HEIGHT_USED)}}for(s=1;s<iR;s++)tR[s].flags|=tc.TAUX_INIT_ROW;if(he){if(r>0)r--;he=false}if(Me){st=0;rt=0;Dt=false;C=-1;for(s=0;s<tc.MAX_TBL_LEVELS;s++){wt[s]=0}}if(Ae)PY("  New column initilized, repage col: ",go);if(!Me)continue e;Me=false}if(r>Un)Sz(_);if(r>=Ri)break e;if(r>0&&ui[r].page<t&&ui[r-1].page==t&&GY(r,tc.INFO_ROW))ui[r].page=t;if(ui[r].page==t)ui[r].col=go;if(o>MaxCurPgHeight)MaxCurPgHeight=o;if(ui[r].cid>0&&ui[r].page<t){Ee=t>0&&r<=po[t-1].LastLine;zt=ui[r].cid;Zt=eR[zt].row;if(!Ee){var ye=ui[r].page;if(r<=po[ye].LastLine)Ee=true}if(Ee){zt=ui[r].cid;Zt=eR[zt].row;if(GY(r,tc.INFO_ROW)&&eR[zt].level==0){for(zt=$E[Zt].FirstCell;zt>0;zt=eR[zt].NextCell){if(Nj(rR[zt].flags&tc.CAUX_PAGE_OVERFLOW)&&eR[zt].RowSpan==1)break;if(Nj(eR[zt].flags&tc.CFLAG_ROW_SPANNED)){var We=rR[zt].SpanningCell;if(We>0&&Nj(rR[We].flags&tc.CAUX_PAGE_OVERFLOW)){if(rR[We].LastSpannedCell==zt){if(Ae)PY("  page-break, row: %d, cl: %d, Spanning cell: %d overflowed, page: %d, l: %d",Zt,zt,We,t,r);break}}}}if(zt>0){if(Ae)PY("page break at this row as atleast one top level cell overflows the page");break}}Re=true;if(Nj(tR[Zt].flags&tc.TAUX_PAGE_OVERFLOW))Re=false;if(Re){C=-1;rt=st=0;for(s=0;s<tc.MAX_TBL_LEVELS;s++){xt[s]=0;Xt[s]=false;Ht[s]=0;mt[s]=0}}if(GY(r,tc.INFO_ROW)&&tR[Zt].MinEndY>o)o=tR[Zt].MinEndY;continue}}if(ui[r].page<t)ui[r].page=t;if(r>0&&ui[r-1].fid>0&&kl[ui[r-1].fid].NextId>0)bz(r);if(Tt==-1&&Dj(Nc[ui[r].pfmt].flags&tc.PAGE_HDR_FTR)){zt=ui[r].cid;Zt=eR[zt].row;if(zt==0||Dj($E[Zt].flags&tc.ROWFLAG_HDR))Tt=r}if(r>0)ct=L6(r-1);nt=L6(r);if(ui[r].cid>0&&nt==eR[ui[r].cid].level){zt=ui[r].cid;Zt=eR[zt].row;if(mt[nt]==$E[Zt].PrevRow)mt[nt]=Zt}if(Ae)hY("  SkipAfterLine: %d, cph: %d",C,o);if(C!=-1&&r>C){if(Ae)hY("  SkipAfterLine: %d",C);if(ui[r].cid>0){zt=ui[r].cid;rR[zt].flags|=tc.CAUX_PAGE_OVERFLOW;ui[r].page=t+1;if(eR[zt].level==0&&GY(r,tc.INFO_CELL)){var Ue=r+1<Ri&&GY(r+1,tc.INFO_ROW);if(!Ue){Zt=eR[zt].row;if(o-tR[Zt].CurPgHeight>$E[Zt].height){$E[Zt].height=o-tR[Zt].CurPgHeight;tR[Zt].flags=cj(tR[Zt].flags,tc.TAUX_HEIGHT_ADDED)}o=tR[Zt].CurPgHeight;A=tR[Zt].PageColHeight}C=-1;if(Ae)hY("  SkipAfterLine reset, cph: %d, pch: %d",o,A)}continue e}else C=-1}if(Ae)hY("  SkippingCell: %d, cph: %d",rt,o);if(rt>0){if(Ae)hY("  Skipping Cell: %d, FirstSkippedLine: %d",rt,it);if(ui[r].cid==rt&&GY(r,tc.INFO_CELL)){rt=0;ui[r].page=t+1;continue}else{if(ui[r].cid==rt||nt>eR[rt].level){var ke=nt==0&&GY(r,tc.INFO_ROW);if(!ke){if(ui[r].page<=t&&r>=it)ui[r].page=t+1;Dt=true;continue e}}else rt=0}}if(Xt[nt]&&nt>0&&GY(r,tc.INFO_ROW)){zt=ui[r].cid;for(;zt>0;zt=eR[zt].ParentCell)rR[zt].flags|=tc.CAUX_PAGE_OVERFLOW;for(fe=nt;fe>=0;fe--){if(fe<nt)wt[fe]+=tR[mt[nt]].BotRowHt;rR[Ht[fe]].NestedRowHeightNotYetAdded=0;if(Xt[fe]&&tR[mt[fe]].FirstPageHt<wt[fe])tR[mt[fe]].FirstPageHt=wt[fe]}C=r}if(Ae)hY("  cph before SkipCellLine: %d, level: %d, CellHeight: %d, SkipLevel: %d, SkipCell: %d, EndPage: %d",o,nt,wt[nt],st,xt[nt],Ot);var Xe=QJ(r,nt,ct,Xt,Kt,t,xt,st,Ht,mt,A,o,Yt,yt,Ot,wt,vt,Ae);st=Ad;A=Ed;o=Rd;Ot=aF;vt=nF;if(Xe){zt=ui[r].cid;for(;zt>0;zt=eR[zt].ParentCell)rR[zt].flags|=tc.CAUX_PAGE_OVERFLOW;if(Ae)hY(" Skip cell Line, l: %d, cid: %d, lvl: %d, lp: %d, EndCell: %d",r,ui[r].cid,eR[ui[r].cid].level,ui[r].page,vt);if(vt){tz(r,t,Kt[nt],Xt[nt],Ht[nt],Ut[nt],A,o,wt[nt],h,u,Ae);Ht[nt]=Ld;Ut[nt]=Cd;A=Ed;o=Rd;h=cF}if(ui[r].cid>0&&GY(r,tc.INFO_ROW)){Zt=eR[ui[r].cid].row;if(Dj(tR[Zt].flags&tc.TAUX_HEIGHT_ADDED)&&Xt[nt]){A+=$E[Zt].height;o+=$E[Zt].height;tR[Zt].flags|=tc.TAUX_HEIGHT_ADDED;if(Ae)hY("  SkipCellLine check, row: %d height added, cph: %d",Zt,o)}}if(Xt[nt]&&!GY(r,tc.INFO_CELL)&&ui[r].page>=t){rt=ui[r].cid;it=r}Dt=true;if(Ae)hY("   SkipAfterLine: %d, AfterSkippingCell: %d, SkippingCell: %d, FirstSkippedLine: %d",C,Dt,rt,it);continue e}if(ui[r].cid>0&&eR[ui[r].cid].level>0&&GY(r,tc.INFO_ROW)){Zt=eR[ui[r].cid].row;if(Dj(tR[Zt].flags&tc.TAUX_HEIGHT_ADDED)&&Kt[nt]){var Ke=$E[Zt].height;if(tR[Zt].TopRowHt>Ke)Ke=tR[Zt].TopRowHt;if(Ke>0){o=u+Ke;A=Ke;tR[Zt].flags|=tc.TAUX_HEIGHT_ADDED;if(Ae)hY("  add row height when a page-top row ends, row: %d, height added to BeginCurPgHeight: %d, cph: %d",Zt,$E[Zt].height,o)}}}if(Ot){r=vz(r,f,_==U);a=r-1;at=ui[r].height;Lt=true;hz(t+1);po[t].LastLine=a;po[t+1].FirstLine=r;po[t+1].flags=cj(po[t+1].flags,tc.PAGE_HARD);po[t+1].TopSect=po[t].TopSect;if(Ae)hY(" page for previous line: %d",ui[r-1].page);if(Ae)hY("page-break, 1, p: %d, l: %d",t,r);break e}if(Dt){for(s=nt+1;s<tc.MAX_TBL_LEVELS;s++){mt[s]=0;Xt[s]=false}Dt=false}at=ui[r].height;if(ui[r].cid>0){zt=ui[r].cid;if(Nj(eR[zt].flags&tc.CFLAG_ROW_SPANNED))at=0}if(Ae&&at==0)hY("  line hight set to 0, cl: %d, spanned flag: %x, cph: %d",ui[r].cid,Nj(eR[ui[r].cid].flags&tc.CFLAG_ROW_SPANNED),o);Lt=false;if(Nj(ui[r].flags&tc.LFLAG_FNOTETEXT)){if(se)_e=true;else{var Ye=Pe;var Ve=0;var je=false;Pe+=Rz(Ti,0,0,r,_,false,false);if(po[t].FnoteHt==0&&Pe>0)Pe+=2*mV(tc.FNOTE_MARGIN);if(ui[r].fid==0)X=wW(r,false);else X=0;Ve=T-L-Pe;if(se&&to[_].columns>1&&go>0)je=true;else if(at+X+MaxCurPgHeight>Ve){if(to[_].columns>1){je=true}else{Pe=Ye;se=true;_e=true}}else po[t].FnoteHt=Pe;if(Pe>Se)Se=Pe;if(je){jt=Pe+mV(720);po[t].FnoteHt=Se;if(jt>Se&&jt<(T-L)*3/4){Se=jt;continue t}}}}G=M;D=N;v=Nc[ui[r].pfmt].flags;M=ui[r].fid;N=0;if(Nj(v&tc.PAGE_HDR_FTR)){N=p;if(Nj(ui[r].flags&tc.LFLAG_HDR))N=tc.HDR_CHAR;if(Nj(ui[r].flags&tc.LFLAG_FTR))N=tc.FTR_CHAR;if(Nj(ui[r].flags&tc.LFLAG_LHDR))N=tc.LHDR_CHAR;if(Nj(ui[r].flags&tc.LFLAG_LFTR))N=tc.LFTR_CHAR;if(Nj(ui[r].flags&tc.LFLAG_RHDR))N=tc.RHDR_CHAR;if(Nj(ui[r].flags&tc.LFLAG_RFTR))N=tc.RFTR_CHAR;if(Nj(ui[r].flags&tc.LFLAG_FHDR))N=tc.FHDR_CHAR;if(Nj(ui[r].flags&tc.LFLAG_FFTR))N=tc.FFTR_CHAR}if(Nj(v&tc.PAGE_HDR_FTR)||M>0)g=false;else g=true;k=o+mV(40);if(M==0&&G>0){var Je=o-b;var ze=r-1;if(ze>=0&&ui[ze].len<=1)Je-=ui[ze].height;var Ze=true;if(kl[G].ShapeType==tc.SHPTYPE_TEXT_BOX||Nj(kl[G].flags&tc.PARA_FRAME_TEXT_BOX))Ze=false;if(Ze&&Je<=po[t].BodyHt)Ze=false;if(Ze&&Je<=po[t].BodyHt+L+Se+me*Ei){if(DV(kl[G].width)<po[t].BodyHt/2)Ze=false}if(Ze){var Qe=r-1,qe;Ce=kl[G].pict;for(Ie=Qe;Ie>=0;Ie--)if(ui[Ie].fid!=G)break;qe=Ie+1;for(Ie++;Ie<=Qe;Ie++)ui[Ie].fid=0;kl[G].InUse=false;if(Ce>0){de=0;Fe=0;if(TerLocateFontId(Ce,de,Fe)){de=PC;Fe=SC;fw(de,Fe,1,tc.CHAR_D)}gb(Ce)}G=0;Un=qe-1;l=qe-1;continue t}o=b;A=x;E=y;go=W}if(M>0&&G>0&&M!=G){o=b;A=x;E=y;go=W;kl[M].TextLine=r}if(Nj(p)&&N==0){if(eo[_].PrevSect<0||wz(_)){if(p==tc.HDR_CHAR&&N!=tc.HDR_CHAR){eo[_].hdr.height=k;if(nj(eo[_].hdr.height)+to[_].HdrMargin<to[_].TopMargin)eo[_].hdr.height=Ei*(to[_].TopMargin-to[_].HdrMargin);if(Nj(to[_].flags&tc.SECT_EXACT_MARGT)&&nj(eo[_].hdr.height)+to[_].HdrMargin>to[_].TopMargin){eo[_].hdr.height=Ei*(to[_].TopMargin-to[_].HdrMargin)}}if(p==tc.LHDR_CHAR&&N!=tc.LHDR_CHAR){eo[_].lhdr.height=k;if(nj(eo[_].lhdr.height)+to[_].HdrMargin<to[_].TopMargin)eo[_].lhdr.height=Ei*(to[_].TopMargin-to[_].HdrMargin);if(Nj(to[_].flags&tc.SECT_EXACT_MARGT)&&nj(eo[_].lhdr.height)+to[_].HdrMargin>to[_].TopMargin){eo[_].lhdr.height=Ei*(to[_].TopMargin-to[_].HdrMargin)}}if(p==tc.RHDR_CHAR&&N!=tc.RHDR_CHAR){eo[_].rhdr.height=k;if(nj(eo[_].rhdr.height)+to[_].HdrMargin<to[_].TopMargin)eo[_].rhdr.height=Ei*(to[_].TopMargin-to[_].HdrMargin);if(Nj(to[_].flags&tc.SECT_EXACT_MARGT)&&nj(eo[_].rhdr.height)+to[_].HdrMargin>to[_].TopMargin){eo[_].rhdr.height=Ei*(to[_].TopMargin-to[_].HdrMargin)}}if(p==tc.FHDR_CHAR&&N!=tc.FHDR_CHAR){eo[_].fhdr.height=k;if(nj(eo[_].fhdr.height)+to[_].HdrMargin<to[_].TopMargin)eo[_].fhdr.height=Ei*(to[_].TopMargin-to[_].HdrMargin);if(Nj(to[_].flags&tc.SECT_EXACT_MARGT)&&nj(eo[_].fhdr.height)+to[_].HdrMargin>to[_].TopMargin){eo[_].fhdr.height=Ei*(to[_].TopMargin-to[_].HdrMargin)}}if(_==U){R=Fz(t,false,true);if(R>0)T=Pt-to[_].HdrMargin*Ei;L=gz(t,false)}o=E=R+Q;A=0}else{o=H;A=m;E=w}}if(Nj(M)&&M!=G&&kl[M].PageNo!=t)kl[M].flags=cj(kl[M].flags,tc.PARA_FRAME_POSITIONED);if(M>0&&G==0){b=o;x=A;y=E;W=go;kl[M].TextLine=r}if(M>0&&M!=G){kl[M].FirstLine=kl[M].LastLine=r}if(G>0&&M!=G){kl[G].LastLine=r-1}if(Nj(N)&&Dj(p)){H=o;m=A;w=E}if(Dj(p)&&Nj(N)||Nj(p)&&p!=N||M!=G&&M>0){go=0;wt[nt]=0;Ht[nt]=0;mt[nt]=0;if(p==tc.HDR_CHAR&&N!=tc.HDR_CHAR){eo[_].hdr.height=eo[_].hdr.TextHeight=k;if(nj(eo[_].hdr.height)+to[_].HdrMargin<to[_].TopMargin)eo[_].hdr.height=Ei*(to[_].TopMargin-to[_].HdrMargin);if(Nj(to[_].flags&tc.SECT_EXACT_MARGT)&&nj(eo[_].hdr.height)+to[_].HdrMargin>to[_].TopMargin){eo[_].hdr.height=Ei*(to[_].TopMargin-to[_].HdrMargin)}R=Fz(t,false,true)}if(p==tc.LHDR_CHAR&&N!=tc.LHDR_CHAR){eo[_].lhdr.height=eo[_].lhdr.TextHeight=k;if(nj(eo[_].lhdr.height)+to[_].HdrMargin<to[_].TopMargin)eo[_].lhdr.height=Ei*(to[_].TopMargin-to[_].HdrMargin);if(Nj(to[_].flags&tc.SECT_EXACT_MARGT)&&nj(eo[_].lhdr.height)+to[_].HdrMargin>to[_].TopMargin){eo[_].lhdr.height=Ei*(to[_].TopMargin-to[_].HdrMargin)}R=Fz(t,false,true)}if(p==tc.RHDR_CHAR&&N!=tc.RHDR_CHAR){eo[_].rhdr.height=eo[_].rhdr.TextHeight=k;if(nj(eo[_].rhdr.height)+to[_].HdrMargin<to[_].TopMargin)eo[_].rhdr.height=Ei*(to[_].TopMargin-to[_].HdrMargin);if(Nj(to[_].flags&tc.SECT_EXACT_MARGT)&&nj(eo[_].rhdr.height)+to[_].HdrMargin>to[_].TopMargin){eo[_].rhdr.height=Ei*(to[_].TopMargin-to[_].HdrMargin)}R=Fz(t,false,true)}if(p==tc.FHDR_CHAR&&N!=tc.FHDR_CHAR){eo[_].fhdr.height=eo[_].fhdr.TextHeight=k;if(nj(eo[_].fhdr.height)+to[_].HdrMargin<to[_].TopMargin)eo[_].fhdr.height=Ei*(to[_].TopMargin-to[_].HdrMargin);if(Nj(to[_].flags&tc.SECT_EXACT_MARGT)&&nj(eo[_].fhdr.height)+to[_].HdrMargin>to[_].TopMargin){eo[_].fhdr.height=Ei*(to[_].TopMargin-to[_].HdrMargin)}R=Fz(t,false,true)}if(p==tc.FTR_CHAR&&N!=tc.FTR_CHAR){eo[_].ftr.height=eo[_].ftr.TextHeight=Nj(St)?St:k;eo[_].ftr.LimitFtrLine=Et;if(nj(eo[_].ftr.height)+to[_].FtrMargin<to[_].BotMargin)eo[_].ftr.height=Ei*(to[_].BotMargin-to[_].FtrMargin);else eo[_].ftr.height+=KJ(eo[_].ftr.FirstLine,eo[_].ftr.LastLine);if(Nj(to[_].flags&tc.SECT_EXACT_MARGB)&&nj(eo[_].ftr.height)+to[_].FtrMargin>to[_].BotMargin){eo[_].ftr.height=Ei*(to[_].BotMargin-to[_].FtrMargin)}L=gz(t,false)}if(p==tc.LFTR_CHAR&&N!=tc.LFTR_CHAR){eo[_].lftr.height=eo[_].lftr.TextHeight=Nj(St)?St:k;eo[_].lftr.LimitFtrLine=Et;if(nj(eo[_].lftr.height)+to[_].FtrMargin<to[_].BotMargin)eo[_].lftr.height=Ei*(to[_].BotMargin-to[_].FtrMargin);if(Nj(to[_].flags&tc.SECT_EXACT_MARGB)&&nj(eo[_].lftr.height)+to[_].FtrMargin>to[_].BotMargin){eo[_].lftr.height=Ei*(to[_].BotMargin-to[_].FtrMargin)}L=gz(t,false)}if(p==tc.RFTR_CHAR&&N!=tc.RFTR_CHAR){eo[_].rftr.height=eo[_].rftr.TextHeight=Nj(St)?St:k;eo[_].rftr.LimitFtrLine=Et;if(nj(eo[_].rftr.height)+to[_].FtrMargin<to[_].BotMargin)eo[_].rftr.height=Ei*(to[_].BotMargin-to[_].FtrMargin);if(Nj(to[_].flags&tc.SECT_EXACT_MARGB)&&nj(eo[_].rftr.height)+to[_].FtrMargin>to[_].BotMargin){eo[_].rftr.height=Ei*(to[_].BotMargin-to[_].FtrMargin)}L=gz(t,false)}if(p==tc.FFTR_CHAR&&N!=tc.FFTR_CHAR){eo[_].fftr.height=eo[_].fftr.TextHeight=Nj(St)?St:k;eo[_].fftr.LimitFtrLine=Et;if(nj(eo[_].fftr.height)+to[_].FtrMargin<to[_].BotMargin)eo[_].fftr.height=Ei*(to[_].BotMargin-to[_].FtrMargin);if(Nj(to[_].flags&tc.SECT_EXACT_MARGB)&&nj(eo[_].fftr.height)+to[_].FtrMargin>to[_].BotMargin){eo[_].fftr.height=Ei*(to[_].BotMargin-to[_].FtrMargin)}L=gz(t,false)}if(R>0&&_==U)T=Pt-to[_].HdrMargin*Ei;if(Nj(N)){o=A=E=St=0;Et=0}}if(N==tc.HDR_CHAR){if(r!=eo[_].hdr.LastLine+1)eo[_].hdr.FirstLine=-1;if(eo[_].hdr.FirstLine<0)eo[_].hdr.FirstLine=r;eo[_].hdr.LastLine=r;p=tc.HDR_CHAR}else if(N==tc.LHDR_CHAR){if(r!=eo[_].lhdr.LastLine+1)eo[_].lhdr.FirstLine=-1;if(eo[_].lhdr.FirstLine<0)eo[_].lhdr.FirstLine=r;eo[_].lhdr.LastLine=r;p=tc.LHDR_CHAR}else if(N==tc.RHDR_CHAR){if(r!=eo[_].rhdr.LastLine+1)eo[_].rhdr.FirstLine=-1;if(eo[_].rhdr.FirstLine<0)eo[_].rhdr.FirstLine=r;eo[_].rhdr.LastLine=r;p=tc.RHDR_CHAR}else if(N==tc.FHDR_CHAR){if(r!=eo[_].fhdr.LastLine+1)eo[_].fhdr.FirstLine=-1;if(eo[_].fhdr.FirstLine<0)eo[_].fhdr.FirstLine=r;eo[_].fhdr.LastLine=r;p=tc.FHDR_CHAR}else if(N==tc.FTR_CHAR){if(r!=eo[_].ftr.LastLine+1)eo[_].ftr.FirstLine=-1;if(eo[_].ftr.FirstLine<0)eo[_].ftr.FirstLine=r;eo[_].ftr.LastLine=r;p=tc.FTR_CHAR}else if(N==tc.LFTR_CHAR){if(r!=eo[_].lftr.LastLine+1)eo[_].lftr.FirstLine=-1;if(eo[_].lftr.FirstLine<0)eo[_].lftr.FirstLine=r;eo[_].lftr.LastLine=r;p=tc.LFTR_CHAR}else if(N==tc.RFTR_CHAR){if(r!=eo[_].rftr.LastLine+1)eo[_].rftr.FirstLine=-1;if(eo[_].rftr.FirstLine<0)eo[_].rftr.FirstLine=r;eo[_].rftr.LastLine=r;p=tc.RFTR_CHAR}else if(N==tc.FFTR_CHAR){if(r!=eo[_].fftr.LastLine+1)eo[_].fftr.FirstLine=-1;if(eo[_].fftr.FirstLine<0)eo[_].fftr.FirstLine=r;eo[_].fftr.LastLine=r;p=tc.FFTR_CHAR}else p=0;if(ui[r].page==t)ui[r].col=go;if(M>0&&M!=G&&kl[M].pict==0){if(Dj(kl[M].flags&tc.PARA_FRAME_OBJECT)){if(Dj(kl[M].flags&tc.PARA_FRAME_POSITIONED)){var $e;for($e=r+1;$e<Ri;$e++)if(ui[$e].fid==0)break;if($e<Ri&&ui[$e].height+o>T-L-Se&&p==0&&ui[$e].cid==0&&r>f&&ui[r].fid!=ui[r-1].fid&&go==to[_].columns-1&&t<tc.MAX_PAGES-1){ui[r].page=t+1;a--;po[t+1].FirstLine=r;po[t].LastLine=a;po[t+1].flags=cj(po[t+1].flags,tc.PAGE_HARD);if(Ae)hY("page-break, 3, p: %d",t);break e}}}kl[M].PageNo=t}if(G>0&&G!=M&&Dj(kl[G].flags&tc.PARA_FRAME_WRAP_IGNORE)){if(Dj(kl[G].flags&tc.PARA_FRAME_POSITIONED)&&kl[G].pict==0&&Dj(D)&&(Dj(N)||yR))S=true;P=true}if(r>q&&Nj(ui[r].flags&tc.LFLAG_PICT)&&Uz(r,t)&&Dj(Nc[ui[r].pfmt].flags&tc.PAGE_HDR_FTR)&&ui[r].fid==0&&ui[r].cid==0){ui[r].page=t+1;a=r-1;po[t+1].FirstLine=r;po[t].LastLine=a;po[t+1].flags=cj(po[t+1].flags,tc.PAGE_HARD);if(Ae)hY("page-break, 4, p: %d",t);break e}if(r>q&&Nj(ui[r-1].flags&tc.LFLAG_PICT)&&Wz(r-1,t,true)&&(Dj(Nc[ui[r-1].pfmt].flags&tc.PAGE_HDR_FTR)||yR)){S=true;Rt=Lq(r-1,0)}else if(r>q&&Nj(ui[r-1].flags&tc.LFLAG_PICT)&&Wz(r-1,t,false))O=true;if(S&&r<=l)S=false;if(S&&M==0&&Dj(N)&&r>l){po[t+1].FirstLine=r;po[t].LastLine=a;po[t+1].flags=cj(po[t+1].flags,tc.PAGE_HARD);if(To<t+2)To=t+2;Hy(false,t,t,false);po[t+1].FirstLine=Ri;po[t].LastLine=Ri-1;po[t+1].flags=cj(po[t+1].flags,tc.PAGE_HARD);Un=q-1;P=true;l=r;continue t}pt=Nj(Nc[ui[r].pfmt].pflags&tc.PFLAG_PAGE_BREAK)&&Nj(ui[r].flags&tc.LFLAG_PARA_FIRST)&&Dj(ui[r].fid)&&g;if(r>0&&(ui[r-1].page<t||Nj(ui[r-1].flags&tc.LFLAG_HDRS_FTRS)))pt=false;if(Nj(ui[r].tabw)&&Nj(ui[r].tabw.type&(tc.INFO_PAGE|tc.INFO_ROW|tc.INFO_COL)))pt=false;if(r==f)pt=false;if(ui[r].cid>0&&Bi)pt=false;if(pt&&r>0&&ui[r].cid>0){if(eR[ui[r].cid].row==eR[ui[r-1].cid].row)pt=false;if(pt&&ui[r-1].cid>0&&eR[ui[r-1].cid].level>0)pt=false;if(pt){ui[r].page=t+1;a=r-1;po[t+1].FirstLine=r;po[t].LastLine=a;po[t+1].flags=cj(po[t+1].flags,tc.PAGE_HARD);if(Ae)hY("page-break, 4a, p: %d",t);break}}d=false;F=false;Nt=true;if(Ae)hY("  cph before info_breaks: %d",o);if(Nj(ui[r].tabw)&&Nj(ui[r].tabw.type&(tc.INFO_SECT|tc.INFO_PAGE|tc.INFO_ROW|tc.INFO_COL))||pt){var tr=o;X=wW(r,false);ui[r].OrgY=o+Z;o+=at+X;A+=at+X;a=r;ui[r].page=t;if(Ae)hY("  in one of the info breaks");if(GY(r,tc.INFO_SECT)&&g&&mt[nt]==0){var er=false;It=false;var rr=r;var ir=Ei/4,fr=0;var lr=T-L-E;if(pt&&r>0&&ui[r].cid==0&&to[_].columns==1){ui[r].page=t+1;a=r-1;po[t+1].FirstLine=r;po[t].LastLine=a;po[t+1].flags=cj(po[t+1].flags,tc.PAGE_HARD);break}if(to[_].columns>1){var ar=true;var nr=eo[_].NextSect;for(ee=i;ee<r;ee++)if(GY(ee,tc.INFO_COL))break;if(ee<r)ar=false;if(wz(nr))ar=false;if(ar||ve){if(ve){ve=false;pe=0}else{var cr=0,sr=0,_r,or=0;lr=T-L-Se-E;_r=o-E;if(go==0&&_r<lr){sr=lr-_r;lr=_r}for(s=0;s<to[_].columns;s++){if(Nj(to[_].flags&tc.SECT_VAR_COL_WIDTH))le=DV(to[_].ColWidth[s]);else{var ur=(eo[U].PgWidth-to[U].LeftMargin-to[U].RightMargin)*Ai;le=(ur-to[_].ColumnSpace*Ai*(to[_].columns-1))/to[_].columns}or+=le;if(s<go)cr+=le*lr;else if(s==go)cr+=le*_r}if(or>0){var Tr=cr/or;pe=lr-Tr;if(pe<0)pe=0;if(pe>0){pe+=sr;if(Ae)PY(" col-adj set to: %d",pe);ve=true;o=E;A=0;Se=Ne;r=i-1;go=0;Me=true;for(ee=De;ee<=r;ee++){if(ui[ee].page==t){if(Nj(ui[ee].flags&LFLAG_SOFT_COL))ui[ee].flags=cj(ui[ee].flags,tc.LFLAG_SOFT_COL);ui[ee].col=0}}if(Ae)PY("  reseting the line to %d to balancing the columns",r);continue e}}}}else if(Nj(to[_].flags&tc.SECT_VAR_COL_WIDTH)){A=YJ(_,A,lr);while(A<=lr){fr=Nz(to[_].columns,A,i,r,lr,_==U,_);r=vC;er=sF;at=ui[r].height;if(!er)break;if(A>=lr){Lt=true;break}A+=ir;if(A>lr)A=lr}A=fr;if(er)It=true}else{A=A/to[_].columns+1;while(A<=lr){r=rr;fr=Nz(to[_].columns,A,i,r,lr,_==U,_);r=vC;er=sF;at=ui[r].height;if(r==rr)break;if(A>=lr){Lt=true;break}A+=ir;if(A>lr)A=lr}A=fr;if(r<rr){if(r>f)It=true;else{r=rr;at=ui[r].height}}}}else{It=tr>T-L-Se&&g&&r>f;if(It){ui[r].page=t+1;a--}else{It=ui[r].len>1&&tr+at>T-L-Se&&g&&r>f;if(It){ui[r].page=t+1;a--}}}B=_;if(It){po[t+1].FirstLine=r;po[t].LastLine=a;po[t+1].flags=cj(po[t+1].flags,tc.PAGE_HARD);if(Ae)hY("page-break, 5, p: %d",t);break e}else{to[_].LastPage=t;eo[_].LastPageHeight=A;to[_].LastLine=r;_=eo[B].NextSect;if(_<0){B5();_=G5(r+1)}to[_].FirstLine=r+1;to[_].LastPage=-1;if(r+1<Ri&&Dj(Nc[ui[r+1].pfmt].flags&tc.PAGE_HDR_FTR)){eo[_].hdr.height=eo[B].hdr.height;eo[_].hdr.TextHeight=eo[B].hdr.TextHeight;if(!j5(eo[B].hdr)){J5(eo[_].hdr);eo[_].hdr.height=(to[_].TopMargin-to[_].HdrMargin)*Ei}eo[_].ftr.height=eo[B].ftr.height;eo[_].ftr.TextHeight=eo[B].ftr.TextHeight;if(!j5(eo[B].ftr)){J5(eo[_].ftr);eo[_].ftr.height=(to[_].BotMargin-to[_].FtrMargin)*Ei}eo[_].fhdr.height=eo[B].fhdr.height;eo[_].fhdr.TextHeight=eo[B].fhdr.TextHeight;if(!j5(eo[B].fhdr))J5(eo[_].fhdr);eo[_].fftr.height=eo[B].fftr.height;eo[_].fftr.TextHeight=eo[B].fftr.TextHeight;if(!j5(eo[B].fftr))J5(eo[_].fftr)}if(Nj(to[_].flags&tc.SECT_RESTART_PAGE_NO))Y=to[_].FirstPageNo;else Y=0;if(Nj(to[_].flags&tc.SECT_START_ON_EVEN_PAGE)&&wz(_))ae=true;if(Nj(to[_].flags&tc.SECT_START_ON_ODD_PAGE)&&wz(_))ne=true;o=E=E+A;if(to[_].columns>1)u=o;De=to[_].FirstLine;Ne=Se;i=r+1;f=r+1;M5(U,_,R);J=_d;z=od;V=ud;Z=Td}A=0;if(to[B].columns>1||to[_].columns>1)Un=r;go=0;wt[nt]=0;Ht[nt]=0;mt[nt]=0;if(!It&&!oi.FittedView&&wz(_))d=true;else continue e}if(GY(r,tc.INFO_COL)&&mt[nt]==0){if(go+1<to[_].columns){o=E;f=r+1;go++;wt[nt]=0;Ht[nt]=0;mt[nt]=0;V+=J+z;if(go+1>=to[_].columns)pe=0;if(Nj(to[_].flags&tc.SECT_VAR_COL_WIDTH)){Un=r-1;if(to[_].ColWidth[go-1]<to[_].ColWidth[go]){Sz(_);Un=r-1}}continue e}else d=true}if(d)pt=false;if(pt&&r>0){ui[r].page=t+1;r--;a=r}if((d||pt||Nj(ui[r].tabw.type&tc.INFO_PAGE)&&!oi.FittedView)&&t<tc.MAX_PAGES-1&&g&&mt[nt]==0){var Ar=true;if(ff&&(GY(r,tc.INFO_PAGE)&&!oi.FittedView)&&r+1<Ri){if(ui[r+1].len==1&&Nj(ui[r+1].flags&tc.LFLAG_PARA)){ui[r].page=ui[r+1].page=t;r++;a=r}else if(Nj(GY(r+1,tc.INFO_SECT))){ui[r].page=ui[r+1].page=t;r++;a=r}}else if(ff&&(GY(r,tc.INFO_PAGE)&&!oi.FittedView)&&!d&&!pt){if(GY(r,tc.INFO_SECT))Ar=false;else if(r+1<Ri&&GY(r+1,tc.INFO_SECT))Ar=false}if(Ar){hz(t+1);po[t].LastLine=a;po[t+1].FirstLine=r+1;po[t+1].flags|=tc.PAGE_HARD;po[t+1].TopSect=po[t].TopSect;if(Ae)hY("page-break, 6, p: %d",t);break e}}if(Ae)hY("  row break: l: %d, lvl: %d, row: %d",r,nt,mt[nt]);if(Nj(ui[r].tabw.type&tc.INFO_ROW)&&mt[nt]>0){var Er;var Rr=true;if(Kt[nt]){if(tR[mt[nt]].TopRowHt==0&&qJ(r,t,mt[nt])){Zt=mt[nt];for(zt=$E[Zt].FirstCell;zt>0;zt=eR[zt].NextCell){if(eR[zt].RowSpan>1&&rR[zt].CurCellHeightPage==t&&rR[zt].CurCellHeight>0){if(rR[zt].CurCellHeight>tR[Zt].TopRowHt){tR[Zt].TopRowHt=rR[zt].CurCellHeight;$E[Zt].height=tR[Zt].TopRowHt}rR[zt].flags|=tc.CAUX_ADD_TOP_SPANNING_CELL_HT}}}I=$E[mt[nt]].NextRow;if(I>0&&tR[I].MinEndY-o>tR[mt[nt]].TopRowHt)tR[mt[nt]].TopRowHt=tR[I].MinEndY-o;Er=tR[mt[nt]].TopRowHt;if(Nj(tR[mt[nt]].flags&tc.TAUX_HEIGHT_ADDED))Er=0}else if(Xt[nt])Er=tR[mt[nt]].BotRowHt;else{if(Ae)hY("  CurRowHt bef base-align adj: %d, row: %d, lvl: ",$E[mt[nt]].height,mt[nt],nt);Mz(mt[nt]);Er=$E[mt[nt]].height;if(!Kt[nt]&&!Xt[nt]&&Er==0){Zt=mt[nt];CellMinHeights=0;for(zt=$E[Zt].FirstCell;zt>0;zt=eR[zt].NextCell){if(Nj(eR[zt].flags&tc.CFLAG_ROW_SPANNED)){CellMinHeights=0;break}if(eR[zt].RowSpan>1&&Math.abs(rR[zt].MinHeightWithBotPad)>CellMinHeights)CellMinHeights=Math.abs(rR[zt].MinHeightWithBotPad)}if(Er<mV(CellMinHeights))Er=mV(CellMinHeights)}}if(Ae)hY("  iptr: %d, ipbr: %d, rh: %d, CurRowHt: %d, CurRowHt+CurPhHeight: %d, ph-fh-fnh: %d,isr: %d, ColAdj: %d",Kt[nt],Xt[nt],$E[mt[nt]].height,Er,Er+o,T-L-Se-pe,E8(mt[nt]),pe);if(nt==0&&ce&&!L8(mt[nt])&&ui[r].fid==0){te=r;r=vz(r,f,_==U);if(te==r+1&&GY(te,tc.INFO_ROW))r++;if(te!=r)a=r-1;break}if(Er+o>T-L-Se-pe&&o>R&&(!Li||nt==0||Eu)&&g&&Rr&&t<tc.MAX_PAGES-1&&!Kt[nt]&&!Xt[nt]&&Bt[nt]>f){Qt=Tt>f?Tt:f;zt=ui[r].cid;if(Tt>=0&&Dj($E[mt[nt]].flags&tc.ROWFLAG_HDR)&&R8(mt[nt]))q=f;if(Ae)hY("  lath: %d, fcl:%d,fl:%d, l: %d",Tt,f,q,r);d=true;if(Gt[nt]>=Qt)r=Gt[nt];else r=Bt[nt];F=true;if(Ae)hY("   row overflows, l: %d, fl: %d, frgl: %d, frl: %d, lvl: %d",r,q,Gt[nt],Bt[nt],nt);at=ui[r].height;zt=eR[zt].ParentCell;for(s=nt-1;s>=0&&zt>0;s--){xt[s]=zt;Xt[s]=true;$E[mt[s]].flags|=tc.ROWFLAG_SPLIT;tR[mt[s]].LastPage=t;zt=eR[zt].ParentCell}mt[nt]=0;Ht[nt]=0}else{var Lr=o;A+=Er;o+=Er;if(tR[mt[nt]].MinEndY>o)o=tR[mt[nt]].MinEndY;if(Dj(tR[mt[nt]].flags&tc.TAUX_HEIGHT_ADDED)||o-Lr>0)JJ(mt[nt],t,go,o-Lr);tR[mt[nt]].flags|=tc.TAUX_HEIGHT_ADDED;if(nt>0){if(Kt[nt])wt[nt-1]+=tR[mt[nt]].TopRowHt;else wt[nt-1]+=Er;rR[Ht[nt-1]].NestedRowHeightNotYetAdded=0}if(Xt[nt]&&tR[mt[nt]].BotRowHt==0){tR[mt[nt]].BotRowHt=$E[mt[nt]].height;JJ(mt[nt],t,go,tR[mt[nt]].BotRowHt)}Rr=o>=T-L-Se-pe;if(Rr&&o<T-L-Se-pe&&L8(mt[nt]))Rr=false;if(Xt[nt]&&nt==0&&Nj(tR[mt[nt]].flags&(tc.TAUX_SAME_ROW_SPAN|tc.TAUX_HAS_EMPTY_CELL)))Rr=true;if(Ae)hY("  l: %d, cid: %d, lvl: %d, rowht: %d, cph: %d, pmh: %d, can-break: %d, ipbrl: %d, ipbrl0: %d",r,ui[r].cid,nt,Er,o,T-L-Se-pe,Rr,Xt[nt],Xt[0]);if(Rr&&Xt[nt]||Nj(tR[mt[nt]].flags&tc.TAUX_PAGE_BREAK)){if(nt==0){te=r;r=vz(r,f,_==U);if(te==r+1&&GY(te,tc.INFO_ROW))r++;if(te!=r)a=r-1;if(Ae)hY("page-break, 7, p: %d, SaveLine: %d, l: %d, pll: %d",t,te,r,a);break}else{var Cr=ui[r+1].cid;I=eR[Cr].row;if(Cr>0&&eR[Cr].level==nt&&E8(I)){Le=f;if(Le<Tt)Le=Tt;if(Gt[nt]<=Le){for(ee=r;ee>=Gt[nt];ee--){if(ee<r&&GY(r,tc.INFO_ROW))break;ui[ee].page=t+1}}else{for(ee=Gt[nt];ee<=r;ee++)ui[ee].page=t+1}}st=nt}}mt[nt]=0;Ht[nt]=0;Kt[nt]=Xt[nt]=false;continue e}}}r:while(true){if(Ae)hY("  cph at check-page-break: %d",o);It=false;var Ir=ui[r].HeightAfter;if(ui[r].cid>0)Ir=0;Ir-=mV(20);ui[r].x=V;ui[r].y=o+Z;if(!yR&&!Ci)ui[r].y-=R;if(ui[r].fid==0)X=K=mW(r,_,true,t);else X=K=0;dt=false;if(ui[r].cid>0){zt=ui[r].cid;if(rR[zt].MinHeight<0){while(zt>0){if(Nj(eR[zt].flags&tc.CFLAG_ROW_SPANNED))at=0;else if(rR[zt].MinHeight<0){var dr=mV(-rR[zt].MinHeight);var Fr=wt[nt];if(Ht[nt]!=zt)Fr=0;if(Fr+at>dr){at=dr-Fr-1;if(Ae)hY("  p: %d, limit height, cl: %d %d, cell h: %d %d, l: %d, lvl: %d, pc: %d, ch: %d, limit height: %d, clh: %d",t,zt,Ht[nt],Fr,wt[nt],r,nt,eR[zt].ParentCell,wt[nt],dr,at)}}if(eR[zt].level==0)break;else zt=eR[zt].ParentCell}}Zt=eR[zt].row;if($E[Zt].MinHeight>0&&(r==0||zt!=E6(eR[zt].level,r-1))&&eR[zt].RowSpan==1&&Dj(eR[zt].flags&tc.CFLAG_ROW_SPANNED)){var gr=$E[Zt].MinHeight;gr=mV(gr);if(at-Ir<gr)Ir=-(gr-at)}}It=at+X+o-Ir>T-L-Se-pe;if(dt)It=false;if(It)se=true;if(It&&ui[r].cid>0){Zt=eR[ui[r].cid].row;tR[Zt].flags|=tc.TAUX_PAGE_OVERFLOW;if(eR[ui[r].cid].level>0)ce=true}var Pr=kt[nt];if(Pr&&eR[ui[r].cid].RowSpan>1)Pr=false;Le=0;if(Pr&&nt>0&&(d||It)){Le=f;if(Le<Tt)Le=Tt;if(Bt[0]==Le){if(Bt[nt]>Le){var Sr=Bt[nt];if(E6(0,Sr)!=E6(0,Sr-1))Pr=false}else Pr=false}}else if(Pr&&nt==0){Zt=eR[ui[r].cid].row;if(Dj($E[Zt].flags&tc.ROWFLAG_KEEP))Pr=false;else if(Nj(lO&tc.TFLAG11_DONT_KEEP_TOGETHER_LONG_TABLES)&&(d||It)){Le=f;if(Le<Tt)Le=Tt;if(Bt[0]==Le){Pr=false;$E[Zt].flags=cj($E[Zt].flags,tc.ROWFLAG_KEEP);po[t].flags|=tc.PAGE_REPAGE_PREV}}}if(ui[r].cid>0&&GY(r,tc.INFO_ROW)){Zt=eR[ui[r].cid].row;if(eR[ui[r].cid].level==0&&Dj(tR[Zt].flags&tc.TAUX_HEIGHT_ADDED)){A+=$E[Zt].height;o+=$E[Zt].height;tR[Zt].flags|=tc.TAUX_HEIGHT_ADDED;if(Ae)hY("  bef CheckPageBreak, row: %d, rh: %d, brh: %d, cph: %d",Zt,$E[Zt].height,tR[Zt].BotRowHt,o)}}if(Ae){hY("  CHECK_PAGE_BREAK, clh: %d, fsb: %d, cph: %d, haa: %d, total: %d, ph: %d, fh: %d, fnh: %d, total: %d, ColAdj: %d",at,X,o,Ir,at+X+o-Ir,T,L,Se,T-L-Se-pe,pe);hY("  l: %d, po: %d, np: %d, pe: %d, lvl: %d, row: %d, keep-row: %d, %d, pph: %d, hh: %d, fl: %d, fcol: %d, ilh: %d",r,It,d,g,nt,mt[nt],kt[nt],Pr,o,R,q,f,dt)}if((d||It||_e)&&g&&(!Li||nt==0||Eu)&&(mt[nt]==0||!Pr)&&o>R&&(r>f||r>q&&It)&&t<tc.MAX_PAGES-1){if(Ae)hY("  page over flow, row: %d, level: %d, keep-row-together: %d",mt[nt],nt,kt[nt]);if(mt[nt]>0){zt=ui[r].cid;var hr=Ht[nt];var Or=mt[nt];for(s=nt;s>=0&&zt>0;s--){Ee=true;if(s==nt&&GY(r,tc.INFO_CELL)&&!GY(r+1,tc.INFO_ROW))Ee=false;if(Ee)xt[s]=zt;else xt[s]=0;Xt[s]=true;$E[mt[s]].flags|=tc.ROWFLAG_SPLIT;rR[zt].flags|=tc.CAUX_PAGE_OVERFLOW;if(r==0||ui[r-1].cid!=ui[r].cid)tR[mt[s]].flags|=tc.TAUX_HAS_EMPTY_CELL;tR[mt[s]].LastPage=t;if(Ae)hY("  cl: %d, level: %d overflows the page: %d",zt,eR[zt].level,t);zt=eR[zt].ParentCell}tz(r,t,Kt[nt],Xt[nt],Ht[nt],Ut[nt],A,o,wt[nt],h,u,Ae);Ht[nt]=Ld;Ut[nt]=Cd;A=Ed;o=Rd;h=cF;if(Ae)hY("  level row: %d, row height added: %d, lvl: %d, level-cl: %d",R6,Nj(tR[R6].flags&tc.TAUX_HEIGHT_ADDED),nt,E6);if(hr>0&&eR[hr].NextCell<=0&&Dj(tR[Or].flags&tc.TAUX_HEIGHT_ADDED)){o+=$E[Or].height;A+=$E[Or].height;tR[Or].flags|=tc.TAUX_HEIGHT_ADDED;JJ(Or,t,go,$E[Or].height)}if(go>=to[_].columns-1){rR[hr].LastPage=t+1;if(Ae)hY("  level row: %d, row height: %d, cph: %d",R6,$E[R6].height,o);rt=ui[r].cid;it=r;if(ui[r].page<=t)ui[r].page=t+1;if(rt!=0&&GY(r,tc.INFO_CELL)&&!GY(r+1,tc.INFO_ROW)){xt[nt]=rt;r--;it=r}if(eR[rt].RowSpan>1){var vr=rR[rt].LastSpannedCell;if(vr>0){var pr=eR[vr].row;tR[pr].flags|=tc.TAUX_PAGE_BREAK;if(Ae)PY("  page-break set for the row %d that contains he spanned cell for cell: %d",pr,rt)}}_e=false;continue e}else{ge=true;r--;he=true;it=-1;if(Ae)PY("  column overflow in table in the general page overflos logic");continue e}}else{Qt=Tt>f?Tt:f;qt=r;var Nr=nt;if(Nj(Nc[ui[Qt].pfmt].flags&tc.PAGE_HDR_FTR)){if(Ae)hY("first line %d in header/footer",q);while(Nj(Nc[ui[Qt].pfmt].flags&tc.PAGE_HDR_FTR)&&Qt<Ri)Qt++;if(Ae)hY("  first line after header/footer: %d",q)}if(Tt>=0&&Dj($E[mt[nt]].flags&tc.ROWFLAG_HDR)&&R8(-ui[r].cid))q=f;if(Ae)hY("  l: %d, level: %d, cid: %d, lath: %d, fl: %d",r,nt,ui[r].cid,Tt,q);if(nt>0&&Nj(ui[r].cid)&&E8(-ui[r].cid)&&Gt[nt]>Qt){r=Gt[nt];at=ui[r].height}if(nt>0&&Nj(ui[r].cid)){for(s=nt-1;s>=0&&eR[ui[r].cid].ParentCell>0;s--){if(kt[s]){UJ(s,Gt,Bt,r,Ae);if(Ae)hY("  lvl: %d, frgl: %d, fl: %d",s,Gt[s],q);if(q==Tt){if(Gt[s]>=q)r=Gt[s];else if(Bt[s]>=q)r=Bt[s]}else{if(Gt[s]>q)r=Gt[s];else if(Bt[s]>q)r=Bt[s]}at=ui[r].height;nt=s}}}if(Ae)hY("  l: %d, OrigLine: %d, level: %d, p: %d, lp: %d",r,qt,nt,t,ui[r].page);if(nt>0&&go>=to[_].columns-1){zt=ui[qt].cid;nt=L6(qt);st=Nr;zt=eR[zt].ParentCell;for(s=nt-1;s>=0&&zt>0;s--){xt[s]=zt;Xt[s]=true;$E[mt[s]].flags|=tc.ROWFLAG_SPLIT;tR[mt[s]].LastPage=t;zt=eR[zt].ParentCell}if(ui[r].page<=t)ui[r].page=t+1;if(r<qt){for(;r<Ri;r++){if(ui[r].page<=t)ui[r].page=t+1;if(L6(r)==0&&GY(r,tc.INFO_CELL))break}st=0}_e=false;continue e}}if(go>=to[_].columns-1){var Dr=true;var Mr=false;var Gr=false;var Br=false;if(ui[r].cid>0&&mt[nt]==0)Dr=false;if(!Dr){Zt=eR[ui[r].cid].row;zt=0;for(zt=$E[Zt].FirstCell;zt>0;zt=eR[zt].NextCell)if(Nj(eR[zt].flags&tc.CFLAG_ROW_SPANNED))break;if(zt>0)Mr=true;Gr=Nj($E[Zt].flags&tc.ROWFLAG_KEEP);if(r>0&&ui[r-1].cid>0){n=eR[ui[r-1].cid].row;if(n!=Zt&&tR[n].PageNo==t){Br=Nj(tR[n].flags&tc.TAUX_PAGE_OVERFLOW);if(Dj($E[n].flags&tc.ROWFLAG_KEEP))Br=false;if(F)Br=false}}}if(Ae)hY("  l: %d, cl: %d, TableRowSet: %d, IsSpannedRow: %d, pro: %d",r,ui[r].cid,Dr,E8,Br);if(ui[r].cid==0||!Br){var Hr=true;if(r>0&&ui[r].cid>0&&ui[r-1].cid>0){zt=ui[r-1].cid;Zt=eR[zt].row;if(Nj($E[Zt].flags&tc.ROWFLAG_HDR))Hr=false}else if(r>0&&ui[r-1].fid>0){Te=0;for(ee=r-1;ee>q;ee--){var mr=ui[ee].fid;if(mr==0)break;if(kl[mr].pict!=0)continue;if(ui[ee].y>Te)Te=ui[ee].y}if(Te<T-L-Se-pe)Hr=false}if(Hr)r=vz(r,f,_==U);at=ui[r].height;Lt=true;hz(t+1);po[t].LastLine=a;po[t+1].FirstLine=r;po[t+1].flags=cj(po[t+1].flags,tc.PAGE_HARD);po[t+1].TopSect=po[t].TopSect;if(Ae)PY("page-break, 9, p: %d, l: %d, pll: %d",t,r,a);break e}}else{ge=true;r--;he=true;it=-1;if(Ae)PY("  column overflow in table in the general page overflow logic ocuring after a row break or when in non-table text");continue e}}Ct=false;gt=nt;if(ui[r].cid>0&&(Ht[nt]==0||eR[ui[r].cid].PrevCell<=0)){zt=ui[r].cid;Zt=eR[zt].row;Ct=true;if($E[Zt].FirstCell==zt)rz(zt);for(s=nt;s>=0&&zt>0&&Ht[s]==0;s--){Zt=eR[zt].row;if($E[Zt].FirstCell==zt||Nj(tR[Zt].flags&tc.TAUX_INIT_ROW)){tR[Zt].CurPgHeight=o;tR[Zt].PageColHeight=A;tR[Zt].EndPgHeight=o;tR[Zt].EndPageColHeight=A;jJ(Zt,t,go);tR[Zt].flags=cj(tR[Zt].flags,tc.TAUX_INIT_ROW);tR[Zt].flags=cj(tR[Zt].flags,tc.TAUX_PAGE_OVERFLOW);tR[Zt].flags=cj(tR[Zt].flags,tc.TAUX_HEIGHT_ADDED);tR[Zt].PageNo=t;tR[Zt].TopRowHt=0;tR[Zt].BotRowHt=0;tR[Zt].flags=cj(tR[Zt].flags,tc.TAUX_HEIGHT_ADDED|tc.TAUX_HAS_EMPTY_CELL|tc.TAUX_MIN_HEIGHT_USED);if(tR[Zt].MinEndY>o){tR[Zt].TopRowHt=tR[Zt].MinEndY-o;tR[Zt].height=tR[Zt].MinEndY-o}}Ht[s]=zt;zt=eR[zt].ParentCell}Ft=s+1;if(true||Nj(eR[ui[r].cid].flags&tc.CFLAG_VALIGN_BASE)){rR[ui[r].cid].BaseHeight=ui[r].BaseHt;rR[ui[r].cid].SpaceBefore=0}}for(nt=Ft;nt<=gt&&Ct;nt++){var wr;var br,xr,yr;zt=Ht[nt];if(tR[eR[zt].row].FirstPage==t)eR[zt].FirstLine=r;eR[zt].LastLine=r;rR[zt].flags=cj(rR[zt].flags,tc.CAUX_PAGINATION_DONE);rR[zt].flags=cj(rR[zt].flags,tc.CAUX_PAGE_OVERFLOW);wt[nt]=0;if(rR[zt].NestedRowHeightNotYetAdded>0){wt[nt]+=rR[zt].NestedRowHeightNotYetAdded;rR[zt].NestedRowHeightNotYetAdded=0}xt[nt]=0;if(nt==0)Yt[nt]=0;else Yt[nt]=Yt[nt-1]+$E[mt[nt-1]].CurIndent+yt[nt-1];rR[zt].PrevColCell=rR[zt].NextColCell=0;if(mt[nt]==0)Wt[nt]=o+Z-(yR?0:R);wr=eR[zt].border;br=CW(zt,wr,t)+W6(zt);wr=kP;xr=IW(zt,wr,t)+U6(zt);wr=kP;if(false&&nt<gt){br=eR[zt].margin;rR[zt].flags|=tc.CAUX_SET_TOP_SPACE}else rR[zt].flags=cj(rR[zt].flags,tc.CAUX_SET_TOP_SPACE);yr=mV(br+xr);o+=yr;A+=yr;wt[nt]+=yr;Ut[nt]=0;if(mt[nt]==0){Zt=eR[zt].row;mt[nt]=Zt;if(nt>0&&k6(Zt))Mt=true;if(N!=0)tR[Zt].flags|=tc.TAUX_IN_HDR_FTR;else tR[Zt].flags=cj(tR[Zt].flags,tc.TAUX_IN_HDR_FTR);if(!Kt[nt]){Re=true;if(Nj($E[Zt].flags&tc.ROWFLAG_SPLIT)&&r>0){if(ui[r-1].cid==zt&&ui[r-1].page<t){Re=false;Kt[nt]=true}}if(Re){$E[Zt].flags=cj($E[Zt].flags,tc.ROWFLAG_SPLIT);tR[Zt].FirstPage=t;tR[Zt].FirstCol=go;tR[Zt].BotRowHt=0;tR[Zt].FirstPageHt=0}}if(eR[zt].PrevCell<=0)tR[Zt].TopRowHt=0;tR[Zt].LastPage=t;tR[Zt].LastCol=go;if(Nj($E[Zt].flags&tc.ROWFLAG_HDR)){n=$E[Zt].PrevRow;if(n>0&&Dj($E[n].flags&tc.ROWFLAG_HDR))$E[Zt].flags=cj($E[Zt].flags,tc.ROWFLAG_HDR)}kt[nt]=Nj($E[Zt].flags&(tc.ROWFLAG_KEEP|tc.ROWFLAG_HDR))||Nj(p)||$E[Zt].MinHeight<0||nt>0&&E8(Zt)||nt>0&&L8(Zt)||nt>0&&kt[nt-1];if(kt[nt]&&nt==0&&L8(Zt))kt[nt]=false;if(false&&!kt[nt]&&$E[Zt].MinHeight>0&&!iz(Zt)){var Wr=T-L-Se-o;if(mV($E[Zt].MinHeight)>Wr)kt[nt]=true}if(r==f)kt[nt]=false;if(kt[nt])$E[Zt].flags|=tc.ROWFLAG_KEEP_CALC;else $E[Zt].flags=cj($E[Zt].flags,tc.ROWFLAG_KEEP_CALC);if($E[Zt].MinHeight<0)$E[Zt].height=mV(-$E[Zt].MinHeight);else $E[Zt].height=mV($E[Zt].MinHeight);if($E[Zt].MinHeight>0){var Ur=W6(zt)+U6(zt);$E[Zt].height+=mV(Ur)}else if($E[Zt].MinHeight<0){if(Dj(fO&tc.TFLAG10_DONT_PAD_TABLE_HEIGHT)){var kr=U6(zt);$E[Zt].height+=mV(kr)}}$E[Zt].MinPictHeight=0;if(Dj(tR[Zt].flags&tc.TAUX_ALL_SPANNED)){bt[nt]=Zt;Gt[nt]=r}Bt[nt]=r;if(Nj($E[Zt].flags&tc.ROWFLAG_HDR))Tt=-1}if(eR[zt].PrevCell>0){var Xr=eR[zt].PrevCell;yt[nt]+=DV(eR[Xr].width)}}nt=gt;lt=ui[r].y;ui[r].x=V;j=o+Z;if(!yR&&!Ci)j-=R;ui[r].y=ui[r].OrgY=j;if(Nj(ui[r].cid)&&r==Gt[nt]){if(ui[r].fid==0){et=HW(r,_);ui[r].y=j+et;for(fe=nt;fe>=0&&r==Gt[fe];fe--){$E[mt[fe]].FrmSpcBef=et;Wt[fe]+=et;if(fe==0)le=J;else{$t=Ht[fe-1];le=DV(eR[$t].width-x6($t)-y6($t))}K6(r,mt[fe],_,le);yt[fe]=0}}else{var Kr=ui[r].fid;et=HW(r,_);ui[r].y=j;for(fe=nt;fe>=0&&r==Gt[fe];fe--){$E[mt[fe]].FrmSpcBef=et;if(fe==0)le=DV(kl[Kr].width);else{$t=Ht[fe-1];le=DV(eR[$t].width-x6($t)-y6($t))}K6(r,mt[fe],_,le);yt[fe]=0}}}else{et=0;if(Nj(ui[r].cid)){var Yr=bt[nt];if(Yr>0){$E[mt[nt]].CurIndent=$E[Yr].CurIndent;$E[mt[nt]].indent=$E[Yr].indent}}}if(Nj(ui[r].cid))ui[r].x+=Yt[nt]+$E[mt[nt]].CurIndent+yt[nt];X=K;if(X>0&&Nt&&at+o+X>T-L-Se-pe&&g){te=r;var Vr=false;while(r-1>q&&ui[r-1].fid>0){re=ui[r-1].fid;kl[re].flags=cj(kl[re].flags,tc.PARA_FRAME_POSITIONED);r--}if(r<=f||r>0&&Nj(Nc[ui[r-1].pfmt].flags&tc.PAGE_HDR_FTR)){r=te}else if(ui[te].len<=1)r=te;Vr=r>0&&ui[r-1].fid==ui[r].fid;if(!Vr){d=true;if(o==R)o++;Nt=false;continue r}}break r}ui[r].y+=X;if(ui[r].fid==0&&P&&ui[r].y!=lt&&r>l){var jr=0,Jr=0,zr=0,Zr=0;if(Nj(ui[r].tabw)){jr=ui[r].tabw.FrameX;Jr=ui[r].tabw.FrameWidth}DW(r,new tc.RECT);zr=HF;Zr=mF;if(zr!=jr||Zr!=Jr){Un=q-1;l=r;continue t}}if(Nj(v&tc.PAGE_FTR)&&St==0&&ui[r].fid==0&&o+at+X+et>ht){St=o;Et=r-1}if(!dt){o+=at+X+et;A+=at+X+et;wt[nt]+=at+X}if(Nj(ui[r].cid)&&Nj(ui[r].flags&tc.LFLAG_PICT)){var Qr=ui[r].pfmt;if(Dj(Nc[Qr].flags&tc.PAGE_FTR)&&(yR||Dj(Nc[Qr].flags&tc.PAGE_HDR))){zt=ui[r].cid;Te=xz(r)+mV(tc.CELL_MARGIN);if(Te-Wt[nt]>Ut[nt]&&eR[zt].RowSpan==1)Ut[nt]=Te-Wt[nt]}}if(Nj(ui[r].tabw)&&Nj(ui[r].tabw.type&tc.INFO_CELL)&&Ht[nt]>0&&mt[nt]>0){tz(r,t,Kt[nt],Xt[nt],Ht[nt],Ut[nt],A,o,wt[nt],h,u,Ae);Ht[nt]=Ld;Ut[nt]=Cd;A=Ed;o=Rd;h=cF}fz(r,t);a=r;ui[r].page=t;ui[r].col=go}if(a<Ri&&ui[a].cid>0){while(a>po[t].FirstLine){zt=ui[a].cid;if(zt>0&&Nj(eR[zt].flags&tc.CFLAG_ROW_SPANNED)&&ui[a].len==1&&GY(a,tc.INFO_CELL))a--;else break}}po[t].BodyHt=T-L-Se-R;if(Rt==0)ut=0;else{Cq(Rt);ut=PC;_t=SC}if(r<=ut){var qr=true;for(ee=r;ee<=ut;ee++)if(ui[ee].page==t&&Nj(ui[ee].flags&tc.LFLAG_PICT)){kz(ee);if(qr)yz(ee,t+1);qr=false}}if(a>=Ri)a=Ri-1;if(ui[a].cid>0&&GY(a,tc.INFO_ROW)){zt=ui[a].cid;Zt=eR[zt].row;if(true||Nj($E[Zt].flags&tc.ROWFLAG_SPLIT)){var $r;var ti,ei=eR[zt].level;for(ee=a-1;ee>=po[t].FirstLine;ee--){ti=ui[ee].cid;if(ti==0||eR[ti].level<ei)break;if(eR[ti].level==ei&&GY(ee,tc.INFO_ROW))break}ee++;if(ui[ee].page>t&&ee>po[t].FirstLine){$r=ee-1;for(;ee<=a;ee++)ui[ee].page=t+1;a=$r}}}if(Lt&&r<=a){a=kJ(t,r,a);r=a+1}if(a+1<Ri&&ui[a].cid>0&&ui[a+1].cid>0){zt=ui[a].cid;Zt=eR[zt].row;var ri,ii=0;if(eR[zt].level==0&&GY(a,tc.INFO_ROW)&&Nj($E[Zt].flags&tc.ROWFLAG_HDR)){for(ii=po[t].FirstLine;ii<a;ii++){ie=ui[ii].pfmt;if(Dj(Nc[ie].flags&tc.PAGE_HDR_FTR))break}for($=a-1;$>ii;$--){zt=ui[$].cid;if(zt==0||eR[zt].level>0)break;Zt=eR[zt].row;if(Dj($E[Zt].flags&tc.ROWFLAG_HDR))break}if($>ii){$++;ri=ui[$].pfmt;if(Nj(Nc[ri].flags&tc.PARA_KEEP_NEXT)&&$<=a){a=kJ(t,$,a)}}}}if(a>=Ri)a=Ri-1;while(ui[a].fid>0){var fi=a;M=ui[a].fid;if(kl[M].pict==0&&Dj(kl[M].flags&(tc.PARA_FRAME_VPAGE|tc.PARA_FRAME_VMARG))){var li=true;for(ee=a;ee>0&&ui[ee].page==t;ee--)if(ui[ee].fid!=M)break;li=ee>po[t].FirstLine&&Dj(Nc[ui[ee].pfmt].flags&tc.PAGE_HDR_FTR);if(li){for(ee=a;ee>0&&ee>po[t].FirstLine&&ui[ee].fid==M&&ui[ee].page==t;ee--)ui[ee].page=t+1;if(ee<a){a=ee;kl[M].flags=cj(kl[M].flags,tc.PARA_FRAME_POSITIONED);kl[M].PageNo=t+1}}}if(fi==a)break}po[t].BodyFirstLine=-1;for(ue=po[t].FirstLine;ue<a;ue++){if(Nj(Nc[ui[ue].pfmt].flags&tc.PAGE_HDR_FTR))continue;if(po[t].BodyFirstLine<0&&ui[ue].page==t)po[t].BodyFirstLine=ue;M=ui[ue].fid;if(M==0)continue;if(kl[M].pict==0&&Dj(kl[M].flags&(tc.PARA_FRAME_VPAGE|tc.PARA_FRAME_VMARG))&&kl[M].ParaY>=0&&kl[M].ShapeType==0&&Nj(kl[M].flags&tc.PARA_FRAME_POSITIONED)){var ai=mV(kl[M].FramePageY+kl[M].height);c=2*ht;if(ai>c){var ni=ue==po[t].FirstLine;if(!ni&&ue>0)if((Nc[ui[ue-1].pfmt].flags&tc.PAGE_HDR_FTR)!=(Nc[ui[ue].pfmt].flags&tc.PAGE_HDR_FTR))ni=true;if(ni){for(Ie=ue;Ie<Ri;Ie++){if(ui[Ie].fid!=M)break;ui[Ie].fid=0}kl[M].InUse=false}else{for(ee=a;ee>=ue;ee--){re=ui[ee].fid;if(re>0){kl[re].flags=cj(kl[re].flags,tc.PARA_FRAME_POSITIONED);kl[re].PageNo=t+1}ui[ee].page=t+1}a=ue-1}}}}if(po[t].BodyFirstLine<0)po[t].BodyFirstLine=po[t].FirstLine;if(ui[a].fid>0){var ci=po[t].BodyFirstLine;_=po[t].TopSect;M=ui[a].fid;if(ui[ci].fid==M){c=2*ht-(to[_].TopMargin+to[_].BotMargin)*Ei;if(mV(kl[M].height)>c){de=0;Fe=0;for(ee=ci;ee<Ri;ee++){if(ui[ee].fid!=M)break;ui[ee].fid=0}for(ee=ci-1;ee>=0;ee--){if(ui[ee].fid!=M)break;ui[ee].fid=0}kl[M].InUse=false;Ce=kl[M].pict;if(Ce>0&&_i.TerLocateFontId(Ce,de,Fe)){de=PC;Fe=SC;fw(de,Fe,1,tc.CHAR_D);xs[Ce].InUse=false}}}}if(a<Ri&&Nj(Nc[ui[a].pfmt].flags&tc.PAGE_HDR_FTR)){for(ee=a-1;ee>=po[t].FirstLine;ee--){ie=ui[ee].pfmt;if(Dj(Nc[ie].flags&tc.PAGE_HDR_FTR))break}if(ee>=po[t].FirstLine){for(ue=ee+1;ue<=a;ue++){ui[ue].page=t+1}a=ee}else{for(ee=a+1;ee<Ri;ee++){ie=ui[ee].pfmt;if(Dj(Nc[ie].flags&tc.PAGE_HDR_FTR))break}if(ee<Ri){for(ue=a;ue<ee;ue++){ui[ue].page=t}a=ee}}}if(a>=Ri)a=Ri-1;po[t].LastLine=a;if(po[0].LastLine>=Ri)po[0].LastLine=Ri-1;ot=po[0].LastLine;for(s=1;s<=t;s++){if(po[s].LastLine>=Ri)po[s].LastLine=Ri-1;if(po[s].LastLine>ot)ot=po[s].LastLine}if(ot>po[t].LastLine)ot=po[t].LastLine;for(r=po[t].FirstLine+1;r<=ot;r++)if(ui[r].page>t)break;if(r>Ri)r=Ri;po[t+1].FirstLine=r;So=r==Ri;po[t+1].flags=cj(po[t+1].flags,tc.PAGE_PRINT_BLANK_PAGE_BEF);if(So){To=t+1;po[To].LastLine=Ri;po[To].flags=cj(po[To].flags,tc.PAGE_HARD)}else{if(Dj(Y)&&(ae||ne)){var si;po[t+1].DispNbr=po[t].DispNbr+1;si=po[t+1].DispNbr%2==0;if(ae&&!si){po[t+1].DispNbr++;po[t+1].flags|=tc.PAGE_PRINT_BLANK_PAGE_BEF}else if(ne&&si){po[t+1].DispNbr++;po[t+1].flags|=tc.PAGE_PRINT_BLANK_PAGE_BEF}}else po[t+1].DispNbr=Nj(Y)?Y:po[t].DispNbr+1;if(t+2>To)To=t+2}for(r=po[t].FirstLine;r<=po[t].LastLine;r++)if(Nj(ui[r].cid)&&ui[r].page==t)break;if(r<=po[t].LastLine)po[t].FirstRow=eR[ui[r].cid].row;for(r=po[t].LastLine;r>=po[t].FirstLine;r--)if(Nj(ui[r].cid)&&ui[r].page==t)break;if(r>=po[t].FirstLine)po[t].LastRow=eR[ui[r].cid].row;for(r=po[t].FirstLine;r<=po[t].LastLine;r++){zt=ui[r].cid;if(zt==0||ui[r].page!=t)continue;$E[eR[zt].row].PageNo=t}if(ot+1<Ri&&Nj(ui[ot+1].flags&tc.LFLAG_PICT)&&ui[ot+1].fid==0&&ui[ot+1].cid==0){yz(ot+1,t+1);S=true}if(So)At=Ri-1;else At=po[t].LastLine;if(Nj(ui[At].flags&tc.LFLAG_PICT)&&Wz(At,t,true))S=P=true;if(P||oi.FittedView||S||So||O)Hy(false,t,t,false);if(S&&po[t].LastLine>l){Un=q-1;l=po[t].LastLine;continue t}tt++;if((P||h||Kn||uL||Nj(po[t].flags&tc.PAGE_REPAGE))&&tt<2){Un=q-1;l=-1;continue t}if(tt<2&&Mt){Un=q-1;l=-1;continue t}break}if(P&&Un>=po[t+1].FirstLine){Un=po[t+1].FirstLine-1}for(r=po[t].LastLine;r>po[t].FirstLine;r--)if(ui[r].page==t)break;if(r>po[t].FirstLine)po[t].LastLine=r;if(po[t].FnoteHt>0){jt=0;for(r=po[t].FirstLine;r<=po[t].LastLine;r++){if(ui[r].page!=t)continue;if(Nj(ui[r].flags&tc.LFLAG_FNOTETEXT)){jt+=Rz(Ti,0,0,r,_,false,false)}}if(jt>0)jt+=2*mV(tc.FNOTE_MARGIN);if(jt<po[t].FnoteHt)po[t].FnoteHt=jt}go=-1;ZU("CreateOnePage: done");return true}function UJ(t,e,r,i,f){var l,a,n=0,c=0,s,_;var o=false;t:{l=E6(t,i);if(l<=0)return false;a=eR[l].row;_=e[t];if(_<0||_>=Ri)break t;l=E6(t,_);if(l<=0)break t;n=eR[l].row;for(s=a;s>0;s=$E[s].PrevRow)if(s==n)break;if(s<=0)break t;_=r[t];if(_<0||_>=Ri)break t;l=E6(t,_);if(l<=0)break t;c=eR[l].row;for(s=a;s>0;s=$E[s].PrevRow)if(s==c)break;if(s<=0)break t;return true}if(f)PY("  ******** FixRowGroupLine(): Recalculating FirstRowGroupLine and FirstRowLine, l: %d",i);for(_=i;_>0;_--){if(ui[_].cid==0||eR[ui[_].cid].level<t){e[t]=r[t]=_+1;break}if(GY(_,tc.INFO_ROW)&&L6(_)==t){if(!o){r[t]=_+1;o=true}e[t]=_+1;s=eR[ui[_].cid].row;s=$E[s].NextRow;if(s<=0)break;if(Nj(tR[s].flags&tc.TAUX_ALL_SPANNED))continue}}return true}function kJ(t,e,r){var i,f;var l,a;l=ui[e].cid;if(eR[l].level>0){for(a=e;a<Ri;a++){var n=ui[a].cid;if(eR[n].level<eR[l].level&&GY(a,tc.INFO_CELL)){if(a>r)r=a;break}}}for(i=e;i<=r;i++)if(ui[i].page==t){ui[i].page=t+1;f=ui[i].fid;if(Nj(f)){kl[f].flags=cj(kl[f].flags,tc.PARA_FRAME_POSITIONED);kl[f].PageNo=t+1}}return e-1}function XJ(t){var e=po[t].TopSect;var r=jV(eo[e].PgWidth);var i=jV(eo[e].PgHeight);var f=$l;var l;if($l<=0)return true;l=kl[f].pict;if(l>0){var a,n=100;if(kl[f].height>i){a=Mj(i,100,kl[f].height);if(a<n)n=a}if(kl[f].width>r){a=Mj(r,100,kl[f].width);if(a<n)n=a}if(n<100){kl[f].height=Mj(kl[f].height,n,100);kl[f].width=Mj(kl[f].width,n,100);xs[l].PictHeight=kl[f].height;xs[l].PictWidth=kl[f].width;HN(l,hV(xs[l].PictHeight),dV(xs[l].PictWidth),true);mN(l)}}kl[f].y=kl[f].ParaY=(i-kl[f].height)/2;kl[f].x=(r-kl[f].width)/2;kl[f].x-=jV(to[e].LeftMargin);kl[f].flags=cj(kl[f].flags,tc.PARA_FRAME_VMARG);kl[f].flags|=tc.PARA_FRAME_VPAGE;return true}function KJ(t,e){var r,i,f,l=0,a;var n;if(t<0||t>e)return 0;a=ui[t].y;for(i=t;i<=e;i++){if(Nj(ui[i].flags&tc.LFLAG_PICT)){n=nb(i);for(r=0;r<ui[i].len;r++){if(gW(n[r])){f=xs[n[r]].ParaFID;if(f>0&&kl[f].ShapeType==tc.SHPTYPE_LINE){if(kl[f].ParaY<0){var c=mV(-kl[f].ParaY);c-=ui[i].y-a;if(c>l)l=c}}}}}}return l}function YJ(t,e,r){var i,f=0,l,a,n,c,s;a=to[t].columns;for(i=0;i<a;i++)f+=to[t].ColWidth[i];l=f/a;c=e;n=0;for(i=0;i<=go;i++){if(c>r)s=r;else s=c;if(s<=0)break;c-=s;s=Mj(s,to[t].ColWidth[i],l);n+=s}return n/a}function VJ(){if(Nj($h&tc.TFLAG5_VARIABLE_PAGE_SIZE)){var t=_i.TerGetTextHeight()-tc.RULER_TOLERANCE;var e=po[0].TopSect;var r=t+jV(to[e].TopMargin+to[e].BotMargin);var i=To>1;if(!i){var f=jV(eo[e].PgHeight);if(r+Kt+2*tc.RULER_TOLERANCE<f)i=true;if(r>f)i=true}if(i){var l=r;r=MD(_i,r);if(r!=0){if(r<l)r=l;Kt=r-l;return _i.TerSetSectPageSize(0,0,jV(eo[e].PgWidth),r+tc.RULER_TOLERANCE/2,false)}}}return false}function jJ(t,e,r){var i=ZJ(t,e,r);if(i<0)return false;tR[t].PageCol[i].height=-1;return true}function JJ(t,e,r,i){var f=ZJ(t,e,r);if(f<0)return false;tR[t].PageCol[f].height=i;return true}function zJ(t,e,r){var i;for(i=0;i<tR[t].TotalPageCols;i++)if(tR[t].PageCol[i].page==e&&tR[t].PageCol[i].col==r)break;if(i==tR[t].TotalPageCols)return-1;return tR[t].PageCol[i].height}function ZJ(t,e,r){var i;if(t<1||t>=iR)return-1;if(tR[t].PageCol==undefined||tR[t].PageCol==null){tR[t].MaxPageCols=1;tR[t].TotalPageCols=0;tR[t].PageCol=[]}for(i=0;i<tR[t].TotalPageCols;i++)if(tR[t].PageCol[i].page==e&&tR[t].PageCol[i].col==r)break;if(i>=tR[t].TotalPageCols){tR[t].MaxPageCols=tR[t].TotalPageCols+10;tR[t].TotalPageCols++}tR[t].PageCol[i]=(new tc.ClsRowPageCol).init();tR[t].PageCol[i].page=e;tR[t].PageCol[i].col=r;return i}function QJ(t,e,r,i,f,l,a,n,c,s,_,o,u,T,A,E,R,L){var C,I;var d;var F=false;A=R=false;Ad=n;Ed=_;Rd=o;aF=A;nF=R;t:{e:{if(f[r]&&(t>0&&L6(t-1)==r&&GY(t-1,tc.INFO_ROW))){var g;if(i[r]){if(r==0){if(Nj(tR[s[r]].flags&tc.TAUX_SAME_ROW_SPAN)){break t}}else n=r}if(s[r]>0){g=tR[s[r]].TopRowHt;tR[s[r]].LastPage=l;if(Dj(tR[s[r]].flags&tc.TAUX_HEIGHT_ADDED)){_+=g;o+=g;tR[s[r]].flags|=tc.TAUX_HEIGHT_ADDED;if(r>0)E[r-1]+=g}}f[r]=false;s[r]=0;c[r]=0}if(n>0&&e>=n){if(ui[t].page<=l)ui[t].page=l+1;break e}n=0;I=ui[t].cid;d=false;if(e>r){var P=I;if(t>0&&ui[t-1].cid==E6(r,t)){for(C=e;C>r;C--){if(a[r]>0)a[C]=P;else a[C]=0;E[C]=0;T[C]=0;P=eR[P].ParentCell}for(C=r+1;C<=e;C++)u[C]=u[C-1]+$E[s[C-1]].CurIndent+T[C-1];if(Nj(a[e]))d=true}}else if(e==r&&a[e]>0){if(I==0||eR[a[e]].row!=eR[I].row){if(e==0){if(Nj(tR[s[r]].flags&tc.TAUX_SAME_ROW_SPAN)){A=true}break t}else n=e}if(Dj(n)){if(I==a[e])d=true;if(I!=a[e]){if(false&&I>0&&e>0&&Nj(a[e-1]))n=e;else a[e]=0}else if(GY(t,tc.INFO_CELL)&&!GY(t+1,tc.INFO_ROW))a[e]=0}}else if(e<r){for(C=e+1;C<=r;C++)a[C]=0;if(a[e]>0)d=R=true}if(i[e]&&e==0&&ui[t].cid>0&&GY(t,tc.INFO_ROW)){if(Nj(tR[s[e]].flags&tc.TAUX_SAME_ROW_SPAN)||ez(s[e]))A=true;d=false;if(L)hY("  In SkipCellLine, level: %d, row: %d, same-row-span: %d, so EndPage: %d",e,s[e],Nj(tR[s[e]].flags&tc.TAUX_SAME_ROW_SPAN),A)}if(d||Nj(n)){if(ui[t].page<=l)ui[t].page=l+1;break e}if(f[0]&&a[e]==0&&ui[t].page<l&&I>0)break e;else break t}F=true}Ad=n;Ed=_;Rd=o;aF=A;nF=R;return F}function qJ(t,e,r){var i,f,l,a,n;if(e==0)return false;for(f=$E[r].FirstCell;f>0;f=eR[f].NextCell){if(eR[f].RowSpan>1){var c=eR[f].RowSpan;var s=eR[f].level;for(l=r;l>0&&c>1;l=$E[l].NextRow)c--;a=l;if(a>0){for(i=t+1;i<Ri;i++){n=ui[i].cid;if(n==0)return true;if(eR[n].level<s){if(eR[f].ParentCell==n)return true;else continue}if(eR[n].level>s)n=E6(s,i);if(eR[n].row==eR[f].row)continue;if(eR[n].row==a&&GY(i,tc.INFO_ROW))break;if(ui[i].page<e)continue;return false}}}}return true}function $J(t,e,r){var i,f,l;var a,n;if(e==0)return false;if(eR[r].RowSpan==1)return false;a=eR[r].level;n=rR[r].LastSpannedCell;f=eR[n].row;if(f>0){for(i=t+1;i<Ri;i++){l=ui[i].cid;if(l==0)return true;if(eR[l].level<a){if(eR[r].ParentCell==l)return true;else continue}if(eR[l].level>a)l=E6(a,i);if(eR[l].row==eR[r].row)continue;if(eR[l].row==f&&GY(i,tc.INFO_ROW))return true;if(ui[i].page<e)continue;return false}}return true}function tz(t,e,r,i,f,l,a,n,c,s,_,o){var u,T;var A,E,R,L;var C=false;Ld=f;Cd=l;Ed=a;Rd=n;cF=s;if(Nj(rR[f].flags&tc.CAUX_PAGINATION_DONE))return true;A=eR[f].row;R=c;if(eR[f].RowSpan>1||Nj(Nc[ui[t].pfmt].flags&tc.PAGE_FTR)){var I,d=0;for(I=1;I<Kl;I++){if(kl[I].InUse&&kl[I].CellId==f&&kl[I].pict>0&&Nj(kl[I].flags&tc.PARA_FRAME_IN_CELL)&&Dj(kl[I].flags&tc.PARA_FRAME_WRAP_IGNORE)){var F=mV(kl[I].height);if(F>d)d=F}}if(o)hY("  ecop1, pict h: %d",d);if(d>c)c=d}if(o)hY("  ecop1a, cl: %d, row: %d, CellTextHeight: %d, fph: %d, cph: %d",f,A,c,tR[A].FirstPageHt,n);if(eR[f].TextAngle!=0){if(l<mV(tc.MIN_VTEXT_CELL_HEIGHT)){l=mV(tc.MIN_VTEXT_CELL_HEIGHT);if(Nj(eR[f].flags&tc.CFLAG_ROW_SPANNED)||eR[f].RowSpan>1)l=Xs[0].height}if(c>l)c=l}if(o)hY("  ecop2, CellHeight: %d",c);if(!r){rR[f].height=c;rR[f].FirstPageHt=c;rR[f].LastPageHt=c;rR[f].FirstPage=e;rR[f].LastPage=e}else{rR[f].LastPageHt=c;rR[f].LastPage=e}if(eR[f].PrevCell<=0){$E[A].height=0;tR[A].flags=cj(tR[A].flags,tc.TAUX_HEIGHT_ADDED)}if(eR[f].NextCell<=0&&$E[A].MinHeight<0&&$E[A].height==0&&Nj(tR[A].flags&tc.TAUX_ALL_SPANNED)){if(!r&&!i){L=0;var g=0;for(cl=$E[A].FirstCell;cl>0;cl=eR[cl].NextCell){L=rR[cl].SpanningCell;if(cl==$E[A].FirstCell)g=eR[L].row;else if(g==0||g!=eR[L].row){g=0;break}}if(g==0||Dj(tR[g].flags&tc.TAUX_SAME_ROW_SPAN)){$E[A].height=mV(-$E[A].MinHeight)}}}if(o)hY("  ecop3, row-min-h: %d, rh: %d, MinCelllHeight: %d",$E[A].MinHeight,$E[A].height,l);if($E[A].MinHeight<0)l=0;u=l>c?l:c;if(o)hY("  ecop4, TblCellHeight: %d, is-lsc: %d, rs: %x, srs: %x",u,C8(f),eR[f].flags&tc.CFLAG_ROW_SPANNED,tR[A].flags&tc.TAUX_SAME_ROW_SPAN);if(Nj(eR[f].flags&tc.CFLAG_ROW_SPANNED)){if(Nj(tR[A].flags&tc.TAUX_ALL_SPANNED)){u=0;if(eR[f].NextCell<=0){var P=$E[A].PrevRow;if(P>0){if(n<tR[P].EndPgHeight){var S=n;n=tR[P].EndPgHeight;if(zJ(P,e,go)<n-S){JJ(P,e,go,n-S)}}if(a<tR[P].EndPageColHeight)a=tR[P].EndPageColHeight}}}else if(C8(f)){u=F8(f,e)}else u=0}else if(eR[f].RowSpan>1){var h,O;rR[f].CurCellHeight=u;rR[f].CurCellHeightPage=e;if(Nj(tR[A].flags&tc.TAUX_SAME_ROW_SPAN)){if(!r&&!i){var v=mV(rR[f].MinHeightWithBotPad);if(v<0)u=-v;else if(v>0&&u<v)u=v}}else if($E[A].MinHeight!=0){for(cl=$E[A].FirstCell;cl>0;cl=eR[cl].NextCell)if(cl!=f&&Dj(eR[cl].flags&tc.CFLAG_ROW_SPANNED))break;if(cl<0)u=Math.abs(mV($E[A].MinHeight));else u=0}else u=0;O=eR[f].RowSpan;for(h=eR[f].row;h>0&&O>1;h=$E[h].NextRow)O--;if(h>0){tR[h].MinEndY=n;if(o)PY("  ecop4c, MinEndY for the spanned row: %d set to: %d",h,tR[h].MinEndY)}rR[f].flags=cj(rR[f].flags,tc.CAUX_ADD_TOP_SPANNING_CELL_HT);if(qJ(t,e,A)){rR[f].flags|=tc.CAUX_ADD_TOP_SPANNING_CELL_HT;if(rR[f].CurCellHeightPage==e&&rR[f].CurCellHeight>tR[A].TopRowHt){tR[A].TopRowHt=rR[f].CurCellHeight;u=rR[f].CurCellHeight;C=true;if(o)PY("   ecop4d, cur cell height added, trh: %d, tch: %d",tR[A].TopRowHt,u)}}if($J(t,e,f))rR[f].flags|=tc.CAUX_ADD_TOP_SPANNING_CELL_HT}else{var p=$E[A].MinHeight>0?W6(f):0;var N=mV(rR[f].MinHeightWithBotPad+p);if(r)N=0;if(N<0)u=-N;else if(N>0&&u<N)u=N}if(eR[f].RowSpan>1)s=true;if(o)hY("  ecop5, TblCellHeight: %d, row spanned: %d",u,s);if(HV(l)>$E[A].MinPictHeight)$E[A].MinPictHeight=HV(l);if(Dj(eR[f].flags&tc.CFLAG_ROW_SPANNED)){if(r&&$E[A].MinHeight>0&&u<mV($E[A].MinHeight)){if(mV($E[A].MinHeight)<=po[e].BodyHt){for(cl=$E[A].FirstCell;cl>0;cl=eR[cl].NextCell)if(eR[cl].RowSpan>1||Nj(eR[cl].flags&tc.CFLAG_ROW_SPANNED))break;if(cl<=0){u=mV($E[A].MinHeight);tR[A].flags|=tc.TAUX_MIN_HEIGHT_USED}}}if(r&&tR[A].TopRowHt<u){tR[A].TopRowHt=u;if(tR[A].MinEndY-tR[A].CurPgHeight>tR[A].TopRowHt){tR[A].TopRowHt=tR[A].MinEndY-tR[A].CurPgHeight;if(o)PY("  ecop5aa, TopRowHt adjusted for the taller spanning row, new TopRowHt: %d, MinEndY: %d, row begin cpg: %d",tR[A].TopRowHt,tR[A].MinEndY,tR[A].CurPgHeight)}}if(i&&tR[A].BotRowHt<u)tR[A].BotRowHt=u;if(i&&tR[A].FirstPage==e&&tR[A].FirstPageHt<u)tR[A].FirstPageHt=u;if(i&&tR[A].FirstPage==e&&tR[A].FirstPageHt<rR[f].FirstPageHt)tR[A].FirstPageHt=rR[f].FirstPageHt;if(i&&eR[f].PrevCell>0&&$E[A].height>tR[A].FirstPageHt)tR[A].FirstPageHt=$E[A].height;if(r&&tR[A].TopRowHt<$E[A].height&&$E[A].MinHeight!=0&&eR[f].RowSpan==1&&$E[A].height>u)tR[A].TopRowHt=$E[A].height;if(r){var D=true;for(T=t+1;T<Ri;T++){if(ui[T].cid==0||eR[ui[T].cid].level<eR[f].level)break;if(eR[ui[T].cid].level>eR[f].level)continue;if(GY(T,tc.INFO_ROW)&&ui[T].page<e)break;if(ui[T].page<e)continue;else{D=false;break}}if(D){for(cl=eR[f].NextCell;cl>0;cl=eR[cl].NextCell){if(rR[cl].SpanningCell>0){L=rR[cl].SpanningCell;if(rR[L].LastSpannedCell==cl){if(rR[L].CurCellHeightPage==e&&rR[L].CurCellHeight>tR[A].TopRowHt){tR[A].TopRowHt=rR[L].CurCellHeight}}}}}}}if(o)hY("  ecop5b, iptr: %d, h: %d, ipbr: %d, h: %d",r,tR[A].TopRowHt,i,tR[A].BotRowHt);if((i||r)&&eR[f].PrevCell<=0&&$E[A].MinHeight>0)$E[A].height=0;if(o)hY("  ecop6, row: %d, cell-aux-mh: %d, row-h: %d, tch: %d, cellaux min h: %d, min rh: %d, min pict h:%d, tch: %d, RowSpan: %d",A,rR[f].MinHeight,$E[A].height,u,$E[A].MinHeight,$E[A].MinPictHeight,u,eR[f].RowSpan);if(true){if($E[A].height<u)$E[A].height=u;eR[f].LastLine=t}if(o)hY(" ecop7, row-h: %d,trh: %d, brh: %d",$E[A].height,tR[A].TopRowHt,tR[A].BotRowHt);rR[f].flags|=tc.CAUX_PAGINATION_DONE;if(tR[A].EndPgHeight<n)tR[A].EndPgHeight=n;if(tR[A].EndPageColHeight<a)tR[A].EndPageColHeight=a;a-=R;n-=R;if(n<tR[A].CurPgHeight&&e==tR[A].PageNo)n=tR[A].CurPgHeight;if(a<tR[A].PageColHeight&&e==tR[A].PageNo)a=tR[A].PageColHeight;if(r&&!GY(t,tc.INFO_ROW)){var M;for(M=t+1;M<Ri;M++)if(ui[M].page>=e)break;if(M<Ri){var G=ui[M-1].page<e&&GY(M,tc.INFO_ROW);var B=false;if(C)G=true;if(!G){var H=ui[M].cid;var m=H==0?0:eR[H].row;var w=eR[f].level;if(m==0||eR[H].level<=eR[f].level||A!=R6(w,m)){if(A!=m)B=G=true}}if(eR[f].RowSpan>1)R=0;if(G){var b=tR[A].TopRowHt;if(b==0)b=R;n=_+b;a=b;tR[A].flags|=tc.TAUX_HEIGHT_ADDED}if(B&&eR[f].ParentCell>0){var x=eR[f].ParentCell;rR[x].NestedRowHeightNotYetAdded=tR[A].TopRowHt}}}f=0;if(o)hY(" ecop8, cph: %d, pcl: %d, cth: %d",n,a,R);Ld=f;Cd=l;Ed=a;Rd=n;cF=s;return true}function ez(t){var e;for(e=$E[t].FirstCell;e>0;e=eR[e].NextCell){if(Dj(rR[e].flags&tc.CAUX_PAGE_OVERFLOW)){if(Nj(eR[e].flags&tc.CFLAG_ROW_SPANNED)){var r=rR[e].SpanningCell;if(r>0){if(Nj(rR[r].flags&tc.CAUX_PAGE_OVERFLOW))continue;if(Nj(rR[r].flags&tc.CAUX_PAGINATION_DONE))continue}}break}}return e<=0}function rz(t){var e,r=eR[t].row;tR[r].flags=cj(tR[r].flags,tc.TAUX_SAME_ROW_SPAN|tc.TAUX_ALL_SPANNED|tc.TAUX_SAME_SPANNING_ROW);for(e=$E[r].FirstCell;e>0;e=eR[e].NextCell){if(eR[e].RowSpan!=eR[t].RowSpan)break;if(Nj(eR[e].flags&tc.CFLAG_ROW_SPANNED)!=Nj(eR[t].flags&tc.CFLAG_ROW_SPANNED))break}if(e<=0)tR[r].flags|=tc.TAUX_SAME_ROW_SPAN;for(e=$E[r].FirstCell;e>0;e=eR[e].NextCell)if(Dj(eR[e].flags&tc.CFLAG_ROW_SPANNED))break;if(e<=0)tR[r].flags|=tc.TAUX_ALL_SPANNED;if(Nj(tR[r].flags&tc.TAUX_ALL_SPANNED)){for(e=$E[r].FirstCell;e>0;e=eR[e].NextCell)if(rR[e].SpanningCell!=rR[t].SpanningCell)break;if(e<=0)tR[r].flags|=tc.TAUX_SAME_SPANNING_ROW}return Nj(tR[r].flags&tc.TAUX_SAME_ROW_SPAN)}function iz(t){var e;for(e=$E[t].FirstCell;e>0;e=eR[e].NextCell)if(Nj(eR[e].flags&tc.CFLAG_ROW_SPANNED))return true;return false}function fz(t,e){var r;var i,f,l;if(ui[t].tag==null)return true;r=ui[t].tag;l=ui[t].len;for(i=0;i<l;i++){f=r[i];while(f!=0){ac[f].line=t;f=ac[f].next}}return true}function lz(t){var e,r,i,f,l;var a=0,n,c;po[t].TblHdrHt=0;po[t].TblHdrFirstLine=po[t].TblHdrLastLine=-1;r=i=-1;f=l=-1;e=po[t].FirstLine-1;if(t==0||e<0||Li||oi.FittedView)return true;if(ui[po[t].FirstLine].cid==0)return true;n=ui[e].cid;c=eR[n].row;if(n==0)return true;while(e>=0){n=ui[e].cid;if(n==0)break;if(eR[n].level>0)n=E6(0,-n);c=eR[n].row;if(Nj($E[c].flags&tc.ROWFLAG_HDR)){var s=$E[c].PrevRow;if(s>0&&Dj($E[s].flags&tc.ROWFLAG_HDR)){i=r=-1;po[t].TblHdrHt=0;a=0;continue}if(i==-1)i=e;r=e;if(c!=a){po[t].TblHdrHt+=$E[c].height;a=c}}e--}po[t].TblHdrFirstLine=r;po[t].TblHdrLastLine=i;if(r==-1){po[t].TblHdrFirstLine=f;po[t].TblHdrLastLine=l}return true}function az(t,e,r){var i=0,f,l;var a=0;if(e<0||e>=Ri||Li||oi.FittedView)return 0;f=ui[e].cid;if(f==0)return 0;l=eR[f].row;r=false;while(e>=0){f=ui[e].cid;if(f==0)break;if(eR[f].level>0)f=E6(0,-f);l=eR[f].row;if(Nj($E[l].flags&tc.ROWFLAG_HDR)){var n=$E[l].PrevRow;if(ui[e].page<t)r=true;if(n>0&&Dj($E[n].flags&tc.ROWFLAG_HDR)){a=0;i=0;continue}if(l!=i){a+=$E[l].height;i=l}}e--}hF=r;return a}_i.TerPrintBlankPageBefore=function(t){if(!lv&&!_i.TerCreateControl())return false;if(t<0||t>=To)return false;return Nj(po[t].flags&tc.PAGE_PRINT_BLANK_PAGE_BEF)};_i.TerExpandWidthToFit=function(t){var e,r,i=0,f,l;var a;var n=false;if(!lv||!QD())_i.TerCreateControl();for(e=0;e<iR;e++){f=$E[e].indent;for(r=$E[e].FirstCell;r>0;r=eR[r].NextCell)f+=eR[r].width;if(i<f)i=f}for(e=0;e<ro;e++){l=(eo[e].PgWidth-to[e].LeftMargin-to[e].RightMargin)*1440;if(i>l){a=i/1440+to[e].LeftMargin+to[e].RightMargin;if(to[e].IsPortrait)to[e].PprWidth=a;else to[e].PprHeight=a;n=true}}if(n)_i.TerRepaginate(t);return true};_i.TerIsBlankPage=function(t){var e;if(!lv||!QD())_i.TerCreateControl();for(e=po[t].FirstLine;e<=po[t].LastLine;e++){if(ui[e].page!=t)continue;if(ui[e].fid>0)break;if(ui[e].cid>0){var r=ui[e].cid;if(eR[r].border!=0)break;if(eR[r].shading!=0)break;if(!MJ(eR[r].BackColor,tc.CLR_WHITE))break}if(ui[e].len>=1){var i=ui[e].txt;var f,l=ui[e].len;for(f=0;f<l;f++){if((i[f]==" "||i[f]<32)&&i[f]!=tc.PICT_CHAR)continue;break}if(f<l)break}}return e>po[t].LastLine};_i.TerGetPageParam=function(t,e){var r=new tc.ClsHdrFtr,i=new tc.ClsHdrFtr;var f,l,a;if(!lv||!QD())_i.TerCreateControl();if(t<0)t=Lo;if(e==tc.PP_FLAGS)return po[t].flags;else if(e==tc.PP_FIRST_LINE)return po[t].FirstLine;else if(e==tc.PP_LAST_LINE)return po[t].LastLine;else if(e==tc.PP_NO)return t;else if(e==tc.PP_DISP_NO)return po[t].DispNbr;else if(e==tc.PP_TOP_SECT)return po[t].TopSect;else if(e==tc.PP_PAGE_HDR_HT){a=po[t].FirstLine;B5();l=G5(a);if(Cz(t)<0)return to[l].TopMargin*1440;else{return HV(r.height)+to[l].HdrMargin*1440}}else if(e==tc.PP_PAGE_FTR_HT){a=po[t].FirstLine;B5();l=G5(a);if(Iz(t)<0)return to[l].BotMargin*1440;else{return HV(i.height)+to[l].FtrMargin*1440}}else if(e==tc.PP_PAGE_BODY_HT)return HV(po[t].BodyHt);else if(e==tc.PP_PAGE_BODY_AVAIL_HT)return HV(po[t].BodyHt-po[t].BodyTextHt);else if(e==tc.PP_HDR_CHAR){if(Cz(t)<0)return 0;for(f=r.FirstLine;f>=0;f--){if(ui[f].len==1&&Nj(ui[f].flags&tc.LFLAG_HDRS_FTRS))return ui[f].txt[0]}}else if(e==tc.PP_FTR_CHAR){if(Iz(t)<0)return 0;for(f=r.FirstLine;f>=0;f--){if(ui[f].len==1&&Nj(ui[f].flags&tc.LFLAG_HDRS_FTRS))return ui[f].txt[0]}}return tc.FP_ERROR};_i.TerPageFromLine=function(t){if(!lv||!QD())_i.TerCreateControl();return nz(t,-1)};function nz(t,e){var r=0;if(t<0)t=0;if(t>=Ri)t=Ri-1;if(e>=0&&e<To&&Nj(Nc[ui[t].pfmt].flags&tc.PAGE_HDR_FTR)&&G5(t)==G5(po[e].FirstLine))r=e;else{if(Nj(ui[t].cid))r=ui[t].page;else{for(r=0;r<To;r++)if(po[r].FirstLine>t)break;if(r>0)r--}}return r}function cz(t){var e;if(t>=Ri)return Lo=To-1;if(oi.PageMode&&yR&&Nj(Nc[ui[t].pfmt].flags&tc.PAGE_HDR_FTR)){for(e=0;e<Dl;e++)if(!pl[e].empty&&t>=pl[e].PageFirstLine&&t<=pl[e].PageLastLine+1)break;if(e<Dl)return Lo}Lo=nz(t,-1);return Lo}function sz(t,e){if(e<0||e>=0)return t;if(t<0||t>=To)return 0;if(Nj(Nc[ui[e].pfmt].flags&tc.PAGE_HDR_FTR)&&t+1<To){var r=po[t].TopSect;if(r<0||r>=ro)return t;if(e>=eo[r].hdr.FirstLine&&e<=eo[r].hdr.LastLine){if(eo[r].fhdr.FirstLine>=0)t++}if(e>=eo[r].ftr.FirstLine&&e<=eo[r].ftr.LastLine){if(eo[r].fftr.FirstLine>=0)t++}}return t}function _z(t){if(t){Fo=0;nO|=tc.TOFLAG2_FULL_REPAGE}else{var e=br;var r=ui[br].page;if(br<po[r].FirstLine+10){if(r>1)e=po[r-1].FirstLine;else e=0}if(e<Fo)Fo=e}Ro=oi.modified-1;Oo=true;if(_l)zQ();return true}_i.TerInsertPageRef=function(t,e,r,i){var f="";var l;if(!lv||!QD())_i.TerCreateControl();if(!oi.PageMode)return false;if(!Lm(br,jt))return false;if(!sy(t,true))return false;f=t+" ";if(e)f+="\\h ";if(r)f+="\\* alphabetic ";f+="\\* MERGEFORMAT ";l=$w();Oc=l=_i.TerGetFieldFont(l,tc.FIELD_PAGE_REF,f);_i.InsertTerText("1",i);Oc=-1;oi.modified++;return true};_i.TerGetTextHeight=function(){var t=0;var e;if(!lv||!QD())_i.TerCreateControl();if(oi.PageMode){var r=0;for(e=0;e<To;e++){r+=po[e].BodyTextHt}return HV(r)+tc.RULER_TOLERANCE}else{var i;for(i=0;i<Ri;i++)t+=$q(i,false);return vV(t)}};function oz(t,e){var r;var i=0;if(t<0)e=0;if(t>=To)t=To-1;for(r=t;r<t+e;r++)i+=uz(r);return i}function uz(t){var e,r,i=0;var f;if(Ci)i=yV(rr+ir);if(oi.FittedView)r=po[t].ScrHt;else{if(Nj(rO&tc.TFLAG8_HIDE_PAGE_BLANK_AREA)&&!Ci&&t==To-1&&!yR)r=po[t].TextHt;else if(Nj(fO&tc.TFLAG10_EXTEND_AUTO_VSCROLL)&&!Ci&&t==To-1)r=po[t].TextHt;else{f=po[t].FirstLine;e=G5(f);r=eo[e].PgHeight*wt;if(!Ci&&!yR)r-=(to[e].TopMargin+to[e].BotMargin)*wt}}r+=i;return r}_i.TerGetPageCount=function(){if(!lv||!QD())_i.TerCreateControl();Id=1;dd=0;if(!oi.PageMode)return false;Id=To;dd=Lo;return true};_i.TerGetPagePos=function(){var t,e;dd=0;Fd=0;if(!lv||!QD())_i.TerCreateControl();if(!oi.PageMode)return false;e=qe;t=Gt;if(Gt>Ze&&e+1<To){e++;t-=Ze}if(t<0)t=0;t=vV(t);dd=e;Fd=t;return true};function Tz(){return Az(false)}function Az(t){var e,r=0,i=0,f,l,a,n;var c;if(!oi.FittedView){e=_i.TerGetPageSect(Lo);if(Ci)r=Nt*eo[e].PgWidth+2*bV(er);else r=Nt*(eo[e].PgWidth-to[e].LeftMargin-to[e].RightMargin)}else r=je;for(f=0;f<Dl;f++){var s=0;if(pl[f].empty)continue;if(t&&oi.ShowHorBar&&Nj(fO&tc.TFLAG10_AUTO_HSCROLL_BAR))s=Rh;if(pl[f].y>Gt+Mt+s)continue;if(pl[f].y+pl[f].height<Gt)continue;if(oi.FittedView&&pl[f].CellId==0&&pl[f].ParaFrameId==0){a=pl[f].y;l=pl[f].x;for(n=pl[f].PageFirstLine;n<=pl[f].PageLastLine;n++){if(n<0||n>=Ri)continue;c=ui[n].height;var _;if(a>Gt+Mt+s)continue;a+=yV(c);if(a<Gt)continue;_=pl[f].x+H$(n,false,dS,true);if(_>l)l=_}}else{a=pl[f].y;l=pl[f].x+pl[f].width;for(n=pl[f].PageFirstLine;n<=pl[f].PageLastLine;n++){if(n<0||n>=Ri)continue;c=ui[n].height;if(a>Gt+Mt+s)continue;a+=yV(c);if(a<Gt)continue;if(ui[n].len<=2){var o=ib(n,0);if(Nj(xs[o].style&tc.PICT)){var u=Eu?DV(xs[o].PictWidth):dV(xs[o].PictWidth);if(pl[f].x+u>l)l=pl[f].x+u}}}}if(l>i)i=l}if(i<r)i=r;return i}_i.TerGetPageSect=function(t){var e;if(!lv||!QD())_i.TerCreateControl();if(t<0||t>=To)return 0;e=po[t].FirstLine;return G5(e)};function Ez(t){if(!oi.PageMode)return true;Lo=qe;if(t>Ze)Lo++;if(Lo>=To)Lo--;return true}function Rz(t,e,r,i,f,l,a){var n=0;var c,s,_,o,u,T;var A;var E;var R,L;var C;var I,d=Eu,F;var g=i;var P=null;ZU("ExtractFootnote");if(oi.FittedView)return 0;if(Nj(Nc[ui[g].pfmt].flags&tc.PAGE_HDR_FTR))return 0;if(Dj(cc)&&null==(cc=[Gn]))return 0;Ib(true);T=(eo[f].PgWidth-to[f].LeftMargin-to[f].RightMargin)*Ai;u=ui[i].len;for(c=0;c<u;c++){if(g>i)break;_=ib(g,c);R=xs[_].style;if(c==0&&vj(R)){o=fb(g,c);L=xs[o].style;if(vj(L)){while(c<u){_=ib(g,c);if(!vj(xs[_].style))break;c++}}if(c==u)break}while(c<u){_=ib(g,c);if(vj(xs[_].style))break;c++}if(c==u)break;s=0;F=true;while(c<u){if(F){Eu=!l;P=vq(g);Eu=d;F=false}_=ib(g,c);C=Sm(g,c);I=vj(xs[_].style);if(true||xs[_].rtl&&Nj(P))A=P[c];else A=Gx(_,l,C);if(!I||s>=Gn){E=s;wn[E]=0;n+=QB(t,e,r+n,i,E,T,l,a);if(!I)break;s=0}wn[s]=C;if(wn[s]==tc.HPARA_CHAR)wn[s]=Bn;dc[s]=_;cc[s]=A;s++;c++;if(c==u){g++;if(g>=Ri)break;u=ui[g].len;c=0;P=null;F=true}}}Ib(false);P=null;return n}function Lz(t,e){var r,i;if(t<0)i=-t;else i=$E[t].FirstCell;r=R6(eR[i].level,po[e].LastRow);if(t<0){var f=-t,l;t=eR[f].row;if(Nj(eR[f].flags&tc.CFLAG_ROW_SPANNED))l=I8(f);else l=eR[f].RowSpan;while(l>1){if(t==r)return true;t=$E[t].NextRow;if(t<=0)return false;l--}}return t==r}function Cz(t){var e=Nj(po[t].flags&tc.PAGE_FIRST_SECT_PAGE);var r,i=po[t].TopSect;var f=Nj(po[t].DispNbr%2);var l=tc.HDR_CHAR;var a=new tc.ClsHdrFtr;jF=new tc.ClsHdrFtr;if(e&&eo[i].fhdr.FirstLine>=0&&Nj(to[i].flags&tc.SECT_HAS_TITLE_PAGE)){jF=eo[i].fhdr;return i}if(e&&Nj(to[i].flags&tc.SECT_HAS_TITLE_PAGE)){r=i;while(r>=0){if(r>=0&&eo[r].fhdr.FirstLine>=0){jF=eo[r].fhdr;return r}else if(true){r=eo[r].PrevSect}else break}return-1}r=i;l=tc.HDR_CHAR;while(r>=0){var n=-1,c=-1,s=-1;if(f||Dj(to[r].flags&tc.SECT_HAS_FACING_PAGES)){if(V5(eo[r].hdr))n=eo[r].hdr.FirstLine;if(V5(eo[r].rhdr))c=eo[r].rhdr.FirstLine;if(n>=0||c>=0){l=n>c?tc.HDR_CHAR:tc.RHDR_CHAR;break}}else{if(Nj(to[r].flags&tc.SECT_HAS_FACING_PAGES)){if(V5(eo[r].lhdr))s=eo[r].lhdr.FirstLine;if(s>=0){l=tc.LHDR_CHAR;break}}}r=eo[r].PrevSect}if(r>=0){if(l==tc.RHDR_CHAR)a=eo[r].rhdr;else if(l==tc.LHDR_CHAR)a=eo[r].lhdr;else a=eo[r].hdr;if(a.FirstLine<0)r=-1;if(r>=0)jF=a}po[t].HdrSect=r;return r}function Iz(t){var e=Nj(po[t].flags&tc.PAGE_FIRST_SECT_PAGE);var r,i=po[t].TopSect,f;var l=Nj(po[t].DispNbr%2);var a=tc.FTR_CHAR;var n=new tc.ClsHdrFtr;jF=new tc.ClsHdrFtr;if(e&&eo[i].fftr.FirstLine>=0&&Nj(to[i].flags&tc.SECT_HAS_TITLE_PAGE)){jF=eo[i].fftr;return i}if(e&&Nj(to[i].flags&tc.SECT_HAS_TITLE_PAGE)){r=i;while(r>=0){if(r>=0&&eo[r].fftr.FirstLine>=0){jF=eo[r].ftr;return r}else if(true){r=eo[r].PrevSect}else break}return-1}r=f=i;a=tc.FTR_CHAR;while(r>=0){var c=-1,s=-1,_=-1;if(l||Dj(to[r].flags&tc.SECT_HAS_FACING_PAGES)){if(V5(eo[r].ftr))c=eo[r].ftr.FirstLine;if(V5(eo[r].rftr))s=eo[r].rftr.FirstLine;if(c>=0||s>=0){a=c>s?tc.FTR_CHAR:tc.RFTR_CHAR;break}}else{if(Nj(to[r].flags&tc.SECT_HAS_FACING_PAGES)){if(V5(eo[r].lftr))_=eo[r].lftr.FirstLine;if(_>=0){a=tc.LFTR_CHAR;break}}}f=r;r=eo[r].PrevSect}if(r>=0){if(a==tc.RFTR_CHAR)n=eo[r].rftr;else if(a==tc.LFTR_CHAR)n=eo[r].lftr;else n=eo[r].ftr;if(n.FirstLine<0)r=-1;if(r>=0)jF=n}else if(f>=0){if(a==tc.RFTR_CHAR)n=eo[f].rftr;else if(a==tc.LFTR_CHAR)n=eo[f].lftr;else n=eo[f].ftr;jF=n}po[t].FtrSect=r;return r}function dz(t,e){return Fz(t,e,false)}function Fz(t,e,r){var i=t==0||Nj(po[t].flags&tc.PAGE_FIRST_SECT_PAGE);var f;var l=po[t].TopSect,a=0,n,c,s;var _=new tc.ClsHdrFtr;if(false){n=-1;if(i&&eo[l].fhdr.FirstLine>=0){n=l;a=eo[l].fhdr.height}else if(i&&Nj(to[l].flags&tc.SECT_HAS_TITLE_PAGE)){n=Cz(t);_=jF;if(n>=0)a=eo[n].fhdr.height;else{n=l;a=0}}if(n<0){var o=false;if(r){n=Cz(t);_=jF}else n=G5(po[t].FirstLine);if(n<0){n=l;o=true}if(!r||o)_=eo[n].hdr;if(n==l)a=_.height;else{c=_.TextHeight;s=(to[l].TopMargin-to[l].HdrMargin)*Ei;a=s>c?s:c}}}else{n=Cz(t);_=jF;if(n>=0)a=_.height;else a=(to[l].TopMargin-to[l].HdrMargin)*Ei}f=a>0?true:false;if(!e&&n>=0&&Nj(to[n].flags&tc.SECT_EXACT_MARGT))a=(to[n].TopMargin-to[n].HdrMargin)*Ei;if(f&&a==0)a=1;if(a<0)a=0;return a}function gz(t,e){var r=t==0||Nj(po[t].flags&tc.PAGE_FIRST_SECT_PAGE);var i;var f=po[t].TopSect,l=0,a;var n=new tc.ClsHdrFtr;var c=true;if(false){a=-1;if(r&&eo[f].fftr.FirstLine>=0){a=f;l=eo[f].fftr.height}else if(r&&Nj(to[f].flags&tc.SECT_HAS_TITLE_PAGE)){a=Iz(t);n=jF;if(a>=0)l=eo[a].fftr.height}if(a<0){var s=false;if(c){a=Iz(t);n=jF}else a=G5(po[t].FirstLine);if(a<0){a=f;if(a<0)a=0;s=true}if(!c||s)n=eo[a].ftr;l=n.height}}else{a=Iz(t);n=jF;if(a>=0)l=n.height;else l=(to[f].BotMargin-to[f].FtrMargin)*Ei}i=l>0?true:false;if(!e&&a>=0&&Nj(to[a].flags&tc.SECT_EXACT_MARGB))l=(to[a].BotMargin-to[a].FtrMargin)*Ei;if(i&&l==0)l=1;if(l<0)l=0;return l}function Pz(t){var e=t==0||Nj(po[t].flags&tc.PAGE_FIRST_SECT_PAGE);var r=po[t].TopSect;var i=Nj(po[t].DispNbr%2);if(e&&eo[r].fftr.FirstLine>=0&&(t==0||wz(r)))return eo[r].fftr.TextHeight;else{var f=r;if(i){if(j5(eo[f].rftr))return eo[r].rftr.TextHeight;else if(j5(eo[f].ftr))return eo[r].ftr.TextHeight}else{if(j5(eo[f].lftr))return eo[r].lftr.TextHeight;else if(j5(eo[f].ftr))return eo[r].ftr.TextHeight;else if(j5(eo[f].rftr))return eo[r].rftr.TextHeight}return eo[r].ftr.TextHeight}}function Sz(t){var e,r,i;var f=30;var l=Un+1;var a;var n;if(Nj(nO&tc.TOFLAG2_NO_WRAP)){Un++;return true}var c=0;for(e=l;e<Ri;e++){c+=ui[e].len;if(Nj(ui[e].flags&(tc.LFLAG_PARA|tc.LFLAG_BREAK)))break;if(c>1e3)break}if(e-l>f)f=e-l;ao=t;no=Un;co=Un+30;r=0;while(r<=f){if(l+r>=Ri)break;i=Un;a=f-r+1;if(a<20)a=20;C9(l+r,a);I9(l+r);n=false;if(Wn>Un+25)n=true;if(bn==0)n=true;if(Wn+1>=Ri)n=true;if(Un==i+1)n=true;if(Wn>Un){if(n){L9(Wn+1,Un-Wn);Wn=Un}else{for(e=Un+1;e<=Wn;e++){dp(e);Ip(e);ui[e].pfmt=0}}}if(Un<0)Un=0;if(Dj(ui[Un].flags&(tc.LFLAG_PARA|tc.LFLAG_BREAK|tc.LFLAG_LINE))){if(Un>l&&Un+1<=Ri&&Un<l+f-1&&Un>i+1)Un--;else Kn=true}if(Nj(ui[Un].flags&tc.LFLAG_SECT))ao=-1;r=Un-l+1}L9(Wn+1,Un-Wn);if(Dj(ui[Un].flags&(tc.LFLAG_PARA|tc.LFLAG_BREAK|tc.LFLAG_LINE))&&Un>l&&Un+1<=Ri&&Un>l+1)Un--;ao=-1;return true}function hz(t){var e;var r,i=Ao;if(t+1<Ao)return true;e=Ao+5;if(e<=t)e=t+10;if(e<=Ao)return true;po=fV(po,e);Ao=e;for(r=i;r<Ao;r++)po[r]=new tc.ClsPage;return true}_i.TerSetPageMultiple=function(t){if(!lv||!QD())TerCreateControl();Io=t;return true};function Oz(){if(!oi.FittedView||Eu)return 1;return Io>0?Io:tc.FITTED_VIEW_DISP_PAGES}function vz(t,e,r){var i=t,f,l,a,n;var c,s=0,_;var o,u=0,T=0;var A;var E=true,R=false;var L;c=ui[i].pfmt;if(e<0)e=-e;while(Nj(Nc[ui[e].pfmt].flags&tc.PAGE_HDR_FTR)){if(e+1>=i)break;e++}while(i>e){var C=ui[i-1].fid;if(C==0)break;if(Nj(kl[C].flags&(tc.PARA_FRAME_VPAGE|tc.PARA_FRAME_VMARG)))break;i--}if(i>0&&ui[i-1].cid>0){n=eR[ui[i-1].cid].row;if(Nj($E[n].flags&tc.ROWFLAG_HDR))R=true}while(true){f=i;t:{if(i>0&&ui[i-1].cid>0&&pz(i-1)){L=OC;var I=true;if(false&&L>0&&ui[L-1].cid>0&&!R){n=eR[ui[L-1].cid].row;if(Nj($E[n].flags&tc.ROWFLAG_HDR))I=false}if(I){if(L<i&&E){for(l=i;l>L;l--){if(Nj(ui[l].flags&tc.LFLAG_PARA_FIRST)){E=false;break}}}i=L;c=ui[i].pfmt;o=Nc[c].flags;break t}}c=ui[i].pfmt;o=Nc[c].flags;if(i>0){s=ui[i-1].pfmt;u=Nc[s].flags;T=ui[i-1].cid}if(Nj(ui[i].flags&tc.LFLAG_PARA_FIRST))E=false;while(i>e&&Nj(u&tc.PARA_KEEP_NEXT)&&Nj(ui[i].flags&tc.LFLAG_PARA_FIRST)&&(T==ui[i].cid||T==0)){if(Nj(ui[i].tabw)&&Nj(ui[i].tabw.type&(tc.INFO_SECT|tc.INFO_PAGE|tc.INFO_COL)))return i;if(Nj(ui[i].flags&tc.LFLAG_HDRS_FTRS))return i;if(false&&ui[i-1].cid>0){var d=ui[i-1].cid;i=i-2;while(i>e+1){if(Nj(ui[i].tabw)&&Nj(ui[i].tabw.type&tc.INFO_ROW)){var F=ui[i].cid;if(eR[d].level==eR[F].level)break}if(ui[i].cid==0)break;i--}if(i<=e+1){if(r)return t;else return e}s=ui[i].pfmt;u=Nc[s].flags;T=ui[i].cid;i++;c=ui[i].pfmt;o=Nc[c].flags;continue}i--;c=s;o=u;if(i>0){s=ui[i-1].pfmt;u=Nc[s].flags;T=ui[i-1].cid}}}if(i<=e){if(r)return t;else return e}while(i>e&&ui[i].fid>0&&ui[i].fid==ui[i-1].fid){i--;c=ui[i].pfmt;o=Nc[c].flags}if(i<=e){if(r)return t;else return e}for(_=i;_>e;_--)if(Nj(ui[i].flags&tc.LFLAG_PARA_FIRST))break;A=Nj(o&tc.PARA_KEEP)||i<=_+3&&Nj(o&tc.PARA_KEEP_NEXT);if(!A&&!E&&Nj(o&tc.PARA_KEEP_NEXT))A=true;while(ui[i].cid==0&&A&&i>e&&Dj(ui[i].flags&tc.LFLAG_PARA_FIRST)){i--;c=ui[i].pfmt;o=Nc[c].flags;A=Nj(o&tc.PARA_KEEP)||i<=_+3&&Nj(o&tc.PARA_KEEP_NEXT);if(!A&&!E&&Nj(o&tc.PARA_KEEP_NEXT))A=true}if(ui[i].cid==0&&Nj(Nc[c].pflags&tc.PFLAG_WIDOW)&&i>e&&Dj(ui[i].flags&tc.LFLAG_PARA_FIRST)){var g=i;if(Nj(ui[i].flags&tc.LFLAG_PARA))i--;else if(Nj(ui[i-1].flags&tc.LFLAG_PARA_FIRST))i--;if(i!=g){c=ui[i].pfmt;o=Nc[c].flags}}a=ui[i].cid;n=eR[a].row;if(a>0&&n>0&&Nj($E[n].flags&tc.ROWFLAG_KEEP_CALC)){var P,S;for(l=i;l>e&&l>0;l--){S=ui[l-1].cid;P=eR[S].row;if(n!=P){if(true||eR[a].level==0||S==0||P==0||Dj($E[P].flags&tc.ROWFLAG_KEEP_CALC))break;else{n=P;continue}}}if(l!=i){i=l;c=ui[i].pfmt;o=Nc[c].flags}}if(i<=e){if(r)return t;else return e}if(E)t=i;if(i==f)break}return i}function pz(t){var e;var r,i,f;var l=false;OC=t;while(true){if(t<0||t>=Ri)return false;r=ui[t].cid;if(r==0)return false;f=eR[r].level;i=eR[r].row;for(e=t-1;e>=0;e--){r=ui[e].cid;if(r==0)break;if(eR[r].level>f)continue;if(i!=eR[r].row)break}e++;if(ui[e].cid>0&&Nj(Nc[ui[e].pfmt].flags&tc.PARA_KEEP_NEXT)){OC=e;l=true}if(Nj($E[i].flags&tc.ROWFLAG_HDR))return l;if(e==0||ui[e-1].cid==0)return l;if(Dj(Nc[ui[e].pfmt].flags&tc.PARA_KEEP_NEXT))return l;t=e-1}}function Nz(t,e,r,i,f,l,a){var n,c=0;var s=0,_=0,o,u;var T,A;var E,R=false,L;L=false;vC=i;sF=L;for(T=r;T<=i;T++){if(GY(T,tc.INFO_FRAME))return f;if(ui[T].cid>0)return f}for(;r<i;r++){var C=ui[r].pfmt;if(Dj(Nc[C].flags&tc.PAGE_HDR_FTR))break}if(i+1>Ri)return f;n=eo[a].NextSect;if(n<0){B5();n=G5(i+1)}if(n<0)return f;if(wz(n))return f;for(T=r;T<=i;T++)if(Nj(ui[T].flags&tc.LFLAG_SOFT_COL))ui[T].flags=cj(ui[T].flags,tc.LFLAG_SOFT_COL);if(Nj(to[a].flags&tc.SECT_VAR_COL_WIDTH))return Dz(t,e,r,i,f,l,a);A=r;for(T=r;T<=i;T++){ui[T].col=0;if(Nj(Nc[ui[T].pfmt].flags&(tc.PAGE_HDR|tc.PAGE_FTR)))continue;ui[T].col=c;u=0;if(ui[T].fid==0){o=ui[T].cid;if(o==0)u=ui[T].height+wW(T,false);else{if(Nj(ui[T].tabw)&&Nj(ui[T].tabw.type&tc.INFO_ROW)&&eR[ui[T].cid].level==0){u=$E[eR[o].row].height}else continue}}else continue;if(T>r&&Nj(ui[T-1].tabw)&&Nj(ui[T-1].tabw.type&tc.INFO_COL))E=true;else E=false;if(R)E=false;R=false;if(T>r&&(_+u>e||E)){if(c+1<t){if(_>s)s=_;if(!E){T=vz(T,A,l);if(GY(T,tc.INFO_ROW)){T--;while(T>=A){if(ui[T].cid==0||GY(T,tc.INFO_ROW)&&L6(T)==0)break;T--}T++}ui[T].flags|=tc.LFLAG_SOFT_COL}_=0;A=T;c++;R=true;T--;continue}else if(E||_+u>f){T=vz(T,A,l);vC=T-1;sF=true;return s}}_+=u}if(_>s)s=_;vC=i;sF=L;return s}function Dz(t,e,r,i,f,l,a){var n=0,c=0,s,_;var o,u;var T,A=false,E;E=false;vC=i;sF=E;u=r;Un=r-1;go=0;for(o=r;o<Ri;o++){if(o>r&&GY(o-1,tc.INFO_SECT)){i=o-1;break}if(o>Un)Sz(a);if(Nj(Nc[ui[o].pfmt].flags&(tc.PAGE_HDR|tc.PAGE_FTR)))continue;_=0;if(ui[o].fid==0){s=ui[o].cid;if(s==0)_=ui[o].height+wW(o,false);else{if(Nj(ui[o].tabw)&&Nj(ui[o].tabw.type&tc.INFO_ROW)&&eR[ui[o].cid].level==0){_=$E[eR[s].row].height}else continue}}else continue;if(o>r&&Nj(ui[o-1].tabw)&&Nj(ui[o-1].tabw.type&tc.INFO_COL))T=true;else T=false;if(A)T=false;A=false;if(o>r&&(c+_>e||T)){if(go+1<t){if(c>n)n=c;if(!T){o=vz(o,u,l);if(GY(o,tc.INFO_ROW)){o--;while(o>=u){if(ui[o].cid==0||GY(o,tc.INFO_ROW)&&L6(o)==0)break;o--}o++}ui[o].flags|=tc.LFLAG_SOFT_COL}c=0;u=o;go++;Un=o-1;A=true;o--;continue}else if(T||c+_>f){o=vz(o,u,l);vC=o-1;sF=true;return n}}c+=_}if(c>n)n=c;vC=i;sF=E;return n}function Mz(t){var e,r,i,f;e=$E[t].FirstCell;for(r=e;r>0;r=eR[r].NextCell)if(Nj(eR[r].flags&tc.CFLAG_VALIGN_BASE))break;if(r<=0)return true;i=0;for(r=e;r>0;r=eR[r].NextCell){if(eR[r].RowSpan>1)continue;if(Nj(eR[r].flags&tc.CFLAG_VALIGN_BASE)&&rR[r].BaseHeight>i)i=rR[r].BaseHeight}for(r=e;r>0;r=eR[r].NextCell){if(eR[r].RowSpan>1)continue;rR[r].SpaceBefore=i-rR[r].BaseHeight;rR[r].height+=rR[r].SpaceBefore}if($E[t].MinHeight<0)return true;f=0;for(r=e;r>0;r=eR[r].NextCell){if(eR[r].RowSpan>1)continue;if(rR[r].height>f)f=rR[r].height}if(f>$E[t].height)$E[t].height=f;return true}function Gz(){var t,e;if(!oi.PrintView)return false;if(oi.PageMode){if(WR)y5();yR=false;t=l$(br);oi.PageMode=false;oi.FittedView=false;Dl=1;lW(0);pl[0].ScrFirstLine=pl[0].ScrLastLine=fr;pl[0].RowOffset=0;pl[0].PageFirstLine=0;pl[0].PageLastLine=Ri-1;Xt=t-Gt;if(Xt<0)Xt=0;if(Xt>Mt)Xt=Mt;Gt=0;fr=br;while(fr>0){e=$q(fr,true);if(e>Xt)break;Xt-=e;fr--}pl[0].ScrFirstLine=pl[0].ScrLastLine=fr;Dt=Mt/xs[0].height;we=br-fr;Dt=we+1;Ue=-1}else{Xt=l$(br);oi.PageMode=true;By(false,Lo,Lo);t=l$(br);Gt=t-Xt;if(Gt<0)Gt=0}if(oi.PageMode&&Dj(oi.FittedView))Wr=true;else Wr=false;BG();cG();return true}function Bz(){if(!oi.PrintView)return false;Fo=0;if(oi.FittedView)oi.FittedView=false;else{oi.FittedView=true;if(!oi.PageMode)return Gz();else if(yR)return W5()}if(oi.PageMode&&Dj(oi.FittedView))Wr=true;else Wr=false;tB();if(oi.PageMode)_i.TerRepaginate(true);else cG();return true}function Hz(){if(!oi.WordWrap||!oi.PageMode||oi.FittedView)return false;FS=!FS;if(!FS)Ci=false;_i.TerRepaginate(true);return true}function mz(t,e){if(Nj(Nc[ui[t].pfmt].flags&tc.PAGE_HDR_FTR))return false;if(Nj(ui[t].fid))return false;return dm(t,e)}_i.TerPageBreak=function(t){var e;var r;var i=false,f=false,l;if(!lv||!QD())_i.TerCreateControl();if(!MY(Ri+1))return true;if(!mz(br,jt))return false;if(!Lm(br,jt))return false;if(ui[br].cid>0){var a,n,c;var s;for(s=br-1;s>=0;s--){if(ui[s].cid==0)break;a=ui[s].cid;if(eR[a].level>0)continue;if(GY(s,tc.INFO_ROW))break}if(s>=0&&ui[s].page!=ui[br].page)return false;br=s+1;jt=0;if(s>=0){n=eR[ui[s].cid].row;if(n>0){c=$E[n].NextRow;$E[n].NextRow=-1;if(c>0)$E[c].PrevRow=-1}}f=true}if(jt>0&&_m(br,jt,0)){br++;jt=0;i=true}r=$w();e=br;if(br==0||Dj(ui[br-1].flags&tc.LFLAG_PARA)||i){if(Dj(aO&tc.TOFLAG_MERGE_PRINT_RECT)&&!f){ew(br,Bn,r,ui[br].pfmt,0,0);br++}}if(xs[r].FieldId!=0)r=_i.TerGetFieldFont(r,0,null);ew(br,tc.PAGE_CHAR,r,-1,0,-1);ui[br].cid=0;ui[br].pfmt=0;l=Nj(iO&tc.TFLAG9_WORD2007_PAGE_BREAK)&&br+1<Ri&&ui[br+1].len==1&&Nj(ui[br+1].flags&tc.LFLAG_PARA);if(f||l){br++;ew(br,Bn,r,0,0,0)}if(f)_i.TerFlushUndo();else V8(e,0,br,0,tc.CHAR_I);br++;if(br-fr>=Dt||br-fr<0){fr=br-Dt/2;if(fr<0)fr=0}we=br-fr;uA=tc.HILIGHT_OFF;oi.modified++;if(t){yJ(false,true,0,true);cG()}return true};function wz(t){var e,r=to[t].FirstLine;var i=eo[t].PrevSect;if(Nj(to[t].flags&tc.SECT_NEW_PAGE))return true;if(i>=0){if(to[i].IsPortrait!=to[t].IsPortrait)return true;if(to[i].PprWidth*100!=to[t].PprWidth*100)return true;if(to[i].PprHeight*100!=to[t].PprHeight*100)return true}for(e=r;e<Ri;e++)if(Dj(Nc[ui[e].pfmt].flags&tc.PAGE_HDR_FTR))break;if(e<Ri&&Nj(Nc[ui[e].pfmt].pflags&tc.PFLAG_PAGE_BREAK))return true;return false}function bz(t){var e,r;if(t==0||ui[t-1].fid==0)return true;e=ui[t-1].fid;if(e==ui[t].fid)return true;r=kl[e].NextId;if(r==0)return true;if(ui[t].fid==0||ui[t].fid!=r){while(r>0){kl[r].flags=cj(kl[r].flags,tc.PARA_FRAME_TEXT_BOX);kl[r].flags|=tc.PARA_FRAME_RECT;kl[r].flags2|=tc.PF2_EMPTY_TEXT_BOX;kl[r].ShapeType=tc.SHPTYPE_RECT;r=kl[r].NextId}}return true}function xz(t){var e;var r;var i,f,l=0,a;if(Dj(ui[t].flags&tc.LFLAG_PICT))return 0;e=nb(t);for(i=0;i<ui[t].len;i++){r=e[i];if(xs[r].InUse&&Nj(xs[r].style&tc.PICT)&&xs[r].FrameType!=tc.PFRAME_NONE&&xs[r].ParaFID>0){f=xs[r].ParaFID;if(kl[f].ShapeType==tc.SHPTYPE_PICT_FRAME){if(Nj(kl[f].flags&tc.PARA_FRAME_POSITIONED)){a=kl[f].y+kl[f].height;if(a>l)l=a}}}}sb(t);return mV(l)}function yz(t,e){var r;var i;var f,l;if(Dj(ui[t].flags&tc.LFLAG_PICT))return false;r=nb(t);for(f=0;f<ui[t].len;f++){i=r[f];if(xs[i].InUse&&Nj(xs[i].style&tc.PICT)&&xs[i].FrameType!=tc.PFRAME_NONE&&xs[i].ParaFID>0){l=xs[i].ParaFID;kl[l].PageNo=e;kl[l].flags|=tc.PARA_FRAME_PAGE_BREAK;kl[l].flags=cj(kl[l].flags,tc.PARA_FRAME_POSITIONED)}}sb(t);return false}function Wz(t,e,r){var i;var f;var l=false;var a,n;if(Dj(ui[t].flags&tc.LFLAG_PICT))return false;i=nb(t);for(a=0;a<ui[t].len;a++){f=i[a];if(xs[f].InUse&&Nj(xs[f].style&tc.PICT)&&xs[f].FrameType!=tc.PFRAME_NONE&&xs[f].ParaFID>0){n=xs[f].ParaFID;kl[n].InUse=true;if(kl[n].PageNo>e)kl[n].flags=cj(kl[n].flags,tc.PARA_FRAME_POSITIONED);if(Dj(kl[n].flags&tc.PARA_FRAME_POSITIONED)){if(r){if(Dj(kl[n].flags&tc.PARA_FRAME_LINE)&&kl[n].ShapeType!=tc.SHPTYPE_LINE)l=true}else l=true}if(oi.FittedView&&ui[t].cid>0&&xs[f].FrameType==tc.PFRAME_RIGHT)kl[n].flags|=tc.PARA_FRAME_IN_CELL;kl[n].PageNo=e;kl[n].CellId=ui[t].cid}}sb(t);return l}function Uz(t,e){var r;var i;var f,l;if(Dj(ui[t].flags&tc.LFLAG_PICT))return false;r=nb(t);for(f=0;f<ui[t].len;f++){i=r[f];if(xs[i].InUse&&Nj(xs[i].style&tc.PICT)&&xs[i].FrameType!=tc.PFRAME_NONE&&xs[i].ParaFID>0){l=xs[i].ParaFID;if(kl[l].PageNo==e+1&&Nj(kl[l].flags&tc.PARA_FRAME_PAGE_BREAK))return true}}sb(t);return false}function kz(t){var e;var r;var i=false;var f,l;if(Dj(ui[t].flags&tc.LFLAG_PICT))return false;e=nb(t);for(f=0;f<ui[t].len;f++){r=e[f];if(xs[r].InUse&&Nj(xs[r].style&tc.PICT)&&xs[r].FrameType!=tc.PFRAME_NONE&&xs[r].ParaFID>0){l=xs[r].ParaFID;kl[l].flags=cj(kl[l].flags,tc.PARA_FRAME_POSITIONED)}}sb(t);return i}function Xz(){var t,e,r,i,f,l;var a,n,c,s,_,o=0,u=-1,T;var A=oi.modified;var E;var R;var L;var C,I=0;var d,F,g,P,S;var h;ZU("CreateEndnote");for(a=0;a<Ys;a++)if(xs[a].InUse&&Nj(xs[a].style&tc.ENOTETEXT))break;if(a==Ys)return true;s=-1;for(t=0;t<Ri;t++){c=ui[t].pfmt;if(c==s)continue;if(Nj(Nc[c].pflags&tc.PFLAG_ENDNOTE)){iw(t,1,tc.CHAR_D);if(br>t)br--;if(uA!=tc.HILIGHT_OFF&&sA>t)sA--;if(uA!=tc.HILIGHT_OFF&&_A>t)_A--;t--}else s=c}e=0;if(!BE)e=Ri-1;f=0;P=false;t:while(true){for(t=e;t<Ri;t++)if(Nj(ui[t].flags&tc.LFLAG_SECT))break;if(t==Ri){P=true;t--}r=t;l=r;h=true;d=br>r;F=uA!=tc.HILIGHT_OFF&&sA>r;g=uA!=tc.HILIGHT_OFF&&_A>r;for(t=f;t<=l;t++){if(Dj(ui[t].flags2&tc.LFLAG2_ENOTETEXT)){if(Nj(nO&tc.TOFLAG2_SSE_READ)){E=nb(t);for(a=0;a<ui[t].len;a++){if(Nj(xs[E[a]].style&tc.ENOTETEXT)){ui[t].flags2|=tc.LFLAG2_ENOTETEXT;break}}sb(t)}if(Dj(ui[t].flags2&tc.LFLAG2_ENOTETEXT))continue}if(ui[t].len==0)continue;i=0;if(h){if(u<0)u=_i.TerCreateParaId(-1,true,360,0,-360,0,0,0,0,tc.PFLAG_ENDNOTE,0,0,0,0);i+=Kz(P,r,u);r=rI;h=false}T=0;while(T<ui[t].len){E=nb(t);_=-1;for(a=T;a<ui[t].len;a++){if(_==-1&&Nj(xs[E[a]].style&tc.ENOTETEXT)){_=a}if(_>=0&&Dj(xs[E[a]].style&tc.ENOTETEXT))break;o=a}T=a;sb(t);if(_<0)continue;if(!MY(Ri+1))return true;iw(r,1,gk("B"));i++;if(d)br+=i;if(F)sA+=i;if(g)_A+=i;S=true;if(o+1==ui[t].len&&t+1<Ri){var O=ib(t+1,0);if(Nj(xs[O].style&tc.ENOTETEXT))S=false}n=o-_+1;if(S)n++;Tm(r,0,n);lw(t,_,r,0,o-_+1);ui[r].pfmt=u;ui[r].cid=0;ui[r].fid=0;n=ui[r].len;ui[r].flags=0;ui[r].flags2=0;if(S&&n>1){R=ui[r].txt;E=nb(r);R[n-1]=Bn;E[n-1]=E[n-2]}n=ui[r].len;if(n>0&&Nj(ui[t].flags&(tc.LFLAG_PARA|tc.LFLAG_BREAK))){var v;R=ui[r].txt;v=R[n-1];if(v==TR||xY(qS,v))R[n-1]=Bn}R=ui[r].txt;n=ui[r].len;for(a=0;a<n;a++)if(R[a]==tc.TAB)R[a]=tc.SPACE;for(a=1;a<ui[r].len;a++){if(R[a-1]==tc.SPACE&&R[a]==tc.SPACE){fw(r,a,1,tc.CHAR_D);R=ui[r].txt;a--}}n=ui[r].len;for(a=0;a<ui[r].len;a++){var p=ib(r,a);if(Nj(xs[p].style&tc.HIDDEN)||xs[p].FieldId==tc.FIELD_NAME){fw(r,a,1,tc.CHAR_D);a--}}n=ui[r].len;if(n>0&&Nj(ui[r].tag)){L=ui[r].tag;for(a=0;a<n;a++)L[a]=0;Tb(r)}if(n>0){E=nb(r);C=36863;for(a=0;a<n;a++){if(E[a]!=C){C=E[a];I=C;if(Dj(xs[C].style&tc.PICT))I=Db(I,tc.FNOTEALL,false);I=Db(I,tc.PROTECT,true);if(xs[I].ParaStyId!=0||xs[I].CharStyId!=1)I=Bb(I,1,0)}E[a]=I}}R=ui[r].txt;n=ui[r].len;if(n>0&&R[n-1]==Bn)ui[r].flags|=tc.LFLAG_PARA;r++}}if(!P){e=f=r+1;continue t}break}if(br>=Ri)br=Ri-1;if(jt>=ui[br].len)jt=ui[br].len-1;if(jt<0)jt=0;if(uA!=tc.HILIGHT_OFF){if(sA>=Ri)sA=Ri-1;if(TA>=ui[sA].len)TA=ui[sA].len-1;if(TA<0)TA=0;if(_A>=Ri)_A=Ri-1;if(AA>ui[_A].len)AA=ui[_A].len}oi.modified=A;return true}function Kz(t,e,r){var i=0;var f;var l;var a,n,c=25;rI=e;if(ui[e].len>1){if(t){if(!MY(Ri+1))return 0;iw(e,1,tc.CHAR_A);i++;e++;Tm(e,ui[e].len,1);f=ui[e].txt;f[0]=Bn;ui[e].flags|=tc.LFLAG_PARA}else{n=ui[e].len-1;Tm(e,n,n-1);ui[e].flags=cj(ui[e].flags,tc.LFLAG_SECT);if(Nj(ui[e].tabw))ui[e].tabw.type=cj(ui[e].tabw.type,tc.INFO_SECT);f=ui[e].txt;n=ui[e].len;if(n==0||n>0&&f[n-1]!=Bn){Tm(e,n,n+1);f=ui[e].txt;f[n]=Bn;ui[e].flags|=tc.LFLAG_PARA}if(!MY(Ri+1))return 0;iw(e,1,tc.CHAR_A);i++;e++;Tm(e,ui[e].len,2);f=ui[e].txt;f[0]=Bn;f[1]=tc.SECT_CHAR;ui[e].flags|=tc.LFLAG_PARA|tc.LFLAG_SECT}}if(e>0&&Dj(ui[e-1].flags&tc.LFLAG_PARA)){if(!MY(Ri+1))return 0;iw(e,1,tc.CHAR_B);Tm(e,ui[e].len,1);f=ui[e].txt;f[0]=Bn;ui[e].flags|=tc.LFLAG_PARA;i++;e++}if(!MY(Ri+1))return 0;iw(e,1,gk("B"));i++;ui[e].pfmt=r;Tm(e,ui[e].len,1);f=ui[e].txt;f[0]=Bn;ui[e].flags=tc.LFLAG_PARA;ui[e].flags2=0;l=nb(e);l[0]=Db(l[0],tc.PROTECT,true);sb(e);e++;if(!MY(Ri+1))return 0;iw(e,1,gk("B"));i++;ui[e].pfmt=r;if(HX()){var s=ui[e].pfmt;if(Nc[s].flow!=tc.FLOW_RTL){ui[e].pfmt=cZ(s,tc.PPARAM_FLOW,tc.FLOW_RTL)}}Tm(e,ui[e].len,c);f=ui[e].txt;for(a=0;a<c-1;a++)f[a]=tc.UNDERSCORE;f[c-1]=Bn;ui[e].flags=tc.LFLAG_PARA;ui[e].flags2=0;l=nb(e);for(a=0;a<c;a++)l[a]=Db(0,tc.PROTECT,true);sb(e);e++;rI=e;return i}function Yz(){var t,e,r,i,f,l;var a;var n=false,c,s=false;var _=0;if(br<=0)return true;t:while(true){if((e=iW(br))<0)return true;MT=tc.CURS_BACKWARD;DA=true;if(Vt<0)Vt=Fq(jt,br,tc.LEFT);l=rW(-e);if(Vt>=pl[e].x+pl[e].width){var o=pl[e].x+pl[e].width-1;_=Vt-o;Vt=o}e:{if(br>pl[e].PageFirstLine){r=Pq(br)-1;r-=vW(br,true);Xt=r;if(l>0)break e}else{r=pl[e].y-1;if(l>0)return true}c=br<=pl[e].PageFirstLine;i=-1;for(t=Dl-1;t>=0;t--){if(pl[t].empty||Nj(pl[t].flags&tc.FRAME_DISABLED))continue;if(Nj(Qh&tc.TFLAG3_CURSOR_IN_CELL)&&pl[t].CellId!=ui[br].cid)continue;if(c&&e==t)continue;if(Vt>=pl[t].x&&Vt<pl[t].x+pl[t].width){f=pl[t].y+pl[t].height-1;if(r>=pl[t].y&&r<=f)n=true;if(f<=r&&f>i)i=f}}if(!n&&i<0){if(Lo==qe&&!s&&Lo>0){By(false,Lo-1,Lo);s=true;continue t}else return zz()}if(!n)r=i}break}aO|=tc.TOFLAG_NO_TOL;br=zq(Vt,r,l>0?e:-1);oj(tc.TOFLAG_NO_TOL);if(Lo>qe&&r<Ze)Lo--;e=iW(br);a=pl[e].ScrFirstLine;if(pl[e].ScrY<Gt)a++;if(Nj(ui[br].tabw)&&Nj(ui[br].tabw.type&tc.INFO_ROW))br--;if(Nj(pl[e].flags&tc.FRAME_ON_SCREEN)&&br>=a){Br=tc.PAINT_MIN;yn=tc.WRAP_OFF}else{if(Nj(Qh&tc.TFLAG3_LINE_SCROLL))Xt=0;else Xt=Mt/2;Gt=Pq(br)-Xt;if(Gt<0)Gt=0;BG();Br=tc.PAINT_WIN;aa=false}jt=Oq(Vt+_,br);if(uA==tc.HILIGHT_CHAR&&OA&&Nj(ui[br].cid)){var u=br;for(;br-1>=0;br--)if(GY(br-1,tc.INFO_CELL|tc.INFO_ROW)||Dj(ui[br-1].cid))break;if(u!=br)jt=0}cG();return true}function Vz(){var t,e,r,i,f,l,a,n;var c,s,_;var o=false,u,T=false;var A=0;if(!OA&&!Xr){if(uA==tc.HILIGHT_CHAR&&_A==br-1&&AA==ui[_A].len){br--;jt=ui[br].len-1}pB()}t:while(true){if((r=iW(br))<0)return true;MT=tc.CURS_FORWARD;DA=true;if(Vt<0)Vt=Fq(jt,br,tc.LEFT);if(Vt>=pl[r].x+pl[r].width){var E=pl[r].x+pl[r].width-1;A=Vt-E;Vt=E}c=pl[r].PageLastLine;if(Nj(ui[c].tabw)&&Nj(ui[c].tabw.type&tc.INFO_ROW))c--;e=rW(-r);e:{if(e==90&&jt==0){f=pl[r].y+pl[r].height+1;e=0}else if(br<c){f=Pq(br)+$q(br,false)+1;if(e>0)break e}else{if(e>0)return true;f=pl[r].y+pl[r].height+1}u=br>=c;l=ze;for(t=0;t<Dl;t++){if(pl[t].empty||Nj(pl[t].flags&tc.FRAME_DISABLED))continue;if(Nj(Qh&tc.TFLAG3_CURSOR_IN_CELL)&&pl[t].CellId!=ui[br].cid)continue;if(u&&r==t)continue;if(Vt>=pl[t].x&&Vt<pl[t].x+pl[t].width){if(f>=pl[t].y&&f<pl[t].y+pl[t].height)o=true;if(pl[t].y>f&&pl[t].y<l)l=pl[t].y}}if(!o&&l==ze){if(br+1==Ri){if(uA==tc.HILIGHT_CHAR){AA=jt=ui[br].len-1;cG()}return true}if(Lo==$e&&!T){By(false,Lo,Lo+1);T=true;continue t}else return Zz()}if(!o)f=l}break}aO|=tc.TOFLAG_NO_TOL;br=zq(Vt,f,e>0?r:-1);oj(tc.TOFLAG_NO_TOL);if(Lo==qe&&f>=Ze)Lo++;r=iW(br);s=pl[r].ScrLastLine;if(br==s){i=l$(br)+$q(br,true);if(i>Gt+Mt)s--}if(Nj(pl[r].flags&tc.FRAME_ON_SCREEN)&&br<=s&&(Gt+Mt<ze||$e==To-1)){Br=tc.PAINT_MIN;yn=tc.WRAP_OFF}else{if(Nj(Qh&tc.TFLAG3_LINE_SCROLL))Xt=Mt-ui[br].ScrHt;else Xt=Mt/2;Gt=Pq(br)-Xt;if(Gt<0)Gt=0;BG();a=Gt;_=Jq(Vt,a);if(_==br-1){n=Pq(_);if(n<a){var R=$q(br,false);Xt+=a-n;if(Xt+R>=Mt)Xt=Mt-R-1;if(Xt<Mt/2)Xt=Mt/2}}Br=tc.PAINT_WIN;aa=false}jt=Oq(Vt+A,br);if(uA==tc.HILIGHT_CHAR&&OA&&Nj(ui[br].cid)){for(;br+1<Ri;br++)if(GY(br,tc.INFO_CELL))break;jt=ui[br].len-1}cG();return true}function jz(t){var e=0;var r;var i=false;var f;MT=tc.CURS_FORWARD;if(uA==tc.HILIGHT_CHAR&&ui[_A].cid>0&&ui[br].cid>0)return S8(t);if(jt==ft-1)return true;jt++;if(ui[br].len>0){r=ui[br].txt;e=r[ui[br].len-1]}if(jt>=ui[br].len&&(br+1<Ri||e==Bn)){if(br+1==Ri){jt--;return true}if(Nj(Qh&tc.TFLAG3_CURSOR_IN_CELL)&&(ui[br].cid!=ui[br+1].cid||GY(br+1,tc.INFO_ROW))){jt--;return true}i=Nj(Nc[ui[br].pfmt].flags&tc.PAGE_HDR_FTR);if(i&&Nj(ui[br+1].flags&tc.LFLAG_HDRS_FTRS)){jt--;return true}if(!i&&Nj(Nc[ui[br+1].pfmt].flags&tc.PAGE_HDR_FTR)&&!WR){f=br;while(f+1<Ri&&Nj(Nc[ui[f+1].pfmt].flags&tc.PAGE_HDR_FTR))f++;if(f+1>=Ri)return true;br=f+1}else br++;jt=0;if(Lo+1<To&&ui[br].page==Lo){yn=tc.WRAP_OFF;Br=tc.PAINT_LINE}}else{yn=tc.WRAP_OFF;Br=tc.PAINT_MIN}cG();return true}function Jz(){var t;var e;if(uA==tc.HILIGHT_CHAR&&ui[_A].cid>0)return P8();pB();MT=tc.CURS_BACKWARD;if(jt>0){if(uA!=tc.HILIGHT_OFF&&_A==br&&jt+1==ui[br].len&&AA==ui[br].len)AA--;else jt--;yn=tc.WRAP_OFF;Br=tc.PAINT_MIN;cG();return true}else{if(br!=0){if(Nj(Qh&tc.TFLAG3_CURSOR_IN_CELL)&&ui[br].cid!=ui[br-1].cid)return true;t=Nj(Nc[ui[br].pfmt].flags&tc.PAGE_HDR_FTR);if(t&&Nj(ui[br-1].flags&tc.LFLAG_HDRS_FTRS))return true;if(!t&&Nj(Nc[ui[br-1].pfmt].flags&tc.PAGE_HDR_FTR)&&!WR){e=br;while(e>0&&Nj(Nc[ui[e-1].pfmt].flags&tc.PAGE_HDR_FTR))e--;if(e==0)return true;br=e-1}else br--;jt=ui[br].len-1;if(ui[br].page==Lo){yn=tc.WRAP_OFF;Br=tc.PAINT_LINE}cG();return true}else return true}}function zz(){var t,e,r,i=-1,f=-1,l;MT=tc.CURS_BACKWARD;if(Gt==0&&Lo==0){for(t=Dl-1;t>=0;t--){if(pl[t].empty||Nj(pl[t].flags&tc.FRAME_DISABLED))continue;if(Nj(Qh&tc.TFLAG3_CURSOR_IN_CELL)&&pl[t].CellId!=ui[br].cid)continue;if(i<0)i=pl[t].y;if(pl[t].y<=i){i=pl[t].y;f=t}}if(f>=0&&br!=pl[f].PageFirstLine){br=pl[f].PageFirstLine;jt=0;MT=tc.CURS_FORWARD;cG()}return true}r=Gt-Mt+3*xs[0].height/2;if(Vt<0)Vt=Fq(jt,br,tc.LEFT);Gt=r;if(Gt<0){if(qe>0){if(Lo>0)Lo--;qe--;By(false,qe,qe+1);Gt=Ze+r;if(Gt<0)Gt=0;if(Zt==tc.ID_UP)Xt=Mt;else Xt=Mt/2}else{Gt=0;if(Xt<0)Xt=0}}if(Xt>(Mt-3*xs[0].height)/2)Xt=Mt-3*xs[0].height/2;if(Xt<0)Xt=0;e=Gt+Xt;l=-1;for(t=Dl-1;t>=0;t--){if(pl[t].empty||Nj(pl[t].flags&tc.FRAME_DISABLED))continue;if(Nj(Qh&tc.TFLAG3_CURSOR_IN_CELL)&&pl[t].CellId!=ui[br].cid)continue;if(e>=pl[t].y&&e<pl[t].y+pl[t].height){br=Jq(Vt,e);break}else if(pl[t].y<=e){if(l!=-1&&pl[l].y<Gt+Mt)br=pl[l].PageFirstLine;else br=pl[t].PageLastLine}l=t}if(t<0&&l!=-1&&pl[l].y<Gt+Mt)br=pl[l].PageFirstLine;jt=Oq(Vt,br);e=Pq(br);if(e<Gt||e>=Gt+Mt)cq();BG();aa=false;cG();return true}function Zz(){var t,e,r;var i;MT=tc.CURS_FORWARD;t:while(true){r=Gt+Mt-3*xs[0].height/2;if(r<Gt)r=Gt+Mt;if(Vt<0)Vt=Fq(jt,br,tc.LEFT);if(Gt+Mt>=Yt){if(Lo<To-1&&$e<To-1){Lo=$e+1;if($e>qe)Gt-=Ze;By(false,Lo-1,Lo);continue t}else{if(Zt!=tc.ID_PGDN&&Zt!=tc.ID_DOWN){Gt=r;if(Gt+Mt>=ze)Gt=ze-Mt-1;if(Gt<0)Gt=0;Xt=0}else if(Zt==tc.ID_PGDN){var f=false;if(Nj(Qh&tc.TFLAG3_CURSOR_IN_CELL)&&Nj(ui[br].cid)){for(i=br+1;i<Ri;i++)if(ui[i].cid!=ui[br].cid||GY(i,tc.INFO_ROW))break;br=i-1;f=true}else if(Pq(Ri-1)>=Gt){br=Ri-1;f=true}if(f){jt=ui[br].len-1;if(jt<0)jt=0;cG()}return true}else return true}}else{Gt=r;if(Gt+Mt>=ze)Gt=ze-Mt;if(Gt<0)Gt=0;if(Xt<0)Xt=0}break}e=Gt+Xt;var l=-1,a=99999;for(t=0;t<Dl;t++){if(pl[t].empty||Nj(pl[t].flags&tc.FRAME_DISABLED))continue;if(Nj(Qh&tc.TFLAG3_CURSOR_IN_CELL)&&pl[t].CellId!=ui[br].cid)continue;if(e>=pl[t].y&&e<pl[t].y+pl[t].height){br=Jq(Vt,e);break}if(pl[t].y>=e&&pl[t].y-e<a){l=t;a=pl[t].y-e}}if(t==Dl&&l>=0)br=pl[l].PageFirstLine;if(t<Dl){if(t<Qe)Lo=qe;else Lo=$e}jt=Oq(Vt,br);e=Pq(br);if((e<Gt||e>=Gt+Mt)&&Zt!=tc.ID_DOWN)cq();BG();aa=false;cG();return true}function Qz(){var t,e,r;var i=br;r=Gt;e=xs[0].height;if(Qt==tc.WMTER_MOUSEWHEEL)e*=5;t=Fq(jt,br,tc.LEFT);if(Gt==0&&Lo==0)return true;if(qe>0&&e>Gt){var f=qe;By(false,qe-1,qe);Gt+=Ze;if(Gt+Tt-e>Yt)Gt=Yt-Tt+e;r=Gt;Lo=f;if(ui[br].page>$e)br=i=po[Lo].FirstLine}else $z();Gt-=e;if(Gt<0)Gt=0;if(Xt<0)Xt=0;if(Xt>Tt)Xt=Tt;if(Gt+Xt>Yt)Xt=Yt-Gt;if(Xt<0)Xt=0;br=Jq(t,Gt+Xt);if(ui[br].page>ui[i].page)br=i;else if(ui[br].page<ui[i].page-1)br=i;else if(ui[br].page<qe)br=i;jt=Oq(t,br);BG();rZ(0,Gt-r);return true}function qz(){var t,e,r,i,f;var l=false;var a=br;if(Nj(rO&tc.TFLAG8_HIDE_PAGE_BLANK_AREA)||Nj(fO&tc.TFLAG10_EXTEND_AUTO_VSCROLL)){if(Tt>Yt&&$e==To-1)return true}r=Gt;e=xs[0].height;if(Qt==tc.WMTER_MOUSEWHEEL)e*=5;t=Fq(jt,br,tc.LEFT);t:while(true){if(Gt+Tt>=ze&&!l){if($e<To-1){var n=$e;f=qe<$e?Ze:0;By(false,$e,$e+1);l=true;Gt-=f;r=Gt;Lo=n;break t}else return true}else{$z();Gt+=e}break}i=true||FS||$e+1<To?ze:Yt;if(Gt+Tt>=i)Gt=i-Tt;if(Gt<0)Gt=0;if(Xt<0)Xt=0;if(Gt+Xt>Yt)Xt=Yt-Gt;if(Xt<0)Xt=0;br=Jq(t,Gt+Xt);if(ui[br].page>ui[a].page+1){var c=ui[a].page;var s=ui[br].page;if(qe==c+1)br=po[qe].LastLine;else br=a}else if(ui[br].page>$e)br=a;else if(ui[br].page<ui[a].page)br=a;jt=Oq(t,br);if(Gt!=r||l){BG();rZ(0,Gt-r)}return true}function $z(){if(false&&Dl<12){vl=null;return}vl=document.createElement("canvas");vl.width=Sl=je;vl.height=hl=Mt;gl=Ft;Pl=Gt;Fl=Ul;Ol=oi.modified;yn=tc.WRAP_OFF;gr=vl.getContext("2d");gr.mozImageSmoothingEnabled=false;gr.webkitImageSmoothingEnabled=false;gr.msImageSmoothingEnabled=false;gr.imageSmoothingEnabled=false;gr.drawImage(_i.cvs,rt.left,rt.top,je,Mt,0,0,je,Mt)}function tZ(){var t,e,r,i;var f;var l;t=Fq(jt,br,tc.LEFT);e=Pq(br);if(jt<ui[br].len){f=ui[br].txt;l=nb(br);i=xs[l[jt]].CharWidth[tc.CHAR_A];sb(br)}else i=Gx(0,true,tc.SPACE);Ft+=i;r=Tz();if(Ft+je>r)Ft=r-je;if(Ft<0)Ft=0;t=t+i;if(t>Ft+je)t=Ft+je;br=Jq(t,e);jt=Oq(t,br);BG();aa=false;cG();return true}function eZ(){var t,e,r;var i;var f;t=Fq(jt,br,tc.LEFT);e=Pq(br);if(jt>0){i=ui[br].txt;f=nb(br);r=xs[f[jt-1]].CharWidth[tc.CHAR_A];sb(br)}else r=Gx(0,true,tc.SPACE);Ft-=r;if(Ft<0)Ft=0;t=t-r;if(t<0)t=0;br=Jq(t,e);jt=Oq(t,br);BG();aa=false;cG();return true}function rZ(t,e){aa=false;QE=qE=false;if(Ro==oi.modified)yn=tc.WRAP_OFF;cG();return true}function iZ(t){var e,r;var i=Lo;var f,l,a,n,c;var s=false;var _=Nj(aO&tc.TOFLAG_CONTINUOUS_SCROLL);var o=tc.SCROLL_RANGE-ct;f=oz(0,To)-Mt;if(t>=o-2){e=To-1;a=uz(e)-Mt;if(a<0)a=0}else{l=Mj(f,t,o);n=0;for(e=0;e<To-1;e++){c=uz(e);if(n+c>l)break;n+=c}a=l-n;if(a>=oz(e,1))a=oz(e,1)-1}if(e!=Lo&&Wr&&!_){if(e<To-1||t<o-2)s=true}Lo=e;if(i!=Lo)my(true);if(s){if(Lo==qe)Gt=0;else Gt=Ze}else{if(Lo==qe)Gt=a;else Gt=Ze+a;if(Gt>=ze-Mt)Gt=ze-Mt;if(Gt<0)Gt=0}BG();r=Gt;if(r>=Yt)r=Yt-1;br=Jq(0,r);jt=0;aa=false;cG();return true}function fZ(t){var e;e=Ft;if(t)Ft-=je/2;else Ft-=je/8;if(Ft<0)Ft=0;BG();if(t){aa=false;cG()}else rZ(Ft-e,0);return true}function lZ(t){var e,r;r=Ft;e=Tz()+1;if(e<je)return true;if(t)Ft+=je/2;else Ft+=je/8;if(Ft+je>e)Ft=e-je;if(Ft<0)Ft=0;BG();if(t){aa=false;cG()}else rZ(Ft-r,0);return true}function aZ(t){var e;e=Tz();if(e<je)return true;if(tc.SCROLL_RANGE-st==0)return true;Ft=(e-je)*t/(tc.SCROLL_RANGE-st);if(Ft>e-je)Ft=e-je;BG();aa=false;cG();return true}_i.TerShrinkPageToFit=function(t){var e;if(!lv||!QD())_i.TerCreateControl();if(!oi.PageMode||oi.FittedView)return false;if(To>1||tr<tc.RULER_TOLERANCE)return false;e=po[0].TopSect;_i.TerSetSectPageSize(tc.SECT_ALL,255,-1,to[0].PprHeight*1440-(tr-tc.RULER_TOLERANCE),t);return true};_i.TerSetPageBorderWidth=function(t,e){if(!lv||!QD())_i.TerCreateControl();ch=t;if(e){my(true);cG()}return true};function nZ(){if(!MJ($T,tc.CLR_WHITE))return $T;else return jT}_i.TerSetPageBkColor=function(t){if(typeof t=="string")t=yK(t);$T=t;oi.modified++;return true};_i.TerGetPageOffset=function(t,e){var r=true;var i;var f,l,a,n;if(!lv||!QD())_i.TerCreateControl();f=l=a=n=0;td=ed=zI=ZI=0;if(!oi.PageMode)return false;if(e!=tc.REL_WINDOW&&e!=tc.REL_TEXT_BOX)return false;if(t<0)t=Lo;if(t<qe||t>$e)return false;l=0;if(t>qe)l+=Ze;if(Ci)l+=yV(rr);l-=Gt;if(l>Mt)r=false;if(l<0&&r){n=Ze;if(Ci)n-=yV(rr+ir);if(l+n<0)r=false}if(e==tc.REL_WINDOW)l+=rt.top;f=0;if(Ci)f+=bV(er);f-=Ft;if(f>je)r=false;if(e==tc.REL_WINDOW)f+=rt.left;if(t==qe)n=Ze;else n=pl[Dl-1].y+pl[Dl-1].height-pl[Qe].y;if(Ci){n-=yV(rr);n-=t+1==To?yV(rr):yV(ir)}i=po[t].TopSect;a=eo[i].PgWidth*Nt;td=f;ed=l;zI=a;ZI=n;return r};_i.TerPosPage=function(t){return _i.TerSetPagePos(t,0)};_i.TerSetPagePos=function(t,e){var r,i;if(!lv||!QD())_i.TerCreateControl();if(!oi.PageMode)return false;e=hV(e);i=Lo;Lo=t;if(i!=Lo||Lo!=qe){By(false,Lo,Lo+1)}if(Lo==qe)Gt=e;else Gt=Ze+e;if(Gt>=ze-Mt&&ze>Mt)Gt=ze-Mt;if(Gt>0&&Lo==0&&ze<=Mt)Gt=0;BG();r=Gt;if(r>=Yt)r=Yt-1;br=Jq(0,r);jt=0;if(VR)cq();cG();return true};_i.TerGetPageFirstLine=function(t){var e;if(!lv||!QD())_i.TerCreateControl();if(t<0)t=0;if(t>To-1)t=To-1;e=po[t].FirstLine;return e};_i.TerGetDispPageNo=function(t){if(!lv||!QD())_i.TerCreateControl();if(t<0||t>=To)return 0;return po[t].DispNbr};_i.TerGetPageOrient=function(t){var e;return _i.TerGetPageOrientEx(t)};_i.TerGetPageOrientEx=function(t){var e;return _i.TerGetPageOrient2(t)};_i.TerGetPageOrient2=function(t){var e;if(!lv||!QD())_i.TerCreateControl();if(t<0)t=0;if(t>=To)t=To-1;e=_i.TerGetPageSect(t);zI=eo[e].PgWidth*1440;ZI=eo[e].PgHeight*1440;gd=MV(eo[e].HiddenX);Pd=HV(eo[e].HiddenY);return to[e].IsPortrait};_i.TerCreateParaId=function(t,e,r,i,f,l,a,n,c,s,_,o,u,T){return _i.TerCreateParaIdEx(t,e,r,i,f,l,a,n,c,s,_,o,u,T,0,tc.CLR_WHITE)};_i.TerCreateParaIdEx=function(t,e,r,i,f,l,a,n,c,s,_,o,u,T,A,E){return _i.TerCreateParaIdEx(t,e,r,i,f,l,a,n,c,s,_,o,u,T,A,yK(E))};_i.TerCreateParaIdEx=function(t,e,r,i,f,l,a,n,c,s,_,o,u,T,A,E){var R,L=0,C;if(!lv||!QD())_i.TerCreateControl();if(t>=Mc)return-1;if(t>=0)e=false;if(t>=Dc){for(R=Dc;R<=t;R++)Nc[R]=new tc.ClsPfmt;Dc=t+1}if(!e)Dh=false;if(t>=0)L=t;C=ZZ(L,r,i,f,l,A,n,a_,a,c,s,_,o,u,0,E,tc.PARA_BOX_SPACE,tc.FLOW_DEF,T);a_=0;if(t>=0&&C!=t){Nc[t]=Nc[C];C=t}return C};function cZ(t,e,r){return ZZ(t,e!=tc.PPARAM_LEFT_INDENT?Nc[t].LeftIndentTwips:r,e!=tc.PPARAM_RIGHT_INDENT?Nc[t].RightIndentTwips:r,e!=tc.PPARAM_FIRST_INDENT?Nc[t].FirstIndentTwips:r,e!=tc.PPARAM_TAB?Nc[t].TabId:r,e!=tc.PPARAM_BLT?Nc[t].BltId:r,e!=tc.PPARAM_AUX?Nc[t].AuxId:r,e!=tc.PPARAM_AUX1?Nc[t].Aux1Id:r,e!=tc.PPARAM_STY?Nc[t].StyId:r,e!=tc.PPARAM_SHADING?Nc[t].shading:r,e!=tc.PPARAM_PFLAGS?Nc[t].pflags:r,e!=tc.PPARAM_SPACE_BEF?Nc[t].SpaceBefore:r,e!=tc.PPARAM_SPACE_AFT?Nc[t].SpaceAfter:r,e!=tc.PPARAM_SPACE_BET?Nc[t].SpaceBetween:r,e!=tc.PPARAM_LINE_SPACING?Nc[t].LineSpacing:r,e!=tc.PPARAM_BK_COLOR?Nc[t].BkColor:new tc.Color(r),e!=tc.PPARAM_BORDER_SPACE?Nc[t].BorderSpaceLeft:r,e!=tc.PPARAM_FLOW?Nc[t].flow:r,e!=tc.PPARAM_FLAGS?Nc[t].flags:r)}function sZ(){if(mr==tc.FLOW_RTL)return _Z(0,mr);else return 0}function _Z(t,e){var r=Nc[t].flags;if(Dj(r&(tc.CENTER|tc.JUSTIFY))){r=cj(r,tc.LEFT|tc.RIGHT_JUSTIFY);if(e==tc.FLOW_RTL)r|=tc.RIGHT_JUSTIFY;else r|=tc.LEFT}return ZZ(t,Nc[t].LeftIndentTwips,Nc[t].RightIndentTwips,Nc[t].FirstIndentTwips,Nc[t].TabId,Nc[t].BltId,Nc[t].AuxId,Nc[t].Aux1Id,Nc[t].StyId,Nc[t].shading,Nc[t].pflags,Nc[t].SpaceBefore,Nc[t].SpaceAfter,Nc[t].SpaceBetween,Nc[t].LineSpacing,Nc[t].BkColor,Nc[t].BorderSpaceLeft,e,r)}function oZ(t){var e,r,i;var f,l,a;e=Nc[ui[t].pfmt].flow;if(e!=tc.FLOW_DEF)return e==tc.FLOW_RTL;l=ui[t].cid;a=eR[l].row;if(l>0)r=$E[a].flow;else r=tc.FLOW_DEF;if(r!=tc.FLOW_DEF)return r==tc.FLOW_RTL;f=G5(t);i=to[f].flow;if(i!=tc.FLOW_DEF)return i==tc.FLOW_RTL;return mr==tc.FLOW_RTL}function uZ(t,e,r,i){if(t==tc.FLOW_DEF){if(e==tc.FLOW_DEF){if(r==tc.FLOW_DEF)return i==tc.FLOW_RTL;else return r==tc.FLOW_RTL}else return e==tc.FLOW_RTL}else return t==tc.FLOW_RTL}function TZ(){if(uA==tc.HILIGHT_OFF)return br;else{var t=sA<_A?sA:_A;if(t>=0&&t<Ri)return t;else return br}}_i.ParaIndentTwips=function(t,e,r,f){var l,a,n;var c,s,_,o,u=0;var T=0;if(!lv||!QD())_i.TerCreateControl();if(!oi.WordWrap)return false;jZ();a=zC;n=iI;if(!Y_)V8(a,0,n,0,"P".charCodeAt(0));if(Y_){s=W_[k_].LeftIndentTwips+t;_=W_[k_].RightIndentTwips+e;o=W_[k_].FirstIndentTwips+r}else{var A=TZ();s=Nc[ui[A].pfmt].LeftIndentTwips+t;_=Nc[ui[A].pfmt].RightIndentTwips+e;o=Nc[ui[A].pfmt].FirstIndentTwips+r;if(Nj(Zh&tc.TFLAG2_INDENT_TABLES)&&t!=0){for(i=1;i<iR;i++)tR[i].flags=cj(tR[i].flags,tc.TAUX_CALC_DONE)}}for(l=a;l<=n;l++){if(!pm(l))continue;if(!Y_){s=Nc[ui[l].pfmt].LeftIndentTwips+t;_=Nc[ui[l].pfmt].RightIndentTwips+e;o=Nc[ui[l].pfmt].FirstIndentTwips+r}if(s>tc.MAX_INDENT)s=tc.MAX_INDENT;if(s<0){o+=s;s=0}if(_>tc.MAX_INDENT)_=tc.MAX_INDENT;if(o>tc.MAX_INDENT)o=tc.MAX_INDENT;if(s+o<0)o=-s;if(Gh){if(Nj(zh&tc.TFLAG_METRIC))c=tc.SNAP_DIST_METRIC;else c=tc.SNAP_DIST;s=HY(s,c);_=HY(_,c);o=HY(o,c);if(Nj(lO&tc.TFLAG11_NO_RIGHT_INDENT_TABLES)&&ui[l].cid>0)_=Nc[ui[l].pfmt].FirstIndentTwips}if(Y_){W_[k_].LeftIndentTwips=s;W_[k_].RightIndentTwips=_;W_[k_].FirstIndentTwips=o;fB(false);W_[k_].ParaMask|=tc.PMASK_INDENT;return true}if(Nj(Zh&tc.TFLAG2_INDENT_FRAMES)&&t!=0&&ui[l].fid>0){if(ui[l].fid!=u){var E=ui[l].fid;T=kl[E].x;kl[E].x+=t;if(T>=0&&kl[E].x<0)kl[E].x=0;u=E}continue}if(Nj(Zh&tc.TFLAG2_INDENT_TABLES)&&t!=0&&ui[l].cid>0){var R=eR[ui[l].cid].row;if(Dj(tR[R].flags&tc.TAUX_CALC_DONE)){T=$E[R].indent;var L,C;$E[R].indent+=t;if(T>=0&&$E[R].indent<0)$E[R].indent=0;L=$E[R].FirstCell;C=$E[R].indent;while(L>0){eR[L].x=C;C+=eR[L].width;L=eR[L].NextCell}tR[R].flags|=tc.TAUX_CALC_DONE}continue}ui[l].pfmt=ZZ(ui[l].pfmt,s,_,o,Nc[ui[l].pfmt].TabId,Nc[ui[l].pfmt].BltId,Nc[ui[l].pfmt].AuxId,Nc[ui[l].pfmt].Aux1Id,Nc[ui[l].pfmt].StyId,Nc[ui[l].pfmt].shading,Nc[ui[l].pfmt].pflags,Nc[ui[l].pfmt].SpaceBefore,Nc[ui[l].pfmt].SpaceAfter,Nc[ui[l].pfmt].SpaceBetween,Nc[ui[l].pfmt].LineSpacing,Nc[ui[l].pfmt].BkColor,Nc[ui[l].pfmt].BorderSpaceLeft,Nc[ui[l].pfmt].flow,Nc[ui[l].pfmt].flags)}oi.modified++;if(!Y_&&a<Fo)Fo=a;if(f)cG();else T9(a,n+10-a);return true};_i.TerSetParaTextFlow=function(t,i,f){var e,r,l,a;if(!lv||!QD())_i.TerCreateControl();if(!oi.WordWrap)return false;if(!t)return AZ(i,f);jZ();r=zC;l=iI;var n=_i.DlgCompHeight;var c=_i.DlgFont;var s=new $t.DialogBox(te,"Paragraph Text Flow",c,true,A,2);var _=s.cvs;if(Y_)i=W_[k_].ParaFlow;else i=Nc[ui[r].pfmt].flow;var o=new $t.RadioButton(_,0,0,JV(15),c,"Left-to-Right",i==tc.FLOW_LTR,null,null);s.addComp(o,0,0,1,1,"left","middle",JV(15));var u=new $t.RadioButton(_,1,0,JV(15),c,"Right-to-Left",i==tc.FLOW_RTL,o,null);s.addComp(u,1,0,1,1,"left","middle",JV(15));var T=new $t.RadioButton(_,2,0,JV(15),c,"Default",i==tc.FLOW_DEF,u,null);s.addComp(T,2,0,1,1,"left","middle",JV(15));s.show();o.setFocus();function A(t,e,r){if(t=="Cancel"){s.hide();return}else if(t=="OK"){i=tc.FLOW_DEF;if(u.isSelected())i=tc.FLOW_RTL;else if(o.isSelected())i=tc.FLOW_LTR;s.hide();return AZ(i,f)}else return}};function AZ(t,e){var r,i,f,l;jZ();i=zC;f=iI;if(t!=tc.FLOW_DEF&&t!=tc.FLOW_RTL&&t!=tc.FLOW_LTR)return true;if(!Y_)V8(i,0,f,0,"P".charCodeAt(0));for(r=i;r<=f;r++){if(!pm(r))continue;if(Y_)l=W_[k_].ParaFlags;else l=Nc[ui[r].pfmt].flags;if(t==tc.FLOW_RTL&&(Nj(l&tc.LEFT)||Dj(l&(tc.CENTER|tc.RIGHT_JUSTIFY|tc.JUSTIFY)))){l=cj(l,tc.LEFT|tc.CENTER|tc.RIGHT_JUSTIFY|tc.JUSTIFY);l|=tc.RIGHT_JUSTIFY}if(t==tc.FLOW_LTR&&Nj(l&tc.RIGHT_JUSTIFY)){l=cj(l,tc.LEFT|tc.CENTER|tc.RIGHT_JUSTIFY|tc.JUSTIFY);l|=tc.LEFT}if(Y_){W_[k_].ParaFlags=l;W_[k_].ParaFlow=t;W_[k_].ParaMask|=tc.PMASK_FLOW|tc.PMASK_ALIGN;return true}ui[r].pfmt=ZZ(ui[r].pfmt,Nc[ui[r].pfmt].LeftIndentTwips,Nc[ui[r].pfmt].RightIndentTwips,Nc[ui[r].pfmt].FirstIndentTwips,Nc[ui[r].pfmt].TabId,Nc[ui[r].pfmt].BltId,Nc[ui[r].pfmt].AuxId,Nc[ui[r].pfmt].Aux1Id,Nc[ui[r].pfmt].StyId,Nc[ui[r].pfmt].shading,Nc[ui[r].pfmt].pflags,Nc[ui[r].pfmt].SpaceBefore,Nc[ui[r].pfmt].SpaceAfter,Nc[ui[r].pfmt].SpaceBetween,Nc[ui[r].pfmt].LineSpacing,Nc[ui[r].pfmt].BkColor,Nc[ui[r].pfmt].BorderSpaceLeft,t,l)}oi.modified++;if(e){_z(true);cG()}return true}_i.SetTerParaFmt=function(t,e,r){var i,f,l;var a;var n,c,s,_;var o,u,T,A,E;if(!lv||!QD())_i.TerCreateControl();if(!oi.WordWrap)return false;jZ();f=zC;l=iI;if(!Y_)V8(f,0,l,0,"P".charCodeAt(0));for(i=f;i<=l;i++){if(!pm(i))continue;if(Y_){n=W_[k_].LeftIndentTwips;c=W_[k_].RightIndentTwips;s=W_[k_].FirstIndentTwips;o=W_[k_].SpaceBefore;u=W_[k_].SpaceAfter;T=W_[k_].SpaceBetween;E=W_[k_].LineSpacing;A=0;a=W_[k_].ParaFlags}else{n=Nc[ui[i].pfmt].LeftIndentTwips;c=Nc[ui[i].pfmt].RightIndentTwips;s=Nc[ui[i].pfmt].FirstIndentTwips;o=Nc[ui[i].pfmt].SpaceBefore;u=Nc[ui[i].pfmt].SpaceAfter;T=Nc[ui[i].pfmt].SpaceBetween;E=Nc[ui[i].pfmt].LineSpacing;A=ui[i].fid;a=Nc[ui[i].pfmt].flags}if(e)a=a|t;else a=a&~t;if(Nj(t&tc.LEFT))a=a&~(tc.CENTER|tc.RIGHT_JUSTIFY|tc.JUSTIFY);if(Nj(t&tc.CENTER))a=a&~(tc.LEFT|tc.RIGHT_JUSTIFY|tc.JUSTIFY);if(Nj(t&tc.RIGHT_JUSTIFY))a=a&~(tc.LEFT|tc.CENTER|tc.JUSTIFY);if(Nj(t&tc.JUSTIFY))a=a&~(tc.LEFT|tc.CENTER|tc.RIGHT_JUSTIFY);if(Nj(t&tc.PAGE_HDR))a=a&~tc.PAGE_FTR;if(Nj(t&tc.PAGE_FTR))a=a&~tc.PAGE_HDR;if(k_<0&&Nj(ui[i].tabw)&&Nj(ui[i].tabw.type&(tc.INFO_TABLE|tc.INFO_SECT|tc.INFO_PAGE|tc.INFO_COL)))a=a&~(tc.PAGE_HDR|tc.PAGE_FTR);if(Nj(t&tc.PARA_BOX_LEFT)){_=n;if(s<0)_+=s;if(e&&_<tc.RULER_TOLERANCE)n+=tc.RULER_TOLERANCE-_;else if(!e&&n==tc.RULER_TOLERANCE)n-=tc.RULER_TOLERANCE;if(n<0)n=0}if(Nj(t&tc.PARA_BOX_RIGHT)){if(e&&c<tc.RULER_TOLERANCE)c=tc.RULER_TOLERANCE;else if(!e&&c==tc.RULER_TOLERANCE)c-=tc.RULER_TOLERANCE;if(c<0)c=0}if(Nj(a&tc.DOUBLE_SPACE))T=E=0;if(Nj(t&tc.PARA_BOX_TOP)&&A==0){if(e&&o<tc.PARA_BOX_SPACE)o=tc.PARA_BOX_SPACE;else if(!e)o-=tc.PARA_BOX_SPACE;if(o<0)o=0}if(Nj(t&tc.PARA_BOX_BOT)&&A==0){if(e&&u<tc.PARA_BOX_SPACE)u=tc.PARA_BOX_SPACE;else if(!e&&u>=tc.PARA_BOX_SPACE)u-=tc.PARA_BOX_SPACE;if(u<0)u=0}if(Y_){W_[k_].LeftIndentTwips=n;W_[k_].RightIndentTwips=c;W_[k_].FirstIndentTwips=s;W_[k_].SpaceBefore=o;W_[k_].SpaceAfter=u;W_[k_].SpaceBetween=T;W_[k_].LineSpacing=E;W_[k_].ParaFlags=a;W_[k_].ParaMask|=tc.PMASK_INDENT|tc.PMASK_SPACING;EZ(k_,t,0);return true}ui[i].pfmt=ZZ(ui[i].pfmt,n,c,Nc[ui[i].pfmt].FirstIndentTwips,Nc[ui[i].pfmt].TabId,Nc[ui[i].pfmt].BltId,Nc[ui[i].pfmt].AuxId,Nc[ui[i].pfmt].Aux1Id,Nc[ui[i].pfmt].StyId,Nc[ui[i].pfmt].shading,Nc[ui[i].pfmt].pflags,o,u,T,E,Nc[ui[i].pfmt].BkColor,Nc[ui[i].pfmt].BorderSpaceLeft,Nc[ui[i].pfmt].flow,a)}oi.modified++;if(oi.PrintView&&Nj(t&(tc.PAGE_HDR|tc.PAGE_FTR))&&Ri<tc.SMALL_FILE)yJ(false,false,0,true);else Fo=f;if(r){if(!e&&Nj(t&(tc.PARA_BOX|tc.PARA_BOX_THICK|tc.PARA_BOX_DOUBLE)))Br=tc.PAINT_WIN_RESET;cG()}else T9(f,l+10-f);return true};function EZ(t,e,r){if(Nj(e&(tc.LEFT|tc.RIGHT_JUSTIFY|tc.CENTER|tc.JUSTIFY)))W_[t].ParaMask|=tc.PMASK_ALIGN;if(Nj(e&tc.PARA_BOX))W_[t].ParaMask|=tc.PMASK_BORDER;if(Nj(e&tc.PARA_CONTEXTUAL_SPACE))W_[t].ParaMask|=tc.PMASK_CONTEXTUAL_SPACE;if(Nj(e&tc.PARA_KEEP))W_[t].ParaMask|=tc.PMASK_KEEP;if(Nj(e&tc.PARA_KEEP_NEXT))W_[t].ParaMask|=tc.PMASK_KEEP_NEXT;if(Nj(e&tc.BULLET))W_[t].ParaMask|=tc.PMASK_BULLET;if(Nj(e&tc.DOUBLE_SPACE))W_[t].ParaMask|=tc.PMASK_SPACING;if(Nj(r&tc.PFLAG_WIDOW))W_[t].ParaMask|=tc.PMASK_WIDOW;if(Nj(r&tc.PFLAG_PAGE_BREAK))W_[t].ParaMask|=tc.PMASK_PAGE_BREAK;return true}_i.ParaNormal=function(t){var e,r,i;var f;if(!lv||!QD())_i.TerCreateControl();if(!oi.WordWrap)return false;if(Y_){W_[k_].LeftIndentTwips=0;W_[k_].RightIndentTwips=0;W_[k_].FirstIndentTwips=0;W_[k_].ParaFlags=0;W_[k_].pflags=0;W_[k_].shading=0;W_[k_].SpaceBefore=0;W_[k_].SpaceAfter=0;W_[k_].SpaceBetween=0;W_[k_].LineSpacing=0;W_[k_].TabId=0;W_[k_].ParaBkColor=tc.CLR_WHITE;W_[k_].ParaBorderColor=tc.CLR_AUTO;fB(false);W_[k_].ParaMask=0;return true}jZ();r=zC;i=iI;V8(r,0,i,0,"P".charCodeAt(0));for(e=r;e<=i;e++){if(!pm(e))continue;f=Nc[ui[e].pfmt].flags;f=f&~(tc.CENTER|tc.RIGHT_JUSTIFY|tc.JUSTIFY|tc.DOUBLE_SPACE|tc.PARA_CONTEXTUAL_SPACE|tc.PARA_KEEP|tc.PARA_KEEP_NEXT|tc.BULLET);f|=tc.LEFT;ui[e].pfmt=ZZ(ui[e].pfmt,0,0,0,0,0,Nc[ui[e].pfmt].AuxId,Nc[ui[e].pfmt].Aux1Id,0,0,0,0,0,0,0,tc.CLR_WHITE,tc.PARA_BOX_SPACE,tc.FLOW_DEF,f)}oi.modified++;if(!Y_&&r<Fo)Fo=r;if(t)cG();else T9(r,i+10-r);return true};_i.TerSetPflags=function(t,e,r){var i,f,l;var a;if(!lv||!QD())_i.TerCreateControl();if(!oi.WordWrap)return false;t=t&tc.PFLAG_STYLES;if(t==0)return false;jZ();f=zC;l=iI;if(!Y_)V8(f,0,l,0,"P".charCodeAt(0));for(i=f;i<=l;i++){if(!pm(i))continue;if(Y_)a=W_[k_].pflags;else a=Nc[ui[i].pfmt].pflags;if(e)a=a|t;else a=a&~t;if(Y_){W_[k_].pflags=a;EZ(k_,0,t);return true}ui[i].pfmt=ZZ(ui[i].pfmt,Nc[ui[i].pfmt].LeftIndentTwips,Nc[ui[i].pfmt].RightIndentTwips,Nc[ui[i].pfmt].FirstIndentTwips,Nc[ui[i].pfmt].TabId,Nc[ui[i].pfmt].BltId,Nc[ui[i].pfmt].AuxId,Nc[ui[i].pfmt].Aux1Id,Nc[ui[i].pfmt].StyId,Nc[ui[i].pfmt].shading,a,Nc[ui[i].pfmt].SpaceBefore,Nc[ui[i].pfmt].SpaceAfter,Nc[ui[i].pfmt].SpaceBetween,Nc[ui[i].pfmt].LineSpacing,Nc[ui[i].pfmt].BkColor,Nc[ui[i].pfmt].BorderSpaceLeft,Nc[ui[i].pfmt].flow,Nc[ui[i].pfmt].flags)}oi.modified++;if(oi.PrintView&&Nj(t&tc.PFLAG_WIDOW)&&Ri<tc.SMALL_FILE)yJ(false,false,0,true);else Fo=f;if(r)cG();else T9(f,l+10-f);return true};_i.TerSetParaIndent=function(t,e,r,i){var f,l,a;var n,c,s,_,o=0,u=0;var T=0;if(!lv||!QD())_i.TerCreateControl();if(!oi.WordWrap)return false;jZ();l=zC;a=iI;if(!Y_)V8(l,0,a,0,"P".charCodeAt(0));for(f=l;f<=a;f++){if(!pm(f))continue;c=t;s=e;_=r;if(Gh){if(Nj(zh&tc.TFLAG_METRIC))n=tc.SNAP_DIST_METRIC;else n=tc.SNAP_DIST;c=HY(c,n);s=HY(s,n);_=HY(_,n)}if(Y_){if(t!=-1)W_[k_].LeftIndentTwips=c;if(e!=-1)W_[k_].RightIndentTwips=s;if(r!=-1)W_[k_].FirstIndentTwips=_;fB(false);W_[k_].ParaMask|=tc.PMASK_INDENT;return true}if(Nj(Zh&tc.TFLAG2_INDENT_FRAMES)&&t!=0&&t!=-1&&ui[f].fid>0){if(ui[f].fid!=o){var A=ui[f].fid;T=kl[A].x;kl[A].x=t;if(T>=0&&kl[A].x<0)kl[A].x=0;o=A}continue}if(Nj(Zh&tc.TFLAG2_INDENT_TABLES)&&t!=0&&t!=-1&&ui[f].cid>0){var E=eR[ui[f].cid].row;if(E!=u){T=$E[E].indent;var R,L;$E[E].indent=t;if(T>=0&&$E[E].indent<0)$E[E].indent=0;R=$E[E].FirstCell;L=$E[E].indent;while(R>0){eR[R].x=L;L+=eR[R].width;R=eR[R].NextCell}u=E}continue}if(Nj(lO&tc.TFLAG11_NO_RIGHT_INDENT_TABLES)&&ui[f].cid>0)s=e;ui[f].pfmt=ZZ(ui[f].pfmt,t==-1?Nc[ui[f].pfmt].LeftIndentTwips:c,e==-1?Nc[ui[f].pfmt].RightIndentTwips:s,r==-1?Nc[ui[f].pfmt].FirstIndentTwips:_,Nc[ui[f].pfmt].TabId,Nc[ui[f].pfmt].BltId,Nc[ui[f].pfmt].AuxId,Nc[ui[f].pfmt].Aux1Id,Nc[ui[f].pfmt].StyId,Nc[ui[f].pfmt].shading,Nc[ui[f].pfmt].pflags,Nc[ui[f].pfmt].SpaceBefore,Nc[ui[f].pfmt].SpaceAfter,Nc[ui[f].pfmt].SpaceBetween,Nc[ui[f].pfmt].LineSpacing,Nc[ui[f].pfmt].BkColor,Nc[ui[f].pfmt].BorderSpaceLeft,Nc[ui[f].pfmt].flow,Nc[ui[f].pfmt].flags)}oi.modified++;if(!Y_&&l<Fo)Fo=l;if(i)cG();else T9(l,a+10-l);return true};_i.ParaLeftIndent=function(t,e){var r,i,f;var l,a,n,c,s,_,o=0,u=0;var T=0;var A=0;var E=0;if(!lv||!QD())_i.TerCreateControl();if(!oi.WordWrap)return false;if(!Y_){var R=ui[br].pfmt;var L=Nc[R].BltId;if(Dj(tO&tc.TFLAG6_DONT_PROCESS_BULLET_KEYS)&&L!=0&&xc[L].ls!=0){if(t&&xc[L].lvl<8){_i.TerSetListLevel(-1,1,true);return true}else if(!t&&(xc[L].lvl>0||Nc[R].LeftIndentTwips>0)){_i.TerSetListLevel(-1,-1,true);return true}}}jZ();i=zC;f=iI;if(!Y_)V8(i,0,f,0,"P".charCodeAt(0));for(r=i;r<=f;r++){if(!pm(r))continue;if(Y_){c=W_[k_].LeftIndentTwips;s=W_[k_].FirstIndentTwips;a=W_[k_].TabId}else{c=Nc[ui[r].pfmt].LeftIndentTwips;s=Nc[ui[r].pfmt].FirstIndentTwips;a=Nc[ui[r].pfmt].TabId;if(Nj(Zh&tc.TFLAG2_INDENT_FRAMES)&&Nj(ui[r].fid)){c=kl[ui[r].fid].x;a=0}if(Nj(Zh&tc.TFLAG2_INDENT_TABLES)&&Nj(ui[r].cid)){A=eR[ui[r].cid].row;c=$E[A].indent;a=0}}n=B_[a].count;if(t){for(l=0;l<n;l++){if(B_[a].pos[l]>c){c=B_[a].pos[l];break}}if(l==n){T=m_>0?m_:720;_=c/T;c=(_+1)*T}}else{var C=false;if(n>0&&c>B_[a].pos[n-1])C=true;if(C){T=m_>0?m_:720;_=c/T;if(c==_*T)_--;c=_*T;if(n>0&&c<B_[a].pos[n-1])c=B_[a].pos[n-1]}else{for(l=n-1;l>=0;l--){if(B_[a].pos[l]<c){c=B_[a].pos[l];break}}if(l<0){T=m_>0?m_:720;_=c/T;if(_>0)c=(_-1)*T;else c=0;if(c<0)c=0}}}if(Nj(Zh&tc.TFLAG2_INDENT_FRAMES)&&!Y_&&ui[r].fid>0){if(ui[r].fid!=o){var I=ui[r].fid;E=kl[I].x;kl[I].x=c;if(E>=0&&kl[I].x<0)kl[I].x=0;o=I}continue}if(Nj(Zh&tc.TFLAG2_INDENT_TABLES)&&!Y_&&ui[r].cid>0){A=eR[ui[r].cid].row;if(A!=u){E=$E[A].indent;var d,F;$E[A].indent=c;if(E>=0&&$E[A].indent<0)$E[A].indent=0;d=$E[A].FirstCell;F=$E[A].indent;while(d>0){eR[d].x=F;F+=eR[d].width;d=eR[d].NextCell}u=A}continue}if(c>tc.MAX_INDENT)c=tc.MAX_INDENT;if(c<0)c=0;if(c+s<0)c=-s;if(Y_){W_[k_].LeftIndentTwips=c;fB(false);W_[k_].ParaMask|=tc.PMASK_INDENT;return true}ui[r].pfmt=ZZ(ui[r].pfmt,c,Nc[ui[r].pfmt].RightIndentTwips,Nc[ui[r].pfmt].FirstIndentTwips,Nc[ui[r].pfmt].TabId,Nc[ui[r].pfmt].BltId,Nc[ui[r].pfmt].AuxId,Nc[ui[r].pfmt].Aux1Id,Nc[ui[r].pfmt].StyId,Nc[ui[r].pfmt].shading,Nc[ui[r].pfmt].pflags,Nc[ui[r].pfmt].SpaceBefore,Nc[ui[r].pfmt].SpaceAfter,Nc[ui[r].pfmt].SpaceBetween,Nc[ui[r].pfmt].LineSpacing,Nc[ui[r].pfmt].BkColor,Nc[ui[r].pfmt].BorderSpaceLeft,Nc[ui[r].pfmt].flow,Nc[ui[r].pfmt].flags)}oi.modified++;if(!Y_&&i<Fo)Fo=i;if(e)cG();else T9(i,f+10-i);return true};_i.ParaRightIndent=function(t,e){var r,i,f;var l;if(!lv||!QD())_i.TerCreateControl();if(!oi.WordWrap)return false;jZ();i=zC;f=iI;if(!Y_)V8(i,0,f,0,"P".charCodeAt(0));for(r=i;r<=f;r++){if(!pm(r))continue;if(Y_)l=W_[k_].RightIndentTwips;else l=Nc[ui[r].pfmt].RightIndentTwips;if(t){if(l+tc.EACH_INDENT<tc.MAX_INDENT)l+=tc.EACH_INDENT;else l=tc.MAX_INDENT}else{if(l-tc.EACH_INDENT>=0)l-=tc.EACH_INDENT;else l=0}if(Y_){W_[k_].RightIndentTwips=l;fB(false);W_[k_].ParaMask|=tc.PMASK_INDENT;return true}if(Nj(lO&tc.TFLAG11_NO_RIGHT_INDENT_TABLES)&&ui[r].cid>0)continue;ui[r].pfmt=ZZ(ui[r].pfmt,Nc[ui[r].pfmt].LeftIndentTwips,l,Nc[ui[r].pfmt].FirstIndentTwips,Nc[ui[r].pfmt].TabId,Nc[ui[r].pfmt].BltId,Nc[ui[r].pfmt].AuxId,Nc[ui[r].pfmt].Aux1Id,Nc[ui[r].pfmt].StyId,Nc[ui[r].pfmt].shading,Nc[ui[r].pfmt].pflags,Nc[ui[r].pfmt].SpaceBefore,Nc[ui[r].pfmt].SpaceAfter,Nc[ui[r].pfmt].SpaceBetween,Nc[ui[r].pfmt].LineSpacing,Nc[ui[r].pfmt].BkColor,Nc[ui[r].pfmt].BorderSpaceLeft,Nc[ui[r].pfmt].flow,Nc[ui[r].pfmt].flags)}oi.modified++;if(!Y_&&i<Fo)Fo=i;if(e)cG();else T9(i,f+10-i);return true};_i.ParaHangingIndent=function(t,e){var r,i,f;var l,a,n,c,s,_,o;var u=0;if(!lv||!QD())_i.TerCreateControl();if(!oi.WordWrap)return false;jZ();i=zC;f=iI;if(!Y_)V8(i,0,f,0,"P".charCodeAt(0));for(r=i;r<=f;r++){if(!pm(r))continue;if(Y_){s=W_[k_].LeftIndentTwips;_=W_[k_].FirstIndentTwips;n=W_[k_].TabId}else{s=Nc[ui[r].pfmt].LeftIndentTwips;_=Nc[ui[r].pfmt].FirstIndentTwips;n=Nc[ui[r].pfmt].TabId}o=s;c=B_[n].count;if(t){for(l=0;l<c;l++){if(B_[n].pos[l]>s){s=B_[n].pos[l];break}}if(l==c){u=m_>0?m_:720;a=s/u;s=(a+1)*u}}else{for(l=c-1;l>=0;l--){if(B_[n].pos[l]<s){s=B_[n].pos[l];break}}if(l<0){u=m_>0?m_:720;a=s/u;if(s==a*u)a--;s=a*u}}if(s>tc.MAX_INDENT)s=tc.MAX_INDENT;if(s<0)s=0;_=_-(s-o);if(Y_){W_[k_].LeftIndentTwips=s;W_[k_].FirstIndentTwips=_;fB(false);W_[k_].ParaMask|=tc.PMASK_INDENT;return true}ui[r].pfmt=ZZ(ui[r].pfmt,s,Nc[ui[r].pfmt].RightIndentTwips,_,Nc[ui[r].pfmt].TabId,Nc[ui[r].pfmt].BltId,Nc[ui[r].pfmt].AuxId,Nc[ui[r].pfmt].Aux1Id,Nc[ui[r].pfmt].StyId,Nc[ui[r].pfmt].shading,Nc[ui[r].pfmt].pflags,Nc[ui[r].pfmt].SpaceBefore,Nc[ui[r].pfmt].SpaceAfter,Nc[ui[r].pfmt].SpaceBetween,Nc[ui[r].pfmt].LineSpacing,Nc[ui[r].pfmt].BkColor,Nc[ui[r].pfmt].BorderSpaceLeft,Nc[ui[r].pfmt].flow,Nc[ui[r].pfmt].flags)}oi.modified++;if(!Y_&&i<Fo)Fo=i;if(e)cG();else T9(i,f+10-i);return true};function RZ(t,e){var r=false;var i=ui[t].pfmt;var f=0,l=0;nP=false;fI=0;Wd=0;if(e)f=dV(Nc[i].FirstIndentTwips);else f=DV(Nc[i].FirstIndentTwips);if(Nj(ui[t].flags&tc.LFLAG_LIST)){l=Nj(ui[t].tabw)?ui[t].tabw.ListTextWidth:0;if(oi.PrintView&&!oi.FittedView&&e)l=bV(l);f+=l;r=true}else if(Nj(Nc[i].flags&tc.BULLET)){var a=Nc[i].BltId;var n=false;if(Nj(xc[a].flags&tc.BLTFLAG_HIDDEN))n=true;if(!n){if(Nc[i].FirstIndent<0){l=-f;f=0}else{CB(Ti,t,i,0,0,0,false);l=zI;if(e)l=dV(l);else l=DV(l);f+=l}r=true}}if(ui[t].tabw!=null&&ui[t].tabw.FrameCharPos==0&&Dj(Nc[i].flags&(tc.CENTER|tc.JUSTIFY|tc.RIGHT_JUSTIFY))){var c=ui[t].tabw.FrameWidth;if(oi.PrintView&&!oi.FittedView&&e)c=bV(c);Wd=c}nP=r;fI=l;return f}function LZ(){var i,t,e=0;var f;var a;if(uA!=tc.HILIGHT_OFF)ON();var r=_i.DlgCompHeight;var n=_i.DlgFont;var c=new $t.DialogBox(te,"Paragraph Borders",n,true,P,2);var s=c.cvs;c.addGroupBox(0,0,7,1,"Sides",n,0,JV(8));var _=new $t.CheckBox(s,0,0,JV(15),JV(16),n,"Left",false,null);c.addComp(_,1,0,1,1,"Left","middle",JV(15),JV(8),JV(40),0);var o=new $t.CheckBox(s,0,0,JV(15),JV(16),n,"Right",false,null);c.addComp(o,2,0,1,1,"Right","middle",JV(15),JV(8),JV(40),0);var u=new $t.CheckBox(s,0,0,JV(15),JV(16),n,"Top",false,null);c.addComp(u,3,0,1,1,"Top","middle",JV(15),JV(8),JV(40),0);var T=new $t.CheckBox(s,0,0,JV(15),JV(16),n,"Bottom",false,null);c.addComp(T,4,0,1,1,"Bot","middle",JV(15),JV(8),JV(40),0);var A=new $t.CheckBox(s,0,0,JV(15),JV(16),n,"Between",false,null);c.addComp(A,5,0,1,1,"Between","middle",JV(15),JV(8),JV(40),0);var E=new $t.Label(s,0,0,n," ");c.addComp(E,6,0,1,1,"Between","middle",JV(15),0,JV(40),JV(-12));c.addGroupBox(0,1,3,2,"Type",n,0,JV(8));var R=new $t.CheckBox(s,0,0,JV(15),JV(16),n,"Double Frame",false,null);c.addComp(R,1,1,1,2,"Double","middle",JV(15),0,JV(40),0);var L=new $t.CheckBox(s,0,0,JV(15),JV(16),n,"Thick Frame",false,null);c.addComp(L,2,1,1,2,"Left","middle",JV(15),0,JV(40),0);var C=new $t.Label(s,0,0,n,"Shading %");c.addComp(C,5,1,1,1,"left","middle",0,JV(-5));var I=new $t.TextBox(s,0,0,JV(60),r,"",n,_i.caret,false,true,null);c.addComp(I,5,2,1,1,"left","middle",0,JV(-5));var d=new $t.Button(s,0,0,JV(155),r,n,"Border Color..",true,function(t,e){Dy("Border Color","line",a,function(t){a=t})});c.addComp(d,6,1,1,2,"left","middle",0,0);c.show();var F=true;if(Y_){t=W_[k_].ParaFlags;i=W_[k_].shading;a=W_[k_].ParaBorderColor;F=true}else{e=ui[br].pfmt;t=Nc[e].flags;i=Nc[e].shading;a=Nc[e].BorderColor;if(oZ(br)){var g=FldBoxLeft;FldBoxLeft=FldBoxRight;FldBoxRight=FldBoxLeft}if(uA!=tc.HILIGHT_OFF){for(l=sA+1;l<=_A;l++){if(!pm(l))continue;if((t&tc.PARA_BOX_ATTRIB)!=(Nc[ui[l].pfmt].flags&tc.PARA_BOX_ATTRIB)||i!=Nc[ui[l].pfmt].shading)break}if(l<=_A)F=false}}if(F){u.setSelected((t&tc.PARA_BOX_TOP)!=0);T.setSelected((t&tc.PARA_BOX_BOT)!=0);A.setSelected((t&tc.PARA_BOX_BETWEEN)!=0);_.setSelected((t&tc.PARA_BOX_LEFT)!=0);o.setSelected((t&tc.PARA_BOX_RIGHT)!=0);R.setSelected((t&tc.PARA_BOX_DOUBLE)!=0);L.setSelected((t&tc.PARA_BOX_THICK)!=0)}if(F)I.setText(mY(i/100));_.setFocus();function P(t,e,r){if(t=="Cancel"){c.hide();return}else if(t=="OK"){es=rs=0;if(u.isSelected())es|=tc.PARA_BOX_TOP;else rs|=tc.PARA_BOX_TOP;if(T.isSelected())es|=tc.PARA_BOX_BOT;else rs|=tc.PARA_BOX_BOT;if(A.isSelected())es|=tc.PARA_BOX_BETWEEN;else rs|=tc.PARA_BOX_BETWEEN;if(_.isSelected())es|=tc.PARA_BOX_LEFT;else rs|=tc.PARA_BOX_LEFT;if(o.isSelected())es|=tc.PARA_BOX_RIGHT;else rs|=tc.PARA_BOX_RIGHT;if(R.isSelected())es|=tc.PARA_BOX_DOUBLE;else rs|=tc.PARA_BOX_DOUBLE;if(L.isSelected())es|=tc.PARA_BOX_THICK;else rs|=tc.PARA_BOX_THICK;c.hide();if(JO!=""){i=LX(I);if(i<0)i=0;if(i>100)i=100;i=i*100;if(Nj(es)||Nj(rs))f=false;else f=true;_i.TerSetParaShading(i,f)}if(Dj(rs)&&Nj(es))_i.SetTerParaFmt(es,true,false);else if(Nj(rs)&&Dj(es))_i.SetTerParaFmt(rs,false,false);else if(Nj(rs)&&Nj(es)){_i.SetTerParaFmt(es,true,false);_i.SetTerParaFmt(rs,false,true)}_i.TerSetParaBorderColor(a,true)}else return}return true}_i.TerSetParaShading=function(t,e){var r,i,f;if(!lv||!QD())_i.TerCreateControl();if(!oi.WordWrap)return false;if(t<0)t=0;if(t>1e4)t=1e4;if(Y_){W_[k_].shading=t;W_[k_].ParaMask|=tc.PMASK_SHADING;return true}jZ();i=zC;f=iI;if(!Y_)V8(i,0,f,0,"P".charCodeAt(0));for(r=i;r<=f;r++){if(!pm(r))continue;ui[r].pfmt=ZZ(ui[r].pfmt,Nc[ui[r].pfmt].LeftIndentTwips,Nc[ui[r].pfmt].RightIndentTwips,Nc[ui[r].pfmt].FirstIndentTwips,Nc[ui[r].pfmt].TabId,Nc[ui[r].pfmt].BltId,Nc[ui[r].pfmt].AuxId,Nc[ui[r].pfmt].Aux1Id,Nc[ui[r].pfmt].StyId,t,Nc[ui[r].pfmt].pflags,Nc[ui[r].pfmt].SpaceBefore,Nc[ui[r].pfmt].SpaceAfter,Nc[ui[r].pfmt].SpaceBetween,Nc[ui[r].pfmt].LineSpacing,Nc[ui[r].pfmt].BkColor,Nc[ui[r].pfmt].BorderSpaceLeft,Nc[ui[r].pfmt].flow,Nc[ui[r].pfmt].flags)}oi.modified++;if(e){cG();if(ai)fB(false)}else T9(i,f+10-i);return true};function CZ(t){var e,r;var i;e=ui[t].fid;if(e>0&&Dj(kl[e].flags&tc.PARA_FRAME_TEXT_BOX))return true;r=ui[t].pfmt;i=Nc[r].flags;if(Nj(ui[t].flags&tc.LFLAG_BOX_TOP))na|=tc.BOX_TOP;if(Nj(ui[t].flags&tc.LFLAG_BOX_BOT))na|=tc.BOX_BOT;if(Nj(ui[t].flags2&tc.LFLAG2_BOX_BETWEEN))na|=tc.BOX_BETWEEN;if(Nj(i&tc.PARA_BOX_LEFT))na|=tc.BOX_LEFT;if(Nj(i&tc.PARA_BOX_RIGHT))na|=tc.BOX_RIGHT;if(Nj(i&tc.PARA_BOX_DOUBLE))na|=tc.BOX_DOUBLE;if(Nj(i&tc.PARA_BOX_THICK))na|=tc.BOX_THICK;if(Nj(ui[t].tabw)&&Nj(ui[t].tabw.type&tc.INFO_PAGE))na=0;if(BK(ui[t].pfmt))na=_j(na,tc.BOX_BOT);return true}function IZ(t,e){var r,i;var f=ui[t].pfmt,l=ui[e].pfmt,a,n;if(ui[t].page!=ui[e].page)return false;if(Nj(ui[t].tabw)&&Nj(ui[t].tabw.type&(tc.INFO_PAGE|tc.INFO_ROW|tc.INFO_COL)))f=0;if(Nj(ui[t].flags&tc.LFLAG_HDRS_FTRS))f=0;if(Nj(ui[e].tabw)&&Nj(ui[e].tabw.type&(tc.INFO_PAGE|tc.INFO_ROW|tc.INFO_COL)))l=0;if(Nj(ui[e].flags&tc.LFLAG_HDRS_FTRS))l=0;r=Nc[f].flags;i=Nc[l].flags;if((r&tc.PARA_BOX_ATTRIB)!=(i&tc.PARA_BOX_ATTRIB))return false;if((r&tc.PAGE_HDR_FTR)!=(i&tc.PAGE_HDR_FTR))return false;if(Nc[f].BorderSpaceLeft!=Nc[l].BorderSpaceLeft)return false;if(!MJ(Nc[f].BorderColor,Nc[l].BorderColor))return false;a=Nc[f].LeftIndentTwips;if(Nc[f].FirstIndentTwips<0)a+=Nc[f].FirstIndentTwips;n=Nc[l].LeftIndentTwips;if(Nc[l].FirstIndentTwips<0)n+=Nc[l].FirstIndentTwips;if(a!=n)return false;if(Nc[f].RightIndentTwips!=Nc[l].RightIndentTwips)return false;if(ui[t].cid!=ui[e].cid)return false;return true}function dZ(t,e){var r,i;var f=ui[t].pfmt,l=ui[e].pfmt,a,n;if(Li)return false;if(Nj(ui[t].tabw)&&Nj(ui[t].tabw.type&tc.INFO_PAGE))f=0;if(Nj(ui[t].flags&tc.LFLAG_HDRS_FTRS))f=0;if(Nj(ui[e].tabw)&&Nj(ui[e].tabw.type&tc.INFO_PAGE))l=0;if(Nj(ui[e].flags&tc.LFLAG_HDRS_FTRS))l=0;if(Nc[f].shading!=Nc[l].shading)return false;if(Nc[f].BkColor!=Nc[l].BkColor)return false;r=Nc[f].flags;i=Nc[l].flags;if(Nj(r&tc.PAGE_HDR_FTR)!=Nj(i&tc.PAGE_HDR_FTR))return false;a=Nc[f].LeftIndent;if(Nc[f].FirstIndent<0)a+=Nc[f].FirstIndent;n=Nc[l].LeftIndent;if(Nc[l].FirstIndent<0)n+=Nc[l].FirstIndent;if(a!=n)return false;if(Nc[f].RightIndent!=Nc[l].RightIndent)return false;if(ui[t].cid!=ui[e].cid)return false;return true}function FZ(){if(uA!=tc.HILIGHT_OFF)ON();var t=_i.DlgCompHeight;var e=_i.DlgFont;var i=new $t.DialogBox(te,"Paragraph Spacing",e,true,F,JV(2));var r=i.cvs;i.addGroupBox(0,0,2,3,"Line Spacing",e,0,JV(10));var f=new $t.ComboBox(r,0,0,JV(125),t,true,JV(150),true,e,true,true,g);f.setMaximumRowCount(6);i.addComp(f,1,0,1,1,"left","bottom",0,0,JV(10));var l=new $t.TextBox(r,0,0,JV(80),t,"",e,_i.caret,false,true,null);i.addComp(l,1,1,1,1,"left","middle");var a=new $t.Label(r,0,0,e,"       ");i.addComp(a,1,2,1,1,"left","middle");var n=new $t.Label(r,0,0,e,"");i.addComp(n,2,1,1,1,"left","middle");i.addGroupBox(3,0,3,3,"",e,0,JV(10));var c=new $t.Label(r,0,0,e,"Space Before Paragraph (points)");i.addComp(c,4,0,1,2,"left","middle");var s=new $t.TextBox(r,0,0,JV(60),t,"",e,_i.caret,false,true,null);i.addComp(s,4,2,1,1,"left","middle",0,0,30);var _=new $t.Label(r,0,0,e,"Space after Paragraph (points)");i.addComp(_,5,0,1,2,"left","middle");var o=new $t.TextBox(r,0,0,JV(60),t,"",e,_i.caret,false,true,null);i.addComp(o,5,2,1,1,"left","middle",0,0,JV(30));i.show();var u=true,T=true;var A,E,R,L,C=0;var I=[];var d=[];I.push(tg.MsgString[tc.MSG_SINGLE]);d.push(tc.PSPACE_SINGLE);I.push(tg.MsgString[tc.MSG_15LINES]);d.push(tc.PSPACE_15);I.push(tg.MsgString[tc.MSG_DBL_LINE]);d.push(tc.PSPACE_20);I.push(tg.MsgString[tc.MSG_ATLEAST]);d.push(tc.PSPACE_ATLEAST);I.push(tg.MsgString[tc.MSG_EXACTLY]);d.push(tc.PSPACE_EXACTLY);I.push(tg.MsgString[tc.MSG_MULTIPLE]);d.push(tc.PSPACE_MULTIPLE);f.setItems(I,d,0);l.setEnabled(false);a.setText("");if(Y_)T=true;else{if(uA!=tc.HILIGHT_OFF){T=true;ParaId=sA<_A?ui[sA].pfmt:ui[_A].pfmt}else ParaId=ui[br].pfmt}A=12;E=0;if(T){if(Y_){s.setText(tj(W_[k_].SpaceBefore).toString());o.setText(tj(W_[k_].SpaceAfter).toString());A=tj(W_[k_].SpaceBetween);E=W_[k_].LineSpacing;if(0!=(W_[k_].ParaFlags&tc.DOUBLE_SPACE))E=100}else{s.setText(tj(Nc[ParaId].SpaceBefore).toString());o.setText(tj(Nc[ParaId].SpaceAfter).toString());A=tj(Nc[ParaId].SpaceBetween);E=Nc[ParaId].LineSpacing;if(0!=(Nc[ParaId].flags&tc.DOUBLE_SPACE))E=100}if(E==0){if(A==0)C=tc.PSPACE_SINGLE;else if(A>0)C=tc.PSPACE_ATLEAST;else C=tc.PSPACE_EXACTLY}else{if(E==50)C=tc.PSPACE_15;else if(E==100)C=tc.PSPACE_20;else C=tc.PSPACE_MULTIPLE}P(C,A,E)}Is=A;ds=E;u=false;f.setFocus();function F(t,e,r){if(t=="Cancel"){i.hide();return}else if(t=="OK"){Ls=CX(s)*20;if(!aP){vJ(0);s.setFocus();return}Cs=CX(o)*20;if(!aP){vJ(0);o.setFocus();return}C=f.getSelectedIndex();A=E=0;if(C==tc.PSPACE_15)E=50;if(C==tc.PSPACE_20)E=100;if(C==tc.PSPACE_MULTIPLE){JO=l.getText();multiple=CX(JO);if(multiple<.5)multiple=.5;if(multiple>9)multiple=9;E=multiple*100-100}if(C==tc.PSPACE_ATLEAST){A=LX(l);if(!aP)return}if(C==tc.PSPACE_EXACTLY){A=LX(l);if(!aP)return;A=-A}Is=A;ds=E;i.hide();_i.TerSetParaSpacing2(Ls,Cs,ej(Is),ds,true)}}function g(t,e,r){if(t!="selected")return;if(u)return;C=f.getSelectedIndex();P(C,Is,ds)}function P(t,e,r){var i;u=true;f.setSelectedIndex(t);if(t==tc.PSPACE_SINGLE||t==tc.PSPACE_15||t==tc.PSPACE_20){l.setEnabled(false);l.setText("");a.setText("")}else if(t==tc.PSPACE_MULTIPLE){i=(r+100)/100;l.setText(AX(i,2));l.setEnabled(true);a.setText(tg.MsgString[tc.MSG_LINES])}else if(t==tc.PSPACE_EXACTLY||t==tc.PSPACE_ATLEAST){if(e<0)e=-e;if(e==0)e=12;l.setText(e.toString());l.setEnabled(true);a.setText(tg.MsgString[tc.MSG_POINTS])}u=false;return true}return true}_i.TerSetParaSpacing=function(t,e,r,i){return _i.TerSetParaSpacing2(t,e,r,0,i)};_i.TerSetParaSpacing2=function(t,e,r,i,f){var l,a,n,c,s,_,o;var u;if(!lv||!QD())_i.TerCreateControl();if(!oi.WordWrap)return false;if(t>5e3)t=5e3;if(e>5e3)e=5e3;if(r<-2e3&&r!=-9999)r=-2e3;if(r>2e3)r=2e3;jZ();a=zC;n=iI;if(!Y_)V8(a,0,n,0,"P".charCodeAt(0));for(l=a;l<=n;l++){if(!pm(l))continue;if(Y_){u=W_[k_].ParaFlags;c=t>=0?t:W_[k_].SpaceBefore;s=e>=0?e:W_[k_].SpaceAfter;_=r!=-9999?r:W_[k_].SpaceBetween;o=i>=0?i:W_[k_].LineSpacing}else{u=Nc[ui[l].pfmt].flags;c=t>=0?t:Nc[ui[l].pfmt].SpaceBefore;s=e>=0?e:Nc[ui[l].pfmt].SpaceAfter;_=r!=-9999?r:Nc[ui[l].pfmt].SpaceBetween;o=i>=0?i:Nc[ui[l].pfmt].LineSpacing}if(_!=0)o=0;if(o!=0)_=0;if(r!=-9999||i>=0)u=cj(u,tc.DOUBLE_SPACE);if(e>=0)u=cj(u,tc.AUTO_SPACE_AFTER);if(t>=0)u=cj(u,tc.AUTO_SPACE_BEFORE);if(Y_){W_[k_].SpaceBefore=c;W_[k_].SpaceAfter=s;W_[k_].SpaceBetween=_;W_[k_].LineSpacing=o;W_[k_].ParaFlags=u;W_[k_].ParaMask|=tc.PMASK_SPACING;return true}ui[l].pfmt=ZZ(ui[l].pfmt,Nc[ui[l].pfmt].LeftIndentTwips,Nc[ui[l].pfmt].RightIndentTwips,Nc[ui[l].pfmt].FirstIndentTwips,Nc[ui[l].pfmt].TabId,Nc[ui[l].pfmt].BltId,Nc[ui[l].pfmt].AuxId,Nc[ui[l].pfmt].Aux1Id,Nc[ui[l].pfmt].StyId,Nc[ui[l].pfmt].shading,Nc[ui[l].pfmt].pflags,c,s,_,o,Nc[ui[l].pfmt].BkColor,Nc[ui[l].pfmt].BorderSpaceLeft,Nc[ui[l].pfmt].flow,u)}oi.modified++;if(f){cG();if(ai)fB(false)}else T9(a,n+10-a);return true};_i.TerSetParaBkColor=function(t,e,r){var i,f;if(typeof e=="string")e=yK(e);if(!lv||!QD())_i.TerCreateControl();if(!oi.WordWrap)return false;if(!t)return gZ(e,r);jZ();i=zC;f=iI;if(Y_)e=W_[k_].ParaBkColor;else e=Nc[ui[i].pfmt].BkColor;NewColor=e;Dy("Paragraph Background Color","bknd",e,l);function l(t){if(!MJ(t,NewColor))return gZ(t,r)}};function gZ(t,e){var r,i,f;jZ();i=zC;f=iI;if(!Y_)V8(i,0,f,0,"P".charCodeAt(0));oi.modified++;for(r=i;r<=f;r++){if(!pm(r))continue;if(Y_){W_[k_].ParaBkColor=t;W_[k_].ParaMask|=tc.PMASK_BK_COLOR;return true}ui[r].pfmt=ZZ(ui[r].pfmt,Nc[ui[r].pfmt].LeftIndentTwips,Nc[ui[r].pfmt].RightIndentTwips,Nc[ui[r].pfmt].FirstIndentTwips,Nc[ui[r].pfmt].TabId,Nc[ui[r].pfmt].BltId,Nc[ui[r].pfmt].AuxId,Nc[ui[r].pfmt].Aux1Id,Nc[ui[r].pfmt].StyId,Nc[ui[r].pfmt].shading,Nc[ui[r].pfmt].pflags,Nc[ui[r].pfmt].SpaceBefore,Nc[ui[r].pfmt].SpaceAfter,Nc[ui[r].pfmt].SpaceBetween,Nc[ui[r].pfmt].LineSpacing,t,Nc[ui[r].pfmt].BorderSpaceLeft,Nc[ui[r].pfmt].flow,Nc[ui[r].pfmt].flags)}if(e)cG();return true}_i.TerSetParaProps=function(t,e,r){var i,f,l;var a;var n;if(!lv||!QD())_i.TerCreateControl();if(!oi.WordWrap)return false;if(t<0||t>=Dc)return false;jZ();f=zC;l=iI;if(!Y_)V8(f,0,l,0,"P".charCodeAt(0));oi.modified++;for(i=f;i<=l;i++){if(!pm(i))continue;if(Y_){if(Nj(e&tc.PMASK_INDENT_LEFT)){W_[k_].LeftIndentTwips=Nc[t].LeftIndentTwips;W_[k_].ParaMask|=tc.PMASK_INDENT_LEFT}if(Nj(e&tc.PMASK_INDENT_LEFT)){W_[k_].RightIndentTwips=Nc[t].RightIndentTwips;W_[k_].ParaMask|=tc.PMASK_INDENT_RIGHT}if(Nj(e&tc.PMASK_INDENT_FIRST)){W_[k_].FirstIndentTwips=Nc[t].FirstIndentTwips;W_[k_].ParaMask|=tc.PMASK_INDENT_FIRST}if(Nj(e&tc.PMASK_TAB)){W_[k_].TabId=Nc[t].TabId;W_[k_].ParaMask|=tc.PMASK_TAB}if(Nj(e&tc.PMASK_OLVL)){W_[k_].OutlineLevel=Nc[t].OutlineLevel;W_[k_].ParaMask|=tc.PMASK_OLVL}if(Nj(e&tc.PMASK_BULLET)){W_[k_].BltId=Nc[t].BltId;W_[k_].ParaMask|=tc.PMASK_BULLET}if(Nj(e&tc.PMASK_SHADING)){W_[k_].shading=Nc[t].shading;W_[k_].ParaMask|=tc.PMASK_SHADING}if(Nj(e&tc.PMASK_SPACING)){W_[k_].SpaceBefore=Nc[t].SpaceBefore;W_[k_].SpaceAfter=Nc[t].SpaceAfter;W_[k_].SpaceBetween=Nc[t].SpaceBetween;W_[k_].LineSpacing=Nc[t].LineSpacing;W_[k_].ParaMask|=tc.PMASK_SPACING}if(Nj(e&tc.PMASK_BK_COLOR)){W_[k_].ParaBkColor=Nc[t].BkColor;W_[k_].ParaMask|=tc.PMASK_BK_COLOR}if(Nj(e&tc.PMASK_BORDER)){}if(Nj(e&tc.PMASK_FLOW)){W_[k_].ParaFlow=Nc[t].flow;W_[k_].ParaMask|=tc.PMASK_FLOW}if(Nj(e&tc.PMASK_BORDER_COLOR)){W_[k_].ParaBorderColor=Nc[t].BorderColor;W_[k_].ParaMask|=tc.PMASK_BORDER_COLOR}W_[k_].ParaFlags=Nc[t].flags;W_[k_].pflags=Nc[t].pflags;W_[k_].ParaMask|=e&(tc.PMASK_ALIGN|tc.PMASK_KEEP|tc.PMASK_KEEP_NEXT|tc.PMASK_WIDOW|tc.PMASK_PAGE_BREAK|tc.PMASK_CONTEXTUAL_SPACE);return true}a=Nc[ui[i].pfmt].copy();a.StyId=Nc[t].StyId;if(Nj(e&tc.PMASK_INDENT)){a.LeftIndent=Nc[t].LeftIndent;a.LeftIndentTwips=Nc[t].LeftIndentTwips}if(Nj(e&tc.PMASK_INDENT)){a.RightIndent=Nc[t].RightIndent;a.RightIndentTwips=Nc[t].RightIndentTwips}if(Nj(e&tc.PMASK_INDENT)){a.FirstIndent=Nc[t].FirstIndent;a.FirstIndentTwips=Nc[t].FirstIndentTwips}if(Nj(e&tc.PMASK_TAB))a.TabId=Nc[t].TabId;if(Nj(e&tc.PMASK_BULLET)){a.BltId=Nc[t].BltId;a.flags=cj(a.flags,tc.BULLET);a.flags|=Nc[t].flags&tc.BULLET}if(Nj(e&tc.PMASK_SHADING))a.shading=Nc[t].shading;if(Nj(e&tc.PMASK_SPACING)){a.SpaceBefore=Nc[t].SpaceBefore;a.SpaceAfter=Nc[t].SpaceAfter;a.SpaceBetween=Nc[t].SpaceBetween;a.LineSpacing=Nc[t].LineSpacing;n=tc.AUTO_SPACE_BEFORE|tc.AUTO_SPACE_AFTER|tc.DOUBLE_SPACE;a.flags=cj(a.flags,n);a.flags|=Nc[t].flags&n}if(Nj(e&tc.PMASK_BK_COLOR))a.BkColor=Nc[t].BkColor;if(Nj(e&tc.PMASK_BORDER_COLOR))a.BorderColor=Nc[t].BorderColor;if(Nj(e&tc.PMASK_BORDER)){n=tc.PARA_BOX_LEFT|tc.PARA_BOX_RIGHT|tc.PARA_BOX_TOP|tc.PARA_BOX_BOT|tc.PARA_BOX_DOUBLE|tc.PARA_BOX_THICK|tc.PARA_BOX_BETWEEN|tc.PARA_BOX_ATTRIB;a.flags=cj(a.flags,n);a.flags|=Nc[t].flags&n;a.BorderSpaceLeft=Nc[t].BorderSpaceLeft}if(Nj(e&tc.PMASK_FLOW))a.flow=Nc[t].flow;if(Nj(e&tc.PMASK_ALIGN)){n=tc.LEFT|tc.RIGHT_JUSTIFY|tc.JUSTIFY|tc.CENTER;a.flags=cj(a.flags,n);a.flags|=Nc[t].flags&n}if(Nj(e&tc.PMASK_KEEP))a.flags|=Nc[t].flags&tc.PARA_KEEP;if(Nj(e&tc.PMASK_KEEP_NEXT))a.flags|=Nc[t].flags&tc.PARA_KEEP_NEXT;if(Nj(e&tc.PMASK_CONTEXTUAL_SPACE))a.flags|=Nc[t].flags&tc.PARA_CONTEXTUAL_SPACE;if(Nj(e&tc.PMASK_WIDOW))a.pflags|=Nc[t].pflags&tc.PFLAG_WIDOW;if(Nj(e&tc.PMASK_PAGE_BREAK))a.pflags|=Nc[t].pflags&tc.PFLAG_PAGE_BREAK;ui[i].pfmt=QZ(ui[i].pfmt,a)}if(r)cG();return true};_i.TerSetParaBorderColor=function(t,e){var r,i,f;var l;if(typeof t=="string")t=yK(t);if(!lv||!QD())_i.TerCreateControl();if(!oi.WordWrap)return false;jZ();i=zC;f=iI;if(!Y_)V8(i,0,f,0,"P".charCodeAt(0));oi.modified++;for(r=i;r<=f;r++){if(!pm(r))continue;if(Y_){W_[k_].ParaBorderColor=t;W_[k_].ParaMask|=tc.PMASK_BORDER_COLOR;return true}l=Nc[ui[r].pfmt].copy();l.BorderColor=t;ui[r].pfmt=QZ(ui[r].pfmt,l)}if(e)cG();return true};_i.TerSetParaIdTextFlow=function(t,e){var r;if(!lv||!QD())_i.TerCreateControl();if(t<0||t>=Dc)return t;r=Nc[t].copy();r.flow=e;return QZ(t,r)};_i.TerSetParaIdBorderColor=function(t,e,r){var i;if(!lv||!QD())_i.TerCreateControl();if(t<0||t>=Dc)return t;i=Nc[t].copy();i.BorderColor=e;i.BorderSpaceLeft=r;return QZ(t,i)};_i.TerSetParaIdBorderSpace=function(t,e,r,i,f){var l;if(!lv||!QD())_i.TerCreateControl();if(t<0||t>=Dc)return t;l=Nc[t].copy();l.BorderSpaceLeft=e;l.BorderSpaceRight=r;l.BorderSpaceTop=i;l.BorderSpaceBot=f;return QZ(t,l)};_i.TerSetParaIdBorderWidth=function(t,e){var r;if(!lv||!QD())_i.TerCreateControl();if(t<0||t>=Dc)return t;r=Nc[t].copy();r.BorderWidth=e;return QZ(t,r)};_i.TerSetParaIdWidthHeight=function(t,e,r){var i;if(!lv||!QD())_i.TerCreateControl();if(t<0||t>=Dc)return t;if(e==-1&&r==-1)return t;i=Nc[t].copy();if(e!=-1)i.width=e;if(r!=-1)i.height=r;return QZ(t,i)};_i.TerUpdateStyle=function(t){var e,r,i;if(!_i.TerCreateControl())return false;k_=Nc[ui[br].pfmt].StyId;if(k_==0){r=$w();if(xs[r].CharStyId!=1)k_=xs[r].CharStyId}i=W_[k_].type;U_=W_[k_].copy();r=ib(br,jt);W_[k_].TypeFace=xs[r].TypeFace;W_[k_].FontFamily=xs[r].FontFamily;W_[k_].TwipsSize=xs[r].TwipsSize;W_[k_].style=cj(xs[r].style,tc.PICT|tc.CHAR_BOX|tc.FNOTEALL);W_[k_].TextColor=xs[r].TextColor;W_[k_].TextBkColor=xs[r].TextBkColor;W_[k_].UlineColor=xs[r].UlineColor;W_[k_].expand=xs[r].expand;W_[k_].CharScaleX=xs[r].ScaleX;W_[k_].offset=xs[r].offset;W_[k_].StyleMask=2147483647;W_[k_].StyleMask=cj(W_[k_].StyleMask,tc.PICT|tc.CHAR_BOX|tc.FNOTEALL);W_[k_].CharMask=tc.CMASK_FONT|tc.CMASK_SIZE|tc.CMASK_TEXT_COLOR|tc.CMASK_TEXT_BK_COLOR|tc.CMASK_ULINE_COLOR|tc.CMASK_EXPAND|tc.CMASK_SCALE_X|tc.CMASK_OFFSET;if(i==tc.SSTYPE_PARA){e=ui[br].pfmt;W_[k_].LeftIndentTwips=Nc[e].LeftIndentTwips;W_[k_].RightIndentTwips=Nc[e].RightIndentTwips;W_[k_].FirstIndentTwips=Nc[e].FirstIndentTwips;W_[k_].ParaFlags=cj(Nc[e].flags,tc.PAGE_HDR_FTR);W_[k_].pflags=Nc[e].pflags&tc.PFLAG_STYLES;W_[k_].shading=Nc[e].shading;W_[k_].SpaceBefore=Nc[e].SpaceBefore;W_[k_].SpaceAfter=Nc[e].SpaceAfter;W_[k_].SpaceBetween=Nc[e].SpaceBetween;W_[k_].LineSpacing=Nc[e].LineSpacing;W_[k_].ParaBkColor=Nc[e].BkColor;W_[k_].ParaBorderColor=Nc[e].BorderColor;W_[k_].TabId=Nc[e].TabId;W_[k_].OutlineLevel=Nc[e].OutlineLevel;W_[k_].ParaMask=tc.PMASK_LS|tc.PMASK_LVL|tc.PMASK_OLVL|tc.PMASK_ALIGN|tc.PMASK_CONTEXTUAL_SPACE|tc.PMASK_KEEP|tc.PMASK_KEEP_NEXT|tc.PMASK_WIDOW|tc.PMASK_PAGE_BREAK|tc.PMASK_BORDER|tc.PMASK_SHADING|tc.PMASK_BK_COLOR|tc.PMASK_FLOW|tc.PMASK_TAB|tc.PMASK_SPACING|tc.PMASK_INDENT|tc.PMASK_BULLET}if(W_[k_].type==tc.SSTYPE_PARA)Y_=true;uA=tc.HILIGHT_OFF;if(W_[k_].type==tc.SSTYPE_PARA)yZ(k_);else wZ(k_);k_=-1;Y_=false;oi.modified++;if(t)cG();else T9(0,Ri);return true};_i.TerEditStyle=function(t,e,r,i,f){var l="",a="heading ";var n,c;if(!lv||!QD())_i.TerCreateControl();if(e==null||e==""){if(k_<0)t=true;else t=false}if(t&&k_>=0)return-1;if(!t&&k_<0)return-1;if(!r&&Tk(e,"Default Paragraph Font")==0)return-1;if(!t){var s=k_;if(W_[k_].type==tc.SSTYPE_PARA)yZ(k_);else wZ(k_);k_=-1;Y_=false;V_=false;oi.modified++;YA=true;if(f)cG();else T9(0,Ri);return s}if(e!=null&&e!="")return PZ(e,r,i,f);var _=_i.DlgCompHeight;var o=_i.DlgFont;var u=new $t.DialogBox(te,"Edit Stylesheet",o,true,P);var T=u.cvs;u.addGroupBox(0,0,2,1,"Type",o,0,JV(10),0,0);var A=new $t.RadioButton(T,0,0,JV(15),o,"Paragraph Style",true,null,v);u.addComp(A,0,0,1,1,"left","bottom",JV(10),0,JV(70));var E=new $t.RadioButton(T,0,0,JV(15),o,"Character Style",false,A,p);u.addComp(E,1,0,1,1,"left","middle",JV(10),0);var R=new $t.Label(T,0,0,o,"Select a style or edit");u.addComp(R,0,1,1,1,"left","top",JV(10),JV(-3));var L=new $t.ListBox(T,0,0,JV(200),JV(225),o,true,true,h);XZ(L,tc.SSTYPE_PARA,false,true);u.addComp(L,0,1,5,1,"Left","top",JV(10),JV(15));var C=new $t.CheckBox(T,0,0,JV(15),JV(16),o,"Create new style",false,O);u.addComp(C,3,0,1,1,"Left","top",0,0);var I=new $t.Label(T,0,0,o,"Style Name");I.setEnabled(false);u.addComp(I,4,0,1,1,"left","top",0,JV(-5));var d=new $t.TextBox(T,0,0,JV(200),_,"",o,_i.caret,false,true,null);u.addComp(d,4,0,1,1,"left","bottom",0,JV(-5));u.addGroupBox(6,0,1,2,"",o,JV(5),0,0,0);var F="Select a style to edit or type in a new style name.\n\n";F+="Click OK to begin recording the style attributes.\n\n";F+="You can select paragraph or font option selections ";F+="from the menu, toolbar or the ruler.  \n\nTo end the ";F+="stylesheet recording, select the 'Edit Style' option ";F+="from the edit menu or click anywhere on the text.";var g=new $t.Label(T,0,0,o,"");g.setWrapWidth(JV(400));g.setText(F);u.addComp(g,6,0,1,2,"left","top",JV(10),JV(10));u.show();A.setFocus();function P(t,e,r){if(t=="Cancel"){u.hide();return}else if(t=="OK"){return S()}}function S(){if(C.isSelected()){e=d.getText().trim();if(e.length==0){qk(tg.MsgString[tc.MSG_TYPE_STYLE_NAME],null);d.setFocus();return}for(n=0;n<X_;n++){if(W_[n].InUse&&W_[n].name==e){if(W_[n].type==tc.SSTYPE_PARA)qk(tg.MsgString[tc.MSG_PARASTYLE_IN_USE],null);else qk(tg.MsgString[tc.MSG_CHARSTYLE_IN_USE],null);d.setFocus();return}}}else{e=L.getSelectedItem()}r=C.isSelected();if(A.isSelected())i=tc.SSTYPE_PARA;else i=tc.SSTYPE_CHAR;u.hide();return PZ(e,r,i,f)}function h(t,e,r){if(t=="enter"||t=="dblclick")return S()}function O(t,e,r){var i=C.isSelected();L.setEnabled(!i);R.setEnabled(!i);d.setEnabled(i);I.setEnabled(i)}function v(t,e,r){if(!A.isSelected())return;XZ(L,tc.SSTYPE_PARA,false,true);L.refresh();L.setEnabled(true);R.setEnabled(true)}function p(t,e,r){if(!E.isSelected())return;var i,f=0;XZ(L,tc.SSTYPE_CHAR,false,true);L.refresh();for(i=0;i<X_;i++)if(W_[i].InUse&&W_[i].type==tc.SSTYPE_CHAR)f++;if(f<=1){C.setSelected(true);L.setEnabled(false);R.setEnabled(false);d.setEnabled(true);I.setEnabled(true)}}return 0};function PZ(t,e,r,i){var f="",l="heading ";var a,n;if(e){for(a=0;a<X_;a++){if(W_[a].InUse&&Tk(W_[a].name,t)==0){e=false;break}}}if(e){k_=UZ();if(k_<0)return-1;if(r!=tc.SSTYPE_CHAR&&r!=tc.SSTYPE_PARA)r=tc.SSTYPE_PARA;W_[k_].name=t;W_[k_].InUse=true;W_[k_].type=r;W_[k_].OutlineLevel=-1;if(r==tc.SSTYPE_PARA&&t.length>l.length){var c;var s=l.length,_=-1;c=t;c=cV(c,0,s);var o=Uk(t);if(Tk(c,l)==0)_=o[s]-"1".charCodeAt(0);if(_<0||_>8)_=-1;W_[k_].OutlineLevel=_}font=$w();if(Tk(xs[font].TypeFace,oi.FontTypeFace)!=0||r==tc.SSTYPE_PARA){W_[k_].TypeFace=xs[font].TypeFace;W_[k_].FontFamily=xs[font].FontFamily}else W_[k_].FontFamily=xs[0].FontFamily;if(xs[font].TwipsSize/20!=oi.PointSize||r==tc.SSTYPE_PARA)W_[k_].TwipsSize=xs[font].TwipsSize;W_[k_].style=cj(xs[font].style,tc.PICT|tc.CHAR_BOX|tc.FNOTEALL);W_[k_].TextColor=xs[font].TextColor;W_[k_].TextBkColor=xs[font].TextBkColor;W_[k_].UlineColor=xs[font].UlineColor;W_[k_].expand=xs[font].expand;W_[k_].CharScaleX=xs[font].ScaleX;W_[k_].offset=xs[font].offset;W_[k_].StyleMask=W_[k_].CharMask=0;if(Nj(eO&tc.TFLAG7_RECORD_CUR_CHAR_PROPS)){W_[k_].StyleMask=2147483647;W_[k_].StyleMask=cj(W_[k_].StyleMask,tc.PICT|tc.CHAR_BOX|tc.FNOTEALL);W_[k_].CharMask=tc.CMASK_FONT|tc.CMASK_SIZE|tc.CMASK_TEXT_COLOR|tc.CMASK_TEXT_BK_COLOR|tc.CMASK_ULINE_COLOR|tc.CMASK_EXPAND|tc.CMASK_SCALE_X|tc.CMASK_OFFSET}if(r==tc.SSTYPE_PARA){n=ui[br].pfmt;W_[k_].LeftIndentTwips=Nc[n].LeftIndentTwips;W_[k_].RightIndentTwips=Nc[n].RightIndentTwips;W_[k_].FirstIndentTwips=Nc[n].FirstIndentTwips;W_[k_].ParaFlags=cj(Nc[n].flags,tc.PAGE_HDR_FTR);W_[k_].pflags=Nc[n].pflags&tc.PFLAG_STYLES;W_[k_].shading=Nc[n].shading;W_[k_].SpaceBefore=Nc[n].SpaceBefore;W_[k_].SpaceAfter=Nc[n].SpaceAfter;W_[k_].SpaceBetween=Nc[n].SpaceBetween;W_[k_].LineSpacing=Nc[n].LineSpacing;W_[k_].ParaBkColor=Nc[n].BkColor;W_[k_].ParaBorderColor=Nc[n].BorderColor;W_[k_].TabId=Nc[n].TabId;W_[k_].OutlineLevel=Nc[n].OutlineLevel;W_[k_].ParaMask=0;if(Nj(eO&tc.TFLAG7_RECORD_CUR_PARA_PROPS)){W_[k_].ParaMask=tc.PMASK_LS|tc.PMASK_LVL|tc.PMASK_OLVL|tc.PMASK_ALIGN|tc.PMASK_CONTEXTUAL_SPACE|tc.PMASK_KEEP|tc.PMASK_KEEP_NEXT|tc.PMASK_WIDOW|tc.PMASK_PAGE_BREAK|tc.PMASK_BORDER|tc.PMASK_SHADING|tc.PMASK_BK_COLOR|tc.PMASK_FLOW|tc.PMASK_TAB|tc.PMASK_SPACING|tc.PMASK_INDENT|tc.PMASK_BULLET}V_=true}W_[k_].flags|=tc.SSFLAG_ADD}else{for(a=0;a<X_;a++){if(W_[a].InUse&&Tk(W_[a].name,t)==0){k_=a;break}}}U_=W_[k_].copy();if(W_[k_].type==tc.SSTYPE_PARA)Y_=true;uA=tc.HILIGHT_OFF;cG();FN(true);return k_}_i.TerCancelEditStyle=function(){if(!lv||!QD())_i.TerCreateControl();if(k_==-1)return false;W_[k_]=U_.copy();k_=-1;Y_=false;V_=false;cG();return true};function SZ(t){var e;var r;var i="heading ";var f;r=i.length;f=W_[t].name.toLowerCase();if(f.length<r)return 0;if(cV(f,0,r)!=i)return 0;if(f.length>r+1)return 0;var l=Uk(f);e=l[r];return e-tc.CHAR_0}_i.TerGetStyleParam=function(t,e){if(!lv||!QD())_i.TerCreateControl();if(t<0||t>=X_||!W_[t].InUse)return-1;if(e==tc.SSINFO_CHAR_SPACE){return W_[t].expand}else if(e==tc.SSINFO_CHAR_OFFSET){return W_[t].offset}else if(e==tc.SSINFO_NEXT){return W_[t].next}else if(e==tc.SSINFO_BASED_ON){return W_[t].BasedOn}else if(e==tc.SSINFO_OUTLINE_LEVEL){return W_[t].OutlineLevel}else return-1};_i.TerSetStyleParam=function(t,e,r,i,f){if(!lv||!QD())_i.TerCreateControl();if(t<0||t>=X_||!W_[t].InUse)return false;if(e==tc.SSINFO_NAME){W_[t].name=i}else if(e==tc.SSINFO_NEXT){var l=r;if(l<0||l>=X_||!W_[l].InUse)return false;W_[t].next=l}else if(e==tc.SSINFO_BASED_ON){var a=r;if(a<0||a>=X_||!W_[a].InUse)return false;W_[t].BasedOn=a}else if(e==tc.SSINFO_OUTLINE_LEVEL){var n=r;if(n<-1||n>8)return false;W_[t].OutlineLevel=n}else return false;oi.modified++;if(f)FN(true);return true};_i.TerGetStyleId=function(t){var e;if(!lv||!QD())_i.TerCreateControl();if(t==null||t.length==0)return-1;for(e=0;e<X_;e++)if(Tk(t,W_[e].name)==0)break;if(e>=X_)return-1;else return e};_i.TerGetStyleInfo=function(t){if(!lv||!QD())_i.TerCreateControl();LP="";kC=0;if(t<0||t>=X_||Dj(W_[t].InUse))return-1;LP=W_[t].name;kC=W_[t].type;return X_};_i.TerDeleteStyle=function(t,e){var r;if(!lv||!QD())_i.TerCreateControl();if(t<0){if(e==null||e.length==0)return false;for(r=2;r<X_;r++)if(Tk(e,W_[r].name)==0)break;if(r>=X_)return false;t=r}if(t<2)return false;if(W_[t].type==tc.SSTYPE_PARA){for(r=0;r<Dc;r++){if(Nc[r].StyId==t)Nc[r].StyId=0}}for(r=0;r<Ys;r++){if(xs[r].ParaStyId==t)xs[r].ParaStyId=0;if(xs[r].CharStyId==t)xs[r].CharStyId=1}W_[t].InUse=false;oi.modified++;return true};function hZ(){var t=false;if(uA!=tc.HILIGHT_OFF){ON();if(Nj(ui[sA].flags&tc.LFLAG_PARA_FIRST)&&TA==0&&Nj(ui[_A].flags&tc.LFLAG_PARA)&&AA>=ui[_A].len-1)t=true}else t=true;if(t){cO|=tc.TOFLAG3_FORCE_CHAR_STYLES;_i.TerSelectParaStyle(0,true);Tj(tc.TOFLAG3_FORCE_CHAR_STYLES)}else _i.TerSelectCharStyle(1,true);return true}_i.TerSelectCharStyle=function(t,e){if(!lv||!QD())_i.TerCreateControl();if(t>=0){if(t>=X_||W_[t].type!=tc.SSTYPE_CHAR)return false;return qb(tc.CMASK_CHAR_STYLE,t,0,null,e)}OZ(tc.SSTYPE_CHAR,r);function r(){t=hs;if(t>=X_||W_[t].type!=tc.SSTYPE_CHAR)return false;return qb(tc.CMASK_CHAR_STYLE,t,0,null,e)}};function OZ(t,e){var r=_i.DlgCompHeight;var i=_i.DlgFont;var f=new $t.DialogBox(te,"Select a Style",i,true,n,JV(2));var l=f.cvs;var a=new $t.ListBox(l,0,0,JV(250),JV(200),i,true,true,c);f.addComp(a,0,0,1,1,"Left","middle",0,0,JV(10),0);BQ(a,true,true,-1);XZ(a,t,true,true);f.show();a.setFocus();function n(t,e,r){if(t=="Cancel"){f.hide();return}else if(t=="OK"){return s()}}function c(t,e,r){if(t=="dblclick"||t=="enter"){s();f.hide()}}function s(){hs=a.getSelectedItemData();f.hide();if(e)e()}}_i.TerForceCharStyles=function(t,e){var r;for(r=0;r<Ys;r++){var i=xs[r].CharStyId;if(i==0)continue;if(i==1){if(t)i=0;else continue}if(Nj(W_[i].CharMask&tc.CMASK_FONT)&&xs[r].CharSet!=tc.SYMBOL_CHARSET&&W_[i].TypeFace.length>0)xs[r].TypeFace=W_[i].TypeFace;if(Nj(W_[i].CharMask&tc.CMASK_SIZE))xs[r].TwipsSize=W_[i].TwipsSize;xs[r].style=cj(xs[r].style,W_[i].StyleMask);xs[r].style|=W_[i].style&W_[i].StyleMask;if(Nj(W_[i].CharMask&tc.CMASK_TEXT_COLOR))xs[r].TextColor=W_[i].TextColor;if(Nj(W_[i].CharMask&tc.CMASK_TEXT_BK_COLOR))xs[r].TextBkColor=W_[i].TextBkColor;if(Nj(W_[i].CharMask&tc.CMASK_ULINE_COLOR))xs[r].UlineColor=W_[i].UlineColor;if(Nj(W_[i].CharMask&tc.CMASK_EXPAND))xs[r].expand=W_[i].expand;if(Nj(W_[i].CharMask&tc.CMASK_SCALE_X))xs[r].ScaleX=W_[i].CharScaleX;if(Nj(W_[i].CharMask&tc.CMASK_OFFSET))xs[r].offset=W_[i].offset}oi.modified++;Fo=0;Oc=-1;if(e)cG();return true};_i.TerRefreshStyles=function(t){var e,r,i;var f;var l,a;if(!lv||!QD())_i.TerCreateControl();if(!oi.WordWrap)return false;jZ();e=zC;r=iI;if(Nj(Zh&tc.TFLAG2_PROTECT_FORMAT)&&xN(e,0,r,ui[r].len,true,false))return true;if(!Y_){var n=uE;V8(e,0,r,ui[r].len-1,tc.CHAR_F);uE=n;V8(e,0,r,0,"P".charCodeAt(0))}for(i=e;i<=r;i++){if(!pm(i))continue;l=a=Nc[ui[i].pfmt].StyId;f=Nc[ui[i].pfmt];mZ(f,W_[f.StyId],W_[a],false);f.StyId=a;ui[i].pfmt=QZ(ui[i].pfmt,f);NZ(i,a,l,true)}oi.modified++;Fo=e;Oc=-1;if(t)cG();else T9(e,r+10-e);return true};_i.TerSelectParaStyle=function(t,e){var r,i,f;var l;var a;if(!lv||!QD())_i.TerCreateControl();if(!oi.WordWrap)return false;if(t>=0)return vZ(t,e);OZ(tc.SSTYPE_PARA,n);function n(){t=hs;if(t>=X_||W_[t].type!=tc.SSTYPE_PARA)return false;return vZ(t,e)}};function vZ(t,e){if(t>=X_||W_[t].type!=tc.SSTYPE_PARA)return false;jZ();FirstLine=zC;LastLine=iI;if(Nj(Zh&tc.TFLAG2_PROTECT_FORMAT)&&xN(FirstLine,0,LastLine,ui[LastLine].len,true,false))return true;if(!Y_){var r=uE;V8(FirstLine,0,LastLine,ui[LastLine].len-1,tc.CHAR_F);uE=r;V8(FirstLine,0,LastLine,0,"P".charCodeAt(0))}for(l=FirstLine;l<=LastLine;l++){if(!pm(l))continue;PrevStyId=Nc[ui[l].pfmt].StyId;para=Nc[ui[l].pfmt].copy();mZ(para,W_[para.StyId],W_[t],true);para.StyId=t;ui[l].pfmt=QZ(ui[l].pfmt,para);NZ(l,t,PrevStyId,false)}oi.modified++;Fo=FirstLine;Oc=-1;if(e)cG();else T9(FirstLine,LastLine+10-FirstLine);return true}function pZ(t,e,r){return NZ(t,e,r,false)}function NZ(t,e,r,i){var f,l,a=0,n=0,c=0;var s;var _,o;var u=tc.BOLD|tc.ULINE|tc.ULINED|tc.ITALIC|tc.STRIKE|tc.DOUBLE_STRIKE|tc.SUPSCR|tc.SUBSCR|tc.SCAPS|tc.CAPS|tc.HIDDEN|tc.PROTECT;l=ui[t].len;if(l==0)return true;s=nb(t);for(f=0;f<l;f++){n=a;a=s[f];if(Nj(xs[a].style&tc.PICT)){if(Nj(W_[e].style&tc.HIDDEN))xs[a].style|=tc.HIDDEN;else xs[a].style=cj(xs[a].style,tc.HIDDEN);continue}if(a==n&&f>0){s[f]=c;continue}_=xs[a].ShallowCopy();o=xs[a].ShallowCopy();if(Nj(W_[r].CharMask&tc.CMASK_FONT)&&_.CharSet!=tc.SYMBOL_CHARSET)_.TypeFace=oi.FontTypeFace;if(Nj(W_[r].CharMask&tc.CMASK_SIZE))_.TwipsSize=oi.PointSize*20;_.style=cj(_.style,W_[r].style&W_[r].StyleMask);if(Nj(W_[r].CharMask&tc.CMASK_TEXT_COLOR)&&MJ(W_[r].TextColor,_.TextColor))_.TextColor=tc.CLR_BLACK;if(Nj(W_[r].CharMask&tc.CMASK_TEXT_BK_COLOR))_.TextBkColor=tc.CLR_WHITE;if(Nj(W_[r].CharMask&tc.CMASK_ULINE_COLOR))_.UlineColor=tc.CLR_BLACK;if(Nj(W_[r].CharMask&tc.CMASK_EXPAND))_.expand=0;if(Nj(W_[r].CharMask&tc.CMASK_SCALE_X))_.ScaleX=0;if(Nj(W_[r].CharMask&tc.CMASK_OFFSET))_.offset=0;var T=Nj(_.style&tc.PROTECT);if(i){if(W_[e].TypeFace.length>0&&_.CharSet!=tc.SYMBOL_CHARSET)_.TypeFace=W_[e].TypeFace;if(W_[e].TwipsSize>0)_.TwipsSize=W_[e].TwipsSize;_.style=cj(_.style,u);_.style=W_[e].style&u;_.TextColor=W_[e].TextColor;_.TextBkColor=W_[e].TextBkColor;_.UlineColor=W_[e].UlineColor;_.expand=W_[e].expand;_.ScaleX=W_[e].CharScaleX;_.offset=W_[e].offset;if(e==0)_.CharStyId=1}else{if(Nj(W_[e].CharMask&tc.CMASK_FONT)&&_.CharSet!=tc.SYMBOL_CHARSET&&W_[e].TypeFace.length>0)_.TypeFace=W_[e].TypeFace;if(Nj(W_[e].CharMask&tc.CMASK_SIZE))_.TwipsSize=W_[e].TwipsSize;_.style=cj(_.style,W_[e].StyleMask);_.style|=W_[e].style&W_[e].StyleMask;if(Nj(W_[e].CharMask&tc.CMASK_TEXT_COLOR)){var A=Nj(W_[r].CharMask&tc.CMASK_TEXT_COLOR)&&MJ(W_[r].TextColor,o.TextColor);if(!A&&Dj(W_[r].CharMask&tc.CMASK_TEXT_COLOR))A=true;if(!A){if(Lk(W_[e].name.toLowerCase(),"toc"))A=true}if(A)_.TextColor=W_[e].TextColor}if(Nj(W_[e].CharMask&tc.CMASK_TEXT_BK_COLOR))_.TextBkColor=W_[e].TextBkColor;if(Nj(W_[e].CharMask&tc.CMASK_ULINE_COLOR))_.UlineColor=W_[e].UlineColor;if(Nj(W_[e].CharMask&tc.CMASK_EXPAND))_.expand=W_[e].expand;if(Nj(W_[e].CharMask&tc.CMASK_SCALE_X))_.ScaleX=W_[e].CharScaleX;if(Nj(W_[e].CharMask&tc.CMASK_OFFSET))_.offset=W_[e].offset}if(T&&Nj(iO&tc.TFLAG9_RETAIN_PROTECT_STYLE))_.style|=tc.PROTECT;_.ParaStyId=e;c=Lb(Ti,a,_);if(c<0)c=a;if(xs[c].CharStyId!=1)c=DZ(c,false);s[f]=c}return true}function DZ(t,e){var r,i,f;var l;l=xs[t].ShallowCopy();r=1;i=xs[t].CharStyId;BZ(l,W_[r],W_[i],e);l.CharStyId=i;if((f=Lb(Ti,t,l))>=0){return f}else return t}function MZ(t,e){var r,i,f=0,l=0,a=0;var n;var c;i=ui[t].len;if(i==0)return true;n=nb(t);for(r=0;r<i;r++){l=f;f=n[r];if(Nj(xs[f].style&tc.PICT))continue;if(f==l&&r>0){n[r]=a;continue}c=xs[f].ShallowCopy();c.ParaStyId=e;a=Lb(Ti,f,c);if(a<0)a=f;n[r]=a}return true}function GZ(t,e,r,i,f,l){var a,n;var c,s,_;var o;a=t;c=e;s=xs[a].CharStyId;_=Nc[ui[f].pfmt].StyId;o=xs[a].ShallowCopy();if(Nj(xs[a].style&tc.PICT))return t;if(Tk(o.TypeFace,W_[_].TypeFace)==0)o.TypeFace=oi.FontTypeFace;if(o.TwipsSize==W_[_].TwipsSize)o.TwipsSize=oi.PointSize*20;o.style=cj(o.style,W_[_].style);if(o.TextColor==W_[_].TextColor)o.TextColor=new tc.Color(0);if(o.TextBkColor==W_[_].TextBkColor)o.TextBkColor=tc.CLR_WHITE;if(o.UlineColor==W_[_].UlineColor)o.UlineColor=new tc.Color(0);if(o.expand==W_[_].expand)o.expand=0;if(o.ScaleX==W_[_].CharScaleX)o.ScaleX=0;if(o.offset==W_[_].offset)o.offset=0;o.CharStyId=c;BZ(o,W_[o.ParaStyId],W_[_],c==1);if(s==1)W_[s].CharMask=0;if(c!=1)BZ(o,W_[s],W_[c],false);if((n=Lb(Ti,a,o))>=0){return n}else return t}function BZ(t,e,r,i){return HZ(t,e,r,i,false)}function HZ(t,e,r,i,f){var l=Tk(r.name,"Default Paragraph Font")==0;var a=false;var n=k_>=0&&Y_&&!V_;if(l)i=true;if(Nj(iO&tc.TFLAG9_FORCE_STYLE))i=true;if(i||Nj(r.CharMask&tc.CMASK_FONT)){if(r.TypeFace.length>0){a=!n||Nj(e.CharMask&tc.CMASK_FONT)&&Tk(t.TypeFace,e.TypeFace)==0;if(a){t.TypeFace=r.TypeFace;if(t.CharSet==tc.SYMBOL_CHARSET)t.CharSet=ks}}else if(Tk(r.name,"Default Paragraph Font")==0){t.TypeFace=oi.FontTypeFace;t.CharSet=xs[0].CharSet}}if(i||Nj(r.CharMask&tc.CMASK_SIZE)){if(r.TwipsSize>0){a=true;if(k_>=0){if(Nj(e.CharMask&tc.CMASK_SIZE)){a=t.TwipsSize==e.TwipsSize}else a=t.TwipsSize==xs[0].TwipsSize}if(a)t.TwipsSize=r.TwipsSize}else if(Tk(r.name,"Default Paragraph Font")==0)t.TwipsSize=oi.PointSize*20}var c=Nj(t.style&tc.PROTECT);if(i){t.style=cj(t.style,e.style);t.style=cj(t.style,tc.BOLD|tc.ULINE|tc.ULINED|tc.ITALIC|tc.STRIKE|tc.DOUBLE_STRIKE|tc.SUPSCR|tc.SUBSCR|tc.SCAPS|tc.CAPS|tc.HIDDEN|tc.PROTECT);t.style|=r.style}else{var s=tc.BOLD|tc.ULINE|tc.ULINED|tc.ITALIC|tc.STRIKE|tc.DOUBLE_STRIKE|tc.SUPSCR|tc.SUBSCR|tc.SCAPS|tc.CAPS|tc.HIDDEN|tc.PROTECT;var _=e.style&s;var o=r.style&s&r.StyleMask;t.style=cj(t.style,_);t.style|=o}if(c&&Nj(iO&tc.TFLAG9_RETAIN_PROTECT_STYLE))t.style|=tc.PROTECT;if(i){if(true||!MJ(r.TextColor,tc.CLR_BLACK))t.TextColor=r.TextColor;if(true||!MJ(r.TextBkColor,tc.CLR_WHITE))t.TextBkColor=r.TextBkColor;if(true||!MJ(r.UlineColor,tc.CLR_BLACK))t.UlineColor=r.UlineColor;t.expand=r.expand;t.ScaleX=r.CharScaleX;t.offset=r.offset}else{if(Nj(r.CharMask&tc.CMASK_TEXT_COLOR)){a=Nj(e.CharMask&tc.CMASK_TEXT_COLOR)&&MJ(e.TextColor,t.TextColor);if(!a&&Dj(e.CharMask&tc.CMASK_TEXT_COLOR)&&(MJ(t.TextColor,tc.CLR_AUTO)||MJ(t.TextColor,tc.CLR_BLACK)))a=true;if(!a&&f&&(MJ(t.TextColor,tc.CLR_AUTO)||MJ(t.TextColor,tc.CLR_BLACK)))a=true;if(a)t.TextColor=r.TextColor}if(Nj(r.CharMask&tc.CMASK_TEXT_BK_COLOR))t.TextBkColor=r.TextBkColor;if(Nj(r.CharMask&tc.CMASK_ULINE_COLOR))t.UlineColor=r.UlineColor;if(Nj(r.CharMask&tc.CMASK_EXPAND))t.expand=r.expand;if(Nj(r.CharMask&tc.CMASK_SCALE_X))t.ScaleX=r.CharScaleX;if(Nj(r.CharMask&tc.CMASK_OFFSET))t.offset=r.offset}if(t.TextColor==null)t.TextColor=tc.CLR_AUTO;if(t.TextBkColor==null)t.TextBkColor=tc.CLR_WHITE;return true}function mZ(t,e,r,i){var f;var l=0;if(Nj(iO&tc.TFLAG9_FORCE_STYLE))i=true;if(Nj(r.ParaMask&tc.PMASK_INDENT)){if(e.LeftIndentTwips!=r.LeftIndentTwips)l|=tc.PMASK_INDENT;if(e.RightIndentTwips!=r.RightIndentTwips)l|=tc.PMASK_INDENT;if(e.FirstIndentTwips!=r.FirstIndentTwips)l|=tc.PMASK_INDENT}else if(Nj(e.ParaMask&tc.PMASK_INDENT)){t.LeftIndentTwips=Nc[0].LeftIndentTwips;t.LeftIndent=Nc[0].LeftIndent;t.RightIndentTwips=Nc[0].RightIndentTwips;t.RightIndent=Nc[0].RightIndent;t.FirstIndentTwips=Nc[0].FirstIndentTwips;t.FirstIndent=Nc[0].FirstIndent}if(Nj(r.ParaMask&tc.PMASK_SPACING)){if(e.SpaceBefore!=r.SpaceBefore)l|=tc.PMASK_SPACING;if(e.SpaceAfter!=r.SpaceAfter)l|=tc.PMASK_SPACING;if(e.SpaceBetween!=r.SpaceBetween)l|=tc.PMASK_SPACING;if(e.LineSpacing!=r.LineSpacing)l|=tc.PMASK_SPACING;if((e.ParaFlags&tc.DOUBLE_SPACE)!=(r.ParaFlags&tc.DOUBLE_SPACE))l|=tc.PMASK_SPACING}else if(Nj(e.ParaMask&tc.PMASK_SPACING)){t.SpaceBefore=Nc[0].SpaceBefore;t.SpaceAfter=Nc[0].SpaceAfter;t.SpaceBetween=Nc[0].SpaceBetween;t.LineSpacing=Nc[0].LineSpacing;t.flags=cj(t.flags,tc.DOUBLE_SPACE);t.flags|=Nc[0].flags&tc.DOUBLE_SPACE}if(Nj(r.ParaMask&tc.PMASK_OLVL)){if(e.OutlineLevel!=r.OutlineLevel)l|=tc.PMASK_OLVL}else if(Nj(e.ParaMask&tc.PMASK_OLVL))t.OutlineLevel=Nc[0].OutlineLevel;if(Nj(r.ParaMask&(tc.PMASK_LS|tc.PMASK_LVL|tc.PMASK_BULLET))){if(e.BltId!=r.BltId)l|=tc.PMASK_LS|tc.PMASK_LVL|tc.PMASK_BULLET;if((e.ParaFlags&tc.BULLET)!=(r.ParaFlags&tc.BULLET))l|=tc.PMASK_LS|tc.PMASK_LVL|tc.PMASK_BULLET}else{if(Nj(e.ParaMask&(tc.PMASK_BULLET|tc.PMASK_LS|tc.PMASK_LVL)))t.BltId=Nc[0].BltId;f=tc.BULLET;t.flags=cj(t.flags,f);if(Nj(e.ParaMask&(tc.PMASK_BULLET|tc.PMASK_LS))){if(Nj(Nc[0].flags&f))t.flags|=f}}if(Nj(r.ParaMask&tc.PMASK_ALIGN)){if((e.ParaFlags&(tc.CENTER|tc.RIGHT_JUSTIFY|tc.JUSTIFY))!=(r.ParaFlags&(tc.CENTER|tc.RIGHT_JUSTIFY|tc.JUSTIFY)))l|=tc.PMASK_ALIGN}else if(Nj(e.ParaMask&tc.PMASK_ALIGN)){t.flags=cj(t.flags,tc.LEFT|tc.CENTER|tc.RIGHT_JUSTIFY|tc.JUSTIFY);t.flags|=Nc[0].flags&(tc.LEFT|tc.CENTER|tc.RIGHT_JUSTIFY|tc.JUSTIFY)}if(Nj(r.ParaMask&tc.PMASK_CONTEXTUAL_SPACE)){if((e.ParaFlags&tc.PARA_CONTEXTUAL_SPACE)!=(r.ParaFlags&tc.PARA_CONTEXTUAL_SPACE))l|=tc.PMASK_CONTEXTUAL_SPACE}else{f=tc.PARA_CONTEXTUAL_SPACE;t.flags=cj(t.flags,f);if(Nj(e.ParaMask&tc.PMASK_CONTEXTUAL_SPACE)){if(Nj(Nc[0].flags&f))t.flags|=f}}if(Nj(r.ParaMask&tc.PMASK_KEEP)){if((e.ParaFlags&tc.PARA_KEEP)!=(r.ParaFlags&tc.PARA_KEEP))l|=tc.PMASK_KEEP}else{f=tc.PARA_KEEP;t.flags=cj(t.flags,f);if(Nj(e.ParaMask&tc.PMASK_KEEP)){if(Nj(Nc[0].flags&f))t.flags|=f}}if(Nj(r.ParaMask&tc.PMASK_KEEP_NEXT)){if((e.ParaFlags&tc.PARA_KEEP_NEXT)!=(r.ParaFlags&tc.PARA_KEEP_NEXT))l|=tc.PMASK_KEEP_NEXT}else{f=tc.PARA_KEEP_NEXT;t.flags=cj(t.flags,f);if(Nj(e.ParaMask&tc.PMASK_KEEP_NEXT)){if(Nj(Nc[0].flags&f))t.flags|=f}}if(Nj(r.ParaMask&tc.PMASK_WIDOW)){if((e.pflags&tc.PFLAG_WIDOW)!=(r.pflags&tc.PFLAG_WIDOW))l|=tc.PMASK_WIDOW}else{f=tc.PFLAG_WIDOW;t.pflags=cj(t.pflags,f);if(Nj(e.ParaMask&tc.PMASK_WIDOW)){if(Nj(Nc[0].pflags&f))t.pflags|=f}}if(Nj(r.ParaMask&tc.PMASK_PAGE_BREAK)){if((e.pflags&tc.PFLAG_PAGE_BREAK)!=(r.pflags&tc.PFLAG_PAGE_BREAK))l|=tc.PMASK_PAGE_BREAK}else{f=tc.PFLAG_PAGE_BREAK;t.pflags=cj(t.pflags,f);if(Nj(e.ParaMask&tc.PMASK_PAGE_BREAK)){if(Nj(e.pflags&f))t.pflags|=f}}if(Nj(r.ParaMask&tc.PMASK_BORDER)){if((e.ParaFlags&tc.PARA_BOX)!=(r.ParaFlags&tc.PARA_BOX))l|=tc.PMASK_BORDER}else{f=tc.PARA_BOX;t.flags=cj(t.flags,f);if(Nj(e.ParaMask&tc.PMASK_BORDER)){if(Nj(Nc[0].flags&f))t.flags|=f}}if(Nj(r.ParaMask&tc.PMASK_SHADING)){if(e.shading!=r.shading)l|=tc.PMASK_SHADING}else if(Nj(e.ParaMask&tc.PMASK_SHADING))t.shading=Nc[0].shading;if(Nj(r.ParaMask&tc.PMASK_BK_COLOR)){if(e.ParaBkColor!=r.ParaBkColor)l|=tc.PMASK_BK_COLOR}else if(Nj(e.ParaMask&tc.PMASK_BK_COLOR))t.BkColor=Nc[0].BkColor;if(Nj(r.ParaMask&tc.PMASK_BORDER_COLOR)){if(e.ParaBorderColor!=r.ParaBorderColor)l|=tc.PMASK_BORDER_COLOR}else if(Nj(e.ParaMask&tc.PMASK_BORDER_COLOR))t.BorderColor=Nc[0].BorderColor;if(Nj(r.ParaMask&tc.PMASK_TAB)){if(e.TabId!=r.TabId)l|=tc.PMASK_TAB}else if(Nj(e.ParaMask&tc.PMASK_TAB))t.TabId=Nc[0].TabId;if(Nj(r.ParaMask&tc.PMASK_FLOW)){if(e.ParaFlow!=r.ParaFlow)l|=tc.PMASK_FLOW}else if(Nj(e.ParaMask&tc.PMASK_FLOW))t.flow=Nc[0].flow;if(i||Nj(l&tc.PMASK_INDENT)){t.LeftIndentTwips=r.LeftIndentTwips;t.LeftIndent=dV(r.LeftIndentTwips);t.RightIndentTwips=r.RightIndentTwips;t.RightIndent=dV(r.RightIndentTwips);t.FirstIndentTwips=r.FirstIndentTwips;t.FirstIndent=dV(r.FirstIndentTwips)}if(i||Nj(l&tc.PMASK_ALIGN)){t.flags=cj(t.flags,tc.LEFT|tc.CENTER|tc.RIGHT_JUSTIFY|tc.JUSTIFY);t.flags|=r.ParaFlags&(tc.LEFT|tc.CENTER|tc.RIGHT_JUSTIFY|tc.JUSTIFY)}if(i||Nj(l&tc.PMASK_SPACING)){t.SpaceBefore=r.SpaceBefore;t.SpaceAfter=r.SpaceAfter;t.SpaceBetween=r.SpaceBetween;t.LineSpacing=r.LineSpacing;t.flags=cj(t.flags,tc.DOUBLE_SPACE);t.flags|=r.ParaFlags&tc.DOUBLE_SPACE}f=tc.PARA_CONTEXTUAL_SPACE;if(i||Nj(l&tc.PMASK_CONTEXTUAL_SPACE)){t.flags=cj(t.flags,f);if(Nj(r.ParaFlags&f))t.flags|=f}f=tc.PARA_KEEP;if(i||Nj(l&tc.PMASK_KEEP)){t.flags=cj(t.flags,f);if(Nj(r.ParaFlags&f))t.flags|=f}f=tc.PARA_KEEP_NEXT;if(i||Nj(l&tc.PMASK_KEEP_NEXT)){t.flags=cj(t.flags,f);if(Nj(r.ParaFlags&f))t.flags|=f}if(i||Nj(l&tc.PMASK_OLVL))t.OutlineLevel=r.OutlineLevel;f=tc.BULLET;if(i||Nj(l&(tc.PMASK_BULLET|tc.PMASK_LS))){t.flags=cj(t.flags,f);if(Nj(r.ParaFlags&f))t.flags|=f}f=tc.LEFT|tc.RIGHT_JUSTIFY|tc.CENTER|tc.JUSTIFY;if(Nj(l&tc.PMASK_ALIGN)){t.flags=cj(t.flags,f);t.flags|=r.ParaFlags&f}f=tc.PARA_BOX;if(Nj(l&tc.PMASK_BORDER)){t.flags=cj(t.flags,f);t.flags|=r.ParaFlags&f}f=tc.PFLAG_WIDOW;if(i||Nj(l&tc.PMASK_WIDOW)){t.pflags=cj(t.pflags,f);if(Nj(r.pflags&f))t.pflags|=f}f=tc.PFLAG_PAGE_BREAK;if(i||Nj(l&tc.PMASK_PAGE_BREAK)){t.pflags=cj(t.pflags,f);if(Nj(r.pflags&f))t.pflags|=f}if(i||Nj(l&tc.PMASK_SHADING))t.shading=r.shading;if(i||Nj(l&tc.PMASK_FLOW))t.flow=r.ParaFlow;if(i||Nj(l&tc.PMASK_SPACING)){t.SpaceBefore=r.SpaceBefore;t.SpaceAfter=r.SpaceAfter;t.SpaceBetween=r.SpaceBetween;t.LineSpacing=r.LineSpacing;t.flags=cj(t.flags,tc.DOUBLE_SPACE);t.flags|=r.ParaFlags&tc.DOUBLE_SPACE}if(i||Nj(l&tc.PMASK_BK_COLOR))t.BkColor=r.ParaBkColor;if(i||Nj(l&tc.PMASK_BORDER_COLOR))t.BorderColor=r.ParaBorderColor;if(i||Nj(l&tc.PMASK_TAB))t.TabId=r.TabId;if(i||Nj(l&(tc.PMASK_BULLET|tc.PMASK_LS|tc.PMASK_LVL)))t.BltId=r.BltId;return true}function wZ(t){var e,r;var i;for(e=0;e<Ys;e++){if(Dj(xs[e].InUse)||Nj(xs[e].style&tc.PICT)||xs[e].CharStyId!=t)continue;i=xs[e].ShallowCopy();r=i.ParaStyId;if(Nj(W_[r].CharMask&tc.CMASK_FONT))i.TypeFace=oi.FontTypeFace;if(Nj(W_[r].CharMask&tc.CMASK_SIZE))i.TwipsSize=oi.PointSize*20;i.style=cj(i.style,W_[r].StyleMask);if(Nj(W_[r].CharMask&tc.CMASK_TEXT_COLOR))i.TextColor=tc.CLR_BLACK;if(Nj(W_[r].CharMask&tc.CMASK_TEXT_BK_COLOR))i.TextBkColor=tc.CLR_WHITE;if(Nj(W_[r].CharMask&tc.CMASK_ULINE_COLOR))i.UlineColor=tc.CLR_BLACK;if(Nj(W_[r].CharMask&tc.CMASK_EXPAND))i.expand=0;if(Nj(W_[r].CharMask&tc.CMASK_SCALE_X))i.ScaleX=0;if(Nj(W_[r].CharMask&tc.CMASK_OFFSET))i.offset=0;BZ(i,W_[r],W_[r],t==1);if(t!=1)HZ(i,U_,W_[t],false,true);xs[e]=i;Rx(Ti,e,true)}return true}function bZ(){var t,e;if(ui[br].len!=1||Dj(ui[br].flags&tc.LFLAG_PARA))return true;e=ui[br].pfmt;t=Nc[e].StyId;if(W_[t].next==t)return true;if(W_[t].next<0)return true;_i.TerSelectParaStyle(W_[t].next,true);return true}function xZ(t,e){var r;var i;if(Nj(xs[t].style&tc.PICT)){xs[t].ParaStyId=e;return t}if(Nj(xs[t].style&tc.HIDDEN))return t;i=xs[t].ShallowCopy();if(GR||i.CharStyId!=1||Nj(lO&tc.TFLAG11_NO_AUTO_PARA_STYLE_ON_TEXT))i.ParaStyId=e;else{var f=Nj(i.style&tc.PROTECT);BZ(i,W_[i.ParaStyId],W_[e],false);i.ParaStyId=e;if(f&&Nj(iO&tc.TFLAG9_RETAIN_PROTECT_STYLE))i.style|=tc.PROTECT}if((r=Lb(Ti,t,i))>=0){return r}else return t}function yZ(t){var e,r;var i=new tc.ClsStyleId;var f;var l;if(W_[t].TwipsSize==0)W_[t].TwipsSize=U_.TwipsSize;for(e=1;e<Ys;e++){if(Dj(xs[e].InUse)||Nj(xs[e].style&tc.PICT)||xs[e].ParaStyId!=t)continue;BZ(xs[e],U_,W_[t],false);if(xs[e].CharStyId!=1){i=W_[xs[e].CharStyId];if(xs[e].CharStyId==1)l=W_[t].CharMask;else l=0;if(Dj(l&tc.CMASK_FONT)&&Nj(i.CharMask&tc.CMASK_FONT))xs[e].TypeFace=i.TypeFace;if(Dj(l&tc.CMASK_SIZE)&&Nj(i.CharMask&tc.CMASK_SIZE))xs[e].TwipsSize=i.TwipsSize;if(Dj(l&tc.CMASK_EXPAND)&&Nj(i.CharMask&tc.CMASK_EXPAND))xs[e].expand=i.expand;if(Dj(l&tc.CMASK_SCALE_X)&&Nj(i.CharMask&tc.CMASK_SCALE_X))xs[e].ScaleX=i.CharScaleX;if(Dj(l&tc.CMASK_OFFSET)&&Nj(i.CharMask&tc.CMASK_OFFSET))xs[e].offset=i.offset;if(Dj(l&tc.CMASK_TEXT_COLOR)&&Nj(i.CharMask&tc.CMASK_TEXT_COLOR))xs[e].TextColor=i.TextColor;if(Dj(l&tc.CMASK_TEXT_BK_COLOR)&&Nj(i.CharMask&tc.CMASK_TEXT_BK_COLOR))xs[e].TextBkColor=i.TextBkColor;if(Dj(l&tc.CMASK_ULINE_COLOR)&&Nj(i.CharMask&tc.CMASK_ULINE_COLOR))xs[e].UlineColor=i.UlineColor;var a=Nj(xs[e].style&tc.PROTECT);xs[e].style=cj(xs[e].style,i.StyleMask);xs[e].style|=i.style;if(a&&Nj(iO&tc.TFLAG9_RETAIN_PROTECT_STYLE))xs[e].style|=tc.PROTECT}Rx(Ti,e,true)}if(t==0){if(Nj(W_[t].CharMask&tc.CMASK_FONT)){xs[0].TypeFace=W_[t].TypeFace}if(Nj(W_[t].CharMask&tc.CMASK_SIZE)){xs[0].TwipsSize=W_[t].TwipsSize;oi.PointSize=W_[t].TwipsSize/20}xs[0].style=cj(xs[0].style,W_[t].StyleMask);xs[0].style|=W_[t].style;if(Nj(W_[t].CharMask&tc.CMASK_TEXT_COLOR))xs[0].TextColor=W_[t].TextColor;if(Nj(W_[t].CharMask&tc.CMASK_TEXT_BK_COLOR))xs[0].TextBkColor=W_[t].TextBkColor;if(Nj(W_[t].CharMask&tc.CMASK_ULINE_COLOR))xs[0].UlineColor=W_[t].UlineColor;if(Nj(W_[t].CharMask&tc.CMASK_EXPAND))xs[0].expand=W_[t].expand;if(Nj(W_[t].CharMask&tc.CMASK_SCALE_X))xs[0].ScaleX=W_[t].CharScaleX;if(Nj(W_[t].CharMask&tc.CMASK_OFFSET))xs[0].offset=W_[t].offset;Rx(Ti,0,true)}f=false;for(e=1;e<Dc;e++){if(Nc[e].StyId!=t)continue;mZ(Nc[e],U_,W_[t],f)}if(t==0){if(Nj(W_[t].ParaMask&tc.PMASK_INDENT)){Nc[0].LeftIndentTwips=W_[t].LeftIndentTwips;Nc[0].RightIndentTwips=W_[t].RightIndentTwips;Nc[0].FirstIndentTwips=W_[t].FirstIndentTwips;Nc[0].LeftIndent=dV(Nc[0].LeftIndentTwips);Nc[0].RightIndent=dV(Nc[0].RightIndentTwips);Nc[0].FirstIndent=dV(Nc[0].FirstIndentTwips)}r=tc.PARA_CONTEXTUAL_SPACE;Nc[0].flags=cj(Nc[0].flags,r);if(Nj(W_[t].ParaMask&tc.PMASK_CONTEXTUAL_SPACE)){if(Nj(W_[t].ParaFlags&r))Nc[0].flags|=r}r=tc.PARA_KEEP;Nc[0].flags=cj(Nc[0].flags,r);if(Nj(W_[t].ParaMask&tc.PMASK_KEEP)){if(Nj(W_[t].ParaFlags&r))Nc[0].flags|=r}r=tc.PARA_KEEP_NEXT;Nc[0].flags=cj(Nc[0].flags,r);if(Nj(W_[t].ParaMask&tc.PMASK_KEEP_NEXT)){if(Nj(W_[t].ParaFlags&r))Nc[0].flags|=r}if(Nj(W_[t].ParaMask&tc.PMASK_OLVL))Nc[0].OutlineLevel=W_[t].OutlineLevel;r=tc.BULLET;Nc[0].flags=cj(Nc[0].flags,r);if(Nj(W_[t].ParaMask&(tc.PMASK_BULLET|tc.PMASK_LS))){if(Nj(W_[t].ParaFlags&r))Nc[0].flags|=r}r=tc.LEFT|tc.RIGHT_JUSTIFY|tc.CENTER|tc.JUSTIFY;Nc[0].flags=cj(Nc[0].flags,r);if(Nj(W_[t].ParaMask&tc.PMASK_ALIGN)){Nc[0].flags|=W_[t].ParaFlags&r}r=tc.PARA_BOX;Nc[0].flags=cj(Nc[0].flags,r);if(Nj(W_[t].ParaMask&tc.PMASK_BORDER)){Nc[0].flags|=W_[t].ParaFlags&r}r=tc.PFLAG_WIDOW;Nc[0].pflags=cj(Nc[0].pflags,r);if(Nj(W_[t].ParaMask&tc.PMASK_WIDOW)){if(Nj(W_[t].pflags&r))Nc[0].pflags|=r}r=tc.PFLAG_PAGE_BREAK;Nc[0].pflags=cj(Nc[0].pflags,r);if(Nj(W_[t].ParaMask&tc.PMASK_PAGE_BREAK)){if(Nj(W_[t].pflags&r))Nc[0].pflags|=r}if(Nj(W_[t].ParaMask&tc.PMASK_SHADING))Nc[0].shading=W_[t].shading;if(Nj(W_[t].ParaMask&tc.PMASK_FLOW))Nc[0].flow=W_[t].ParaFlow;if(Nj(W_[t].ParaMask&tc.PMASK_SPACING)){Nc[0].SpaceBefore=W_[t].SpaceBefore;Nc[0].SpaceAfter=W_[t].SpaceAfter;Nc[0].SpaceBetween=W_[t].SpaceBetween;Nc[0].LineSpacing=W_[t].LineSpacing;Nc[0].flags=cj(Nc[0].flags,tc.DOUBLE_SPACE);Nc[0].flags|=W_[t].ParaFlags&tc.DOUBLE_SPACE}if(Nj(W_[t].ParaMask&tc.PMASK_BK_COLOR))Nc[0].BkColor=W_[t].ParaBkColor;if(Nj(W_[t].ParaMask&tc.PMASK_BORDER_COLOR))Nc[0].BorderColor=W_[t].ParaBorderColor;if(Nj(W_[t].ParaMask&tc.PMASK_TAB))Nc[0].TabId=W_[t].TabId}return true}function WZ(t,e){W_[e].TypeFace=W_[t].TypeFace;W_[e].TwipsSize=W_[t].TwipsSize;W_[e].style=W_[t].style;W_[e].TextColor=W_[t].TextColor;W_[e].TextBkColor=W_[t].TextBkColor;W_[e].UlineColor=W_[t].UlineColor;W_[e].expand=W_[t].expand;W_[e].CharScaleX=W_[t].CharScaleX;W_[e].offset=W_[t].offset;W_[e].CharMask=W_[t].CharMask;W_[e].StyleMask=W_[t].StyleMask;return true}function UZ(){var t;var e;for(t=2;t<X_;t++){if(!W_[t].InUse){W_[t]=kZ();return t}}if(X_>=K_){e=K_+K_/2;W_=fV(W_,e);K_=e}if(X_<K_){X_++;W_[X_-1]=kZ();return X_-1}QY(tc.MSG_OUT_OF_STYLESHEET,null);return-1}function kZ(){var t=new tc.ClsStyleId;t.TypeFace="";t.OutlineLevel=-1;return t}function XZ(t,e,r,i){var f,l=0,a,n=0;if(r){if(e==tc.SSTYPE_CHAR){a=$w();l=xs[a].CharStyId}else if(e==tc.SSTYPE_PARA)l=Nc[ui[br].pfmt].StyId;else{l=Nc[ui[br].pfmt].StyId;if(l==0){a=$w();if(xs[a].CharStyId!=1)l=xs[a].CharStyId}}}var c=[];var s=[];for(f=0;f<X_;f++){if(W_[f].InUse&&(W_[f].type==e||e==0)){c.push(W_[f].name);s.push(f);n++}}var _=0;if(r){var o;for(f=0;f<n;f++){o=s[f];if(l==o){_=f;break}}}t.setItems(c,s,_,false);if(!i&&c.length<10)t.setMaximumRowCount(c.length);else t.setMaximumRowCount(10);return true}_i.ClearAllTabs=function(t){var e,r,i;if(!lv||!QD())_i.TerCreateControl();if(!oi.WordWrap)return false;if(Y_){W_[k_].TabId=0;fB(false);W_[k_].ParaMask=cj(W_[k_].ParaMask,tc.PMASK_TAB);return true}jZ();r=zC;i=iI;if(!Y_)V8(r,0,i,0,"P".charCodeAt(0));for(e=r;e<=i;e++){if(!pm(e))continue;ui[e].pfmt=ZZ(ui[e].pfmt,Nc[ui[e].pfmt].LeftIndentTwips,Nc[ui[e].pfmt].RightIndentTwips,Nc[ui[e].pfmt].FirstIndentTwips,0,Nc[ui[e].pfmt].BltId,Nc[ui[e].pfmt].AuxId,Nc[ui[e].pfmt].Aux1Id,Nc[ui[e].pfmt].StyId,Nc[ui[e].pfmt].shading,Nc[ui[e].pfmt].pflags,Nc[ui[e].pfmt].SpaceBefore,Nc[ui[e].pfmt].SpaceAfter,Nc[ui[e].pfmt].SpaceBetween,Nc[ui[e].pfmt].LineSpacing,Nc[ui[e].pfmt].BkColor,Nc[ui[e].pfmt].BorderSpaceLeft,Nc[ui[e].pfmt].flow,Nc[ui[e].pfmt].flags)}oi.modified++;if(t){cG();if(ai)fB(false)}else T9(r,i+10-r);return true};function KZ(){var t,e,r;if(Y_)e=W_[k_].TabId;else e=Nc[ui[br].pfmt].TabId;var i=_i.DlgCompHeight;var f=_i.DlgFont;var l=new $t.DialogBox(te,"Clear a Tab Position",f,true,o,JV(2));var a=l.cvs;var n=new $t.ListBox(a,0,0,JV(150),JV(200),f,true,true,u);l.addComp(n,0,0,1,1,"Left","middle");BQ(n,true,true,-1);l.show();var c;var s=Nj(zh&tc.TFLAG_METRIC);var _=[];for(c=0;c<B_[e].count;c++){if(s)r=AX(lj(B_[e].pos[c]/1440),2);else r=AX(B_[e].pos[c]/1440,2);_.push(r)}n.setItems(_,null,0);n.setFocus();function o(t,e,r){if(t=="Cancel"){l.hide();return}else if(t=="OK"){T()}}function u(t,e,r){if(t=="dblclick"||t=="enter"){return T()}}function T(){t=n.getSelectedIndex();l.hide();_i.ClearTab(B_[e].pos[t],true)}return true}_i.ClearTab=function(t,e){var r,i,f;var l,a,n,c;var s=new tc.TejTab;var _;if(!lv||!QD())_i.TerCreateControl();if(!oi.WordWrap)return false;if(t<0)t=0;jZ();i=zC;f=iI;if(!Y_)V8(i,0,f,0,"P".charCodeAt(0));for(r=i;r<=f;r++){if(!pm(r))continue;if(Y_){n=W_[k_].TabId;if(B_[n].count==0)break}else{n=Nc[ui[r].pfmt].TabId;if(B_[n].count==0)continue}s=B_[n].copy();_=false;while(s.count>0){for(l=0;l<s.count;l++)if(Math.abs(s.pos[l]-t)<tc.SNAP_DIST/2)break;if(l==s.count)break;a=l;for(l=a+1;l<s.count;l++){s.pos[l-1]=s.pos[l];s.type[l-1]=s.type[l];s.flags[l-1]=s.flags[l]}s.count--;_=true}if(!_)continue;c=YZ(n,s);if(Y_){W_[k_].TabId=c;fB(false);W_[k_].ParaMask|=tc.PMASK_TAB;return true}ui[r].pfmt=ZZ(ui[r].pfmt,Nc[ui[r].pfmt].LeftIndentTwips,Nc[ui[r].pfmt].RightIndentTwips,Nc[ui[r].pfmt].FirstIndentTwips,c,Nc[ui[r].pfmt].BltId,Nc[ui[r].pfmt].AuxId,Nc[ui[r].pfmt].Aux1Id,Nc[ui[r].pfmt].StyId,Nc[ui[r].pfmt].shading,Nc[ui[r].pfmt].pflags,Nc[ui[r].pfmt].SpaceBefore,Nc[ui[r].pfmt].SpaceAfter,Nc[ui[r].pfmt].SpaceBetween,Nc[ui[r].pfmt].LineSpacing,Nc[ui[r].pfmt].BkColor,Nc[ui[r].pfmt].BorderSpaceLeft,Nc[ui[r].pfmt].flow,Nc[ui[r].pfmt].flags)}oi.modified++;if(e){cG();if(ai)fB(false)}else T9(i,f+10-i);return true};function YZ(t,e){var r,i;var f;var l;var a=[tc.MAX_TABS];var n;if(e.count==0)return 0;for(r=0;r<H_;r++){if(B_[r].count==e.count){for(i=0;i<e.count;i++){if(B_[r].pos[i]!=e.pos[i])break;if(B_[r].type[i]!=e.type[i])break;if(B_[r].flags[i]!=e.flags[i])break}if(i==e.count)return r}}f=-1;if(H_>=tc.MAX_TABS){for(r=0;r<H_;r++){if(B_[r].count==0){f=r;break}}if(f==-1){n=[Dc];for(r=0;r<Dc;r++)n[r]=false;for(l=0;l<Ri;l++)n[ui[l].pfmt]=true;for(r=1;r<Dc;r++)if(!n[r])Nc[r].TabId=0;for(r=1;r<tc.MAX_TABS;r++)a[r]=false;for(i=0;i<Dc;i++)a[Nc[i].TabId]=true;for(r=1;r<tc.MAX_TABS;r++){if(!a[r]){if(f<0)f=r;B_[r].count=0;break}}}}if(H_<tc.MAX_TABS||f>=0){if(H_<tc.MAX_TABS){r=H_;H_++}else r=f;B_[r]=e.copy();return r}if(Dj(aO&tc.TOFLAG_NO_MORE_TAB_MSG)){QY(tc.MSG_OUT_OF_TAB_TABLE,null);aO|=tc.TOFLAG_NO_MORE_TAB_MSG}return t}_i.SetTab=function(t,e,r){return _i.TerSetTab(t,e,0,r)};_i.TerSetTab=function(t,l,a,n){if(!lv||!QD())_i.TerCreateControl();if(!oi.WordWrap)return false;if(l>=0)return VZ(t,l,a,n);var e=_i.DlgCompHeight;var r=_i.DlgFont;var c=new $t.DialogBox(te,"Set a Tab Position",r,true,O,JV(2));var i=c.cvs;var f=new $t.Label(i,0,0,r,"Tab positions in Inches");c.addComp(f,0,0,1,1,"Left","middle",0,0,JV(15),0);var s=new $t.ComboBox(i,0,0,JV(110),e,true,200,false,r,true,true,v);s.setMaximumRowCount(7);c.addComp(s,0,1,1,1,"left","middle",0,0);var _=new $t.Label(i,0,0,r,"     ");c.addComp(_,1,0,1,1,"Left","middle",0,0,0,JV(10));c.addGroupBox(2,0,6,1,"Tab Type",r,0,0);var o=new $t.RadioButton(i,0,0,JV(15),r,"Left",true,null,null);c.addComp(o,3,0,1,1,"left","middle",JV(15),0);var u=new $t.RadioButton(i,0,0,JV(15),r,"Right",false,o,null);c.addComp(u,4,0,1,1,"left","middle",JV(15),0);var T=new $t.RadioButton(i,0,0,JV(15),r,"Center",false,u,null);c.addComp(T,5,0,1,1,"left","middle",JV(15),0);var A=new $t.RadioButton(i,0,0,JV(15),r,"Decimal",false,T,null);c.addComp(A,6,0,1,1,"left","middle",JV(15),0);var E=new $t.Label(i,0,0,r,"  ");c.addComp(E,7,0,1,1,"Left","middle");c.addGroupBox(2,1,6,1,"Tab Leader",r,0,0);var R=new $t.RadioButton(i,0,0,JV(15),r,"None",true,null,null);c.addComp(R,3,1,1,1,"left","middle",JV(15),0,JV(40));var L=new $t.RadioButton(i,0,0,JV(15),r,"Dots",false,R,null);c.addComp(L,4,1,1,1,"left","middle",JV(15),0,JV(40));var C=new $t.RadioButton(i,0,0,JV(15),r,"Hyphens",false,L,null);c.addComp(C,5,1,1,1,"left","middle",JV(15),0,JV(40));var I=new $t.RadioButton(i,0,0,JV(15),r,"Underline",false,C,null);c.addComp(I,6,1,1,1,"left","middle",JV(15),0,JV(40));c.show();var d,F,g;var P;var S=Nj(zh&tc.TFLAG_METRIC);if(S)Units.setText(MsgString[tc.MSG_TAB_POS]);if(Y_)d=W_[k_].TabId;else{F=ui[br].pfmt;d=Nc[F].TabId}Ls=d;var h=[];for(g=0;g<B_[d].count;g++){P=B_[d].pos[g]/1440;if(S)P=lj(P);h.push(AX(P,2))}if(h.length>0)s.setItems(h,null,0);if(oZ(br)){o.setText("Right");u.setText("Left")}p(d,0);s.setFocus();function O(t,e,r){if(t=="Cancel"){c.hide();return}else if(t=="OK"){var i=CX(s.getSelectedItem());if(S)i=fj(i);var f=Math.round(jV(i));if(f<=0){vJ(0);s.setFocus();return}Cs=tc.TAB_LEFT;if(u.isSelected())Cs=tc.TAB_RIGHT;else if(T.isSelected())Cs=tc.TAB_CENTER;else if(A.isSelected())Cs=tc.TAB_DECIMAL;Is=0;if(L.isSelected())Is=tc.TAB_DOT;else if(C.isSelected())Is=tc.TAB_HYPH;else if(I.isSelected())Is=tc.TAB_ULINE;Ls=f;l=Ls;t=Cs;a=Is;c.hide();return VZ(t,l,a,n)}else return}function v(t,e,r){if(t=="selected"){var i=s.getSelectedIndex();if(i<0)return;p(Ls,i)}}function p(t,e){var r;var i;if(e<0||e>=B_[t].count){o.setSelected(true);R.setSelected(true);return true}r=B_[t].type[e];i=B_[t].flags[e];o.setSelected(r==tc.TAB_LEFT);u.setSelected(r==tc.TAB_RIGHT);T.setSelected(r==tc.TAB_CENTER);A.setSelected(r==tc.TAB_DECIMAL);R.setSelected(i==0);L.setSelected(i==tc.TAB_DOT);C.setSelected(i==tc.TAB_HYPH);I.setSelected(i==tc.TAB_ULINE);return true}};function VZ(t,e,r,i){var f,l,a;var n,c,s,_,o=tc.RULER_TOLERANCE/2;var u=new tc.TejTab;if(e<0)e=0;if(t!=tc.TAB_LEFT&&t!=tc.TAB_RIGHT&&t!=tc.TAB_CENTER&&t!=tc.TAB_DECIMAL)t=tc.TAB_LEFT;jZ();l=zC;a=iI;if(!Y_)V8(l,0,a,0,"P".charCodeAt(0));for(f=l;f<=a;f++){if(!pm(f))continue;if(Y_)s=W_[k_].TabId;else s=Nc[ui[f].pfmt].TabId;u=B_[s].copy();if(u.count==tc.TE_MAX_TAB_STOPS){return QY(tc.MSG_OUT_OF_TAB_POS,"Set Tab")}for(n=0;n<u.count;n++){if(Math.abs(u.pos[n]-e)<=o)break;if(u.pos[n]>e)break}if(n==u.count){c=u.count;u.count++}else{c=n;if(Math.abs(u.pos[c]-e)>o){for(n=u.count-1;n>=c;n--){u.pos[n+1]=u.pos[n];u.type[n+1]=u.type[n];u.flags[n+1]=u.flags[n]}u.count++}}u.pos[c]=e;u.type[c]=t;u.flags[c]=r;_=YZ(s,u);if(Y_){W_[k_].TabId=_;fB(false);W_[k_].ParaMask|=tc.PMASK_TAB;return true}ui[f].pfmt=ZZ(ui[f].pfmt,Nc[ui[f].pfmt].LeftIndentTwips,Nc[ui[f].pfmt].RightIndentTwips,Nc[ui[f].pfmt].FirstIndentTwips,_,Nc[ui[f].pfmt].BltId,Nc[ui[f].pfmt].AuxId,Nc[ui[f].pfmt].Aux1Id,Nc[ui[f].pfmt].StyId,Nc[ui[f].pfmt].shading,Nc[ui[f].pfmt].pflags,Nc[ui[f].pfmt].SpaceBefore,Nc[ui[f].pfmt].SpaceAfter,Nc[ui[f].pfmt].SpaceBetween,Nc[ui[f].pfmt].LineSpacing,Nc[ui[f].pfmt].BkColor,Nc[ui[f].pfmt].BorderSpaceLeft,Nc[ui[f].pfmt].flow,Nc[ui[f].pfmt].flags)}oi.modified++;if(!Y_&&l<Fo)Fo=l;if(i){cG();if(ai)fB(false)}else T9(l,a+10-l);return true}_i.TerCreateTabId=function(t){if(!lv||!QD())_i.TerCreateControl();if(!oi.WordWrap)return-1;return YZ(0,t)};_i.TerGetTabStop=function(t,e){return _i.TerGetTabStop2(tc.PID_LINE,t,e)};_i.TerGetTabStop2=function(t,e,r){var i;if(!lv||!QD())_i.TerCreateControl();aI=cI=nI=0;if(!oi.WordWrap)return-1;if(t==tc.PID_LINE||e<0){if(e<0)e=br;if(e>=Ri)return-1;i=Nc[ui[e].pfmt].TabId}else if(t==tc.PID_PARA){if(e>Dc)return-1;i=Nc[e].TabId}else{if(e>H_)return-1;i=e}if(r<0)return B_[i].count;if(r>=B_[i].count)return-1;aI=B_[i].pos[r];cI=B_[i].type[r];nI=B_[i].flags[r];return B_[i].count};function jZ(){return JZ(-1)}function JZ(t){var e,r,i;var f;var l;zC=iI=0;if(t>=0)r=i=t;else{if(!ON())uA=tc.HILIGHT_OFF;if(uA!=tc.HILIGHT_OFF){r=sA;i=_A;if(AA==0&&i>r&&ui[i].cid==0)i--}else r=i=br}e=r-1;while(e>=0){l=ui[e].len;if(l>0){f=ui[e].txt;if(f[l-1]==Bn||f[l-1]==TR||f[l-1]==tc.ROW_CHAR||hj(f[l-1])||f[l-1]==tc.SECT_CHAR||f[l-1]==tc.PAGE_CHAR||f[l-1]==tc.COL_CHAR){r=e+1;break}}if(e==0)r=0;e--}e=i;while(e<Ri){l=ui[e].len;if(l>0){f=ui[e].txt;if(f[l-1]==Bn||f[l-1]==TR||f[l-1]==tc.ROW_CHAR||hj(f[l-1])||f[l-1]==tc.SECT_CHAR||f[l-1]==tc.PAGE_CHAR||f[l-1]==tc.COL_CHAR){i=e;break}}if(e+1==Ri)i=e;e++}zC=r;iI=i;return true}function zZ(t,e){var r,i;var f;var l;var a;var n;for(r=1;r<yc;r++){if(xc[r].flags!=e.flags)continue;if(xc[r].start!=e.start)continue;if(xc[r].level!=e.level)continue;if(xc[r].NumberType!=e.NumberType)continue;if(xc[r].BulletChar!=e.BulletChar)continue;if(xc[r].AftChar!=e.AftChar)continue;if(xc[r].BefText!=e.BefText)continue;if(xc[r].ls!=e.ls)continue;if(xc[r].lvl!=e.lvl)continue;return r}f=-1;if(yc>=Wc){a=[yc+1];n=[Dc];for(r=0;r<Dc;r++)n[r]=false;for(l=0;l<Ri;l++)n[ui[l].pfmt]=true;for(r=1;r<Dc;r++)if(!n[r])Nc[r].BltId=0;for(r=1;r<yc;r++)a[r]=false;for(i=0;i<Dc;i++)a[Nc[i].BltId]=true;for(r=1;r<yc;r++){if(!a[r]){if(f<0)f=r;break}}}if(f==-1&&yc>=Wc){var c=Wc+Wc/2;xc=fV(xc,c);Wc=c}if(yc<Wc||f>=0){if(yc<Wc){r=yc;yc++}else r=f;xc[r]=e.copy();return r}QY(tc.MSG_OUT_OF_BLT_TABLE,null);return t}_i.TerNewDivId=function(t,e,r,i,f){return _i.TerNewDivId2(t,e,r,i,f,0)};_i.TerNewDivId2=function(t,e,r,i,f,l){if(wc>=bc){var a=bc+bc/2;mc=fV(mc,a);bc=a}mc[wc]=new tc.ClsDiv;mc[wc].parent=t;mc[wc].level=mc[t].level+1;mc[wc].height=e;mc[wc].LeftMarg=r;mc[wc].RightMarg=i;mc[wc].BkColor=f;mc[wc].ParaFlags=l;wc++;return wc-1};_i.TerSetParaIdDiv=function(t,e){var r;if(!lv||!QD())_i.TerCreateControl();if(t<0||t>=Dc)return t;r=Nc[t].copy();r.DivId=e;r.flags|=mc[e].ParaFlags&tc.PARA_BOX;return QZ(t,r)};function ZZ(t,e,r,i,f,l,a,n,c,s,_,o,u,T,A,E,R,L,C){var I;var d=false;if(t>=0&&t<Dc)d=true;if(d)I=Nc[t].copy();else I=new tc.ClsPfmt;I.LeftIndentTwips=e;I.RightIndentTwips=r;I.FirstIndentTwips=i;I.TabId=f;I.BltId=l;I.AuxId=a;I.Aux1Id=n;I.StyId=c;I.shading=s;I.pflags=_;I.SpaceBefore=o;I.SpaceAfter=u;I.SpaceBetween=T;I.LineSpacing=A;I.BkColor=E;I.BorderSpaceLeft=R;I.flow=L;I.flags=C;I.LeftIndent=dV(I.LeftIndentTwips);I.RightIndent=dV(I.RightIndentTwips);I.FirstIndent=dV(I.FirstIndentTwips);I.BorderColor=d?Nc[t].BorderColor:tc.CLR_AUTO;I.OutlineLevel=d?Nc[t].OutlineLevel:-1;return QZ(t,I)}function QZ(t,e){var r,i,f;var l;var a;if(Z_){if(e.FmtRev==0)e.FmtOrigPara=t;e.FmtRev=q_;e.FmtTime=$_.copy()}if(Dj(e.flags&tc.BULLET))e.BltId=0;if(Dh){if(Nc[t].LeftIndentTwips==e.LeftIndentTwips&&Nc[t].RightIndentTwips==e.RightIndentTwips&&Nc[t].FirstIndentTwips==e.FirstIndentTwips&&Nc[t].TabId==e.TabId&&Nc[t].BltId==e.BltId&&Nc[t].DivId==e.DivId&&Nc[t].AuxId==e.AuxId&&Nc[t].Aux1Id==e.Aux1Id&&Nc[t].StyId==e.StyId&&Nc[t].shading==e.shading&&Nc[t].pflags==e.pflags&&Nc[t].SpaceBefore==e.SpaceBefore&&Nc[t].SpaceAfter==e.SpaceAfter&&Nc[t].SpaceBetween==e.SpaceBetween&&Nc[t].LineSpacing==e.LineSpacing&&Nc[t].TextVAlign==e.TextVAlign&&Nc[t].BkColor==e.BkColor&&Nc[t].BorderColor==e.BorderColor&&Nc[t].BorderSpaceLeft==e.BorderSpaceLeft&&Nc[t].BorderSpaceRight==e.BorderSpaceRight&&Nc[t].BorderSpaceTop==e.BorderSpaceTop&&Nc[t].BorderSpaceBot==e.BorderSpaceBot&&Nc[t].BorderWidth==e.BorderWidth&&Nc[t].flow==e.flow&&Nc[t].width==e.width&&Nc[t].height==e.height&&Nc[t].flags==e.flags&&Nc[t].FmtRev==e.FmtRev&&Ak(Nc[t].FmtTime,e.FmtTime)&&Nc[t].FmtOrigPara==e.FmtOrigPara&&Nc[t].OutlineLevel==e.OutlineLevel&&Nc[t].mask==e.mask){return t}for(r=0;r<Dc;r++){if(Nc[r].LeftIndentTwips==e.LeftIndentTwips&&Nc[r].RightIndentTwips==e.RightIndentTwips&&Nc[r].FirstIndentTwips==e.FirstIndentTwips&&Nc[r].TabId==e.TabId&&Nc[r].BltId==e.BltId&&Nc[r].DivId==e.DivId&&Nc[r].AuxId==e.AuxId&&Nc[r].Aux1Id==e.Aux1Id&&Nc[r].StyId==e.StyId&&Nc[r].shading==e.shading&&Nc[r].pflags==e.pflags&&Nc[r].SpaceBefore==e.SpaceBefore&&Nc[r].SpaceAfter==e.SpaceAfter&&Nc[r].SpaceBetween==e.SpaceBetween&&Nc[r].LineSpacing==e.LineSpacing&&Nc[r].TextVAlign==e.TextVAlign&&Nc[r].BkColor==e.BkColor&&Nc[r].BorderColor==e.BorderColor&&Nc[r].BorderSpaceLeft==e.BorderSpaceLeft&&Nc[r].BorderSpaceLeft==e.BorderSpaceLeft&&Nc[r].BorderSpaceRight==e.BorderSpaceRight&&Nc[r].BorderSpaceTop==e.BorderSpaceTop&&Nc[r].BorderSpaceBot==e.BorderSpaceBot&&Nc[r].BorderWidth==e.BorderWidth&&Nc[r].width==e.width&&Nc[r].height==e.height&&Nc[r].flags==e.flags&&Nc[r].FmtRev==e.FmtRev&&Ak(Nc[r].FmtTime,e.FmtTime)&&Nc[r].FmtOrigPara==e.FmtOrigPara&&Nc[r].OutlineLevel==e.OutlineLevel&&Nc[r].mask==e.mask){return r}}}else Dh=true;f=-1;if(Dc>=Mc&&Mc>=1e3&&Pr){var n=[Mc];for(r=0;r<Mc;r++)n[r]=false;for(l=0;l<Ri;l++)n[ui[l].pfmt]=true;for(r=0;r<oE;r++){if(sE[r].type=="P".charCodeAt(0)){var c=sE[r].pfmt;if(Nj(c)){var s=c[0];for(i=0;i<s;i++)n[c[i+1]]=true}}}for(r=0;r<Dc;r++){if(Nc[r].FmtRev>0){var _=Nc[r].FmtOrigPara;if(_>=0&&_<Dc)n[_]=true}}for(r=1;r<Mc;r++)if(!n[r])break;if(r<Mc)f=r}if(Dc>=Mc&&f==-1){a=Mc+Mc/2;Nc=fV(Nc,a+1);Mc=a}if(Dc<Mc||f>=0){if(Dc<Mc){r=Dc;Dc++}else r=f;Nc[r]=new tc.ClsPfmt;Nc[r].LeftIndentTwips=e.LeftIndentTwips;Nc[r].RightIndentTwips=e.RightIndentTwips;Nc[r].FirstIndentTwips=e.FirstIndentTwips;Nc[r].TabId=e.TabId;Nc[r].BltId=e.BltId;Nc[r].DivId=e.DivId;Nc[r].AuxId=e.AuxId;Nc[r].Aux1Id=e.Aux1Id;Nc[r].StyId=e.StyId;Nc[r].shading=e.shading;Nc[r].pflags=e.pflags;Nc[r].SpaceBefore=e.SpaceBefore;Nc[r].SpaceAfter=e.SpaceAfter;Nc[r].SpaceBetween=e.SpaceBetween;Nc[r].LineSpacing=e.LineSpacing;Nc[r].TextVAlign=e.TextVAlign;Nc[r].BkColor=e.BkColor;Nc[r].BorderColor=e.BorderColor;Nc[r].BorderSpaceLeft=e.BorderSpaceLeft;Nc[r].BorderSpaceRight=e.BorderSpaceRight;Nc[r].BorderSpaceTop=e.BorderSpaceTop;Nc[r].BorderSpaceBot=e.BorderSpaceBot;Nc[r].BorderWidth=e.BorderWidth;Nc[r].flow=e.flow;Nc[r].width=e.width;Nc[r].height=e.height;Nc[r].flags=e.flags;Nc[r].FmtRev=e.FmtRev;Nc[r].FmtTime=e.FmtTime==null?null:e.FmtTime.copy();Nc[r].FmtOrigPara=e.FmtOrigPara;Nc[r].OutlineLevel=e.OutlineLevel;Nc[r].mask=e.mask;Nc[r].LeftIndent=dV(Nc[r].LeftIndentTwips);Nc[r].RightIndent=dV(Nc[r].RightIndentTwips);Nc[r].FirstIndent=dV(Nc[r].FirstIndentTwips);return r}if(Dj(Vh&tc.MSG_MAX_PFMT))QY(tc.MSG_OUT_OF_PARA_SLOT,null);Vh|=tc.MSG_MAX_PFMT;return t}_i.TerGetBulletInfo=function(t,e){var r;return _i.TerGetBulletInfo2(t,e)};_i.TerGetBulletInfo2=function(t,e){var r;return _i.TerGetBulletInfo3(t,e)};_i.TerGetBulletInfo3=function(t,e){var r,i;var f=new tc.ClsListLevel;var l=false;var a;if(!lv||!QD())_i.TerCreateControl();cP=false;sI=oI=TI=RI=AI=0;CP="";if(t==tc.PID_LINE){if(e<-1||e>=Ri)return-1;if(e==-1)e=br;t=tc.PID_PARA;e=ui[e].pfmt}if(t==tc.PID_PARA){if(e<0||e>=Dc)return-1;t=tc.PID_BULLET;i=e;e=Nc[i].BltId;if(e==0&&Dj(Nc[i].flags&tc.BULLET))return 0;a=Nc[i].StyId}else if(t==tc.PID_STYLE){if(e<0||e>=X_)return-1;a=e;e=W_[e].BltId;if(e==0&&Dj(W_[e].ParaFlags&tc.BULLET))return 0}r=e;if(r<0||r>=yc)return-1;cP=xc[r].IsBullet;RI=xc[r].ls;if(xc[r].ls>0){f=sQ(xc[r].ls,xc[r].lvl);l=f!=null}if(l&&cP)cP=f.NumType==tc.LIST_BLT;if(l)oI=xc[r].lvl;else oI=xc[r].level;if(l)sI=f.start;else sI=xc[r].start;AI=xc[r].flags;if(xc[r].IsBullet){var n=xc[r].BulletChar;TI=tc.BLT_ROUND;if(xc[r].font==tc.BFONT_SYMBOL){if(n==183)TI=tc.BLT_ROUND;if(n==168)TI=tc.BLT_DIAMOND}else if(xc[r].font==tc.BFONT_WINGDINGS){if(n==167)TI=tc.BLT_SQUARE;if(n=="q".charCodeAt(0))TI=tc.BLT_HOLLOW_SQUARE;if(n=="v".charCodeAt(0))TI=tc.BLT_4_DIAMONDS;if(n==216)TI=tc.BLT_ARROW;if(n==252)TI=tc.BLT_CHECK}}else{if(l){var c=f.NumType;if(c==tc.LIST_DEC)TI=tc.NBR_DEC;else if(c==tc.LIST_UPR_ALPHA)TI=tc.NBR_UPR_ALPHA;else if(c==tc.LIST_LWR_ALPHA)TI=tc.NBR_LWR_ALPHA;else if(c==tc.LIST_UPR_ROMAN)TI=tc.NBR_UPR_ROMAN;else if(c==tc.LIST_LWR_ROMAN)TI=tc.NBR_LWR_ROMAN;else TI=tc.NBR_DEFAULT;cP=c==tc.LIST_BLT;CP=oQ(f.txt)}else{TI=xc[r].NumberType;if(xc[r].NumberType==tc.NBR_DEFAULT){var s,_="HEADING";var o=false;s=W_[a].name.toUpperCase();o=s.indexOf(_)>=0;if(!o)TI=tc.NBR_UPR_ALPHA}}}return r};_i.TerSetBullet=function(t,e){return _i.TerSetBulletEx(t,true,1,0,0,e)};_i.TerSetBulletEx=function(t,e,r,i,f,l){return _i.TerSetBullet2(t,e,r,i,f,null,null,l)};_i.TerSetBullet2=function(t,e,r,i,f,l,a,n){return _i.TerSetBullet3(t,e,r,i,f,l,a,0,n)};_i.TerSetBullet3=function(t,e,r,i,f,l,a,n,c){var s,_,o;var u;var T,A,E;if(!lv||!QD())_i.TerCreateControl();if(!oi.WordWrap)return false;if(l==null)l="";if(a==null)a="";if(i<0)i=0;if(i>10)i=10;jZ();_=zC;o=iI;if(!Y_)V8(_,0,o,0,"P".charCodeAt(0));for(s=_;s<=o;s++){if(!pm(s))continue;if(Y_){u=W_[k_].ParaFlags;T=W_[k_].LeftIndentTwips;A=W_[k_].FirstIndentTwips;E=W_[k_].BltId}else{u=Nc[ui[s].pfmt].flags;T=Nc[ui[s].pfmt].LeftIndentTwips;A=Nc[ui[s].pfmt].FirstIndentTwips;E=Nc[ui[s].pfmt].BltId}if(t){u|=tc.BULLET;E=_i.TerCreateBulletId3(e,r,i,f,l,a,n)}else{u=cj(u,tc.BULLET);E=0}if(t&&Dj(Nc[ui[s].pfmt].flags&tc.BULLET)){T+=360;A-=360}else if(!t&&Nj(Nc[ui[s].pfmt].flags&tc.BULLET)){T-=360;A+=360}if(T<0)T=0;if(T+A<0)A=-T;if(Y_){W_[k_].ParaFlags=u;W_[k_].LeftIndentTwips=T;W_[k_].FirstIndentTwips=A;W_[k_].BltId=E;fB(false);W_[k_].ParaMask|=tc.PMASK_INDENT|tc.PMASK_BULLET;return true}ui[s].pfmt=ZZ(ui[s].pfmt,T,Nc[ui[s].pfmt].RightIndentTwips,A,Nc[ui[s].pfmt].TabId,E,Nc[ui[s].pfmt].AuxId,Nc[ui[s].pfmt].Aux1Id,Nc[ui[s].pfmt].StyId,Nc[ui[s].pfmt].shading,Nc[ui[s].pfmt].pflags,Nc[ui[s].pfmt].SpaceBefore,Nc[ui[s].pfmt].SpaceAfter,Nc[ui[s].pfmt].SpaceBetween,Nc[ui[s].pfmt].LineSpacing,Nc[ui[s].pfmt].BkColor,Nc[ui[s].pfmt].BorderSpaceLeft,Nc[ui[s].pfmt].flow,u)}oi.modified++;if(c){cG();if(ai)fB(false)}else T9(_,o+10-_);return true};_i.TerCreateBulletId=function(t,e,r,i){return _i.TerCreateBulletId2(t,e,r,i,null,null)};_i.TerCreateBulletId2=function(t,e,r,i,f,l){return _i.TerCreateBulletId3(t,e,r,i,f,l,0)};_i.TerCreateBulletId3=function(t,e,r,i,f,l,a){var n;if(!lv||!QD())_i.TerCreateControl();if(!oi.WordWrap)return 0;if(f==null)f="";if(l==null)l="";n=xc[0].copy();if(t){n.IsBullet=true;n.level=11;if(i==tc.BLT_DIAMOND){n.BulletChar=168;n.font=tc.BFONT_SYMBOL}else if(i==tc.BLT_SQUARE){n.BulletChar=167;n.font=tc.BFONT_WINGDINGS}else if(i==tc.BLT_HOLLOW_SQUARE){n.BulletChar="q".charCodeAt(0);n.font=tc.BFONT_WINGDINGS}else if(i==tc.BLT_4_DIAMONDS){n.BulletChar="v".charCodeAt(0);n.font=tc.BFONT_WINGDINGS}else if(i==tc.BLT_ARROW){n.BulletChar=216;n.font=tc.BFONT_WINGDINGS}else if(i==tc.BLT_CHECK){n.BulletChar=252;n.font=tc.BFONT_WINGDINGS}else{n.BulletChar=183;n.font=tc.BFONT_SYMBOL}}else{n.IsBullet=false;n.start=e;n.level=r;n.NumberType=i;n.BefText=f;if(l.length>0)n.AftChar=Uk(l)[0];else n.AftChar=0}n.flags=a;return zZ(0,n)};_i.TerCreateListBulletId=function(t,e){return _i.TerCreateListBulletId2(t,e,-1)};_i.TerCreateListBulletId2=function(t,e,r){var i;var f;if(!lv||!QD())_i.TerCreateControl();if(!oi.WordWrap)return 0;if(t<0||t>=zc)return 0;f=Jc[t].LevelCount;if(f==0){var l=Jc[t].ListIdx;f=Kc[l].LevelCount}if(e<0||e>=f)return 0;i=xc[0].copy();i.IsBullet=false;i.ls=t;i.lvl=e;if(r!=-1){if(r==tc.BLT_DIAMOND){i.BulletChar=168;i.font=tc.BFONT_SYMBOL}else if(r==tc.BLT_SQUARE){i.BulletChar=167;i.font=tc.BFONT_WINGDINGS}else if(r==tc.BLT_HOLLOW_SQUARE){i.BulletChar="q".charCodeAt(0);i.font=tc.BFONT_WINGDINGS}else if(r==tc.BLT_4_DIAMONDS){i.BulletChar="v".charCodeAt(0);i.font=tc.BFONT_WINGDINGS}else if(r==tc.BLT_ARROW){i.BulletChar=216;i.font=tc.BFONT_WINGDINGS}else if(r==tc.BLT_CHECK){i.BulletChar=252;i.font=tc.BFONT_WINGDINGS}else{i.BulletChar=183;i.font=tc.BFONT_SYMBOL}}return zZ(0,i)};_i.TerSetBulletId=function(t,e){if(!lv||!QD())_i.TerCreateControl();if(e<0||e>=Dc)return false;if(t<0||t>=yc)return false;Nc[e].BltId=t;return true};_i.TerSetListBullet=function(t,e,r,i,f,l,a){return _i.TerSetListBullet2(t,e,r,i,f,l,"",a)};_i.TerSetListBullet2=function(t,e,r,i,f,l,a,n){var c,s,_,o,u,T=0;var A;var E,R,L,C=0;var I=0;var d;var F;var g="";if(!lv||!QD())_i.TerCreateControl();if(!oi.WordWrap)return false;if(f==null)f="";if(l==null)l="";if(a==null)a="";if(r>10)r=10;jZ();o=zC;u=iI;if(!Y_)V8(o,0,u,0,"P".charCodeAt(0));for(c=o;c<=u;c++){if(!pm(c))continue;if(Y_){A=W_[k_].ParaFlags;E=W_[k_].LeftIndentTwips;R=W_[k_].FirstIndentTwips;L=W_[k_].BltId}else{A=Nc[ui[c].pfmt].flags;E=Nc[ui[c].pfmt].LeftIndentTwips;R=Nc[ui[c].pfmt].FirstIndentTwips;L=Nc[ui[c].pfmt].BltId;C=Nc[ui[c].pfmt].AuxId}T=E;if(r<0&&Nj(A&tc.BULLET))r=xc[L].lvl;if(r<0)r=0;if(t){A|=tc.BULLET;if(I==0){var P=0,S=0,h;var O=false;var v=false,p=false,N,D=false;var M=[];if(xc[L].ls>0){P=xc[L].ls;S=Jc[P].ListIdx}p=xc[L].ls==0||!Jc[P].InUse||Kc[S].LevelCount!=9;if(p){var G=PQ("List");S=_i.TerEditList(true,0,false,G,true,0);P=_i.TerEditListOr(true,0,false,S,false,0);v=true}M=null;if(Jc[P].LevelCount>r)M=Jc[P].level;else if(Kc[S].LevelCount>r)M=Kc[S].level;if(M!=null&&M[r].NumType!=e)M=null;if(M==null){for(_=0;_<zc;_++){if(Jc[_].ListIdx!=S)continue;if(Jc[_].LevelCount<=r)continue;if(Jc[_].level[r].NumType==e){P=_;v=true;M=Jc[P].level;break}}}if(M==null){P=_i.TerEditListOr(true,0,false,S,true,0);v=true;if(e==tc.LIST_BLT&&Jc[P].level!=null){M=Jc[P].level;for(_=0;_<Jc[P].LevelCount;_++){M[r].NumType=e;M[r].flags|=tc.LISTLEVEL_RESTART|tc.LISTLEVEL_REFORMAT;M[r].CharMask|=tc.CMASK_FONT;D=true}}if(Jc[P].LevelCount>r)M=Jc[P].level;else M=null}if(M==null)continue;var B="";var H="";var m=0;var w=false,b=false;h=0;for(s=o;s<Ri;s++){if(Nj(ui[s].flags&tc.LFLAG_PARA)&&ui[s].len>0){h=ib(s,ui[s].len-1);break}}if(Oc<0)Oc=$w();if(Oc>=0&&!MJ(xs[Oc].TextColor,xs[h].TextColor))h=fx(h,pJ(xs[Oc].TextColor),0,"",br,jt);if(xs[h].FieldId==tc.FIELD_HLINK){if(wh==(xs[h].style&wh))h=Db(h,wh,false);if(MJ(bh,xs[h].TextColor))h=fx(h,pJ(xs[0].TextColor),0,"",br,jt)}if(a==""){if(e==tc.LIST_BLT){g="";if(D){F=[1];if(kc>=2&&Dj(lO&tc.TFLAG11_NO_ALTERNATING_BULLETS)){F[0]=Uc[1].unicode;B=Wk(F);g=Uc[1].typeface;if(Tk(g,"symbol")==0&&n_.length>0)g=n_;else if(Tk(g,"Wingdings")==0&&c_.length>0)g=c_;h=Rb(Ti,h,g,Uc[1].TwipsSize>0?Uc[1].TwipsSize:xs[h].TwipsSize,0,xs[h].TextColor,xs[h].TextBkColor,xs[h].UlineColor,0,0,0,1,0,0,0,0,null,0,Uc[1].CharSet,0,xs[h].TextAngle);w=Uc[1].TwipsSize>0&&!Uc[1].AutoSize;if(kc>=3){F[0]=Uc[2].unicode;H=Wk(F);g=Uc[2].typeface;if(Tk(g,"symbol")==0&&n_.length>0)g=n_;else if(Tk(g,"Wingdings")==0&&c_.length>0)g=c_;m=Rb(Ti,h,g,Uc[2].TwipsSize>0?Uc[2].TwipsSize:xs[h].TwipsSize,0,xs[h].TextColor,xs[h].TextBkColor,xs[h].UlineColor,0,0,0,1,0,0,0,0,null,0,Uc[2].CharSet,0,xs[h].TextAngle);b=Uc[2].TwipsSize>0&&!Uc[2].AutoSize}}else{F=[1];F[0]=-3913;B=Wk(F);g="Symbol";if(n_.length>0)g=n_;h=Rb(Ti,h,g,xs[h].TwipsSize,0,xs[h].TextColor,xs[h].TextBkColor,xs[h].UlineColor,0,0,0,1,0,0,0,0,null,0,tc.SYMBOL_CHARSET,0,xs[h].TextAngle)}}else{B="";h=M[r].FontId;O=true}}else B=f+"~"+(r+1).toString()+"~"+l}else{B=a;if(e==tc.LIST_BLT&&a.length==1){var x=Uk(a);var y=x[0];g="";var W=tc.ANSI_CHARSET;if(y==61623){g="Symbol";W=tc.SYMBOL_CHARSET}else if(y==61607||y==61656||y==61692||y==61558||y>=61440&&y<=61695){g="Wingdings";W=tc.SYMBOL_CHARSET}if(g!="")h=Rb(Ti,h,g,xs[h].TwipsSize,0,xs[h].TextColor,xs[h].TextBkColor,xs[h].UlineColor,0,0,0,1,0,0,0,0,null,0,W,0,xs[h].TextAngle)}}N=Jc[P].LevelCount>r;d=N?Jc[P].level[r].flags:Kc[S].level[r].flags;if(v&&e==tc.LIST_BLT){var U=N?Jc[P].LevelCount:Kc[S].LevelCount;for(_=0;_<U;_++){if(_%2!=0&&H.length>0){_i.EditListLevel(!N,N?P:S,_,i,e,tc.LISTAFT_TAB,H,O?-1:m,d,b)}else _i.EditListLevel(!N,N?P:S,_,i,e,tc.LISTAFT_TAB,B,O?-1:h,d,w)}}else _i.EditListLevel(!N,N?P:S,r,i,e,tc.LISTAFT_TAB,B,h,d,false);if(v||xc[L].lvl!=r)L=_i.TerCreateListBulletId(P,r);I=L}else L=I}else{A=cj(A,tc.BULLET);L=0;C=C>>6<<6}if(t){var k=m_>0?m_:720;var X=k/2;if(X==0)X=270;while(X<270)X*=2;E+=X;R=-X;if(a!=null){var K=a.length/6*X;if(K>1440)K=1440;E+=K;R-=K}if(Qc!=-1&&T==0)E+=Qc}else{E+=R;if(E<0)E=0;R=0}if(Y_){W_[k_].ParaFlags=A;W_[k_].LeftIndentTwips=E;W_[k_].FirstIndentTwips=R;W_[k_].BltId=L;fB(false);W_[k_].ParaMask|=tc.PMASK_BULLET|tc.PMASK_LS|tc.PMASK_INDENT;return true}ui[c].pfmt=ZZ(ui[c].pfmt,E,Nc[ui[c].pfmt].RightIndentTwips,R,Nc[ui[c].pfmt].TabId,L,C,Nc[ui[c].pfmt].Aux1Id,Nc[ui[c].pfmt].StyId,Nc[ui[c].pfmt].shading,Nc[ui[c].pfmt].pflags,Nc[ui[c].pfmt].SpaceBefore,Nc[ui[c].pfmt].SpaceAfter,Nc[ui[c].pfmt].SpaceBetween,Nc[ui[c].pfmt].LineSpacing,Nc[ui[c].pfmt].BkColor,Nc[ui[c].pfmt].BorderSpaceLeft,Nc[ui[c].pfmt].flow,A)}oi.modified++;if(n){_i.TerRepaginate(true);if(ai)fB(false)}return true};_i.TerSetCustBullet=function(t,e,r){var i,f,l,a,n,c=0;var s;var _,o,u,T=0;var A=0,E=0;var R,L;var C=-1,I=-1,d=-1,F=-1,g,P,S;var h=0,O=0,v=0,p=0;var N=uE;var D=true,M=false;var G=[];if(!lv||!QD())_i.TerCreateControl();if(!oi.WordWrap)return false;L=ui[br].pfmt;u=u=Nc[L].BltId;if(u>=0&&xc[u].ls>0)return false;uA=tc.HILIGHT_OFF;jZ();a=zC;n=iI;if(!Y_)V8(a,0,n,0,tc.CHAR_P);if(a>0){v=ui[a-1].pfmt;h=Nc[v].BltId;C=xc[h].ls;d=xc[h].lvl}if(n+1<Ri){p=ui[n+1].pfmt;O=Nc[p].BltId;I=xc[O].ls;F=xc[O].lvl}for(i=a;i<=n;i++){if(!pm(i))continue;u=-1;if(Y_){s=W_[k_].ParaFlags;_=W_[k_].LeftIndentTwips;o=W_[k_].FirstIndentTwips}else if(D){s=Nc[ui[i].pfmt].flags;_=Nc[ui[i].pfmt].LeftIndentTwips;o=Nc[ui[i].pfmt].FirstIndentTwips;T=Nc[ui[i].pfmt].AuxId;if(F>=d&&O>0){u=O;_=Nc[p].LeftIndentTwips;o=Nc[p].FirstIndentTwips}else if(d>F&&h>0){u=h;_=Nc[v].LeftIndentTwips;o=Nc[v].FirstIndentTwips}D=false}if(u>=0){P=xc[u].ls;g=Jc[P].ListIdx;E=xc[u].lvl;G=null;if(Kc[g].LevelCount>E)G=Kc[g].level;if(Jc[P].LevelCount>E)G=Jc[P].level;if(G==null||G[E].NumType!=tc.LIST_BLT)u=-1}if(u==-1){var B=PQ("List");g=_i.TerEditList(true,0,false,B,true,0);P=_i.TerEditListOr(true,0,false,g,false,0);G=Kc[g].level;for(E=0;E<Kc[g].LevelCount;E++){G[E].NumType=tc.LIST_BLT;G[E].flags|=tc.LISTLEVEL_RESTART|tc.LISTLEVEL_REFORMAT;G[E].CharMask|=tc.CMASK_FONT;G[E].CharMask=cj(G[E].CharMask,tc.CMASK_SIZE);if(!r)G[E].CharMask|=tc.CMASK_SIZE;G[E].txt[0]=1;G[E].txt[1]=t;G[E].FontId=e}M=true;S=(_+tc.RULER_TOLERANCE)/360-1;if(S<0)S=0;if(S>8)S=8;u=_i.TerCreateListBulletId(P,S);_=360*(S+1);o=-360}s|=tc.BULLET;if(Y_){W_[k_].ParaFlags=s;W_[k_].LeftIndentTwips=_;W_[k_].FirstIndentTwips=o;W_[k_].BltId=u;fB(false);W_[k_].ParaMask|=tc.PMASK_BULLET|tc.PMASK_LS|tc.PMASK_INDENT;return true}ui[i].pfmt=ZZ(ui[i].pfmt,_,Nc[ui[i].pfmt].RightIndentTwips,o,Nc[ui[i].pfmt].TabId,u,T,Nc[ui[i].pfmt].Aux1Id,Nc[ui[i].pfmt].StyId,Nc[ui[i].pfmt].shading,Nc[ui[i].pfmt].pflags,Nc[ui[i].pfmt].SpaceBefore,Nc[ui[i].pfmt].SpaceAfter,Nc[ui[i].pfmt].SpaceBetween,Nc[ui[i].pfmt].LineSpacing,Nc[ui[i].pfmt].BkColor,Nc[ui[i].pfmt].BorderSpaceLeft,Nc[ui[i].pfmt].flow,s);var H=Nc[ui[i].pfmt].BltId}if(!M){P=xc[u].ls;g=Jc[P].ListIdx;E=xc[u].lvl;G=null;if(Kc[g].LevelCount>E)G=Kc[g].level;if(Jc[P].LevelCount>E)G=Jc[P].level;if(G!=null){uE=N;V8(a,0,a,0,tc.UNDO_LIST_LEVEL);G[E].text[0]=1;G[E].text[1]=t;G[E].FontId=e;G[E].CharMask|=tc.CMASK_FONT;G[E].CharMask=cj(G[E].CharMask,tc.CMASK_SIZE);if(!r)G[E].CharMask|=tc.CMASK_SIZE}}oi.modified++;_i.TerRepaginate(true);if(ai)fB(false);return true};_i.TerSetListLevel=function(t,e,r){var i,f,l,a,n=0;var c;var s,_,o,u=0,T=0;var A=0;var E=null;var R=false;var L=0;if(!lv||!QD())_i.TerCreateControl();if(!oi.WordWrap)return false;jZ();l=zC;a=iI;if(!Y_)V8(l,0,a,0,"P".charCodeAt(0));for(i=l;i<=a;i++){if(!pm(i))continue;if(Y_){c=W_[k_].ParaFlags;s=W_[k_].LeftIndentTwips;_=W_[k_].FirstIndentTwips;o=W_[k_].BltId}else{c=Nc[ui[i].pfmt].flags;s=Nc[ui[i].pfmt].LeftIndentTwips;_=Nc[ui[i].pfmt].FirstIndentTwips;o=Nc[ui[i].pfmt].BltId}if(Dj(c&tc.BULLET))continue;if(xc[o].ls==0)continue;if(A==0){var C=new tc.ClsListLevel;var I=new tc.ClsListLevel;var d=0,F=0;var g=false,P=false;C=sQ(xc[o].ls,xc[o].lvl);if(t==-1){var S=false;if(e<0&&xc[o].lvl==0&&!Y_){for(m=i-1;m>=0;m--){var h=ui[m].pfmt;L=Nc[h].BltId;if(L==0||xc[L].ls==0)break;if(L!=o){var O=Nc[h].LeftIndentTwips+Nc[h].FirstIndentTwips;if(O<s+_){o=L;t=xc[L].lvl;s=Nc[h].LeftIndentTwips;_=Nc[h].FirstIndentTwips;S=P=true;break}}}}if(!S)t=xc[o].lvl+e}if(t<0)t=0;if(t>8)t=8;C=sQ(xc[o].ls,t);if(i>0){gQ(i-1,t,C,n);C=_P}if(i+1<Ri){gQ(i+1,t,C,n);C=_P}d=xc[o].ls;F=Jc[d].ListIdx;if(Jc[d].LevelCount>t){I=Jc[d].level[t].copy();g=true}else if(Kc[F].LevelCount>t){I=Kc[F].level[t].copy();g=true}if(!g&&!P){if(i>0&&gQ(i-1,t,I,d)){I=_P;g=true}if(i+1<Ri&&gQ(i+1,t,I,d)){I=_P;g=true}if(g&&I.NumType!=C.NumType)g=false}if(!g){for(f=0;f<zc;f++){if(Jc[f].ListIdx!=F)continue;if(Jc[f].LevelCount<=t)continue;if(Jc[f].level[t].NumType==C.NumType){d=f;I=Jc[d].level[t].copy();g=true;break}}}if(!g){d=_i.TerEditListOr(true,0,false,F,true,0);if(Jc[d].LevelCount>t){I=Jc[d].level[t].copy();if(C.NumType==tc.LIST_BLT){I=C.copy();I.flags|=tc.LISTLEVEL_RESTART|tc.LISTLEVEL_REFORMAT}g=true}}if(!g)continue;E=oQ(I.txt);o=_i.TerCreateListBulletId(d,t);R=false;if(P)R=true;if(!R){for(m=i-1;m>=0;m--){L=Nc[ui[m].pfmt].BltId;if(xc[L].ls==0)break;if(xc[L].lvl==t&&xc[L].ls==d){s=Nc[ui[m].pfmt].LeftIndentTwips;_=Nc[ui[m].pfmt].FirstIndentTwips;R=true;break}}}if(!R){var v=m_>0?m_:720;var p=v/2;if(p==0)p=270;while(p<270)p*=2;s+=p*e;if(E.length>6){var N=E.length/6*1440/8;s+=N;_-=N}if(s<0)s=0}A=o;u=s;T=_}else{o=A;_=T;s=u}if(Y_){W_[k_].ParaFlags=c;W_[k_].LeftIndentTwips=s;W_[k_].FirstIndentTwips=_;W_[k_].BltId=o;fB(false);W_[k_].ParaMask|=tc.PMASK_BULLET|tc.PMASK_LS|tc.PMASK_INDENT;return true}ui[i].pfmt=ZZ(ui[i].pfmt,s,Nc[ui[i].pfmt].RightIndentTwips,_,Nc[ui[i].pfmt].TabId,o,Nc[ui[i].pfmt].AuxId,Nc[ui[i].pfmt].Aux1Id,Nc[ui[i].pfmt].StyId,Nc[ui[i].pfmt].shading,Nc[ui[i].pfmt].pflags,Nc[ui[i].pfmt].SpaceBefore,Nc[ui[i].pfmt].SpaceAfter,Nc[ui[i].pfmt].SpaceBetween,Nc[ui[i].pfmt].LineSpacing,Nc[ui[i].pfmt].BkColor,Nc[ui[i].pfmt].BorderSpaceLeft,Nc[ui[i].pfmt].flow,c)}oi.modified++;if(r){_z(true);cG();if(ai)fB(false)}return true};_i.TerSetParaList=function(t,e,r,i,f){var l,a=0,n=0;var c=e>=0;var s,_;var o=(new tc.ClsBlt).init();var u;if(!lv||!QD())_i.TerCreateControl();if(!oi.WordWrap)return false;if(c){if(e>=Dc)return false;_=Nc[e].BltId}else{jZ();a=zC;n=iI;if(Y_)_=W_[k_].BltId;else{e=ui[a].pfmt;_=Nc[e].BltId}}if(!t)return qZ(e,r,i,f);var T=_i.DlgCompHeight;var A=_i.DlgFont;var E=new $t.DialogBox(te,"Apply List",A,true,F,JV(2));var R=E.cvs;var L=new $t.Label(R,0,0,A,"List");E.addComp(L,0,0,1,1,"Left","middle");var C=new $t.ListBox(R,0,0,JV(300),JV(200),A,true,true,g);E.addComp(C,1,0,1,1,"Left","top",0,0,JV(15));var I=new $t.Label(R,0,0,A,"Level");E.addComp(I,0,1,1,1,"left","middle",0,0);var d=new $t.ComboBox(R,0,0,JV(60),T,true,150,true,A,true,true,null);d.setMaximumRowCount(7);E.addComp(d,1,1,1,1,"left","top",0,0,JV(15));Ls=Cs=0;if(_>0){Ls=xc[_].ls;Cs=xc[_].lvl}BQ(C,true,true,Ls,false);mQ(C,d,Cs);E.show();C.setFocus();function F(t,e,r){if(t=="Cancel"){E.hide();return}else if(t=="OK"){return P()}}function g(t,e,r){if(t=="dblclick"||t=="enter")return P();else if(t=="change"){mQ(C,d,Cs)}}function P(){r=C.getSelectedValue();i=d.getSelectedValue();E.hide();return qZ(e,r,i,f)}};function qZ(t,e,r,i){var f,l=0,a=0;var n=t>=0;var c,s;var _=(new tc.ClsBlt).init();var o;if(n){if(t>=Dc)return false;s=Nc[t].BltId}else{jZ();l=zC;a=iI;if(Y_)s=W_[k_].BltId;else{t=ui[l].pfmt;s=Nc[t].BltId}}if(e<0||e>=zc)return false;if(e>0){c=Jc[e].LevelCount;if(c==0){var u=Jc[e].ListIdx;c=Kc[u].LevelCount}if(r<0||r>=c)return false}oi.modified++;t:{if(e==0)s=0;else{_=xc[0].copy();_.IsBullet=false;_.ls=e;_.lvl=r;s=zZ(0,_)}if(n){Nc[t].BltId=s;Nc[t].flags=cj(Nc[t].flags,tc.BULLET);if(Nj(e))Nc[t].flags|=tc.BULLET;if(i)break t;else return true}if(!Y_)V8(l,0,a,0,"P".charCodeAt(0));for(f=l;f<=a;f++){if(!pm(f))continue;if(Y_)o=W_[k_].ParaFlags;else o=Nc[ui[f].pfmt].flags;if(e>0)o|=tc.BULLET;else o=cj(o,tc.BULLET);if(Y_){W_[k_].ParaFlags=o;W_[k_].BltId=s;fB(false);W_[k_].ParaMask|=tc.PMASK_BULLET|tc.PMASK_LS;return true}ui[f].pfmt=ZZ(ui[f].pfmt,Nc[ui[f].pfmt].LeftIndentTwips,Nc[ui[f].pfmt].RightIndentTwips,Nc[ui[f].pfmt].FirstIndentTwips,Nc[ui[f].pfmt].TabId,s,Nc[ui[f].pfmt].AuxId,Nc[ui[f].pfmt].Aux1Id,Nc[ui[f].pfmt].StyId,Nc[ui[f].pfmt].shading,Nc[ui[f].pfmt].pflags,Nc[ui[f].pfmt].SpaceBefore,Nc[ui[f].pfmt].SpaceAfter,Nc[ui[f].pfmt].SpaceBetween,Nc[ui[f].pfmt].LineSpacing,Nc[ui[f].pfmt].BkColor,Nc[ui[f].pfmt].BorderSpaceLeft,Nc[ui[f].pfmt].flow,o)}}if(i){_z(true);cG()}return true}_i.TerEditListLevel=function(t,e,r,i,f,l,a,n,c){if(!lv||!QD())_i.TerCreateControl();return _i.EditListLevel(t,e,r,i,f,l,a,n,c,true)};_i.EditListLevel=function(t,e,r,i,f,l,a,n,c,s){var _=(new tc.ClsListLevel).init();if(e<0){return $Z()}else{if(e<=0||r<0)return false;if(t){if(e>=Vc||!Kc[e].InUse)return false;if(r>=Kc[e].LevelCount)return false;_=Kc[e].level[r].copy()}else{if(e>=zc||!Jc[e].InUse)return false;if(r>=Jc[e].LevelCount)return false;_=Jc[e].level[r].copy()}if(n<0)n=_.FontId;if(n<0||Dj(xs[n].InUse)||Nj(xs[n].style&tc.PICT))return false;var o=Uk(a);if(f==tc.LIST_BLT&&a.length>0){var u="";var T=o[0];var A=0;var E=tc.SYMBOL_CHARSET;if(T==tc.BLT_DIAMOND){A=168;u="Symbol";if(n_.length>0)u=n_}else if(T==tc.BLT_SQUARE){A=167;u="Wingdings";if(c_.length>0)u=c_}else if(T==tc.BLT_HOLLOW_SQUARE){A="q".charCodeAt(0);u="Wingdings";if(c_.length>0)u=c_}else if(T==tc.BLT_4_DIAMONDS){A="v".charCodeAt(0);u="Wingdings";if(c_.length>0)u=c_}else if(T==tc.BLT_ARROW){A=216;u="Wingdings";if(c_.length>0)u=c_}else if(T==tc.BLT_CHECK){A=252;u="Wingdings";if(c_.length>0)u=c_}else if(T==tc.BLT_ROUND||T==0){A=183;u="Symbol";if(n_.length>0)u=n_}else if(T=="o".charCodeAt(0)){A=T;u="Arial";E=tc.ANSI_CHARSET}else A=T;a=String.fromCharCode(A);if(u.length>0)n=Rb(Ti,n,u,xs[n].TwipsSize,0,xs[n].TextColor,tc.CLR_WHITE,xs[n].UlineColor,0,0,0,1,0,0,0,0,null,0,E,0,xs[n].TextAngle)}_.start=i;_.NumType=f;_.CharAft=l;_.FontId=n;if(n>0){if(s){_.CharMask|=tc.CMASK_FONT|tc.CMASK_SIZE;if(xs[n].TextColor!=tc.CLR_AUTO)_.CharMask|=tc.CMASK_TEXT_COLOR;if(xs[n].style!=0)_.StyleMask=xs[n].style}else if(f==tc.LIST_BLT)_.CharMask|=tc.CMASK_FONT}_.flags=c;if(a!=null&&a.length>0)uQ(a,_.txt);if(f==tc.LIST_NO_NUM)_.txt[0]=0;if(t)Kc[e].level[r]=_;else Jc[e].level[r]=_}oi.modified++;_z(true);return true};function $Z(){var t=_i.DlgCompHeight;var e=_i.DlgFont;var l=new $t.DialogBox(te,"List Level Properties",e,true,v,JV(2));var r=l.cvs;l.addGroupBox(0,0,5,6,"",e,0,0);var a=new $t.RadioButton(r,0,0,JV(15),e,"List Item",true,null,null);l.addComp(a,1,0,1,1,"left","middle",JV(15),0);var n=new $t.ComboBox(r,0,0,JV(300),t,true,JV(200),true,e,true,true,p);HQ(n,true,false,-1);n.setMaximumRowCount(10);l.addComp(n,1,1,1,1,"left","middle",JV(-30),0);var i=new $t.RadioButton(r,0,0,JV(15),e,"List Override",true,a,null);l.addComp(i,3,0,1,1,"left","middle",JV(15),0);var c=new $t.ComboBox(r,0,0,JV(300),t,true,JV(200),true,e,true,true,N);var f=BQ(c,true,false,-1,true);c.setMaximumRowCount(10);l.addComp(c,3,1,1,1,"left","middle",JV(-30),0);a.setSelected(f<=0||Jc[f].LevelCount==0);i.setSelected(!a.isSelected());var s=new $t.Label(r,0,0,e,"List Level");l.addComp(s,3,2,1,1,"left","bottom",JV(15),0);var _=new $t.ComboBox(r,0,0,JV(60),t,true,JV(200),true,e,true,true,D);wQ(a.isSelected(),n,c,_);_.setMaximumRowCount(10);l.addComp(_,3,3,1,1,"left","middle",JV(15),0);l.addGroupBox(5,0,6,2,"",e,0,0);var o=new $t.CheckBox(r,0,0,JV(15),JV(16),e,"Restart numbering when override changes for a list",false,null);l.addComp(o,6,0,1,2,"Left","middle",JV(15),0);var u=new $t.CheckBox(r,0,0,JV(15),JV(16),e,"Change previous level number to an Arabic format",false,null);l.addComp(u,7,0,1,2,"Left","middle",JV(15),0);var T=new $t.CheckBox(r,0,0,JV(15),JV(16),e,"Override font attribute of the list Level",false,null);l.addComp(T,8,0,1,2,"Left","middle",JV(15),0);var A=new $t.CheckBox(r,0,0,JV(15),JV(16),e,"Do not reset numbering when the parent level changes",false,null);l.addComp(A,9,0,1,2,"Left","middle",JV(15),0);l.addGroupBox(11,0,7,2,"",e,0,0,0,JV(15));var E=new $t.Label(r,0,0,e,"Number Text");l.addComp(E,12,0,1,1,"left","bottom",JV(15),0);var R=new $t.TextBox(r,0,0,JV(300),t,"",e,_i.caret,false,true,null);l.addComp(R,12,1,1,1,"left","middle",JV(-30),0,0,0);var L=new $t.Label(r,0,0,e,"The list level number must be surrounded by a pair of ~");l.addComp(L,14,0,1,2,"left","bottom",JV(15),0);var C=new $t.Label(r,0,0,e,"characters. Example: (~1~) would print as");l.addComp(C,15,0,1,2,"left","bottom",JV(15),0);var I=new $t.Label(r,0,0,e,"     (1) First item.");l.addComp(I,16,0,1,2,"left","bottom",JV(15),0);var d=new $t.Label(r,0,0,e,"     (2) Second item.");l.addComp(d,17,0,1,2,"left","bottom",JV(15),0);l.addGroupBox(5,2,13,2,"",e,0,0,0,JV(15));var F=new $t.Label(r,0,0,e,"Start at");l.addComp(F,6,2,1,1,"left","bottom",JV(15),0);var g=new $t.TextBox(r,0,0,100,t,"",e,_i.caret,false,true,null);l.addComp(g,6,3,1,1,"left","middle",JV(-15),0,0,0);var P=new $t.Label(r,0,0,e,"Character After");l.addComp(P,8,2,1,1,"left","bottom",JV(15),0,JV(25),0);var S=new $t.ComboBox(r,0,0,JV(100),t,true,JV(200),true,e,true,true,M);S.setMaximumRowCount(3);l.addComp(S,8,3,1,1,"left","middle",JV(-15),0,10,0);var h=new $t.Label(r,0,0,e,"Number Type");l.addComp(h,11,2,1,1,"left","bottom",JV(15),0);var O=new $t.ComboBox(r,0,0,JV(225),t,true,JV(200),true,e,true,true,G);O.setMaximumRowCount(6);l.addComp(O,12,2,1,2,"left","middle",JV(20),JV(10),0,0);FldFonts=new $t.Button(r,0,0,JV(150),t,e,"Number Font...",true,B);l.addComp(FldFonts,17,2,1,1,"left","middle",JV(100),0,JV(15));bQ(a.isSelected(),n,c,_,o,u,T,A,g,O,S,R);l.show();n.setFocus();function v(t,e,r){if(t=="Cancel"){l.hide();return}else if(t=="OK"){var i;var f;if(!WQ(a.isSelected(),n,c,_)){return}f=_P;r=SI;i=oI;f.flags=cj(f.flags,tc.LISTLEVEL_RESTART|tc.LISTLEVEL_LEGAL|tc.LISTLEVEL_REFORMAT|tc.LISTLEVEL_NO_RESET);if(o.isSelected())f.flags|=tc.LISTLEVEL_RESTART;if(u.isSelected())f.flags|=tc.LISTLEVEL_LEGAL;if(T.isSelected())f.flags|=tc.LISTLEVEL_REFORMAT;if(A.isSelected())f.flags|=tc.LISTLEVEL_NO_RESET;f.txt=[];uQ(R.getText(),f.txt);f.start=LX(g);f.NumType=UQ(O,f.NumType,false);f.CharAft=kQ(S,f.CharAft,false);if(Ls!=f.FontId){f.FontId=Ls;f.CharMask|=tc.CMASK_SIZE|tc.CMASK_FONT|tc.CMASK_TEXT_COLOR|tc.CMASK_TEXT_BK_COLOR}if(a.isSelected())Kc[r].level[i]=f;else Jc[r].level[i]=f;oi.modified++;_z(true);l.hide()}}function p(t,e,r){if(t=="selected"){wQ(a.isSelected(),n,c,_);bQ(a.isSelected(),n,c,_,o,u,T,A,g,O,S,R)}}function N(t,e,r){if(t=="selected"){wQ(a.isSelected(),n,c,_);bQ(a.isSelected(),n,c,_,o,u,T,A,g,O,S,R)}}function D(t,e,r){if(t=="selected"){bQ(a.isSelected(),n,c,_,o,u,T,A,g,O,S,R)}}function M(t,e,r){}function G(t,e,r){}function B(t,e,r){xQ(Ls)}}_i.TerEditListOr=function(t,e,r,i,f,l){var a,n,c;var s=(new tc.ClsListLevel).init();if(!lv||!QD())_i.TerCreateControl();for(a=1;a<Vc;a++)if(Kc[a].InUse)break;if(a==Vc)return-1;n=a;if(t){if((e=hQ())<0)return-1;Jc[e].InUse=true;Jc[e].ListIdx=i;c=f?Kc[i].LevelCount:0;Jc[e].LevelCount=c;Jc[e].flags=l;if(c>0){Jc[e].level=[c];for(a=0;a<c;a++){s=Kc[i].level[a].copy();s.flags|=tc.LISTLEVEL_RESTART|tc.LISTLEVEL_REFORMAT;Jc[e].level[a]=s}}if(r)return eQ(e,l);else return rQ(i,e,f,l)}if(e>=0){if(r)return eQ(i);else return rQ(i,e,f,l)}if(zc<=1)return-1;tQ(true,l)};function tQ(e,r){var t=_i.DlgCompHeight;var i=_i.DlgFont;var f=new $t.DialogBox(te,"Select a list",i,true,n,JV(2));var l=f.cvs;var a=new $t.ListBox(l,0,0,JV(350),JV(110),i,true,true,c);f.addComp(a,0,0,1,1,"Left","middle",0,0,JV(10),0);BQ(a,true,true,-1);f.show();a.setFocus();function n(t,e,r){if(t=="Cancel"){f.hide();return}else if(t=="OK"){s()}}function c(t,e,r){if(t=="dblclick"||t=="enter"){s();f.hide()}}function s(){var t=a.getSelectedItemData();f.hide();if(e)eQ(t,r)}}function eQ(r,i){var t=_i.DlgCompHeight;var e=_i.DlgFont;var f=new $t.DialogBox(te,"List Override Properties",e,true,s,JV(2));var l=f.cvs;var a=new $t.Label(l,0,0,e,"List to Override");f.addComp(a,0,0,1,1,"left","bottom");var n=new $t.ComboBox(l,0,0,JV(250),t,true,JV(200),true,e,true,true,_);HQ(n,true,false,Jc[r].ListIdx);n.setMaximumRowCount(3);f.addComp(n,1,0,1,1,"left","bottom",0,0,JV(10));var c=new $t.CheckBox(l,0,0,JV(15),JV(16),e,"Override Levels",Jc[r].LevelCount>0,null);f.addComp(c,3,0,1,1,"Left","middle");f.show();n.setFocus();function s(t,e,r){if(t=="Cancel"){f.hide();return}else if(t=="OK"){o()}}function _(t,e,r){}function o(){var t=n.getSelectedItemData();var e=c.isSelected();f.hide();rQ(t,r,e,i)}}function rQ(t,e,r,f){Jc[e].flags=f;LevelCount=r?Kc[t].LevelCount:0;if(LevelCount==Jc[e].LevelCount){if(t!=Jc[e].ListIdx&&LevelCount>0){for(i=0;i<LevelCount;i++)Jc[e].level[i]=Kc[t].level[i].copy()}}else{if(Jc[e].LevelCount>0){Jc[e].level=null}Jc[e].LevelCount=LevelCount;Jc[e].level=[LevelCount];for(i=0;i<LevelCount;i++)Jc[e].level[i]=Kc[t].level[i].copy()}Jc[e].ListIdx=t;oi.modified++;return e}_i.TerEditList=function(t,e,r,i,f,l){var a,n,c,s;var _,o;var u=(new tc.ClsListLevel).init();var T=(new tc.ClsListLevel).init();if(!lv||!QD())_i.TerCreateControl();if(t){if((e=SQ())<0)return-1;var A=new Date;var E=new Date("January 1, 2016");_=Math.floor((A.getTime()-E.getTime())/1e3)+15*Vc;o=Math.floor((A.getTime()-E.getTime())/1e3);for(a=0;a<Vc;a++){if(Kc[a].InUse&&Kc[a].TmplId>=_)_=Kc[a].TmplId+1;if(Kc[a].InUse&&Kc[a].id>=o)o=Kc[a].id+1}Kc[e].InUse=true;Kc[e].id=o;Kc[e].TmplId=_;Kc[e].FontId=0;s=f?9:1;Kc[e].LevelCount=s;Kc[e].flags=l;Kc[e].name=i;Kc[e].level=[s];for(a=0;a<s;a++)Kc[e].level[a]=(new tc.ClsListLevel).init();for(a=0;a<s;a++){u=(new tc.ClsListLevel).init();u.start=1;u.CharAft=tc.LISTAFT_TAB;u.NumType=tc.LIST_DEC;if(Yc==null||Yc[a]==null||Yc[a].txt==null)u.txt=[2,a,".".charCodeAt(0)];else{u.NumType=Yc[a].NumType;c=Yc[a].txt.length;u.txt=[];for(n=0;n<c;n++)u.txt[n]=Yc[a].txt[n];if(u.NumType==tc.LIST_BLT){var R="";var L=u.txt[1];var C=0;var I=u.FontId;var d=tc.SYMBOL_CHARSET;if(Yc[a].typeface!=null&&Yc[a].typeface!=""&&c>=2){C=u.txt[1];R=Yc[a].typeface;if(!Lk(R.toLowerCase(),"wingdings")&&!Lk(R.toLowerCase(),"symbol"))d=0}else if(L==tc.BLT_DIAMOND){C=9830;R="Symbol";if(n_.length>0)R=n_}else if(L==tc.BLT_SQUARE){C=61607;R="Wingdings";if(c_.length>0)R=c_}else if(L==tc.BLT_HOLLOW_SQUARE){C="q".charCodeAt(0);R="Wingdings";if(c_.length>0)R=c_}else if(L==tc.BLT_4_DIAMONDS){C=61558;R="Wingdings";if(c_.length>0)R=c_}else if(L==tc.BLT_ARROW){C=61656;R="Wingdings";if(c_.length>0)R=c_}else if(L==tc.BLT_CHECK){C=61692;R="Wingdings";if(c_.length>0)R=c_}else if(L==tc.BLT_ROUND||L==0){C=61623;R="Symbol";if(n_.length>0)R=n_}else C=L;u.txt[0]=1;u.txt[1]=C;u.CharMask|=tc.CMASK_FONT;if(R.length>0)u.FontId=Rb(Ti,I,R,xs[I].TwipsSize,0,xs[I].TextColor,tc.CLR_WHITE,xs[I].UlineColor,0,0,0,1,0,0,0,0,null,0,d,0,xs[I].TextAngle)}}Kc[e].level[a]=u.copy()}if(r)return fQ(e);else return lQ(e,i,f,l)}if(e>=0){if(r)return fQ(e);else return OnEditList(e,i,f,l)}if(Vc<=1)return-1;iQ(true)};function iQ(e){var t=_i.DlgCompHeight;var r=_i.DlgFont;var i=new $t.DialogBox(te,"Select a list",r,true,a,JV(2));var f=i.cvs;var l=new $t.ListBox(f,0,0,JV(250),JV(110),r,true,true,function(t,e){n(t,e,te)});i.addComp(l,0,0,1,1,"Left","middle",0,0,JV(10),0);HQ(l,true,true,-1);i.show();l.setFocus();function a(t,e,r){if(t=="Cancel"){i.hide();return}else if(t=="OK"){c()}}function n(t,e,r){if(t=="dblclick"||t=="enter"){c();i.hide()}}function c(){var t=l.getSelectedItemData();i.hide();if(e)fQ(t)}}function fQ(f){var t=_i.DlgCompHeight;var e=_i.DlgFont;var l=new $t.DialogBox(te,"List Properties",e,true,_,JV(2));var r=l.cvs;var i=new $t.Label(r,0,0,e,"List Name");l.addComp(i,0,0,1,1,"Left","bottom");var a=new $t.TextBox(r,0,0,JV(300),t,Kc[f].name,e,_i.caret,false,true,null);l.addComp(a,1,0,1,1,"left","middle",0,0,JV(10),0);var n=new $t.CheckBox(r,0,0,JV(15),JV(16),e,"Multi-level list",Kc[f].LevelCount>1,null);l.addComp(n,3,0,1,1,"Left","middle");var c=Kc[f].flags;var s=new $t.CheckBox(r,0,0,JV(15),JV(16),e,"Restart at section break",Nj(c&tc.LISTFLAG_RESTART_SEC),null);l.addComp(s,4,0,1,1,"Left","middle");l.show();a.setFocus();function _(t,e,r){if(t=="Cancel"){l.hide();return}else if(t=="OK"){name=a.getText();if(name.length==0){return}var i=n.isSelected();c=_j(c,tc.LISTFLAG_RESTART_SEC);if(s.isSelected())c|=tc.LISTFLAG_RESTART_SEC;l.hide();return lQ(f,name,i,c)}else return}}function lQ(t,e,r,i){var f,l,a,n;var c,s;var _=(new tc.ClsListLevel).init();var o=(new tc.ClsListLevel).init();Kc[t].name=e;Kc[t].flags=i;n=r?9:1;if(n!=Kc[t].LevelCount){Kc[t].level=fV(Kc[t].level,n);if(n>Kc[t].LevelCount){var u=Kc[t].LevelCount;_=Kc[t].level[0];for(f=u;f<n;f++){o=_.copy();a=_.txt[0]+1;for(l=1;l<a;l++){if(o.text[l]==0)o.text[l]=f}Kc[t].level[f]=o}}Kc[t].LevelCount=n}oi.modified++;return t}_i.TerSetDefListFormat=function(t,e,r){return _i.TerSetDefListFormat2(t,e,r,"")};_i.TerSetDefListFormat2=function(t,e,r,i){if(!lv||!QD())_i.TerCreateControl();if(t<0||t>8)return false;if(Yc==null){Yc=[]}Yc[t]=(new tc.ClsDefListLevel).init();Yc[t].NumType=e;if(r!=null)uQ(r,Yc[t].txt);if(i==null)i="";Yc[t].typeface=i;return true};_i.TerGetListId=function(t){var e;if(!lv||!QD())_i.TerCreateControl();for(e=0;e<Vc;e++){if(Kc[e].InUse&&Tk(Kc[e].name,t)==0)return e}return-1};_i.TerGetListInfo=function(t){var e=new tc.ClsList;if(!lv||!QD())_i.TerCreateControl();IP="";uI=LI=CI=0;AI=0;if(t<0){var r=ui[br].pfmt;var i=Nc[r].BltId;var f;if(i==0||xc[i].ls==0)return false;f=xc[i].ls;t=Jc[f].ListIdx}if(t<0||t>=Vc)return false;e=Kc[t];IP=e.name;uI=e.LevelCount;AI=e.flags;LI=e.id;CI=e.TmplId;return true};_i.TerGetListOrInfo=function(t){var e=new tc.ClsListOr;if(!lv||!QD())_i.TerCreateControl();EI=uI=AI=0;if(t<0){var r=ui[br].pfmt;var i=Nc[r].BltId;if(i==0||xc[i].ls==0)return false;t=xc[i].ls}if(t<0||t>=zc)return false;e=Jc[t];EI=e.ListIdx;uI=e.LevelCount;AI=e.flags;return true};_i.TerGetListLevelInfo=function(t,e,r){var i=(new tc.ClsListLevel).init();if(!lv||!QD())_i.TerCreateControl();sI=II=FI=0;dI=0;CP="";YI=0;if(e<0){var f=ui[br].pfmt;var l=Nc[f].BltId;var a;if(l==0||xc[l].ls==0)return false;a=xc[l].ls;if(t)e=Jc[a].ListIdx;else e=a;r=xc[l].lvl}if(t){if(e>=Vc||!Kc[e].InUse)return false;if(r>=Kc[e].LevelCount)return false;i=Kc[e].level[r]}else{if(e>=zc||!Jc[e].InUse)return false;if(r>=Jc[e].LevelCount)return false;i=Jc[e].level[r]}sI=i.start;II=i.NumType;dI=i.CharAft;FI=i.FontId;YI=i.flags;CP=oQ(i.txt);var n=xs[i.FontId].TypeFace;if(i.NumType==tc.LIST_BLT){if(CP.length==0)CP=tc.BLT_ROUND.toString();else if(CP.length==1){var c=Uk(CP);var s=c[0];if(s==168&&Tk(n,"Symbol")==0)CP=tc.BLT_DIAMOND.toString();else if(s==168&&Tk(n,n_)==0)CP=tc.BLT_DIAMOND.toString();else if(s==167&&Tk(n,"Wingdings")==0)CP=tc.BLT_SQUARE.toString();else if(s==167&&Tk(n,c_)==0)CP=tc.BLT_SQUARE.toString();else if(s=="q".charCodeAt(0)&&Tk(n,"Wingdings")==0)CP=tc.BLT_HOLLOW_SQUARE.toString();else if(s=="q".charCodeAt(0)&&Tk(n,c_)==0)CP=tc.BLT_HOLLOW_SQUARE.toString();else if(s=="v".charCodeAt(0)&&Tk(n,"Wingdings")==0)CP=tc.BLT_4_DIAMONDS.toString();else if(s=="v".charCodeAt(0)&&Tk(n,c_)==0)CP=tc.BLT_4_DIAMONDS.toString();else if(s==216&&Tk(n,"Wingdings")==0)CP=tc.BLT_ARROW.toString();else if(s==216&&Tk(n,c_)==0)CP=tc.BLT_ARROW.toString();else if(s==252&&Tk(n,"Wingdings")==0)CP=tc.BLT_CHECK.toString();else if(s==252&&Tk(n,c_)==0)CP=tc.BLT_CHECK.toString();else if(s==183&&Tk(n,"Symbol")==0)CP=tc.BLT_ROUND.toString();else if(s==183&&Tk(n,n_)==0)CP=tc.BLT_ROUND.toString()}}return true};function aQ(t,e,r,i,f){var l,a,n,c,s,_,o=0,u,T,A,E,R=0;var L,C,I=0,d;var F,g=0;var P;var S;var h=[50],O=[50];var v=(new tc.ClsListLevel).init();var p=(new tc.ClsListLevel).init();var N;var D;var M,G,B=tc.LIST_DEC;var H,m;var w,b;var x;var y=false,W=false,U=false,k,X,K=true;var Y=false;var V;CP="";gI=PI=FI=0;O[0]=0;d=0;R=0;o=0;t:{if(GY(e,tc.INFO_ROW))break t;if(i>=0){if(Dj(ui[e].tabw)||i>=ui[e].tabw.ListnumCount)break t;x=ui[e].tabw.pListnum;u=x[i].ls;A=x[i].lvl}else{if(Dj(Nc[t].flags&tc.BULLET))break t;_=Nc[t].BltId;A=xc[_].lvl;_=nQ(_);u=xc[_].ls}if((v=_Q(u,A,true))==null)break t;if(v.NumType==tc.LIST_BLT)W=true;e:{if(false&&v.NumType==tc.LIST_BLT){P=SY("%c",183);JY(O,Uk(P));s=P.length;W=true;break e}else if(false&&v.NumType==tc.LIST_NO_NUM){CP="";break t}U=v.CharAft==tc.LISTAFT_TAB;k=Nj(v.flags&tc.LISTLEVEL_RIGHT);X=Nj(v.flags&tc.LISTLEVEL_CENTER);d=f?DV(v.MinIndent):dV(v.MinIndent);h=v.txt;n=h[0];if(n>=50)break t;s=0;for(c=1;c<=n;c++){S=h[c];if(S>9){O[s]=h[c];s++;continue}T=h[c];F=cQ(e,u,T,A,i);if(A==T)g=F;p=_Q(u,T,true);B=p.NumType;if(Nj(v.flags&tc.LISTLEVEL_LEGAL)&&B!=tc.LIST_NO_NUM&&B!=tc.LIST_DEC_PAD)B=tc.LIST_DEC;if(B!=tc.LIST_NO_NUM)K=false;if(B==tc.LIST_NO_NUM)P="";else if(B==tc.LIST_UPR_ALPHA)P=KX(F,true);else if(B==tc.LIST_LWR_ALPHA)P=KX(F,false);else if(B==tc.LIST_UPR_ROMAN)P=YX(F,true);else if(B==tc.LIST_LWR_ROMAN)P=YX(F,false);else if(B==tc.LIST_CARDINAL)P=eK(F,false,Nj(xs[p.FontId].style&(tc.CAPS|tc.SCAPS)),xs[Nj(v.CharMask&tc.CMASK_LANG)?p.FontId:r].lang);else if(B==tc.LIST_ORDINAL_TEXT)P=eK(F,true,Nj(xs[p.FontId].style&(tc.CAPS|tc.SCAPS)),xs[Nj(v.CharMask&tc.CMASK_LANG)?p.FontId:r].lang);else if(B>=tc.LIST_CHINESE_NUM&&B<=tc.LIST_CHINESE_NUM_LAST||B>=tc.LIST_CHINESE_ZOD&&B<=tc.LIST_CHINESE_ZOD_LAST||B>=tc.LIST_CHINESE_DBL&&B<=tc.LIST_CHINESE_DBL_LAST||B==tc.LIST_KANJI_DBNUM2)P=VX(F,true);else if(B>=tc.LIST_KANJI_NUM&&B<=tc.LIST_KANJI_NUM_LAST)P=JX(F,true);else if(B==tc.LIST_HEBREW)P=QX(F,true);else if(B==tc.LIST_KOREAN2)P=ZX(F);else if(B==tc.LIST_DEC_PAD)P=XX(F.toString(),"0",2);else P=F.toString();y=B==tc.LIST_UPR_ROMAN||B==tc.LIST_LWR_ROMAN;O[s]=0;zY(O,Uk(P));s=jY(O)}}O[s]=0;CP=Wk(O,0,s);Nc[t].pflags=cj(Nc[t].pflags,tc.PFLAG_NO_NUM_LIST);if(CP.length==0)Nc[t].pflags|=tc.PFLAG_NO_NUM_LIST;if(v.CharAft==tc.LISTAFT_SPACE)CP+=" ";R=v.FontId;var j=v.flags;D=xs[r].TypeFace;M=xs[r].TwipsSize;H=xs[r].style;H=_j(H,tc.ULINE);if(v.NumType==tc.LIST_BLT)H=_j(H,tc.ITALIC);w=xs[r].TextColor;b=xs[r].TextBkColor;m=xs[r].CharSet;G=0;if(Tk(xs[R].TypeFace,D)!=0){var J=tc.CMASK_FONT_LATIN;if(B>=tc.LIST_CHINESE_NUM&&B<=tc.LIST_CHINESE_NUM_LAST||B>=tc.LIST_CHINESE_ZOD&&B<=tc.LIST_CHINESE_ZOD_LAST||B>=tc.LIST_CHINESE_DBL&&B<=tc.LIST_CHINESE_DBL_LAST||B==tc.LIST_KANJI_DBNUM2)J=tc.CMASK_FONT;else if(B>=tc.LIST_KANJI_NUM&&B<=tc.LIST_KANJI_NUM_LAST)J=tc.CMASK_FONT;else if(B==tc.LIST_HEBREW)J=tc.CMASK_FONT;if(Nj(v.CharMask&J)){D=xs[R].TypeFace;m=xs[R].CharSet;G++}}if(vS|pS&&Tk(D,"Symbol")==0){D="Arial";Y=true;if(G==0)G++}var z=false;if(Nj(v.CharMask&tc.CMASK_SIZE))z=true;if(qc>0){M=qc;G++}else if((Li||vr)&&W){M=200;G++}else if(z){M=xs[R].TwipsSize;G++}if(Nj(j&tc.LISTLEVEL_REFORMAT)||Nj(xs[R].style)||Nj(v.FontStylesOff)){H=cj(H,v.FontStylesOff);H|=xs[R].style;G++}if(xs[R].TextColor!=xs[0].TextColor&&xs[R].TextColor!=tc.CLR_AUTO||Nj(v.CharMask&tc.CMASK_TEXT_COLOR)){w=xs[R].TextColor;G++}if(Nj(j&tc.LISTLEVEL_REFORMAT)||xs[R].TextBkColor!=xs[0].TextBkColor&&xs[R].TextBkColor!=jT){b=xs[R].TextBkColor;G++}if(G==0){R=r;if(Nj(xs[R].style&tc.ULINE))R=Db(R,tc.ULINE,false)}else if(G<=5){var Z=ui[e].fid;N=f?Xs[0].gr:Ti;R=Rb(N,R,D,M,H,w,b,tc.CLR_AUTO,0,0,0,1,0,0,0,0,null,0,m,0,kl[Z].TextAngle)}if(Y){var Q=Uk(CP);for(c=0;c<CP.length;c++){if(Q[c]==61623)Q[c]=9679}CP=Wk(Q)}N=Ti;var q=f?Xs[R].font:xs[R].font;o=gJ(N,q,CP);var $=0;if(f)$=-DV(Nc[t].FirstIndentTwips);else $=-dV(Nc[t].FirstIndentTwips);if(o>=$){var tt=$*tc.MAX_TEXT_COMPRESSION_PCT/100;if(o<$+tt)o=$-1}if(d==0&&!W){var et="    ";d=_B(N,q,et)}if(K)d=0;if(v.CharAft==tc.LISTAFT_TAB){if(U&&(k||X)){if(k)o=0;if(X)o/=2}l=Nc[t].LeftIndentTwips+Nc[t].FirstIndentTwips;if(f)l=DV(l);else l=dV(l);a=l+o;E=Nc[t].TabId;v$(e,t,B_[E],a,!f,true);L=aI;C=cI;I=L-a;if(I<0)I=0;o+=I}if(o<d)o=d}gI=o;FI=R;PI=g;return true}function nQ(t){var e=xc[t].ls;var r=xc[t].lvl;var i,f;if(t==0)return t;f=Jc[e].ListIdx;if(Kc[f].ListStyleName!=null&&Kc[f].ListStyleName.length>0){for(i=0;i<X_;i++){if(Tk(Kc[f].ListStyleName,W_[i].name)==0){if(W_[i].BltId>0)return W_[i].BltId}}}return t}function cQ(t,e,r,i,f){var l,a,n=0,c,s,_,o,u=0,T,A=-1,E;var R=1,L,C,I,d=-1;var F,g;var P,S,h,O,v=false,p=false,N,D;var M;var G;o=Jc[e].ListIdx;if(r<Kc[o].LevelCount)R=Kc[o].level[r].start;L=n=R-1;G=sQ(e,r);S=Dj(G.flags&tc.LISTLEVEL_NO_RESET);v=Nj(ui[t].fid);N=Nj(Nc[ui[t].pfmt].flags&tc.PAGE_HDR_FTR)?true:false;if(f<0){for(F=t-1;F>=0;F--){if(GY(F,tc.INFO_ROW|tc.INFO_PAGE|tc.INFO_COL|tc.INFO_SECT))break;if(Nj(ui[F].flags&tc.LFLAG_LISTNUM))break;if(ui[F].cid>0&&Nj(eR[ui[F].cid].flags&tc.CFLAG_ROW_SPANNED))continue;if(Dj(ui[F].flags&tc.LFLAG_PARA_FIRST))continue;if(Dj(ui[F].flags&tc.LFLAG_LIST))break;p=Nj(ui[F].fid);if(p!=v||ui[F].fid!=ui[F+1].fid)break;D=Nj(Nc[ui[F].pfmt].flags&tc.PAGE_HDR_FTR)?true:false;if(D!=N)break;T=Nc[ui[F].pfmt].BltId;u=xc[T].lvl;T=nQ(T);s=xc[T].ls;if(Jc[s].ListIdx!=o)break;if(s!=e){break}if(u<r)break;if(u>r)continue;if(Dj(ui[F].tabw))break;if(r<i)return ui[F].tabw.ListNbr;else return ui[F].tabw.ListNbr+1}}for(l=0;l<zc;l++){Jc[l].flags=cj(Jc[l].flags,tc.LISTOR_FOUND);for(a=0;a<Jc[l].LevelCount;a++)Jc[l].level[a].flags=sj(Jc[l].level[a].flags,tc.LISTLEVEL_RESTARTED)}h=false;var B=0;var H=0;var m=0;u=0;for(F=0;F<=t;F++){if(m>0){B=m;H=u}if(GY(F,tc.INFO_ROW|tc.INFO_PAGE|tc.INFO_COL))continue;if(ui[F].cid>0&&Nj(eR[ui[F].cid].flags&tc.CFLAG_ROW_SPANNED))continue;I=ui[F].fid;if(Nj(I)&&Nj(kl[I].flags&(tc.PARA_FRAME_LINE|tc.PARA_FRAME_RECT)))continue;p=Nj(I);if(p!=v)continue;D=Nj(Nc[ui[F].pfmt].flags&tc.PAGE_HDR_FTR)?true:false;if(D!=N)continue;if(Nj(Kc[o].flags&tc.LISTFLAG_RESTART_SEC)&&GY(F,tc.INFO_SECT))h=true;E=0;if(F==t)E=f+1;else if(Nj(ui[F].tabw))E=ui[F].tabw.ListnumCount;if(E<0)E=0;for(c=-1;c<E;c++){if(c==-1){T=Nc[ui[F].pfmt].BltId;u=xc[T].lvl;m=xc[T].ls;var w=nQ(T);if(T!=w&&m>0&&(m!=B||u!=H)&&Jc[m].LevelCount>u){if(Nj(Jc[m].level[u].flags&tc.LISTLEVEL_RESTART)){n=Jc[m].level[u].start;continue}}T=w;s=xc[T].ls;d=-1;if(Dj(ui[F].flags&tc.LFLAG_PARA_FIRST))continue}else{if(Dj(ui[F].tabw)||c>=ui[F].tabw.ListnumCount)continue;M=ui[F].tabw.pListnum;s=M[c].ls;u=M[c].lvl;var b=sQ(s,u);if(true||M[c].RestartAt>=0)d=M[c].RestartAt;T=-1}_=Jc[s].ListIdx;if(s==0)continue;O=h;h=false;if(_!=o)continue;if(T>=0&&Nj(xc[T].flags&tc.BLTFLAG_HIDDEN))continue;if(T>=0&&xc[T].IsBullet)continue;if(O&&u==r){n=R-1}if(u>r){if(n==R-1)n++;Jc[s].flags|=tc.LISTOR_FOUND;continue}if(s!=A){P=u==r&&r<Jc[s].LevelCount&&Nj(Jc[s].level[r].flags&tc.LISTLEVEL_RESTART)&&Dj(Jc[s].flags&tc.LISTOR_FOUND);if(P){C=Jc[s].level[r].start;R=C;n=R-1;A=s}Jc[s].flags|=tc.LISTOR_FOUND}if(d>=0){R=n=d-1}if(u<r){if(S){if(true||Jc[e].LevelCount==0)n=L;else n=R-1}continue}n++;if(false&&F<t&&ui[F].fid>0){for(g=F;g<Ri;g++)if(Nj(ui[g].flags&tc.LFLAG_PARA))break;if(g+1<Ri&&ui[g+1].fid!=ui[F].fid)n++}}}return n}function sQ(t,e){return _Q(t,e,false)}function _Q(t,e,r){var i;var f=new tc.ClsListOr;var l=new tc.ClsList;var a;a=(new tc.ClsListLevel).init();if(t==0||t>=zc)return null;f=Jc[t];i=f.ListIdx;if(i<=0||i>=Vc)return null;l=Kc[i];if(f.LevelCount==0||e>=f.LevelCount||f.LevelCount!=1&&f.LevelCount!=9||f.LevelCount<l.LevelCount||r&&e<f.LevelCount&&Dj(f.level[e].flags&tc.LISTLEVEL_REFORMAT)){if(e>=l.LevelCount){if(l.LevelCount<=0)return null;else e=l.LevelCount-1}a=l.level[e]}else{if(e>=f.LevelCount)return null;a=f.level[e]}return a}function oQ(t){var e,r,i;var f=[100];var l;r=0;i=t[0];for(e=1;e<=i;e++,r++){if(t[e]<=8){f[r]="~".charCodeAt(0);r++;f[r]=t[e]+"1".charCodeAt(0);r++;f[r]="~".charCodeAt(0)}else f[r]=t[e]}f[r]=0;l=Wk(f,0,r);return l}function uQ(t,e){var r,i,f,l;var a=Uk(t);f=a.length;i=1;for(r=0;r<f;r++,i++){if(a[r]=="~".charCodeAt(0)&&r+2<f&&a[r+2]=="~".charCodeAt(0)){l=a[r+1]-"1".charCodeAt(0);if(l<0)l=0;if(l>8)l=8;e[i]=l;r+=2}else e[i]=a[r]}e[i]=0;e[0]=i-1;return true}function TQ(t,e){var r="";var i;var f,l,a;var n;var c;f=0;n=Nc[ui[t].pfmt].StyId;if(Nj(n))f=SZ(n);for(c=t-1;c>=0;c--){if(Dj(ui[c].flags&tc.LFLAG_AUTONUMLGL))continue;if(Dj(ui[c].tabw)||Dj(ui[c].tabw.pAutoNumLgl))continue;l=0;n=Nc[ui[c].pfmt].StyId;if(Nj(n))l=SZ(n);if(f>0&&(l==0||l>f))continue;if(l==f){FQ(ui[c].tabw.pAutoNumLgl);i=dP;a=PI;r=dQ(i,a+1,l,f)}else r=dQ(ui[c].tabw.pAutoNumLgl,1,l,f);break}if(r.length==0)r=dQ("",1,0,f);ui[t].tabw.pAutoNumLgl=r;return true}function AQ(t,e){var r;var i,f,l,a,n,c;var s,_;var o,u;var T;var A,E,R=0,L;var C;var I;var d;r=nb(t);C=ui[t].txt;n=-1;a=0;f=ui[t].len;for(i=0;i<f;i++){I=C[i];l=a;a=r[i];if(i==0||l!=a||I==tc.HPARA_CHAR){if(I==tc.HPARA_CHAR){var F;if(0==Vx(t,i,tc.TERTAG_HPARA))continue;F=WC;if(F<0||F>=Dc)continue;if((R=Nc[F].BltId)==0)continue;if(xc[R].ls==0)continue}else{c=xs[a].FieldId;if(c!=tc.FIELD_LISTNUM)continue}n++;if(Dj(ui[t].tabw))xX(t);if(ui[t].tabw.ListnumCount==0)ui[t].tabw.pListnum=[n+1];else ui[t].tabw.pListnum=fV(ui[t].tabw.pListnum,n+1);ui[t].tabw.ListnumCount=n;if(I==tc.HPARA_CHAR){A=xc[R].ls;E=xc[R].lvl;u=-1}else{EQ(a,t);A=RI;E=oI;u=_I}ui[t].tabw.ListnumCount=n+1;T=ui[t].tabw.pListnum;T[n]=new tc.ClsListnum;T[n].ls=A;T[n].lvl=E;T[n].RestartAt=u;T[n].IsHPARA=I==tc.HPARA_CHAR;T[n].HasLevelSpec=I!=tc.HPARA_CHAR&&xs[a].FieldCode!=null&&xs[a].FieldCode.indexOf("\\l ")>=0;aQ(ui[t].pfmt,t,0,n,e);s=CP;o=PI;T=ui[t].tabw.pListnum;T[n].text=s;T[n].ListNbr=o}}return true}function EQ(t,e){var r;var i=0,f,l,a;var n=0,c,s=0;var _=1,o;var u,T;var A=xs[t].FieldId;var E=false;var R;var L,C=false,I;RI=oI=0;t:{L=true;for(R=e;R>=0;R--){c=ui[R].pfmt;s=Nc[c].BltId;if(Nj(s))break;if(Nj(ui[R].flags&tc.LFLAG_PARA_FIRST))L=false}if(s==0)L=false;if(s==0){for(R=e;R<Ri;R++){c=ui[R].pfmt;s=Nc[c].BltId;if(Nj(s))break}}r=xs[t].FieldCode;if(Nj(r))r=r.trim();I=false;n=0;for(R=e-1;R>=0;R--){if(Nj(ui[R].flags&tc.LFLAG_LISTNUM)&&Nj(ui[R].tabw)&&ui[R].tabw.ListnumCount>0&&Nj(ui[R].tabw.pListnum)){for(f=ui[R].tabw.ListnumCount-1;f>=0;f--){if(ui[R].tabw.pListnum[f].HasLevelSpec){n=ui[R].tabw.pListnum[f].lvl;break}}if(f>=0)break}c=ui[R].pfmt;if(Nj(Nc[c].BltId)){n=xc[s].lvl;break}}if(R>=0)I=true;if(!I&&(Dj(r)||r.length==0)){if(s>0){i=xc[s].ls;if(L){c=ui[e].pfmt;s=Nc[c].BltId;n=xc[s].lvl+1;if(n>8)n=8;E=false}break t}}if(Nj(r))u=r;else u="";u=u.toUpperCase().trim();T=Aw(u);if(T.length>0&&Nj(s)&&Nj(xc[s].ls)){var d=Jc[xc[s].ls].ListIdx;if(d>=0&&d<Vc&&Nj(Kc[d].name)&&Tk(Kc[d].name,T)==0){i=xc[s].ls;n=xc[s].lvl+1}}if(T.length==0&&!I){i=xc[s].ls;n=xc[s].lvl}_=CQ(u,"\\S",-1);E=sP;a=n;n=CQ(u,"\\L",n+1)-1;C=sP;if(!C)n=a+1;if(false&&n>a&&!E){E=true;_=1}if(T.length==0){if(s>0){i=xc[s].ls;break t}else{T="NumberDefault";if(u.length==0){if(Nj(ui[e].tabw)){if(Dj(ui[e].tabw.pListnum)||ui[e].tabw.ListnumCount==0)n=0;else{var F=ui[e].tabw.ListnumCount-1;var g=ui[e].tabw.pListnum;n=g[F].lvl+1}}}}}if(n<0)n=0;if(n>8)n=8;for(f=0;f<Vc;f++){if(Kc[f].InUse&&Nj(Kc[f].name)&&Tk(Kc[f].name,T)==0)break}if(f<Vc)o=f;else o=RQ(T);for(f=0;f<zc;f++){if(Jc[f].ListIdx!=o)continue;if(Jc[f].LevelCount>0){for(l=0;l<Jc[f].LevelCount;l++){if(Nj(Jc[f].level[l].flags&tc.LISTLEVEL_REFORMAT))break}if(l<Jc[f].LevelCount)continue}if(E){if(n>=Jc[f].LevelCount)continue;if(Jc[f].level[n].start==_&&Nj(Jc[f].level[n].flags&tc.LISTLEVEL_RESTART))break}else{if(n<Jc[f].LevelCount){if(true||Nj(Jc[f].level[n].flags&tc.LISTLEVEL_RESTART))break}else if(n<Kc[o].LevelCount)break}}if(f<zc)i=f;else i=LQ(o,_,E,n)}if(n<0)n=0;if(n>8)n=8;RI=i;oI=n;if(E)_I=_;else _I=-1;return true}function RQ(t){var e,r,i,f,l=9,a;var n=0,c=0;var s;var _;var o=new Date;var u=new Date("January 1, 2016");c=Math.floor((o.getTime()-u.getTime())/1e3)+15*Vc;for(r=0;r<Vc;r++){if(Kc[r].id>n)n=Kc[r].id;if(Kc[r].TmplId>c)c=Kc[r].TmplId+1}n++;c++;if((e=SQ())<0)return 0;Kc[e].InUse=true;Kc[e].id=n;Kc[e].TmplId=c;Kc[e].FontId=0;Kc[e].LevelCount=l;Kc[e].flags=0;Kc[e].name=t;Kc[e].level=[l];s=Kc[e].level;for(r=0;r<l;r++){s[r]=(new tc.ClsListLevel).init();s[r].start=1;s[r].CharAft=tc.LISTAFT_NONE;s[r].text=[50]}if(Tk(t,"NumberDefault")==0){s[0].NumType=s[3].NumType=s[6].NumType=tc.LIST_DEC;s[1].NumType=s[4].NumType=s[7].NumType=tc.LIST_LWR_ALPHA;s[2].NumType=s[5].NumType=s[8].NumType=tc.LIST_LWR_ROMAN;_=s[0].text;_[0]=2;_[1]=0;_[2]=")".charCodeAt(0);_=s[1].text;_[0]=2;_[1]=1;_[2]=")".charCodeAt(0);_=s[2].text;_[0]=2;_[1]=2;_[2]=")".charCodeAt(0);_=s[3].text;_[0]=3;_[1]="(".charCodeAt(0);_[2]=3;_[3]=")".charCodeAt(0);_=s[4].text;_[0]=3;_[1]="(".charCodeAt(0);_[2]=4;_[3]=")".charCodeAt(0);_=s[5].text;_[0]=3;_[1]="(".charCodeAt(0);_[2]=5;_[3]=")".charCodeAt(0);_=s[6].text;_[0]=2;_[1]=0;_[2]=".".charCodeAt(0);_=s[7].text;_[0]=2;_[1]=1;_[2]=".".charCodeAt(0);_=s[8].text;_[0]=2;_[1]=2;_[2]=".".charCodeAt(0)}else if(Tk(t,"OutlineDefault")==0){s[0].NumType=tc.LIST_UPR_ROMAN;s[1].NumType=tc.LIST_UPR_ALPHA;s[2].NumType=s[4].NumType=tc.LIST_DEC;s[3].NumType=s[5].NumType=s[7].NumType=tc.LIST_LWR_ALPHA;s[6].NumType=s[8].NumType=tc.LIST_LWR_ROMAN;_=s[0].text;_[0]=2;_[1]=0;_[2]=".".charCodeAt(0);_=s[1].text;_[0]=2;_[1]=1;_[2]=".".charCodeAt(0);_=s[2].text;_[0]=2;_[1]=2;_[2]=".".charCodeAt(0);_=s[3].text;_[0]=2;_[1]=3;_[2]=")".charCodeAt(0);_=s[4].text;_[0]=3;_[1]="(".charCodeAt(0);_[2]=4;_[3]=")".charCodeAt(0);_=s[5].text;_[0]=3;_[1]="(".charCodeAt(0);_[2]=5;_[3]=")".charCodeAt(0);_=s[6].text;_[0]=3;_[1]="(".charCodeAt(0);_[2]=6;_[3]=")".charCodeAt(0);_=s[7].text;_[0]=3;_[1]="(".charCodeAt(0);_[2]=7;_[3]=")".charCodeAt(0);_=s[8].text;_[0]=3;_[1]="(".charCodeAt(0);_[2]=8;_[3]=")".charCodeAt(0)}else{for(r=0;r<9;r++)s[r].NumType=tc.LIST_DEC;for(r=0;r<9;r++){_=s[r].text;a=r+1;_[0]=a*2;i=1;for(f=0;f<a;f++,i++){_[i]=f;i++;_[i]=".".charCodeAt(0)}}}return e}function LQ(t,e,r,i){var f,l,a,n;if((f=hQ())<0)return 0;Jc[f].InUse=true;Jc[f].ListIdx=t;l=i==0&&!r?0:9;Jc[f].LevelCount=l;if(l==0)return f;Jc[f].level=[l];for(a=0;a<l;a++){if(a<Kc[t].LevelCount)n=a;else n=Kc[t].LevelCount-1;Jc[f].level[a]=Kc[t].level[n];if(r&&i==a){Jc[f].level[a].flags|=tc.LISTLEVEL_RESTART;Jc[f].level[a].start=e}}return f}function CQ(t,e,r){var i=r;var f;var l,a,n;var c;sP=false;if((a=t.indexOf(e))==-1)return i;f=t.substring(a+e.length);var s=Uk(f);for(l=0;l<f.length;l++)if(s[l]!=tc.CHAR_SPACE)break;if(l==f.length)return i;n=l;for(;l<f.length&&s[l]!=tc.CHAR_SPACE;l++);c=cV(f,n,l-n);sP=true;return LX(c)}function IQ(t,e){var r=false;var i;var f,l,a;var n=false;var c=null;if((l=t.indexOf(e))==-1)return null;i=cV(t,l+e.length);var s=Uk(i);for(f=0;f<i.length;f++){if(s[f]==tc.QUOTE){n=true;f++;break}if(s[f]!=tc.CHAR_SPACE)break}if(f==i.length)return null;a=f;for(;f<i.length;f++){if(n&&s[f]==tc.QUOTE)break;if(!n&&s[f]==tc.CHAR_SPACE)break}c=cV(i,a,f-a);return c}function dQ(t,e,r,i){var f,l;var a;a=t;l=a.length;var n=Uk(a);if(l>0&&n[l-1]!=".".charCodeAt(0)){a+=".";l=a.length}n=Uk(a);if(r+1<i){for(f=r+1;f<i;f++)a+="0.";l=a.length}a+=mY(e);return a}function FQ(t){var e;var r,i;dP="";PI=0;r=t;var f=Uk(r);e=r.length-1;if(e<0)return true;if(f[e]==".".charCodeAt(0)){r=cV(r,0,e);e--;if(e<0)return true}f=Uk(r);for(;e>=0&&f[e]!=".".charCodeAt(0);e--);i=cV(r,e+1);r=cV(r,0,e+1);dP=r;PI=LX(i);return true}function gQ(t,e,r,i){var f,l;var a;a=_P=r.copy();RI=i;if(Y_){l=W_[k_].ParaFlags;f=W_[k_].BltId}else{l=Nc[ui[t].pfmt].flags;f=Nc[ui[t].pfmt].BltId}if(Dj(l&tc.BULLET))return false;if(xc[f].ls==0)return false;if((_P=sQ(xc[f].ls,xc[f].lvl))==null){r=_P=a.copy();return false}if(e!=xc[f].lvl){r=_P=a.copy();return false}RI=xc[f].ls;return true}function PQ(t){var e,r;var i;for(e=1;true;e++){var f=new Date;var l=new Date("January 1, 2016");var a=Math.floor((f.getTime()-l.getTime())/1e3);i=t+a.toString()+"_"+mY(e);for(r=0;r<Vc;r++)if(Kc[r].name==i)break;if(r==Vc)return i}}function SQ(){var t;var e;for(t=1;t<Vc;t++){if(!Kc[t].InUse){Kc[t]=new tc.ClsList;return t}}if(Vc>=jc){e=jc+jc/2;Kc=fV(Kc,e+1);jc=e}Kc[Vc]=new tc.ClsList;Vc++;return Vc-1}function hQ(){var t;var e;for(t=1;t<zc;t++){if(!Jc[t].InUse){Jc[t]=new tc.ClsListOr;return t}}if(zc>=Zc){e=Zc+Zc/2;Jc=fV(Jc,e+1);Zc=e}Jc[zc]=new tc.ClsListOr;zc++;return zc-1}function OQ(t){var e,r;if(t<0||t>=Ri)return false;if(GY(t,tc.INFO_PAGE|tc.INFO_COL|tc.INFO_ROW))return false;e=ui[t].pfmt;if(Dj(Nc[e].flags&tc.BULLET))return false;r=Nc[e].BltId;if(r==0)return false;if(xc[r].IsBullet)return false;if(xc[r].ls==0)return false;return p9(t)}function vQ(t,e){var r;if(t.InUse&&!e.InUse)return false;if(!t.InUse&&e.InUse)return false;if(t.LevelCount!=e.LevelCount)return false;for(r=0;r<t.LevelCount;r++)if(!NQ(t.level[r],e.level[r]))return false;return true}function pQ(t,e){var r;if(t.InUse&&!e.InUse)return false;if(!t.InUse&&e.InUse)return false;if(t.ListIdx!=e.ListIdx)return false;if(t.LevelCount!=e.LevelCount)return false;for(r=0;r<t.LevelCount;r++)if(!NQ(t.level[r],e.level[r]))return false;return true}function NQ(t,e){var r,i;var f=tc.LISTLEVEL_RESTART|tc.LISTLEVEL_LEGAL|tc.LISTLEVEL_REFORMAT|tc.LISTLEVEL_NO_RESET;if(t.start!=e.start)return false;if(t.NumType!=e.NumType)return false;if(t.CharAft!=e.CharAft)return false;if(t.LeftIndent!=e.LeftIndent)return false;if(t.RightIndent!=e.RightIndent)return false;if(t.FirstIndent!=e.FirstIndent)return false;if(t.ParaFlags!=e.ParaFlags)return false;if(t.FontStyles!=e.FontStyles)return false;if(Nj(t.flags&f)!=Nj(e.flags&f))return false;if(t.MinIndent!=e.MinIndent)return false;if(t.FontStylesOff!=e.FontStylesOff)return false;if(t.txt[0]!=e.txt[0])return false;i=t.txt[0];for(r=1;r<=i;r++)if(t.txt[r]!=e.txt[r])return false;return true}function DQ(){var t;for(t=1;t<Vc;t++)MQ(t);Vc=1;for(t=1;t<zc;t++)GQ(t);zc=1;return true}function MQ(t){Kc[t]=new tc.ClsList;return true}function GQ(t){Jc[t]=new tc.ClsListOr;return true}function BQ(t,e,r,i,f){var l,a,n=0;var c;var s;if(e&&i<0){var _=ui[br].pfmt;var o=Nc[_].BltId;i=1;if(o>0&&xc[o].ls>0)i=xc[o].ls}var u=[];var T=[];for(l=1;l<zc;l++){if(Jc[l].InUse){if(f&&Jc[l].LevelCount==0)continue;a=Jc[l].ListIdx;s=XX(l.toString(),"0",3);if(Nj(Kc[a].name)&&Kc[a].name.length>0)c="List: "+Kc[a].name+", Override# "+s;else c="List Override #"+s;u.push(c);T.push(l);n++}}var A=0;if(e&&i!=0){for(l=0;l<n;l++){if(i==T[l]){A=l;break}}}t.setItems(u,T,A,false);return i}function HQ(t,e,r,i){var f,l=0;var a;if(e&&i<0){var n=ui[br].pfmt;var c=Nc[n].BltId;i=1;if(c>0&&xc[c].ls>0){var s=xc[c].ls;i=Jc[s].ListIdx}}var _=[];var o=[];for(f=1;f<Vc;f++){if(Kc[f].InUse){if(Nj(Kc[f].name)&&Kc[f].name.length>0)a=Kc[f].name;else a="Unnamed List #"+mY(f);_.push(a);o.push(f);l++}}var u=0;if(e){for(f=0;f<l;f++){if(i==o[f]){u=0;break}}}t.setItems(_,o,u,false);return true}function mQ(t,e,r){var i,f,l,a,n,c;var s;f=t.getSelectedIndex();if(t.getSelectedValue()==null)return false;a=t.getSelectedValue();c=Jc[a].LevelCount;if(c==0){l=Jc[a].ListIdx;c=Kc[l].LevelCount}n=e.getItemCount();if(n!=c){var _=[];var o=[];for(i=0;i<c;i++){s=mY(i+1);_.push(s);o.push(i)}f=0;for(i=0;i<c;i++){if(r==o[i]){f=i;break}}e.setItems(_,o,f,false)}return true}function wQ(t,e,r,i){var f,l,a,n,c,s;var _;var o=false;if(!t)e=r;l=e.getSelectedIndex();if(e.getSelectedItem()==null)return false;a=e.getSelectedValue();s=Kc[a].LevelCount;o=true;e.setEnabled(o);r.setEnabled(!o);c=i.getItemCount();if(c!=s){var u=[];var T=[];for(f=0;f<s;f++){_=mY(f+1);u.push(_);T.push(f)}i.setItems(u,T,0,false)}return true}function bQ(t,e,r,i,f,l,a,n,c,s,_,o){var u;var T;var A;if(!WQ(t,e,r,i))return false;u=_P;f.setSelected(Nj(u.flags&tc.LISTLEVEL_RESTART));l.setSelected(Nj(u.flags&tc.LISTLEVEL_LEGAL));a.setSelected(Nj(u.flags&tc.LISTLEVEL_REFORMAT));n.setSelected(Nj(u.flags&tc.LISTLEVEL_NO_RESET));c.setText(mY(u.start));UQ(s,u.NumType,true);kQ(_,u.CharAft,true);T=oQ(u.txt);o.setText(T);Ls=u.FontId;return true}function xQ(i,t){var f;var l;if(i<0||i>=Ys||!xs[i].InUse||Nj(xs[i].style&tc.PICT))i=0;f=xs[i].style;Ls=i;zs=xs[i].TypeFace;Zs=xs[i].TwipsSize;yQ(i,e);function e(t,e){var r=new tc.Font(zs,0,Zs);l=Zs;Ls=Rb(Ti,i,zs,l,f,xs[i].TextColor,xs[i].TextBkColor,xs[i].UlineColor,xs[i].FieldId,xs[i].AuxId,xs[i].Aux1Id,xs[i].CharStyId,xs[i].ParaStyId,xs[i].expand,xs[i].TempStyle,xs[i].lang,xs[i].FieldCode,xs[i].offset,xs[i].CharSet,xs[i].flags,xs[i].TextAngle)}}function yQ(t,f){var e=_i.DlgCompHeight;var r=_i.DlgFont;var l=new $t.DialogBox(te,"Font Selection",r,true,d,JV(2));var a=l.cvs;var n=new $t.Label(a,0,0,r,"Typeface");l.addComp(n,0,0,1,1,"left","middle");var c=JV(300);var s=new $t.ComboBox(a,0,0,JV(250),c+e,false,c,false,r,true,true,null);l.addComp(s,1,0,1,1,"left","middle");var _=new $t.Label(a,0,0,r,"Point Size");l.addComp(_,0,2,1,1,"left","middle");var o=new $t.ComboBox(a,0,0,JV(100),c+e,false,c,false,r,true,true,null);l.addComp(o,1,2,1,1,"left","middle",0,0,JV(10));var u=nX(true,null,s);var T=u.length;var A=Ls;if(k_>=0&&(W_[k_].TypeFace==null||W_[k_].TypeFace.length==0))zs="";else{for(i=0;i<T;i++){var E=u[i];if(k_<0&&E==xs[A].TypeFace)break;if(k_>=0&&E==W_[k_].TypeFace)break}if(i<T){s.setSelectedIndex(i)}if(k_<0)zs=xs[A].TypeFace;else zs=W_[k_].TypeFace}if(k_>=0)Zs=W_[k_].TwipsSize;else Zs=xs[A].TwipsSize;var R=aX(true,null,o,zs,Zs);var L=Zs;var C=L/20;PointText=XX(C.toString()," ",2);if(L>C*20)PointText+=".5";T=R.length;for(i=0;i<T;i++){var I=R[i];if(I==PointText)break}if(i<T){o.setSelectedIndex(i)}l.show();s.setFocus();function d(t,e,r){if(t=="Cancel"){l.hide();return}else if(t=="OK"){zs=s.getText();var i=o.getText();Zs=CX(i)*20;l.hide();if(f)f(zs,Zs)}}}function WQ(t,e,r,i){var f,l,a,n,c;var s=[];SI=oI=0;_P=(new tc.ClsListLevel).init();if(!t)e=r;f=e.getSelectedIndex();if(e.getItemAt(f)==null)return false;l=e.getValueAt(f);c=Kc[l].LevelCount;s=Kc[l].level;SI=l;if(s==null)return false;f=i.getSelectedIndex();if(i.getItemAt(f)==null)return false;n=i.getValueAt(f);if(n>=c)return false;oI=n;_P=s[n];return true}function UQ(t,e,r){var i,f,l;var a=[20];var n=[20];i=0;n[i]=tc.LIST_DEC;a[i]="Decimal";i++;n[i]=tc.LIST_UPR_ROMAN;a[i]="Uppercase Roman letters";i++;n[i]=tc.LIST_LWR_ROMAN;a[i]="Lowercase Roman letters";i++;n[i]=tc.LIST_UPR_ALPHA;a[i]="Uppercase alphabets";i++;n[i]=tc.LIST_LWR_ALPHA;a[i]="Lowercase alphabets";i++;n[i]=tc.LIST_CARDINAL;a[i]="Cardinal numbering";i++;n[i]=tc.LIST_ORDINAL_TEXT;a[i]="Ordinal text numbering";i++;n[i]=tc.LIST_DEC_PAD;a[i]="Decimal padded";i++;n[i]=tc.LIST_BLT;a[i]="Bullet";i++;n[i]=tc.LIST_NO_NUM;a[i]="Hidden";i++;n[i]=tc.LIST_KANJI_NUM;a[i]="Kanji";i++;n[i]=tc.LIST_CHINESE_NUM;a[i]="Chinese";i++;n[i]=tc.LIST_CHINESE_ZOD;a[i]="Chinese tc.ZOD";i++;n[i]=tc.LIST_CHINESE_DBL;a[i]="Chinese Double";i++;n[i]=tc.LIST_HEBREW;a[i]="Hebrew";i++;l=i;var c=0;if(r){var s=[];var _=[];for(i=0;i<l;i++){s.push(a[i]);_.push(n[i]);if(n[i]==e)c=i}t.setItems(s,_,c,false)}else{c=t.getSelectedIndex();if(t.getItemAt(c)==null)return 0;e=t.getValueAt(c)}return e}function kQ(t,e,r){var i,f,l;var a=[20];var n=[20];i=0;n[i]=tc.LISTAFT_TAB;a[i]="Tab";i++;n[i]=tc.LISTAFT_SPACE;a[i]="Space";i++;n[i]=tc.LISTAFT_NONE;a[i]="None";i++;l=i;if(r){var c=[];var s=[];for(i=0;i<l;i++){c.push(a[i]);s.push(n[i]);if(n[i]==e)CurIdx=i}t.setItems(c,s,CurIdx,false)}else{CurIdx=t.getSelectedIndex();if(t.getItemAt(CurIdx)==null)return 0;e=t.getValueAt(CurIdx)}return e}_i.TerGetListLine=function(t){var e,r=-1;var i=0,f=0,l,a;if(!lv||!QD())_i.TerCreateControl();if(t<0)t=br;if(Nj(Nc[ui[t].pfmt].flags&tc.BULLET))return-1;for(e=t-1;e>=0;e--){if(Dj(Nc[ui[e].pfmt].flags&tc.BULLET))continue;if((l=Nc[ui[e].pfmt].BltId)==0)break;if((a=xc[l].ls)==0)break;i=Jc[a].ListIdx;r=e;f=Nc[ui[e].pfmt].LeftIndentTwips;break}if(i==0)return-1;if(f!=Nc[ui[t].pfmt].LeftIndentTwips)return-1;for(e=t+1;e<Ri;e++){if(Dj(Nc[ui[e].pfmt].flags&tc.BULLET))continue;if((l=Nc[ui[e].pfmt].BltId)==0)return-1;if((a=xc[l].ls)==0)return-1;return i==Jc[a].ListIdx?r:-1}return-1};_i.TerBulletToText=function(t,e){var r,i,f,l,a;var n,c,s,_,o,u,T;var A;var E;if(!lv||!QD())_i.TerCreateControl();if(!oi.WordWrap)return false;if(!t&&uA==tc.HILIGHT_OFF)return false;i=0;f=Ri-1;if(!t){ON();i=sA;f=_A}for(r=f;r>=i;r--){if(Dj(ui[r].flags&tc.LFLAG_PARA_FIRST))continue;n=ui[r].pfmt;c=Nc[n].BltId;if(c==0&&Dj(Nc[n].flags&tc.BULLET))continue;CB(Ti,r,n,0,0,0,false);A=ns;s=Ls;if(A.length==0)continue;if(Nj(xs[s].style&tc.HIDDEN))s=Db(s,tc.HIDDEN,false);if(xs[s].ParaStyId!=Nc[n].StyId)s=Bb(s,1,Nc[n].StyId);_i.SetTerCursorPos(r,0,false);_i.TerInsertText(A,s,n,false);T=A.length;A="";a=4-T;c=Nc[n].BltId;o=xc[c].ls;if(o==0){A+="\t"}else{var R;if((R=sQ(o,xc[c].lvl))!=null){if(R.CharAft==tc.LISTAFT_TAB){var L;A+="\t";if((L=Nc[n].TabId)>0){if(B_[L].count>0){var C=B_[L].count;if(B_[L].pos[C-1]>Nc[n].LeftIndentTwips)A+="\t"}}}else if(R.CharAft==tc.LISTAFT_SPACE){for(u=0;u<a;u++)A+=" ";A+=" "}else if(R.CharAft==tc.LISTAFT_NONE){for(u=0;u<a;u++)A+=" ";T=A.length;if(T>0&&Uk(A)[T-1]!=tc.CHAR_SPACE)A+=" "}}}if(xs[s].CharSet==tc.SYMBOL_CHARSET)s=xb(s,xs[0].TypeFace,xs[0].CharSet,xs[0].lang);_i.TerInsertText(A,s,n,false);E=cj(Nc[n].flags,tc.BULLET);_=ZZ(n,Nc[n].LeftIndentTwips,Nc[n].RightIndentTwips,Nc[n].FirstIndentTwips,Nc[n].TabId,0,Nc[n].AuxId,Nc[n].Aux1Id,Nc[n].StyId,Nc[n].shading,Nc[n].pflags,Nc[n].SpaceBefore,Nc[n].SpaceAfter,Nc[n].SpaceBetween,Nc[n].LineSpacing,Nc[n].BkColor,Nc[n].BorderSpaceLeft,Nc[n].flow,E);for(l=r;l<Ri;l++){if(ui[l].pfmt==n)ui[l].pfmt=_;if(Nj(ui[l].flags&tc.LFLAG_PARA))break}}if(e){if(oi.PageMode)_i.TerRepaginate(true);else cG()}return true};_i.TerGetParaAux1Id=function(t){if(!lv||!QD())_i.TerCreateControl();if(t<0||t>=Dc)return 0;return Nc[t].Aux1Id};_i.TerSetNextParaAux1Id=function(t){if(!lv||!QD())_i.TerCreateControl();a_=t;return true};_i.TerSetParaAuxId=function(t,e,r){var i;if(!lv||!QD())_i.TerCreateControl();if(!oi.WordWrap)return false;if(t<0){jZ();t=zC;e=iI}if(!Y_)V8(t,0,e,0,"P".charCodeAt(0));for(i=t;i<=e;i++){if(!pm(i))continue;ui[i].pfmt=ZZ(ui[i].pfmt,Nc[ui[i].pfmt].LeftIndentTwips,Nc[ui[i].pfmt].RightIndentTwips,Nc[ui[i].pfmt].FirstIndentTwips,Nc[ui[i].pfmt].TabId,Nc[ui[i].pfmt].BltId,r,Nc[ui[i].pfmt].Aux1Id,Nc[ui[i].pfmt].StyId,Nc[ui[i].pfmt].shading,Nc[ui[i].pfmt].pflags,Nc[ui[i].pfmt].SpaceBefore,Nc[ui[i].pfmt].SpaceAfter,Nc[ui[i].pfmt].SpaceBetween,Nc[ui[i].pfmt].LineSpacing,Nc[ui[i].pfmt].BkColor,Nc[ui[i].pfmt].BorderSpaceLeft,Nc[ui[i].pfmt].flow,Nc[ui[i].pfmt].flags)}oi.modified++;return true};_i.TerSetParaId=function(t,e,r){var i;if(!lv||!QD())_i.TerCreateControl();if(!oi.WordWrap)return false;if(r<0||r>=Dc)return false;if(t<0){jZ();t=zC;e=iI}if(!Y_)V8(t,0,e,0,"P".charCodeAt(0));for(i=t;i<=e;i++)ui[i].pfmt=r;oi.modified++;return true};_i.TerSetDefTabWidth=function(t,e){var r;if(!lv||!QD())_i.TerCreateControl();if(t<tc.RULER_TOLERANCE)t=tc.RULER_TOLERANCE;r=m_;m_=t;if(e)cG();return r};_i.TerGetParaInfo=function(t){return _i.TerGetParaInfo2(t)};_i.TerGetParaInfo2=function(t){return _i.TerGetParaInfo3(t,false)};_i.TerGetParaInfo3=function(t,e){return _i.TerGetParaInfo4(t,e)};_i.TerGetParaInfo4=function(t,e){var r=0,i=-1;if(!lv||!QD())_i.TerCreateControl();NI=DI=MI=GI=BI=HI=mI=UI=kI=XI=KI=0;wI=YI=VI=0;WP=tc.CLR_WHITE;if(e){if(t==tc.SID_CUR)i=k_;else i=t;if(i<0||i>=X_)return false}else{if(t<0){r=-t;if(r>=Dc)r=0}else{if(t>=Ri)return false;r=ui[t].pfmt}if(r<0||r>=Dc)return false}if(i<0){NI=Nc[r].LeftIndentTwips;DI=Nc[r].RightIndentTwips;MI=Nc[r].FirstIndentTwips;GI=Nc[r].TabId;BI=Nc[r].StyId;HI=Nc[r].AuxId;mI=Nc[r].shading;wI=Nc[r].pflags;UI=Nc[r].SpaceBefore;kI=Nc[r].SpaceAfter;XI=Nc[r].SpaceBetween;KI=Nc[r].LineSpacing;YI=Nc[r].flags;VI=Nc[r].Aux1Id;WP=Nc[r].BkColor}else{NI=W_[i].LeftIndentTwips;DI=W_[i].RightIndentTwips;MI=W_[i].FirstIndentTwips;GI=W_[i].TabId;BI=i;HI=0;mI=W_[i].shading;wI=W_[i].pflags;UI=W_[i].SpaceBefore;kI=W_[i].SpaceAfter;XI=W_[i].SpaceBetween;KI=W_[i].LineSpacing;YI=W_[i].ParaFlags;VI=0;WP=W_[i].ParaBkColor}return true};_i.TerGetParaParam=function(t,e,r){var i=0,f=-1;if(!lv||!QD())_i.TerCreateControl();if(e){if(t==tc.SID_CUR)f=k_;else f=t;if(f<0||f>=X_)return tc.PARAINFO_ERROR}else{if(t<0){i=-t;if(i>=Dc)i=0}else{if(t>=Ri)return tc.PARAINFO_ERROR;i=ui[t].pfmt}if(i<0||i>=Dc)return tc.PARAINFO_ERROR}switch(r){case tc.PARAINFO_TEXT_FLOW:return f<0?Nc[i].flow:0;case tc.PARAINFO_SPC_BEF:return f<0?Nc[i].SpaceBefore:W_[f].SpaceBefore;case tc.PARAINFO_SPC_AFT:return f<0?Nc[i].SpaceAfter:W_[f].SpaceAfter;case tc.PARAINFO_SPC_BET:return f<0?Nc[i].SpaceBetween:W_[f].SpaceBetween;case tc.PARAINFO_LINE_SPACE:{var l=f<0?Nc[i].LineSpacing:W_[f].LineSpacing;if(l==0){if(f<0&&Nj(Nc[i].flags&tc.DOUBLE_SPACE))l=100;if(f>=0&&Nj(W_[f].ParaFlags&tc.DOUBLE_SPACE))l=100}if(l>0)return l+100;break}case tc.PARAINFO_FLAGS:return f<0?Nc[i].flags:0;case tc.PARAINFO_HEADING_LEVEL:{var a=f,n=0;if(f<0)a=Nc[i].StyId;if(W_[a].name.indexOf("heading")>=0){var c="heading 1".length;if(W_[a].name.length==c){var s=Uk(W_[a].name);var _=s[c-1];n=_-tc.CHAR_0}}return n}}return tc.PARAINFO_ERROR};_i.TerGetParaParamClr=function(t,e,r){var i=0,f=-1;if(!lv||!QD())_i.TerCreateControl();UP=tc.CLR_AUTO;if(e){if(t==tc.SID_CUR)f=k_;else f=t;if(f<0||f>=X_)return false}else{if(t<0)i=-t;else{if(t>=Ri)return false;i=ui[t].pfmt}if(i<0||i>=Dc)return false}switch(r){case tc.PARAINFO_BORDER_COLOR:UP=f<0?Nc[i].BorderColor:W_[f].ParaBorderColor;return true;case tc.PARAINFO_BK_COLOR:UP=f<0?Nc[i].BkColor:W_[f].ParaBkColor;return true}return false};function XQ(t){var e=_i.cvs.style.cursor;_i.cvs.style.cursor=t;if(t!=U&&BS!=null&&!HS)KQ(false);return e}function KQ(t,e){var r=document.body||document.documentElement;if(BS==null&&t){var i=tc.GetElementPosition(_i.cvs);var f=i.x+_i.cvs.width/2;var l=i.y+_i.cvs.height/2;var a=_i.cvs.width/3;BS=document.createElement("div");BS.style.position="absolute";BS.style.left=(f-a/2).toString()+"px";BS.style.top=l.toString()+"px";BS.style.width=a.toString()+"px";BS.style.height="1px";BS.style.backgroundColor="#fff";BS.style.zIndex="10000";BS.style.visibility="hidden";BS.align="center";var n=document.createElement("img");if(tg.ResourceUrl!="")n.src=tg.ResourceUrl+"/wait.gif";else n.src="wait.gif";BS.appendChild(n);var c=document.createElement("span");c.style.color="green";c.style.font="20px Arial";if(e!=undefined&&e!=null&&e.length>0)c.innerHTML=nk(e);else c.innerHTML=nk("Working, Please Wait");BS.appendChild(c);r.appendChild(BS)}if(t&&BS!=null){BS.style.visibility="visible"}if(!t&&BS!=null){BS.style.visibility="hidden";r=document.body||document.documentElement;r.removeChild(BS);BS=null;HS=false}}function YQ(t,e,r,i){var I,f,l;var a=document.body||document.documentElement;if(mS[e]==null&&t){I=tc.GetElementPosition(_i.cvs);f=I.x+r-tc.TEXT_HANDLE_WIDTH/2;l=I.y+i;var n=tc.TEXT_HANDLE_WIDTH;var c=tc.TEXT_HANDLE_HEIGHT;mS[e]=document.createElement("div");mS[e].style.position="absolute";mS[e].style.left=f.toString()+"px";mS[e].style.top=l.toString()+"px";mS[e].style.width=n.toString()+"px";mS[e].style.height=c.toString()+"px";mS[e].style.backgroundColor="#ffffff00";mS[e].style.zIndex="10000";mS[e].style.margin="0px";mS[e].style.padding="0px";mS[e].style.userSelect="none";mS[e].style.WebkitUserSelect="none";mS[e].style.msUserSelect="none";if(_i.InAdroid){var s=document.createElement("img");if(tg.ResourceUrl!="")s.src=tg.ResourceUrl+"/texthandle.gif";else s.src="texthandle.gif";s.style.width=n.toString()+"px";s.style.height=c.toString()+"px";s.style.margin="0px";s.style.padding="0px";s.style.userSelect="none";s.style.WebkitUserSelect="none";s.style.msUserSelect="none";s.style.WebkitTouchCallout="none";s.style.khtmlUserSelect="none";s.style.mozUserSelect="none";mS[e].appendChild(s)}else{if(tg.ResourceUrl!="")mS[e].style.backgroundImage="url('"+tg.ResourceUrl+"/texthandle.gif')";else mS[e].style.backgroundImage="url('texthandle.gif')";mS[e].style.backgroundSize="100% 100%"}a.appendChild(mS[e]);VQ(e);var _=0;mS[e].addEventListener("mousemove",TextHandleEvents[e][_]=function(t){o(t,te,e)});_++;mS[e].addEventListener("mouseup",TextHandleEvents[e][_]=function(t){o(t,te,e)});_++;mS[e].addEventListener("mousedown",TextHandleEvents[e][_]=function(t){o(t,te,e)});_++;mS[e].addEventListener("mouseout",TextHandleEvents[e][_]=function(t){o(t,te,e)});_++;mS[e].addEventListener("mouseleave",TextHandleEvents[e][_]=function(t){o(t,te,e)});_++;mS[e].addEventListener("mouseover",TextHandleEvents[e][_]=function(t){o(t,te,e)});_++;mS[e].addEventListener("touchstart",TextHandleEvents[e][_]=function(t){o(t,te,e)});_++;mS[e].addEventListener("touchend",TextHandleEvents[e][_]=function(t){o(t,te,e)});_++;mS[e].addEventListener("touchcancel",TextHandleEvents[e][_]=function(t){o(t,te,e)});_++;mS[e].addEventListener("touchmove",TextHandleEvents[e][_]=function(t){o(t,te,e)});_++}if(t&&mS[e]!=null){I=tc.GetElementPosition(_i.cvs);f=I.x+r-tc.TEXT_HANDLE_WIDTH/2;l=I.y+i;mS[e].style.left=f.toString()+"px";mS[e].style.top=l.toString()+"px";mS[e].style.visibility="visible";if(bS){clearInterval(bS);bS=null}wS=false;if(e==tc.CURSOR_HANDLE_IDX){bS=setInterval(d,5e3)}else{if(mS[tc.CURSOR_HANDLE_IDX]!=null)mS[tc.CURSOR_HANDLE_IDX].style.visibility="hidden"}}if(!t&&mS[e]!=null){mS[e].style.visibility="hidden";a=document.body||document.documentElement;a.removeChild(mS[e]);VQ(e);mS[e]=null;HS=false}function d(){if(mS[tc.CURSOR_HANDLE_IDX]!=null)mS[tc.CURSOR_HANDLE_IDX].style.visibility="hidden";wS=false;if(bS){clearInterval(bS);bS=null}}function o(t,e,r){var i;var f,l,a,n,c,s,_,o,u;if(Nr)return false;var T=document.getElementById(e);if(T==null)return;var A=$t.GetTerData(e);if(!A)return;if(A.DlgLevel>0)return;if(!oi.open)return;t.preventDefault();if(t.type=="touchstart"){yS[r]=t.touches[0].clientX;WS[r]=t.touches[0].clientY;i=mS[r].style.left;c=i.indexOf("px");i=cV(i,0,c);US[r]=LX(i);i=mS[r].style.top;c=i.indexOf("px");i=cV(i,0,c);kS[r]=LX(i);o=s=br;u=_=jt}else if(t.type=="mouseover"){if(r==tc.CURSOR_HANDLE_IDX){clearInterval(bS);bS=setInterval(d,1e4)}}else if(t.type=="mouseup"||t.type=="mouseout"||t.type=="mouseleave"||t.type=="touchend"||t.type=="touchcancel"){if(document.activeElement!=A.cvs){if(A.UseVirtKeyboard)A.VirtTextarea.focus({preventScroll:true});else A.cvs.focus({preventScroll:true});if(r==tc.SEL_BEG_HANDLE_IDX||r==tc.SEL_END_HANDLE_IDX)cG();if(t.type=="touchend"&&r==tc.CURSOR_HANDLE_IDX&&o==s&&u==_){sM(t);Sa.shiftKey=false;Ua=true}}}else if(t.type=="mousemove"||t.type=="touchmove"){var E=t.buttons===undefined?t.which===1:t.buttons===1;if(E||t.type=="touchmove"){xS=(new Date).getTime();if(r==tc.CURSOR_HANDLE_IDX){clearInterval(bS);bS=setInterval(d,1e4)}if(t.type=="mousemove"){i=mS[r].style.left;c=i.indexOf("px");i=cV(i,0,c);a=f=LX(i)+t.movementX;i=mS[r].style.top;c=i.indexOf("px");i=cV(i,0,c);n=l=LX(i)+t.movementY}else{a=f=US[r]+(t.touches[0].clientX-yS[r]);n=l=kS[r]+(t.touches[0].clientY-WS[r])}mS[r].style.left=f.toString()+"px";mS[r].style.top=l.toString()+"px";I=tc.GetElementPosition(A.cvs);a-=I.x;a+=tc.TEXT_HANDLE_WIDTH/2;n-=I.y;A.TerPixToTextPos(tc.REL_WINDOW,a,n-4,false);s=PC;_=SC;if(r==tc.CURSOR_HANDLE_IDX){A.SetTerCursorPos(s,_,true)}else if(r==tc.SEL_BEG_HANDLE_IDX){var R=Ft,L=Gt;if(sA!=s||TA!=_){sA=s;TA=_;cG();if(R==Ft&&L==Gt){mS[r].style.left=f.toString()+"px";mS[r].style.top=l.toString()+"px"}}A.ForgetMouseUp=true}else if(r==tc.SEL_END_HANDLE_IDX){var C=_A;if(_A!=s||AA!=_){_A=br=s;AA=jt=_;cG();if(C==_A)mS[r].style.left=f.toString()+"px"}A.ForgetMouseUp=true}}}}}function VQ(t){var e;for(e=0;e<TextHandleEvents[t].length;e++){var r=0;mS[t].removeEventListener("mousemove",TextHandleEvents[t][r]);r++;mS[t].removeEventListener("mouseup",TextHandleEvents[t][r]);r++;mS[t].removeEventListener("mousedown",TextHandleEvents[t][r]);r++;mS[t].removeEventListener("mouseout",TextHandleEvents[t][r]);r++;mS[t].removeEventListener("mouseleave",TextHandleEvents[t][r]);r++;mS[t].removeEventListener("mouseover",TextHandleEvents[t][r]);r++;mS[t].removeEventListener("touchstart",TextHandleEvents[t][r]);r++;mS[t].removeEventListener("touchend",TextHandleEvents[t][r]);r++;mS[t].removeEventListener("touchcancel",TextHandleEvents[t][r]);r++;mS[t].removeEventListener("touchmove",TextHandleEvents[t][r]);r++}TextHandleEvents[t]=[];return true}function jQ(){var t;for(t=0;t<tc.TEXT_HANDLE_COUNT;t++){if(mS[t]!=null&&document.activeElement==mS[t])return t}return-1}function JQ(){return _i.cvs.style.cursor}_i.TerTextPosToPix=function(t,e,r){var i,f;if(!lv||!QD())_i.TerCreateControl();td=ed=0;if(t!=tc.REL_WINDOW&&t!=tc.REL_TEXT_BOX)return false;if(e<0){e=br;r=jt}if(r<0){Cq(e);e=PC;r=SC}i=Fq(r,e,tc.LEFT)-Ft;f=Pq(e)-Gt;if(Nj(ui[e].flags2&tc.LFLAG2_RTL)){var l,a=pf;vf=Mq(e,null,-1);a=Dd;pf=a;if(pf>0){if((l=iW(e))>=0){Nf=Vq(e,r,pf,vf);i=E$(i,0,l,vf[Nf]);if(i>=je)i--}pf=0}}if(t==tc.REL_WINDOW){i+=rt.left;f+=rt.top}td=i;ed=f;return true};_i.TerPixToTextPos=function(t,e,r,i){var f;var l;if(!lv||!QD())_i.TerCreateControl();PC=SC=0;if(t!=tc.REL_WINDOW&&t!=tc.REL_TEXT_BOX)return false;if(t==tc.REL_WINDOW){e-=rt.left;r-=rt.top}e+=Ft;r+=Gt;var a=aO;var n=nO;aO|=tc.TOFLAG_SET_MOUSE_ON_TEXT_LINE;nO|=tc.TOFLAG2_CHECK_DISABLED_FRAMES;f=Jq(e,r);aO=a;nO=n;l=Sq(e,r,f);if(i){f=Lq(f,l);l=-1}PC=f;SC=l;return true};_i.TerPosLineAtTop=function(t,e){var r,i;if(!lv||!QD())_i.TerCreateControl();if(t<0||t>=Ri)return false;br=fr=t;we=0;jt=0;if(!oi.PageMode){if(!e){we=Dt/2;fr=br-we;if(fr<0)fr=0}cG();return true}Lo=cz(br);my(true);r=Pq(br);if(!e){r-=Mt/2;if(r<0)r=0}if(Lo==qe+1)i=Ze;else i=0;if(Li&&e&&Lo==To-1&&r-i+Mt>uz(Lo)){r=uz(Lo)-Mt+i;if(r<0)r=0}if(r!=Gt){Gt=r;BG()}cG();return true};_i.TerPosBodyText=function(t,e,r){var i;var f,l;if(!lv||!QD())_i.TerCreateControl();if(e!=tc.POS_BEG&&e!=tc.POS_END)return false;f=0;i=0;while(f<t){while(i<Ri){if(Nj(ui[i].tabw)&&Nj(ui[i].tabw.type&tc.INFO_SECT)){f++;i++;break}i++}if(i==Ri)break}if(i==Ri)return false;for(;i<Ri;i++)if(Dj(Nc[ui[i].pfmt].flags&tc.PAGE_HDR_FTR))break;if(i==Ri)return false;if(e==tc.POS_BEG){_i.SetTerCursorPos(i,0,r);return true}for(;i<Ri;i++)if(Nj(ui[i].tabw)&&Nj(ui[i].tabw.type&tc.INFO_SECT))break;if(i==Ri)i--;if(i>=0){l=ui[i].len-1;if(l<0)l=0;_i.SetTerCursorPos(i,l,r);return true}return false};_i.TerGetCaretPos=function(){if(!lv||!QD())_i.TerCreateControl();if(VR)return Lq(br,jt);else return lL};_i.TerSetCaretPos=function(t){if(!lv||!QD())_i.TerCreateControl();if(VR)_i.SetTerCursorPos(t,-1,false);else lL=t;return true};_i.TerGetVisibleCol=function(t,e){var r;var i=0,f,l;var a=-1;var n=false;if(!lv||!QD())_i.TerCreateControl();if(t<0)t=br;if(e<0)e=jt;if(t>=Ri)return-1;r=nb(t);l=ui[t].len;if(e>=l)e=l-1;i=0;for(f=0;f<e;f++){if(r[f]!=a)n=!um(r[f]);a=r[f];if(n)i++}sb(t);return i};_i.SetTerCursorPos=function(t,e,r){var i;var f;if(!lv||!QD())_i.TerCreateControl();if(e<0){i=t;Cq(i);t=PC;e=SC}if(t>=Ri||t<0){t=Ri-1;e=ui[t].len;if(oi.WordWrap)e--;if(e<0)e=0}if(e>ui[t].len)e=ui[t].len;if(e<0)e=0;if(!VR)nq(-1);br=t;jt=e;f=Mt/xs[0].height;if(br-fr>=f||br-fr<0){fr=br-f/2;if(fr<0)fr=0}we=br-fr;if(r){cG();if(_l)zQ()}return true};function zQ(){if(el==null){el=window.setInterval(xp,1)}return true}function ZQ(){Xi=true;if(rl==null){rl=window.setInterval(yp,1)}return true}function QQ(t){window.setTimeout(function(){_i.TerCommand(t)},1);return true}function qQ(t,e,r){if(t==tc.WM_COMMAND||t==tc.TER_WM_COMMAND)QQ(e);return true}_i.GetTerCursorPos=function(t){var e=0;if(!lv||!QD())_i.TerCreateControl();if(t==-1){e=Lq(br,jt)}else{e=br;t=jt}PC=e;SC=t;return true};_i.TerGetLineCol=function(t,e,r){if(!_i.TerCreateControl())return false;if(e<0){PC=br;SC=jt}if(e>=Ri)return false;if(r<0||r>=ui[e].len)return false;if(t&&e==Ri-1&&r>=ui[e].len-1)return false;if(!t&&e==0&&r<=0)return false;if(t)Rm(e,r);else Em(e,r);return true};function $Q(t,e){Ga=t.clientX;Ba=t.clientY;Ga=Ga-_i.cvs.getBoundingClientRect().left-_i.cvs.clientLeft+_i.cvs.scrollLeft;Ba=Ba-_i.cvs.getBoundingClientRect().top-_i.cvs.clientTop+_i.cvs.scrollTop;Ga=JV(Ga);Ba=JV(Ba);return tq(e)}function tq(t){var e,r,i,f;var l=new tc.Point;var a,n;ya=tc.CHAR_SPACE;Wa=0;Da=br;Ma=jt;Ir=false;KE=-1;aO=oj(tc.TOFLAG_CURS_ON_TABLE_TOP);aO=oj(tc.TOFLAG_X_BEFORE_LINE);e=Ga;r=Ba;if(!OA&&!oi.ReadOnly){if(oi.ruler&&(e>=k.left&&e<=k.right&&r>=k.top&&r<=k.bottom))Ir=true;l.x=e-rt.left+Ft;l.y=r-rt.top+Gt;iq(l);KE=GC;YE=BC}if(e<rt.left){ya="L".charCodeAt(0);Wa=rt.left-e}if(e>rt.right){ya=tc.CHAR_R;Wa=e-rt.right}if(r<rt.top){ya="T".charCodeAt(0);Wa=rt.top-r}if(r>rt.bottom){ya=tc.CHAR_B;Wa=r-rt.bottom}if(e<rt.left)e=rt.left;e=e-rt.left+Ft;r=r-rt.top+Gt;aO|=tc.TOFLAG_SET_MOUSE_ON_TEXT_LINE;Da=Jq(e,r);oj(tc.TOFLAG_SET_MOUSE_ON_TEXT_LINE);if(Da>=Ri)Da=Ri-1;if(Ha>=0&&Ha<Dl)n=pl[Ha].ParaFrameId;else n=ui[Da].fid;if(n>0&&KE>=0){if(Nj(kl[n].flags&tc.PARA_FRAME_LINE)&&(XE[KE].type!=tc.DRAG_TYPE_FRAME_SIZE&&XE[KE].type!=tc.DRAG_TYPE_FRAME_MOVE))KE=-1}if(ya==tc.CHAR_SPACE&&oi.PageMode&&ui[Da].cid>0&&(Da==0||ui[Da-1].cid!=ui[Da].cid&&s6(eR[ui[Da].cid].row))&&(i=iW(Da))>0&&(e>=pl[i].x&&e<=pl[i].x+pl[i].width)){if(Math.abs(pl[i].y-r)<dV(tc.RULER_TOLERANCE)){var c=ui[Da].cid;if(!Li||Nj(eR[c].border&tc.BORDER_TOP))aO|=tc.TOFLAG_CURS_ON_TABLE_TOP}}if(t&&oi.PageMode){if(Lo==qe&&r>=Ze&&Lo+1<To)Lo++;else if(Lo==qe+1&&r<Ze&&Lo>0)Lo--}if((i=iW(Da))>=0&&pl[i].ScrLastLine>=0&&Da>pl[i].ScrLastLine&&ya==tc.CHAR_SPACE)ya=tc.CHAR_B;f=hq(e,r,Da);if(Da>=fr&&Da-fr<Dt&&f<f$(Da)){Ma=-1;aO|=tc.TOFLAG_X_BEFORE_LINE}else if(Ha>=0&&Ha<Dl&&pl[Ha].ParaFrameId>0){n=pl[Ha].ParaFrameId;var s=kl[n].pict,_,o;var u;u=nb(Da);o=ui[Da].len;for(_=0;_<o;_++)if(u[_]==s)break;if(_<o)Ma=_;else Ma=0}else Ma=Oq(f,Da);if(Ma>=0){a=ib(Da,Ma);if(Dj(xs[a].style&tc.PICT)&&!oU(a)){var T=Fq(Ma,Da,tc.TER_CENTER);if(f>T)Ma++}}if(Ma>=ui[Da].len){Ma=ui[Da].len;if(oi.WordWrap)Ma--}if(Ma<0)Ma=0;return true}function eq(t,e){var r,i,f=-1,l=0,a,n,c=0;var s=new tc.Point;var _=null;if(Nj(Zh&tc.TFLAG2_NO_CURSOR_CHANGE)||!_l)return true;if(!e&&Bh&&OA)return true;Ga=t.clientX;Ba=t.clientY;Ga=Ga-_i.cvs.getBoundingClientRect().left-_i.cvs.clientLeft+_i.cvs.scrollLeft;Ba=Ba-_i.cvs.getBoundingClientRect().top-_i.cvs.clientTop+_i.cvs.scrollTop;Ga=JV(Ga);Ba=JV(Ba);s.x=Ga-rt.left+Ft;s.y=Ba-rt.top+Gt;if(!e&&!oi.ReadOnly){iq(s);KE=f=GC;YE=l=BC}if(f>=0){if(XE[f].type==tc.DRAG_TYPE_CELL||XE[f].type==tc.DRAG_TYPE_ROW_INDENT){_=yf}else if(XE[f].type==tc.DRAG_TYPE_ROW){_=Uf}if(XE[f].type>=tc.DRAG_TYPE_RULER_BEGIN&&XE[f].type<=tc.DRAG_TYPE_RULER_END){if(XE[f].type!=tc.DRAG_TYPE_TAB_TYPE){if(XE[f].type==tc.DRAG_TYPE_RULER_TAB)_="ew-resize";else _="ew-resize"}}if(XE[f].type==tc.DRAG_TYPE_PICT_SIZE||XE[f].type==tc.DRAG_TYPE_FRAME_SIZE||XE[f].type==tc.DRAG_TYPE_CTL_SIZE){if(XE[f].type==tc.DRAG_TYPE_FRAME_SIZE&&Nj(kl[XE[f].id1].flags&tc.PARA_FRAME_LINE))_="crosshair";else if(l==tc.DRAG_HOT_LEFT||l==tc.DRAG_HOT_RIGHT)_="ew-resize";else if(l==tc.DRAG_HOT_TOP||l==tc.DRAG_HOT_BOT)_="ns-resize";else if(l==tc.DRAG_HOT_TL||l==tc.DRAG_HOT_BR)_="nw-resize";else _="ne-resize"}if(XE[f].type==tc.DRAG_TYPE_FRAME_MOVE)_="move"}else{$Q(t,false);if(-1==(a=iW(Da)))return true;if(oi.PageMode&&Da>=0&&Da<Ri){var o=ui[Da].cid;c=eR[o].row}if(Ka&&!e&&za!=null){_=za;KE=-1;Ir=false}else if(Xr&&!Vr&&!e){if(ya!=tc.CHAR_SPACE&&Wa>xs[0].height*3/2)_=jf;else{var u=Sa.isControlDown();_=u?Vf:Yf}Ir=false;KE=-1}else if(!e&&Nj(aO&tc.TOFLAG_CURS_ON_TABLE_TOP))_=Wf;else if(vh&&!e&&Dj(aO&tc.TOFLAG_X_BEFORE_LINE)){if(!Ir&&KE<0){var T=ib(Da,Ma);if(TU(T,false,true))_=Xf}Ir=false;KE=-1}else if(Sa.ctrlKey&&KE==-1&&!Ir&&!e&&Dj(aO&tc.TOFLAG_X_BEFORE_LINE)){if(CU(false,Da,Ma))_=Xf}if(_==null){if(oi.ReadOnly)_="default";else if(s.y<Gt||s.y>Gt+Mt)_="default";else if(s.x<pl[a].x+Nc[ui[Da].pfmt].LeftIndent)_="default";else if(s.x<pl[a].x+pl[a].width-Nc[ui[Da].pfmt].RightIndent){if(gm())_="default";else{n=ib(Da,Ma);if(Nj(xs[n].style&tc.PROTECT))_="default";else if(Dj(xs[n].style&tc.PICT)){if(I$(a)>0)_=Qf;else _="text"}}}}}if(f<0&&!Xa&&_!=za)_=null;if(_h>=0)_=qf;else if(Ah)_=$f;if(_!=null)XQ(_);else XQ("default");Bh=_==Wf;Hh=_==Xf;return true}function rq(){while(Nj(xs[ib(br,jt)].style&tc.HIDDEN)){MT=tc.CURS_BACKWARD;if(jt+1<ui[br].len)jt++;else{if(br+1<Ri){br++;jt=0}else break}}return true}function iq(t){var e,r,i=-1;var f=false;GC=BC=-1;for(e=0;e<VE;e++){if(XE[e].InUse&&(XE[e].type==tc.DRAG_TYPE_FRAME_MOVE||XE[e].type==tc.DRAG_TYPE_FRAME_SIZE))break}if(e<VE)f=true;t:while(true){i++;for(e=0;e<VE;e++){if(!XE[e].InUse)continue;if(f&&i==0&&XE[e].type!=tc.DRAG_TYPE_FRAME_MOVE&&XE[e].type!=tc.DRAG_TYPE_FRAME_SIZE&&XE[e].type!=tc.DRAG_TYPE_PICT_SIZE)continue;if(XE[e].IsHotPolygon){var l=[];for(r=0;r<XE[e].HotRectCount;r++){l.push(new tc.Point(XE[e].HotRect[r].left,XE[e].HotRect[r].top))}if(LJ(Ti,l,t.x,t.y)){GC=e;BC=0;return true}}else{for(r=0;r<XE[e].HotRectCount;r++){var a=YY(XE[e].HotRect[r]);if(CJ(Ti,a,t.x,t.y)){GC=e;BC=r;return true}}}}if(f&&i==0)continue t;break}return false}function fq(){var t;var e=ui[br].txt;if(ui[br].len==0)return true;t=jt;if(t>=ui[br].len)t=ui[br].len-1;if(t<0)t=0;if(e[t]==tc.CHAR_SPACE)t--;while(t>=0){if(e[t]==tc.CHAR_SPACE)return false;t--}return true}function lq(){var t,e,r=0,i=0,f;var l=15;var a=Ft,n=0;if(oi.WordWrap&&Ft==0&&!M$()){if(oi.PageMode)r=Tz();else r=M9(br,-1);if(r<=je)return}if(!sq()||!VR)return;if(Nj(Qh&tc.TFLAG3_NO_SCROLL)&&Ft==0)return;if(_i.HasTouchScreen&&Ft>=0)return;if(Nj(ui[br].flags2&tc.LFLAG2_RTL)){Tq(br,jt,i);e=td;i=ed;n=2;if(oi.PageMode)r=Tz()+n}else e=Fq(jt,br,tc.LEFT);if(e>=Ft&&e<=Ft+je)return;if(je<=0)t=1;else t=e*2/je;if(t==0)t=1;Ft=(t-1)*(je/2);if(Nj(ui[br].flags2&tc.LFLAG2_RTL)&&(e>je-l||jt<=1||Ft+je>r)&&oi.WordWrap&&oi.PageMode){f=r-je;if(f<0)f=0;if(e>=f&&e<=f+je)Ft=f;Ft++}if(Ft<0)Ft=0;BG();bG(true)}function aq(){var t,e,r,i=0,f;var l,a=false;var n,c;var s;if(Nj(Zh&tc.TFLAG2_NO_ADJUST_CURSOR)||(Nj(aO&tc.TOFLAG_NO_ADJUST_POS)||!VR))return;if(oi.PageMode&&Nj(Qh&tc.TFLAG3_CURSOR_IN_CELL)&&cR>0&&(ui[br].cid!=cR||GY(br,tc.INFO_ROW))){for(n=0;n<Ri;n++)if(ui[n].cid==cR)break;if(n==Ri){cR=0;return}if(br<n){br=n;jt=0;MT=tc.CURS_FORWARD}else{for(;n<Ri;n++)if(ui[n].cid!=cR||GY(n,tc.INFO_ROW))break;n--;if(br>n){br=n;jt=ui[br].len-1;MT=tc.CURS_BACKWARD}}}if(oi.PageMode&&!yR)a=true;t:{if(oi.PageMode&&Nj(ui[br].tabw)&&Nj(ui[br].tabw.type&tc.INFO_ROW))break t;if(Nj(ui[br].flags&tc.LFLAG_HDRS_FTRS))break t;if(a&&Nj(Nc[ui[br].pfmt].flags&tc.PAGE_HDR_FTR))break t;if(Om(br,jt))break t;return}t:{l=hm();e:while(true){c=br;if(l){var _=false;if(oi.PageMode&&yR&&!WR){if(Nj(Nc[ui[br].pfmt].flags&tc.PAGE_HDR)){br=po[Lo].FirstLine;for(;br+1<Ri;br++)if(Dj(Nc[ui[br].pfmt].flags&tc.PAGE_HDR_FTR))break;jt=0;_=true}if(Nj(Nc[ui[br].pfmt].flags&tc.PAGE_FTR)&&Lo+1<To){br=po[Lo+1].FirstLine;_=true}}for(n=br;n<Ri;n++){e=ui[n].len;if(e==0)continue;if(Nj(ui[n].flags&tc.LFLAG_HDRS_FTRS))continue;if(Nj(ui[n].tabw)&&Nj(ui[n].tabw.type&tc.INFO_ROW))continue;if(a&&Nj(Nc[ui[n].pfmt].flags&tc.PAGE_HDR_FTR))continue;s=nb(n);if(n==br)r=jt+1;else r=0;if(_)r=0;for(t=r;t<e;t++){if(!Om(n,t)){if((Zt==tc.ID_DOWN||Zt==tc.ID_PGDN||MT==tc.CURS_DOWN)&&n>vT&&oi.PageMode&&ui[n].x!=ui[br].x){f=Oq(Vt,n);if(f>=t){t=f;if(Om(n,t))continue}else continue}br=n;jt=t;if(Zt==tc.ID_LINE_END&&ui[br].len>0)jt=ui[br].len-1;sb(n);break t}}sb(n)}br=Ri-1;jt=ui[br].len-1;if(jt<0)jt=0;break t}else{if(oi.PageMode&&yR&&!WR){if(Nj(Nc[ui[br].pfmt].flags&tc.PAGE_FTR)){br=po[Lo].LastLine;if(br>=Ri)br=Ri-1;if(br<0)br=0}if(Nj(Nc[ui[br].pfmt].flags&tc.PAGE_HDR)&&Lo>0){br=po[Lo-1].LastLine}}for(n=br;n>=0;n--){if(ui[n]==null)continue;e=ui[n].len;if(e==0)continue;if(Nj(ui[n].flags&tc.LFLAG_HDRS_FTRS))continue;if(Nj(ui[n].tabw)&&Nj(ui[n].tabw.type&tc.INFO_ROW))continue;if(a&&Nj(Nc[ui[n].pfmt].flags&tc.PAGE_HDR_FTR))continue;s=nb(n);if((Zt==tc.ID_UP||Zt==tc.ID_PGUP||MT==tc.CURS_UP)&&n<vT){f=Oq(Vt,n);for(t=f;t<e;t++)if(!Om(n,t))break;if(t>=e){for(t=f;t>=0;t--)if(!Om(n,t))break}if(t>=0){br=n;jt=t;sb(n);break t}else continue}else{if(n==br)r=jt-1;else r=e-1;for(t=r;t>=0;t--){if(!Om(n,t)){br=n;jt=t;sb(n);break t}}sb(n)}}}i++;if(n<0||n==Ri){if(i>=2){if(a){yR=true;a=false}else return}l=!l;break e}break}}if(c==fr){fr=br;we=0}}_i.TerEngageCaret=function(t){if(!lv||!QD())_i.TerCreateControl();if(VR){if(!zR&&sq())_q();return true}return nq(t?-1:0)};function nq(t){var e;var r;if(VR)return true;if(t==tc.ID_PAGE_MODE)return true;if(t==tc.ID_VIEW_HDR_FTR)return true;if(t==tc.ID_EDIT_FNOTE)return true;if(t==tc.ID_TOOL_BAR)return true;if(t==tc.ID_RULER)return true;if(t==tc.ID_STATUS_RIBBON)return true;if(t==tc.ID_SHOW_HIDDEN)return true;if(t==tc.ID_SHOW_PARA_MARK)return true;if(t==tc.ID_SHOW_HYPERLINK_CURSOR)return true;if(t==tc.ID_PRINT)return true;if(t==tc.ID_PRINT_PREVIEW)return true;if((t==tc.ID_COPY||t==tc.ID_CUT)&&uA!=tc.HILIGHT_OFF){var i=sA<=_A?sA:_A;var f=_A>=sA?_A:sA;if(br>=i&&br<=f)return true}VR=true;r=Sa.shiftKey;if(!r||uA!=tc.HILIGHT_OFF){if(t==tc.ID_PGUP)return true;if(t==tc.ID_PGDN)return true}if(t==tc.ID_INSERT_PARA_FRAME)return true;if(t==-1)return true;var l=jt;Cq(lL);e=PC;l=SC;jt=l;if(oi.PageMode){Lo=rL;br=e;cG()}else Iq(e+1);return true}function cq(){if(!VR)return true;lL=Lq(br,jt);rL=Lo;VR=false;return true}function sq(){return(!oi.ReadOnly||Nj(zh&tc.TFLAG_SHOW_CARET)||mh)&&Dj(Zh&tc.TFLAG2_NO_CARET)}function _q(){var t,e,r,i;var f;var l,a;if(!_l)return true;if(!sq()||Ru||!QU()){if(zR)Aq();zR=false;ZR=true;iL=0;return true}if(VR){l=br;r=jt}else{Cq(lL);l=PC;r=SC}e=Pq(l);t=c$(l);s$(l,t,true);i=Sd;if(qq()){var n=Oc;if(Oc<0)Oc=$w();if(Oc>=0&&xs[Oc].BaseHeight!=0){t=xs[Oc].height;e+=yV(ui[l].BaseHt)-xs[Oc].BaseHeight}Oc=n}else e+=i;if(e<Gt){t=t-(Gt-e);e=Gt}if(t+e-Gt>Mt)t=Mt-e+Gt;if(t<=0)t=xs[tc.DEFAULT_CFMT].height;f=rW(l)==0;if((t!=iL||tL!=f)&&!ZR)Aq();iL=t;tL=f;zR=true;if(Eq(l,r)){var c,s;Tq(l,r,e);c=td;s=ed;if(c<=K.right){oq(rt.left+c-Ft,rt.top+s-Gt);if(_i.HasTouchScreen&&wS){YQ(true,tc.CURSOR_HANDLE_IDX,rt.left+c-Ft+1,rt.top+s-Gt+iL-2)}}}return true}function oq(t,e){_i.caret.position(t,e);return true}function uq(){var t=-1,e,r,i=0,f;var l;var a=-1,n;if(!_l||_i.dialog!=null)return true;if(zR){qR=true;if(VR){a=br;i=jt}else{Cq(lL);a=PC;i=SC}e=Pq(a);r=c$(a);s$(a,r,true);f=Sd;if(qq()){var c=Oc;if(Oc<0)Oc=$w();if(Oc>=0&&xs[Oc].BaseHeight!=0){r=xs[Oc].height;e+=yV(ui[a].BaseHt)-xs[Oc].BaseHeight}Oc=c}else e+=f;if(e<Gt){r=r-(Gt-e);e=Gt}if(r+e-Gt>Tt)r=Tt-e+Gt;l=rW(a)==0;if(iL!=r||tL!=l)_q();if(Eq(a,i)){var s,_;Tq(a,i,e);s=td;_=ed;oq(rt.left+s-Ft,rt.top+_-Gt);if(_i.HasTouchScreen&&wS){YQ(true,tc.CURSOR_HANDLE_IDX,rt.left+s-Ft+1,rt.top+_-Gt+iL-2)}}t=ib(a,i);if(Nj(xs[t].style&tc.PICT)&&QE)hM(t);if(qE){var o=iW(a);if(o>=0&&pl[o].ParaFrameId>0)pM(pl[o].BoxFrame,-1)}}else{t=ib(br,jt);if(Nj(xs[t].style&tc.PICT)&&QE)hM(t)}GE=false;if(a==-1){if(VR){a=br;i=jt}else{Cq(lL);a=PC;i=SC}}if(t==-1)t=ib(a,i);if(Nj(xs[t].style&(tc.FNOTETEXT|tc.FNOTEREST)))GE=true;return true}function Tq(t,e,r){var i,f;var l,a=r,n;var c,s;i=l=Fq(e,t,tc.LEFT);if(Nj(ui[t].flags2&tc.LFLAG2_RTL)){var _=pf;vf=Mq(t,null,-1);_=Dd;pf=_;if(pf>0){if((n=iW(t))>=0){Nf=Vq(t,e,pf,vf);if(e==0){l=i=E$(i,0,n,vf[Nf]);if(l>=je)l--}else{var o=e-1;Nf=Vq(t,o,pf,vf);i=Fq(o,t,tc.TER_RIGHT);l=i=E$(i,0,n,vf[Nf])}}pf=0}}if(oi.PageMode){var u=0,T;f=ui[t].fid;T=ui[t].cid;if(f!=0)u=kl[f].TextAngle;if(u==0&&T>0)u=eR[T].TextAngle;if(u>0&&(n=iW(t))>=0){l=g$(i,r,n);a=P$(i,r,n);if(u==270)l-=iL}}td=l;ed=a;return true}function Aq(){if(!_l)return true;if(!ZR)_i.caret.destroy();zR=false;ZR=true;return true}function Eq(t,e){var r=true;var i,f,l=0,a;var n;if(!_l)return false;t:{if(VR)break t;if(t<0){Cq(lL);t=PC;e=SC}r=false;i=iW(t);if(i>=0&&t>=pl[i].ScrFirstLine&&t<=pl[i].ScrLastLine){f=Fq(e,t,tc.LEFT);if(f>=Ft&&f<Ft+je)r=true;if(it!=null){l=l$(t);if(l<Gt||l>=Gt+Tt)r=false}}}if(!QR&&r){n=$w();if(Nj(xs[n].style&tc.PROTECT))r=false}if(mh&&r){n=ib(br,jt);if(xs[n].ctl!=null)r=false}if(r){a=ui[t].fid;if(Nj(kl[a].flags&(tc.PARA_FRAME_RECT|tc.PARA_FRAME_LINE)))r=false;if(k_>=0)r=false}if(uA!=tc.HILIGHT_OFF&&!Xr&&(sA!=_A||TA!=AA))r=false;ZR=_i.caret.isCaretHidden();if(r&&_i.dialog==null&&(ZR||_i.caret.owner!="te")){var c=fL==0?xs[0].CharWidth[tc.CHAR_e]/4:fL;if(tL)_i.caret.CreateCaret(c,iL);else _i.caret.CreateCaret(iL,c);_i.caret.show();_i.caret.owner="te";ZR=false}if(!r&&!ZR){_i.caret.hide();ZR=true}return r}_i.TerSetCaretWidth=function(t){fL=t;if(lv)_q();return true};function Rq(t){var e,r;e=t.getLocation().getX();r=t.getLocation().getY();$Q(t,false);if(!Lm(Da,Ma)){return true}br=Da;jt=Ma;if(!zR)_q();uq();return true}_i.TerRowColToAbs=function(t,e){if(!lv||!QD())_i.TerCreateControl();return Lq(t,e)};_i.TerAbsToRowCol=function(t){if(!lv||!QD())_i.TerCreateControl();Cq(t)};function Lq(t,e){var r=0;var i,f=0,l;var a=Nj(qh&tc.TFLAG4_COUNT_PCHAR_AS_CRLF)?true:false;if(Nj(cO&tc.TOFLAG3_NO_CRLF_FLAG))a=false;if(Dj(oi.WordWrap))r=2;if(t<0)t=0;if(t>=Ri)t=Ri-1;for(i=0;i<t;i++){l=ui[i].len;if(Nj(ui[i].flags2&tc.LFLAG2_TEMP_HYPH)&&l>0&&ui[i].txt[l-1]==tc.HYPH_CHAR)l--;f=f+l+r;if(a&&(Nj(ui[i].flags&(tc.LFLAG_PARA|tc.LFLAG_LINE|tc.LFLAG_HDRS_FTRS))||ui[i].len==1&&GY(i,tc.INFO_ROW)))f++}if(e>ui[t].len&&e>0)e=ui[t].len-1+r;if(e<0)e=0;f=f+e;return f}function Cq(t,e){var r=0,i,f;var l=Nj(qh&tc.TFLAG4_COUNT_PCHAR_AS_CRLF)?true:false;var a,n;if(Nj(cO&tc.TOFLAG3_NO_CRLF_FLAG))l=false;nO=uj(tc.TOFLAG2_ABS_POS_BEYOND);if(Dj(oi.WordWrap))r=2;a=n=0;PC=SC=0;while(t>=0){f=ui[a].len;if(Nj(ui[a].flags2&tc.LFLAG2_TEMP_HYPH)&&f>0&&ui[a].txt[f-1]==tc.HYPH_CHAR)f--;i=f+r;if(l&&(Nj(ui[a].flags&(tc.LFLAG_PARA|tc.LFLAG_LINE|tc.LFLAG_HDRS_FTRS))||ui[a].len==1&&GY(a,tc.INFO_ROW)))i++;if(t>=i)t=t-i;else{n=t;break}if(a>=Ri-1){n=ui[Ri-1].len-1+r;nO|=tc.TOFLAG2_ABS_POS_BEYOND;break}a++}if(n<0)n=0;if(e!=undefined){if(e=="C".charCodeAt(0)){br=a;jt=n}else if(e==tc.CHAR_B){sA=a;TA=n}else if(e==tc.CHAR_E){_A=a;AA=n}else qk(tg.MsgString[tc.MSG_INTERNAL_ERROR],"AbsToRowCol",tc.MSGTYPE_ALERT)}PC=a;SC=n}function Iq(t){return dq(t,true)}function dq(t,e){ZU("TerPosLine2");if(t>Ri)t=Ri;if(t<1)t=1;br=t-1;if(br-fr>=Dt||br-fr<0){fr=br-Dt/2;if(fr<0)fr=0}we=br-fr;if(oi.PageMode){var r=Lo,i;var f;Lo=cz(br);if(r!=Lo)my(true);if(jt>=ui[br].len)jt=ui[br].len-1;if(jt<0)jt=0;f=Pq(br);i=Gt;if(f<Gt||f>=Gt+Mt)Gt=f;if(Gt+Mt>ze)Gt=ze-Mt;if(Gt<0)Gt=0;if(Gt!=i)BG()}if(!VR&&e)nq(-1);cG();if(oi.ShowHorBar||oi.ShowVerBar)h$();_q();return true}function Fq(t,e,r){var i,f,l,a,n,c,s;var _=0;var o=null,u;if(e>=Ri)return 0;u=vq(e);if(Dj(u))return 0;if(ui[e].fmt!=null)o=ui[e].fmt;l=ui[e].len;if(ui[e].fmt!=null)o=ui[e].fmt;i=f$(e);for(f=0;f<=t;f++){c=s=0;if(Nj(ui[e].tabw)&&Nj(ui[e].tabw.type&tc.INFO_FRAME)&&f==ui[e].tabw.FrameCharPos)i+=ui[e].tabw.FrameScrWidth;if(ui[e].fmt==null)_=ui[e].UniFmt;else if(f<l)_=o[f];if(f<l){a=u[f];if(Nj(ui[e].tabw)&&Nj(ui[e].tabw.CharFlags)&&f<ui[e].tabw.CharFlagsLen){if(Nj(ui[e].tabw.CharFlags[f]&tc.BFLAG_BOX_FIRST))c=yh;if(Nj(ui[e].tabw.CharFlags[f]&tc.BFLAG_BOX_LAST))s=yh}}else a=Gx(_,true,tc.CHAR_SPACE);if(f==t){if(r==tc.TER_CENTER)i+=c+(a-c-s)/2;if(r==tc.TER_RIGHT)i+=c+(a-c-s);else i+=c}else i+=a}if(oi.PageMode){n=iW(e);if(n>=0)i+=pl[n].ScrX}return i}function gq(t,e){var r,i,f,l,a;var n=0;var c=null,s;if(t>=Ri)return 0;s=vq(t);if(Dj(s))return 0;if(ui[t].fmt!=null)c=ui[t].fmt;f=ui[t].len;if(ui[t].fmt!=null)c=ui[t].fmt;r=f$(t);if(Eu)r=wV(r);for(i=0;i<e;i++){a=0;if(Nj(ui[t].tabw)&&Nj(ui[t].tabw.type&tc.INFO_FRAME)&&i==ui[t].tabw.FrameCharPos)r+=ui[t].tabw.FrameScrWidth;if(ui[t].fmt==null)n=ui[t].UniFmt;else if(i<f)n=c[i];if(i<f){l=s[i];if(Nj(ui[t].tabw)&&Nj(ui[t].tabw.CharFlags)&&i<ui[t].tabw.CharFlagsLen){if(Nj(ui[t].tabw.CharFlags[i]&tc.BFLAG_BOX_FIRST))a=yh}}else l=Gx(n,true,tc.CHAR_SPACE);if(i==e)r+=a;else r+=l}if(Eu)r=MV(r);else r=gV(r);return r}function Pq(t){if(t==tc.STATUS_ROW){if(oi.BorderMargin)return Gt+rt.bottom-rt.top+OV(tc.BORDER_MARGIN);else return Gt+rt.bottom-rt.top}else return l$(t)}function Sq(t,e,r){t=hq(t,e,r);return Oq(t,r)}function hq(t,e,r){var i,f,l,a,n,c=0,s;var _;var o=false;if(r<0){r=Jq(t,e);if(r>=Ri)r=Ri-1}if(eR[ui[r].cid].TextAngle!=0)o=true;if(oi.PageMode&&(jl||o)){for(i=0;i<Dl;i++){if(pl[i].empty||pl[i].ParaFrameId==0||Dj(pl[i].flags&tc.FRAME_PICT))continue;if(Nj(pl[i].flags&tc.FRAME_DISABLED)&&Dj(nO&tc.TOFLAG2_CHECK_DISABLED_FRAMES))continue;if(Nj(pl[i].flags1&tc.FRAME1_RECT)){if(Qq(i,t,e))break;else continue}if(t>=pl[i].x&&t<pl[i].x+pl[i].width&&e>=pl[i].y&&e<pl[i].y+pl[i].height)break}if(i<Dl){l=pl[i].ParaFrameId;f=kl[l].pict;if(f<Ys&&Nj(xs[f].style&tc.PICT)&&xs[f].FrameType!=tc.PFRAME_NONE){_=nb(r);for(a=0;a<ui[r].len;a++)if(_[a]==f)break;sb(r);if(a<ui[r].len)return Fq(a,r,tc.TER_LEFT)}}for(i=0;i<Dl;i++){if(pl[i].empty||pl[i].ParaFrameId==0&&pl[i].CellId==0)continue;if(Nj(pl[i].flags&tc.FRAME_DISABLED)&&Dj(nO&tc.TOFLAG2_CHECK_DISABLED_FRAMES))continue;if(I$(i)==0)continue;if(C$(t,e,i))break}n=i;if(n<Dl){var u,T;var A=0,E=0,R=0;l=pl[n].ParaFrameId;T=pl[n].CellId;var L=l==0?n:pl[n].BoxFrame;if(l==0&&T>0&&eR[T].TextAngle!=0){A=pl[L].x;E=pl[L].y;R=pl[L].height}else{A=pl[L].x+pl[L].SpaceLeft;E=pl[L].y+pl[L].SpaceTop;R=pl[L].height-pl[L].SpaceTop-pl[L].SpaceBot}u=I$(n);if(u>0){if(u==90)t=A+R-(e-E);else t=A+(e-E)}}}if(Nj(ui[r].flags2&tc.LFLAG2_RTL)){var C=-1,I,d,F;if(oi.PageMode){for(i=0;i<Dl;i++){if(pl[i].empty)continue;if(Nj(pl[i].flags&tc.FRAME_DISABLED)&&Dj(nO&tc.TOFLAG2_CHECK_DISABLED_FRAMES))continue;l=pl[i].ParaFrameId;c=pl[i].width;s=pl[i].height;if(I$(i)!=0){c=WY(c,s);s=JC}if(t>=pl[i].x&&t<pl[i].x+c&&e>=pl[i].y&&e<pl[i].y+s)break}if(i<Dl)C=i}else{C=0;c=pl[C].width}if(C>=0&&C<Dl){var g=pl[C].x;var P=0;var S=pf;vf=Mq(r,null,-1);S=Dd;pf=S;F=-1;for(i=0;i<pf;i=i+1+P){var h=vf[i].width;P=0;if(h==0)continue;if(!vf[i].NoMerge){for(a=i+1;a<pf;a++){if(vf[a].rtlch!=vf[i].rtlch||vf[a].IsTab!=vf[i].IsTab)break;if(!vf[i].ParaRtl&&vf[a].rtl!=vf[i].rtl)break;if(vf[i].ParaRtl&&vf[a].NoMerge)break;if(vf[i].ParaRtl&&vf[i].rtlch){if(vf[a].IsObj!=vf[i].IsObj||vf[a].IsNumeric!=vf[i].IsNumeric||vf[a].IsParen!=vf[i].IsParen||vf[a].IsPunct!=vf[i].IsPunct)break}h+=vf[a].width;P++}}I=vf[i].x+g;I=E$(I,0,C,vf[i]);d=vf[i].x+h+g;d=E$(d,0,C,vf[i]);if(I>d){I=WY(I,d);d=JC}if(i==0){if(vf[i].ParaRtl&&t>=d){F=g;break}}else if(i+1==pf&&!vf[i].ParaRtl&&t<I){F=g+pl[C].width;break}if(t>=I&&t<d){F=vf[i].x+g;if(vf[i].rtl&&!vf[i].IsNumeric)F+=d-t;else F+=t-I;break}if(i==pf-1){if(vf[i].ParaRtl&&t<I||!vf[i].ParaRtl&&t>=d){F=g+(c-1);break}}}if(F!=-1)t=F;vf=null;pf=Nf=0}}return t}function Oq(t,e){var r=0,i,f,l,a,n=0;var c=null,s;oj(tc.TOFLAG_X_BEYOND_LINE);oj(tc.TOFLAG_X_BEFORE_LINE);if(e>=Ri||e<0)return 0;s=vq(e);if(Dj(s))return 0;i=ui[e].len;if(ui[e].fmt!=null)c=ui[e].fmt;t=t-f$(e);if(oi.PageMode){l=iW(e);if(l>=0)t=t-pl[l].ScrX}if(t<0)aO|=tc.TOFLAG_X_BEFORE_LINE;a=t;while(true){if(Nj(ui[e].tabw)&&Nj(ui[e].tabw.type&tc.INFO_FRAME)&&r==ui[e].tabw.FrameCharPos)f=ui[e].tabw.FrameScrWidth;else f=0;if(ui[e].fmt==null)n=ui[e].UniFmt;else if(r<i)n=c[r];if(r<i){f+=s[r];if(Nj(ui[e].tabw)&&Nj(ui[e].tabw.CharFlags)&&r<ui[e].tabw.CharFlagsLen){if(Nj(ui[e].tabw.CharFlags[r]&tc.BFLAG_BOX_FIRST))f+=yh;if(Nj(ui[e].tabw.CharFlags[r]&tc.BFLAG_BOX_LAST))f+=yh}}else{if(oi.WordWrap){aO|=tc.TOFLAG_X_BEYOND_LINE;break}f+=Gx(n,true,tc.CHAR_SPACE)}t-=f;if(t<0)break;r++}if(oi.WordWrap){if(r>=ui[e].len&&ui[e].len>0)r=ui[e].len-1}else{if(r>ui[e].len&&ui[e].len>0)r=ui[e].len}return r}function vq(t){var e,r,i,f,l,a=0,n,c,s=0;var _=0,o,u,T,A,E;var R;var L=0,C;var I=null,d,F;var g=!oi.WordWrap||!oi.PrintView||oi.FittedView;var P=0,S;var h;var O;if(t>=Ri||t<0)return null;d=[ui[t].len+1];F=[ui[t].len+1];if(d==null||F==null){return null}R=ui[t].txt;l=ui[t].len;if(ui[t].fmt!=null)I=ui[t].fmt;if(Eu){bt=Ai;e=0}else{bt=Nt;e=f$(t);if(!g){var v=ui[t].pfmt;if(Nc[v].LeftIndent==e)e=Nc[v].LeftIndentTwips;else e=gV(e)}}if(Nj(ui[t].flags&tc.LFLAG_ASSUMED_TAB))a++;for(i=0;i<l;i++){C=L;L=R[i];if(ui[t].fmt==null)_=ui[t].UniFmt;else _=I[i];if(Nj(xs[_].style&(tc.SCAPS|tc.CAPS))&&Oj(L)){O=tc.CHAR_A-tc.CHAR_a;L+=O}A=0;if(L==tc.TAB&&!um(_)){n=p$(t,a,e);a++}else if(i==0&&Nj(ui[t].flags2&tc.LFLAG2_SPACE_TAKING_FRAME)&&xs[_].ParaFID>0){var p=xs[_].ParaFID;n=mV(kl[p].width)}else if(L==tc.CHAR_SPACE&&Nj(ui[t].tabw)&&Nj(ui[t].tabw.type&tc.INFO_JUST)&&A$(_)){if(Qi&&Nq(_)&&!um(_)){if(oi.FittedView&&!Eu)n=dV(xs[_].TwipsSize)/2;else n=DV(xs[_].TwipsSize-1)/2}else if(Qi&&(C==tc.SPACE||i==0)&&!Nq(_)&&!um(_)){if(oi.FittedView&&!Eu)n=dV(xs[_].TwipsSize)/2;else n=DV(xs[_].TwipsSize)/2}else n=Gx(_,g,L);n+=N$(t,s);s++}else if(L==tc.CHAR_SPACE&&Qi&&Nq(_)&&!um(_)){if(oi.FittedView&&!Eu)n=dV(xs[_].TwipsSize)/2;else n=DV(xs[_].TwipsSize-1)/2;s++}else if(L==tc.SPACE&&Qi&&!Dq(_)&&(C==tc.SPACE||i==0)&&!Nq(_)&&!um(_)){if(oi.FittedView&&!Eu)n=dV(xs[_].TwipsSize)/2;else n=DV(xs[_].TwipsSize)/2;s++}else if(L==tc.HYPH_CHAR&&i==l-1&&!dS){n=Gx(_,g,"-".charCodeAt(0))}else if(L==tc.ZWNJ_CHAR||L==tc.LRM_CHAR||L==tc.RLM_CHAR){n=0}else if(dS&&!g&&Nj(xs[_].style&tc.PICT)&&xs[_].FrameType!=tc.PFRAME_NONE){A=xs[_].CharWidth[tc.PICT_CHAR];n=g?A:wV(A)}else if(Nj(xs[_].style&tc.PICT)&&um(_)){A=n=0}else{if(Nj(ui[t].cwidth)&&Nj(Zw(t,i)&tc.CWIDTH_USED)){if(g)n=A=Zw(t,i)&tc.CWIDTH_WIDTH;else{n=Zw(t,i)&tc.CWIDTH_WIDTH;A=WV(n)}n=n/tc.CWIDTH_FACTOR;A=A/tc.CWIDTH_FACTOR;if(Dj(xs[_].flags&tc.FFLAG_HIDDEN_INFO)){if(!DE&&vj(xs[_].style))n=A=0;if(!ME&&Nj(xs[_].style&tc.ENOTETEXT))n=A=0}if(xs[_].CharWidth[tc.CHAR_SPACE]==0)n=A=0}else{A=Gx(_,true,L);if(g)n=A;else n=Gx(_,g,L);if(NS&&t==0&&i==0)PY("line/col: ",t,i,"w: ",n)}if(i<l-1&&Nj(ui[t].tabw)&&Nj(ui[t].tabw.type&tc.INFO_JUST)&&n>0){if(h9(L,_)){n+=N$(t,s);A=WV(n);s++}}if(Nj(ui[t].tabw)&&Nj(ui[t].tabw.CharFlags)&&i<ui[t].tabw.CharFlagsLen){if(Nj(ui[t].tabw.CharFlags[i]&tc.BFLAG_BOX_FIRST)){h=yh;A+=Eu?xh:h;n+=g?h:xh}if(Nj(ui[t].tabw.CharFlags[i]&tc.BFLAG_BOX_LAST)){h=yh;A+=Eu?xh:h;n+=g?h:xh}if(Nj(ui[t].tabw.type&tc.INFO_ALT_JUST)&&Nj(ui[t].tabw.CharFlags[i]&tc.BFLAG_JUST_SPACE)&&A$(_)){if(Nj(ui[t].tabw.type&tc.INFO_NEG_JUST))n-=N$(t,s);else n+=N$(t,s);A=WV(n);s++}}}d[i]=n;F[i]=A}if(g||Eu||Ai==Nt){return d}else{if(Nt!=Ai)for(i=0;i<l;i++)d[i]=d[i]*Nt/Ai;return d}o=0;if(oi.PageMode){c=iW(t);if(c>=0)o=pl[c].x}e+=o;T=WV(e);P=0;S=9999;for(i=0;i<l;i++){if(S==9999||R[i]==tc.CHAR_SPACE){for(f=i+1;f<l;f++)if(R[f]==tc.CHAR_SPACE)break;if(f<l)S=f;else S=-1}r=e+d[i];u=WV(r);E=d[i];if(u>=T)d[i]=u-T;else{O=-(u-T);if(i>0){if(d[i-1]>=O)d[i-1]=d[i-1]-O;else d[i-1]=0}d[i]=0}if(d[i]<F[i]){d[i]++;u++}if(d[i]>F[i]&&F[i]!=0&&d[i]>0){if(R[i]!=tc.CHAR_SPACE){O=d[i]-F[i]-1;d[i]=F[i]+1;u-=O;if(i>S&&O>2){d[i]++;u++}}}if(E==0&&d[i]>0){u-=d[i];d[i]=0}e=r;T=u;P+=d[i]}return d}function pq(t,e,r,i){var f=[r];var l;for(l=0;l<r;l++){if(Nj(i))f[l]=i[l];else f[l]=Gx(t,true,e[l])}return f}function Nq(t){if(Qi){if(xs[t].CharSet==tc.CHINESEBIG5_CHARSET||xs[t].CharSet==tc.GB2312_CHARSET||Tk(xs[t].TypeFace,"PMingLiU")==0||Tk(xs[t].TypeFace,"SimSun")==0)return true}return false}function Dq(t){return xs[t].CharWidth[tc.CHAR_i]==xs[t].CharWidth[tc.CHAR_W]}function Mq(t,e,r){return Gq(t,e,0,0,null,null,r)}function Gq(t,e,r,i,f,l,a){var n,c;var s,_,o=0,u=0,T=0,A=0,E=0,R=0;var L=[];var C=false,I=false,d=false,F=false,g=false,P=false;var S,h=true,O=false,v=false,p=false,N=false;var D=false,M=false,G=false,B=false;var H=false,m=false;var w=0,b=0,x=tc.FLOW_DEF,y=tc.FLOW_DEF;var W,U,k,X=0,K=0;var Y=0;var V=false,j;var J=null;var z=0,Z=0;var Q=false,q=false;var $=false,tt=false;var et=0;var rt=0;var it=false;var ft=false,lt=false;var at=t>=0?ui[t].len:r;J=[at+1];if(t<0||!bq(t,r,J))J=null;t:{if(t>=0){n=Nj(e)?e:vq(t);c=Nj(ui[t].flags2&tc.LFLAG2_RTL)?ui[t].cwidth:null;if(GY(t,tc.INFO_FRAME))R=ui[t].tabw.FrameCharPos;else R=-1;if(Eu){var nt=ui[t].pfmt;var ct=Nc[nt].LeftIndentTwips+Nc[nt].FirstIndentTwips;i=0;if(Nj(ui[t].flags&tc.LFLAG_PARA_FIRST)){if(ct<0)i=DV(ct)}else if(Nc[nt].LeftIndentTwips<0)i=DV(Nc[nt].LeftIndentTwips)}else{if(a==-1)i=f$(t);else i=a}r=ui[t].len;if(r>0&&Nj(ui[t].flags&tc.LFLAG_PARA)&&!dS)n[r-1]=0;if(r==0)break t;l=nb(t);f=ui[t].txt;h=Nj(ui[t].flags2&tc.LFLAG2_PARA_RTL);V=Nj(ui[t].flags&(tc.LFLAG_PARA|tc.LFLAG_BREAK))}else{n=e;c=null;R=-1;h=true}for(s=0;s<=r;s++){if(s<r){W=f[s];u=l[s];C=Nj(c)?Nj(c[s]&tc.CWIDTH_RTL):false;z=W;x=xs[u].flow;if(x==tc.FLOW_DEF&&J!=null)x=J[s];if(x==tc.FLOW_RTL)d=true;else if(x==tc.FLOW_LTR)d=false;else d=xs[u].rtlch;w=xs[u].lang;g=Nj(xs[u].style&tc.FNOTEALL);if(d&&!C){var st=xs[u].FieldId;C=st==tc.FIELD_DATE||st==tc.FIELD_TIME||st==tc.FIELD_PRINTDATE}D=W==tc.TAB;G=W=="(".charCodeAt(0)||W==")".charCodeAt(0)||W=="[".charCodeAt(0)||W=="]".charCodeAt(0)||W=="{".charCodeAt(0)||W=="}".charCodeAt(0);if(G)C=d;if(s>0)k=f[s-1];else if(t>0)k=Wq(t,s);else k=tc.CHAR_0;if(s+1<r)U=f[s+1];else if(t>=0&&t+1<Ri)U=Uq(t,s);else U=tc.CHAR_0;if(G&&(W=="(".charCodeAt(0)||W=="[".charCodeAt(0)||W=="{".charCodeAt(0))){if(U>=tc.CHAR_a&&U<=tc.CHAR_z)G=false;if(U>=tc.CHAR_A&&U<=tc.CHAR_Z)G=false}if(G&&(W==")".charCodeAt(0)||W=="]".charCodeAt(0)||W=="}".charCodeAt(0))){if(k>=tc.CHAR_a&&k<=tc.CHAR_z)G=false;else if(k>=tc.CHAR_A&&k<=tc.CHAR_Z)G=false;else if(!F&&(k>=tc.CHAR_0&&k<=tc.CHAR_9))G=false}p=W>=tc.CHAR_0&&W<=tc.CHAR_9;if(!p&&(W==".".charCodeAt(0)||W==gk(","))){p=k>=tc.CHAR_0&&k<=tc.CHAR_9&&(U>=tc.CHAR_0&&U<=tc.CHAR_9)}if(!p&&(W=="/".charCodeAt(0)||W=="*".charCodeAt(0)||W=="+".charCodeAt(0)||W=="-".charCodeAt(0))){if(!h)p=true;else if(k>=tc.CHAR_0&&k<=tc.CHAR_9&&(U>=tc.CHAR_0&&U<=tc.CHAR_9)){p=true}}if(!p&&(W=="(".charCodeAt(0)||W=="[".charCodeAt(0)||W=="{".charCodeAt(0))&&(U>=tc.CHAR_0&&U<=tc.CHAR_9))p=true;if(!p&&(W==")".charCodeAt(0)||W=="]".charCodeAt(0)||W=="}".charCodeAt(0))&&(k>=tc.CHAR_0&&k<=tc.CHAR_9))p=true;if(!p&&W=="%".charCodeAt(0)&&(k>=tc.CHAR_0&&k<=tc.CHAR_9)&&(U==tc.CHAR_SPACE||U==tc.NBSPACE_CHAR||U==".".charCodeAt(0)||U==gk(",")||U==")".charCodeAt(0)))p=true;if(!p&&W=="%".charCodeAt(0)&&(k>=tc.CHAR_0&&k<=tc.CHAR_9)&&(s+2==r&&V))p=true;if(p&&!d)G=false;if(!p&&(W==":".charCodeAt(0)||W==gk("'"))&&!C&&I&&d==F&&t>=0){var _t=Wq(t,s);if(Yq(_t))C=I}if(x==tc.FLOW_RTL&&!G)C=true;if(J==null&&!p&&wq(z,u))O=true;else if(J==null&&!p&&h&&(W==tc.CHAR_SPACE||W==tc.NBSPACE_CHAR)&&N)O=true;else{O=true;if(O&&W>=tc.CHAR_0&&W<=tc.CHAR_9)O=false;if(O&&W>=tc.CHAR_a&&W<=tc.CHAR_z)O=false;if(O&&W>=tc.CHAR_A&&W<=tc.CHAR_Z)O=false;if(O&&W>=256)O=false;if(O&&W==tc.CHAR_SPACE)O=false;if(O&&W==tc.NBSPACE_CHAR)O=false;if(O&&W==tc.TAB)O=false;if(O&&W==":".charCodeAt(0)&&d!=F)O=false;if(O&&W=="/".charCodeAt(0))O=false;if(O&&W=="%".charCodeAt(0))O=false;if(O&&W=="<".charCodeAt(0))O=false;if(O&&W==">".charCodeAt(0))O=false;if(O&&G)O=false;if(O&&(W=="(".charCodeAt(0)||W==")".charCodeAt(0)||W=="[".charCodeAt(0)||W=="]".charCodeAt(0)||W=="{".charCodeAt(0)||W=="}".charCodeAt(0)))O=false;if(O&&p)O=false;if(O&&Nj(xs[u].style&tc.PICT))O=false;if(O&&x==tc.FLOW_RTL){C=true;O=false}if(xs[u].CharSet==tc.ARABIC_CHARSET){if(W=="-".charCodeAt(0)&&F&&d&&p)O=true;if(W=="/".charCodeAt(0)&&F&&d&&p)O=true}}tt=q=false;ft=false;if(lt&&(z==tc.LRM_CHAR||z==tc.RLM_CHAR))ft=true;if(Xq(z))ft=true;if(!ft&&(lt||Xq(U))){if(z==1548||z==1644)ft=true;if(z==1643)ft=true;if(z==32)ft=true;if(z=="x".charCodeAt(0))ft=true}if(ft){C=false;q=true;O=false;x=1}if(Kq(z)&&Xq(Z)){C=false;O=false;q=true}if(Nj(xs[u].flags&tc.FFLAG_FORCE_RTLCH)){C=true;tt=true;d=true}else if(Nj(xs[u].flags&tc.FFLAG_FORCE_LTRCH)){C=false;O=false;q=true;d=false}if(O&&d&&Hq(t,s)&&Bq(t,s)){O=false}m=false;if(Nj(xs[u].style&tc.PICT)&&xs[u].ObjectType!=tc.OBJ_NONE)m=true;K=0;if(G&&!xs[l[s]].rtl&&x!=tc.FLOW_LTR){var ot=W=="(".charCodeAt(0)||W=="[".charCodeAt(0)||W=="{".charCodeAt(0);if(ot){for(_=s+1;_<r;_++){if(f[_]==tc.CHAR_SPACE)continue;if(f[_]==tc.NBSPACE_CHAR)continue;if(f[_]<128)break;if(Yq(f[_])){if(W=="(".charCodeAt(0))K=")".charCodeAt(0);if(W=="{".charCodeAt(0))K="}".charCodeAt(0);if(W=="[".charCodeAt(0))K="]".charCodeAt(0);break}}}else{for(_=s-1;_>=0;_--){if(f[_]==tc.CHAR_SPACE)continue;if(f[_]==tc.NBSPACE_CHAR)continue;if(f[_]>=tc.CHAR_0&&f[_]<=tc.CHAR_9)continue;if(f[_]==":"||f[_]==gk(",")||f[_]==".".charCodeAt(0))continue;if(f[_]<128)break;if(Yq(f[_])){if(W==")".charCodeAt(0))K="(".charCodeAt(0);if(W=="}".charCodeAt(0))K="{".charCodeAt(0);if(W=="]".charCodeAt(0))K="[".charCodeAt(0);break}}}}if(K==0&&!G&&p&&d){if(W=="(".charCodeAt(0))K=")".charCodeAt(0);else if(W=="[".charCodeAt(0))K="]".charCodeAt(0);else if(W=="{".charCodeAt(0))K="}".charCodeAt(0);else if(W==")".charCodeAt(0))K="(".charCodeAt(0);else if(W=="]".charCodeAt(0))K="[".charCodeAt(0);else if(W=="}".charCodeAt(0))K="{".charCodeAt(0)}}if(s==0){Y=u;I=C;F=d;y=x;P=g;v=O;N=p;M=D;B=G;H=m;b=w;X=K;Z=z;$=tt;Q=q;lt=ft;T=A=0;E=i}else{S=false;var ut=Y!=u;ut=FG(Y,u);if(Xq(Z)&&Kq(z))ut=false;if(s==r||Nj(c)&&C!=I||s==R||ut||P!=g||d!=F||O!=v||p!=N||D!=M||G!=B||m!=H||w!=b||G&&B&&F||f[s]<32&&f[s]!=tc.PICT_CHAR||f[s-1]<32&&f[s-1]!=tc.PICT_CHAR)S=true;if(h&&O)S=true;if(Q&&Q==q&&F&&F==d)S=false;if(S){if(T==R&&t>=0){if(Eu)E+=ui[t].tabw.FrameSpaceWidth;else E+=bV(ui[t].tabw.FrameSpaceWidth)}if(o==0&&E>0){L[o]=new tc.ClsLineSeg;L[o].InUse=true;L[o].col=0;L[o].count=0;L[o].x=0;L[o].width=i;L[o].rtl=false;L[o].rtlch=false;L[o].IsNumeric=false;L[o].IsPunct=true;L[o].IsTab=true;L[o].IsParen=false;L[o].IsObj=false;L[o].MirrorChar=0;L[o].RtlFont=false;L[o].flow=tc.FLOW_DEF;L[o].lang=1033;L[o].LineNo=t;L[o].NoMerge=false;L[o].IsDate=false;L[o].ForceLtr=false;L[o].ForceRtl=false;o++;L=fV(L,o+1)}L[o]=new tc.ClsLineSeg;L[o].InUse=true;L[o].col=T;L[o].count=s-T;L[o].x=E;L[o].width=A;L[o].rtl=I;L[o].rtlch=F;L[o].IsNumeric=N;L[o].IsPunct=v;L[o].IsTab=M;L[o].IsParen=B;L[o].IsObj=H;L[o].lang=b;L[o].MirrorChar=X;L[o].RtlFont=xs[Y].rtl;L[o].flow=y;L[o].LineNo=t;L[o].NoMerge=false;L[o].IsDate=false;L[o].ForceLtr=Q;L[o].ForceRtl=$;if(f[T]<32&&o>0)L[o].rtl=true;o++;if(s==r)break;Y=u;I=C;F=d;y=x;P=g;v=O;N=p;M=D;B=G;H=m;b=w;X=K;$=tt;Q=q;lt=ft;T=s;E=E+A;A=0}else{Z=z}}A+=n[s]}for(s=0;s<o;s++){if(L[s].IsPunct&&!L[s].rtlch){var Tt=false;var At=false;if(s>0)Tt=!L[s-1].rtlch;if(s+1<o)At=!L[s+1].rtlch;if(Tt&&At)L[s].IsPunct=false}L[s].ForceDrawLtr=false}for(s=0;s<o;s++){if(L[s].IsPunct&&s>0&&L[s-1].IsNumeric&&L[s].rtlch==L[s-1].rtlch&&L[s].count==1){_=L[s].col;W=f[_];if(W=="%".charCodeAt(0)){L[s].IsPunct=false;L[s].IsNumeric=true}}}for(s=o-2;s>=0;s--){if(L[s].IsNumeric&&!L[s+1].IsNumeric&&!L[s+1].rtlch){L[s].IsNumeric=false;L[s].rtlch=false}}j=false;for(s=0;s<o;s++){if(!L[s].IsPunct)j=true;if(!j&&J!=null)L[s].NoMerge=true;L[s].pFirstSeg=L;L[s].idx=s;L[s].TotalLineSeg=o;if(t>=0)L[s].ParaRtl=Nj(ui[t].flags2&tc.LFLAG2_PARA_RTL);else L[s].ParaRtl=true}if(!h){L=mq(L,f,n,o);o=Dd}for(s=0;s<o;s++){if(L[s].IsPunct){if(s>0&&!L[s-1].rtl&&!L[s-1].rtlch)L[s].rtl=false;if(h&&s>0&&!L[s-1].rtlch)L[s].rtlch=true}else if(L[s].rtlch){et=L[s].col;rt=L[s].count;it=false;if(!it&&c!=null){for(_=et;_<et+rt;_++)if(Nj(c[_]&tc.CWIDTH_RTL)){it=true;break}}if(!it&&L[s].rtlch)L[s].ForceDrawLtr=true}else if(!L[s].rtlch&&L[s].rtl){et=L[s].col;rt=L[s].count;it=false;for(_=et;_<et+rt;_++){W=f[_];if(Yq(W)){it=true;break}if(!it)L[s].rtl=false}}if(s+1==o){et=L[s].col;rt=L[s].count;L[s].AllSpaces=true;for(_=et;_<et+rt;_++){W=f[_];if(W!=tc.CHAR_SPACE){L[s].AllSpaces=false;break}}}else L[s].AllSpaces=false}if(J!=null){for(s=o-1;s>=0;s--){if(!L[s].IsPunct)break;L[s].NoMerge=true}}if(t>=0)sb(t)}Dd=o;return L}function Bq(t,e){var r;var i;var f;var l,a,n,c;for(l=t;l<Ri;l++){i=nb(l);r=ui[l].txt;if(l==t)n=e+1;else n=0;for(a=n;a<ui[l].len;a++){f=r[a];c=i[a];if(Yq(f))return false;if(f>="0".charCodeAt(0)&&f<="9".charCodeAt(0))return true;if(f>="a".charCodeAt(0)&&f<="z".charCodeAt(0))return true;if(f>="A".charCodeAt(0)&&f<="A")return true;if(f>=160&&f<=255)return true;if(f>=256&&f<=383)return true;if(f>=384&&f<=591)return true;if(f>=880&&f<=1023)return true;if(f>=1024&&f<=1327)return true}if(Nj(ui[l].flags&tc.LFLAG_PARA))break}return false}function Hq(t,e){var r;var i;var f;var l,a,n,c;for(l=t;l>=0;l--){i=nb(l);r=ui[l].txt;if(l==t)n=e-1;else n=ui[l].len-1;for(a=n;a>=0;a--){f=r[a];c=i[a];if(Yq(f))return false;if(f>="0".charCodeAt(0)&&f<="9".charCodeAt(0))return true;if(f>="a".charCodeAt(0)&&f<="z".charCodeAt(0))return true;if(f>="A".charCodeAt(0)&&f<="A")return true;if(f>=160&&f<=255)return true;if(f>=256&&f<=383)return true;if(f>=384&&f<=591)return true;if(f>=880&&f<=1023)return true;if(f>=1024&&f<=1327)return true}if(l==0||Nj(ui[l-1].flags&tc.LFLAG_PARA))break}return false}function mq(t,e,r,i){var f,l,a,n,c,s,_;var o=false,u=false;for(f=0;f<i;f++){if(t[f].count>0&&t[f].rtlch){s=t[f].col;_=t[f].count;u=false;for(l=0;l<_;l++){if(r[s+l]==0)continue;if(e[s+l]==tc.CHAR_SPACE||e[s+l]==tc.TAB)break;if(e[s+l]=="/".charCodeAt(0))u=true}if(l<_||!u)continue;c=t[f].x;for(l=0;l<_;l++){if(e[s+l]=="/".charCodeAt(0)&&l>0&&l<_-1){t=fV(t,i+2);for(a=i-1;a>=f;a--){t[a+2]=t[a]}i+=2;n=f;f+=2;t[n]=t[f];t[n].col=s;t[n].count=l;t[n].width=0;for(a=t[n].col;a<t[n].col+t[n].count;a++)t[n].width+=r[a];t[n].x=c;c+=t[n].width;t[n].IsNumeric=true;t[n].IsDate=false;n++;t[n]=t[f];t[n].col=s+l;t[n].count=1;t[n].width=r[s+l];t[n].x=c;c+=t[n].width;t[n].IsPunct=true;t[n].IsNumeric=false;t[n].IsDate=false;t[f].col=s+l+1;t[f].count=_-l-1;t[f].width=0;for(a=t[f].col;a<t[f].col+t[f].count;a++)t[f].width+=r[a];t[f].x=c;t[f].IsNumeric=true;t[f].IsDate=false;o=true;f--;break}}}}if(o){for(f=0;f<i;f++){for(l=f+1;l<i;l++){if(t[l].col<t[f].col){var T;T=t[f].copy();t[f]=t[l].copy();t[l]=T.copy()}}t[f].TotalLineSeg=i;t[f].idx=f;t[f].pFirstSeg=t}}Dd=i;return t}function wq(t,e){var r=xs[e].CharSet;var i=["+".charCodeAt(0),gk("-"),gk("*"),gk("/"),gk(","),gk("."),gk(";"),gk("@"),gk("#"),gk("%"),gk("^"),gk("&"),gk("~"),gk("?"),gk(":"),gk(";"),gk("|"),gk("\\"),gk("<"),gk(">"),gk("!"),Bn,tc.CELL_CHAR,tc.LINE_CHAR,tc.PICT_CHAR];var f=Wk(i);if(r==tc.SYMBOL_CHARSET)return true;if(t<256){var l=wY(t);if(f.indexOf(l)>=0)return true}if(t==183)return true;if(t>=65280)return true;return false}function bq(t,e,r){var i,f,l,a,n,c,s,_,o,u=0;var T,A=0,E=0;var R=false,L=false,C=false;var I;var d;var F=39;pSeg=[];var g=0;var P=1;var S=2;var h=3;var O=4;var v=5;var p=6;d=nb(t);I=ui[t].txt;R=Nj(ui[t].flags2&tc.LFLAG2_PARA_RTL);e=ui[t].len;if(e>0&&I[e-1]!=Bn||I[e-1]!=TR||BY(I[e-1]))e--;for(i=0;i<e;i++){if(xs[d[i]].flow==tc.FLOW_DEF){if(!Yq(I[i]))continue;break}}if(i==e)return false;e=ui[t].len;pSeg=[e+1];for(i=0;i<e+1;i++)pSeg[i]=new tc.ClsSeg;a=0;s=g;for(i=0;i<e;i++){n=d[i];T=I[i];if(i+1<e)E=I[i+1];else E=0;L=i+1==e;var N=um(n);if(xs[n].CharSet==tc.SYMBOL_CHARSET||N)c=S;else{if(T>=tc.CHAR_a&&T<=tc.CHAR_z)c=g;else if(T>=tc.CHAR_A&&T<=tc.CHAR_Z)c=g;else if(Yq(T))c=P;else if(T>=tc.CHAR_0&&T<=tc.CHAR_9)c=h;else if(T==".".charCodeAt(0)||T==gk(","))c=O;else if(T=="@".charCodeAt(0)&&E!=0&&(E>=tc.CHAR_a&&E<=tc.CHAR_z||E>=tc.CHAR_A&&E<=tc.CHAR_Z))c=g;else if((T==":".charCodeAt(0)||T=="/".charCodeAt(0))&&s==h&&(L||E>=tc.CHAR_0&&E<=tc.CHAR_9))c=h;else if(T=="$".charCodeAt(0))c=v;else if(T==tc.SPACE||T==tc.NBSPACE_CHAR)c=p;else if((T==Bn||T==tc.LINE_CHAR||T==TR)&&xs[d[i]].rtlch)c=P;else if(wq(T,n)){if(i==0&&xs[d[i]].rtlch)c=P;else c=S}else if(T=="[".charCodeAt(0)||T=="]".charCodeAt(0)||T=="(".charCodeAt(0)||T==")".charCodeAt(0)||T=="{".charCodeAt(0)||T=="}".charCodeAt(0))c=S;else if(T==tc.QUOTE||T==F)c=S;else{if(s==h||(L||E>=tc.CHAR_0&&E<=tc.CHAR_9))c=h;else c=g}}A=T;s=c;if(i==0){a=0;pSeg[a].col=0;pSeg[a].count=1;pSeg[a].type=c;pSeg[a].FirstChar=I[i];continue}else if(pSeg[a].type!=c||pSeg[a].type==S&&N){a++;pSeg[a].col=i;pSeg[a].count=0;pSeg[a].type=c;pSeg[a].FirstChar=I[i]}pSeg[a].count++}o=a+1;u=0;t:while(true){for(i=0;i<o;i++){if(pSeg[i].type==p){s=g;for(f=i-1;f>=0;f--){if(pSeg[f].type==g||pSeg[f].type==P)break}if(f>=0)s=pSeg[f].type;_=s;for(f=i+1;f<o;f++){if(pSeg[f].type==g||pSeg[f].type==P)break}if(f<o)_=pSeg[f].type;if(R){if(i+1<o&&_==P)pSeg[i].type=P;else if(i>0&&s==P)pSeg[i].type=P;else if(i+1<o&&_==g)pSeg[i].type=g;else if(i>0&&s==g)pSeg[i].type=g;else if(u==1)pSeg[i].type=S}else{if(i+1<o&&pSeg[i+1].type==g)pSeg[i].type=g;else if(i>0&&s==g)pSeg[i].type=g;else if(i+1<o&&pSeg[i+1].type==P)pSeg[i].type=P;else if(i>0&&s==P)pSeg[i].type=P;else if(u==1)pSeg[i].type=S}}}for(i=0;i<o;i++){if(pSeg[i].type==O){if(i>0&&i<o-1&&pSeg[i-1].type==h&&pSeg[i+1].type==h)pSeg[i].type=h;else pSeg[i].type=S}else if(pSeg[i].type==v){if(i<o-1&&pSeg[i+1].type==h)pSeg[i].type=h;else pSeg[i].type=S}}for(i=0;i<o;i++){if(pSeg[i].type==h){if(i>0){if(pSeg[i-1].type==P||pSeg[i-1].type==g)pSeg[i].type=pSeg[i-1].type;else{for(f=i-1;f>=0;f--){if(pSeg[f].type==P||pSeg[f].type==g){for(l=f+1;l<=i;l++)pSeg[l].type=pSeg[f].type;break}}if(f<0)pSeg[i].type=g}}else pSeg[i].type=g}}for(i=0;i<o;i++){if(pSeg[i].type==S){s=g;for(f=i-1;f>=0;f--){if(pSeg[f].type==g||pSeg[f].type==P)break}if(f>=0)s=pSeg[f].type;_=s;for(f=i+1;f<o;f++){if(pSeg[f].type==g||pSeg[f].type==P)break}if(f<o)_=pSeg[f].type;T=pSeg[i].FirstChar;if(T=="(".charCodeAt(0)||T=="[".charCodeAt(0)||T=="{".charCodeAt(0)||T=="<".charCodeAt(0))pSeg[i].type=_;else if(T==")".charCodeAt(0)||T=="]".charCodeAt(0)||T=="}".charCodeAt(0)||T==">".charCodeAt(0))pSeg[i].type=s;else{if(i>0&&i<o-1&&pSeg[i-1].type==g&&pSeg[i+1].type==g)pSeg[i].type=g;else if(i>0&&i<o-1&&pSeg[i-1].type==P&&pSeg[i+1].type==P)pSeg[i].type=P;else if(R&&(i>0&&pSeg[i-1].type==g)&&(i+1<o&&pSeg[i+1].type==P))pSeg[i].type=P;else if(R&&(i>0&&pSeg[i-1].type==P)&&(i+1<o&&pSeg[i+1].type==g))pSeg[i].type=P;else if(u==1&&pSeg[i].count==1){T=pSeg[i].FirstChar;if(T=="[".charCodeAt(0)||T=="]".charCodeAt(0)||T=="(".charCodeAt(0)||T==")".charCodeAt(0)||T=="{".charCodeAt(0)||T=="}".charCodeAt(0))pSeg[i].type=R?P:g;else if(T==".".charCodeAt(0)&&i>0)pSeg[i].type=pSeg[i-1].type}}}}if(u==0){for(i=0;i<o;i++){if(pSeg[i].type!=P&&pSeg[i].type!=g){u++;continue t}}}break}for(i=0;i<o;i++)if(pSeg[i].type==S)pSeg[i].type=g;l=0;for(i=0;i<o;i++){for(f=0;f<pSeg[i].count;f++,l++){if(pSeg[i].type==P)r[l]=tc.FLOW_RTL;else r[l]=tc.FLOW_LTR}}var D=tc.HEBREW_CHARSET;for(i=0;i<ui[t].len;i++){T=I[i];if(r[i]==tc.FLOW_RTL){if(kq(T)){D=tc.ARABIC_CHARSET;break}}}var M=false;var G=false;for(i=0;i<ui[t].len;i++){var B=tc.ANSI_CHARSET;var H=false;T=I[i];if(r[i]==tc.FLOW_RTL){var m=kq(T);var w=!m&&Yq(T);if(w)B=tc.HEBREW_CHARSET;else if(m)B=tc.ARABIC_CHARSET;else if(M){B=tc.ARABIC_CHARSET;m=true}else if(G){B=tc.HEBREW_CHARSET;w=true}else{if(r[i]==tc.FLOW_RTL){B=D;w=B==tc.HEBREW_CHARSET;m=B==tc.ARABIC_CHARSET}else{r[i]=tc.FLOW_LTR;B=tc.ANSI_CHARSET}}H=xs[d[i]].CharSet!=B;M=m;G=w}else H=xs[d[i]].CharSet==tc.HEBREW_CHARSET||xs[d[i]].CharSet==tc.ARABIC_CHARSET;if(H)d[i]=yb(d[i],B,-1);if(r[i]==tc.FLOW_RTL&&!xs[d[i]].rtlch)d[i]=Jb(d[i],true);else if(r[i]==tc.FLOW_LTR&&xs[d[i]].rtlch)d[i]=Jb(d[i],false)}return true}function xq(t){if(t==1033)return false;if(t==1037)return true;if(t==1025)return true;if(t==1065)return true;if(t==1056)return true;if(t==5121)return true;if(t==15361)return true;if(t==3073)return true;if(t==1)return true;if(t==2049)return true;if(t==11265)return true;if(t==13313)return true;if(t==12289)return true;if(t==4097)return true;if(t==6145)return true;if(t==8193)return true;if(t==16385)return true;if(t==10241)return true;if(t==7169)return true;if(t==14337)return true;if(t==9217)return true;return false}function yq(t){if(t==1033)return false;if(t==1041)return true;if(t==2052)return true;if(t==4100)return true;if(t==1042)return true;if(t==5124)return true;if(t==3076)return true;if(t==1028)return true;if(t==1054)return true;if(t==1066)return true;return false}function Wq(t,e){Em(t,e);return Sm(PC,SC)}function Uq(t,e){Rm(t,e);return Sm(PC,SC)}function kq(t){var e=t;if(e>=1536&&e<=1791)return true;if(e>=1872&&e<=1901)return true;if(e>=64336&&e<=65023)return true;if(e>=65136&&e<=65279)return true;return false}function Xq(t){return t>=1632&&t<=1641}function Kq(t){return t==":".charCodeAt(0)||t=="-".charCodeAt(0)||t==".".charCodeAt(0)||t=="/".charCodeAt(0)}function Yq(t){var e=t;if(e>=1536&&e<=1791)return true;if(e>=1872&&e<=1901)return true;if(e>=64336&&e<=65023)return true;if(e>=65136&&e<=65279)return true;if(e>=1425&&e<=1479)return true;if(e>=1488&&e<=1514)return true;if(e>=1520&&e<=1524)return true;return false}function Vq(t,e,r,i){var f=[];var l,a=0;f=Nj(i)?i:Mq(t,null,-1);r=Dd;if(Dj(f)||r==0)return 0;for(l=r-1;l>=0;l--)if(e>=f[l].col)break;a=l;return a}function jq(t){var e,r;if(!jl)return false;r=l$(t);for(e=0;e<Dl;e++){if(pl[e].empty&&Dj(pl[e].flags1&tc.FRAME1_PARA_FRAME_BOX))continue;if(pl[e].ParaFrameId==0)continue;if(t>=pl[e].PageFirstLine&&t<=pl[e].PageLastLine)continue;if(r>=pl[e].y&&r<=pl[e].y+pl[e].height)return true}return false}function Jq(t,e){return zq(t,e,-1)}function zq(t,e,r){var i=Zq(t,e,r);if(i>=Ri)i=Ri-1;if(i<0)i=0;return i}function Zq(t,e,r){var i,f,l,a,n,c,s,_,o,u=-1,T=-1,A=-1,E=0,R,L=0,C=0,I=0;var d,F,g;var P,S,h;var O;var v=-1,p=-1;var N=0;var D=Nj(aO&tc.TOFLAG_SET_MOUSE_ON_TEXT_LINE)?true:false;var M=Sa.altKey;Xa=true;Ha=-1;if(oi.PageMode){if(Nj(Qh&tc.TFLAG3_CURSOR_IN_CELL)&&ui[br].cid>0)N=ui[br].cid;t:{if(r>=0){n=r;break t}if(jl&&Dj(N)){O=false;for(a=0;a<Dl;a++){if(pl[a].empty&&Dj(pl[a].flags1&tc.FRAME1_PARA_FRAME_BOX))continue;if(pl[a].ParaFrameId==0)continue;if(Nj(pl[a].flags&tc.FRAME_DISABLED)&&Dj(nO&tc.TOFLAG2_CHECK_DISABLED_FRAMES))continue;d=pl[a].ParaFrameId;if(M&&Dj(kl[d].flags&tc.PARA_FRAME_BEHIND_TEXT))continue;if(!M&&Nj(kl[d].flags&tc.PARA_FRAME_BEHIND_TEXT))continue;e:{if(Nj(kl[d].flags&tc.PARA_FRAME_RECT)&&Dj(kl[d].flags2&tc.PF2_CANVAS)&&kl[d].canvas==0&&(kl[d].ShapeType==0||kl[d].ShapeType==tc.SHPTYPE_RECT)){pl[a].flags1|=tc.FRAME1_RECT;if(Qq(a,t,e))break e}else{if(C$(t,e,a))break e}continue}if(!O){I=a;O=true}else if(pl[a].x>L||pl[a].y>C)I=a;if(Nj(pl[a].flags1&tc.FRAME1_PARA_FRAME_BOX))v=a;else p=a;L=pl[a].x;C=pl[a].y}if(O)a=I;if(a<Dl&&Nj(pl[a].flags&tc.FRAME_PICT)){Ha=a;return pl[a].PageFirstLine}}else a=Dl;if(a==v&&Dj(pl[a].flags&tc.FRAME_DISABLED)){if(p!=-1)a=p;else{P=pl[v].PageLastLine;if(GY(P,tc.INFO_ROW)&&P>0)P--;return P}}if(a==Dl){for(a=0;a<Dl;a++){if(pl[a].empty||pl[a].ParaFrameId>0)continue;if(Nj(pl[a].flags&tc.FRAME_DISABLED)&&Dj(nO&tc.TOFLAG2_CHECK_DISABLED_FRAMES))continue;if(Nj(N)&&pl[a].CellId!=N)continue;if(t>=pl[a].x&&t<pl[a].x+pl[a].width&&e>=pl[a].y&&e<pl[a].y+pl[a].height)break}}if(a==Dl){if(D)Xa=false;for(a=0;a<Dl;a++){if(pl[a].empty)continue;if(Nj(pl[a].flags&tc.FRAME_DISABLED)&&Dj(nO&tc.TOFLAG2_CHECK_DISABLED_FRAMES))continue;if(Nj(N)&&pl[a].CellId!=N)continue;if(pl[a].ParaFrameId>0){d=pl[a].ParaFrameId;if(Nj(kl[d].flags&tc.PARA_FRAME_BEHIND_TEXT)){if(C$(t,e,a))break}else continue}if(e>=pl[a].y&&e<pl[a].y+pl[a].height)break;if(e<Ze&&a<Qe){if(u==-1)u=a;T=a}else if(e>=Ze&&a>=Qe){if(u==-1)u=a;T=a}R=Math.abs(e-pl[a].y);if(A<0){A=a;E=R}if(R<E){A=a;E=R}R=Math.abs(pl[a].y+pl[a].height-e);if(R<E){A=a;E=R}}}if(a==Dl){if(D)Xa=false;if(Nj(N)){for(a=0;a<Dl;a++)if(pl[a].CellId==N)break;if(a<Dl)A=a}if(A>=0){var G=Math.abs(pl[A].y-e);var B=Math.abs(pl[A].y+pl[A].height-e);if(G<B)P=pl[A].PageFirstLine;else P=pl[A].PageLastLine;if(P>0&&GY(P,tc.INFO_ROW))P--;return P}if(u>=0&&e<pl[u].y)return pl[u].PageFirstLine;if(T>=0&&e>=pl[T].y+pl[T].height)return pl[T].PageLastLine;if(Lo>=To-1)S=Ri-1;else S=po[Lo+1].FirstLine;if(br>=po[Lo].FirstLine&&br<=S)return br;if(T>=0)return pl[T].PageFirstLine;return br}n=a}d=pl[n].ParaFrameId;l=pl[n].y+pl[n].SpaceTop;f=pl[n].x+pl[n].SpaceLeft;i=I$(n);if(i==0||r>0)e-=l;else if(i==90){g=g$(pl[n].x,pl[n].y,n);e=t-g}else{var H=pl[n].height;g=g$(pl[n].x,pl[n].y,n)-H;e=H-(t-g);e-=pl[n].SpaceTop}h=pl[n].PageLastLine;if(h>0&&h<Ri&&Nj(ui[h].tabw)&&Nj(ui[h].tabw.type&tc.INFO_ROW))h--;o=0;for(P=pl[n].PageFirstLine;P<h;P++){if(L6(P)!=pl[n].level)continue;F=$q(P,true);if(o+F>e)break;o=o+F}}else{n=0;c=pl[n].RowOffset;for(P=pl[n].ScrFirstLine;P<=pl[n].ScrLastLine;P++){s=ra[c+P-pl[n].ScrFirstLine];_=ra[c+P+1-pl[n].ScrFirstLine];if(e>=s&&e<_)break}if(e<ra[c])P=pl[n].ScrFirstLine;if(P>pl[n].ScrLastLine){P=pl[n].ScrLastLine;if(D)Xa=false}}return P}function Qq(t,e,r){var i,f,l,a,n;i=hV(tc.RULER_TOLERANCE)/2;if(Nj(aO&tc.TOFLAG_NO_TOL))i=0;f=pl[t].x;l=pl[t].y;a=f+pl[t].width;n=l+pl[t].height;if(r>=l-i&&r<=n+i){if(e>=f-i&&e<=f+i)return true;if(e>=a-i&&e<=a+i)return true}if(e>=f-i&&e<=a+i){if(r>=l-i&&r<=l+i)return true;if(r>=n-i&&r<=n+i)return true}return false}function qq(){return oi.PageMode||oi.PrintView&&!oi.FittedView}_i.TerScrLineHeight=function(t){if(!lv||!QD())_i.TerCreateControl();if(t<0||t>=Ri)return 0;return $q(t,true)};function $q(t,e){return t$(t,e,false)}function t$(t,e,r){var i,f,l,a,n;if(t>=Ri)t=Ri-1;if(qq()){f=ui[t].ScrHt;if(e)f+=vW(t,true)}else{f=r$(t,r);s$(t,f,true);f+=Sd+hd}return f}function e$(t){return r$(t,false)}function r$(t,e){var r,i,f=0,l=0,a=0,n,c,s=0;var _=0;var o=9999,u=o,T=o,A,E;var R;var L;var C;var I,d,F;var g=0;var P=0;pd=g;Nd=P;if(t>=Ri)f=xs[0].height;else if(ui[t].fmt==null){C=ui[t].UniFmt;n=xs[C].height-xs[C].BaseHeight;if(xs[C].OffsetVal>0)n-=xs[C].OffsetVal;A=xs[C].OffsetVal;u=T=0;if(A>0)u=A;else T=-A;s=xs[C].BaseHeight;f=s+n-T;if(Nj(T))s-=T;if(Nj(u))s+=u;a=xs[C].ExtLead}else if(ui[t].len>0){var S=false;R=ui[t].fmt;L=ui[t].txt;C=R[0];f=l=a=0;s=0;r=ui[t].len;I=d=F=false;c=0;if(r>1&&Nj(ui[t].flags&(tc.LFLAG_PARA|tc.LFLAG_LINE))){c=R[r-1]}for(i=0;i<r;i++){if(!F&&Dj(xs[R[i]].style&tc.PICT)&&r>1&&Nj(ui[t].flags&(tc.LFLAG_PARA|tc.LFLAG_LINE))){if(i!=r-1){r--;F=true;if(i==r)break}}if(!d&&(L[i]==tc.CHAR_SPACE||L[i]==tc.TAB)&&xs[R[i]].height>0)d=true;if((L[i]==tc.CHAR_SPACE||L[i]==tc.TAB)&&(i<r-1||I))continue;if(F&&(L[i]==Bn||L[i]==TR||L[i]==tc.SECT_CHAR)&&(i<r-1||I)&&xs[R[i]].FieldId!=tc.FIELD_TEXTBOX)continue;if(e&&Nj(xs[R[i]].style&tc.PICT)){if(xs[R[i]].ParaFID==0)S=true;continue}if(Nj(xs[R[i]].style&tc.PICT)&&xs[R[i]].ParaFID>0){var h=R[i];var O=xs[h].ParaFID;if(Dj(kl[O].flags2&tc.PF2_INLINE)){if(i==0&&Nj(ui[t].flags2&tc.LFLAG2_SPACE_TAKING_FRAME)&&fW(O)){s=kl[O].height;s=Eu?mV(s):hV(s)}continue}}if(!I||R[i]!=C){C=R[i];var v=xs[C].BaseHeight;if(xs[C].OffsetVal<0){if(v>s)s=v;n=xs[C].height-v;if(n>l)l=n;v+=xs[C].OffsetVal}if(v>s)s=v;n=xs[C].height-v;if(n>l)l=n;if(xs[C].ExtLead>a)a=xs[C].ExtLead;if(xs[C].height>0)I=true}}if(oi.PrintView){if(e){if(S)f=s+l;else f=yV(ui[t].TextHt)}else f=yV(ui[t].height)}else f=s+l;if(f==0&&(d||F)){f=xs[c].height;s=xs[c].BaseHeight;a=xs[c].ExtLead}}else{f=xs[0].height;s=xs[0].BaseHeight;a=xs[0].ExtLead}if(Eu){f=xV(f);a=xV(a);s=xV(s)}P=a;g=s;pd=g;Nd=P;return f}function i$(t,e,r,i){var f,l=0,a=0,n=0,c=0;var s=0;var _=0;var o=0;pd=_;Nd=o;for(f=0;f<r;f++){if(f>0&&(t[f]==Bn||t[f]==tc.LINE_CHAR))continue;if(e[f]!=s||f==0){s=e[f];if(i){if(xs[s].BaseHeight>c)c=xs[s].BaseHeight;if(xs[s].height-xs[s].BaseHeight>a)a=xs[s].height-xs[s].BaseHeight;if(xs[s].ExtLead>n)n=xs[s].ExtLead}else{if(Xs[s].BaseHeight>c)c=Xs[s].BaseHeight;if(Xs[s].height-Xs[s].BaseHeight>a)a=Xs[s].height-Xs[s].BaseHeight;if(Xs[s].ExtLead>n)n=Xs[s].ExtLead}}}l=c+a;_=c;o=n;pd=_;Nd=o;return l}function f$(t){var e,r;e=iW(t);if(e<0)return bV(ui[t].JustAdjX);if(t<pl[e].ScrFirstLine||t>pl[e].ScrLastLine){var i=0;if(oi.PageMode&&Ci)i=pl[e].SpaceLeft;return i+bV(ui[t].JustAdjX)}r=pl[e].RowOffset;return fa[r+t-pl[e].ScrFirstLine]}function l$(t){var e,r,i;var f,l=t;if(t<0||t>=Ri)return 0;if(oi.PageMode){if(Nj(ui[t].flags&(tc.LFLAG_HDR|tc.LFLAG_FHDR))){if(t+1<Ri&&Nj(Nc[ui[t+1].pfmt].flags&tc.PAGE_HDR))t++;else if(t>0)t--}if(Nj(ui[t].flags&(tc.LFLAG_FTR|tc.LFLAG_FFTR))){if(t+1<Ri&&Nj(Nc[ui[t+1].pfmt].flags&tc.PAGE_FTR))t++;else if(t>0)t--}e=iW(t);if(e<0)return 0;i=pl[e].y+pl[e].SpaceTop;for(f=pl[e].PageFirstLine;f<l;f++){if(L6(f)!=pl[e].level)continue;i+=$q(f,true)}return i+vW(l,true)}else{e=0;if(t<pl[e].ScrFirstLine)t=pl[e].ScrFirstLine;if(t>pl[e].ScrLastLine)t=pl[e].ScrLastLine;r=pl[e].RowOffset;return ra[r+t-pl[e].ScrFirstLine]}}function a$(t,e,r){var i,f;if(r==undefined)r=false;if(!oi.PageMode)return t>=fr&&t<=fr+Dt;if((f=iW(t))==-1)return false;if(t<pl[f].ScrFirstLine||t>pl[f].ScrLastLine)return false;if(r){var l=l$(t);if(l<Gt)return false;var a=l+yV(ui[t].height);if(a-Gt>Mt)return false}i=Fq(e,t,tc.TER_LEFT);return i>=Ft&&i<=Ft+je}function n$(t){var e;e=iW(t);if(e<0)return false;return t>=pl[e].ScrFirstLine&&t<=pl[e].ScrLastLine}function c$(t){var e,r;e=iW(t);if(e<0)return 0;if(t<pl[e].ScrFirstLine||t>pl[e].ScrLastLine)return 0;r=pl[e].RowOffset;return ia[r+t-pl[e].ScrFirstLine]}function s$(t,e,r){return _$(t,e,r)}function _$(t,e,r){var i;Sd=0;hd=0;Od=0;vd=0;if(e==0){e=r$(t,true);if(!r&&!Eu)e=xV(e)}if(e==0)return true;return o$(t,e,r)}function o$(t,e,r){var i,f=0,l=0,a,n,c,s,_,o,u,T;var A=0;var E;var R;var L=0;var C=0;var I=0;var d=0;var F;var g;var P,S;Sd=L;hd=C;Od=I;vd=d;if(e==0)return true;a=ui[t].pfmt;if(Nj(aO&tc.TOFLAG_WRAPPING)){ui[t].GridSpace=0;if(Dj(Nc[ui[t].pfmt].flags&tc.PAGE_HDR_FTR)&&Dj(Nc[ui[t].pfmt].pflags&tc.PFLAG_NO_SNAP_TO_GRID)){for(i=0;i<ro;i++){if(to[i].LineSpace!=0&&Nj(to[i].flags&tc.SECT_SNAP_LINE_GRID)){var h=G5(t),O;var v=e+mV(0);A=mV(to[h].LineSpace);if(h>=0&&Nj(to[i].flags&tc.SECT_SNAP_LINE_GRID)&&to[h].LineSpace!=0){if(Nc[a].LineSpacing!=0){S=Mj(A,Nc[a].LineSpacing+100,100);ui[t].GridSpace=S-v;if(ui[t].GridSpace<0)ui[t].GridSpace=1}else if(Nj(Nc[a].flags&tc.DOUBLE_SPACE)){S=A*2;ui[t].GridSpace=S-v;if(ui[t].GridSpace<0)ui[t].GridSpace=1}else{O=v/A;if(v>A*O)O++;ui[t].GridSpace=A*O}}break}}}}if(Nc[a].SpaceBetween!=0){if(r)n=hV(Nc[a].SpaceBetween);else n=mV(Nc[a].SpaceBetween);if(Nc[a].SpaceBetween>0){if(n>e)f+=n-e}else{n=-n;_=n-e;if(_>0){o=0;u=_}else{var p;r$(t,true);p=pd;if(!r&&!Eu)p=xV(p);o=Mj(_,p,e);u=_-o}f+=o;l+=u}}else if(Nc[a].LineSpacing!=0){E=false;R=nb(t);for(i=0;i<ui[t].len;i++)if(Nj(xs[R[i]].style&tc.PICT))E=true;if(ui[t].GridSpace>0){F=ui[t].GridSpace;if(r&&!Eu)F=yV(F);f=F/2;l=F-f}else{if(E){F=r$(t,true);if(!r&&!Eu)F=xV(F)}else F=e;if(Nc[a].LineSpacing<0)f+=Mj(F,Nc[a].LineSpacing,100);else l+=Mj(F,Nc[a].LineSpacing,100)}}else if(Nj(Nc[a].flags&tc.DOUBLE_SPACE)){E=false;R=nb(t);for(i=0;i<ui[t].len;i++)if(Nj(xs[R[i]].style&tc.PICT))E=true;if(ui[t].GridSpace>0){F=ui[t].GridSpace;if(r&&!Eu)F=yV(F);f=F/2;l=F-f}else{if(E){F=r$(t,true);if(!r&&!Eu)F=xV(F)}else F=e;l+=F}}else if(ui[t].GridSpace>0){n=ui[t].GridSpace;if(r)n=yV(n);if(n>e){_=n-e;o=_/2;u=_-o;if(t>0&&ui[t-1].HeightAfter>0){var N=ui[t].cid==ui[t-1].cid&&ui[t].fid==ui[t-1].fid&&ui[t].page==ui[t-1].page;if(N){g=ui[t-1].pfmt;if((Nc[a].flags&tc.PAGE_HDR_FTR)!=(Nc[g].flags&tc.PAGE_HDR_FTR))N=false}if(N){if(r)o-=yV(ui[t-1].HeightAfter);else o-=ui[t-1].HeightAfter;if(o<0)o=0}}if(Nj(ui[t].flags&tc.LFLAG_PARA_FIRST)&&Nc[a].SpaceBefore>0){var D;if(r)D=hV(Nc[a].SpaceBefore);else D=mV(Nc[a].SpaceBefore);o-=D;if(o<0)o=0}if(Nj(ui[t].flags&tc.LFLAG_PARA)&&Nc[a].SpaceAfter>0){var M;if(r)M=hV(Nc[a].SpaceAfter);else M=mV(Nc[a].SpaceAfter);u-=M;if(u<0)u=0}f+=o;l+=u}}if(true||Dj(ui[t].flags&tc.LFLAG_HTML_RULE)){var G=u$(t);var B=Nc[a].SpaceBefore;if(Nj(ui[t].flags&tc.LFLAG_PARA_FIRST)){if(Di&&Nj(Nc[a].flags&tc.AUTO_SPACE_BEFORE)&&B==0){var H=true;if(t==0)H=false;if(t>0){if(ui[t-1].fid!=ui[t].fid)H=false;if(H&&ui[t-1].cid!=ui[t].cid){var m,w;H=false;m=ui[t-1].cid;w=ui[t].cid;if(w==0)H=true;else if(eR[w].level<eR[m].level)H=true}}if(H)B=tc.AUTO_SPACE}if(t>0){var b=u$(t-1);g=ui[t-1].pfmt;if(false&&B>0&&ui[t].cid>0){if(ui[t].cid!=ui[t-1].cid)B=0}if(false&&B>0&&ui[t].fid>0){if(ui[t].fid!=ui[t-1].fid)B=0}if(false&&Di&&B>0&&Nc[a].BltId>0){if(Nc[a].BltId==Nc[g].BltId)B=0}if(Di){if(ui[t-1].cid==ui[t].cid&&ui[t-1].fid==ui[t].fid){if(B>b)B-=b;else B=0}}if(B>0&&t>0){var x=Nc[a].StyId;if(Nj(W_[x].flags&tc.SSFLAG_NO_SPACE)&&x==Nc[ui[t-1].pfmt].StyId)B=0}}a=ui[t].pfmt;if(Nj(Nc[a].flags&tc.PARA_CONTEXTUAL_SPACE)){if(t>0&&Nj(ui[t].flags&tc.LFLAG_PARA_FIRST)){g=ui[t-1].pfmt;if(Nc[g].StyId==Nc[a].StyId&&Nj(Nc[g].flags&tc.PARA_CONTEXTUAL_SPACE))B=0}if(t+1<Ri&&Nj(ui[t+1].flags&tc.LFLAG_PARA_FIRST)){P=ui[t+1].pfmt;if(Nc[P].StyId==Nc[a].StyId&&Nj(Nc[P].flags&tc.PARA_CONTEXTUAL_SPACE))G=0}}}if(Nj(ui[t].flags&tc.LFLAG_BOX_TOP))c=Nc[a].BorderSpaceTop+tc.PARA_BORDER_WIDTH;else c=0;if(Nj(Nc[a].flags&tc.PARA_BOX_DOUBLE)&&c>0)c+=tc.PARA_BORDER_WIDTH/2;s=B+c;if(s>0&&Nj(ui[t].flags&tc.LFLAG_PARA_FIRST)){if(r)n=hV(s);else n=mV(s);f+=n;if(Nj(ui[t].flags&tc.LFLAG_BOX_TOP))I=n;if(Nj(ui[t].flags2&tc.LFLAG2_SHADE_BEGIN))I=n}if(Nj(ui[t].flags&tc.LFLAG_BOX_BOT)||Nj(ui[t].flags2&tc.LFLAG2_BOX_BETWEEN))c=Nc[a].BorderSpaceBot+tc.PARA_BORDER_WIDTH;else c=0;if(Nj(Nc[a].flags&tc.PARA_BOX_DOUBLE)&&c>0)c+=tc.PARA_BORDER_WIDTH/2;s=G+c;if(s>0&&Nj(ui[t].flags&tc.LFLAG_PARA)){if(r)n=hV(s);else n=mV(s);l+=n;if(Nj(ui[t].flags&tc.LFLAG_BOX_BOT))d=n;if(Nj(ui[t].flags2&tc.LFLAG2_SHADE_END))d=n}if(Nj(ui[t].flags&tc.LFLAG_PARA)){var y,W=0,U=t;var k=Nc[a].height;var X=Nc[a].DivId;var K=false;if(X>0&&mc[X].height>k){if(t+1>=Ri)K=true;else{P=ui[t+1].pfmt;K=Nc[P].DivId!=X}if(K){for(y=t-1;y>=0;y--){g=ui[y].pfmt;if(Nc[g].DivId!=X)break;if(ui[y].fid!=ui[t].fid||ui[y].cid!=ui[t].cid){K=false;break}}U=y+1;k=mc[X].height}}if(k>0){k=mV(k);for(y=t;y>=0;y--){if(y==t){if(r)W+=xV(e);else W+=e}else W+=ui[y].height;if(K){if(y==U)break}else if(Nj(ui[y].flags&tc.LFLAG_PARA_FIRST))break}if(W<k){var Y=k-W;if(r)Y=yV(Y);if(l<Y)l=Y}}}}if(t>0&&ui[t].len==1&&GY(t,tc.INFO_CELL)&&L6(t-1)>L6(t)){var V=ui[t].cid;if(r)n=hV(eR[V].margin);else n=mV(eR[V].margin);_=n-e;o=_/2;u=_-o;f=o;l=u}if(ui[t].fid>0&&(t+1>=Ri||ui[t+1].fid!=ui[t].fid)){var j=ui[t].fid;if(kl[j].ShapeId>0||Nj(kl[j].flags&tc.PARA_FRAME_OBJECT))l=0}L=f;C=l;Sd=L;hd=C;Od=I;vd=d;return true}_i.TerLineSpaceAfter=function(t){if(!lv||!QD())_i.TerCreateControl();return u$(t)};function u$(t){var e,r,i;var f;if(Dj(ui[t].flags&tc.LFLAG_PARA))return 0;r=ui[t].pfmt;f=Nc[r].SpaceAfter;if(Nj(Nc[r].flags&tc.AUTO_SPACE_AFTER)){if(f==0)f=tc.AUTO_SPACE;if(t>=Ri-1)f=0;else{i=ui[t+1].pfmt;if(f>0&&ui[t].cid>0){if(GY(t,tc.INFO_CELL|tc.INFO_ROW))f=0}if(f>0&&ui[t].fid>0){if(ui[t].fid!=ui[t+1].fid)f=0}if(f>0&&Nc[r].BltId>0){if(Nc[r].BltId==Nc[i].BltId)f=0}}}if(t+1<Ri){if(ui[t].cid==ui[t+1].cid&&!GY(t,tc.INFO_CELL)&&ui[t].fid==ui[t+1].fid){i=ui[t+1].pfmt;if(Dj(Nc[i].flags&tc.AUTO_SPACE_BEFORE)){if(Di){f-=Nc[i].SpaceBefore;if(f<0)f=0}}}}if(t+1<Ri){i=ui[t+1].pfmt;e=Nc[r].StyId;if(Nj(W_[e].flags&tc.SSFLAG_NO_SPACE)&&e==Nc[i].StyId)f=0}r=ui[t].pfmt;if(Nj(Nc[r].flags&tc.PARA_CONTEXTUAL_SPACE)){if(t+1<Ri&&Nj(ui[t].flags&tc.LFLAG_PARA)){i=ui[t+1].pfmt;if(Nc[i].StyId==Nc[r].StyId&&Nj(Nc[i].flags&tc.PARA_CONTEXTUAL_SPACE))f=0}}return f}function T$(t){var e=ui[t].pfmt;var r=Nc[e].DivId;var i=mc[r].height;var f=0;var l;if(r==0||i>=0)return false;i=-i;i=mV(i);for(l=t-1;l>=0;l--){var a=ui[l].pfmt;if(Nc[a].DivId!=r)break;if(ui[l].fid!=ui[t].fid||ui[l].cid!=ui[t].cid)break;f+=ui[l].height;if(f>i)return true}return false}function A$(t){return!um(t)}function E$(t,e,r,i){var f;var l,a,n,c;var s,_,o;if(r<0||r>=Dl)return t;s=pl[r].BoxFrame;_=pl[r].ParaFrameId;c=pl[r].x+(Eu?Le:0);o=0;l=c+o;n=pl[r].width;if(n>=9999&&!Eu)n=je;a=n;if(oi.FittedView&&a>=je)a=je-1;if(kl[_].TextAngle!=0)a=pl[s].height-pl[s].SpaceTop-pl[s].SpaceBot;if(!i.InUse)f=l+(a-(t-l))-e;else{var u=i.pFirstSeg;var T=i.idx;var A=i.TotalLineSeg,E,R,L,C,I,d,F;var g=i.rtlch;var P=i.IsTab;var S=i.IsObj;var h=i.IsNumeric;var O=i.IsPunct;var v=i.IsParen;if(i.ParaRtl&&i.NoMerge)C=I=T;else{for(d=T;d>=0;d--){if(u[d].rtlch!=g||u[d].IsTab!=P)break;if(i.ParaRtl&&d<T&&u[d].NoMerge)break;if(i.ParaRtl&&g){if(u[d].IsObj!=S||u[d].IsNumeric!=h||u[d].IsParen!=v||u[d].IsPunct!=O)break}}C=d+1;for(d=T;d<A;d++){if(u[d].rtlch!=g||u[d].IsTab!=P)break;if(i.ParaRtl&&d>T&&u[d].NoMerge)break;if(i.ParaRtl&&g){if(u[d].IsObj!=S||u[d].IsNumeric!=h||u[d].IsParen!=v||u[d].IsPunct!=O)break}}I=d-1}R=u[C].x;if(I>C&&u[I].AllSpaces&&u[I].rtlch)I--;E=u[I].x+u[I].width-R;if(!i.ParaRtl){if(i.rtlch){F=i.x-R;R-=o;L=R+(E-(F+i.width));t-=i.x+c;if(i.rtl&&!i.IsNumeric&&!i.ForceDrawLtr)f=L+(i.width-t-e);else f=L+t;f+=l}else{F=i.x-R;R-=o;L=R+F;t-=i.x+c;if(i.rtl)f=L+(i.width-t-e);else f=L+t;f+=l}}else{if(i.rtlch&&!i.IsNumeric){F=i.x-R;R-=o;R=a-R-E;L=R+(E-(F+i.width));t-=i.x+c;if(i.rtl&&!i.ForceDrawLtr)f=L+(i.width-t-e);else f=L+t;f+=l}else{F=i.x-R;R-=o;R=a-R-E;L=R+F;t-=i.x+c;if(i.rtl&&!i.IsNumeric)f=L+(i.width-t-e);else f=L+t;f+=l}}}return f}function R$(t,e,r){var i,f;var l=pl[e].ParaFrameId,a,n;var c=I$(e);i=pl[e].x+pl[e].SpaceLeft+(Eu?Le:0);f=pl[e].width-pl[e].SpaceLeft-pl[e].SpaceRight;if(c!=0)f=pl[e].height-pl[e].SpaceTop-pl[e].SpaceBot;if(Df){n=i+(i+f-t.left);a=i+(i+f-t.right)}else{a=E$(t.left,0,e,r);n=E$(t.right,0,e,r)}if(n<a){a=WY(a,n);n=JC}t.left=a;t.right=n;return t}function L$(t){if(t.right<t.left){t.left=WY(t.left,t.right);t.right=JC}if(t.bottom<t.top){t.bottom=WY(t.bottom,t.top);t.top=JC}return t}function C$(t,e,r){var i,f,l,a,n,c;var s;var _=false;i=pl[r].x;f=pl[r].y;l=pl[r].width;a=pl[r].height;n=pl[r].ParaFrameId;if(n>0&&kl[n].TextAngle!=0)_=true;if(_&&I$(r)>0&&Dj(pl[r].flags1&tc.FRAME1_PARA_FRAME_BOX)){s=VY(i,f,i+l,f+a);s=S$(s,r);s=L$(s);i=s.left;f=s.top;l=s.right-s.left;a=s.bottom-s.top}if(Nj(kl[n].flags&tc.PARA_FRAME_LINE)&&Dj(aO&tc.TOFLAG_NO_TOL))c=hV(tc.RULER_TOLERANCE);else c=0;return t>=i-c&&t<i+l+c&&e>=f-c&&e<f+a+c}function I$(t){var e,r,i=0;e=pl[t].ParaFrameId;r=pl[t].CellId;if(e>0)i=kl[e].TextAngle;if(i==0&&r>0)i=eR[r].TextAngle;return i}function d$(t,e){var r=pl[e].BoxFrame;var i=pl[e].ParaFrameId;var f,l,a,n;var c,s,_,o,u,T;if(i==0||kl[i].TextAngle==0)return true;f=pl[r].x+pl[r].SpaceLeft+(Eu?Le:0);l=pl[r].y+pl[r].SpaceTop+(Eu?Ce:0);a=pl[r].height-pl[r].SpaceTop-pl[r].SpaceBot;n=pl[r].width-pl[r].SpaceLeft-pl[r].SpaceRight;c=0;o=0;if(Ie==90){_=1;u=f-l;s=-1;T=f+l+a}else{_=-1;u=f+l+n;s=1;T=l-f}t.transform(c,s,_,o,u,T);return true}function F$(t){return true}function g$(t,e,r){var i;var f=pl[r].BoxFrame;var l=pl[r].ParaFrameId;var a=pl[r].CellId;var n,c,s;if(l==0||a>0)f=r;var _=I$(r);if(_==0)return t;if(l==0||a>0){n=pl[f].x+(Eu?Le:0);c=pl[f].y+(Eu?Ce:0);s=pl[f].width}else{n=pl[f].x+pl[f].SpaceLeft+(Eu?Le:0);c=pl[f].y+pl[f].SpaceTop+(Eu?Ce:0);s=pl[f].width-pl[f].SpaceLeft-pl[f].SpaceRight}if(_==90)i=n+e-c;else i=n+c+s-e;return i}function P$(t,e,r){var i;var f=pl[r].BoxFrame;var l=pl[r].ParaFrameId;var a=pl[r].CellId;var n,c,s;if(l==0||a>0)f=r;var _=I$(r);if(_==0)return e;if(l==0||a>0){n=pl[f].x+(Eu?Le:0);c=pl[f].y+(Eu?Ce:0);s=pl[f].height}else{n=pl[f].x+pl[f].SpaceLeft+(Eu?Le:0);c=pl[f].y+pl[f].SpaceTop+(Eu?Ce:0);s=pl[f].height-pl[f].SpaceTop-pl[f].SpaceBot}if(_==90)i=n+c+s-t;else i=-n+t+c;return i}function S$(t,e){var r,i,f,l;var a=pl[e].ParaFrameId;r=g$(t.left,t.top,e);i=P$(t.left,t.top,e);l=t.right-t.left;f=t.bottom-t.top;t.left=r;t.bottom=i;var n=I$(e);if(n==90){t.right=t.left+f;t.top=t.bottom-l}else{t.right=t.left-f;t.top=t.bottom+l}return t}function h$(){var t,e,r,i,f;var l,a,n,c,s,_;ZU("SetScrollBars");if(!_l)return true;if(rf)return true;rf=true;if(oi.ShowVerBar&&b!=null){i=0;if(oi.PageMode){n=oz(0,qe);c=n+Gt;if(Nj(eO&tc.TFLAG7_DRAW_OLD_VSCROLL)){if(Lo==To-1){s=_=n+Yt;a=s-xs[0].height-Mt;if(a<c)a=c}else a=s=_=oz(0,To)}else{s=_=oz(0,To);a=s-Mt}if(_<Mt&&Gt>0)qQ(tc.WM_VSCROLL,tc.SB_PAGEUP,0);if(_==0)i=tc.SCROLL_RANGE;else{i=Mj(Mt,tc.SCROLL_RANGE,_);if(i<ut)i=ut;if(i>tc.SCROLL_RANGE)i=tc.SCROLL_RANGE}if(i==tc.SCROLL_RANGE&&Gt!=0)i--;f=tc.SCROLL_RANGE-i;if(a<=0)t=0;else if(c>0&&c+Mt>=s)t=f;else t=Mj(c,f,a)}else{var o=0,u;f=tc.SCROLL_RANGE;_=0;if(false&&Ri>500)i=ut;else{u=km();for(l=0;l<u;l++){var T=ui[l].ScrHt;_+=T;if(l<fr)o+=T}if(Ue!=-1)o+=zt;if(D$()&&fr>0){fr=0;we=br;yn=tc.WRAP_OFF;cG()}if(_==0)i=tc.SCROLL_RANGE;else{i=Mt*tc.SCROLL_RANGE/(_+Mt);if(i<ut)i=ut;if(i>tc.SCROLL_RANGE)i=tc.SCROLL_RANGE}}f=tc.SCROLL_RANGE-i;if(_==0||fr==0)t=0;else t=Mj(o,f,_);if(t>f)t=f}if(t!=nt||i!=ct){if(t>tc.SCROLL_RANGE-i)t=tc.SCROLL_RANGE-i;mi=true;b.SetThumbPos(t,i);mi=false;nt=t;ct=i}}if(oi.ShowHorBar&&w!=null){i=0;if(oi.WordWrap&&(oi.PageMode||!M$())){if(oi.PageMode)e=Tz();else e=M9(br,-1);if(e==0)i=tc.SCROLL_RANGE;else{if(e<=je&&Ft>0&&!_i.HasTouchScreen){var A=Fq(jt,br,tc.LEFT);if(A<je&&rW(br)==0){Ft=0;BG();yn=tc.WRAP_OFF;cG()}}i=je*tc.SCROLL_RANGE/e;if(i<ut)i=ut;if(i>tc.SCROLL_RANGE)i=tc.SCROLL_RANGE}}else{e=0;for(l=fr;l<=pl[0].ScrLastLine;l++){r=B$(l,true,true);if(r>e)e=r}if(e<=je&&Ft>0){Ft=0;BG();yn=tc.WRAP_OFF;cG()}if(e==0)i=tc.SCROLL_RANGE;else{i=je*tc.SCROLL_RANGE/e;if(i<ut)i=ut;if(i>tc.SCROLL_RANGE)i=tc.SCROLL_RANGE}}f=tc.SCROLL_RANGE-i;r=e-je;if(r<=0)r=1;t=Ft*f/r;if(Ft>=e-je)t=f;if(Ft==0)t=0;if(t!=at||i!=st){mi=true;w.SetThumbPos(t,i);mi=false;at=t;st=i}}rf=false;return true}function O$(t,e,r,i){return v$(-1,t,e,r,i,false)}function v$(t,e,r,i,f,l){var a,n,c,s,_,o;var u=false,T=!SS;var A=0;var E=false;var R=false;pLevel=(new tc.ClsListLevel).init();var L=i;if(Gi&&zi&&Zi)R=true;var C=0;var I=0;var d=0;aI=C;cI=I;nI=d;if(Nj(Nc[e].flags&tc.BULLET)&&t>=0&&Nj(ui[t].flags&tc.LFLAG_PARA_FIRST)){var F=Nc[e].BltId;if(F>0&&(pLevel=sQ(xc[F].ls,xc[F].lvl))!=null)E=pLevel.CharAft==tc.LISTAFT_TAB}if(f)i=gV(i)+1;else i=MV(i+1);s=r.count;c=Nc[e].LeftIndentTwips;if(f&&oi.FittedView){var g=dV(c);c=gV(g)}for(a=0;a<s;a++){if(T&&c<r.pos[a]&&c>i&&!l){u=true;if(E&&a==0)u=false;if(u)break}if(T&&c<r.pos[a]&&c>i&&l&&R){u=true}o=0;if(Math.abs(c-i)<10){if(f)o=-gV(3);else o=-MV(3)}o=0;if(r.pos[a]>i+o)break}if(u){n=c;_=tc.TAB_LEFT}else if(a<s){n=r.pos[a];_=r.type[a];A=r.flags[a]}else{if(m_<=0)n=i;else{n=0;if(SS)c=-99999;while(true){if(n>=c){if(c>i){n=c;break}else if(n>i)break}n+=m_}}_=tc.TAB_LEFT}if(f){var P=n;n=dV(n);if(n<=L&&gV(n)<P)n++}else n=DV(n);C=n;I=_;d=A;aI=C;cI=I;nI=d;return true}function p$(t,e,r){var i,f,l;if(Nj(ui[t].tabw)&&Nj(ui[t].tabw.type&tc.INFO_TAB)&&e<ui[t].tabw.count)l=ui[t].tabw.width[e];else if(m_<=0)return 0;else{i=gV(r+1);f=(i/m_+1)*m_;f=dV(f);l=f-r}return l}function N$(t,e){var r=0;if(Nj(ui[t].tabw)&&Nj(ui[t].tabw.type&(tc.INFO_JUST|tc.INFO_ALT_JUST))&&e>=ui[t].tabw.JustSpaceIgnore&&e<ui[t].tabw.JustSpaceCount){r=ui[t].tabw.JustAdj;if(e-ui[t].tabw.JustSpaceIgnore<ui[t].tabw.JustCount)r++}return r}function D$(){var t=0;var e;for(e=0;e<Ri;e++){t+=$q(e,false);if(t>Mt)return false}return true}function M$(){var t;if(Nj(zh&tc.TFLAG_NO_WRAP))return true;for(t=0;t<Dc;t++){if(Nj(Nc[t].pflags&tc.PFLAG_NO_WRAP))return true}return false}function G$(t,e){var r=0,i,f,l;var a;var n;var c;var s=false;while(!s){a=vq(t);if(a==null)break;c=ui[t].txt;n=nb(t);f=ui[t].len;for(i=0;i<f;i++){if(i==f-1&&Nj(ui[t].flags&(tc.LFLAG_PARA|tc.LFLAG_BREAK))){s=true;break}if(a[i]==0)continue;l=n[i];if(Nj(xs[l].style&tc.PICT)&&xs[l].FrameType!=tc.PFRAME_NONE)continue;if(Eu)r+=a[i];else r+=wV(a[i]);if(c[i]==tc.CHAR_SPACE){s=true;break}}if(s||t+1>=Ri-1)break;t++}if(e)r=bV(r);return r}_i.TerGetLineWidth=function(t){if(!lv||!QD())_i.TerCreateControl();return B$(t,false,false)};_i.TerGetLineWidth2=function(t,e){if(!lv||!QD())_i.TerCreateControl();return B$(t,false,e)};function B$(t,e,r){return H$(t,false,e,r)}function H$(t,e,r,i){var f,l=0,a=0,n=0,c,s,_=0;var o=null;var u;var T;var A=null;var E=ui[t].tabw!=null&&Nj(ui[t].tabw.type&tc.INFO_ALT_JUST)&&ui[t].tabw.CharFlags!=null;if(E&&Nj(nO&tc.TOFLAG2_DRAW_FNOTE))E=false;if(t>=Ri)return 0;if(ui[t].len==0)return 0;if(!oi.PrintView)i=true;if(Eu)i=true;u=ui[t].txt;c=ui[t].len;if(c>0&&!r&&u[c-1]==tc.SECT_CHAR)c--;if(c>0&&!r&&(u[c-1]==Bn||u[c-1]==TR||u[c-1]==tc.LINE_CHAR))c--;if(!r){while(c>0){if(u[c-1]!=tc.CHAR_SPACE)break;if(ui[t].fmt==null)T=ui[t].UniFmt;else T=ui[t].fmt[c-1];if(xs[T].FieldId!=0)break;c--}}_=c;if(e){while(_>0){if(u[_-1]!=tc.TAB)break;_--}}if(c==0)return 0;if(i&&null==(A=vq(t)))return 0;if(Nj(ui[t].flags&tc.LFLAG_ASSUMED_TAB))a++;s=a;if(ui[t].fmt==null){T=ui[t].UniFmt;for(f=0;f<c;f++){if(i)l+=A[f];else l+=Gx(T,i,u[f])}}else{o=ui[t].fmt;T=o[0];for(f=0;f<c;f++){if(!Hi&&u[f]==tc.TAB&&e&&a>=s){var R=ui[t].pfmt;var L=Nc[R].TabId;var C=a-s;if(C<B_[L].count&&B_[L].type[C]!=tc.TAB_LEFT&&f>=_)break}if(i){l+=A[f];continue}if(o[f]!=T)T=o[f];if(u[f]==tc.TAB){var I=p$(t,a,bV(l));l+=I;a++}else if(u[f]==tc.CHAR_SPACE&&Nj(ui[t].tabw)&&Nj(ui[t].tabw.type&tc.INFO_JUST)&&A$(T)){l=l+Gx(T,i,u[f])+N$(t,n);n++}else{if(E){var d=N$(t,n);if(Nj(ui[t].tabw.type&tc.INFO_NEG_JUST))l-=d;else l+=d;n++}l+=Gx(T,i,u[f])}}}return l}function m$(){var t;var e=_i.DlgCompHeight;var r=_i.DlgFont;var f=new $t.DialogBox(te,"Jump To",r,true,n,JV(2));var i=f.cvs;var l=new $t.Label(i,0,0,r,"Jump to Line Number");f.addComp(l,0,0,1,1,"Left","middle",0,0,JV(30));var a=new $t.TextBox(i,0,0,60,e,"",r,_i.caret,false,true,null);f.addComp(a,0,1,1,1,"left","middle",0,0,JV(30));f.show();a.setFocus();function n(t,e,r){if(t=="Cancel"){f.hide();return}else if(t=="OK"){var i=LX(a);if(i<0)return;f.hide();Iq(i)}else return}return true}_i.TerGetScreenRes=function(t,e){if(t)return e?Nt:yt;else return e?wt:Wt};_i.TerScrToTwipsX=function(t){var e;if(!lv||!QD())_i.TerCreateControl();t=t-rt.left;t+=Ft;e=gV(t);if(oi.PageMode)e=sW(e);cd=e;return true};_i.TerScrToTwipsY=function(t){var e;if(!lv||!QD())_i.TerCreateControl();t=t-rt.top;t+=Gt;e=vV(t);if(oi.PageMode)e=_W(e);sd=e;return true};function w$(t){var e,r,i;var f;if(ui[t].fmt==null){i=ui[t].UniFmt;return Nj(xs[i].style&tc.HIDDEN)}else{f=ui[t].fmt;r=ui[t].len;for(e=0;e<r;e++)if(Dj(xs[f[e]].style&tc.HIDDEN))return false}return true}function b$(t){return 1}function x$(t,e){return true}function y$(){if(Nj(zh&tc.TFLAG_NO_PRINTER)){Iu=false;return true}if(!U$()||!Iu)return true;return true}function W$(t){r=document.createElement("canvas");re=r.getContext("2d");Iu=true;return true}function U$(){r=document.createElement("canvas");re=r.getContext("2d");Iu=true;return true}function k$(){var t=_i.DlgCompHeight;var e=_i.DlgFont;metric=Nj(zh&tc.TFLAG_METRIC);if(metric)MarginLabel="Margin (cm)";else MarginLabel="Margin (Inches)";var o=G5(br);var r=metric?lj(to[o].LeftMargin):to[o].LeftMargin;var i=metric?lj(to[o].RightMargin):to[o].RightMargin;var f=metric?lj(to[o].TopMargin):to[o].TopMargin;var l=metric?lj(to[o].BotMargin):to[o].BotMargin;var a=metric?lj(to[o].HdrMargin):to[o].HdrMargin;var n=metric?lj(to[o].FtrMargin):to[o].FtrMargin;var u=new $t.DialogBox(te,"Page Parameters",e,true,function(t,e,r){S(t,e,r)});var c=u.cvs;if(metric)LblMargin="Margin (cm)";else LblMargin="Margin (Inches)";u.addGroupBox(0,0,3,5,LblMargin,e,0,JV(10));var s=new $t.Label(c,0,0,e,"Left");u.addComp(s,1,0,1,1,"left","middle",JV(10));var T=new $t.TextBox(c,0,0,JV(60),t,AX(r,2),e,_i.caret,false,true,null);u.addComp(T,1,1,1,1,"left","middle",JV(10));var _=new $t.Label(c,0,0,e,"Right");u.addComp(_,1,3,1,1,"left","middle",JV(-10));var A=new $t.TextBox(c,0,0,JV(60),t,AX(i,2),e,_i.caret,false,true,null);u.addComp(A,1,4,1,1,"left","middle",JV(-10));var E=new $t.Label(c,0,0,e,"Top");u.addComp(E,2,0,1,1,"left","middle",JV(10));var R=new $t.TextBox(c,0,0,JV(60),t,AX(f,2),e,_i.caret,false,true,null);u.addComp(R,2,1,1,1,"left","middle",JV(10));var L=new $t.Label(c,0,0,e,"Bottom");u.addComp(L,2,3,1,1,"left","middle",JV(-10));var C=new $t.TextBox(c,0,0,JV(60),t,AX(l,2),e,_i.caret,false,true,null);u.addComp(C,2,4,1,1,"left","middle",JV(-10));var I=new $t.Label(c,0,0,e,"Header distance from the page top");u.addComp(I,4,0,1,4,"left","middle");var d=new $t.TextBox(c,0,0,JV(60),t,AX(a,2),e,_i.caret,false,true,null);u.addComp(d,4,4,1,1,"left","middle");var F=new $t.Label(c,0,0,e,"Footer distance from the page bottom");u.addComp(F,5,0,1,4,"left","top");var g=new $t.TextBox(c,0,0,JV(60),t,AX(n,2),e,_i.caret,false,true,null);u.addComp(g,5,4,1,1,"left","top");var P=new $t.CheckBox(c,0,0,JV(15),JV(16),e,"All Sections",false,null);u.addComp(P,5,0,1,1,"left","bottom",0);u.show();T.setFocus();function S(t,e,r){if(t=="Cancel"){u.hide();return}else if(t=="OK"){var i;var f,l,a,n,c,s;var _=P.isSelected();if(!EX(this,"F",T,0,9))return;if(!EX(this,"F",A,0,9))return;if(!EX(this,"F",R,0,9))return;if(!EX(this,"F",C,0,9))return;if(!EX(this,"F",d,0,9))return;if(!EX(this,"F",g,0,9))return;f=CX(T,metric);l=CX(A,metric);a=CX(R,metric);n=CX(C,metric);c=CX(d,metric);s=CX(g,metric);W$(false);if(xo<=f+l+tc.MIN_TEXT_WIDTH||yo<=a+n+tc.MIN_TEXT_HEIGHT){QY(tc.MSG_MARGIN_TOO_LARGE,"PageParam");return}for(i=0;i<ro;i++){if(!_&&i!=o)continue;to[i].LeftMargin=f;to[i].RightMargin=l;to[i].TopMargin=a;to[i].BotMargin=n;to[i].HdrMargin=c;to[i].FtrMargin=s;if(to[i].FirstLine<Fo)Fo=to[o].FirstLine}oi.modified++;sH();u.hide()}else return;if(oi.PrintView)cG();return}return true}function X$(){return true}_i.TerSetPrinter=function(t,e,r){return true};function K$(t,e){var r;for(r=0;r<ro;r++){to[r].PprWidth=VV(t);to[r].PprHeight=VV(e)}oi.modified++;return true}function Y$(t){var e;for(e=0;e<ro;e++){to[e].IsPortrait=t}oi.modified++;return true}function V$(t,e){var r;for(r=0;r<ro;r++){to[r].FirstPageBin=t;to[r].bin=e}oi.modified++;return true}_i.TerPrint=function(t){return _i.TerPrintEx(t,-1,-1)};_i.TerPrintEx=function(t,e,r){return _i.TerPrint2(t,e,r)};_i.TerPrint2=function(t,e,r,i,f){return _i.TerPrint3(t,e,r)};_i.TerPrint3=function(t,e,r){var i=tc.IDC_RANGE_ALL,f;var l=false;var a=false;var n=false;var c=false;var s=true;var _=false;var o=false;var u="";var T=null;var A=0,E=0,R=0,L=0,C=0,I=0;var d=false;var F=1,g;var P=false;if(!lv||!QD())_i.TerCreateControl();QO=0;if(tg.expired){QO=tc.MSG_EXPIRED;return false}if(!Iu){QO=tc.MSG_NO_PRINTER;return false}l0();l=false;F=1;P=false;if(uA!=tc.HILIGHT_OFF)_i.DeselectTerText();s=oi.WordWrap;if(!oi.WordWrap)a0();if(DE)Z5(true);if(ME)Z5(false);B5();var S=si;si=false;Eu=true;if(nh!=0&&nh!=100)Ex(Ti);pr=true;CT=IT=dT=tc.CLR_WHITE;iu=e;var h=WR;$u=qe;tT=$e;var O=FS;FS=false;if(oi.WordWrap&&!oi.PrintView){oi.PrintView=true;a=true}if(oi.PrintView){if(!oi.PageMode){oi.PageMode=true;n=true}c=oi.FittedView;oi.FittedView=false;if(!n&&WR)y5();if(!a&&!yR){for(f=0;f<ro;f++){if(eo[f].hdr.FirstLine>=0||eo[f].ftr.FirstLine>=0||eo[f].fhdr.FirstLine>=0||eo[f].fftr.FirstLine>=0){_=true;W5();break}}}}if(oi.PrintView){if(Li||Nj(rO&tc.TFLAG8_AUTO_REFORMAT_TABLES))_i.TerAdjustHtmlTable();yJ(false,false,0,true);if(Kl>1)yJ(false,false,0,true);B5();l0()}if(l)e=r=po[Lo].PhyPageNo;if(e>=OT)e=OT-1;if(r>=OT)r=OT-1;if(e>r)e=r;if(e>=0)iu=hT[e].TextPageNo;else iu=po[Lo].PhyPageNo;eT=e;rT=r;if(eT<0){eT=0;rT=OT-1}iT=F;fT=0;lT=P;for(f=0;f<To;f++)po[f].PagesPrinted=0;if(o){T=XQ(U)}mo="";j$(eT,rT);for(g=eT;g<=rT;g++){f0("<page size='Page"+g+"'>");Bo=Ho=0;mo="   ";if(!hT[g].IsBlank)_0(re,-1,hT[g].TextPageNo);mo="";f0("</page>")}J$();oi.FittedView=c;FS=O;if(_)W5();WR=h;if(n)Gz();if(a)oi.PrintView=oi.PageMode=false;Eu=false;if(nh!=0&&nh!=100)Ex(Ti);pr=false;si=S;na=ca=0;if(Li||Nj(rO&tc.TFLAG8_AUTO_REFORMAT_TABLES))_i.TerAdjustHtmlTable();if(oi.FittedView)_i.TerRepaginate(false);if($u!=qe&&oi.PageMode)By(false,$u,tT);if(!s)n0();cG();if(Cu){Cu=false;qQ(tc.TER_WM_COMMAND,tc.ID_PRINT_PREVIEW,0);_i.ForgetMouseUp=true}if(T!=null)setCursorType(T);return true};function j$(t,e){var r,i,f;wo=0;Go="<html><head><title>Report- ";Go+=ih==null||ih.length==0?"Unknown":ih;Go+="</title>"+Wk([13,10]);f0("<style>");for(r=0;r<Vs;r++){f0("@font-face {");f0("   font-family: "+Ks[r].typeface+";");if(Ks[r].url.indexOf("src:")==0)f0("   "+Ks[r].url+";");else f0("   src: url('"+Ks[r].url+"');");if(Ks[r].options!=null&&Ks[r].options.length>0)f0("   "+options);f0("}")}f0("body {");f0("background: rgb(204,204,204);");f0("}");f0("page {");f0("  background: white;");f0("  display: block;");f0("  overflow: hidden;");f0("  margin: 0 auto;");f0("  margin-bottom: 0.5cm;");f0("  position: relative;");f0("  page-break-after: always;");f0("}");for(i=t;i<=e;i++){var l=hT[i].TextPageNo;f0("page[size='Page"+mY(l)+"'] {");f=po[l].TopSect;var a=zh;zh=cj(zh,tc.TFLAG_SWAP_DECIMAL);var n=AX(eo[f].PgWidth,2);f0("  width: "+n+"in;");n=AX(eo[f].PgHeight,2);f0("  height: "+n+"in;");zh=a;f0("}")}f0("@media print {");f0("  body, page {");f0("    margin: 0;");f0("    box-shadow: 0;");f0("  }");f0("}");f0("</style>");f0("</head>");f0("<body onload='window.print();'>")}function J$(){if(Go==null)return;f0("</body>");f0("</html>");var t=window.open();if(t==null)qk(tg.MsgString[tc.MSG_ALLOW_POPUP],"",tc.MSGTYPE_ALERT);else{t.document.open();t.document.write(Go);t.document.close()}Go=null}function z$(t,e,r,i,f,l,a,n){var c=0;var s=0;var _='"';if(n==undefined)n=true;while(t.indexOf(" ")>=0)t=t.replace(" ","&nbsp;");e=MV(e)/1440-Bo;r=HV(r)/1440-Ho;if(i!=null){c=MV(i.right-i.left)/1440;s=HV(i.bottom-i.top)/1440}var o="position: absolute; ";var u="left: "+e.toString()+"in; ";var T="top: "+r.toString()+"in; ";var A="font: "+l.GetCssFontString(_i)+"; ";var E="color: "+f+"; ";var R="";var L="";var C=false;var I=false;if(a>=0&&a<Ys&&xs[a].InUse){if(Dj(fO&tc.TFLAG10_UPRIGHT_CHARS)&&(xs[a].TextAngle==90||xs[a].TextAngle==270))C=true;if(xs[a].ScaleX!=0)I=true}if(C||I){R+="transform: ";L+="-webkit-transform: ";var d,F,g,P,S=0,h=0;var O=(xs[a].ScaleX+100)/100;if(I){d=e+c/2;var v=e+c/2/O;S=d-v;F=r+s/2;var p=r+s/2/O;h=F-p;if(!C){R+="translate("+S.toString()+"in, 0in) ";L+="translate("+S.toString()+"in, 0in) "}}if(C){d=e+s/2;F=r+c/2;g=d;P=F;if(xs[a].TextAngle==90){g=e+c/2;P=r-s/2;R+="translate("+(g-d+h).toString()+"in, "+(P-F).toString()+"in) ";L+="translate("+(g-d+h).toString()+"in, "+(P-F).toString()+"in) "}else if(xs[a].TextAngle==270){g=e-c/2;P=r+s/2;R+="translate("+(g-d+h).toString()+"in, "+(P-F).toString()+"in) ";L+="translate("+(g-d+h).toString()+"in, "+(P-F).toString()+"in) "}}if(I){if(C){R+="scale(1, "+O.toString()+") ";L+="scale(1, "+O.toString()+") "}else{R+="scale("+O.toString()+",1) ";L+="scale("+O.toString()+",1) "}}if(C){deg=xs[a].TextAngle;deg=360-deg;R+="rotate("+deg.toString()+"deg) ";L+="rotate("+deg.toString()+"deg) "}}R+="; ";L+="; ";f0("<div style="+_+o+u+T+A+E+R+L+_+">");f0("   <span>"+t+"</span>");f0("</div>")}function Z$(t,e,r,i,f,l,a,n,c,s){var _=0;var o=0;var u='"';if(s==undefined)s=true;if(t.charCodeAt(0)==1&&t.charCodeAt(1)==0&&t.charCodeAt(2)==9&&t.charCodeAt(3)==0){t=sD(-1,t)}x=MV(l)/1440-Bo;y=HV(a)/1440-Ho;_=Math.floor(n*yt/Ai);o=Math.floor(c*Wt/Ei);_=zV(_);o=zV(o);var T="position: absolute; ";var A="left: "+x.toString()+"in; ";var E="top: "+y.toString()+"in; ";var R="";try{R="data: image/png;base64,"+btoa(t)}catch(t){}f0("<div style="+u+T+A+E+u+">");f0("   <img width="+_.toString()+"in height="+o.toString()+"in src="+u+R+u+"/>");f0("</div>")}function Q$(t,e,r,i){var f=0;var l=0;var a='"';if(i==undefined)i=true;x=MV(e)/1440-Bo;y=HV(r)/1440-Ho;var n="position: absolute; ";var c="left: "+x.toString()+"in; ";var s="top: "+y.toString()+"in; ";f0("<div style="+a+n+c+s+a+">");f0("   <img src="+a+t+a+"/>");f0("</div>")}function q$(t,e,r,i,f){var l='"';var a="";t=MV(t)/1440-Bo;e=HV(e)/1440-Ho;r=MV(r)/1440;i=MV(i)/1440;var n="position: absolute; ";var c="left: "+t.toString()+"in; ";var s="top: "+e.toString()+"in; ";var _="width: "+r.toString()+"in; ";var o="height: "+i.toString()+"in; ";var u="background-color: "+f.toString()+"; ";a="<div style="+l;a+=n+c+s+_+o+u;a+=l+"></div>";f0(a)}function $$(t,e,r,i,f,l){var a='"';var n="";var c,s,_,o,u,T;var A=t.thick,E,R,L;var C=null;if(r==f||e==i)C=t0(t,e,r,i,f);var I="position: absolute; ";u="color: "+t.color.toString()+"; ";A=HV(A);if(A==0)A=15;A=A/1440;if(r==f){if(i<e){E=i;i=e;e=E}e=MV(e)/1440-Bo;r=HV(r)/1440-Ho;r-=A;c="left: "+e.toString()+"in; ";s="top: "+r.toString()+"in; ";n="\x3c!-- horz line --\x3e ";n+=" <div style="+a;n+=I+c+s;if(l!=undefined){n+="transform: rotate("+l.toString()+"deg); ";n+="-webkit-transform: rotate("+l.toString()+"deg); "}n+=a+">";f0(n);f0("   <img src="+a+C+a+"/>");f0("</div>")}else if(e==i){if(f<r){E=f;f=r;r=E}r=HV(r)/1440-Ho;e=MV(e)/1440-Bo;e-=A;c="left: "+e.toString()+"in; ";s="top: "+r.toString()+"in; ";n="\x3c!-- vert line --\x3e ";n+=" <div style="+a;n+=I+c+s;n+=a+">";f0(n);f0("   <img src="+a+C+a+"/>");f0("</div>")}else{var d,F,g,P;if(f<r){E=r;r=f;f=E;E=e;e=i;i=E}F=Math.sqrt((e-i)*(e-i)+(r-f)*(r-f));if(e<i){d=Math.atan((f-r)/(i-e))*180/Math.PI;g=e+(i-e)/2;P=r+(f-r)/2}else{d=-Math.atan((f-r)/(e-i))*180/Math.PI;g=i+(e-i)/2;P=r+(f-r)/2}return $$(t,g-F/2,P,g+F/2,P,d)}}function t0(t,e,r,i,f){var l=t==null?1:t.thick;if(l<=0)l=1;if(e!=i&&r!=f)return"";e=zV(e);r=zV(r);i=zV(i);f=zV(f);l=zV(l);var a=document.createElement("canvas");if(r==f){a.width=Math.abs(i-e);a.height=3*l}else{a.width=3*l;a.height=Math.abs(f-r)}var n=a.getContext("2d");if(t!=null)n.strokeStyle=t.color.toString();n.lineWidth=l;n.beginPath();if(r==f){n.moveTo(0,l);n.lineTo(Math.abs(i-e),l)}else{n.moveTo(l,0);n.lineTo(l,Math.abs(f-r))}n.closePath();if(t!=null&&t.DottedLine)n.setLineDash([3,6]);n.stroke();var c=a.toDataURL("image/png");return c}function e0(t){var e='"';var r="";var i="Canvas"+wo.toString();mo="";f0("<script>",true);mo="   ";if(t!=undefined)f0("// "+t,true);f0("function OnLoadCanvas"+wo.toString()+"()",true);f0("{",true);mo+="    ";f0("var cvs=document.getElementById("+e+i+e+");",true);f0('var gr=cvs.getContext("2d");',true)}function r0(t,e,r,i){var f='"';var l="";var a="Canvas"+wo.toString();mo="   ";f0("}",true);mo="";f0("<\/script>",true);t=MV(t)/1440-Bo;e=HV(e)/1440-Ho;r=Math.floor(r*yt/Ai);i=Math.floor(i*Wt/Ei);var n="position: absolute; ";var c="left: "+t.toString()+"in; ";var s="top: "+e.toString()+"in; ";var _="data: image/png;base64,"+btoa(ImageData);f0("<div style="+f+n+c+s+f+">");f0("   <canvas id="+f+a+f+" width="+r.toString()+" height="+i.toString()+">");f0("   </canvas>",true);f0("</div>");f0("<script>",true);f0("   OnLoad"+a+"();",true);f0("<\/script>",true);wo++}function i0(t){var e='"';var r=t+"(";var i=arguments.length;for(var f=1;f<i;f++){if(f>1)r+=", ";if(typeof arguments[f]=="string")r+=arguments[f];else r+=arguments[f].toString()}r+="); ";f0(r,true)}function f0(t,e){if(e==undefined)e=true;Go+=mo+t;if(e)Go+=String.fromCharCode(13)+String.fromCharCode(10)}function l0(){var t,e=0;for(t=0;t<To;t++,e++){if(Nj(po[t].flags&tc.PAGE_PRINT_BLANK_PAGE_BEF))e++;po[t].PhyPageNo=e}OT=e;hT=[];for(t=0;t<OT;t++){hT[t]=new tc.ClsPhyPage;hT[t].TextPageNo=-1}for(t=0;t<To;t++){e=po[t].PhyPageNo;hT[e].TextPageNo=t}for(t=0;t<OT;t++){if(hT[t].TextPageNo==-1){if(t+1<OT)hT[t].TextPageNo=hT[t+1].TextPageNo;hT[t].IsBlank=true}}return true}_i.getNumberOfPages=function(){return OT};function a0(){var t,e;var r;for(t=0;t<Ri;t++){e=ui[t].len;Tm(t,e,e+1);r=ui[t].txt;r[e]=Bn;ui[t].flags|=tc.LFLAG_PARA|tc.LFLAG_PARA_FIRST}oi.WordWrap=true;oi.PageMode=oi.PrintView=oi.FittedView=false;zh=_j(zh,tc.TFLAG_NO_WRAP);lp(0);_i.TerRewrap();return true}function n0(){var t,e;zh|=tc.TFLAG_NO_WRAP;_i.TerRewrap();for(t=0;t<Ri;t++){e=ui[t].len;if(e>0&&ui[t].txt[e-1]==Bn){Tm(t,e,e-1);ui[t].flags=_j(ui[t].flags,tc.LFLAG_PARA|tc.LFLAG_PARA_FIRST)}}oi.WordWrap=false;oi.PageMode=oi.PrintView=oi.FittedView=false;zh=_j(zh,tc.TFLAG_NO_WRAP);return true}_i.TerGetPrinterHiddenXY=function(t){if(!lv||!QD())_i.TerCreateControl();GetPrinterHiddenArea(t);td=jo;ed=Jo;return true};function c0(t,e,r){var i=true;var f,l;var a=false;var n=null;re=t;try{}catch(t){}Ut=Nt;kt=Nt;GetPrinterHiddenArea(t);jo=Mj(jo,Ut,tg.UNITS_PER_INCH);Jo=Mj(Jo,kt,tg.UNITS_PER_INCH);if(Nj(aO&tc.TOFLAG_MERGE_PRINT_RECT)){eu=Mj(FT.left,Ut,tg.UNITS_PER_INCH)-jo;ru=Mj(FT.top,kt,tg.UNITS_PER_INCH)-Jo}else{eu=-jo;ru=-Jo}if(i){f=n.getScaleX();l=n.getScaleY();t.scale(Ut/(tg.UNITS_PER_INCH*f),kt/(tg.UNITS_PER_INCH*l))}else{t.setTransform(new AffineTransform);t.scale(Ut/tg.UNITS_PER_INCH,kt/tg.UNITS_PER_INCH)}f=t.getTransform().getScaleX();l=t.getTransform().getScaleY();t.setClip(new tc.Rectangle(0,0,999999,999999));if(!gu)_0(re,-1,iu);re=null;Ut=kt=tg.UNITS_PER_INCH}function s0(t,e,r,i,f,l,a,n,c,s){var _,o,u,T;var A=0;var E;if(a!=null&&a.length==0)a=null;if(l!=null&&l.length==0)l=null;if(c!=null&&n>c.length)n=c.length;var R=t.getFont();if(n>0){if(a!=null)A=n;else{A=n;a=[A];for(_=0;_<n;_++){if(l[_]>65535)break;a[_]=l[_]}if(_<n){var L=Wk(l,0,n);a=Uk(L);A=a.length}}}E=t.fillStyle;t.fillStyle=iA.toString();t.drawString(Wk(a),e,r);t.fillStyle=E;return 1}function _0(t,e,r){var i,f,l,a;var n,c,s,_,o,u=0,T,A,E,R=0,L=0,C=0,I,d,F,g,P,S,h,O,v,p,N,D,M,G,B,H,m,w;var b;var x;var y;var W;var U;var k;var X;var K;var Y=0;var V,j=false;var J,z,Z,Q;var q,$,tt;var et,rt=0;var it,ft,lt;var at=9999,nt=at,ct=at,st,_t,ot;var ut;var Tt=null;var At=0,Et=0,Rt=-1,Lt=0,Ct=0;var It=false,dt=false;var Ft=0,gt=0;var Pt=0;var St,ht,Ot;if(e<0){i=f=r;if(i>=To)return 0;j=true}else{for(i=0;i<To;i++)if(po[i].FirstLine>e)break;if(i>0)i--;for(f=0;f<To;f++)if(po[f].FirstLine>r)break;if(f>0)f--;if(f<i)f=i}var vt=true;var pt=new tc.Point;if(vt){pt.x=0;pt.y=0}Q=bl?1:2;for(l=i;l<=f;l++){Lo=l;By(true,Lo,Lo);b=true;Q=bl?1:2;u=0;var Nt=$T!=tc.CLR_WHITE;if(!Nt&&Nj(nO&tc.TOFLAG2_PDF)){for(n=0;n<Ys;n++){if(Nj(xs[n].style&tc.PICT)){Nt=true;break}}}$n=false;rc=ic=ec=-1;if(Nt)g0(t,l);if(Nj(Qh&tc.TFLAG3_PRINT_BKND_PICT))O0(t,l);for(a=0;a<Q;a++){for(Z=0;Z<Dl;Z++){t:{CT=IT=dT=tc.CLR_WHITE;if(bl)_=pl[Z].DispFrame;else _=Z;if(Nj(pl[_].flags&tc.FRAME_WATERMARK)&&!b)continue;z=pl[_].ParaFrameId;if(z>0&&Nj(kl[z].flags2&tc.PF2_HIDDEN))continue;if(pl[_].BoxFrame==_&&JW(z))continue;if(z>0&&pl[_].BoxFrame!=_){var Dt=pl[_].BoxFrame;if(pl[Dt].ParaFrameId==z){var Mt=pl[Dt].y+pl[Dt].height;if(pl[_].y>=Mt)continue}}if(!bl){if(a==0&&z>0)continue;if(a==1&&z==0)continue}if(pl[_].CellId>0&&Nj(eR[pl[_].CellId].flags&tc.CFLAG_ROW_SPANNED)&&Dj(pl[_].flags&tc.FRAME_TOP_SPAN))continue;if(Nj(rO&tc.TFLAG8_HIDE_EMPTY_CELLS_ON_PRINT)&&pl[_].CellId>0){ot=pl[_].CellId;if(Nj(rR[ot].flags&tc.CAUX_EMPTY_CELL)){var Gt=pl[_].BackColor!=nZ();if(!Gt)continue}}if(pl[_].CellId>0&&pl[_].height==0)continue;if(At>0&&(a>Rt||pl[_].ZOrder>Lt||Ct!=pl[_].ParaFrameId)){for(Pt=0;Pt<At;Pt++){It=EG(t,Tt[Pt].frm,It,L,C);C0(t,Tt[Pt].frm,Tt[Pt].x,Tt[Pt].y,Tt[Pt].TopMargin)}Tt=null;At=Et=0}s=po[l].TopSect;F=pl[_].sect;var Bt=new tc.Point;if(!vt){Bt.x=Bt.y=0}else{Bt.x=pt.x;Bt.y=pt.y}L=to[F].LeftMargin*Ai-Bt.x;PT=L;if(b){if(yR)C=0;else C=to[s].TopMargin*Ei-Bt.y;ST=C;if($l>0){for(n=0;n<Dl;n++){var Ht;if(Dj(pl[n].flags&tc.FRAME_WATERMARK))continue;Ht=pl[n].ParaFrameId;St=kl[Ht].pict;if(St>0&&Nj(xs[St].style&tc.PICT)){ht=Xs[St].CharWidth[tc.PICT_CHAR];Ot=Xs[St].height;F0(t,St,pl[n].x+L,pl[n].y+C,ht,Ot,1,pl[n].PageFirstLine);break}}}}b=false;It=EG(t,_,It,L,C);if(Dj(pl[_].empty)&&Nj(pl[_].flags&(tc.FRAME_NON_TEXT_DO|tc.FRAME_PICT))){var mt=pl[_].PageFirstLine;var wt;wt=mt>=e&&mt<=r||e<0||Nj(Nc[ui[mt].pfmt].flags&tc.PAGE_HDR_FTR)||Nj(ui[mt].cid)&&Nj($E[eR[ui[mt].cid].row].flags&tc.ROWFLAG_HDR)||j;if(!wt)continue;pl[_].x+=L;pl[_].y+=C;if(Nj(kl[z].flags&tc.PARA_FRAME_FILL_PICT)&&kl[z].FillPict>0){F0(t,kl[z].FillPict,pl[_].x,pl[_].y,pl[_].width,pl[_].height,1,mt)}else if(Nj(kl[z].flags&tc.PARA_FRAME_LINE))kB(t,_,0,0,0,0,0);else if(Nj(kl[z].flags&tc.PARA_FRAME_RECT))VB(t,_,0,0,0,0,0,tc.MODE_DRAW_FILL);else if(kl[z].pict>0){F0(t,kl[z].pict,pl[_].x,pl[_].y,pl[_].width,pl[_].height,1,mt);YB(t,_)}continue}if(JW(z))VB(t,_,0,0,0,0,0,tc.MODE_FILL);if(z>0&&pl[_].empty&&(Nj(kl[z].flags&tc.PARA_FRAME_FILL_PICT)&&kl[z].FillPict>0)){Nl=_;St=kl[z].FillPict;pl[_].x+=L;pl[_].y+=C;ht=pl[_].width;Ot=pl[_].height;xs[St].PictWidth=MV(ht);xs[St].PictHeight=HV(Ot);HN(St,yV(Ot),bV(ht),false);F0(t,St,pl[_].x,pl[_].y,ht,Ot,1,pl[_].PageFirstLine);continue}Le=L;Ce=C;if(Nj(pl[_].flags&tc.FRAME_FNOTE)){Nl=_;pl[_].y+=C;ZB(re,_,false);if(pl[_].y+pl[_].height>u)u=pl[_].y+pl[_].height;continue}if(Nj(pl[_].flags&tc.FRAME_PAGE_BOX)){yB(re,_);continue}if(pl[_].ParaFrameId>0&&pl[_].width<0)continue;c=pl[_].x+L;o=E=R=pl[_].y+C;Nl=_;if(!pl[Nl].empty)Ie=rW(-_);if(Ie>0&&tg.OSCanRotate)d$(t,Nl);L0(t,_,c,o,C);d0(t,_,c,o,C);if(At+1>=Et){Et+=20;if(Tt==null)Tt=[Et+1]}Tt[At]=new tc.ClsFrameBorder;Tt[At].frm=_;Tt[At].x=c;Tt[At].y=o;Tt[At].TopMargin=C;Rt=a;Lt=pl[_].ZOrder;Ct=pl[_].ParaFrameId;At++;if(pl[_].empty)break t;if(pl[_].CellId>0){gt=pl[_].CellId;if(Nj(eR[gt].flags&tc.CFLAG_HIDDEN))break t}o=o+pl[_].SpaceTop;d=pl[_].width;if(to[F].columns>1&&Dj(pl[_].flags&tc.FRAME_LAST_COL)&&pl[_].CellId==0&&pl[_].ParaFrameId==0){var bt=ui[pl[_].PageFirstLine].pfmt;if(Dj(Nc[bt].flags&tc.PAGE_HDR_FTR))d-=to[s].ColumnSpace*Ai}m=0;so=tH(_);for(K=pl[_].PageFirstLine;K<=pl[_].PageLastLine;K++){Hs=K;if(Nj(fO&tc.TFLAG10_NO_LAST_PARA_MARKER)&&K+1==Ri&&ui[K].len==1&&Nj(ui[K].flags&tc.LFLAG_PARA))continue;if(L6(K)!=pl[_].level)continue;if(Nj(Qh&tc.TFLAG3_CLIP_CELL_OVERFLOW)&&pl[_].CellId>0&&o+ui[K].height>E+pl[_].height)break;if(pl[_].LimitY!=-1&&o+ui[K].height*3/4>pl[_].LimitY+C&&K>pl[_].PageFirstLine){ot=pl[_].CellId;if(eR[ot].TextAngle==0){s$(K,ui[K].height,false);q=Sd;$=hd;if(o+ui[K].height-$>pl[_].LimitY+C)break}}G=pl[_].BoxFrame;B=pl[G].y+C+pl[G].height-pl[G].SpaceBot;if(Dj(kl[z].flags2&tc.PF2_SIZE_TO_TEXT)&&z>0){var xt=Nj(kl[z].flags&tc.PARA_FRAME_TEXT_BOX);if(!xt&&Dj(kl[z].flags&tc.PARA_FRAME_OBJECT)&&kl[z].ShapeType==0)xt=true;if(xt&&K>pl[_].PageFirstLine&&o+ui[K].height>B){s$(K,0,false);q=Sd;$=hd;if(o>B)break}}o+=vW(K,false);if(Nj(ui[K].tabw)&&Nj(ui[K].tabw.type&(tc.INFO_PAGE|tc.INFO_COL)))continue;if(ui[K].len==0)continue;if(ui[K].height==0)continue;V=false;N=ui[K].pfmt;W=Nc[N].flags;p=DV(Nc[N].RightIndentTwips);if(false&&Nc[N].flow==tc.FLOW_RTL)v=J=pl[_].SpaceLeft+DV(Nc[N].RightIndentTwips);else v=J=pl[_].SpaceLeft+DV(Nc[N].LeftIndentTwips);if(K==0||Nj(ui[K].flags&tc.LFLAG_PARA_FIRST)){v+=RZ(K,false);rt=fI;V=nP;w=Wd}if(Nc[N].FirstIndentTwips<0)J+=DV(Nc[N].FirstIndentTwips);J+=c;ca=Nc[N].shading;Ia=Nc[N].BkColor;da=Nc[N].BorderSpaceLeft;Fa=Nc[N].BorderSpaceRight;ga=Pa=0;if(Nj(ui[K].flags&tc.LFLAG_BOX_TOP))ga=Nc[N].BorderSpaceTop;if(Nj(ui[K].flags&tc.LFLAG_BOX_BOT))Pa=Nc[N].BorderSpaceBot;if(ui[K].fid>0){if(K==0||ui[K-1].fid!=ui[K].fid)ga=0;if(K+1>=Ri||ui[K+1].fid!=ui[K].fid)Pa=0}if(ui[K].fid>0){if(K==0||ui[K-1].fid!=ui[K].fid)ga=0;if(K+1>=Ri||ui[K+1].fid!=ui[K].fid)Pa=0}na=0;$c=ts=0;CZ(K);if(false&&Nj(W&tc.PARA_BOX)){z=ui[K].fid;if(z==0||Nj(kl[z].flags&tc.PARA_FRAME_TEXT_BOX)){if(Nj(W&tc.PARA_BOX_TOP)&&(K==pl[_].PageFirstLine||!IZ(K-1,K)))na|=tc.BOX_TOP;if(Nj(W&tc.PARA_BOX_BOT)&&(K>=pl[_].PageLastLine||!IZ(K+1,K)))na|=tc.BOX_BOT;if(Nj(W&tc.PARA_BOX_LEFT))na|=tc.BOX_LEFT;if(Nj(W&tc.PARA_BOX_RIGHT))na|=tc.BOX_RIGHT;if(Nj(W&tc.PARA_BOX_BETWEEN)&&Nj(ui[K].flags&tc.LFLAG_PARA))na|=tc.BOX_BETWEEN;if(Nj(W&tc.PARA_BOX_DOUBLE))na|=tc.BOX_DOUBLE;if(Nj(W&tc.PARA_BOX_THICK))na|=tc.BOX_THICK}}M=tc.PARA_BORDER_MARGIN;if(Nj(ui[K].flags&tc.LFLAG_HTML_RULE))M=-tc.PARA_BORDER_MARGIN/2;if(Nj(z)&&Dj(kl[z].flags&tc.PARA_FRAME_OBJECT))M=0;if(Nj(ui[K].cid))M=0;if(Nc[N].DivId==0){H=DV(Nc[N].LeftIndentTwips);if(Nc[N].FirstIndentTwips<0)H+=DV(Nc[N].FirstIndentTwips)}else{var yt=Nc[N].DivId;H=DV(mc[yt].LeftMarg)}$c=c+pl[_].SpaceLeft+H-DV(M);ts=c+d-DV(Nc[N].RightIndentTwips-M)-pl[_].SpaceRight;if(Nj(na)&&Nj(ui[K].tabw)&&ui[K].tabw.FrameX>0){if(Math.abs(ui[K].tabw.FrameX+ui[K].tabw.FrameWidth-ts)<Ai)ts=ui[K].tabw.FrameX}D=ui[K].len;U=ui[K].txt;k=nb(K);if(Nj(ui[K].tabw))X=ui[K].tabw.copy();else X=new tc.TejTabw;lt=false;I=v;g=h=P=S=0;if(D>0&&Nj(ui[K].flags&tc.LFLAG_SECT))D--;T=D;if(D>0&&(U[D-1]==Bn||U[D-1]==TR||U[D-1]==tc.ROW_CHAR||U[D-1]==tc.COL_CHAR||U[D-1]==tc.SECT_CHAR||U[D-1]==tc.LINE_CHAR)){Ft=k[D-1];dt=xs[Ft].StoryIds!=null&&xs[Ft].StoryIds.length>0;if(!dt){T--;lt=true}}while(T>0){if(U[T-1]!=tc.SPACE&&U[T-1]!=tc.NBSPACE_CHAR)break;if(U[T-1]==tc.SPACE&&Nj(nO&tc.TOFLAG2_PDF))break;Y=k[T-1];if(Nj(xs[Y].style&(tc.ULINE|tc.ULINED|tc.ULINE_DOTTED|tc.STRIKE|tc.DOUBLE_STRIKE|tc.CHAR_BOX))){if(Dj(Nc[N].flags&tc.JUSTIFY))break}if(xs[Y].FieldId>0)break;dt=xs[Y].StoryIds!=null&&xs[Y].StoryIds.length>0;if(dt)break;T--}if(true||T>0)D=T;it=ft=false;et=0;tt=D;if(false&&D>1&&Nj(ui[K].flags&(tc.LFLAG_PARA|tc.LFLAG_LINE))){et=k[D-1];lt=true;tt--}ct=nt=at;ut=vq(K);for(n=0;n<=D;n++){if(n<D)Y=k[n];if(n<tt){var Wt;if(!ft&&(U[n]==gk(" ")||U[n]==tc.TAB)&&xs[Y].height>0)ft=true;Wt=xs[Y].ParaFID;if(Nj(xs[Y].style&tc.PICT)&&Wt>0){if(n==0&&Nj(ui[K].flags2&tc.LFLAG2_SPACE_TAKING_FRAME)){P=mV(kl[z].height);O=st=nt=ct=S=h=0;continue}else if(Dj(kl[Wt].flags2&tc.PF2_INLINE))continue}if(U[n]!=gk(" ")&&U[n]!=tc.TAB&&U[n]!=Bn&&U[n]!=TR&&U[n]!=tc.SECT_CHAR||n==tt-1&&!it){var Ut=Xs[Y].BaseHeight;if(Xs[Y].OffsetVal<0){if(Ut>P)P=Ut;O=Xs[Y].height-Ut;if(O>h)h=O;Ut+=Xs[Y].OffsetVal}if(Ut>P)P=Ut;O=Xs[Y].height-Ut;if(O>h)h=O;if(Xs[Y].ExtLead>S)S=Xs[Y].ExtLead;if(Xs[Y].height>0&&Dj(xs[Y].style&tc.PICT))it=true}if(n+1==tt&&P==0&&tt<ui[K].len){D=tt=T=ui[K].len}}if(n<T)I+=ut[n]}g=P+h+S;if(!it||g==0&&(ft||lt)){g=e$(K);P=pd;S=Nd}if(ui[K].len==1&&Nj(ui[K].flags&(tc.LFLAG_PARA|tc.LFLAG_LINE|tc.LFLAG_BREAK)))g=ui[K].height;g=ui[K].height;x=[D+10];y=[D+10];for(n=0;n<D;n++){x[n]=U[n];y[n]=k[n]}x[n]=0;if(D>0&&(x[D-1]==Bn||x[D-1]==TR||x[D-1]==tc.LINE_CHAR||x[D-1]==tc.COL_CHAR||x[D-1]==tc.ROW_CHAR)){Ft=y[D-1];dt=xs[Ft].StoryIds!=null&&xs[Ft].StoryIds.length>0;if(!dt){D--;x[D]=0}}if(Dj(eO&tc.TFLAG7_SHOW_SPACES_AT_PARA_END)&&Nj(nO&tc.TOFLAG2_DONT_ULINE_TRAIL_SPC)){while(D>0){Ft=y[D-1];dt=xs[Ft].StoryIds!=null&&xs[Ft].StoryIds.length>0;if(dt)break;if(x[D-1]!=gk(" ")&&x[D-1]!=Bn&&x[D-1]!=TR&&x[D-1]!=tc.LINE_CHAR)break;D--}}x[D]=0;A=0;if(D>0||I>0){var kt=0,Xt=0,Kt=0;var Yt=d-v,Vt;if(pl[_].CellId>0&&eR[pl[_].CellId].TextAngle!=0){gt=pl[_].CellId;Yt=pl[_].height-H;if(eR[gt].TopPad>=0)Yt-=DV(eR[gt].TopPad);if(eR[gt].BotPad>=0)Yt-=DV(eR[gt].BotPad)}if(ui[K].fid==0&&X.FrameCharPos>=ui[K].len){if(X.FrameX<Yt-p)Kt=Yt-p-X.FrameX}var jt=Nj(ui[K].flags2&tc.LFLAG2_RTL)&&Dj(W&tc.CENTER);Vt=H$(K,true,false,false);if(Nj(ui[K].flags&tc.LFLAG_ASSUMED_TAB)&&Nj(ui[K].tabw)&&ui[K].tabw.count>0)kt=ui[K].tabw.width[0];else if(Nj(W&tc.CENTER)){if(pl[_].CellId>0&&eR[pl[_].CellId].TextAngle!=0)kt=(Yt-p-Kt-Vt)/2;else kt=(Yt-p-pl[_].SpaceRight-Kt-Vt)/2}else if(Nj(W&tc.RIGHT_JUSTIFY)&&Dj(ui[K].flags2&tc.LFLAG2_PARA_RTL)||Dj(W&(tc.CENTER|tc.JUSTIFY|tc.RIGHT_JUSTIFY))&&Nj(ui[K].flags2&tc.LFLAG2_PARA_RTL)&&Dj(tO&tc.TFLAG6_RIGHT_JUST_RTL)){kt=Yt-p-pl[_].SpaceRight-Kt-Vt}if(Nj(X.type&tc.INFO_FRAME)&&X.FrameCharPos==0)Xt=wV(X.FrameScrWidth);A=kt>Xt?kt:Xt;if(Nj(X.type&tc.INFO_FRAME)&&X.FrameCharPos>0&&X.FrameCharPos<ui[K].len)A=0}var Jt,zt;_$(K,ui[K].TextHt,false);q=Sd;$=hd;Jt=Od;zt=vd;Ds=q;Ms=$;Gs=Jt;Bs=zt;if(Nj(pl[_].flags&tc.FRAME_LAST_FRAME_OF_BOX_FRAME)&&(K+1>=Ri||ui[K].fid!=ui[K+1].fid)){var Zt=ui[K].pfmt;if(Nj(Nc[Zt].flags&tc.PARA_BOX)||Nc[Zt].shading>0||!MJ(Nc[Zt].BkColor,tc.CLR_WHITE)){var Qt=o+g+S+mV(Nc[Zt].BorderSpaceRight);var qt=pl[_].y+pl[_].height;if(Qt<qt)g+=qt-Qt}}if(K>=e&&K<=r||e<0||Nj(Nc[ui[K].pfmt].flags&tc.PAGE_HDR_FTR)||Nj(ui[K].cid)&&Nj($E[eR[ui[K].cid].row].flags&tc.ROWFLAG_HDR)){if(Nj(ca)||!MJ(Ia,$T))R0(t,K,_,$c,ts,o+S,g+-(Nj(na&tc.BOX_BOT)?CV(1):0),m);else IT=tc.CLR_WHITE;_t=v+A;var $t=c+v+A-rt;var te=c+pl[_].SpaceLeft;gT=l;if(Nj(nO&tc.TOFLAG2_PDF)&&Nj(ui[K].flags&tc.LFLAG_PARA_FIRST))u0(t,K);p0(K,t,c+_t,o,x,y,D,g,P,X,N,q,$,S,_,L,_t,ut,V,$t,te,R,m);m=Ud;T0(t,K,l,o)}o+=ui[K].height;if(o>u)u=o;sb(K)}}if(JW(z)){It=EG(t,0,It,L,C);VB(t,_,0,0,0,0,0,tc.MODE_DRAW)}if(Nj(pl[_].flags&tc.FRAME_LINE_BET_COL))zG(t,_,L,C);if(pl[_].empty)continue;if(Ie>0&&tg.OSCanRotate)F$(t);Ie=0;so=-1}if(At>0){for(Pt=0;Pt<At;Pt++){It=EG(t,Tt[Pt].frm,It,L,C);C0(t,Tt[Pt].frm,Tt[Pt].x,Tt[Pt].y,Tt[Pt].TopMargin)}Tt=null;At=Et=0}}if(JL!=0)o0(t,l,L,C);if($n)iH(t)}if(It)t.restore();if(Ie>0&&tg.OSCanRotate)F$(t);Ie=0;return u}function o0(t,e,r,i){var f;var l,a,n;var c;if(YL==null)YL="";if(VL==null)VL="";if(jL==null)jL="";if(Nj(JL&tc.REP_NO_PAGE))f=YL;else{f=YL+" "+mY(e+1)+" ";if(VL.length>0)f+=VL+" "+mY(To)+" ";f+=jL}f+="    ";c=SJ(t,Xs[0].font,f);n=po[e].TopSect;if(Nj(JL&(tc.REP_CENTER|tc.REP_RIGHT))){var s=(eo[n].PgWidth-to[n].LeftMargin-to[n].RightMargin)*Ai;var _=s-c.cx;if(Nj(JL&tc.REP_CENTER))l=r+_/2;else l=r+_}else l=r;if(Nj(JL&tc.REP_TOP))a=mV(zL);else{a=eo[n].PgHeight*Ei;a-=mV(zL)+c.cy}var o=new tc.Rectangle(l,a,c.cx,c.cy);SH(t,f,Xs[0].font,xs[0].TextColor,o);return true}function u0(t,e){return true}function T0(t,e,r,i){return true}function A0(t,e,r,i){return true}function E0(t,e,r,i,f,l){return true}function R0(t,e,r,i,f,l,a,n){var c=new tc.RECT;var s,_;var o;c.left=i;c.right=f;c.top=l;c.bottom=c.top+a;c.top+=n;s=mV(da);_=mV(Fa);c.left-=s;c.right+=_;if(Dj(ui[e].flags&tc.LFLAG_HTML_RULE)){if(ga>0)c.top=c.top+Ds-mV(ga);else c.top+=Gs;if(Pa>0)c.bottom=c.bottom-Ms+mV(Pa);else c.bottom-=Bs;if(Ru){c.top+=xV(1);c.bottom+=xV(1)}if(c.bottom>Ce+pl[r].y+pl[r].height)c.bottom=Ce+pl[r].y+pl[r].height}IT=tc.CLR_WHITE;if(Ia!=tc.CLR_WHITE)IT=Ia;if(Nj(ca)&&Ia==tc.CLR_WHITE){o=ca*255/1e4;if(o>255)o=255;o=o<<16|o<<8|o;IT=new tc.Color(pJ(IT)^o)}else if(ca!=1e4&&ca!=0){o=255*ca/1e4;var u=IT;var T=u.getRed();var A=u.getGreen();var E=u.getBlue();T=T<o?0:T-o;A=A<o?0:A-o;E=E<o?0:E-o;IT=new tc.Color(T,A,E)}if(IT!=tc.CLR_WHITE)HH(re,IT,c);return true}function L0(t,e,r,i,f){var l=new tc.RECT;var a;var n;var c=tc.CLR_WHITE;var s=false;var _=pl[e].CellId,o;var u=Ie;var T=pl[e].BackColor;var A=false;l.left=r;l.right=l.left+pl[e].width;l.top=i;l.bottom=l.top+pl[e].height;n=pl[e].ParaFrameId;if(Nj(kl[n].flags&tc.PARA_FRAME_FILL_PICT)&&kl[n].FillPict>0)return true;o=pl[e].BoxFrame;if(n>0&&o!=e){var E=pl[o].y+f+pl[o].height-pl[o].SpaceBot;if(l.bottom>E)l.bottom=E}if(false&&_>0&&Nj(nO&tc.TOFLAG2_PDF)){var R=Nj(eR[_].border&tc.BORDER_TOP)?mV(eR[_].BorderWidth[tc.BORDER_INDEX_TOP]):0;var L;if(R==0&&(L=I6(_,false))>0){if(Nj(eR[L].border&tc.BORDER_BOT)){var C=mV(eR[L].BorderWidth[tc.BORDER_INDEX_BOT]);if(C>R)R=C}}l.top+=R}if(pl[e].CellId>0)u=0;if(u>0){l=S$(l,Nl);if(n>0&&o!=e){var I=pl[o].x+PT+pl[o].width-pl[o].SpaceBot;if(l.right>I)l.right=I}}A=_>0&&T!=nZ();n=pl[e].ParaFrameId;if(Nj(kl[n].flags&(tc.PARA_FRAME_TEXT_BOX|tc.PARA_FRAME_CONV))&&!A){if(kl[n].FillPattern>0){c=kl[n].BackColor;if(true||c!=tc.CLR_WHITE)s=true}}else{lA=pl[e].shading;sa=pl[e].flags;if(T!=nZ()||Nj(sa&tc.FRAME_FORCE_BKND_CLR)){var d=lA>0?lA:0;var F=T.getRed()*(100-d)/100;var g=T.getGreen()*(100-d)/100;var P=T.getBlue()*(100-d)/100;c=new tc.Color(F,g,P)}else{a=lA*255/100;if(a>255)a=255;a=~a&255;c=new tc.Color(a,a,a)}s=!MJ(c,tc.CLR_WHITE)}if(!s&&_>0&&n>0){if(Nj(kl[n].flags&tc.PARA_FRAME_TEXT_BOX)&&kl[n].FillPattern==1)s=true}if(jW(n)){if(pl[e].BoxFrame==e){var S=kl[n].FillOpacity-1;if(S>255)S=255;BH(re,l,kl[n].BackColor,S)}}else{if(s){HH(re,c,l);dT=c}else dT=tc.CLR_WHITE}return true}function C0(t,e,r,i,f){var l=pl[e].CellId,a;if(JW(pl[e].ParaFrameId))return true;a=eR[l].row;Nl=e;if(pl[e].CellId>0&&c8(l)>0){var n=r;var c=i;var s=r+pl[e].width;var _=i+pl[e].height;Nl=e;if(Nj(pl[e].border))jG(re,pl[e].CellId,n,c,s,_,pl[e].BorderWidth,false)}else{var o=nO;nO|=tc.TOFLAG2_USE_PEN_FOR_BORDER;if(Nj(pl[e].border&tc.BORDER_TOP))I0(re,e,tc.BORDER_INDEX_TOP,r,i);if(Nj(pl[e].border&tc.BORDER_BOT))I0(re,e,tc.BORDER_INDEX_BOT,r,i);if(Nj(pl[e].border&tc.BORDER_LEFT))I0(re,e,tc.BORDER_INDEX_LEFT,r,i);if(Nj(pl[e].border&tc.BORDER_RIGHT))I0(re,e,tc.BORDER_INDEX_RIGHT,r,i);nO|=o}return true}function I0(t,e,r,i,f){var l=new tc.RECT;var a,n,c,s,_=0;var o=[2];var u=e>=Qe?qe+1:qe;var T;var A=true;var E=0;var R=0,L=0;var C;l.left=i;l.right=l.left+pl[e].width;l.top=f;l.bottom=f+pl[e].height;if(pl[e].CellId>0&&Nj(pl[e].flags&tc.FRAME_RTL)){if(r==tc.BORDER_INDEX_LEFT||r==tc.BORDER_INDEX_RIGHT){l.left=WY(l.left,l.right);l.right=JC}}o[0]=new tc.Point(0,0);o[1]=new tc.Point(0,0);c=pl[e].CellId;if(r==tc.BORDER_INDEX_BOT&&c>0&&eR[c].RowSpan>1&&rR[c].LastSpannedCell>0)c=rR[c].LastSpannedCell;a=pl[e].BorderWidth[r];a=mV(a);if(c>0){a=0;if(r==tc.BORDER_INDEX_LEFT){if(Nj(eR[c].border&tc.BORDER_LEFT))a=eR[c].BorderWidth[tc.BORDER_INDEX_LEFT];else return true}else if(r==tc.BORDER_INDEX_RIGHT){if(Nj(eR[c].border&tc.BORDER_RIGHT))a=eR[c].BorderWidth[tc.BORDER_INDEX_RIGHT];else return true}else if(r==tc.BORDER_INDEX_TOP){if(Nj(eR[c].border&tc.BORDER_TOP))a=eR[c].BorderWidth[tc.BORDER_INDEX_TOP];else return true}else if(r==tc.BORDER_INDEX_BOT){if(Nj(eR[c].border&tc.BORDER_BOT))a=eR[c].BorderWidth[tc.BORDER_INDEX_BOT];else return true}a=10*Math.round(a/10);if(a<10)a=10;a=DV(a)}if(a>0){if(r==tc.BORDER_INDEX_TOP){l.bottom=l.top}else if(r==tc.BORDER_INDEX_BOT){l.top=l.bottom}else if(r==tc.BORDER_INDEX_LEFT){l.right=l.left}else{l.left=l.right;l.right++}T=pl[e].BorderColor[r];if(c>0){if(r==tc.BORDER_INDEX_TOP){if(Nj(eR[c].border&tc.BORDER_TOP))T=eR[c].BorderColor[tc.BORDER_INDEX_TOP]}else if(r==tc.BORDER_INDEX_BOT){L=c;if(eR[c].RowSpan>1&&rR[c].LastSpannedCell>0)L=rR[c].LastSpannedCell;if(Nj(eR[L].border&tc.BORDER_BOT))T=eR[L].BorderColor[tc.BORDER_INDEX_BOT]}}s=pl[e].ParaFrameId;if(pl[e].CellId==0&&s>0&&Nj(kl[s].flags&(tc.PARA_FRAME_TEXT_BOX|tc.PARA_FRAME_CONV)))T=kl[s].LineColor;var I=255;if(s>0&&kl[s].LineOpacity>0){I=kl[s].LineOpacity-1;if(I>255)I=255}if(I<255&&pl[e].BoxFrame==e){if(r==tc.BORDER_INDEX_TOP){l.right=l.left+pl[e].width;l.bottom=l.top+pl[e].height;GH(re,l,T,a,I)}}else{C=new tc.Pen(T);c=pl[e].CellId;if(c>0)_=eR[c].row;if(c>0){var d=false;if($E[_].CellSpacing==0&&Dj(eR[c].flags&tc.CFLAG_3D))d=true;if(Nj(Qh&tc.TFLAG3_PLAIN_TABLE_BORDER))d=true;if(false&&d){if(r==tc.BORDER_INDEX_TOP&&rR[c].PrevColCell>0){a=2*a}if(r==tc.BORDER_INDEX_BOT&&rR[c].NextColCell>0){a=2*a}if(r==tc.BORDER_INDEX_LEFT&&eR[c].PrevCell>0)a=2*a;if(r==tc.BORDER_INDEX_RIGHT&&eR[c].NextCell>0)a=2*a}}C.thick=a;if(r==tc.BORDER_INDEX_TOP||r==tc.BORDER_INDEX_BOT){if((c=pl[e].CellId)>0){_=_=eR[c].row;if(r==tc.BORDER_INDEX_TOP&&$E[_].PrevRow<=0)l.top+=a/2;else if(r==tc.BORDER_INDEX_BOT){if(eR[c].RowSpan>1){L=K8(c);_=eR[L].row}if($E[_].NextRow<=0)l.top-=a/2}}if(I<255){DH(re,l.left,l.top,l.right,l.top,T,a,I)}else hH(re,l.left,l.top,l.right,l.top,C,null)}else{if((c=pl[e].CellId)>0){if(r==tc.BORDER_INDEX_LEFT&&eR[c].PrevCell<=0)l.left+=a/2;else if(r==tc.BORDER_INDEX_RIGHT&&eR[c].NextCell<=0)l.left-=a/2}if(I<255){DH(re,l.left,l.top,l.left,l.bottom,T,a,I)}else hH(re,l.left,l.top,l.left,l.bottom,C,null)}C.Dispose()}}return true}function d0(t,e,r,i,f){var l,a,n,c,s,_=pl[e].CellId,o,u,T,A,E,R,L;var C,I,d,F;var g,P;var S;if(pl[e].empty)return false;if(_<=0)return false;if(eR[_].PictId>0){C=eR[_].PictId;I=pl[e].height;d=pl[e].width}else{o=s=eR[_].row;if($E[s].PrevRow>0)return false;C=$E[s].TblPictId;if(C<=0)return false;I=pl[e].height;for(s=$E[s].NextRow;s>0;s=$E[s].NextRow){c=$E[s].FirstCell;for(F=e+1;F<Dl;F++)if(pl[F].CellId==c)break;if(F==Dl)break;if(pl[F].PageNo!=Lo)break;I+=pl[F].height}d=pl[e].width;for(c=eR[_].NextCell;c>0;c=eR[c].NextCell){for(F=e+1;F<Dl;F++)if(pl[F].CellId==c)break;if(F==Dl)break;if(pl[F].PageNo!=Lo)break;d+=pl[F].width}}T=r+d;u=i+I;g=Xs[C].CharWidth[tc.PICT_CHAR];P=Xs[C].height;S=xs[C].image;l=r;a=i;while(true){A=g;E=P;R=S.getWidth(null);L=S.getHeight(null);n=0;if(l+A>T){var h=T-l;R=Mj(R,h,A);A=h}if(a+E>u){var O=u-a;var v=Mj(L,O,E);n=L-v;L=v;E=O}t.drawImage(S,0,0,R,L,l,a,A,E);l+=g;if(l>=r+d){a+=P;if(a>=i+I)break;l=r}}return true}function F0(t,e,r,i,f,l,a,n){var c=r;var s=i;var _=f;var o=l;var u;var T=xs[e].ParaFID;var A;if(f==0||Nj(xs[e].style&tc.HIDDEN))return true;if(Nj(kl[T].flags2&tc.PF2_INLINE)&&Nj(kl[T].flags&(tc.PARA_FRAME_RECT|tc.PARA_FRAME_LINE))){if(Nj(kl[T].flags&tc.PARA_FRAME_RECT))VB(t,-1,T,c,s,_,o,tc.MODE_DRAW_FILL);if(Nj(kl[T].flags&tc.PARA_FRAME_LINE))kB(t,-1,T,c,s,_,o)}u=Nj(xs[e].CropLeft)||Nj(xs[e].CropRight)||Nj(xs[e].CropTop)||Nj(xs[e].CropBot);if(u&&xs[e].OrigPictWidth!=0){if(xs[e].ParaFID==0||xs[e].CropLeft<0){A=xs[e].PictWidth/(xs[e].OrigPictWidth-xs[e].CropLeft-xs[e].CropRight);var E=xs[e].CropLeft*A;c-=mV(E);_=xs[e].OrigPictWidth*A;_=DV(_)}}if(u&&xs[e].OrigPictHeight!=0){if(xs[e].ParaFID==0||xs[e].CropTop<0){A=xs[e].PictHeight/(xs[e].OrigPictHeight-xs[e].CropTop-xs[e].CropBot);var R=xs[e].CropTop*A;s-=mV(R);o=xs[e].OrigPictHeight*A;o=mV(o)}}var L=_;var C=o;if(Ie>0){_=WY(_,o);o=JC}if(Ie>0&&tg.OSCanRotate)F$(re);if(xs[e].PictType==tc.PICT_IMAGE){M0(t,e);vG(c,s,L,C);c=Hd;s=md;if(u){state=pH(t);WG(t,new tc.Rectangle(r,i,f,l))}if(xs[e].ParaFID>0){T=xs[e].ParaFID;if(kl[T].FillPattern!=0&&!MJ(kl[T].BackColor,tc.CLR_WHITE)){var I=kl[T].BackColor;HH(t,I,XY(new tc.Rectangle(c,s,_,o)))}}var d=xs[e].image;var F=0,g=0;var P=d.naturalWidth;var S=d.naturalHeight;if(u&&xs[e].ParaFID>0){var h=65536;F=Mj(xs[e].CropLeftFixed,P,h);P-=Mj(xs[e].CropLeftFixed+xs[e].CropRightFixed,P,h);g=Mj(xs[e].CropTopFixed,S,h);S-=Mj(xs[e].CropTopFixed+xs[e].CropBotFixed,S,h)}if($l>0&&xs[e].ParaFID==$l&&ta!=null){if(Go!=null)Z$(xs[e].PictData,F,g,P,S,c,s,_,o);else t.drawImage(d,F,g,P,S,c,s,_,o)}else{if(Go!=null)Z$(xs[e].PictData,F,g,P,S,c,s,_,o);else{try{t.drawImage(d,F,g,P,S,c,s,_,o)}catch(t){}}}if(u)NH(t,state);M0(t,0)}else if(Xw(e)){S0(re,e,r,i,f,l)}if(Ie>0&&tg.OSCanRotate)d$(re,Nl);return true}function g0(t,e){var r,i,f,l,a,n,c;var s=new tc.RECT;for(r=0;r<Dl;r++)if(Nj(pl[r].flags&tc.FRAME_PAGE_BOX))break;if(r<Dl){GetPrinterHiddenArea(t);i=pl[r].x-l;f=pl[r].y-a;n=pl[r].width;c=pl[r].height}else{_i.TerGetPageOrient2(e);n=zI;c=ZI;l=gd;a=Pd;n=n-2*l;c=c-2*a;i=l;f=a}s=VY(i,f,i+n,f+c);HH(t,$T,s);return true}function P0(t,e,r,i,f){return(t-i)*r/e+f}function S0(t,e,r,i,f,l){var a=null;var n;var c,s,_,o,u,T;var A=null;var E=Xs[0].height,R;var L=null;var C;var I=true,d=false,F=true;var g,P;L=xs[e].form;C=xs[e].ctl;if(C!=null)l=xV(C.getHeight()-2);if(C!=null&&mD(_i,xs[e].ctl,t,r,i,f,l))return true;if(L==null||xs[e].ctl==null)return true;if(Hw(e,tc.FIELD_TEXTBOX)){if(!L.border)I=false}if(Hw(e,tc.FIELD_LISTBOX))I=false;if(L.CtlClass=="TextBox"||L.CtlClass=="TextArea"){a=new tc.Pen(tc.Color.black,DV(15));g=C;var S=g.getBorder();if(S==null)I=F=false}else{a=new tc.Pen(tc.Color.black,DV(15));d=true}R=0;if(L!=null)R=L.FontId;if(R<0||R>=Ys)R=0;A=Xs[0].font;if(L.CtlClass=="RadioButton"){var h=f*9/10;var O=l*9/10;var v=new tc.RECT;_=r+h;o=i+O;u=f-2*h;T=l-2*O;v=VY(_,o,_+u,o+T);mH(t,false,Color.white,a,v);if(C.isSelected()){v=VY(_+u/3,o+T/3,_+u/3+u/3,o+T/3+T/3);mH(t,true,tc.Color.black,null,v)}}else if(L.CtlClass=="Button"){MH(t,a,r,i,f,l);n=C.getText();h0(t,A,n,r,i,f,l,true,true,-1)}else if(I){if(F){var p=DV(30);var N=DV(5);var D=new tc.Pen(tc.Color.gray,N);var M=new tc.Pen(tc.Color.gray,p);hH(t,r,i,r+f-p/2,i,M,null);hH(t,r,i,r,i+l-p/2,M,null);hH(t,r+f,i,r+f,i+l,D,null);hH(t,r,i+l,r+f,i+l,D,null)}else MH(t,a,r,i,f,l)}if(L.CtlClass=="CheckBox"){P=C;if(P.isSelected()){hH(t,r,i,r+f,i+l,a,null);hH(t,r,i+l,r+f,i,a,null)}}else if(L.CtlClass=="TextBox"){g=C;n=g.getText();try{var G=C;var B=n.length;var H=[B];for(c=0;c<B;c++)H[c]=G.getEchoChar();n=Wk(H)}catch(t){}h0(t,g.getFont(),n,r,i,f,l,g.getAlignmentX(),I,-1)}else if(L.CtlClass=="TextBox"){g=C;h0(t,C.getFont(),g.getText(),r,i,f,l,g.getAlignmentX(),I,vV(g.getHeight()))}else if(L.CtlClass=="ComboBox"){P=C;n=P.getSelectedItem().toString();R=L.FontId;if(R<0)R=0;var m=Xs[R].font;if(fu>0)m=new tc.Font(m.getFontName(),0,fu*Ei/wt);h0(t,m,n,r,i,f,l,false,false,-1)}if(d)a.Dispose();return true}function h0(t,e,r,i,f,l,a,n,c,s){var _,o;var u;u=SJ(t,e,r);if(n==tc.CENTER)_=i+(l-u.cx)/2;else if(n==tc.RIGHT_JUSTIFY)_=i+(l-u.cx)-Xs[0].CharWidth[gk(" ")];else _=i+(c?Xs[0].CharWidth[gk(" ")]:0);o=f+(a-u.cy)/2;var T=new tc.Rectangle(_,o,l,s>0?s:a);SH(t,r,e,tc.Color.black,T);return true}function O0(t,e){var r,i,f=Xs[jh].CharWidth[tc.PICT_CHAR];var l=Xs[jh].height;var a,n,c,s;if(jh<=0)return true;_i.TerGetPageOrient2(e);a=zI;n=ZI;c=gd;s=Pd;a=DV(a-2*c);n=mV(n-2*s);r=i=0;if(Jh==tc.BKPICT_STRETCH)F0(t,jh,r,i,a,n,1,0);else if(Jh==tc.BKPICT_TILE){var _=r+a;var o=i+n;var u,T;T=i;while(T<o){u=r;while(u<_){F0(t,jh,u,T,f,l,1,0);u+=f;if(Ru&&u+f>_)break}T+=l}}else F0(t,jh,r,i,f,l,1,0);return true}function v0(){var t;if(lT){t=gu;if(!t)iu++;gu=false;if(iu>rT){fT++;iu=eT}if(fT>=iT)return false;if(Nj(po[iu].flags&tc.PAGE_PRINT_BLANK_PAGE_BEF)&&!t)gu=true}else{fT++;if(fT>=iT){t=gu;if(!t)iu++;gu=false;fT=0;if(Nj(po[iu].flags&tc.PAGE_PRINT_BLANK_PAGE_BEF)&&!t)gu=true}if(iu>rT)return false}return true}function p0(t,e,r,i,f,l,a,n,c,s,_,o,u,T,A,E,R,L,C,I,d,F,g){var P,S;var h=0;var O=0,v,p,N;var D,M,G,B=0,H,m,w;var b=false,x;var y=0,W=-1,U=0,k,X;var K=new tc.RECT;var Y;var V=Nj(nO&tc.TOFLAG2_DRAW_FNOTE);var j=false;var J,z=r,Z,Q;var q=ui[t].tabw!=null&&Nj(ui[t].tabw.type&tc.INFO_ALT_JUST)&&ui[t].tabw.CharFlags!=null;var $=ui[t].tabw!=null&&Nj(ui[t].tabw.type&tc.INFO_JUST);var tt;var et;var rt;Ud=g;t:{Qn=qn=false;P=S=0;D=B=H=0;if(s!=null&&Nj(s.type&tc.INFO_JUST))b=true;if(!V){Nf=0;ii=Nj(ui[t].flags2&tc.LFLAG2_RTL);var it=pf;if(ii){vf=Mq(t,L,-1);it=Dd}pf=it;if(vf==null)ii=false}if(ii){if(GY(t,tc.INFO_FRAME)&&ui[t].tabw.FrameCharPos==0&&Dj(aO&tc.TOFLAG2_DRAW_FNOTE))R-=ui[t].tabw.FrameSpaceWidth;if(R>0)for(G=0;G<pf;G++)vf[G].x+=R;Nf=Vq(t,0,pf,vf);X=vf[Nf].col+vf[Nf].count;if(vf[Nf].IsDate)r=z+vf[Nf].x;Y=vf[Nf].rtl}else{Nf=0;Y=false;X=9999}if(C){CB(re,t,ui[t].pfmt,I,i+o+T,c,true)}if(a==0)break t;for(G=0;G<=a;G++){var ft=0;if(G<a)S=l[G];j=S!=P;if(!j){if(q&&G>0&&Nj(ui[t].tabw.CharFlags[G-1]&tc.BFLAG_JUST_SPACE))j=true}if(!j&&$){h=G>=0?f[G-1]:0;var lt=G<a?f[G]:0;if(h==tc.CHAR_SPACE||lt==tc.CHAR_SPACE)j=true}if(!j&&Nj(nO&tc.TOFLAG2_PDF)&&G>0&&ii&&Nf>=0&&vf[Nf].rtl&&vf[Nf].rtlch){var at=!vf[Nf].IsNumeric;var nt=f[G-1];if(!at&&(nt==gk("(")||nt==gk(")")||nt==gk("[")||nt==gk("]")||nt==gk("{")||nt==gk("}")))at=true;if(!at){tt=f[G];if(tt==gk("(")||tt==gk(")")||tt==gk("[")||tt==gk("]")||tt==gk("{")||tt==gk("}"))at=true}if(at&&!Yq(nt))j=true;if(!j){tt=f[G];if(Yq(nt)&&!Yq(tt))j=true}}if(!j&&G>0&&G<a&&Nj(eO&tc.TFLAG7_ISOLATE_UNICODE)){if(h<256&&f[G]>=256)j=true;else if(h>=256&&f[G]<256)j=true}if(!j&&G<a&&Nj(nO&tc.TOFLAG2_PDF)){if(f[G]>=61440&&h<61440)j=true;else if(f[G]<61440&&h>=61440)j=true;else if(f[G]>=61440&&h>=61440)j=true;if(!j&&G>0&&!P9(f[G-1])&&P9(f[G]))j=true;if(!j&&G>0){var ct=f[G]>=44032&&f[G]<=55215;var st=f[G-1]>=44032&&f[G-1]<=55215;j=ct&&!st||!ct&&st}}if(xs[P].TextAngle!=0&&Nj(fO&tc.TFLAG10_UPRIGHT_CHARS)){j=true;if(xs[P].TextAngle==270)ft=-Xs[P].height}if(!j&&xs[P].expand!=0)j=true;if(G==a||j||h==tc.TAB&&xs[P].height!=0||h==tc.HYPH_CHAR||h==tc.HIDDEN_CHAR||h==tc.ZWNJ_CHAR||G>=X||ii&&Y&&(G>0&&f[G-1]==gk(" ")||f[G]==gk(" "))||b&&f[G]==gk(" ")&&A$(P)||G>0&&s!=null&&Nj(s.type&tc.INFO_FRAME)&&s.FrameCharPos==G){var _t=false;M=D;if(h==tc.TAB)M--;if(G==a&&h==tc.HYPH_CHAR)h=gk("-");if(h==tc.HYPH_CHAR||h==tc.ZWNJ_CHAR)M--;if(h==tc.HIDDEN_CHAR&&Nj(nO&tc.TOFLAG2_PDF)&&xs[P].FieldId==tc.FIELD_HLINK)_t=true;if(h==tc.HIDDEN_CHAR&&!_t)M--;if(M>0){CT=xs[P].TextBkColor;if(MJ(CT,tc.CLR_WHITE))CT=xs[P].HilightColor;var ot=Dj(iO&tc.TFLAG9_NO_COMMENTS)&&ly(P);if(CT!=tc.CLR_WHITE||ot){K.left=r;K.right=K.left+B;K.top=i+o;K.bottom=K.top+n;if(Ie>0)K=S$(K,Nl);if(ii)K=R$(K,Nl,vf[Nf]);HH(re,ot?zn:CT,K)}N=xs[P].ParaFID;x=Nj(xs[P].style&tc.PICT)&&N>0&&Dj(kl[N].flags2&tc.PF2_INLINE);Qn=ny(true,t,H,false,0,0,false);w=i+o+c-Xs[P].BaseHeight+Xs[P].height-mV(10);qn=ny(false,t,G-1,true,r+B,w,false);if(!qn&&f[G-1]==TR){if(t+1<Ri&&GY(t+1,tc.INFO_ROW))qn=ny(false,t+1,0,true,r+B,w,false)}if(!x)N0(re,P,r+y,i+o-ft,lV(f,H),M,c,T,0,lV(L,H),F,i+n,t);var ut=o+c-Xs[P].BaseHeight+T+Xs[P].height-ui[t].height;g=ut>0?ut:0;if(U>0){var Tt=Ei/wt;var At=i+o+T+c-Xs[P].BaseHeight;var Et=At+Xs[P].height;et=new tc.Pen(tc.Color.black);hH(re,W+Tt,At,U-Tt,At,et,null);hH(re,W+Tt,Et,U-Tt,Et,et,null);hH(re,W+Tt,At,W+Tt,Et,et,null);hH(re,U-Tt,At,U-Tt,Et,et,null);W=-1;U=0}}H+=D;r+=B;if(G>0&&s!=null&&Nj(s.type&tc.INFO_FRAME)&&s.FrameCharPos==G)r+=wV(s.FrameScrWidth);if(h==tc.TAB){m=L[G-1];if(xs[P].TextBkColor!=tc.CLR_WHITE){K.left=r;K.right=K.left+m;K.top=i+o;K.bottom=K.top+n;HH(re,xs[P].TextBkColor,K)}v=Nc[_].TabId;k=r;if(oi.PageMode)k-=E+pl[A].x+pl[A].SpaceLeft;var Rt;O$(ui[t].pfmt,B_[v],k,false);Rt=nI;Rt=Rt;p=i+o+c+T;if(Rt==tc.TAB_DOT){Z=CV(1)/2;if(Z<1)Z=1;Q=p+5*Z;RH(re,r,Q,r+m,Q,tc.Color.black)}else if(Rt==tc.TAB_HYPH){et=new tc.Pen(tc.Color.black);et.setDotted();hH(re,r,p-2,r+m,p-2,et,null);et.Dispose()}else if(Rt==tc.TAB_ULINE||Nj(xs[P].style&(tc.ULINE|tc.ULINE_DOTTED|tc.ULINED|tc.STRIKE))){et=null;if(Nj(xs[P].style&(tc.ULINE|tc.ULINE_DOTTED|tc.ULINED))){if(!MJ(xs[P].UlineColor,tc.CLR_AUTO))et=new tc.Pen(xs[P].UlineColor);else if(!MJ(xs[P].TextColor,tc.CLR_AUTO))et=new tc.Pen(xs[P].TextColor);else et=new tc.Pen(tc.Color.black)}else if(Nj(xs[P].style&tc.STRIKE))et=new tc.Pen(xs[P].TextColor);else et=new tc.Pen(tc.Color.black);Z=CV(1)/2;if(Z<1)Z=1;et.thick=Z;Q=p+2*Z;var Lt=i+n;if(Nj(xs[P].style&tc.STRIKE)){rt=Xs[P].BaseHeight/2*2/3;if(rt<1)rt=1;Q=p-rt}if(Rt==tc.TAB_ULINE||Nj(xs[P].style&(tc.ULINE|tc.ULINE_DOTTED)))Q+=3*Z;if(Nj(xs[P].style&tc.ULINED))Q-=Z;if((Rt==tc.TAB_ULINE||Nj(xs[P].style&(tc.ULINE|tc.ULINE_DOTTED)))&&Q+Z>Lt)Q=Lt-Z;else if(Nj(xs[P].style&tc.ULINED)&&Q+3*Z>Lt)Q=Lt-3*Z;if(Rt==tc.TAB_ULINE||Nj(xs[P].style&(tc.ULINE|tc.ULINED|tc.STRIKE)))hH(re,r,Q,r+m,Q,et,null);if(Nj(xs[P].style&tc.ULINED)){Q+=2*Z;hH(re,r,Q,r+m,Q,et,null)}if(Nj(xs[P].style&tc.ULINE_DOTTED)){et.setDotted();hH(re,r,Q,r+m,Q,et,null)}et.Dispose()}Rt=0;r=r+m;O++}D=B=0;y=0;kh=Xh=false;P=S;if(ii&&vf!=null&&G>=X&&Nf+1<pf){Nf++;X=vf[Nf].col+vf[Nf].count;if(vf[Nf].IsDate)r=z+vf[Nf].x;Y=vf[Nf].rtl}}if(G==a)break;E0(e,r,i+o,t,G,gT);h=f[H+D];if(h!=tc.TAB){var Ct=false,It=false;m=0;if(s!=null&&H+D<s.CharFlagsLen&&Nj(s.CharFlags[H+D]&tc.BFLAG_BOX_FIRST))Ct=true;if(s!=null&&H+D<s.CharFlagsLen&&Nj(s.CharFlags[H+D]&tc.BFLAG_BOX_LAST)||G==a-1&&W!=-1)It=true;if(Ct){W=r+B;if(D==0)y=xh}N=xs[S].ParaFID;x=Nj(xs[S].style&tc.PICT)&&N>0&&Dj(kl[N].flags2&tc.PF2_INLINE);if(!x)m+=L[G];B+=m;if(Ct)L[G]-=xh;if(It)L[G]-=xh;if(It)U=r+B}D++}}if(Nj(na&tc.PARA_BOX)){K.left=$c;K.right=ts;if(t>=0&&ui[t].fid==0){rt=20;if(Nj(Nc[ui[t].pfmt].flags&tc.PARA_BOX_THICK))rt+=20;if(Nj(Nc[ui[t].pfmt].flags&tc.PARA_BOX_DOUBLE))rt+=40;K.left-=RV(rt);K.right+=RV(rt)}if(t>=0&&ui[t].cid>0){K.right-=RV(1)}K.top=i+T;K.bottom=i+n+CV(1);if(Dj(na&tc.PARA_BOX_BOT))K.bottom+=T;eA=Nc[ui[t].pfmt].BorderColor;UB(re,K,true);na=ca=0}if(so>=0){$B(e,t-pl[A].PageFirstLine,d,i+o+T,c,true);$B(e,t-pl[A].PageFirstLine,d+pl[A].width,i+o+T,c,false)}if(Nj(ui[t].flags2&(tc.LFLAG2_DEL_REV|tc.LFLAG2_INS_REV)))eH(e,d,i+o,n);if(Nj(ui[t].flags2&tc.LFLAG2_LEFT_LINE))rH(e,d,i+o,n);kh=Xh=false;Qn=qn=false;if(Dj(nO&tc.TOFLAG2_DRAW_FNOTE)){vf=null;ii=false}Ud=g;return true}function N0(t,e,r,i,f,l,a,n,c,s,_,o,u){var T,A,E,R,L,C,I,d;var F=hc;var g=iA;var P=fA;var S;var h;var O;var v;var p;var N=new tc.RECT;var D=false;var M=0;t:{if(l>0){var G=ui[u].pfmt;if(Nc[G].TextVAlign==tc.TEXT_VALIGN_BASE)i=i+a-Xs[e].BaseHeight+n;else{i=i+n;if(Nc[G].TextVAlign==tc.TEXT_VALIGN_CENTER)i+=(ui[u].height-Xs[e].height)/2;else if(Nc[G].TextVAlign==tc.TEXT_VALIGN_BOT)i+=ui[u].height-Xs[e].height}if(false&&Ru&&Nj(xs[e].style&tc.SCAPS)&&Nj(xs[e].flags&tc.FFLAG_SCAPS)){if(i+xs[e].height>o)i=o-xs[e].height}if(Nj(xs[e].style&tc.PICT)){R=Xs[e].CharWidth[tc.PICT_CHAR];L=Xs[e].height;if(xs[e].PctHeight>0){i=_;L=Mj(pl[Nl].height,xs[e].PctHeight,100)}F0(re,e,r,i,R,L,l,u);N.left=r;N.right=N.left+R;N.top=i;N.bottom=N.top+L;A0(t,e,gT,N)}else{if(!um(e)){FJ(re,Xs[e].font);h=xs[e].TextColor;if(Nj(xs[e].style&tc.EMBOSS))h=YG(xs[e].TextColor,xs[e].TextBkColor);if(Nj(xs[e].InsRev)&&!Q_)h=ul[xs[e].InsRev].InsColor;if(Nj(xs[e].DelRev)&&!Q_)h=ul[xs[e].DelRev].DelColor;if(MJ(h,tc.CLR_AUTO)||Li&&MJ(h,Color.white)){if(Dj(Qh&tc.TFLAG3_NO_TEXT_COLOR_ADJ)){var B=true;var H=CT;if(H==tc.CLR_WHITE)H=IT;if(H==tc.CLR_WHITE)H=dT;if($T!=tc.CLR_WHITE)B=false;if(h==tc.CLR_AUTO&&Dj(Qh&tc.TFLAG3_NO_TEXT_COLOR_ADJ)&&B){var m=H.getRed()+H.getGreen()+H.getBlue();if(m<=192)h=tc.CLR_WHITE}if(h==tc.CLR_BLACK||h==tc.CLR_AUTO)h=JT;if(GJ(h,H)&&!GJ(xs[e].TextColor,xs[e].TextBkColor)){h=xs[e].TextColor}}}if(Nj(ca)&&Dj(Qh&tc.TFLAG3_NO_TEXT_COLOR_ADJ)){O=Mj(ca,255,1e4);if(O>255)O=255;O=O<<16|O<<8|O;if(h==xs[0].TextColor)h=new tc.Color(pJ(h)^O)}iA=h;p=[l+1];for(T=0;T<l;T++){p[T]=f[T];if(f[T]==tc.NBSPACE_CHAR)p[T]=gk(" ");if(f[T]==tc.NBDASH_CHAR)p[T]=gk("-");if(f[T]==tc.HYPH_CHAR)p[T]=gk("-");if(f[T]==Bn)p[T]=gk(" ");if(f[T]==TR)p[T]=gk(" ");if(f[T]==tc.LINE_CHAR)p[T]=gk(" ");if(f[T]==tc.SECT_CHAR)p[T]=gk(" ")}E=l;if(Nj(xs[e].style&(tc.SCAPS|tc.CAPS))){for(T=0;T<E;T++)if(sk(p[T]))p[T]=ok(p[T])}v=[];for(T=0;T<E;T++)v[T]=s[T];for(T=0,A=0;T<E;T++)A+=v[T];N.left=r;N.right=N.left+A;N.top=i+Xs[e].BaseHeightAdj;N.bottom=N.top+Xs[e].height;hc=e;if(Nj(nO&tc.TOFLAG2_PDF)){var w=Xs[e].BaseHeight;if(Nj(xs[e].style&tc.SUPSCR))w+=Xs[e].BaseHeightAdj;else if(Nj(xs[e].style&tc.SUBSCR))w-=Xs[e].BaseHeightAdj;if(Nj(xs[e].style&tc.CHAR_BOX))w-=Xs[e].BaseHeightAdj;var b=new tc.ClsPdfFontId(e,xs[e].expand,false,0,w)}if(l==1&&f[0]==tc.HIDDEN_CHAR)D=true;if(!D)TB(re,r,i+Xs[e].BaseHeightAdj+ui[u].BaseHeightAdj,0,N,p,E,v);v=null;p=null;A0(t,e,gT,N);if(D)break t;M=xs[e].style;if(Nj(xs[e].InsRev))M|=ul[xs[e].InsRev].InsStyle;if(Nj(xs[e].DelRev))M|=ul[xs[e].DelRev].DelStyle;if(Nj(M&(tc.ULINED|tc.ULINE|tc.ULINE_DOTTED|tc.STRIKE|tc.DOUBLE_STRIKE))&&Dj(M&(tc.SUPSCR|tc.SUBSCR))){var x;var y;if(Eu&&!Ru){A+=2;r--}for(y=0;y<3;y++){if(y==0)x=M&(tc.ULINED|tc.ULINE);else if(y==1)x=M&(tc.STRIKE|tc.DOUBLE_STRIKE);else x=M&tc.ULINE_DOTTED;if(Dj(x))continue;d=CV(1)/2;if(Nj(x&(tc.STRIKE|tc.DOUBLE_STRIKE)))d+=d*((xs[e].TwipsSize-1)/240);if(d<1)d=1;var W=h;if(Nj(x&(tc.ULINE|tc.ULINED|tc.ULINE_DOTTED))&&!MJ(xs[e].UlineColor,tc.CLR_AUTO))W=xs[e].UlineColor;S=new tc.Pen(W);S.thick=d;if(y==2)S.setDotted();C=i+Xs[e].BaseHeight+d;if(Nj(x&(tc.ULINE|tc.ULINE_DOTTED)))C+=3*d;if(Nj(x&(tc.ULINE|tc.ULINE_DOTTED))&&xs[e].TwipsSize>=8*20)C+=d;if(Nj(x&(tc.STRIKE|tc.DOUBLE_STRIKE)))C-=Xs[e].BaseHeight/2*2/3;if(Nj(x&(tc.ULINE|tc.ULINE_DOTTED))&&C+d>o)C=o-d;else if(Nj(x&tc.ULINED)&&C+3*d>o)C=o-3*d;I=r+A;hH(re,r-c,C,I,C,S,null);if(Nj(x&tc.STRIKE)){C=C+d;hH(re,r-c,C,I,C,S,null)}if(Nj(x&(tc.ULINED|tc.DOUBLE_STRIKE))){C=C+2*d;hH(re,r-c,C,I,C,S,null)}S.Dispose()}}var U,k,X,K;if(Qn&&Dj(iO&tc.TFLAG9_NO_COMMENTS)){d=CV(1)/2;C=i+Xs[e].BaseHeight+d;S=new tc.Pen(Zn);S.thick=d;U=3*d;k=r-c;X=i;K=C+2*d;hH(re,k+U,X,k,X+U,S,null);hH(re,k,X+U,k,K-U,S,null);hH(re,k,K-U,k+U,K,S,null);Qn=false}if(qn&&Dj(iO&tc.TFLAG9_NO_COMMENTS)){d=CV(1)/2;I=r+A;C=i+Xs[e].BaseHeight+d;S=new tc.Pen(Zn);S.thick=d;U=3*d;k=I-d;X=i;K=C+2*d;hH(re,k-U,X,k,X+U,S,null);hH(re,k,X+U,k,K-U,S,null);hH(re,k,K-U,k-U,K,S,null);qn=false;$n=true}}}}}hc=F;iA=g;fA=P;return true}function D0(t,e,r){if(Nj(nO&tc.TOFLAG2_PDF)){var i=new tc.ClsPdfFontId(e,r,false,0,0);i.sign[0]=gk("D");i.sign[1]=gk("B")}}function M0(t,e){if(Nj(nO&tc.TOFLAG2_PDF)){var r=new tc.ClsPdfFontId(e,0,false,pJ(xs[e].PictXparentColor),0);r.sign[0]=gk("P");r.sign[1]=gk("I")}}_i.TerMergePrint=function(t){var e=false;if(!t.FullPage&&t.rect==null)return false;var r=document.createElement("canvas");r.id="cvsmp";var i=TerInit(r.id);i.WordWrap=true;i.PageMode=true;i.PrintViewMode=true;i.InWebServer=true;i.UseWin=false;e=i.TerMergePrint2(t);return e};_i.TerMergePrint2=function(t){var e=null;var r,i,f;var l,a,n;var c,s,_;var o=false;var u=null;var T=new tc.RECT,A=new tc.RECT;var E=false,R=false;var L=null;var C=false;if(expired||!AH())return false;t:{if(t.gr!=null)t.OnePage=true;if(t.gr==null){if(!Iu)return false;if(t.FullPage)t.PrintMarginArea=true}if(t.InputType=="F")_i.ReadTerFile(t.file);else{_i.SetTerBuffer(t.buffer,"");ih=t.file}pE=t.PrintHiddenText;if(Dj(zh&tc.TFLAG_NO_HOUR_GLASS)){u=XQ(U)}Eu=true;pr=true;aO|=tc.TOFLAG_IN_MERGE_PRINT;if(t.rect!=null){A=XY(t.rect);C=A.left<0||A.right<0||A.top<0||A.bottom<0;T=A;if(C){T.left=-T.left;T.right=-T.right;T.top=-T.top;T.bottom=-T.bottom}else{T.left=rj(T.left)*1440;T.right=rj(T.right)*1440;T.top=rj(T.top)*1440;T.bottom=rj(T.bottom)*1440}xo=VV(T.right-T.left);yo=VV(T.bottom-T.top);FT=T}if(t.gr==null&&!t.FullPage){aO|=tc.TOFLAG_MERGE_PRINT_RECT}else if(t.gr!=null){e=re;re=L=t.gr;state=pH(L);var I=null;if(t.dpi>0){Ut=kt=t.dpi;T.left=Mj(T.left,t.dpi,yt);T.right=Mj(T.right,t.dpi,yt);T.top=Mj(T.top,t.dpi,Wt);T.bottom=Mj(T.bottom,t.dpi,Wt);FT=T}else{}if(t.IsPrinter)GetPrinterHiddenArea(L);else jo=Jo=0;eu=Mj(T.left,Ut,tg.UNITS_PER_INCH)-jo;ru=Mj(T.top,kt,tg.UNITS_PER_INCH)-Jo;aO|=tc.TOFLAG_MERGE_PRINT_RECT}if(!t.PrintMarginArea){var d=-1,F=-1;for(n=0;n<=Ri;n++){var g=n<Ri?Nj(Nc[ui[n].pfmt].flags&tc.PAGE_HDR_FTR):false;if(d==-1&&g)d=F=n;if(!g&&d!=-1){iw(d,F-d,gk("D"));d=F=-1}}}if(t.PrintMarginArea&&!yR){for(n=0;n<Ri;n++)if(Nj(Nc[ui[n].pfmt].flags&tc.PAGE_HDR_FTR))break;if(n<Ri)W5()}var P=false;if(Kl>1&&t.PrintMarginArea){var S,h;for(S=1;S<Kl;S++){if(!kl[S].InUse||Dj(kl[S].flags&tc.PARA_FRAME_VPAGE))continue;h=to[0].TopMargin*1440;kl[S].y-=h;kl[S].ParaY-=h;kl[S].flags=cj(kl[S].flags,tc.PARA_FRAME_VPAGE);kl[S].flags|=tc.PARA_FRAME_VMARG}}var O=t.gr!=null||!t.FullPage;if(O){for(r=0;r<ro;r++){var v=to[r].PprWidth;var p=to[r].PprHeight;eo[r].PgWidth=to[r].PprWidth=xo;eo[r].PgHeight=to[r].PprHeight=yo;to[r].IsPortrait=true;if(t.PrintMarginArea){to[r].LeftMargin=to[r].LeftMargin*xo/v;to[r].RightMargin=to[r].RightMargin*xo/v;to[r].TopMargin=to[r].TopMargin*yo/p;to[r].BotMargin=to[r].BotMargin*yo/p;to[r].HdrMargin=to[r].HdrMargin*yo/p;to[r].FtrMargin=to[r].FtrMargin*yo/p}else{to[r].LeftMargin=0;to[r].RightMargin=0;to[r].TopMargin=0;to[r].BotMargin=0;to[r].HdrMargin=0;to[r].FtrMargin=0}}}P=t.StartPos>0;if(P){var N;Cq(t.StartPos,gk("E"));for(n=0;n<_A;n++){N=Nc[ui[n].pfmt].BltId;if(N>0&&(!xc[N].IsBullet||xc[N].ls>0)){if(t.StartPos>0){var D=-1;_i.SetTerCursorPos(_A,AA,true);_i.TerPageBreak(true);_i.GetTerCursorPos(0);t.StartPos=PC;D=SC;R=true}P=false;break}}}if(P){sA=0;TA=0;Cq(t.StartPos,gk("E"));uA=tc.HILIGHT_CHAR;GN(false,false);E=true}B5();if(Li||Nj(rO&tc.TFLAG8_AUTO_REFORMAT_TABLES))_i.TerAdjustHtmlTable();yJ(false,false,0,true);if(!_i.TerMergeFields(t.MergeFields,t.MergeData,false)){QY(tc.MSG_ERR_MAIL_MERGE,null);break t}B5();yJ(false,false,0,true);B5();if(Kl>1)yJ(false,false,0,true);l0();if(t.StartPos<0){var M=-t.StartPos;if(M>=To)M=To-1;t.StartPos=Lq(po[M].FirstLine,0);Cq(t.StartPos);l=PC;i=SC;c=ui[l].page}else if(E){c=0;l=0;i=0}else{Cq(t.StartPos);l=PC;i=SC;c=ui[l].page}if(t.OnePage){Lo=c;By(true,Lo,Lo);a=po[Lo].LastLine}else a=Ri-1;f=ui[a].len-1;if(f<0)f=0;if(t.OnePage)s=_=c;else{s=ui[l].page;_=ui[a].page}if(L==null){return false}else{var G=_0(re,-1,c);if(C)t.NextY=-A.top+G;else t.NextY=A.top+Mj(G,254,14400)}if(a+1>=Ri||Lo>=To-1||!t.OnePage)t.NextPos=0;else{t.NextPos=Lq(po[c+1].FirstLine,0);if(E)t.NextPos+=t.StartPos;else if(R)t.NextPos-=1}o=true}if(t.gr!=null&&state!=null)NH(L,state);re=e;if(u!=null)XQ(u);return o};_i.TerSetPrintPreviewSize=function(t,e){if(!lv||!QD())_i.TerCreateControl();Nu=t;Du=e;return true};function G0(t){var e=new tc.RECT;var r;if(Ru){Nt=AT;wt=ET;H0();Ru=false;if(nT!=null)nT.delete();if(aT!=null)aT.delete();if(sT!=null)sT.delete();if(_T!=null)_T.delete();if(oT!=null)oT.delete();nT=aT=sT=_T=oT=0;oi.ShowStatus=bu;oi.ruler=xu;oi.ToolBar=yu;wA=Zu;oi.ShowHorBar=Yu;oi.ShowVerBar=Vu;Ti.save();Ti.setTransform(1,0,0,1,0,0);r=Ti.fillStyle;Ti.fillStyle=tc.CLR_WHITE.toString();Ti.fillRect(0,xO,_i.cvs.width,_i.cvs.height-xO);Ti.fillStyle=r;Ti.restore();iG();if(oi.ToolBar)tN();if(oi.ShowVerBar)op(true);if(oi.ShowHorBar)op(false);if(oi.ShowStatus)tB();ai=true;$R=true;if(oi.WordWrap&&jt>=ui[br].len)jt=ui[br].len-1;if(jt<0)jt=0;NT=Lo;vT=br;pT=jt;MT=tc.CURS_FORWARD;if(oi.FittedView||Kl>1)_i.TerRepaginate(false);if($u!=qe&&oi.PageMode)By(false,$u,tT);BG();_q();Br=tc.PAINT_WIN;_z(true);cG();return true}zu=true;if(!B0(Ti)){Ru=false;return false}AT=Nt;ET=wt;if(nh!=0&&nh!=100){Ex(Ti);_i.TerRepaginate(false)}if(oi.ToolBar){oi.ToolBar=false;SN();iG()}Ti.save();Ti.setTransform(1,0,0,1,0,0);r=Ti.fillStyle;Ti.fillStyle=tc.CLR_WHITE.toString();Ti.fillRect(0,xO,_i.cvs.width,_i.cvs.height-xO);Ti.fillStyle=r;Ti.restore();oi.ShowStatus=oi.ruler=oi.ToolBar=false;Aq();wA=0;K0();oi.ShowHorBar=true;oi.ShowVerBar=true;op(true);op(false);_p(true);iG();zu=false;if(nh!=0&&nh!=100)Ex(Ti);b0();return true}_i.TerSetPrintPreview=function(t){if(!lv||!QD())_i.TerCreateControl();if(t&&Lu)return false;if(!t&&!Lu)return false;if(t){$u=qe}if(!t&&Eu){H0();if(oi.FittedView)_i.TerRepaginate(false);if($u!=qe&&oi.PageMode)By(false,$u,tT);BG();_q();Br=tc.PAINT_WIN;_z(true);cG()}Lu=t;return true};_i.TerSetPdfFirstPage=function(t){sh=t;return true};_i.TerPageBitmap=function(t){var e=96;var r,i;if(!lv||!QD())_i.TerCreateControl();_i.TerGetPageOrientEx(t);r=zI;i=ZI;var f=document.createElement("canvas");f.width=r;f.height=i;gr=f.getContext("2d");var l=new tc.Rectangle;l.x=l.y=0;l.width=Mj(r,e,1440);l.height=Mj(i,e,1440);_i.TerPrintPreview(gr,l,t,true);return f};_i.TerPrintPreview=function(t,e,r,i){if(!lv||!QD())_i.TerCreateControl();var f=1;if(!Lu||!Eu){if(!B0(t)){Ru=false;return false}pr=true}if(Lu){if(false){H0();if(i)m0(t,XY(e),r,-1);if(!oi.WordWrap)f=To;B0(t);if(!oi.WordWrap)To=f;pr=true}else re=t}if(oi.PrintView&&r<0)r=cz(br);w0(t,XY(e),r,i);if(!Lu){H0();cG()}return true};_i.TerSetPreview=function(t,e,r){ZU("TerSetPreview");if(!lv||!QD())_i.TerCreateControl();if(t<1)t=1;if(t>2)t=2;if(e<0)e=0;if(e>200)e=200;Bu=t;Hu=e;Ju=r;if(Ru){_i.TerRepaint(true)}return true};function B0(t){var e;var r=false,i;var f=null;t:{if(Dj(zh&tc.TFLAG_NO_HOUR_GLASS)){f=XQ(U)}qx(t);Eu=true;pr=true;Ru=true;i=si;si=false;Wu=oi.WordWrap;if(!oi.WordWrap)a0();if(DE)Z5(true);if(ME)Z5(false);Uu=oi.PrintView;ku=oi.PageMode;Xu=FS;Ku=oi.FittedView;bu=oi.ShowStatus;xu=oi.ruler;yu=oi.ToolBar;Zu=wA;Yu=oi.ShowHorBar;Vu=oi.ShowVerBar;ju=yR;Qu=Ft;qu=Gt;$u=qe;tT=$e;B5();if(!W$(false))break t;if(oi.WordWrap&&!oi.PrintView){oi.PrintView=true}if(oi.PrintView){FS=false;if(!oi.PageMode)oi.PageMode=true;oi.FittedView=false;if(ku&&WR)y5();if(Uu&&!yR){for(e=0;e<ro;e++){if(eo[e].hdr.FirstLine>=0||eo[e].ftr.FirstLine>=0||eo[e].fhdr.FirstLine>=0||eo[e].fftr.FirstLine>=0||eo[e].rhdr.FirstLine>=0||eo[e].rftr.FirstLine>=0||eo[e].lhdr.FirstLine>=0||eo[e].lftr.FirstLine>=0){W5();break}}}}if(oi.PrintView){if(Li||Nj(rO&tc.TFLAG8_AUTO_REFORMAT_TABLES))_i.TerAdjustHtmlTable();yJ(false,false,0,true);B5()}if(!oi.WordWrap)To=Lo=0;Ft=Gt=0;CT=IT=dT=tc.CLR_WHITE;re=t;r=true}pr=false;si=i;if(f!=null)XQ(f);return r}function H0(){var t;var e=null;if(Dj(zh&tc.TFLAG_NO_HOUR_GLASS)){e=XQ(U)}pr=true;t=si;si=false;Ft=Gt=0;oi.FittedView=Ku;FS=Xu;if(!ju&&yR&&ku)W5();if(!ku)Gz();if(!Uu)oi.PrintView=oi.PageMode=false;if(!Wu)n0();t_=false;Eu=false;pr=false;Ru=false;if(nh!=0&&nh!=100)Ex(Ti);na=ca=0;Ft=Qu;Gt=qu;if(_l){Ti.setTransform(1,0,0,1,0,0);Ti.translate(-Ft+rt.left,-Gt+rt.top)}si=t;yn=tc.WRAP_PAGE;if(Li||Nj(rO&tc.TFLAG8_AUTO_REFORMAT_TABLES))_i.TerAdjustHtmlTable();if(e!=null)XQ(e);return true}function m0(t,e,r,i){if(i<0)i=_i.TerGetPageSect(r);$o=e.left;tu=e.top;zo=eo[i].PgWidth*Ai;Zo=eo[i].PgHeight*Ei;Qo=e.right-e.left;qo=e.bottom-e.top;return true}function w0(t,e,r,i){var f;var l=null;t.save();if(i){f=_i.TerGetPageSect(r);m0(t,e,r,f);t.setTransform(1,0,0,1,0,0);t.translate($o-Mj(Ft,Qo,zo),tu-Mj(Gt,qo,Zo));t.scale(Qo/zo,qo/Zo)}l=re;re=t;_0(re,-1,r);if(l!=null)re=l;t.restore();return true}function b0(){var t,e,r,i,f,l,a,n;var c,s,_,o;var u,T,A,E,R=0,L=0,C,I;var d=new tc.RECT,F;var g,P,S;var h,O,v;var p,N,D,M;var G;var B;if(Bu==0||zu)return true;if(oi.PrintView)Lo=cz(br);f=v=Lo;if(false&&et!=null)G=et;else G=Ti;if(Bu>2)Bu=2;e=_i.TerGetPageSect(f);u=A=eo[e].PgWidth;T=E=eo[e].PgHeight;if(Bu>1){if(f+1<To)e=_i.TerGetPageSect(f+1);R=eo[e].PgWidth;L=eo[e].PgHeight;u+=tc.PV_PAGE_DIST+R;if(L>E)T=L}if(true){for(t=0;t<WE;t++){if(kE[t].InUse&&kE[t].ctl!=null&&kE[t].ctl.isVisible()){kE[t].ctl.setVisible(false);kE[t].InUse=false}}BG();kG();B=new tc.Brush(jT);oJ(G,B,new tc.Rectangle(Ft-rt.left,Gt-rt.top+wA+xO,K.right-K.left,K.bottom-K.top-wA));Wo=u;Uo=T}if(Hu<=0){a=Mt*u/T;if(je>a){n=Mt;r=(je-a)/2;i=0}else{n=je*T/u;a=je;r=0;i=(Mt-n)/2;if(i<0)i=0}Ft=Gt=0}else{a=Nt*u*Hu/100;n=wt*T*Hu/100;r=i=0;if(je>a){r=(je-a)/2;Ft=0}if(Mt>n){i=(Mt-n)/2;Gt=0}}mu=n;wu=a;l=tc.PV_PAGE_DIST*a/u;G.save();G.setTransform(1,0,0,1,0,0);WG(G,new tc.Rectangle(0,xO+wA,_i.cvs.width-Y,_i.cvs.height-(xO+wA+Y)));for(t=0;t<Bu;t++,f++){if(t==0){C=A;I=E}else{C=R;I=L}_=C*a/u;o=I*n/T;d.left=r;d.right=d.left+_-1;d.top=i;d.bottom=d.top+o-1;var H=d.copy();H.left+=rt.left;H.right+=rt.left;H.top+=rt.top;H.bottom+=rt.top;G.save();O=Ai*A;if(Bu>1)O+=Ai*(R+tc.PV_PAGE_DIST);h=Mj(je,O,wu);P=T*Ei;g=Mj(Mt,P,mu);G.setTransform(1,0,0,1,0,0);G.translate(-Mj(Ft,je,h)+rt.left,-Mj(Gt,Mt,g)+rt.top+xO);WG(G,new tc.Rectangle(d.left,d.top,d.right-d.left,d.bottom-d.top));oJ(G,new tc.Brush(tc.CLR_WHITE),new tc.Rectangle(d.left,d.top,d.right-d.left,d.bottom-d.top));w0(G,H,f,true);s=Mj(o,Gt,I*Ei);if(Mt>o)s=0;c=Mj(_,Ft,C*Ai);if(je>wu)c=0;$o=c;tu=s;G.restore();if(t>0){F=d.copy();F.right=d.left;F.left=F.right-l;B=new tc.Brush(jT);oJ(G,B,new tc.Rectangle(F.left+rt.left,i+rt.top,l,mu-1))}MH(G,new tc.Pen(tc.CLR_BLACK),d.left+rt.left,d.top+rt.top,d.right-d.left-1,d.bottom-d.top-1);CloseDC=true;r+=_+l}G.restore();if(oi.PrintView)Lo=v;if(oT!=null){var m;if(Bu==1||Lo+1==To)m=tg.MsgString[tc.MSG_PP_PG]+mY(Lo+1);else m=tg.MsgString[tc.MSG_PP_PG]+mY(Lo+1)+"/"+mY(Lo+2);oT.setText(m);oT.show()}P=T*Ei;g=Mj(Mt,P,mu);if(oi.ShowVerBar){D=tc.SCROLL_RANGE-ct;N=P*To-g;if(N>0){p=P*Lo+Gt;S=p*D/N;if(p>=N&&p>0)S=D;if(S<0)S=0}else S=0;M=0;if(N<=0)M=tc.SCROLL_RANGE;else{M=Mj(Mt,tc.SCROLL_RANGE,N);if(M<ut)M=ut;if(M>tc.SCROLL_RANGE)M=tc.SCROLL_RANGE}if(M==tc.SCROLL_RANGE&&Gt!=0)M--;if(S!=nt||M!=ct){if(S>tc.SCROLL_RANGE-M)S=tc.SCROLL_RANGE-M;mi=true;b.SetThumbPos(S,M);mi=false;nt=S;ct=M}}O=Ai*A;if(Bu>1)O+=Ai*(R+tc.PV_PAGE_DIST);h=Mj(je,O,wu);if(oi.ShowHorBar){D=tc.SCROLL_RANGE;N=O-h;M=je*tc.SCROLL_RANGE/wu;if(M<ut)M=ut;if(M>tc.SCROLL_RANGE)M=tc.SCROLL_RANGE;D-=M;if(N>0){p=Ft;S=p*D/N;if(p>=N&&p>0)S=D;if(S<0)S=0}else S=0;if(S!=at||M!=st){mi=true;w.SetThumbPos(S,M);mi=false;at=S;st=M}}return true}function x0(t){var e,r;r=Ai*Wo;e=Mj(je,r,wu);if(Ft+e>=r)return true;else{if(t)Ft+=e;else Ft+=e/6;if(Ft+e>r)Ft=r-e}b0();return true}function y0(t){var e,r;r=Ai*Wo;e=Mj(je,r,wu);if(Ft<=0)return true;else{if(t)Ft-=e;else Ft-=e/6;if(Ft<0)Ft=0}b0();return true}function W0(t){var e=tc.SCROLL_RANGE-st;var r,i;i=Ai*Wo;r=Mj(je,i,wu);if(t<2){Ft=0}else if(t>=e-2){Ft=i-r}else{if(e>0)Ft=(i-r)*t/e}b0();return true}function U0(t){var e;var r,i,f,l,a,n;var c=tc.SCROLL_RANGE-ct;var s,_;n=Lo;_=Uo*Ei;s=Mj(Mt,_,mu);r=_*To;if(t>=c-2){e=To-1;f=_-s}else{i=r*t/c;l=0;for(e=0;e<To-1;e++){a=_;if(l+a>i)break;l+=a}f=i-l}if(f>_-s)f=_-s;if(f<0)f=0;Lo=e;if(Lo!=n){br=po[Lo].FirstLine;jt=0}Gt=f;b0();return true}function k0(t){var e,r;r=Math.floor(Uo*Ei);e=Mj(Mt,r,mu);if(Gt+e>=r){if(Lo+1<To){Lo++;br=po[Lo].FirstLine;jt=0;Gt=0}else return true}else{if(t)Gt+=e;else Gt+=e/6;if(Gt+e>r)Gt=r-e}b0();return true}function X0(t){var e,r;r=Math.floor(Uo*Ei);e=Mj(Mt,r,mu);if(Gt==0){if(Lo>0){Lo--;br=po[Lo].FirstLine;jt=0;Gt=r-e;if(Gt<0)Gt=0}else return true}else{if(t)Gt-=e;else Gt-=e/6;if(Gt<0)Gt=0}b0();return true}function K0(){var t;var e=xO+tg.TLB_MARGIN+1;wA=tg.TLB_ICON_HEIGHT+2*tg.TLB_MARGIN;uT=true;Ti.save();Ti.setTransform(1,0,0,1,0,0);var r=Ti.fillStyle;if(nA==null)Ti.fillStyle=WO.toString();else Ti.fillStyle=cA.toString();Ti.fillRect(0,xO,_i.cvs.width,wA);Ti.fillStyle=r;nT=new $t.ComboBox(_i.cvs,JV(20),e,JV(70),tg.TLB_ICON_HEIGHT,true,JV(200),true,JA,true,false,function(t,e){Y0(t,e)});cT[0]=tg.MsgString[tc.MSG_PP_FITTED];var i=Hu;if(i<=0)i=0;else i=cT.indexOf(mY(i)+"%");if(i<0)i=0;nT.setItems(cT,null,i,false);nT.setMaximumRowCount(cT.length);nT.name="PvZoom";nT.refresh();var f=tg.TLB_ICON_HEIGHT+1;var l=Bu==1?tg.MsgString[tc.MSG_PP_TWO_PAGES]:tg.MsgString[tc.MSG_PP_ONE_PAGE];aT=new $t.Button(_i.cvs,JV(106),e,JV(80),f-2,JA,l,true,function(t,e){V0(t,e,te)});aT.name="PvPages";aT.show();if(Dj(iO&tc.TFLAG9_HIDE_PRINT_BUTTON)){l=tg.MsgString[tc.MSG_PP_PRINT];sT=new $t.Button(_i.cvs,JV(210),e,JV(70),f-JV(2),JA,l,true,function(t,e){V0(t,e,te)});sT.name="PvPrint";sT.show()}else sT=null;if(Dj(rO&tc.TFLAG8_HIDE_PPV_EDIT_BUTTON)){l=oi.ReadOnly?tg.MsgString[tc.MSG_PP_CLOSE]:tg.MsgString[tc.MSG_PP_EDIT];_T=new $t.Button(_i.cvs,JV(300),e,JV(70),f-JV(2),JA,l,true,function(t,e){V0(t,e,te)});_T.name="PvClose";_T.show()}else _T=false;oT=new $t.Label(_i.cvs,JV(390),e+JV(5),JA,tg.MsgString[tc.MSG_PP_PG]+"1");oT.name="PvPageNo";oT.show();var a=new tc.Pen(new tc.Color(13684944));var n=xO+1;_J(Ti,a,0,n,_i.cvs.width,n);_J(Ti,a,0,xO+wA,_i.cvs.width,xO+wA);Ti.restore();uT=false}function Y0(t,e){var r=0;if(t!="selected")return;var i=e.getSelectedItem();if(i=="Fitted")r=-1;else{var f=i.length;if(f>0&&i.charAt(f-1)=="%"){i=cV(i,0,f-1);r=LX(i)}}if(r!=0){Hu=r;b0()}}function V0(t,e,r){var i="";if(uT)return;if(e.name=="PvClose"){_T.delete();_T=null;_i.TerCommand(tc.ID_PRINT_PREVIEW);_i.ForgetMouseUp=true}else if(e.name=="PvPages"){if(Bu==1)Bu=2;else Bu=1;i=Bu==1?tg.MsgString[tc.MSG_PP_TWO_PAGES]:tg.MsgString[tc.MSG_PP_ONE_PAGE];aT.setText(i);b0();_i.ForgetMouseUp=true}else if(e.name=="PvPrint"){Cu=true;qQ(tc.TER_WM_COMMAND,tc.ID_PRINT_PREVIEW,0);qQ(tc.TER_WM_COMMAND,tc.ID_PRINT,0);_i.ForgetMouseUp=true}}_i.TerSetDefPrinter=function(t,e){DefPrt=t;DefPrtPage=e;return true};_i.TerSelectPrint=function(){return _i.TerSelectPrint2(1)};_i.TerSelectPrint2=function(t){var e;if(!lv||!QD())_i.TerCreateControl();if(!Iu||uA==tc.HILIGHT_OFF)return false;if(!ON())return false;e=new TejPrint;e.InputType="B";e.buffer=_i.TerGetRtfSel();e.gr=null;e.OnePage=false;e.FullPage=true;return _i.TerMergePrint(e)};_i.TerIsPrinting=function(){if(!lv||!QD())_i.TerCreateControl();return Eu};_i.TerOverridePageSize=function(t,e){InitPageWidth=t;InitPageHeight=e;return true};_i.TerSetRepInfo=function(t,e,r,i,f){if(!lv||!QD())_i.TerCreateControl();YL=t;VL=e;jL=r;zL=i;JL=f;return true};_i.TerSpoolBegin=function(t){return true};_i.TerSpoolEnd=function(){return true};function j0(t,e){return t==e?0:1}_i.InsertRtfBuf=function(t,e,r,i){var f=e;var l=r;var a=si,n=false;var c=false;var s,_;var o,u,T,A;var E,R;var L=tc.RTF_CB;var C=false;var I=false,d=false;var F=0,g=0;var P=t==null?0:t.length;if(!lv||!QD())_i.TerCreateControl();if(f<0){if(f==-2){L=tc.RTF_CB_APPEND;f=br=Ri-1;l=jt=ui[br].len-1;if(jt<0)l=jt=0}else{f=br;l=jt}}else{if(l<0){Cq(f);f=PC;l=SC}if(f>=Ri){f=Ri-1;l=ui[f].len;if(oi.WordWrap)l--;if(l<0)l=0}if(f<0)f=0;if(l>ui[f].len)l=ui[f].len;if(l<0)l=0}if(Nj(nO&tc.TOFLAG2_FROM_CB)&&Te>0){var S=ib(f,l);if(xs[S].FieldId==tc.FIELD_DATA){if(_i.TerLocateFieldChar(tc.FIELD_DATA,null,false,f,l,false)){f=zC;l=ZC;if(_i.TerLocateFieldChar(tc.FIELD_NAME,null,false,f,l,false)){f=zC;l=ZC;Rm(f,l);f=PC;l=SC}}}}br=f;jt=l;if(L==tc.RTF_CB&&Nj(ui[br].cid)){C=true}g=uE;I=false;if(L==tc.RTF_CB_APPEND)u=Lq(Ri-1,ui[Ri-1].len-1);else{I=J0(L,t);u=Qd;F=qd;if(!I){var h=false;if(L==tc.RTF_CB&&!TE){for(_=br;_>0;_--)if(Nj(ui[_].flags&tc.LFLAG_PARA_FIRST))break;if(br>_||jt>0)h=true;if(h){var O=br;var v=jt-1;if(v<0&&O>0){O--;v=ui[O].len-1}V8(_,0,O,v,tc.CHAR_D);u=Lq(_,0)}}if(!h)u=Lq(br,jt)}}if(jt>0&&L!=tc.RTF_CB_APPEND){a=si;si=false;c=sm(0,Er,true);si=a;n=true;if(!c)return false;if(br>0)ui[br-1].flags=cj(ui[br-1].flags,tc.LFLAG_PARA|tc.LFLAG_BREAK)}if(TE&&Nj(nO&tc.TOFLAG2_TEXT_TO_TABLE)){for(s=br-1;s>=0;s--)if(Nj(ui[s].flags&tc.LFLAG_PARA_FIRST))break;if(s<0)s=0;for(;s<br;s++)ui[s].cid=0}if(Dj(nO&tc.TOFLAG2_FROM_CB)&&!TE){gi=Nj(Qh&tc.TFLAG3_EMBEDDED_TABLES);Te=0}_=br;c=Z0(L,null,t,P);if(_>0&&n)_--;if(oi.WordWrap){if(L>=tc.RTF_CB)GR=true;T9(_,br-_+1);GR=false}if(!oi.WordWrap&&br>_){q0(_,br)}Cq(u);o=PC;E=SC;A=Lq(br,jt);d=u==A;if(C&&jt==0&&br>0&&ui[br].cid!=ui[br-1].cid&&ui[br-1].cid>0&&GY(br-1,tc.INFO_CELL|tc.INFO_ROW)){A--}Cq(A-1);T=PC;R=SC;if(c){if(I)z0(o,E,F,g);else if(!d)V8(o,E,T,R,tc.CHAR_I)}if(i)cG();return c};function J0(t,e){var r,i,f,l,a,n,c,s,_,o;var u;var T,A,E;var R,L=false;Qd=qd=0;if(TE||t!=tc.RTF_CB)return false;l=ui[br].cid;if(l==0)return false;if(e==null||e.length==0)return false;L=e.indexOf("\\cell")>=0;if(!L)return false;l=E6(0,-l);for(a=eR[l].row;a>=0;a=$E[a].PrevRow){if($E[a].PrevRow<=0||Nj($E[a].flags&tc.ROWFLAG_NEW_TABLE))break;for(s=$E[a].FirstCell;s>0;s=eR[s].NextCell)if(Nj(eR[s].flags&tc.CFLAG_ROW_SPANNED))break;if(s<=0)break}R=false;n=$E[a].FirstCell;c=eR[n].level;for(T=br;T>=0;T--){s=ui[T].cid;if(s==0)break;if(eR[s].level>c)continue;if(eR[s].level<c)break;if(s==n)R=true;if(R&&s!=n)break}A=T+1;Qd=Lq(A,0);r=0;if(Te>=0&&Nj(nO&tc.TOFLAG2_FROM_CB))r=Ee;i=1;for(a=eR[l].row;a>=0;a=$E[a].NextRow,i++){_=$E[a].NextRow;if(_<=0||Nj($E[_].flags&tc.ROWFLAG_NEW_TABLE))break;if(!E8(_)){if(r==0&&i>=r)break}}R=false;n=$E[a].LastCell;c=eR[n].level;for(T=br;T<Ri;T++){s=ui[T].cid;if(eR[s].level>c){if(!R)continue;if(E6(c,T)==n)continue}if(eR[s].level<c)break;if(s==n)R=true;if(R&&s!=n)break}E=T;qd=ui[E].cid;o=Te;u=gi;Te=0;gi=false;if(qd>0){a=eR[qd].row;for(;;a=$E[a].PrevRow)if(s6(a))break;for(;;a=$E[a].NextRow){$E[a].flags=_j($E[a].flags,tc.ROWFLAG_AUTO_FIT|tc.ROWFLAG_AUTO_WIDTH_RTF);$E[a].FixWidth=0;if(u6(a))break}}m6();f=_E;V8(A,0,E-1,ui[E-1].len-1,tc.CHAR_D);if(_E>f)sE[_E-1].type=tc.UNDO_ROW_DEL;Te=o;gi=u;return true}function z0(t,e,r,i){var f,l;for(f=t;f<Ri;f++)if(ui[f].cid==r)break;l=f-1;if(l>=0){uE=i;V8(t,e,l,ui[l].len-1,tc.UNDO_ROW_INS)}else n9();return true}function Z0(t,e,r,i){var f=null;var l=null;var a=true;var n,c;var s=si;var _=null;var o=new tc.ClsRtfPict;var u=new tc.ClsRtfObject;var T;ZU("RtfRead");if(t==tc.RTF_FILE)return false;ah=t;HE="";mE=0;L_="";if(ah<tc.RTF_CB)Mi=false;for(n=0;n<iR;n++){if($E[n].InUse)$E[n].flags|=tc.ROWFLAG_PREEXIST;tR[n].flags=cj(tR[n].flags,tc.TAUX_TROWD_DONE|tc.TAUX_REUSE_CELL_CHAIN|tc.TAUX_HAS_NEW_TEXT|tc.TAUX_RTF_DEL|tc.TAUX_COPIED)}for(n=0;n<fR;n++){if(eR[n].InUse){eR[n].flags|=tc.CFLAG_PREEXIST;rR[n].flags=cj(rR[n].flags,tc.CAUX_CLOSED)}}nO=_j(nO,tc.TOFLAG2_DONT_ULINE_TRAIL_SPC);for(n=0;n<Al;n++)ul[n].RtfId=n;for(n=0;n<Vc;n++){Kc[n].RtfId=0;Kc[n].flags=cj(Kc[n].flags,tc.LISTFLAG_NEW_LIST)}f=new tc.ClsRtf;f.InitArray();c=G5(br);f.PaperWidth=jV(eo[c].PgWidth);f.PaperHeight=jV(eo[c].PgHeight);f.InitTblCol=-1;f.CurTabType=tc.TAB_LEFT;f.lang=MO;f.OutBuf="";f.sect=new tc.ClsSect;if(Ri==1&&ui[0].len<=1)f.EmptyDoc=true;f.TopColorGroup=1;if(t==tc.RTF_FILE)f.iFile=iFile;else{f.buf=Uk(r);f.BufLen=i;f.iFile=null}wR=50;l=f.group=[wR];for(n=0;n<wR;n++){l[n]=new tc.ClsRtfGroup;l[n].init()}l[0].rtf=f;l[0].CharStyId=1;l[0].CharSet=ks;l[0].CellPatBC=tc.CLR_WHITE;l[0].CharBkPat=tc.PAT_NONE;l[0].CellBorderType=tc.BRDRTYPE_NONE;l[0].ParaBkColor=tc.CLR_WHITE;l[0].CharPatBC=tc.CLR_WHITE;l[0].shape.WrapType=tc.SWRAP_NO_WRAP;l[0].shape.WrapSide=tc.WRAPSIDE_BOTH;l[0].shape.type=tc.SHPTYPE_NONE;l[0].UcIgnoreCount=1;l[0].TextBoxMargin=-1;l[0].OutlineLevel=-1;l[0].RowBand=-2;l[0].ParaBorderColor=tc.CLR_AUTO;l[0].RowColStyle=-1;l[0].TypeFace=oi.FontTypeFace;l[0].TypeFaceDB=oi.FontTypeFace;l[0].TypeFaceHi=oi.FontTypeFace;l[0].TypeFaceCs=oi.FontTypeFace;l[0].FontFamily="nil";l[0].PointSize2=f.InXml?20:2*oi.PointSize;l[0].TextColor=xs[0].TextColor;l[0].TextBkColor=tc.CLR_WHITE;l[0].HilightColor=tc.CLR_WHITE;l[0].UlineColor=tc.CLR_AUTO;for(n=0;n<tc.MAX_BORDERS;n++)l[0].BorderColor[n]=tc.CLR_AUTO;l[0].blt=xc[0];gR=PR=hR=OR=0;MR=false;bR=new tc.ClsRtfParaFrameInfo;nR=0;s=si;si=false;t:{e:{r:{a=false;if(!r2(f)||Dj(f.GroupBegin))break t;if(!r2(f)||Dj(f.IsControlWord))break t;f.CurWord=f.CurWord.toUpperCase();if(Tk("RTF",f.CurWord)!=0)break t;P2(f,f.GroupLevel);if(Dj(zh&tc.TFLAG_NO_HOUR_GLASS)){_=XQ(U)}if(!t1(tc.RTF_BEGIN,l[f.GroupLevel],null,o,u))break t;f.sect=to[f.InitSect].copy();if(Nj(Qh&tc.TFLAG3_GET_BUF_HDR_FTR))f.sect.IsPortrait=true;for(n=0;n<f.GroupLevel;n++){l[n].flags=l[f.GroupLevel].flags;l[n].FrmFlags=l[f.GroupLevel].FrmFlags;l[n].level=l[f.GroupLevel].level;l[n].ParaFrameInfo=l[f.GroupLevel].ParaFrameInfo.copy()}for(n=0;n<=f.GroupLevel;n++)l[n].sect=f.sect.copy();f.InitialCell=PR;f.InitialParaFID=OR;f.SectGroup=f.GroupLevel;a=true;i:while(true){f.flags2|=tc.RFLAG2_CAN_EXPAND_GROUP_TABLE;if(!r2(f))break t;l=f.group;f.flags2=cj(f.flags2,tc.RFLAG2_CAN_EXPAND_GROUP_TABLE);if(f.IsControlWord){var A=tc.RTF_FILE_INCOMPLETE;A=r1(f);if(A==tc.RTF_FILE_INCOMPLETE)break r;else if(A==tc.RTF_SYNTAX_ERROR)break e;else if(A==tc.RTF_END_FILE)break t;else if(f.SuspendReading)break t}else if(f.WordLen>0){if(!Q0(f))break t}}}T=SY("pos: %d, control: %b, beg group: %b, end group: %b, word: %s, word len: %d, param: %d",f.FilePos,f.IsControlWord,f.GroupBegin,f.GroupEnd,f.CurWord,f.WordLen,f.IntParam);QY(tc.MSG_UNEXPECTED_EOF,T);break t}T=SY("pos: %d, control: %b, beg group: %b, end group: %b, word: %s, word len: %d, param: %d",f.FilePos,f.IsControlWord,f.GroupBegin,f.GroupEnd,f.CurWord,f.WordLen,f.IntParam);QY(tc.MSG_READ_ABORTED,T)}b1(f);if(f.TagId>0){if(br<Ri)C1(f,br)}if(f.OpenRowId>0)e1(f,f.OpenRowId);if(f.InputType<tc.RTF_CB&&Ri>0){var E=ui[Ri-1].pfmt;if(Nj(Nc[E].flags&tc.PAGE_HDR_FTR)){Ri++;br=Ri-1;Ip(br);ui[br].pfmt=sZ()}}if(a)t1(tc.RTF_END,l[0],f,o,u);else{GR=false}if(_!=null){XQ(_)}try{if(iFile!=null)iFile.close()}catch(t){}si=s;return a}function Q0(t){var e=t.group;var r;if(t.SkipSpaces&&e[t.GroupLevel].InTable)t.SkipSpaces=false;if(t.SkipSpaces){var i=Uk(t.CurWord);for(r=0;r<t.WordLen;r++)if(i[r]!=tc.SPACE)break;if(r==t.WordLen)return true}if(e[t.GroupLevel].IgnoreCount>0){var f=e[t.GroupLevel].IgnoreCount>t.WordLen?t.WordLen:e[t.GroupLevel].IgnoreCount;t.CurWord=t.CurWord.substring(f);t.WordLen=t.CurWord.length;e[t.GroupLevel].IgnoreCount-=f}if(t.WordLen>0){if(t.OutBufLen+t.WordLen>tc.RTF_LINE_LEN||t.OutBufHasUnicode)if(!b1(t))return false;t.OutBuf+=t.CurWord;t.OutBufLen+=t.WordLen}t.SkipSpaces=false;return true}function q0(t,e){var r,i,f=0,l,a;var n=[1];var c;var s=[1];var _,o,u;var T;var A;var E;a=0;for(r=0;r<=br;r++){if(r<br)_=ui[r].len;else _=jt;a+=_;if(_>0&&r>=t){T=ui[r].txt;if(T[_-1]==Bn)a--}}_=0;for(r=t;r<=e;r++){if(_==0)f=r;o=ui[r].len;T=ui[r].txt;if(o>0)c=T[o-1];else c=0;E=false;if(c==Bn||xY(qS,c))E=true;if(E){Tm(r,o,o-1);o=ui[r].len}if(_==0&&o>=tc.MAX_WIDTH)continue;l=-1;if(_>0&&_+o>=tc.MAX_WIDTH)l=r=r-1;if(l==-1){T=ui[r].txt;A=nb(r);n=fV(n,_+o);s=fV(s,_+o);for(u=0;u<o;u++){n[_+u]=T[u];s[_+u]=A[u]}sb(r);_+=o;if(E||r==e)l=r}if(l==-1)continue;if(l<f)l=f;if(l>f){Tm(f,ui[f].len,_);T=ui[f].txt;A=nb(f);for(u=0;u<_;u++){T[u]=n[u];A[u]=s[u]}sb(f);i=l-f;iw(f+1,i,tc.CHAR_D);r-=i;e-=i}_=0}for(r=t;r<=e;r++){ui[r].pfmt=0;Dc=1;if(Nj(ui[r].tabw))yX(r)}br=jt=0;while(a>=0){if(a>=ui[br].len)a=a-ui[br].len;else{jt=a;break}if(br>=Ri-1){jt=ui[Ri-1].len;break}br++}if(jt<0)jt=0;return true}function $0(){var t,e,r;var i;var f,l;var a,n;var c;f=true;for(i=0;i<Ri-1;i++){e=ui[i].len;if(e==0)continue;if(f&&!vm(i))f=false;a=ui[i].txt;if(a[e-1]!=Bn){if(BY(a[e-1]))f=true;continue}t=ib(i,e-1);if(!f&&Nj(xs[t].style&tc.HIDDEN)&&ui[i].cid==ui[i+1].cid&&ui[i].fid==ui[i+1].fid){l=true;if(ui[i+1].len>0){n=ui[i+1].txt;if(hj(n[0]))l=false;if(n[ui[i+1].len-1]==tc.SECT_CHAR)l=false}if(l){ui[i].txt[e-1]=tc.HPARA_CHAR;Bx(i,e-1,tc.TERTAG_HPARA,"HPARA",null,ui[i+1].pfmt);r=ui[i].pfmt;ui[i].flags=cj(ui[i].flags,tc.LFLAG_PARA);ui[i+1].flags=cj(ui[i+1].flags,tc.LFLAG_PARA_FIRST);for(i++;i<Ri;i++){e=ui[i].len;if(e<=0)continue;ui[i].pfmt=r;MZ(i,Nc[r].StyId);c=ui[i].txt[e-1];if(BY(c))break}}}f=true}return true}function t1(t,e,r,i,f){var l;var a;var n,c,s,_;var o;var u=false;var T,A;if(t!=tc.RTF_BEGIN&&t!=tc.RTF_END){O2(e)}switch(t){case tc.RTF_BEGIN:GR=true;HR=false;a=e.rtf;a.FirstLine=br;a.FirstLineParaId=ui[br].pfmt;e.TypeFace=oi.FontTypeFace;e.FontFamily="nil";e.TypeFaceDB=oi.FontTypeFace;e.TypeFaceHi=oi.FontTypeFace;e.TypeFaceCs=oi.FontTypeFace;e.PointSize2=a.InXml?20:2*oi.PointSize;e.TextColor=xs[0].TextColor;e.TextBkColor=tc.CLR_WHITE;e.HilightColor=tc.CLR_WHITE;e.UlineColor=tc.CLR_AUTO;SR=PR=gR=hR=0;a.OpenCellId=a.OpenRowId=a.OpenLastCellX=0;NR=0;a.EmbedTable=true;if(ah==tc.RTF_FILE||ah==tc.RTF_BUF){for(o=0;o<Ri;o++)dp(o);Ri=0;lh=tc.SAVE_RTF;if(e.TextColor==tc.Color.black)e.TextColor=tc.CLR_AUTO;BR=0;a.InitSect=0;Gi=false;Hi=false;qi=false;if(a.InXml)qi=true}else{BR=Nc[ui[br].pfmt].flags&tc.PAGE_HDR_FTR;a.flags1|=tc.RFLAG1_FIRST_TABLE;e.flags|=BR;SR=PR=ui[br].cid;if(TE&&EE==tc.UNDO_ROW_DEL)PR=0;else if(TE&&Nj(nO&tc.TOFLAG2_TEXT_TO_TABLE))SR=PR=0;if(PR>0){gR=eR[PR].row;e.InTable=true;a.flags|=tc.RFLAG_CURS_IN_TABLE;a.InitTblCol=G6(PR,true);if(!gi&&(Te<=0||eR[PR].level==Te-1)){var E=false;var R=Sa.altKey;if((R||Nj(iO&tc.TFLAG9_ALWAYS_EMBED_TABLES))&&ah==tc.RTF_CB)E=true;if(!E){a.EmbedTable=false;if(eR[PR].PrevCell>0||Dj(zh&tc.TFLAG_ROW_PASTE))a.PastingColumn=true}}if(Te<0){if(Nj(nO&tc.TOFLAG2_FROM_CB)){a.PastingColumn=false;a.EmbedTable=true}Te=1}else if(Ae>0&&Nj(nO&tc.TOFLAG2_FROM_CB))a.PastingColumn=false;if(!GY(br,tc.INFO_ROW))a.InsertBefCell=PR;NR=eR[PR].level+1;e.level=a.CurTblLevel=NR;x2(a,a.CurTblLevel);if(a.CurTblLevel>0){for(n=0;n<a.CurTblLevel;n++)a.TblLevel[n]=new tc.ClsRtfTableLevel;a.TblLevel[a.CurTblLevel-1].CurCellId=eR[PR].ParentCell}a.IgnoreFrames=true}OR=ui[br].fid;if(OR>0){bR.x=kl[OR].x;bR.y=kl[OR].ParaY;bR.width=kl[OR].width;bR.height=kl[OR].MinHeight;bR.DistFromTextLeft=kl[OR].DistFromTextLeft;bR.DistFromTextRight=kl[OR].DistFromTextRight;bR.DistFromTextTop=kl[OR].DistFromTextTop;bR.DistFromTextBot=kl[OR].DistFromTextBot;bR.ZOrder=kl[OR].ZOrder;e.ParaFrameInfo=bR.copy();e.FrmFlags|=tc.PARA_FRAME_USED;a.flags1|=tc.RFLAG1_PASTING_IN_PARA_FRAME;a.IgnoreFrames=true}a.InitSect=G5(br);if(Nj(Qh&tc.TFLAG3_GET_BUF_HDR_FTR))to[a.InitSect].flags=cj(to[a.InitSect].flags,tc.SECT_HAS_TITLE_PAGE);Su=to[a.InitSect].IsPortrait;if(Nj(Qh&tc.TFLAG3_GET_BUF_HDR_FTR))Su=true;if(Dj(Qh&tc.TFLAG3_GET_BUF_HDR_FTR)||U2(a.InitSect)){a.flags|=tc.RFLAG_HDR_FTR_FOUND|tc.RFLAG_SECT_HDR_FOUND|tc.RFLAG_SECT_FTR_FOUND;a.flags1|=tc.RFLAG1_SECT_FHDR_FOUND|tc.RFLAG1_SECT_FFTR_FOUND;a.flags1|=tc.RFLAG1_SECT_RHDR_FOUND|tc.RFLAG1_SECT_RFTR_FOUND;a.flags1|=tc.RFLAG1_SECT_LHDR_FOUND|tc.RFLAG1_SECT_LFTR_FOUND;a.ExistingHdrFtr=true}_=ib(br,jt);l=Sm(br,jt);if(xs[_].FieldId==tc.FIELD_NAME&&l!=tc.LEFT_BRACE||xs[_].FieldId==tc.FIELD_DATA)a.InitFieldId=xs[_].FieldId;if(xs[_].FieldId!=tc.FIELD_TEXTBOX&&mh&&a.InitFieldId==0){A=fb(br,jt);if(xs[A].FieldId==tc.FIELD_TEXTBOX)_=A}if(a.InitFieldId==0&&xs[_].FieldId==tc.FIELD_TEXTBOX){var L=false;if(mh)L=true;else if(true||br>0||jt>0){A=fb(br,jt);if(xs[_].FieldId==tc.FIELD_TEXTBOX&&xs[A].FieldId==tc.FIELD_TEXTBOX)L=true}if(L){a.InitFieldId=tc.FIELD_TEXTBOX;if(xs[_].FieldCode!=null){a.FieldCode=xs[_].FieldCode;a.InitStyle=xs[_].style;a.InitAuxId=xs[_].AuxId}}}if(xs[_].FieldId==tc.FIELD_HLINK){A=fb(br,jt);if(xs[_].FieldId==xs[A].FieldId&&Cw(xs[_].FieldCode,xs[A].FieldCode)){a.InitFieldId=a.FieldId=xs[_].FieldId;if(xs[_].FieldCode!=null){a.FieldCode=xs[_].FieldCode}}}if(Z_){e.revised=true;e.InsRev=q_;e.InsTime=$_}if(TE&&Ri==1&&ui[0].len==1&&ui[0].txt[0]==tc.PARA_CHAR&&ui[0].pfmt==0)a.flags2|=tc.RFLAG2_UNDO_IN_EMPTY_FILE}nO=_j(nO,tc.TOFLAG2_TABLE_EMBEDDED);if(a.EmbedTable)nO|=tc.TOFLAG2_TABLE_EMBEDDED;Fo=br;break;case tc.RTF_END:ZU("RTF_END");a=r;if(Ri>0){var C=ui[Ri-1].pfmt;if(Nj(Nc[C].flags&tc.PAGE_HDR_FTR)){for(o=Ri-1;o>=0;o--){C=ui[o].pfmt;if(Dj(Nc[C].flags&tc.PAGE_HDR_FTR))break}iw(o+1,Ri-(o+1),"D")}}if(ah>=tc.RTF_CB&&Nj(fO&tc.TFLAG10_NO_LAST_PARA_MARKER)&&br>0){var I=br-1;var d=ui[I].len;if(d>0&&ui[I].txt[d-1]==tc.PARA_CHAR){var F=ib(I,d-1);var g;var P;jx(I,d-1);fw(I,d-1,1,tc.CHAR_D);ui[I].flags=_j(ui[I].flags,tc.LFLAG_PARA|tc.LFLAG_BREAK);for(g=I;g>=0;g--)if(Nj(ui[g].flags&(tc.LFLAG_PARA|tc.LFLAG_BREAK)))break;g++;if(Nj(fO&tc.TFLAG10_USE_LAST_PARA_PROPS))P=ui[I].pfmt;else{if(g<=a.FirstLine)P=a.FirstLineParaId;else P=ui[g].pfmt}for(o=g;o<Ri;o++){var S=Nj(ui[o].flags&(tc.LFLAG_PARA|tc.LFLAG_BREAK))||GY(o,tc.INFO_CELL);ui[o].pfmt=P;MZ(o,Nc[P].StyId);if(!S&&ui[o].len>0){var h=Sm(o,ui[o].len-1);S=h==Bn||h==TR}if(S){if(ui[o].len>0&&Nj(fO&tc.TFLAG10_USE_LAST_PARA_PROPS)){var O=nb(o);O[ui[o].len-1]=F}break}}}else if(br+1==Ri&&ui[br].len==1&&Dj(ui[I].flags&tc.LFLAG_PARA))ui[br].pfmt=ui[I].pfmt}for(n=0;n<iR;n++){if($E[n].InUse&&Nj(tR[n].flags&tc.TAUX_RTF_DEL))e1(a,n)}for(n=0;n<Kl;n++){if(kl[n].NextShapeId>0){var v=kl[n].NextShapeId;if(v==kl[n].ShapeId)kl[n].NextId=0;else{for(c=0;c<Kl;c++)if(kl[c].ShapeId==v)break;if(c<Kl){kl[n].NextId=c;kl[c].PrevId=n}else kl[n].NextId=0}}else kl[n].NextId=0}if(Nj(a.flags2&tc.RFLAG2_UNDO_IN_EMPTY_FILE)&&br+1==Ri&&br>0&&ui[br-1].len>0){iw(br,1,tc.CHAR_D);if(br>=Ri){br=Ri-1;jt=ui[br].len-1}}for(n=1;n<Vc;n++){for(c=1;c<Vc;c++)if(n!=c&&Kc[n].id==Kc[c].id)break;if(c<Vc){while(true){Kc[n].id++;for(c=1;c<Vc;c++)if(n!=c&&Kc[n].id==Kc[c].id)break;if(c==Vc)break}}}if((ah==tc.RTF_FILE||ah==tc.RTF_BUF)&&Ri>0){o=Ri-1;if(ui[o].len>0){n=ui[o].len-1;if(ui[o].txt[n]==tc.SECT_CHAR){fw(o,n,1,tc.CHAR_D);ui[o].flags=cj(ui[o].flags,tc.LFLAG_SECT);if(ro>1)a.sect=to[ro-1].copy();if(Nj(a.flags2&tc.RFLAG2_PAPER_DIM_FOUND)&&!a.sect.IsPortrait){T=a.sect.PprWidth;a.sect.PprWidth=a.sect.PprHeight;a.sect.PprHeight=T}}}}if(Ri==0){Ri=1;Ip(0)}if(!oi.WordWrap&&ah<tc.RTF_CB)q0(0,Ri-1);if(Nj(qh&tc.TFLAG4_HIDE_HIDDEN_PARA_MARK)&&ah<tc.RTF_CB)$0();if(ah>=tc.RTF_CB&&br<Ri&&br>0&&Dj(ui[br-1].flags&tc.LFLAG_PARA)&&ui[br-1].cid==ui[br].cid&&ui[br-1].fid==ui[br].fid){if(ui[br].len==1&&Nj(ui[br].flags&tc.LFLAG_PARA)&&Dj(nO&tc.TOFLAG2_FROM_CB))ui[br].pfmt=ui[br-1].pfmt}if(ah<tc.RTF_CB||Nj(Qh&tc.TFLAG3_GET_BUF_HDR_FTR)&&Dj(lO&tc.TFLAG11_NO_PASTE_PAPER_PROPS)){to[a.InitSect]=a.sect.copy();if(to[a.InitSect].PprWidth<0)to[a.InitSect].PprWidth=VV(12240);if(to[a.InitSect].PprHeight<0||to[a.InitSect].PprHeight>22)to[a.InitSect].PprHeight=VV(15840);if(to[a.InitSect].TopMargin<0||to[a.InitSect].TopMargin>22)to[a.InitSect].TopMargin=VV(360);if(to[a.InitSect].BotMargin<0||to[a.InitSect].BotMargin>22)to[a.InitSect].BotMargin=VV(360);if(to[a.InitSect].LeftMargin<0||to[a.InitSect].LeftMargin>22)to[a.InitSect].LeftMargin=VV(360);if(to[a.InitSect].RightMargin<0||to[a.InitSect].RightMargin>22)to[a.InitSect].RightMargin=VV(360);if(to[a.InitSect].TopMargin+to[a.InitSect].BotMargin>to[a.InitSect].PprHeight)to[a.InitSect].TopMargin=to[a.InitSect].BotMargin=VV(360);if(to[a.InitSect].LeftMargin+to[a.InitSect].RightMargin>to[a.InitSect].PprWidth)to[a.InitSect].LeftMargin=to[a.InitSect].RightMargin=VV(360);if(Nj(a.flags2&tc.RFLAG2_PAPER_DIM_FOUND)&&!to[a.InitSect].IsPortrait){T=to[a.InitSect].PprWidth;to[a.InitSect].PprWidth=to[a.InitSect].PprHeight;to[a.InitSect].PprHeight=T}}if(ro>1){for(n=0;n<ro;n++)if(Dj(to[n].flags&tc.SECT_HAS_FACING_PAGES))break;if(n<ro){for(n=0;n<ro;n++)to[n].flags=_j(to[n].flags,tc.SECT_HAS_FACING_PAGES)}}for(n=0;n<ro;n++){if(Dj(to[n].flags&tc.SECT_GUTTER_ADDED)){to[n].LeftMargin+=to[n].gutter;to[n].flags|=tc.SECT_GUTTER_ADDED}}if(!qW(true))_i.TerFixZOrder();if(ro>1)B5();b5();if(oi.PrintView)Z4(true);if(oi.PageMode&&a.InXml)w9();if(!TE&&!AE){for(n=0;n<iR;n++)tR[n].flags=cj(tR[n].flags,tc.TAUX_CALC_DONE);for(n=0;n<iR;n++){if(ah>=tc.RTF_CB&&Nj($E[n].flags&tc.ROWFLAG_PREEXIST))continue;if($E[n].InUse&&$E[n].PrevRow<0&&$E[n].TblIndType==3){var p;var N=$E[n].TblInd-$E[n].AddedIndent;for(p=n;p>0;p=$E[p].NextRow){var D=$E[p].PrevRow;if(D>0&&tR[p].TableInFrame!=tR[D].TableInFrame){$E[D].NextRow=-1;$E[p].PrevRow=-1;break}if(Nj(tR[p].flags&tc.TAUX_CALC_DONE))break;$E[p].indent=N;if($E[p].RowSpaceBefType==3)$E[p].indent+=$E[p].RowSpaceBef;if(oi.FittedView&&$E[p].indent<0)$E[p].indent=0;tR[n].flags|=tc.TAUX_CALC_DONE}}}}for(n=0;n<iR;n++)$E[n].AddedIndent=0;w2(a);if(ah==tc.RTF_FILE||ah==tc.RTF_BUF){if(!a.InXml)Qi=true;for(n=0;n<Ys;n++){if(xs[n].CharSet==tc.CHINESEBIG5_CHARSET||xs[n].CharSet==tc.GB2312_CHARSET||Tk(xs[n].TypeFace,"PMingLiU")==0||Tk(xs[n].TypeFace,"SimSun")==0){Qi=true;break}}if(Nj(lO&tc.TFLAG11_DONT_BALANCE_FAR_EAST_TEXT))qi=true;if(qi)Qi=false;Su=to[0].IsPortrait;br=we=jt=0;Fo=0;if(Kl==1)Mn=50;if(oi.PageMode){var M=Kl>500?2:30;var G=gS||Ri<tc.SMALL_FILE;if(Kl>500)G=false;if(!G)for(n=0;n<Ys;n++)if(xs[n].InUse&&xs[n].FieldId==tc.FIELD_TOC)G=true;if(!G)for(n=0;n<Dc;n++)if(xc[Nc[n].BltId].ls>0)G=true;if(Nj($h&tc.TFLAG5_FULL_REPAGINATE))G=true;if(G)yJ(false,false,0,true);else yJ(false,false,M,true);if(Nj(cO&tc.TOFLAG3_REPAGINATE))yJ(false,false,0,true);for(n=0;n<X_;n++){if(W_[n].OutlineLevel>0||Lk(W_[n].name.toLowerCase(),"heading"))break}if(n<X_)_i.TerUpdateDynField(false)}else if(oi.WordWrap)T9(0,Ri);if(oi.PageMode){for(n=1;n<Kl;n++){if(kl[n].InUse&&Dj(kl[n].flags&tc.PARA_FRAME_WRAP_IGNORE)){u=true;break}}}}else{if(br>=Ri)br=Ri-1;if(br<0)br=0;jt=0;if(FR&&!TE)_i.TerAdjustHtmlTable()}if((Nj(a.flags&tc.RFLAG_PARA_FRAME_FOUND)||Nj(a.flags1&tc.RFLAG1_NEW_HDR_FTR))&&!yR&&oi.PageMode&&Dj(Zh&tc.TFLAG2_NO_AUTO_HDR_FTR)&&!TE){var B=si;si=false;W5();si=B}if(ah==tc.RTF_FILE||ah==tc.RTF_BUF){if(u){_i.TerRepaginate(true)}if(yR&&oi.PageMode){var H=false;for(o=0;o<Ri;o++){if(Nj(Nc[ui[o].pfmt].flags&tc.PAGE_HDR)&&Dj(ui[o].flags&tc.LFLAG_HDRS)){if(!H)br=o;H=true;if(o>0&&Nj(ui[o-1].flags&tc.LFLAG_FHDR)){br=o;break}}if(Dj(Nc[ui[o].pfmt].flags&tc.PAGE_HDR_FTR))break}}oi.modified=0}if(ah<tc.RTF_CB&&Nj(fO&tc.TFLAG10_SHRINK_RTF_IMAGES)){_i.TerShrinkAllPictures(true);oi.modified=0}if(ah<tc.RTF_CB&&a.EnableTracking)_i.TerEnableTracking(true,"",true,0,tc.CLR_AUTO,0,tc.CLR_AUTO);YA=true;FN(true);_z(true);GR=false;ZU("RTF_END - exit");break;case tc.RTF_SECT:a=r;for(s=0;s<ro;s++)if(!to[s].InUse)break;if(s==ro){if(ro>=fo){D5(-1);if(ro>=fo)return QY(tc.MSG_SECTION_FULL,null)}ro++}to[s]=a.sect.copy();if(to[s].PprWidth<0)to[s].PprWidth=VV(12240);if(to[s].PprHeight<0||to[s].PprHeight>22)to[s].PprHeight=VV(15840);if(to[s].TopMargin<0||to[s].TopMargin>22)to[s].TopMargin=VV(360);if(to[s].BotMargin<0||to[s].BotMargin>22)to[s].BotMargin=VV(360);if(to[s].LeftMargin<0||to[s].LeftMargin>22)to[s].LeftMargin=VV(360);if(to[s].RightMargin<0||to[s].RightMargin>22)to[s].RightMargin=VV(360);if(to[s].TopMargin+to[s].BotMargin>to[s].PprHeight)to[s].TopMargin=to[s].BotMargin=VV(360);if(to[s].LeftMargin+to[s].RightMargin>to[s].PprWidth)to[s].LeftMargin=to[s].RightMargin=VV(360);if(Nj(a.flags2&tc.RFLAG2_PAPER_DIM_FOUND)&&!to[s].IsPortrait){T=to[s].PprWidth;to[s].PprWidth=to[s].PprHeight;to[s].PprHeight=T}if(Dj(to[s].flags&tc.SECT_HAS_FACING_PAGES))eo[s].lhdr.FirstLine=eo[s].lftr.FirstLine=-1;io=s;return i1(a.group[a.GroupLevel],a.OutBuf);case tc.RTF_TEXT:return i1(e,r);case tc.RTF_PICT:return l1(e,i);case tc.RTF_OBJECT:break;default:break}return true}function e1(t,e){var r=$E[e].PrevRow;var i=$E[e].FirstCell;if(r>0)$E[r].NextRow=-1;$E[e].InUse=false;while(i>0){eR[i].InUse=false;i=eR[i].NextCell}return true}function r1(t){var e,r,i,f,l;var a,n=false;var c=t.group;var s,_;var o=h2(t);var u=o.color;var T;var A;s=t.CurWord.toLowerCase();f=t.GroupLevel;c[f].IgnoreCount=0;if(s!="par"&&s!="line"&&s!="lbr"&&s!="cell"&&s!="nestcell"&&s!="tab"&&s!="tx"&&s!="u"&&!b1(t))return tc.RTF_END_FILE;a=true;if(s=="rtf"){if(t.PrevGroupBegin)P2(t,t.GroupLevel)}else if(s=="sstecf"||s=="sstern"||s=="sstej"||s=="ssteh"||s=="sste"){t.TeVersion=t.IntParam;zS=t.IntParam;if(ah<tc.RTF_CB&&t.TeVersion<19001)qi=true}else if(s=="info"){if(ah<tc.RTF_CB)A1(t);else y1(t)}else if(s=="userprops"){if(ah<tc.RTF_CB)E1(t);else y1(t)}else if(s=="revtbl"){if(ah<tc.RTF_CB)R1(t);else y1(t)}else if(s=="revised"){c[f].revised=true}else if(s=="deleted"){c[f].deleted=true}else if(s=="oldcprops"){if(f>0){c[f-1].FontChanged=true;c[f].gflags2|=tc.GFLAG2_IN_OLDCPROPS}}else if(s=="oldpprops"){if(f>0){c[f-1].ParaChanged=true;c[f].gflags2|=tc.GFLAG2_IN_OLDPPROPS}}else if(s=="revauth"||s=="crauth"||s=="prauth"||s=="revauthdel"){var E=t.IntParam;for(e=0;e<Al;e++)if(ul[e].RtfId==E)break;if(e<Al){if(s=="revauth")c[f].InsRev=e;else if(s=="crauth")c[f].FmtRev=e;else if(s=="prauth")c[f].ParaFmtRev=e;else c[f].DelRev=e}}else if(s=="revdttm"||s=="crdate"||s=="prdate"||s=="revdttmdel"){var R=t.IntParam;var L=Nk(R,5,6);var C=Nk(R,10,5);var I=Nk(R,15,5);var d=Nk(R,19,4);var F=Nk(R,28,9)+1900;var g=new tc.ClsDate;try{g.dt=new Date(F,d,I,C,L,0)}catch(t){g.dt=new Date}if(s=="revdttm")c[f].InsTime=g;else if(s=="crdate")c[f].FmtTime=g;else if(s=="prdate")c[f].ParaFmtTime=g;else c[f].DelTime=g}else if(s=="revisions"){if(ah<tc.RTF_CB)t.EnableTracking=true}else if(s=="atrfstart"&&(ah<tc.RTF_CB||TE)){s1(t)}else if(s=="atrfend"&&(ah<tc.RTF_CB||TE)){_1(t)}else if(s=="atnid"&&(ah<tc.RTF_CB||TE)){o1(t,tc.ANNOT_AUTH_ID)}else if(s=="atnauthor"&&(ah<tc.RTF_CB||TE)){o1(t,tc.ANNOT_AUTH_NAME)}else if(s=="annotation"&&(ah<tc.RTF_CB||TE)){o1(t,tc.ANNOT_TEXT)}else if(s=="deflang"){t.lang=t.IntParam;if(ah<tc.RTF_CB)MO=t.lang;c[f].lang=t.lang}else if(s=="lang"){if(t.IntParam!=1024){c[f].lang=t.IntParam;if(c[f].CharFlow!=tc.FLOW_DEF){if(xq(c[f].lang)){c[f].rtlch=true;c[f].CharFlow=tc.FLOW_RTL}else{c[f].rtlch=false;c[f].CharFlow=tc.FLOW_LTR}}c[f].CharMask|=tc.CMASK_LANG}}else if(s=="mac"){t.mac=true}else if(s=="viewkind"){if(ah<tc.RTF_CB)Re=t.IntParam}else if(s=="background"){if(ah<tc.RTF_CB)c[f].gflags|=tc.GFLAG_BACKGROUND;else y1(t)}else if(s=="formprot"){if(ah<tc.RTF_CB){mh=true;oi.ReadOnly=true}}else if(s=="readprot"||s=="annotprot"){if(ah<tc.RTF_CB)OS=true}else if(s=="jexpand"){if(ah<tc.RTF_CB)Mi=true}else if(s=="jcompress"){if(ah<tc.RTF_CB)Mi=false}else if(s=="nofeaturethrottle"){if(ah<tc.RTF_CB&&t.IntParam>0)Gi=true}else if(j0(s,"useltbaln")==0){if(ah<tc.RTF_CB&&t.IntParam>0)Hi=true}else if(s=="nouicompat"){if(ah<tc.RTF_CB&&t.IntParam>0)zi=true}else if(s=="noindnmbrts"){if(ah<tc.RTF_CB&&t.IntParam>0)Zi=true}else if(s=="dntblnsbdb"){if(ah<tc.RTF_CB&&t.IntParam>0)qi=true}else if(s=="expshrtn"){if(ah<tc.RTF_CB)$i=true}else if(s=="spltpgpar"){if(ah<tc.RTF_CB)ff=true}else if(s=="deftab"){if(ah<tc.RTF_CB)m_=t.IntParam}else if(s=="margl"){if(ah<tc.RTF_CB){if(t.IntParam<0)t.IntParam=360;to[0].LeftMargin=t.sect.LeftMargin=VV(t.IntParam);t.flags2|=tc.RFLAG2_LEFT_MARG_FOUND}}else if(s=="margr"){if(ah<tc.RTF_CB){if(t.IntParam<0)t.IntParam=360;to[0].RightMargin=t.sect.RightMargin=VV(t.IntParam)}}else if(s=="margt"){if(ah<tc.RTF_CB){if(t.IntParam<0){to[0].flags|=tc.SECT_EXACT_MARGT;t.sect.flags|=tc.SECT_EXACT_MARGT;t.IntParam=-t.IntParam}else{to[0].flags=cj(to[0].flags,tc.SECT_EXACT_MARGT);t.sect.flags=cj(t.sect.flags,tc.SECT_EXACT_MARGT)}to[0].TopMargin=t.sect.TopMargin=VV(t.IntParam)}}else if(s=="margb"){if(ah<tc.RTF_CB){if(t.IntParam<0){to[0].flags|=tc.SECT_EXACT_MARGB;t.sect.flags|=tc.SECT_EXACT_MARGB;t.IntParam=-t.IntParam}else{to[0].flags=cj(to[0].flags,tc.SECT_EXACT_MARGB);t.sect.flags=cj(t.sect.flags,tc.SECT_EXACT_MARGB)}to[0].BotMargin=t.sect.BotMargin=VV(t.IntParam)}}else if(s=="gutter"){if(ah<tc.RTF_CB)hu=VV(t.IntParam)}else if(s=="paperw"||s=="paperh"){if(s=="paperw")t.PaperWidth=t.IntParam;if(s=="paperh")t.PaperHeight=t.IntParam;if(t.PaperWidth<0)t.PaperWidth=12240;if(t.PaperHeight<0||t.PaperHeight>1440*22)t.PaperWidth=15840;P1(t);if(s=="paperw")t.sect.PprWidth=VV(t.IntParam);if(s=="paperh")t.sect.PprHeight=VV(t.IntParam);g1(t);t.flags2|=tc.RFLAG2_PAPER_DIM_FOUND}else if(false&&s=="psz"){var P=t.IntParam;for(e=0;e<tg.DefPaperCount;e++)if(tg.DefPaperSize[e]==P)break;if(e<tg.DefPaperCount){t.PaperWidth=tg.DefPaperWidth[e]*1440;t.PaperHeight=tg.DefPaperHeight[e]*1440;Pu=tg.DefPaperKind[e];t.sect.PprWidth=tg.DefPaperWidth[e];t.sect.PprHeight=tg.DefPaperHeight[e];t.sect.PprKind=tg.DefPaperKind[e];t.flags2=cj(t.flags2,tc.RFLAG2_PAPER_DIM_FOUND)}}else if(s=="landscape"){Su=t.sect.IsPortrait=false}else if(s=="htmautsp"){if(ah<tc.RTF_CB)Di=t.IntParam==0?false:true}else if(s=="ftnnar"){if(ah<tc.RTF_CB)wE=tc.NBR_DEC}else if(s=="ftnnalc"){if(ah<tc.RTF_CB)wE=tc.NBR_LWR_ALPHA}else if(s=="ftnnauc"){if(ah<tc.RTF_CB)wE=tc.NBR_UPR_ALPHA}else if(s=="ftnnrlc"){if(ah<tc.RTF_CB)wE=tc.NBR_LWR_ROMAN}else if(s=="ftnnruc"){if(ah<tc.RTF_CB)wE=tc.NBR_UPR_ROMAN}else if(s=="aftnnar"){if(ah<tc.RTF_CB)bE=tc.NBR_DEC}else if(s=="aftnnalc"){if(ah<tc.RTF_CB)bE=tc.NBR_LWR_ALPHA}else if(s=="aftnnauc"){if(ah<tc.RTF_CB)bE=tc.NBR_UPR_ALPHA}else if(s=="aftnnrlc"){if(ah<tc.RTF_CB)bE=tc.NBR_LWR_ROMAN}else if(s=="aftnnruc"){if(ah<tc.RTF_CB)bE=tc.NBR_UPR_ROMAN}else if(s=="aenddoc"){if(ah<tc.RTF_CB)BE=false}else if(s=="notabind"){if(ah<tc.RTF_CB)SS=true}else if(s=="ftnrestart"){if(ah<tc.RTF_CB)t.flags2|=tc.RFLAG2_RESTART_FNOTE_ON_SECT_BREAK}else if(s=="noultrlspc"){if(ah<tc.RTF_CB)nO|=tc.TOFLAG2_DONT_ULINE_TRAIL_SPC}else if(s=="rtldoc"){if(ah<tc.RTF_CB)mr=tc.FLOW_RTL;t.DocFlow=tc.FLOW_RTL}else if(s=="ltrdoc"){if(ah<tc.RTF_CB)mr=tc.FLOW_LTR;t.DocFlow=tc.FLOW_LTR}else if(s=="sectd"){if(Dj(c[f].InTable)&&Dj(BR)){t.sect=to[t.InitSect].copy();if((ah<tc.RTF_CB||Nj(Qh&tc.TFLAG3_GET_BUF_HDR_FTR))&&Nj(t.flags1&tc.RFLAG1_SECT_FACING_PAGES))t.sect.flags|=tc.SECT_HAS_FACING_PAGES;c[f].BorderType=0;t.sect.flags=cj(t.sect.flags,tc.SECT_VAR_COL_WIDTH);for(e=tc.BORDER_SECT_TOP;e<=tc.BORDER_SECT_RIGHT;e++){c[f].BorderWidth[e]=c[f].BorderSpace[e]=0;c[f].BorderColor[e]=tc.CLR_AUTO}if(t.PaperWidth>0&&t.PaperHeight>0){Su=true;t.sect.PprWidth=VV(t.PaperWidth);t.sect.PprHeight=VV(t.PaperHeight);t.sect.IsPortrait=Su;g1(t)}else if(!t.sect.IsPortrait){var S=t.sect.PprWidth;t.sect.PprWidth=t.sect.PprHeight;t.sect.PprHeight=S}t.SectFlow=tc.FLOW_DEF;t.sect.gutter=hu}}else if(s=="linemod"){t.sect.flags|=tc.SECT_LINE;t.sect.LineStep=t.IntParam}else if(s=="marglsxn"){if(t.IntParam<0)t.IntParam=720;t.sect.LeftMargin=VV(t.IntParam);t.flags2|=tc.RFLAG2_LEFT_MARG_FOUND}else if(s=="margrsxn"){if(t.IntParam<0)t.IntParam=720;t.sect.RightMargin=VV(t.IntParam)}else if(s=="margtsxn"){if(t.IntParam<0){t.IntParam=-t.IntParam;t.sect.flags|=tc.SECT_EXACT_MARGT}else t.sect.flags=cj(t.sect.flags,tc.SECT_EXACT_MARGT);t.sect.TopMargin=VV(t.IntParam)}else if(s=="margbsxn"){if(t.IntParam<0){t.IntParam=-t.IntParam;t.sect.flags|=tc.SECT_EXACT_MARGB}else t.sect.flags=cj(t.sect.flags,tc.SECT_EXACT_MARGB);t.sect.BotMargin=VV(t.IntParam)}else if(s=="guttersxn"){t.sect.gutter=VV(t.IntParam)}else if(s=="pgbrdrt"){c[f].BorderType=tc.BORDER_SECT_TOP}else if(s=="pgbrdrb"){c[f].BorderType=tc.BORDER_SECT_BOT}else if(s=="pgbrdrl"){c[f].BorderType=tc.BORDER_SECT_LEFT}else if(s=="pgbrdrr"){c[f].BorderType=tc.BORDER_SECT_RIGHT}else if(s=="pgbrdrhead"){t.sect.flags|=tc.SECT_BRDR_HEADER}else if(s=="pgbrdrfoot"){t.sect.flags|=tc.SECT_BRDR_FOOTER}else if(s=="pgbrdropt"){t.sect.BorderOpts=t.IntParam}else if(s=="headery"){if(t.IntParam<0)t.IntParam=720;t.sect.HdrMargin=VV(t.IntParam)}else if(s=="footery"){if(t.IntParam<0)t.IntParam=720;t.sect.FtrMargin=VV(t.IntParam)}else if(s=="sbknone"){t.sect.flags=cj(t.sect.flags,tc.SECT_NEW_PAGE)}else if(s=="sbkpage"){t.sect.flags|=tc.SECT_NEW_PAGE}else if(s=="sbkeven"){t.sect.flags|=tc.SECT_NEW_PAGE|tc.SECT_START_ON_EVEN_PAGE}else if(s=="sbkodd"){t.sect.flags|=tc.SECT_NEW_PAGE|tc.SECT_START_ON_ODD_PAGE}else if(s=="pgnstart"){t.sect.FirstPageNo=t.IntParam;t.sect.flags|=tc.SECT_RESTART_PAGE_NO}else if(s=="pgnstarts"){t.sect.FirstPageNo=t.IntParam}else if(s=="pgnrestart"){t.sect.flags|=tc.SECT_RESTART_PAGE_NO}else if(s=="sectunlocked"){if(t.IntParam==1)t.sect.flags|=tc.SECT_UNLOCKED;else t.sect.flags=cj(t.sect.flags,tc.SECT_UNLOCKED)}else if(s=="titlepg"){if(ah<tc.RTF_CB||Nj(Qh&tc.TFLAG3_GET_BUF_HDR_FTR))t.sect.flags|=tc.SECT_HAS_TITLE_PAGE}else if(s=="facingp"){if(ah<tc.RTF_CB||Nj(Qh&tc.TFLAG3_GET_BUF_HDR_FTR))t.sect.flags|=tc.SECT_HAS_FACING_PAGES;t.flags1|=tc.RFLAG1_SECT_FACING_PAGES}else if(s=="pgncont"){t.sect.FirstPageNo=0;t.sect.flags=cj(t.sect.flags,tc.SECT_RESTART_PAGE_NO)}else if(s=="vertal"){if(f==c[f].RtfGroup&&Dj(c[f].gflags&tc.GFLAG_IN_FRAME)){t.sect.flags=cj(t.sect.flags,tc.SECT_VALIGN_CTR|tc.SECT_VALIGN_BOT);t.sect.flags|=tc.SECT_VALIGN_BOT}}else if(s=="vertalc"){if(f==c[f].RtfGroup&&Dj(c[f].gflags&tc.GFLAG_IN_FRAME)){t.sect.flags=cj(t.sect.flags,tc.SECT_VALIGN_CTR|tc.SECT_VALIGN_BOT);t.sect.flags|=tc.SECT_VALIGN_CTR}}else if(s=="pgndec"){t.sect.PageNumFmt=tc.NBR_DEC}else if(s=="pgnucrm"){t.sect.PageNumFmt=tc.NBR_UPR_ROMAN}else if(s=="pgnlcrm"){t.sect.PageNumFmt=tc.NBR_LWR_ROMAN}else if(s=="pgnucltr"){t.sect.PageNumFmt=tc.NBR_UPR_ALPHA}else if(s=="pgnlcltr"){t.sect.PageNumFmt=tc.NBR_LWR_ALPHA}else if(s=="cols"){if(!oi.FittedView)t.sect.columns=t.IntParam}else if(s=="linebetcol"){t.sect.flags|=tc.SECT_LINE_BET_COL}else if(s=="colsx"){t.sect.ColumnSpace=VV(t.IntParam)}else if(s=="colno"){t.SectColNo=t.IntParam-1}else if(s=="colw"){if(f==c[f].RtfGroup&&t.SectColNo>=0){t.sect.ColWidth[t.SectColNo]=t.IntParam;t.sect.flags|=tc.SECT_VAR_COL_WIDTH}}else if(s=="colsr"){if(f==c[f].RtfGroup&&t.SectColNo>=0){t.sect.ColSpace[t.SectColNo]=t.IntParam;t.sect.flags|=tc.SECT_VAR_COL_WIDTH}}else if(s=="pgwsxn"||s=="pghsxn"){if(s=="pgwsxn")t.sect.PprWidth=VV(t.IntParam);if(s=="pghsxn")t.sect.PprHeight=VV(t.IntParam);g1(t);t.flags2|=tc.RFLAG2_PAPER_DIM_FOUND}else if(s=="lndscpsxn"){t.sect.IsPortrait=false}else if(s=="binfsxn"){t.sect.FirstPageBin=f3(t.IntParam)}else if(s=="binsxn"){t.sect.bin=f3(t.IntParam)}else if(s=="rtlsect"){t.sect.flow=tc.FLOW_RTL;t.SectFlow=tc.FLOW_RTL}else if(s=="ltrsect"){t.sect.flow=tc.FLOW_LTR;t.SectFlow=tc.FLOW_LTR}else if(s=="sectlinegrid"){t.sect.LineSpace=t.IntParam}else if(s=="sectspecifyl"){t.sect.flags|=tc.SECT_SNAP_LINE_GRID}else if(s=="sect"){if(Dj(c[f].InTable)&&Dj(BR)&&Dj(c[f].gflags&(tc.GFLAG_NEW_FRAME|tc.GFLAG_IN_FRAME))){if(t.OutBufLen>0)if(!b1(t))return tc.RTF_END_FILE;t.OutBuf=wY(tc.SECT_CHAR);t.OutBufLen=1;if(!b1(t))return tc.RTF_END_FILE;t.flags=cj(t.flags,tc.RFLAG_SECT_HDR_FOUND|tc.RFLAG_SECT_FTR_FOUND);t.flags1=cj(t.flags1,tc.RFLAG1_SECT_FHDR_FOUND|tc.RFLAG1_SECT_FFTR_FOUND);t.flags1=cj(t.flags1,tc.RFLAG1_SECT_RHDR_FOUND|tc.RFLAG1_SECT_RFTR_FOUND);t.flags1=cj(t.flags1,tc.RFLAG1_SECT_LHDR_FOUND|tc.RFLAG1_SECT_LFTR_FOUND);t.ExistingHdrFtr=false;if(Nj(t.flags2&tc.RFLAG2_RESTART_FNOTE_ON_SECT_BREAK))t.FootnoteNo=0}}else if(s=="header"){if(Nj(t.flags&tc.RFLAG_SECT_HDR_FOUND)&&!a1(t,tc.LFLAG_HDR)||Nj(t.flags1&tc.RFLAG1_PASTING_IN_PARA_FRAME)){y1(t);c[f].XmgFlags|=tc.XMGFLAG_SKIP_GROUP}else{if(t.OutBufLen>0)if(!b1(t))return tc.RTF_END_FILE;v1(t,c);f=t.GroupLevel;c[f].flags=c[f].flags|tc.PAGE_HDR;t.HdrFtrChar=tc.HDR_CHAR;t.OutBuf=wY(tc.HDR_CHAR);t.OutBufLen=1;if(!b1(t))return tc.RTF_END_FILE;BR=tc.PAGE_HDR;t.flags=cj(t.flags,tc.RFLAG_HDRFTR_TEXT_FOUND);t.flags|=tc.RFLAG_HDR_FTR_FOUND|tc.RFLAG_SECT_HDR_FOUND;t.flags1|=tc.RFLAG1_NEW_HDR_FTR;c[f].gflags2|=tc.GFLAG2_IN_HDR_FTR}}else if(s=="headerr"){if(Nj(t.flags1&tc.RFLAG1_SECT_RHDR_FOUND)&&!a1(t,tc.LFLAG_RHDR)||Nj(t.flags1&tc.RFLAG1_PASTING_IN_PARA_FRAME)){i=y1(t);c[f].XmgFlags|=tc.XMGFLAG_SKIP_GROUP}else{if(t.OutBufLen>0)if(!b1(t))return tc.RTF_END_FILE;v1(t,c);f=t.GroupLevel;c[f].flags=c[f].flags|tc.PAGE_HDR;t.HdrFtrChar=tc.RHDR_CHAR;t.OutBuf=wY(tc.RHDR_CHAR);t.OutBufLen=1;if(!b1(t))return tc.RTF_END_FILE;BR=tc.PAGE_HDR;t.flags=cj(t.flags,tc.RFLAG_HDRFTR_TEXT_FOUND);t.flags|=tc.RFLAG_HDR_FTR_FOUND;t.flags1|=tc.RFLAG1_SECT_RHDR_FOUND|tc.RFLAG1_NEW_HDR_FTR;c[f].gflags2|=tc.GFLAG2_IN_HDR_FTR}}else if(s=="headerl"){if(Nj(t.flags1&tc.RFLAG1_SECT_LHDR_FOUND)&&!a1(t,tc.LFLAG_LHDR)||Nj(t.flags1&tc.RFLAG1_PASTING_IN_PARA_FRAME)){i=y1(t);c[f].XmgFlags|=tc.XMGFLAG_SKIP_GROUP}else if(Dj(t.flags1&tc.RFLAG1_SECT_FACING_PAGES)&&!t.InXml)i=y1(t);else{if(t.OutBufLen>0)if(!b1(t))return tc.RTF_END_FILE;v1(t,c);f=t.GroupLevel;c[f].flags=c[f].flags|tc.PAGE_HDR;t.HdrFtrChar=tc.LHDR_CHAR;t.OutBuf=wY(tc.LHDR_CHAR);t.OutBufLen=1;if(!b1(t))return tc.RTF_END_FILE;BR=tc.PAGE_HDR;t.flags=cj(t.flags,tc.RFLAG_HDRFTR_TEXT_FOUND);t.flags|=tc.RFLAG_HDR_FTR_FOUND;t.flags1|=tc.RFLAG1_SECT_LHDR_FOUND|tc.RFLAG1_NEW_HDR_FTR;c[f].gflags2|=tc.GFLAG2_IN_HDR_FTR}}else if(s=="headerf"){if(Nj(t.flags1&tc.RFLAG1_SECT_FHDR_FOUND)&&!a1(t,tc.LFLAG_FHDR)||Nj(t.flags1&tc.RFLAG1_PASTING_IN_PARA_FRAME)){y1(t);c[f].XmgFlags|=tc.XMGFLAG_SKIP_GROUP}else{if(t.OutBufLen>0)if(!b1(t))return tc.RTF_END_FILE;v1(t,c);f=t.GroupLevel;c[f].flags=c[f].flags|tc.PAGE_HDR;t.HdrFtrChar=tc.FHDR_CHAR;t.OutBuf=wY(tc.FHDR_CHAR);t.OutBufLen=1;if(!b1(t))return tc.RTF_END_FILE;BR=tc.PAGE_HDR;t.flags=cj(t.flags,tc.RFLAG_HDRFTR_TEXT_FOUND);t.flags|=tc.RFLAG_HDR_FTR_FOUND;t.flags1|=tc.RFLAG1_SECT_FHDR_FOUND|tc.RFLAG1_NEW_HDR_FTR;c[f].gflags2|=tc.GFLAG2_IN_HDR_FTR}}else if(s=="footer"){if(Nj(t.flags&tc.RFLAG_SECT_FTR_FOUND)&&!a1(t,tc.LFLAG_FTR)||Nj(t.flags1&tc.RFLAG1_PASTING_IN_PARA_FRAME)){y1(t);c[f].XmgFlags|=tc.XMGFLAG_SKIP_GROUP}else{if(t.OutBufLen>0)if(!b1(t))return tc.RTF_END_FILE;v1(t,c);f=t.GroupLevel;c[f].flags=c[f].flags|tc.PAGE_FTR;t.HdrFtrChar=tc.FTR_CHAR;t.OutBuf=wY(tc.FTR_CHAR);t.OutBufLen=1;if(!b1(t))return tc.RTF_END_FILE;BR=tc.PAGE_FTR;t.flags=cj(t.flags,tc.RFLAG_HDRFTR_TEXT_FOUND);t.flags|=tc.RFLAG_HDR_FTR_FOUND|tc.RFLAG_SECT_FTR_FOUND;t.flags1|=tc.RFLAG1_NEW_HDR_FTR;c[f].gflags2|=tc.GFLAG2_IN_HDR_FTR}}else if(s=="footerr"){if(Nj(t.flags1&tc.RFLAG1_SECT_RFTR_FOUND)&&!a1(t,tc.LFLAG_RFTR)||Nj(t.flags1&tc.RFLAG1_PASTING_IN_PARA_FRAME)){y1(t);c[f].XmgFlags|=tc.XMGFLAG_SKIP_GROUP}else{if(t.OutBufLen>0)if(!b1(t))return tc.RTF_END_FILE;v1(t,c);f=t.GroupLevel;c[f].flags=c[f].flags|tc.PAGE_FTR;t.HdrFtrChar=tc.RFTR_CHAR;t.OutBuf=wY(tc.RFTR_CHAR);t.OutBufLen=1;if(!b1(t))return tc.RTF_END_FILE;BR=tc.PAGE_FTR;t.flags=cj(t.flags,tc.RFLAG_HDRFTR_TEXT_FOUND);t.flags|=tc.RFLAG_HDR_FTR_FOUND;t.flags1|=tc.RFLAG1_SECT_RFTR_FOUND|tc.RFLAG1_NEW_HDR_FTR;c[f].gflags2|=tc.GFLAG2_IN_HDR_FTR}}else if(s=="footerl"){if(Nj(t.flags1&tc.RFLAG1_SECT_LFTR_FOUND)&&!a1(t,tc.LFLAG_LFTR)||Nj(t.flags1&tc.RFLAG1_PASTING_IN_PARA_FRAME)){y1(t);c[f].XmgFlags|=tc.XMGFLAG_SKIP_GROUP}else if(s=="footerl"&&Dj(t.flags1&tc.RFLAG1_SECT_FACING_PAGES)&&!t.InXml)i=y1(t);else{if(t.OutBufLen>0)if(!b1(t))return tc.RTF_END_FILE;v1(t,c);f=t.GroupLevel;c[f].flags=c[f].flags|tc.PAGE_FTR;t.HdrFtrChar=tc.LFTR_CHAR;t.OutBuf=wY(tc.LFTR_CHAR);t.OutBufLen=1;if(!b1(t))return tc.RTF_END_FILE;BR=tc.PAGE_FTR;t.flags=cj(t.flags,tc.RFLAG_HDRFTR_TEXT_FOUND);t.flags|=tc.RFLAG_HDR_FTR_FOUND;t.flags1|=tc.RFLAG1_SECT_LFTR_FOUND|tc.RFLAG1_NEW_HDR_FTR;c[f].gflags2|=tc.GFLAG2_IN_HDR_FTR}}else if(s=="footerf"){if(Nj(t.flags1&tc.RFLAG1_SECT_FFTR_FOUND)&&!a1(t,tc.LFLAG_FFTR)||Nj(t.flags1&tc.RFLAG1_PASTING_IN_PARA_FRAME)){y1(t);c[f].XmgFlags|=tc.XMGFLAG_SKIP_GROUP}else{if(t.OutBufLen>0)if(!b1(t))return tc.RTF_END_FILE;v1(t,c);f=t.GroupLevel;c[f].flags=c[f].flags|tc.PAGE_FTR;t.HdrFtrChar=tc.FFTR_CHAR;t.OutBuf=wY(tc.FFTR_CHAR);t.OutBufLen=1;if(!b1(t))return tc.RTF_END_FILE;BR=tc.PAGE_FTR;t.flags=cj(t.flags,tc.RFLAG_HDRFTR_TEXT_FOUND);t.flags|=tc.RFLAG_HDR_FTR_FOUND;t.flags1|=tc.RFLAG1_NEW_HDR_FTR|tc.RFLAG1_SECT_FFTR_FOUND;c[f].gflags2|=tc.GFLAG2_IN_HDR_FTR}}else if(s=="uc"){c[f].UcIgnoreCount=t.IntParam}else if(s=="u"){if(t.IntParam==tc.OVR_RTLCH_CHAR||t.IntParam==tc.OVR_LTRCH_CHAR||t.IntParam==tc.LRE_CHAR||t.IntParam==tc.RLE_CHAR||t.IntParam==tc.LRM_CHAR||t.IntParam==tc.RLM_CHAR)tf=true;w1(t,f)}else if(s=="upr"){c[f].gflags2|=tc.GFLAG2_IN_UPR}else if(s=="ud"){c[f].gflags2|=tc.GFLAG2_IN_UD}else if(s=="fonttbl"){i=W1(t);if(i==tc.RTF_FILE_INCOMPLETE)return tc.RTF_FILE_INCOMPLETE;else if(i==tc.RTF_SYNTAX_ERROR)return tc.RTF_SYNTAX_ERROR}else if(s=="sscontainer"){t.InContainer=true;t.TopColorGroup=2}else if(s=="colortbl"){i=$1(t);if(i==tc.RTF_FILE_INCOMPLETE)return tc.RTF_FILE_INCOMPLETE;else if(i==tc.RTF_SYNTAX_ERROR)return tc.RTF_SYNTAX_ERROR}else if(s=="deff"){_=t.IntParam;if(_<0)_=0;c[f].DefFont=_}else if(s=="stylesheet"){if(Nj(c[f].gflags2&tc.GFLAG2_IN_UPR)&&Dj(c[f].gflags2&tc.GFLAG2_IN_UD))y1(t);else{c[f].gflags|=tc.GFLAG_IN_STYLESHEET;c[f].StyleMask=0;c[f].CharMask=0}}else if(s=="s"){if(t.IntParam<0)t.IntParam=0;if(Nj(c[f].gflags&tc.GFLAG_IN_STYLESHEET))c[f].ParaStyId=t.IntParam;else k2(t,t.IntParam,tc.SSTYPE_PARA,false)}else if(s=="cs"){if(Nj(c[f].gflags&tc.GFLAG_IN_STYLESHEET)){c[f].CharStyId=t.IntParam;c[f].gflags|=tc.GFLAG_CHAR_STYLE}else k2(t,t.IntParam,tc.SSTYPE_CHAR,false)}else if(s=="ts"){if(Nj(c[f].gflags&tc.GFLAG_IN_STYLESHEET)){c[f].gflags2|=tc.GFLAG2_UNSUPPORTED_STYLE;y1(t)}else t.CurTblStyle=t.IntParam}else if(s=="yts"){if(Nj(c[f].gflags&tc.GFLAG_IN_STYLESHEET)){c[f].gflags2|=tc.GFLAG2_UNSUPPORTED_STYLE;y1(t)}else{if(t.IntParam>=0&&t.IntParam<c[f].MaxRtfSID)c[f].RowColStyle=c[f].RtfSID[t.IntParam]}}else if(s=="contextualspace"){f=t.GroupLevel;c[f].flags|=tc.PARA_CONTEXTUAL_SPACE;c[f].ParaMask|=tc.PMASK_CONTEXTUAL_SPACE}else if(s=="snext"){if(Nj(c[f].gflags&tc.GFLAG_IN_STYLESHEET)){c[f].NextStyId=t.IntParam}}else if(s=="object"){i=n2(t);if(i==tc.RTF_FILE_INCOMPLETE)return tc.RTF_FILE_INCOMPLETE;else if(i==tc.RTF_SYNTAX_ERROR)return tc.RTF_SYNTAX_ERROR}else if(s=="shp"){t.ShpGroup=f;c[f].gflags|=tc.GFLAG_IN_SHP}else if(s=="shpgrp"){t.ShpGroup=f;c[f].gflags|=tc.GFLAG_IN_SHPGRP}else if(s=="shpinst"){var h=true;if(h){if(Nj(c[f].gflags&tc.GFLAG_IN_SHP))L2(t);else if(Nj(c[f].gflags&tc.GFLAG_IN_SHPGRP))E2(t)}}else if(s=="shprslt"){if(Nj(c[f].gflags&tc.GFLAG_IN_FRAME)&&Dj(c[f].gflags&tc.GFLAG_IN_SHP)&&Dj(c[f].gflags&tc.GFLAG_IN_SHPGRP)){if(Nj(t.flags&tc.RFLAG_READ_SHAPE_PICT))T2(t)}else if(Nj(c[f].gflags&tc.GFLAG_IN_SHPGRP))y1(t);else if(Dj(t.flags&tc.RFLAG_READ_SHAPE_PICT))y1(t);else if(false&&Nj(t.flags1&tc.RFLAG1_PNG_FOUND)){T2(t)}else{if(!c[f].InTable&&gR>0)gR=PR=hR=0;if(gR>0)y1(t);else c[f].gflags|=tc.GFLAG_IN_SHPRSLT}}else if(s=="shppict"){if(Nj(c[f].gflags&tc.GFLAG_IN_SHP)){}else t.flags|=tc.RFLAG_READ_SHAPE_PICT}else if(s=="nonshppict"){if(Dj(t.flags&tc.RFLAG_READ_SHAPE_PICT))y1(t)}else if(s=="sn"){var O;A2(t);O=Gf;if(Tk(O,"fillBlip")==0){if(f>0)c[f-1].shape.FrmFlags|=tc.PARA_FRAME_FILL_PICT;c[f].shape.FrmFlags|=tc.PARA_FRAME_FILL_PICT}}else if(s=="sv"){if(Nj(t.flags&tc.RFLAG_READ_SHAPE_PICT)){_2(t,"pict");if(Nj(c[f].shape.FrmFlags&tc.PARA_FRAME_FILL_PICT)&&c[f].shape.FillPict>0){if(OR>0){kl[OR].ShapeType=0;kl[OR].flags=cj(kl[OR].flags,tc.PARA_FRAME_BOXED);kl[OR].flags|=tc.PARA_FRAME_FILL_PICT;kl[OR].FillPict=c[f].shape.FillPict}}}else y1(t)}else if(s=="ssanimseq"){c[f].gflags|=tc.GFLAG_ANIM_SEQ}else if(s=="ssanimloops"){c[f].AnimLoops=t.IntParam;c[f].gflags|=tc.GFLAG_ANIM_INFO}else if(s=="ssanimdelay"){c[f].AnimDelay=t.IntParam;c[f].gflags|=tc.GFLAG_ANIM_INFO}else if(s=="pict"||s=="sscontrol"){i=v2(t,0,0,1,tc.CLR_WHITE);if(i==tc.RTF_FILE_INCOMPLETE)return tc.RTF_FILE_INCOMPLETE;else if(i==tc.RTF_SYNTAX_ERROR)return tc.RTF_SYNTAX_ERROR}else if(s=="sslinkpictw"){c[f].LinkPictWidth=t.IntParam}else if(s=="sslinkpicth"){c[f].LinkPictHeight=t.IntParam}else if(s=="subpictid"){if(t.OutBufLen>0)if(!b1(t))return tc.RTF_END_FILE;f=t.GroupLevel;c[f].PictId=t.IntParam;t.OutBuf=wY(tc.HYPH);t.OutBufLen=1;if(!b1(t))return tc.RTF_END_FILE;c[f].PictId=0}else if(s=="tc"){c[f].FieldId=tc.FIELD_TC;t.FieldCode=null;if(Dj(eO&tc.TFLAG7_HIDE_TC_FIELD))c[f].style=cj(c[f].style,tc.HIDDEN)}else if(s=="tcl"){if(c[f].FieldId==tc.FIELD_TC){t.FieldCode="\\tcl"+mY(t.IntParam);if(Dj(eO&tc.TFLAG7_HIDE_TC_FIELD)){for(e=f;e>=0&&c[e].FieldId==tc.FIELD_TC;e--)c[e].style=cj(c[e].style,tc.HIDDEN)}}}else if(s=="xe"){if(t.InitFieldId==0&&Dj(c[f].gflags&tc.GFLAG_IN_FIELD)){if(t.PrevField==tc.FIELD_XE){t.OutBuf+=tc.SPACE;t.OutBufLen++;if(!b1(t))return tc.RTF_END_FILE}c[f].FieldId=tc.FIELD_XE;t.FieldCode="";t.FieldName=""}}else if(s=="plain"){h1(t,c)}else if(s=="loch"){c[f].CharType=tc.CHAR_LO}else if(s=="hich"){c[f].CharType=tc.CHAR_HI}else if(s=="dbch"){c[f].CharType=tc.CHAR_DB}else if(s=="fcs"){c[f].SaRun=Nj(t.IntParam)}else if(s=="cchs"){c[f].CharSet=t.IntParam;if(c[f].CharSet>255)c[f].CharSet=77;c[f].CharSetDB=c[f].CharSet;c[f].CharSetHi=c[f].CharSet}else if(s=="rtlch"){if(!c[f].rtlch){c[f].LtrchStyle=c[f].style&(tc.BOLD|tc.ITALIC|tc.ULINE);c[f].LtrchStyleOff=c[f].StyleOff&(tc.BOLD|tc.ITALIC|tc.ULINE);c[f].LtrchStyleMask=c[f].StyleMask&(tc.BOLD|tc.ITALIC|tc.ULINE)}c[f].rtlch=true;c[f].CharFlow=tc.FLOW_RTL;if(c[f].CharType==tc.CHAR_DB)c[f].CharType=tc.CHAR_LO;HR=true}else if(s=="ltrch"){if(c[f].rtlch){c[f].style=cj(c[f].style,tc.BOLD|tc.ITALIC|tc.ULINE);c[f].StyleOff=cj(c[f].StyleOff,tc.BOLD|tc.ITALIC|tc.ULINE);c[f].StyleMask=cj(c[f].StyleMask,tc.BOLD|tc.ITALIC|tc.ULINE);if(c[f].LtrchStyle!=0){c[f].style|=c[f].LtrchStyle;c[f].StyleOff|=c[f].LtrchStyleOff;c[f].StyleMask|=c[f].LtrchStyleMask;c[f].LtrchStyle=0;c[f].LtrchStyleOff=0;c[f].LtrchStyleMask=0}}if(c[f].rtlch&&c[f].LtrchPointSize2!=0){c[f].PointSize2=c[f].LtrchPointSize2}c[f].rtlch=false;c[f].CharFlow=tc.FLOW_LTR;HR=true}else if(s=="f"||s=="af"){var v;_=t.IntParam;var p=true;o=h2(t);f=t.GroupLevel;if(_>=0&&_<tc.MAX_RTF_SEQ_FONTS)v=_;else for(v=tc.MAX_RTF_SEQ_FONTS;v<o.MaxRtfFonts;v++){if(o.font[v].InUse&&o.font[v].FontId==_)break}if(v<o.MaxRtfFonts){if(o.font[v].IsHiThemeFont&&c[f].CharType==tc.CHAR_DB)c[f].CharType=tc.CHAR_HI;if(c[f].rtlch){c[f].TypeFaceCs=o.font[v].name;c[f].FontFamilyCs=o.font[v].family;c[f].CharSetCs=o.font[v].CharSet}if(c[f].CharType==tc.CHAR_DB){c[f].TypeFaceDB=o.font[v].name;c[f].FontFamilyDB=o.font[v].family;c[f].CharSetDB=o.font[v].CharSet;if(s=="f"){c[f].TypeFace=o.font[v].name;c[f].FontFamily=o.font[v].family;c[f].CharSet=o.font[v].CharSet}}else if(!c[f].rtlch&&c[f].CharType==tc.CHAR_LO){c[f].TypeFace=o.font[v].name;c[f].FontFamily=o.font[v].family;c[f].CharSet=o.font[v].CharSet;var N=c[f].CharSet;var D=N==tc.GB2312_CHARSET||N==tc.CHINESEBIG5_CHARSET||N==tc.SHIFTJIS_CHARSET;if(D&&!yq(c[f].lang))c[f].CharSet=tc.ANSI_CHARSET}else if(c[f].CharType==tc.CHAR_HI){c[f].TypeFaceHi=o.font[v].name;c[f].FontFamilyHi=o.font[v].family;c[f].CharSetHi=o.font[v].CharSet;if(s=="f"){c[f].TypeFace=o.font[v].name;c[f].FontFamily=o.font[v].family;c[f].CharSet=o.font[v].CharSet}}else if(s=="f"){c[f].TypeFace=o.font[v].name;c[f].FontFamily=o.font[v].family;c[f].CharSet=o.font[v].CharSet;if(!c[f].rtlch){c[f].TypeFaceHi=o.font[v].name;c[f].FontFamilyHi=o.font[v].family;c[f].CharSetHi=o.font[v].CharSet;c[f].TypeFaceDB=o.font[v].name;c[f].FontFamilyDB=o.font[v].family;c[f].CharSetDB=o.font[v].CharSet}c[f].TypeFaceCs=o.font[v].name;c[f].FontFamilyCs=o.font[v].family;c[f].CharSetCs=o.font[v].CharSet}p=s=="f";if(c[f].CharType==tc.CHAR_DB||c[f].SaRun){c[f].CharMask|=tc.CMASK_FONT_DB;p=false}if(c[f].rtlch){c[f].CharMask|=tc.CMASK_FONT_RTL;p=false}if(p)c[f].CharMask|=tc.CMASK_FONT_LATIN}}else if(s=="fs"){f=t.GroupLevel;c[f].PointSize2=t.IntParam;c[f].CharMask|=tc.CMASK_SIZE}else if(s=="sscharaux"){f=t.GroupLevel;if(!Li&&c[f].FieldId!=tc.FIELD_TEXTBOX)c[f].AuxId=t.IntParam}else if(s=="cf"){o=h2(t);u=o.color;f=t.GroupLevel;if(t.param.length==0)t.IntParam=0;if(t.IntParam>=o.TotalRtfColors)t.IntParam=0;if(t.IntParam>=0&&t.IntParam<o.TotalRtfColors){c[f].TextColor=u[t.IntParam].color;if(Nj(c[f].flags&(tc.GFLAG_IN_LIST|tc.GFLAG_IN_LIST_OR))&&MJ(c[f].TextColor,tc.CLR_AUTO))c[f].TextColor=tc.CLR_BLACK;c[f].CharMask|=tc.CMASK_TEXT_COLOR;c[f].TextColorUsesThemeColor=u[t.IntParam].UsesThemeColor}}else if(s=="ulc"){o=h2(t);u=o.color;f=t.GroupLevel;if(t.param.length==0)t.IntParam=0;if(t.IntParam>=0&&t.IntParam<o.TotalRtfColors)c[f].UlineColor=u[t.IntParam].color}else if(s=="chbghoriz"||s=="chbgvert"||s=="chbgfdiag"||s=="chbgbdiag"||s=="chbgcross"||s=="chbgdcross"||s=="chbgdkhoriz"||s=="chbgdkvert"||s=="chbgdkfdiag"||s=="chbgdkbdiag"||s=="chbgdkcross"||s=="chbgdkdcross"){c[f].CharBkPat=tc.PAT_OTHER}else if(s=="chcfpat"||s=="chcbpat"){o=h2(t);u=o.color;f=t.GroupLevel;if(t.param.length==0)t.IntParam=0;if(t.IntParam>=0&&t.IntParam<o.TotalRtfColors){if(s=="chcfpat")c[f].CharPatFC=u[t.IntParam].color;else if(Dj(lO&tc.TFLAG11_NO_CHAR_BKND)){if(t.IntParam==0&&u[0].color==tc.CLR_AUTO)c[f].CharPatBC=tc.CLR_WHITE;else c[f].CharPatBC=u[t.IntParam].color;if(Nj(c[f].flags&(tc.GFLAG_IN_LIST|tc.GFLAG_IN_LIST_OR)))c[f].CharPatBC=tc.CLR_WHITE}}}else if(s=="cb"){o=h2(t);u=o.color;f=t.GroupLevel;if(t.param.length==0)t.IntParam=0;if(t.IntParam==0)c[f].TextBkColor=jT;else if(t.IntParam>=0&&t.IntParam<o.TotalRtfColors)c[f].TextBkColor=u[t.IntParam].color;c[f].CharMask|=tc.CMASK_TEXT_BK_COLOR}else if(s=="highlight"){o=h2(t);u=o.color;f=t.GroupLevel;if(t.param.length==0)t.IntParam=0;if(t.IntParam==0)c[f].HilightColor=tc.CLR_WHITE;else if(t.IntParam>=0&&t.IntParam<o.TotalRtfColors)c[f].HilightColor=u[t.IntParam].color;c[f].HilightColor=c1(t,c[f].HilightColor);c[f].CharMask|=tc.CMASK_HILIGHT_COLOR}else if(s=="b"){f=t.GroupLevel;if(Nj(Nj(t.IntParam)))c[f].style=c[f].style|tc.BOLD;else{c[f].style=c[f].style&~tc.BOLD;c[f].StyleOff|=tc.BOLD}c[f].StyleMask|=tc.BOLD}else if(s=="sshlink"){f=t.GroupLevel;if(Nj(Nj(t.IntParam)))c[f].style=c[f].style|tc.HLINK;else c[f].style=c[f].style&~tc.HLINK}else if(s=="i"){f=t.GroupLevel;if(Nj(t.IntParam))c[f].style=c[f].style|tc.ITALIC;else{c[f].style=c[f].style&~tc.ITALIC;c[f].StyleOff|=tc.ITALIC}c[f].StyleMask|=tc.ITALIC}else if(s=="v"){f=t.GroupLevel;if(Nj(t.IntParam)&&c[f].FieldId==tc.FIELD_TC){for(e=f;e>=0&&c[e].FieldId==tc.FIELD_TC;e--)c[e].style|=tc.HIDDEN}else{if(Nj(t.IntParam))c[f].style=c[f].style|tc.HIDDEN;else c[f].style=c[f].style&~tc.HIDDEN}c[f].StyleMask|=tc.HIDDEN}else if(s=="dn"){f=t.GroupLevel;if(t.param=="0")c[f].offset=0;else{if(t.IntParam==0)t.IntParam=6;c[f].offset=-ej(t.IntParam)/2}c[f].CharMask|=tc.CMASK_OFFSET}else if(s=="sub"){f=t.GroupLevel;c[f].style=cj(c[f].style,tc.SUPSCR);c[f].style=c[f].style|tc.SUBSCR;c[f].StyleMask|=tc.SUBSCR}else if(s=="nosupersub"){c[f].style=cj(c[f].style,tc.SUBSCR|tc.SUPSCR);c[f].StyleMask|=tc.SUBSCR|tc.SUPSCR}else if(s=="strike"){f=t.GroupLevel;if(Nj(t.IntParam))c[f].style=c[f].style|tc.STRIKE;else{c[f].style=c[f].style&~tc.STRIKE;c[f].StyleOff|=tc.STRIKE}c[f].StyleMask|=tc.STRIKE}else if(s=="striked"){f=t.GroupLevel;if(Nj(t.IntParam))c[f].style=c[f].style|tc.DOUBLE_STRIKE;else{c[f].style=c[f].style&~tc.DOUBLE_STRIKE;c[f].StyleOff|=tc.DOUBLE_STRIKE}c[f].StyleMask|=tc.DOUBLE_STRIKE}else if(s=="protect"){f=t.GroupLevel;if(Nj(t.IntParam))c[f].style=c[f].style|tc.PROTECT;else{c[f].style=c[f].style&~tc.PROTECT;c[f].StyleOff|=tc.PROTECT}c[f].StyleMask|=tc.PROTECT}else if(s=="ul"||s=="ulw"){f=t.GroupLevel;if(Nj(t.IntParam))c[f].style=c[f].style|tc.ULINE;else{c[f].style=c[f].style&~tc.ULINE;c[f].StyleOff|=tc.ULINE}c[f].StyleMask|=tc.ULINE}else if(s=="uld"||s=="ulthd"){f=t.GroupLevel;if(Nj(t.IntParam))c[f].style=c[f].style|tc.ULINE_DOTTED;else{c[f].style=c[f].style&~tc.ULINE_DOTTED;c[f].StyleOff|=tc.ULINE_DOTTED}c[f].StyleMask|=tc.ULINE_DOTTED}else if(s=="uldb"){f=t.GroupLevel;if(Nj(t.IntParam))c[f].style=c[f].style|tc.ULINED;else{c[f].style=c[f].style&~tc.ULINED;c[f].StyleOff|=tc.ULINED}c[f].StyleMask|=tc.ULINED}else if(s=="embo"){f=t.GroupLevel;if(Nj(t.IntParam))c[f].style=c[f].style|tc.EMBOSS;else{c[f].style=c[f].style&~tc.EMBOSS;c[f].StyleOff|=tc.EMBOSS}c[f].StyleMask|=tc.EMBOSS}else if(s=="ulnone"){f=t.GroupLevel;c[f].style=c[f].style&~(tc.ULINE|tc.ULINED);c[f].StyleOff|=tc.ULINE|tc.ULINED;c[f].StyleMask|=tc.ULINE|tc.ULINED}else if(s=="expnd"){c[f].expand=t.IntParam*20/4;c[f].CharMask|=tc.CMASK_EXPAND}else if(s=="expndtw"){c[f].expand=t.IntParam;c[f].CharMask|=tc.CMASK_EXPAND}else if(s=="charscalex"){if(t.IntParam>=1&&t.IntParam<=600){c[f].CharScaleX=t.IntParam-100;c[f].CharMask|=tc.CMASK_SCALE_X}}else if(s=="up"){f=t.GroupLevel;if(t.param=="0")c[f].offset=0;else{if(t.IntParam==0)t.IntParam=6;c[f].offset=ej(t.IntParam)/2}c[f].CharMask|=tc.CMASK_OFFSET}else if(s=="super"){f=t.GroupLevel;c[f].style=cj(c[f].style,tc.SUBSCR);c[f].style=c[f].style|tc.SUPSCR;c[f].StyleMask|=tc.SUPSCR}else if(s=="scaps"||s=="caps"){f=t.GroupLevel;var M=s=="scaps"?tc.SCAPS:tc.CAPS;if(Nj(t.IntParam))c[f].style=c[f].style|M;else{c[f].style=c[f].style&~M;c[f].StyleOff|=M}c[f].StyleMask|=M}else if(s=="ssleftline"){f=t.GroupLevel;if(Nj(t.IntParam))c[f].style=c[f].style|tc.LEFT_LINE;else{c[f].style=c[f].style&~tc.LEFT_LINE;c[f].StyleOff|=tc.LEFT_LINE}c[f].StyleMask|=tc.LEFT_LINE}else if(s=="tab"||s=="pmartabql"||s=="pmartabqc"||s=="pmartabqr"||s=="pindtabql"||s=="pindtabqc"||s=="pindtabqr"){t.OutBuf+=wY(9);t.OutBufLen++}else if(s=="chpgn"){if(t.OutBufLen>0)if(!b1(t))return tc.RTF_FILE_INCOMPLETE;t.OutBuf="1";t.OutBufLen=1;t.group[f].FieldId=tc.FIELD_PAGE_NUMBER;if(!b1(t))return tc.RTF_FILE_INCOMPLETE;t.group[f].FieldId=0}else if(s=="page"){n=Nj(c[f].style&tc.FNOTEALL);if(t.InitialCell==0&&br>0&&!n&&Dj(c[f].gflags&tc.GFLAG_IN_NESTTABLEPROPS)&&c[f].InTable){var G=ui[br-1].cid;if(G>0&&eR[G].level==0&&GY(br-1,tc.INFO_ROW)){v1(t,c);t.InTableDef=false}}if(Dj(c[f].InTable)&&Dj(BR)&&Dj(c[f].gflags&tc.GFLAG_IN_SHP)){t.OutBuf+=wY(tc.PAGE_CHAR);t.OutBufLen++;if(!b1(t))return tc.RTF_END_FILE}}else if(s=="column"){if(Dj(c[f].InTable)){t.OutBuf+=wY(tc.COL_CHAR);t.OutBufLen++}}else if(s=="zwnj"){t.OutBuf+=wY(tc.ZWNJ_CHAR);t.OutBufLen++;if(!b1(t))return tc.RTF_END_FILE}else if(s=="par"||s=="line"||s=="lbr"){if(s=="par")t.OutBuf+=wY(Bn);else{t.OutBuf+=wY(tc.LINE_CHAR);if(s=="lbr")c[f].CharId=t.IntParam}t.OutBufLen++;if(!b1(t))return tc.RTF_END_FILE;c[f].CharId=0}else if(s=="defpap"){c[f].gflags2|=tc.GFLAG2_IN_DOC_PARA_PROPS}else if(s=="pard"){v1(t,c);t.InTableDef=false}else if(s=="ql"){f=t.GroupLevel;c[f].flags=c[f].flags&~(tc.CENTER|tc.RIGHT_JUSTIFY|tc.JUSTIFY);c[f].flags=c[f].flags|tc.LEFT;c[f].ParaMask|=tc.PMASK_ALIGN}else if(s=="qr"){f=t.GroupLevel;c[f].flags=c[f].flags&~(tc.LEFT|tc.CENTER|tc.JUSTIFY);c[f].flags=c[f].flags|tc.RIGHT_JUSTIFY;c[f].ParaMask|=tc.PMASK_ALIGN}else if(s=="qc"){f=t.GroupLevel;c[f].flags=c[f].flags&~(tc.LEFT|tc.RIGHT_JUSTIFY|tc.JUSTIFY);c[f].flags=c[f].flags|tc.CENTER;c[f].ParaMask|=tc.PMASK_ALIGN}else if(s=="rtlpar"){c[f].flow=tc.FLOW_RTL;c[f].flags=c[f].flags&~(tc.LEFT|tc.CENTER|tc.JUSTIFY);c[f].flags=c[f].flags|tc.RIGHT_JUSTIFY;c[f].ParaMask|=tc.PMASK_FLOW|tc.PMASK_ALIGN}else if(s=="ltrpar"){c[f].flow=tc.FLOW_LTR;c[f].ParaMask|=tc.PMASK_FLOW|tc.PMASK_ALIGN}else if(s=="qj"||s=="qk"||s=="qd"){f=t.GroupLevel;c[f].flags=c[f].flags&~(tc.LEFT|tc.RIGHT_JUSTIFY|tc.CENTER);c[f].flags=c[f].flags|tc.JUSTIFY;if(j0(s,"qd")==0)c[f].flags=c[f].flags|tc.JUSTIFY_DIST;c[f].ParaMask|=tc.PMASK_ALIGN}else if(s=="fi"){f=t.GroupLevel;c[f].FirstIndent=t.IntParam;c[f].ParaMask|=tc.PMASK_INDENT_FIRST}else if(s=="li"){f=t.GroupLevel;c[f].LeftIndent=c[f].LeftIndentFlow=t.IntParam;c[f].ParaMask|=tc.PMASK_INDENT_LEFT}else if(s=="ri"){f=t.GroupLevel;c[f].RightIndent=c[f].RightIndentFlow=t.IntParam;if(c[f].RightIndent>32e3)c[f].RightIndent=c[f].RightIndentFlow=0;c[f].ParaMask|=tc.PMASK_INDENT_RIGHT}else if(s=="lin"){f=t.GroupLevel;c[f].LeftIndentFlow=t.IntParam;c[f].ParaMask|=tc.PMASK_INDENT_LEFT}else if(s=="rin"){f=t.GroupLevel;c[f].RightIndentFlow=t.IntParam;c[f].ParaMask|=tc.PMASK_INDENT_RIGHT}else if(s=="sb"){f=t.GroupLevel;c[f].SpaceBefore=t.IntParam;c[f].ParaMask|=tc.PMASK_SPACING|tc.PMASK_SPACING_BEF}else if(s=="sbauto"){f=t.GroupLevel;if(Di&&t.IntParam==1){c[f].SpaceBefore=0;c[f].flags|=tc.AUTO_SPACE_BEFORE;c[f].ParaMask|=tc.PMASK_SPACING}}else if(s=="sa"){f=t.GroupLevel;c[f].SpaceAfter=t.IntParam;c[f].ParaMask|=tc.PMASK_SPACING|tc.PMASK_SPACING_AFT}else if(s=="saauto"){f=t.GroupLevel;if(Di&&t.IntParam==1){c[f].SpaceAfter=0;c[f].flags|=tc.AUTO_SPACE_AFTER;c[f].ParaMask|=tc.PMASK_SPACING}}else if(s=="sl"){c[f].flags=cj(c[f].flags,tc.DOUBLE_SPACE);c[f].SpaceBetween=t.IntParam;if(Nj(lO&tc.TFLAG11_NO_EXACT_LINE_SPACING))c[f].SpaceBetween=Math.abs(c[f].SpaceBetween);if(c[f].SpaceBetween==1)c[f].SpaceBetween=0;c[f].ParaMask|=tc.PMASK_SPACING|tc.PMASK_SPACING_BET}else if(s=="slmult"){f=t.GroupLevel;if(t.IntParam==1){if(c[f].SpaceBetween==480){c[f].flags|=tc.DOUBLE_SPACE;c[f].LineSpacing=0}else if(c[f].SpaceBetween>0){c[f].LineSpacing=Mj(c[f].SpaceBetween-240,100,240);c[f].flags=cj(c[f].flags,tc.DOUBLE_SPACE)}c[f].SpaceBetween=0}c[f].ParaMask|=tc.PMASK_SPACING|tc.PMASK_SPACING_LINE}else if(s=="facenter"){f=t.GroupLevel;c[f].TextVAlign=tc.TEXT_VALIGN_CENTER;c[f].ParaMask|=tc.PMASK_TEXT_VALIGN}else if(s=="fahang"){f=t.GroupLevel;c[f].TextVAlign=tc.TEXT_VALIGN_TOP;c[f].ParaMask|=tc.PMASK_TEXT_VALIGN}else if(s=="favar"){f=t.GroupLevel;c[f].TextVAlign=tc.TEXT_VALIGN_BOT;c[f].ParaMask|=tc.PMASK_TEXT_VALIGN}else if(s=="faroman"){f=t.GroupLevel;c[f].TextVAlign=tc.TEXT_VALIGN_BASE;c[f].ParaMask|=tc.PMASK_TEXT_VALIGN}else if(s=="keep"){f=t.GroupLevel;c[f].flags|=tc.PARA_KEEP;c[f].ParaMask|=tc.PMASK_KEEP}else if(s=="keepn"){f=t.GroupLevel;c[f].flags|=tc.PARA_KEEP_NEXT;c[f].ParaMask|=tc.PMASK_KEEP_NEXT}else if(s=="widowctrl"){t.SetWidowOrphan=true;c[f].pflags|=tc.PFLAG_WIDOW;c[f].ParaMask|=tc.PMASK_WIDOW}else if(s=="nosnaplinegrid"){c[f].pflags|=tc.PFLAG_NO_SNAP_TO_GRID;c[f].ParaMask|=tc.PMASK_NO_SNAP_TO_GRID}else if(s=="widctlpar"){c[f].pflags|=tc.PFLAG_WIDOW;c[f].ParaMask|=tc.PMASK_WIDOW}else if(s=="ssparnw"){c[f].pflags|=tc.PFLAG_NO_WRAP}else if(s=="ssparaaux"){c[f].ParaAuxId=t.IntParam}else if(s=="nowidctlpar"){c[f].pflags=cj(c[f].pflags,tc.PFLAG_WIDOW);c[f].ParaMask|=tc.PMASK_WIDOW}else if(s=="pagebb"){c[f].pflags|=tc.PFLAG_PAGE_BREAK;c[f].ParaMask|=tc.PMASK_PAGE_BREAK}else if(s=="outlinelevel"){c[f].OutlineLevel=t.IntParam;c[f].ParaMask|=tc.PMASK_OLVL}else if(s=="pn"){i=W2(t);if(i==tc.RTF_FILE_INCOMPLETE)return tc.RTF_FILE_INCOMPLETE;else if(i==tc.RTF_SYNTAX_ERROR)return tc.RTF_SYNTAX_ERROR;c[f].ParaMask|=tc.PMASK_BULLET}else if(s=="listtable"){c[f].flags|=tc.GFLAG_IN_LIST;i=J2(t);if(i==tc.RTF_FILE_INCOMPLETE)return tc.RTF_FILE_INCOMPLETE;else if(i==tc.RTF_SYNTAX_ERROR)return tc.RTF_SYNTAX_ERROR}else if(s=="listoverridetable"){c[f].flags|=tc.GFLAG_IN_LIST_OR;i=Z2(t);if(i==tc.RTF_FILE_INCOMPLETE)return tc.RTF_FILE_INCOMPLETE;else if(i==tc.RTF_SYNTAX_ERROR)return tc.RTF_SYNTAX_ERROR;t.ListRead=true;j2(t)}else if(s=="ls"){if(t.IntParam<=0&&Dj(c[f].flags&tc.GFLAG_IN_LIST_OR)){c[f].RtfLs=0;c[f].ListLvl=0;c[f].flags=cj(c[f].flags,tc.BULLET);c[f].ParaMask=cj(c[f].ParaMask,tc.PMASK_LS)}else{c[f].RtfLs=t.IntParam;c[f].ParaMask|=tc.PMASK_LS}}else if(s=="ilvl"){c[f].ListLvl=t.IntParam;if(c[f].ListLvl<0)c[f].ListLvl=0;c[f].ParaMask|=tc.PMASK_LVL}else if(s=="listtext"){y1(t)}else if(s=="chbrdr"){if(Nj(t.IntParam)&&Dj(c[f].flags&(tc.GFLAG_IN_LIST|tc.GFLAG_IN_LIST_OR))){c[f].BorderType=tc.BORDER_CHAR;c[f].style|=tc.CHAR_BOX}else{c[f].style=c[f].style&~tc.CHAR_BOX;c[f].StyleOff|=tc.CHAR_BOX}}else if(s=="box"){c[f].BorderType=tc.BORDER_PARA_ALL;c[f].ParaMask|=tc.PMASK_BORDER}else if(s=="brdrt"){c[f].BorderType=tc.BORDER_PARA_TOP;c[f].ParaMask|=tc.PMASK_BORDER}else if(s=="brdrb"){c[f].BorderType=tc.BORDER_PARA_BOT;c[f].ParaMask|=tc.PMASK_BORDER}else if(s=="brdrl"){c[f].BorderType=tc.BORDER_PARA_LEFT;c[f].ParaMask|=tc.PMASK_BORDER}else if(s=="brdrr"){c[f].BorderType=tc.BORDER_PARA_RIGHT;c[f].ParaMask|=tc.PMASK_BORDER}else if(s=="brdrbtw"){c[f].BorderType=tc.BORDER_PARA_BETWEEN;c[f].ParaMask|=tc.PMASK_BORDER}else if(s=="brdrs"){l=c[f].BorderType;c[f].CellBorderType=tc.BRDRTYPE_SINGLE;t2(c[f],l);if(pj(l)){e2(c[f],l);t.sect.BorderType=tc.BRDRTYPE_SINGLE}else if(l==tc.BORDER_CELL_TOP)c[f].BorderWidth[tc.BORDER_CELL_TOP]=20;else if(l==tc.BORDER_CELL_BOT)c[f].BorderWidth[tc.BORDER_CELL_BOT]=20;else if(l==tc.BORDER_CELL_LEFT)c[f].BorderWidth[tc.BORDER_CELL_LEFT]=20;else if(l==tc.BORDER_CELL_RIGHT)c[f].BorderWidth[tc.BORDER_CELL_RIGHT]=20;else if(l==tc.BORDER_CHAR)c[f].CharBorderWidth=20;c[f].ParaMask|=tc.PMASK_BORDER}else if(s=="brdrnone"){l=c[f].BorderType;c[f].CellBorderType=tc.BRDRTYPE_NONE;c[f].BorderWidth[l]=0;if(l==tc.BORDER_PARA_LEFT)c[f].flags=cj(c[f].flags,tc.PARA_BOX_LEFT);if(l==tc.BORDER_PARA_RIGHT)c[f].flags=cj(c[f].flags,tc.PARA_BOX_RIGHT);if(l==tc.BORDER_PARA_TOP)c[f].flags=cj(c[f].flags,tc.PARA_BOX_TOP);if(l==tc.BORDER_PARA_BOT)c[f].flags=cj(c[f].flags,tc.PARA_BOX_BOT);if(pj(l)){e2(c[f],l);t.sect.BorderType=tc.BRDRTYPE_NONE;c[f].ParaMask|=tc.PMASK_BORDER}if(l==tc.BORDER_CHAR)c[f].CharBorderWidth=0}else if(s=="brdrsh"){l=c[f].BorderType;c[f].CellBorderType=tc.BRDRTYPE_SHADOW;c[f].BorderWidth[l]=0;if(pj(l)){e2(c[f],l);t.sect.BorderType=tc.BRDRTYPE_SHADOW;c[f].ParaMask|=tc.PMASK_BORDER}}else if(s=="brdrsh"){l=c[f].BorderType;c[f].CellBorderType=tc.BRDRTYPE_SHADOW;c[f].BorderWidth[l]=0;if(pj(l)){e2(c[f],l);t.sect.BorderType=tc.BRDRTYPE_SHADOW;c[f].ParaMask|=tc.PMASK_BORDER}}else if(s=="brdrtnthsg"||s=="brdrtnthmg"||s=="brdrtnthlg"){l=c[f].BorderType;c[f].CellBorderType=tc.BRDRTYPE_THICK_THIN;c[f].BorderWidth[l]=0;if(pj(l)){e2(c[f],l);t.sect.BorderType=tc.BRDRTYPE_THIN_THICK}}else if(s=="brdrtnthtnsg"||s=="brdrtnthtnmg"||s=="brdrtnthtnlg"){l=c[f].BorderType;c[f].CellBorderType=tc.BRDRTYPE_THIN_THICK_THIN;c[f].BorderWidth[l]=0;if(pj(l)){e2(c[f],l);t.sect.BorderType=tc.BRDRTYPE_THIN_THICK_THIN}}else if(s=="brdrthtnsg"||s=="brdrthtnmg"||s=="brdrthtnlg"){l=c[f].BorderType;c[f].CellBorderType=tc.BRDRTYPE_THICK_THIN;c[f].BorderWidth[l]=0;if(pj(l)){e2(c[f],l);t.sect.BorderType=tc.BRDRTYPE_THICK_THIN}}else if(s=="brdrthtnthg"||s=="brdrthtnthmg"||s=="brdrthtnthlg"){l=c[f].BorderType;c[f].CellBorderType=tc.BRDRTYPE_THICK_THIN_THICK;c[f].BorderWidth[l]=0;if(pj(l)){e2(c[f],l);t.sect.BorderType=tc.BRDRTYPE_THICK_THIN_THICK}}else if(s=="brdrth"){l=c[f].BorderType;c[f].CellBorderType=tc.BRDRTYPE_THICK;t2(c[f],l);c[f].flags=c[f].flags|tc.PARA_BOX_THICK;if(pj(l))e2(c[f],l)}else if(s=="brdrw"){l=c[f].BorderType;t2(c[f],l);if(gR==0)c[f].BorderWidth[l]=t.IntParam;else{if(t.IntParam>0||Nj(rO&tc.TFLAG8_COMP_V14))c[f].BorderWidth[l]=t.IntParam;else if(c[f].CellBorderType==tc.BRDRTYPE_NONE)c[f].BorderWidth[l]=0}if(pj(l))e2(c[f],l);if(l==tc.BORDER_PARA_LEFT||l==tc.BORDER_PARA_RIGHT||l==tc.BORDER_PARA_TOP||l==tc.BORDER_PARA_BOT||l==tc.BORDER_PARA_BETWEEN)c[f].BorderWidth[l]=t.IntParam;if(l==tc.BORDER_CHAR)c[f].CharBorderWidth=t.IntParam}else if(s=="brdrdb"){l=c[f].BorderType;c[f].CellBorderType=tc.BRDRTYPE_DBL;t2(c[f],l);c[f].flags=c[f].flags|tc.PARA_BOX_DOUBLE;if(pj(l)){e2(c[f],l);t.sect.BorderType=tc.BRDRTYPE_DBL}}else if(s=="brdrtriple"){l=c[f].BorderType;c[f].CellBorderType=tc.BRDRTYPE_TRIPLE;t2(c[f],l);c[f].flags=c[f].flags|tc.PARA_BOX_DOUBLE;if(pj(l)){e2(c[f],l);t.sect.BorderType=tc.BRDRTYPE_TRIPLE}}else if(s=="brdrcf"){o=h2(t);u=o.color;if(t.param.length==0)t.IntParam=0;l=c[f].BorderType;if(t.IntParam>=0&&t.IntParam<o.TotalRtfColors)c[f].BorderColor[l]=u[t.IntParam].color;if(t.IntParam>=o.TotalRtfColors&&Nj(rO&tc.TFLAG8_COMP_V14))c[f].BorderColor[l]=tc.CLR_WHITE;t2(c[f],l);if(Nj(c[f].flags&tc.PARA_BOX))c[f].ParaBorderColor=u[t.IntParam].color;if(t.param.length==0)t.IntParam=0;if(t.IntParam>=0&&t.IntParam<o.TotalRtfColors)c[f].BorderColor[l]=u[t.IntParam].color;if(pj(l)){e2(c[f],l);t.sect.BorderColor=u[t.IntParam].color}}else if(s=="brsp"){f=t.GroupLevel;l=c[f].BorderType;t2(c[f],l);c[f].BorderSpace[l]=t.IntParam;c[f].BorderMargin=t.IntParam;if(pj(l))e2(c[f],l)}else if(s=="shading"){f=t.GroupLevel;c[f].ParShading=t.IntParam;c[f].ParaMask|=tc.PMASK_SHADING}else if(s=="cbpat"){o=h2(t);u=o.color;if(t.IntParam==0&&u[0].color==tc.CLR_AUTO){c[f].ParaBkColor=tc.CLR_WHITE;c[f].ParaMask|=tc.PMASK_BK_COLOR}else if(t.IntParam>=0&&t.IntParam<o.TotalRtfColors){c[f].ParaBkColor=u[t.IntParam].color;c[f].ParaMask|=tc.PMASK_BK_COLOR}}else if(s=="cfpat"){o=h2(t);u=o.color;c[f].ParaBkColor=u[t.IntParam].color;c[f].ParShading=0}else a=false;if(a)return 0;if(s=="phpg"&&!t.IgnoreFrames){if(!c[f].InTable&&gR>0&&!t.TableInFrame)gR=PR=hR=0;if(true||gR==0||t.TableInFrame){f=t.GroupLevel;c[f].FrmFlags|=tc.PARA_FRAME_HPAGE|tc.PARA_FRAME_USED;c[f].HPageGroup=f;c[f].gflags|=tc.GFLAG_NEW_FRAME|tc.GFLAG_IN_FRAME}}else if(s=="pvpg"&&!t.IgnoreFrames){if(!c[f].InTable&&gR>0&&!t.TableInFrame)gR=PR=hR=0;if(true||gR==0||t.TableInFrame){c[f].FrmFlags|=tc.PARA_FRAME_VPAGE|tc.PARA_FRAME_USED;c[f].gflags|=tc.GFLAG_NEW_FRAME|tc.GFLAG_IN_FRAME}}else if(s=="pvmrg"&&!t.IgnoreFrames){if(!c[f].InTable&&gR>0&&!t.TableInFrame)gR=PR=hR=0;if(true||gR==0||t.TableInFrame){c[f].FrmFlags|=tc.PARA_FRAME_VMARG|tc.PARA_FRAME_USED;c[f].gflags|=tc.GFLAG_NEW_FRAME|tc.GFLAG_IN_FRAME}}else if(s=="pvpara"){if(!t.IgnoreFrames){if(!c[f].InTable&&gR>0&&!t.TableInFrame)gR=PR=hR=0;if(Dj(c[f].gflags&(tc.GFLAG_DRAW_OBJECT|tc.GFLAG_IN_SHP))||Nj(c[f].gflags&tc.GFLAG_IN_SHPRSLT)){c[f].FrmFlags|=tc.PARA_FRAME_USED;c[f].FrmFlags2|=tc.PF2_PVPARA;c[f].gflags|=tc.GFLAG_NEW_FRAME|tc.GFLAG_IN_FRAME}}}else if(s=="posxr"&&!t.IgnoreFrames){if(!c[f].InTable&&gR>0&&!t.TableInFrame)gR=PR=hR=0;if(true||gR==0||t.TableInFrame){c[f].FrmFlags|=tc.PARA_FRAME_RIGHT_JUST|tc.PARA_FRAME_USED;c[f].gflags|=tc.GFLAG_NEW_FRAME|tc.GFLAG_IN_FRAME}}else if(s=="posxc"&&!t.IgnoreFrames){if(!c[f].InTable&&gR>0&&!t.TableInFrame)gR=PR=hR=0;if(true||gR==0||t.TableInFrame){c[f].FrmFlags|=tc.PARA_FRAME_CENTER|tc.PARA_FRAME_USED;c[f].gflags|=tc.GFLAG_NEW_FRAME|tc.GFLAG_IN_FRAME}}else if(s=="posyc"&&!t.IgnoreFrames){if(!c[f].InTable&&gR>0&&!t.TableInFrame)gR=PR=hR=0;if(true||gR==0||t.TableInFrame){if(Dj(c[f].FrmFlags2&tc.PF2_VTOP)){c[f].FrmFlags|=tc.PARA_FRAME_VCENTER|tc.PARA_FRAME_USED;c[f].gflags|=tc.GFLAG_NEW_FRAME|tc.GFLAG_IN_FRAME}}}else if(s=="posyb"&&!t.IgnoreFrames){if(!c[f].InTable&&gR>0&&!t.TableInFrame)gR=PR=hR=0;if(true||gR==0||t.TableInFrame){c[f].FrmFlags|=tc.PARA_FRAME_USED;c[f].FrmFlags2|=tc.PF2_VBOTTOM;c[f].gflags|=tc.GFLAG_NEW_FRAME|tc.GFLAG_IN_FRAME}}else if((s=="posx"||s=="posnegx")&&!t.IgnoreFrames){if(!c[f].InTable&&gR>0&&!t.TableInFrame)gR=PR=hR=0;if(true||gR==0||t.TableInFrame){c[f].ParaFrameInfo.x=t.IntParam;c[f].HPageGroup=f;c[f].FrmFlags|=tc.PARA_FRAME_USED;c[f].gflags|=tc.GFLAG_NEW_FRAME|tc.GFLAG_IN_FRAME}}else if(s=="posxi"&&!t.IgnoreFrames){if(!c[f].InTable&&gR>0&&!t.TableInFrame)gR=PR=hR=0;if(true||gR==0||t.TableInFrame){c[f].ParaFrameInfo.x=0;c[f].FrmFlags|=tc.PARA_FRAME_USED;c[f].gflags|=tc.GFLAG_NEW_FRAME|tc.GFLAG_IN_FRAME}}else if((s=="posy"||s=="posnegy")&&!t.IgnoreFrames&&!t.InTableDef){if(!c[f].InTable&&gR>0&&!t.TableInFrame)gR=PR=hR=0;if(true||gR==0||t.TableInFrame){c[f].ParaFrameInfo.y=t.IntParam;c[f].FrmFlags|=tc.PARA_FRAME_USED;c[f].gflags|=tc.GFLAG_NEW_FRAME|tc.GFLAG_IN_FRAME;if(gR>0)tR[gR].TableInFrame=true}}else if(s=="posyt"&&!t.IgnoreFrames){if(!c[f].InTable&&gR>0&&!t.TableInFrame)gR=PR=hR=0;if(true||gR==0||t.TableInFrame){c[f].ParaFrameInfo.y=0;c[f].FrmFlags|=tc.PARA_FRAME_USED;if(Dj(c[f].FrmFlags&tc.PARA_FRAME_VPAGE))c[f].FrmFlags|=tc.PARA_FRAME_VMARG;c[f].gflags|=tc.GFLAG_NEW_FRAME|tc.GFLAG_IN_FRAME}}else if(s=="absw"&&!t.IgnoreFrames){if(!c[f].InTable&&gR>0&&!t.TableInFrame)gR=PR=hR=0;if(true||gR==0||t.TableInFrame){c[f].ParaFrameInfo.width=t.IntParam;c[f].FrmFlags|=tc.PARA_FRAME_USED;c[f].FrmFlags=cj(c[f].FrmFlags,tc.PARA_FRAME_SET_WIDTH);c[f].gflags|=tc.GFLAG_NEW_FRAME|tc.GFLAG_IN_FRAME;if(false&&gR==0){c[f].InTable=false;t.InitialCell=0}}}else if(s=="absh"&&!t.IgnoreFrames){if(!c[f].InTable&&gR>0&&!t.TableInFrame)gR=PR=hR=0;if(true||gR==0||t.TableInFrame){c[f].ParaFrameInfo.height=Math.abs(t.IntParam);if(t.IntParam<0)c[f].FrmFlags|=tc.PARA_FRAME_FIXED_HEIGHT;c[f].FrmFlags|=tc.PARA_FRAME_USED;c[f].gflags|=tc.GFLAG_NEW_FRAME|tc.GFLAG_IN_FRAME}}else if(s=="dfrmtxtx"){if(!c[f].InTable&&gR>0&&!t.TableInFrame)gR=PR=hR=0;if(true||gR==0||t.TableInFrame){c[f].ParaFrameInfo.DistFromTextLeft=Math.abs(t.IntParam);c[f].ParaFrameInfo.DistFromTextRight=Math.abs(t.IntParam)}}else if(s=="nowrap"){c[f].FrmFlags|=tc.PARA_FRAME_NO_WRAP}else if(s=="overlay"){c[f].FrmFlags2|=tc.PF2_OVERLAY}else if(s=="absnoovrlp"){if(Nj(t.IntParam))c[f].FrmFlags2|=tc.PF2_NO_OVERLAP}else if(s=="frmtxtblr"||s=="frmtxtbrl"||s=="frmtxtbrlv"){c[f].TextAngle=270}else if(s=="frmtxbtlr"){c[f].TextAngle=90}else if(s=="do"){if(false&&OR>0&&Nj(c[f].gflags&tc.GFLAG_IN_FRAME))y1(t);else{c[f].gflags|=tc.GFLAG_INSERT_BEF_PARA|tc.GFLAG_DRAW_OBJECT|tc.GFLAG_NEW_FRAME|tc.GFLAG_IN_FRAME;t.flags|=tc.RFLAG_NEW_FRAME;OR=0;c[f].TextAngle=0}}else if(s=="dptxbtlr"){c[f].TextAngle=90}else if(s=="dptxtbrl"){c[f].TextAngle=270}else if(s=="dobxpage"){c[f].FrmFlags|=tc.PARA_FRAME_HPAGE;c[f].HPageGroup=f}else if(s=="dobypage"){c[f].FrmFlags|=tc.PARA_FRAME_VPAGE}else if(s=="dobymargin"){c[f].FrmFlags|=tc.PARA_FRAME_VMARG}else if(s=="dodhgt"){c[f].ParaFrameInfo.ZOrder=t.IntParam;if(c[f].ParaFrameInfo.ZOrder==0)c[f].ParaFrameInfo.ZOrder=-1}else if(s=="dptxbxmar"){c[f].TextBoxMargin=t.IntParam}else if(s=="dptxbx"){c[f].FrmFlags|=tc.PARA_FRAME_TEXT_BOX|tc.PARA_FRAME_USED}else if(s=="dpgroup"){c[f].gflags|=tc.GFLAG_IN_DPGROUP;if(c[f].DpGroupCount<tc.MAX_DP_GROUPS)c[f].DpGroupCount++}else if(s=="dpendgroup"){OR=0;if(c[f].DpGroupCount>0)c[f].DpGroupCount--;c[f].gflags=cj(c[f].gflags,tc.GFLAG_IN_DPGROUP)}else if(s=="dpline"){OR=0;c[f].gflags=cj(c[f].gflags,tc.GFLAG_IN_DPGROUP);c[f].FrmFlags|=tc.PARA_FRAME_LINE|tc.PARA_FRAME_USED;t.OutBuf+=wY(Bn);t.OutBufLen++;OR=0;if(!b1(t))return tc.RTF_END_FILE;kl[OR].x=kl[OR].ParaY=-1;kl[OR].width=kl[OR].height=1;kl[OR].LineType=tc.DOL_HORZ}else if(s=="dprect"){OR=0;c[f].gflags=cj(c[f].gflags,tc.GFLAG_IN_DPGROUP);c[f].FrmFlags|=tc.PARA_FRAME_RECT|tc.PARA_FRAME_USED;t.OutBuf+=wY(Bn);t.OutBufLen++;if(!b1(t))return tc.RTF_END_FILE}else if(s=="dppolycount"){r=t.IntParam;if(r==2||r==4){OR=0;c[f].gflags=cj(c[f].gflags,tc.GFLAG_IN_DPGROUP);c[f].FrmFlags|=r==2?tc.PARA_FRAME_LINE:tc.PARA_FRAME_RECT;c[f].FrmFlags|=tc.PARA_FRAME_USED;if(r==2)c[f].FrmFlags2|=tc.PF2_POLYLINE;t.OutBuf+=wY(Bn);t.OutBufLen++;if(!b1(t))return tc.RTF_END_FILE;if(r==2){kl[OR].x=kl[OR].ParaY=-1;kl[OR].width=kl[OR].height=1}}}else if(s=="dptxbxtext"){OR=0;c[f].gflags|=tc.GFLAG_DO_TEXT_READ;c[f].gflags=cj(c[f].gflags,tc.GFLAG_IN_DPGROUP)}else if(s=="dpptx"&&OR>0){T=c[f].DpGroupCount-1;if(T>=0&&Dj(c[f].gflags&tc.GFLAG_IN_DPGROUP))t.IntParam+=c[f].DpGroupX[T];if(kl[OR].x<0)kl[OR].x=t.IntParam;else{kl[OR].width=t.IntParam-kl[OR].x;c[f].gflags|=tc.GFLAG_GOT_WIDTH;if(Nj(c[f].gflags&tc.GFLAG_GOT_HEIGHT)){TW(OR,kl[OR].x,kl[OR].ParaY,kl[OR].x+kl[OR].width,kl[OR].ParaY+kl[OR].height)}}}else if(s=="dppty"&&OR>0){T=c[f].DpGroupCount-1;if(T>=0&&Dj(c[f].gflags&tc.GFLAG_IN_DPGROUP))t.IntParam+=c[f].DpGroupX[T];if(kl[OR].ParaY<0)kl[OR].ParaY=t.IntParam;else{kl[OR].height=kl[OR].MinHeight=t.IntParam-kl[OR].ParaY;c[f].gflags|=tc.GFLAG_GOT_HEIGHT;if(Nj(c[f].gflags&tc.GFLAG_GOT_WIDTH)){TW(OR,kl[OR].x,kl[OR].ParaY,kl[OR].x+kl[OR].width,kl[OR].ParaY+kl[OR].height)}}}else if(s=="dpx"){T=c[f].DpGroupCount-1;if(Nj(c[f].gflags&tc.GFLAG_IN_DPGROUP)){if(T>=0)c[f].DpGroupX[T]=t.IntParam;if(T-1>=0)c[f].DpGroupX[T]+=c[f].DpGroupX[T-1]}else if(OR>0){if(Nj(kl[OR].flags&(tc.PARA_FRAME_TEXT_BOX|tc.PARA_FRAME_RECT)))kl[OR].x=0;if(T>=0)kl[OR].x=c[f].DpGroupX[T];kl[OR].OrgX=kl[OR].x;kl[OR].OrgX+=t.IntParam;kl[OR].x+=t.IntParam;if(Nj(kl[OR].flags&tc.PARA_FRAME_HPAGE)){kl[OR].x-=jV(t.sect.LeftMargin);kl[OR].flags=cj(kl[OR].flags,tc.PARA_FRAME_HPAGE)}}}else if(s=="dpy"){T=c[f].DpGroupCount-1;if(Nj(c[f].gflags&tc.GFLAG_IN_DPGROUP)){if(T>=0)c[f].DpGroupY[T]=t.IntParam;if(T-1>=0)c[f].DpGroupY[T]+=c[f].DpGroupY[T-1]}else if(OR>0){if(Nj(kl[OR].flags&(tc.PARA_FRAME_TEXT_BOX|tc.PARA_FRAME_RECT)))kl[OR].ParaY=0;if(T>=0)kl[OR].ParaY=c[f].DpGroupY[T];kl[OR].ParaY+=t.IntParam}}else if(s=="dpxsize"&&OR>0){if(Dj(c[f].FrmFlags2&tc.PF2_POLYLINE)){f=t.GroupLevel;kl[OR].width=t.IntParam;kl[OR].flags=cj(kl[OR].flags,tc.PARA_FRAME_SET_WIDTH)}}else if(s=="dpysize"&&OR>0){if(Dj(c[f].FrmFlags2&tc.PF2_POLYLINE)){f=t.GroupLevel;kl[OR].height=kl[OR].MinHeight=t.IntParam}}else if(s=="dplinehollow"&&OR>0){c[f].gflags|=tc.GFLAG_DPLINEHOLLOW}else if(s=="dplinesolid"&&OR>0){kl[OR].flags|=tc.PARA_FRAME_BOXED}else if(s=="dplinedot"&&OR>0){kl[OR].flags|=tc.PARA_FRAME_BOXED|tc.PARA_FRAME_DOTTED}else if(s=="dplinew"&&OR>0){kl[OR].LineWdth=t.IntParam;if(t.IntParam>0&&Dj(c[f].gflags&tc.GFLAG_DPLINEHOLLOW))kl[OR].flags|=tc.PARA_FRAME_BOXED}else if(s=="dplinecor"&&OR>0){u=kl[OR].LineColor;kl[OR].LineColor=new tc.Color(t.IntParam,u.getGreen(),u.getBlue())}else if(s=="dplinecog"&&OR>0){u=kl[OR].LineColor;kl[OR].LineColor=new tc.Color(u.getRed(),t.IntParam,u.getBlue())}else if(s=="dplinecob"&&OR>0){u=kl[OR].LineColor;kl[OR].LineColor=new tc.Color(u.getRed(),u.getGreen(),t.IntParam)}else if(s=="dpfillbgcr"&&OR>0){u=kl[OR].BackColor;kl[OR].BackColor=new tc.Color(t.IntParam,u.getGreen(),u.getBlue())}else if(s=="dpfillbgcg"&&OR>0){u=kl[OR].BackColor;kl[OR].BackColor=new tc.Color(u.getRed(),t.IntParam,u.getBlue())}else if(s=="dpfillbgcb"&&OR>0){u=kl[OR].BackColor;kl[OR].BackColor=new tc.Color(u.getRed(),u.getGreen(),t.IntParam)}else if(s=="dpfillbggray"&&OR>0){var B=255-t.IntParam*255/200;kl[OR].BackColor=new tc.Color(B,B,B)}else if(s=="dpfillpat"&&OR>0){kl[OR].FillPattern=t.IntParam;if(kl[OR].FillPattern==1&&MJ(kl[OR].BackColor,tc.CLR_WHITE))kl[OR].BackColor=tc.CLR_WHITE_FORCE}else if(s=="tqr"){t.CurTabType=tc.TAB_RIGHT}else if(s=="tqdec"){t.CurTabType=tc.TAB_DECIMAL}else if(s=="tqc"){t.CurTabType=tc.TAB_CENTER}else if(s=="tldot"){t.CurTabFlags=tc.TAB_DOT}else if(s=="tlhyph"){t.CurTabFlags=tc.TAB_HYPH}else if(s=="tlul"){t.CurTabFlags=tc.TAB_ULINE}else if(s=="tx"){f=t.GroupLevel;r=c[f].tab.count;if(r<tc.TE_MAX_TAB_STOPS){for(e=0;e<r;e++){if(c[f].tab.pos[e]==t.IntParam&&c[f].tab.type[e]==t.CurTabType)break}if(e==r){c[f].tab.pos[r]=t.IntParam;c[f].tab.type[r]=t.CurTabType;c[f].tab.flags[r]=t.CurTabFlags;c[f].tab.count++}}t.CurTabType=tc.TAB_LEFT;t.CurTabFlags=0;c[f].ParaMask|=tc.PMASK_TAB}else if(s=="sssubtable"){var H=c[f].level;t.flags1|=tc.RFLAG1_SSSUBTABLE_USED;b2(t,f,H+1,H)}else if(s=="itap"){var m=t.IntParam;n=Nj(c[f].style&tc.FNOTEALL);if(!n){if(m<0)m=0;c[f].level=NR+m;if(!t.EmbedTable&&PR!=SR)c[f].level--}t.InTableDef=false}else if(s=="nonesttables"){y1(t)}else if(s=="nesttableprops"){c[f].gflags|=tc.GFLAG_IN_NESTTABLEPROPS;if(c[f].level<=1||Nj(c[f].gflags2&tc.GFLAG2_NESTPROP_BEF_NESTCELL)){c[f].level++;c[f].gflags2|=tc.GFLAG2_NESTPROP_BEF_NESTCELL}}else if(s=="trowd"){var w;if(!B1(t,c,f))return cr;if(gR>0){$E[gR].flags=cj($E[gR].flags,tc.CENTER|tc.RIGHT_JUSTIFY|tc.ROWFLAG_AUTO_FIT|tc.ROWFLAG_AUTO_WIDTH_RTF|tc.ROWFLAG_TWIPS_WIDTH);tR[gR].flags=cj(tR[gR].flags,tc.TAUX_IN_FRAME);$E[gR].MinHeight=0}if(Nj(rO&tc.TFLAG8_COMP_V14))c[f].TextColor=tc.CLR_AUTO;t.CurTblStyle=0;t.InTableDef=true}else if((s=="row"||s=="nestrow")&&Dj(t.flags&tc.RFLAG_END_TABLE)&&gR>0&&$E[gR].FirstCell>0){var b;c[f].InTable=true;if(!t.PastingColumn||Dj($E[gR].flags&tc.ROWFLAG_PREEXIST)){if(Nj($E[gR].flags&(tc.ROWFLAG_AUTO_FIT|tc.ROWFLAG_TWIPS_WIDTH|tc.ROWFLAG_PCT_WIDTH))&&!TE)N1(t,gR);t.OutBuf+=wY(tc.ROW_CHAR);t.OutBufLen++;if(!b1(t))return tc.RTF_END_FILE}else if(t.PastingColumn&&t.InitTblCol>=0&&ah!=tc.RTF_CB&&Nj($E[gR].flags&tc.ROWFLAG_PREEXIST))p1(gR);$E[gR].TblIndType=c[f].TblIndType;$E[gR].TblInd=c[f].TblInd;$E[gR].RowSpaceBefType=c[f].RowSpaceBefType;$E[gR].RowSpaceBef=c[f].RowSpaceBef;b=gR;$E[b].border=0;if(Nj(c[f].BorderWidth[tc.BORDER_ROW_TOP]))$E[b].border|=tc.BORDER_TOP;if(Nj(c[f].BorderWidth[tc.BORDER_ROW_BOT]))$E[b].border|=tc.BORDER_BOT;if(Nj(c[f].BorderWidth[tc.BORDER_ROW_LEFT]))$E[b].border|=tc.BORDER_LEFT;if(Nj(c[f].BorderWidth[tc.BORDER_ROW_RIGHT]))$E[b].border|=tc.BORDER_RIGHT;if(Nj($E[b].border&tc.BORDER_TOP))$E[b].BorderWidth[tc.BORDER_INDEX_TOP]=c[f].BorderWidth[tc.BORDER_ROW_TOP];if(Nj($E[b].border&tc.BORDER_BOT))$E[b].BorderWidth[tc.BORDER_INDEX_BOT]=c[f].BorderWidth[tc.BORDER_ROW_BOT];if(Nj($E[b].border&tc.BORDER_LEFT))$E[b].BorderWidth[tc.BORDER_INDEX_LEFT]=c[f].BorderWidth[tc.BORDER_ROW_LEFT];if(Nj($E[b].border&tc.BORDER_RIGHT))$E[b].BorderWidth[tc.BORDER_INDEX_RIGHT]=c[f].BorderWidth[tc.BORDER_ROW_RIGHT];if(t.TableInFrame)tR[b].flags|=tc.TAUX_IN_FRAME;if(!D1(t,c,f))return tc.RTF_SYNTAX_ERROR;tR[gR].flags=cj(tR[gR].flags,tc.TAUX_TROWD_DONE|tc.TAUX_REUSE_CELL_CHAIN);t.SkipSpaces=false}else if(s=="intbl"){if(Nj(t.IntParam)){c[f].InTable=true;t.SkipSpaces=false;if(Dj(t.flags1&tc.RFLAG1_SSSUBTABLE_USED)){c[f].level=NR+1;if(!t.EmbedTable)c[f].level--}if(!t.EmbedTable)t.InitialCell=0}else c[f].InTable=false;t.InTableDef=false}else if(s=="sstrid"){if(gR>0&&Dj($E[gR].flags&tc.ROWFLAG_PREEXIST)){var x=t.IntParam;for(e=1;e<iR;e++){if(Nj($E[e].flags&tc.ROWFLAG_PREEXIST)&&$E[e].id==x){x=0;break}}$E[gR].id=x}}else if(s=="trhdr"){if(gR>0&&Dj($E[gR].flags&tc.ROWFLAG_PREEXIST))$E[gR].flags|=tc.ROWFLAG_HDR}else if(s=="trkeep"){if(gR>0&&Dj($E[gR].flags&tc.ROWFLAG_PREEXIST))$E[gR].flags|=tc.ROWFLAG_KEEP}else if(s=="trautofit"){if(gR>0&&Dj($E[gR].flags&tc.ROWFLAG_PREEXIST)&&t.IntParam!=0&&Dj(eO&tc.TFLAG7_NO_TABLE_AUTO_WIDTH))$E[gR].flags|=tc.ROWFLAG_AUTO_FIT|tc.ROWFLAG_AUTO_WIDTH_RTF}else if(s=="trwwidth"){if(gR>0&&Dj($E[gR].flags&tc.ROWFLAG_PREEXIST)){$E[gR].PrefWidth=t.IntParam;$E[gR].FixWidth=t.IntParam}}else if(s=="trftswidth"){if(gR>0&&Dj($E[gR].flags&tc.ROWFLAG_PREEXIST)){$E[gR].flags=cj($E[gR].flags,tc.ROWFLAG_TWIPS_WIDTH);$E[gR].flags=cj($E[gR].flags,tc.ROWFLAG_NO_PREF_WIDTH|tc.ROWFLAG_PCT_WIDTH);if(t.IntParam==1)$E[gR].flags|=tc.ROWFLAG_NO_PREF_WIDTH;else if(t.IntParam==2)$E[gR].flags|=tc.ROWFLAG_PCT_WIDTH;else if(t.IntParam==3)$E[gR].flags|=tc.ROWFLAG_TWIPS_WIDTH}}else if(s=="trgaph"){if(gR>0&&Dj($E[gR].flags&tc.ROWFLAG_PREEXIST)){$E[gR].CellMargin=t.IntParam;if(!Bi)$E[gR].AddedIndent=t.IntParam}}else if(s=="trpaddl"){if(gR>0&&Dj($E[gR].flags&tc.ROWFLAG_PREEXIST)&&t.IntParam>0){if($E[gR].LeftPad!=2){$E[gR].LeftPad=t.IntParam;if(!Bi)$E[gR].AddedIndent=t.IntParam}}}else if(s=="trpaddfl"){if(gR>0&&Dj($E[gR].flags&tc.ROWFLAG_PREEXIST)){if(t.IntParam==0)$E[gR].LeftPad=-2}}else if(s=="trpaddr"){if(gR>0&&Dj($E[gR].flags&tc.ROWFLAG_PREEXIST)){if($E[gR].RightPad!=2&&tR[gR].RowBand==c[f].RowBand)$E[gR].RightPad=t.IntParam}}else if(s=="trpaddfr"){if(gR>0&&Dj($E[gR].flags&tc.ROWFLAG_PREEXIST)){if(t.IntParam==0)$E[gR].RightPad=-2}}else if(s=="trpaddt"){if(gR>0&&Dj($E[gR].flags&tc.ROWFLAG_PREEXIST)){if($E[gR].TopPad!=2&&tR[gR].RowBand==c[f].RowBand)$E[gR].TopPad=t.IntParam}}else if(s=="trpaddft"){if(gR>0&&Dj($E[gR].flags&tc.ROWFLAG_PREEXIST)){if(t.IntParam==0)$E[gR].TopPad=-2}}else if(s=="trpaddb"){if(gR>0&&Dj($E[gR].flags&tc.ROWFLAG_PREEXIST)){if($E[gR].BotPad!=2&&tR[gR].RowBand==c[f].RowBand)$E[gR].BotPad=t.IntParam}}else if(s=="trpaddfb"){if(gR>0&&Dj($E[gR].flags&tc.ROWFLAG_PREEXIST)){if(t.IntParam==0)$E[gR].BotPad=-2}}else if(s=="irowband"){if(gR>0&&Dj($E[gR].flags&tc.ROWFLAG_PREEXIST)){c[f].RowBand=t.IntParam;if(tR[gR].RowBand==-2)tR[gR].RowBand=t.IntParam}}else if(s=="lastrow"){if(gR>0&&Dj($E[gR].flags&tc.ROWFLAG_PREEXIST)&&Dj(rO&tc.TFLAG8_IGNORE_LASTROW)){$E[gR].flags|=tc.ROWFLAG_LAST_ROW}}else if(s=="trqr"){if(gR>0&&Dj($E[gR].flags&tc.ROWFLAG_PREEXIST))$E[gR].flags|=tc.RIGHT_JUSTIFY}else if(s=="trqc"){if(gR>0&&Dj($E[gR].flags&tc.ROWFLAG_PREEXIST))$E[gR].flags|=tc.CENTER}else if(s=="trleft"){if(gR>0&&Dj($E[gR].flags&tc.ROWFLAG_PREEXIST)){var y=t.IntParam;tR[gR].RtfRowIndent=y;$E[gR].indent=y}t.PrevCellX=t.IntParam}else if(s=="tblind"){c[f].TblInd=t.IntParam}else if(s=="tblindtype"){c[f].TblIndType=t.IntParam}else if(s=="trwwidthb"){c[f].RowSpaceBef=t.IntParam}else if(s=="trftswidthb"){c[f].RowSpaceBefType=t.IntParam}else if(s=="trrh"){if(gR>0&&Dj($E[gR].flags&tc.ROWFLAG_PREEXIST))$E[gR].MinHeight=t.IntParam}else if(s=="trbrdrt"){c[f].BorderType=tc.BORDER_ROW_TOP;c[f].BorderWidth[tc.BORDER_ROW_TOP]=vV(1)}else if(s=="trbrdrb"){c[f].BorderType=tc.BORDER_ROW_BOT;c[f].BorderWidth[tc.BORDER_ROW_BOT]=vV(1)}else if(s=="trbrdrl"){c[f].BorderType=tc.BORDER_ROW_LEFT;c[f].BorderWidth[tc.BORDER_ROW_LEFT]=gV(1)}else if(s=="trbrdrr"){c[f].BorderType=tc.BORDER_ROW_RIGHT;c[f].BorderWidth[tc.BORDER_ROW_RIGHT]=gV(1)}else if(s=="rtlrow"){t.CellFlow=tc.FLOW_RTL;if(gR>0&&Dj($E[gR].flags&tc.ROWFLAG_PREEXIST))$E[gR].flow=tc.FLOW_RTL}else if(s=="ltrrow"){t.CellFlow=tc.FLOW_LTR;if(gR>0&&Dj($E[gR].flags&tc.ROWFLAG_PREEXIST))$E[gR].flow=tc.FLOW_LTR}else if(s=="ssdelcell"||s=="sswholetablerows"){t.InitTblCol=-1;t.PastingColumn=false;if(s=="ssdelcell")t.EmbedTable=false;t.InsertBefCell=t.InsertAftCell=0}else if(s=="sstblend"){if(Nj(t.flags&tc.RFLAG_CURS_IN_TABLE))t.flags|=tc.RFLAG_END_TABLE}else if(s=="clpadl"){c[f].ClTopPad=t.IntParam}else if(s=="clpadfl"){if(t.IntParam==3)c[f].ClPadFlags|=tc.PAD_TOP}else if(s=="clpadt"){c[f].ClLeftPad=t.IntParam}else if(s=="clpadft"){if(t.IntParam==3)c[f].ClPadFlags|=tc.PAD_LEFT}else if(s=="clpadr"){c[f].ClRightPad=t.IntParam}else if(s=="clpadfr"){if(t.IntParam==3)c[f].ClPadFlags|=tc.PAD_RIGHT}else if(s=="clpadb"){c[f].ClBotPad=t.IntParam}else if(s=="clpadfb"){if(t.IntParam==3)c[f].ClPadFlags|=tc.PAD_BOT}else if(s=="clwwidth"){c[f].clwWidth=t.IntParam}else if(s=="clftswidth"){c[f].clftsWidth=t.IntParam}else if(s=="cellx"){if(!H1(t,c,f))return tc.RTF_SYNTAX_ERROR;c[f].InTable=true}else if(s=="clmrg"){t.flags|=tc.RFLAG_CELL_MERGED}else if(s=="clvmrg"){t.flags1|=tc.RFLAG1_ROW_SPANNED}else if((s=="cell"||s=="nestcell")&&Dj(t.flags&tc.RFLAG_END_TABLE)){var W;if(PR>0&&Nj(rR[PR].flags&tc.CAUX_CLOSED))O2(c[f]);W=PR;if(c[f].InTable&&gR<=0&&t.OpenRowId>0){gR=t.OpenRowId;PR=W=t.OpenCellId;hR=t.OpenLastCellX}if(true||W==0||Dj(eR[W].flags&tc.CFLAG_MERGED)){t.OutBuf+=wY(TR);t.OutBufLen++}if(!b1(t))return tc.RTF_END_FILE;if(PR>0)rR[PR].flags|=tc.CAUX_CLOSED}else if(s=="clvertalt"){c[f].CellFlags=cj(c[f].CellFlags,tc.CFLAG_VALIGN_CTR|tc.CFLAG_VALIGN_BOT)}else if(s=="clvertalc"){c[f].CellFlags|=tc.CFLAG_VALIGN_CTR}else if(s=="clvertalb"){c[f].CellFlags|=tc.CFLAG_VALIGN_BOT}else if(s=="ssclvertalbs"){c[f].CellFlags|=tc.CFLAG_VALIGN_BASE}else if(s=="clbrdrt"){c[f].BorderType=tc.BORDER_CELL_TOP;c[f].BorderWidth[tc.BORDER_CELL_TOP]=0}else if(s=="clbrdrb"){c[f].BorderType=tc.BORDER_CELL_BOT;c[f].BorderWidth[tc.BORDER_CELL_BOT]=0}else if(s=="clbrdrl"){c[f].BorderType=tc.BORDER_CELL_LEFT;c[f].BorderWidth[tc.BORDER_CELL_LEFT]=0}else if(s=="clbrdrr"){c[f].BorderType=tc.BORDER_CELL_RIGHT;c[f].BorderWidth[tc.BORDER_CELL_RIGHT]=0}else if(s=="cldglu"){c[f].BorderType=tc.BORDER_DIAG_UL2LR;c[f].BorderWidth[tc.BORDER_DIAG_UL2LR]=0}else if(s=="cldgll"){c[f].BorderType=tc.BORDER_DIAG_UR2LL;c[f].BorderWidth[tc.BORDER_DIAG_UL2LR]=0}else if(s=="clshdng"){c[f].CellShading=t.IntParam/100}else if(s=="clcfpat"||s=="clcbpat"||s=="clcbpatraw"){o=h2(t);u=o.color;if(t.IntParam>=0&&t.IntParam<o.TotalRtfColors){if(s=="clcfpat")c[f].CellPatFC=u[t.IntParam].color;else{c[f].CellPatBC=u[t.IntParam].color;if(MJ(c[f].CellPatBC,tc.CLR_AUTO))c[f].CellPatBC=tc.CLR_WHITE}c[f].CellFlags|=tc.CFLAG_FORCE_BKND_CLR}}else if(s=="sscolspan"){c[f].CellColSpan=t.IntParam}else if(s=="cltxbtlr"||s=="cltxbtrl"){c[f].TextAngle=90}else if(s=="cltxtblr"||s=="cltxtbrl"){c[f].TextAngle=270}else if(s=="brdrdb"){l=c[f].BorderType;c[f].BorderWidth[l]=2}else if(s=="brdrw"){l=c[f].BorderType;c[f].BorderWidth[l]=t.IntParam}else if(s=="bkmkstart"){if(Dj(iO&tc.TFLAG9_DONT_PASTE_TAGS)){i=K1(t);if(i==tc.RTF_FILE_INCOMPLETE)return tc.RTF_FILE_INCOMPLETE;else if(i==tc.RTF_SYNTAX_ERROR)return tc.RTF_SYNTAX_ERROR}else y1(t)}else if(s=="sstag"){if(Dj(iO&tc.TFLAG9_DONT_PASTE_TAGS)){i=V1(t);if(i==tc.RTF_FILE_INCOMPLETE)return tc.RTF_FILE_INCOMPLETE;else if(i==tc.RTF_SYNTAX_ERROR)return tc.RTF_SYNTAX_ERROR}else y1(t)}else if(s=="protstart"){if(ah<tc.RTF_CB){i=X1(t,true);if(i==tc.RTF_FILE_INCOMPLETE)return tc.RTF_FILE_INCOMPLETE;else if(i==tc.RTF_SYNTAX_ERROR)return tc.RTF_SYNTAX_ERROR}else y1(t)}else if(s=="protend"){if(ah<tc.RTF_CB){i=X1(t,false);if(i==tc.RTF_FILE_INCOMPLETE)return tc.RTF_FILE_INCOMPLETE;else if(i==tc.RTF_SYNTAX_ERROR)return tc.RTF_SYNTAX_ERROR}else y1(t)}else if(s=="field"){i=j1(t);if(i==tc.RTF_FILE_INCOMPLETE)return tc.RTF_FILE_INCOMPLETE;else if(i==tc.RTF_SYNTAX_ERROR)return tc.RTF_SYNTAX_ERROR}else if(s=="fldrslt"){if(Nj(c[f].gflags&tc.GFLAG_IN_MERGE_FIELD)&&z1(t))c[f].FieldId=tc.FIELD_DATA;else y1(t)}else if(s=="formfield"){i=U1(t);if(i==tc.RTF_FILE_INCOMPLETE)return tc.RTF_FILE_INCOMPLETE;else if(i==tc.RTF_SYNTAX_ERROR)return tc.RTF_SYNTAX_ERROR}else if(s=="footnote"){c[f].style=c[f].style|tc.FNOTETEXT;c[f].style=cj(c[f].style,tc.FNOTEREST);t.flags2|=tc.RFLAG2_HAS_FNOTE}else if(s=="ftnalt"){c[f].style=c[f].style|tc.ENOTETEXT;t.flags2|=tc.RFLAG2_HAS_FNOTE;if(Nj(t.flags2&tc.RFLAG2_CHFTN_FOUND)){t.FootnoteNo--;t.EndnoteNo++;i3(t,t.EndnoteNo,bE);A=BP;c[f].EndnoteMarker=A;t.flags2=cj(t.flags2,tc.RFLAG2_CHFTN_FOUND)}}else if(s=="chftn"){if(Dj(c[f].style&tc.FNOTETEXT)){t.FootnoteNo++;i3(t,t.FootnoteNo,wE);A=BP;t.OutBuf+=A;t.OutBufLen=t.OutBuf.length;HE="";t.flags2|=tc.RFLAG2_WRITING_CHFTN;if(!b1(t))return tc.RTF_END_FILE;t.flags2=cj(t.flags2,tc.RFLAG2_WRITING_CHFTN);if(HE.length>0)c[f].style|=tc.FNOTEREST;t.flags2|=tc.RFLAG2_CHFTN_FOUND}else{if(Nj(c[f].style&tc.ENOTETEXT))i3(t,t.EndnoteNo,bE);else i3(t,t.FootnoteNo,wE);A=BP;t.OutBuf+=A;t.OutBufLen=t.OutBuf.length}}else if(s=="mmath"){c[f].gflags2|=tc.GFLAG2_IN_MATH;t.MathGroup=f}else if(s=="momathpara"){c[f].gflags2|=tc.GFLAG2_IN_MATH_PARA}else if(s=="mmathpict"){c[f].gflags2|=tc.GFLAG2_IN_MATH_PICT}else if(s=="momath"){u1(t)}else if(s=="msty"){if(t.exp!=null)t.exp.style=t.IntParam}else if(s=="mscr"){if(t.exp!=null)t.exp.script=t.IntParam}else if(s=="bullet"){m1(t,149,tc.ANSI_CHARSET)}else if(s=="emdash"){t.OutBuf+=wY(8212);t.OutBufLen++}else if(s=="endash"){t.OutBuf+=wY(8211);t.OutBufLen++}else if(s=="lquote"){m1(t,145,tc.ANSI_CHARSET)}else if(s=="rquote"){m1(t,146,tc.ANSI_CHARSET)}else if(s=="ldblquote"){m1(t,8220,tc.ANSI_CHARSET)}else if(s=="rdblquote"){m1(t,8221,tc.ANSI_CHARSET)}else{t:{if(c[t.GroupLevel].ControlCount==1&&t.IgnoreText){if(s=="kerning")break t;if(s=="outl")break t;if(s=="shad")break t;if(s=="cchs")break t;if(s=="widctlpar")break t;if(s=="background")break t;i=y1(t);if(i==tc.RTF_FILE_INCOMPLETE)return tc.RTF_FILE_INCOMPLETE;else if(i==tc.RTF_SYNTAX_ERROR)return tc.RTF_SYNTAX_ERROR}else if(c[t.GroupLevel].ControlCount==1){if(s=="pntext"||s=="pntextb"){i=y1(t);if(i==tc.RTF_FILE_INCOMPLETE)return tc.RTF_FILE_INCOMPLETE;else if(i==tc.RTF_SYNTAX_ERROR)return tc.RTF_SYNTAX_ERROR}}}}return 0}function i1(t,e){var r,i,f;var l;var a;var n;var c;var s,_;var o=false;var u;var T;var A;var E,R,L,C,I,d;var F,g;var P,S;c=t.rtf;if(-1==(_=g2(c)))return false;I1(_,t);if(Nj(t.style&tc.FNOTETEXT))r3(t,_-1);if(Nj(t.gflags&tc.GFLAG_CAPS)&&c.OutBufLen>0)c.OutBuf=c.OutBuf.toUpperCase();r=e.length;var h=e;if(Dj(c.flags2&tc.RFLAG2_WRITING_CHFTN)&&!c.OutBufHasUnicode&&!c.InXml){var O=t.CharType;var v=0;if(O==tc.CHAR_DB&&t.TypeFaceDB!=null&&t.TypeFaceDB.length>0)v=t.CharSetDB;else if(O==tc.CHAR_HI&&t.TypeFaceHi!=null&&t.TypeFaceHi.length>0)v=t.CharSetHi;else v=t.CharSet;if(t.CharType==tc.CHAR_DB){t.gflags2=cj(t.gflags2,tc.GFLAG2_HAS_LEAD);if(L1(c,e,t)){u=pP;if(u.length<e.length)t.gflags2|=tc.GFLAG2_HAS_LEAD;e=u}}else if(v>=2&&r>0){n=e.charCodeAt(r-1);if(n<32)r--;if(r>0&&v!=2){if(n<32)e=cV(e,0,r);if(L1(c,e,t))e=pP;if(n<32)e+=wY(n)}}else{A=Uk(e);for(E=0;E<r;E++){if(A[E]>=256)break;if(A[E]>=128&&A[E]<=161)break}if(E<r){u=e.substring(0,E);for(;E<r;E++){if(A[E]<128)u+=wY(A[E]);else if(A[E]>161&&A[E]<256)u+=wY(A[E]);else if(A[E]>65280)u+=wY(A[E]-65280);else{S=wY(A[E]);var p;if(L1(c,S,t))S=pP;u+=S}}e=u}}}if(t.IgnoreCount>0){r=e.length;T=r>t.IgnoreCount?t.IgnoreCount:r;if(T==r)e="";else e=e.substring(T);t.IgnoreCount-=T}if(t.caps)e=e.toUpperCase();r=e.length;if(r==1&&e.charCodeAt(0)==tc.LINE_CHAR&&t.CharId==0&&_>0&&ui[_-1].len>0){g=ui[_-1].len;P=ui[_-1].txt;if(P[g-1]==tc.LINE_CHAR){d=nb(_-1);var N=xs[d[g-1]].CharId;if(N>0){e="";r=e.length}}}ui[_].fmt=null;ui[_].UniFmt=tc.DEFAULT_CFMT;Tm(_,0,r);l=ui[_].txt;if(r>0){l=ui[_].txt=Uk(e).slice(0,r)}if(Nj(t.XmgFlags&tc.XMGFLAG_USE_PARA_FONT)){i=t.ParaFontId;if(c.FieldId!=xs[i].FieldId||!Cw(c.FieldCode,xs[i].FieldCode)){i=Ew(i,c.FieldId,c.FieldCode)}}else if(Nj(t.XmgFlags2&tc.XMGFLAG2_SDT_FONT_SET)){i=t.SdtFontId;if(c.FieldId!=xs[i].FieldId||!Cw(c.FieldCode,xs[i].FieldCode)){i=Ew(i,c.FieldId,c.FieldCode)}}else i=f1(c,t);f=xs[i].FieldId;if(t.PictId>0&&xs[t.PictId].InUse&&Nj(xs[t.PictId].style&tc.PICT)){i=t.PictId}ui[_].fmt=null;ui[_].UniFmt=i;ui[_].y=0;ui[_].x=0;ui[_].height=xs[i].height;if(PR<0)PR=0;ui[_].cid=PR;d1(_,t);if(Nj(cO&tc.TOFLAG3_USE_PREV_PFMT)){if(_>0)ui[_].pfmt=ui[_-1].pfmt;Tj(tc.TOFLAG3_USE_PREV_PFMT)}if(_>0&&ui[_-1].fid!=ui[_].fid){F=ui[_].fid;if(Nj(kl[F].flags&tc.PARA_FRAME_TEXT_BOX)&&Nj(kl[F].flags&tc.PARA_FRAME_CONV)){r=ui[_-1].len;l=ui[_-1].txt;if(l[r-1]!=Bn){fw(_-1,r-1,1,tc.CHAR_A);r=ui[_-1].len;l=ui[_-1].txt;l[r-1]=Bn}}}if(e.length==1){A=Uk(e);if(A[0]==tc.SECT_CHAR&&xX(_)){ui[_].tabw.type=tc.INFO_SECT;ui[_].tabw.section=io;ui[_].tabw.count=0;o=true}if(A[0]==tc.SECT_CHAR&&_>0)ui[_].pfmt=ui[_-1].pfmt;if(A[0]==tc.SECT_CHAR||A[0]==tc.PAGE_CHAR)ui[_].fid=0;if(A[0]==tc.ROW_CHAR&&_>0&&ui[_].fid!=ui[_-1].fid){ui[_].fid=OR=ui[_-1].fid;if(OR>0)bR=xR.copy()}if(A[0]==tc.HDR_CHAR||A[0]==tc.FTR_CHAR||A[0]==tc.RHDR_CHAR||A[0]==tc.RFTR_CHAR||A[0]==tc.FHDR_CHAR||A[0]==tc.FFTR_CHAR||A[0]==tc.LHDR_CHAR||A[0]==tc.LFTR_CHAR){if(_-2>=0&&ui[_-2].len==1&&ui[_-1].len==1){I=ui[_-2].txt[0];if(I==tc.HDR_CHAR||I==tc.FTR_CHAR||I==tc.RHDR_CHAR||I==tc.RFTR_CHAR||I==tc.FHDR_CHAR||I==tc.FFTR_CHAR||I==tc.LHDR_CHAR||I==tc.LFTR_CHAR){var D=ui[_-1].txt;I=D[0];if(I==tc.PARA_CHAR){fw(_-1,0,1,gk("B"));D=ui[_-1].txt;D[0]=tc.SPACE}}}}X5(_,A[0])}r=e.length;c.flags1=cj(c.flags1,tc.RFLAG1_PARA_ENDED);if(r>0){n=e.charCodeAt(r-1);if(n==Bn)c.flags1|=tc.RFLAG1_PARA_ENDED;if(n==tc.ROW_CHAR||n==TR){if(ui[_].tabw==null)xX(_);if(Nj(ui[_].tabw)){if(n==tc.ROW_CHAR)ui[_].tabw.type|=tc.INFO_ROW;else if(n==TR)ui[_].tabw.type|=tc.INFO_CELL}}X5(_,n);if(n==Bn||n==TR)ui[_].flags|=tc.LFLAG_PARA;if(f==tc.FIELD_TOC)ui[_].flags|=tc.LFLAG_TOC;if(f==tc.FIELD_LISTNUM)ui[_].flags|=tc.LFLAG_LISTNUM;if(f==tc.FIELD_AUTONUMLGL)ui[_].flags|=tc.LFLAG_AUTONUMLGL;if(f==tc.FIELD_TC)ui[_].flags2|=tc.LFLAG2_TC;if(f==tc.FIELD_SEQ)ui[_].flags2|=tc.LFLAG2_SEQ;c.PrevField=f;if(n==tc.PAGE_CHAR||n==tc.SECT_CHAR||n==tc.COL_CHAR||n==tc.ROW_CHAR||hj(n))ui[_].flags|=tc.LFLAG_BREAK;if(n==tc.SECT_CHAR)ui[_].flags|=tc.LFLAG_SECT;if(Nj(xs[i].style&tc.ENOTETEXT)){ui[_].flags2|=tc.LFLAG2_ENOTETEXT;aO|=tc.TOFLAG_UPDATE_ENOTE}else if(Nj(xs[i].style&tc.FNOTETEXT))ui[_].flags|=tc.LFLAG_FNOTETEXT;if(false&&Nj(xs[i].style&tc.FNOTETEXT)&&Nj(ui[_].flags&tc.LFLAG_PARA)&&_>0){for(s=_-1;s>=0;s--){if(Nj(ui[s].flags&tc.LFLAG_PARA)){ui[_].pfmt=ui[s].pfmt;break}}}if(Nj(ui[_].flags&tc.LFLAG_PARA)){s=_-1;while(s>=0&&Dj(ui[s].flags&(tc.LFLAG_PARA|tc.LFLAG_BREAK))){ui[s].pfmt=ui[_].pfmt;s--}}if(_>0&&n==TR&&ui[_].cid>0&&eR[ui[_].cid].PrevCell>0){R=ui[_].cid;var M;for(s=_-1;s>=0;s--){if(Nj(ui[s].tabw)&&Nj(ui[s].tabw.type&tc.INFO_CELL))break;if(ui[_].fid!=ui[s].fid)break;if(ui[s].cid==0){ui[s].cid=R;M=ui[s].pfmt;if(Dj(Nc[M].pflags&tc.PFLAG_CELL))ui[s].pfmt=cZ(M,tc.PPARAM_PFLAGS,Nc[M].pflags|tc.PFLAG_CELL)}}}if(c.TeVersion==18e3&&_>0&&ui[_].cid==0){L=ui[_-1].cid;if(L>0&&eR[L].level>=1&&eR[L].ParentCell>0){iw(_,1,gk("B"));ui[_].cid=eR[L].ParentCell;ui[_].flags=tc.LFLAG_PARA|tc.LFLAG_BREAK;if(ui[_].tabw==null)xX(_);if(Nj(ui[_].tabw))ui[_].tabw.type|=tc.INFO_ROW;Tm(_,0,1);l=ui[_].txt;l[0]=tc.ROW_CHAR;_++;c.InsLine=_;br++}}if(_>0&&n==TR&&ui[_].cid>0){R=ui[_].cid;var G;var B=eR[R].level;for(s=_-1;s>=0&&ui[s].cid>0;s--){C=ui[s].cid;G=eR[C].level;if(C==R)continue;if(G<=B)break;if(G==B+1&&B>=0)eR[C].ParentCell=R}}if(_>0&&n==tc.ROW_CHAR){F=0;var H;ui[_].pfmt=ui[_-1].pfmt;if(Kl>1){H=eR[ui[_].cid].row;for(s=_;s>=0;s--){if(Dj(C=ui[s].cid))break;if(eR[C].row!=H)break;if((F=ui[s].fid)>0)break}if(F>0){H=eR[ui[_].cid].row;for(s=_;s>=0;s--){if(Dj(C=ui[s].cid))break;if(eR[C].row!=H)break;ui[s].fid=F}}}}if(_>0&&ui[_-1].fid>0&&ui[_-1].fid!=ui[_].fid&&ui[_-1].len>0){r=ui[_-1].len;l=ui[_-1].txt;I=l[r-1];if(I!=Bn){iw(_,1,gk("B"));ui[_].cid=0;ui[_].flags=tc.LFLAG_PARA;Tm(_,0,1);l=ui[_].txt;l[0]=Bn;_++;c.InsLine=_;br++}}}r=ui[_].len;if(r>0){var m=",symbol,wingdings,wingdings 2,wingdings 3,webding,";var w=false;l=ui[_].txt;a=nb(_);var b=xs[a[0]].TypeFace.toLowerCase();if(m.indexOf(b)>=0)w=true;for(E=0;E<r;E++){var x=a[E];var y;if(xs[x].UcBase==0&&(xs[x].CharSet==2||w)){if(Tk(xs[x].TypeFace,"Wingdings 2")==0){if(l[E]==151){l[E]=61623;a[E]=xb(x,"Symbol",2,xs[x].lang);continue}else if(l[E]==163){l[E]=61603;continue}else if(l[E]==82){l[E]=61522;continue}else if(l[E]==83){l[E]=61523;continue}}var W=Py(x,l[E]);if(false&&W>=65535){I=Character.toChars(W);y=I[0];W=I[1];if(xs[x].UcBase!=y)x=Wb(x,y)}else x=yb(x,0,0);l[E]=W;a[E]=x}if(xs[x].CharSet==tc.MAC_CHARSET){I=l[E];if(I>=128&&I<=255){l[E]=Pk(l[E]);a[E]=yb(a[E],0,xs[a[E]].lang)}}a[E]=vy(a[E],l[E])}}if(_>0&&ui[_].cid>0&&ui[_-1].len>0){L=ui[_-1].cid;R=ui[_].cid;if(L==0||eR[L].level<eR[R].level){g=ui[_-1].len;P=ui[_-1].txt;n=P[g-1];var U=n>=tc.SPACE||n==tc.PICT_CHAR||n==tc.NBSPACE_CHAR||n==tc.NBDASH_CHAR;if(U){fw(_-1,g-1,1,tc.CHAR_A);g=ui[_-1].len;P=ui[_-1].txt;P[g-1]=Bn;if(n==tc.PICT_CHAR){d=nb(_-1);d[g-1]=0;d[g-1]=Db(d[g-1],tc.HIDDEN,true)}}}}if(Nj(c.TagId))C1(c,_);if(o){var k=io;S="Section"+mY(k);Bx(_,0,tc.TERTAG_SECT,S,null,io)}if(c.InXml&&ui[_].len>0){a=nb(_);r=ui[_].len;l=ui[_].txt;for(E=0;E<r;E++){if(l[E]==160&&xs[a[E]].UcBase==0){l[E]=tc.NBSPACE_CHAR}}}c.SomeTextRead=true;c.FirstTbLine=false;if(PR>0&&PR!=SR)c.TableTextFound=true;if(c.FieldId>0)c.FieldResultTextFound=true;c.TextLine=_;if(c.group[t.ShapeGroup].XmlShape.FirstLine==-1)c.group[t.ShapeGroup].XmlShape.FirstLine=c.group[t.ShapeGroup].XmlShape.LastLine=_;else c.group[t.ShapeGroup].XmlShape.LastLine=_;br++;return true}function f1(t,e){var r,i,f=0,l,a;var n,c;var s;var _,o,u;var T;var A;var E=false,R=false;var L=false,C=false,I=false;if(t.InXml)e.FieldId=t.FieldId;if(Nj(e.style&tc.FNOTEREST)&&Dj(e.style&tc.FNOTETEXT)&&mE>0&&mE<Ys){e.style=e.style&tc.FNOTEALL|xs[mE].style&tc.FNOTENONE;e.TextColor=xs[mE].TextColor;e.TextBkColor=xs[mE].TextBkColor;e.HilightColor=xs[mE].HilightColor;e.UlineColor=xs[mE].UlineColor;e.PointSize2=xs[mE].TwipsSize/10;e.TypeFace=xs[mE].TypeFace;mE=0}if((e.FieldId==tc.FIELD_TOC||Nj(iO&tc.TFLAG9_TOC_TO_TEXT))&&Nj(e.style&tc.ULINE)&&MJ(e.TextColor,new tc.Color(16711680))){e.style=cj(e.style,tc.ULINE);e.TextColor=tc.CLR_BLACK}if(ah==tc.RTF_CB&&MJ(e.TextColor,e.TextBkColor)&&e.TextColorUsesThemeColor){var d=e.TextBkColor;if(MJ(e.TextBkColor,tc.CLR_WHITE)){if(e.InTable&&PR>0)d=eR[PR].BackColor;else if(e.ParaFID>0)d=kl[e.ParaFID].BackColor}if(MJ(d,e.TextColor)){if(MJ(d,tc.CLR_WHITE)||MJ(d,tc.CLR_BLACK))e.TextColor=NJ(8421504);else if(!MJ(d,tc.CLR_WHITE))e.TextColor=tc.CLR_WHITE;else if(!MJ(d,tc.CLR_BLACK))e.TextColor=tc.CLR_BLACK;else e.TextColor=NJ(~pJ(d))}}o=e.TextAngle;if(PR>0){u=eR[PR].TextAngle;if(PR!=0&&u!=0)o=u}n=e.TypeFace;if(n.length==0)n=oi.FontTypeFace;i=e.PointSize2*10;if(i==0)i=12*20;if(i<Qs)i=Qs;if(qs>0&&i>qs)i=qs;A=e.CharSet;a=e.CharType;if(a==tc.CHAR_DB&&Dj(e.gflags2&tc.GFLAG2_HAS_LEAD)&&t.OutBufLen>0){if(t.OutBuf.charCodeAt(0)<256)a=tc.CHAR_LO}var F=false;I=false;if(t.OutBufHasUnicode&&t.OutBufLen>0){var g=false;var P=t.OutBuf.charCodeAt(0);F=S9(P);I=kq(P);if(true||a==tc.CHAR_DB){if(P>11776){var S=P;g=S>=11776&&S<=40879||S>=63744&&S<64255||S>=65072&&S<65103||S>=65280&&S<65519;if(!g){g=S>=19968&&S<=43007}}if(g)R=true;else E=true}else E=true;if(P>=44032&&P<=55215)L=true;if(P>=1536&&P<=1791)C=true;if(!C&&(P>=64336&&P<=65023))C=true;if(!C&&(P>=65136&&P<=65279))C=true}else if(a==tc.CHAR_HI||t.OutBuf!=null&&t.OutBuf.length>0&&t.OutBuf.charCodeAt(0)>=256)E=true;if(e.UseAsianTextFont)R=true;if(E&&(e.TypeFaceHi==null||e.TypeFaceHi.length==0))E=false;if(a==tc.CHAR_DB&&e.TypeFaceDB!=null&&e.TypeFaceDB.length>0&&!t.OutBufHasUnicode){R=true;E=false}if(E){n=e.TypeFaceHi;A=e.CharSetHi}else if(R){if(e.TypeFaceDB!="")n=e.TypeFaceDB;A=e.CharSetDB}if(e.rtlch&&e.TypeFaceCs.length>0){if(e.CharSetCs==tc.ARABIC_CHARSET||e.CharSetCs==tc.HEBREW_CHARSET){n=e.TypeFaceCs;A=e.CharSetCs;if(A==0)A=tc.GB2312_CHARSET}}if(e.rtlch&&A!=tc.ARABIC_CHARSET&&A!=tc.HEBREW_CHARSET){A=e.PrevCharSet;if(A!=tc.ARABIC_CHARSET&&A!=tc.HEBREW_CHARSET)A=e.CharSetHi;if(A!=tc.ARABIC_CHARSET&&A!=tc.HEBREW_CHARSET)A=e.CharSetDB;if(A!=tc.ARABIC_CHARSET&&A!=tc.HEBREW_CHARSET){if(C)A=tc.ARABIC_CHARSET;else A=tc.HEBREW_CHARSET}}else{if(L&&(A==tc.ANSI_CHARSET||A==ks))A=tc.HANGUL_CHARSET}if(I)A=tc.ARABIC_CHARSET;if(A==ks&&e.CharType==tc.CHAR_LO&&!E&&!R&&!e.rtlch)A=tc.ANSI_CHARSET;if((A==tc.SHIFTJIS_CHARSET||A==tc.GB2312_CHARSET)&&e.CharType==tc.CHAR_LO&&!E&&!R&&!e.rtlch){var h=Uk(t.OutBuf);for(r=0;r<t.OutBufLen;r++)if(h[r]>=128)break;if(r==t.OutBufLen)A=tc.ANSI_CHARSET}e.PrevCharSet=A;_=e.style;_=cj(_,$s);if(e.RowColStyle>=0&&e.RowColStyle<K_&&PR>0){var O=e.RowColStyle;if(Nj(W_[O].StyleMask&tc.BOLD)&&Nj(W_[O].style&tc.BOLD)){if(Nj(_&tc.BOLD))_=cj(_,tc.BOLD);else _|=tc.BOLD}}if(e.CharBorderWidth==0)_=cj(_,tc.CHAR_BOX);if(t.InitFieldId==tc.FIELD_TEXTBOX){if(Nj(t.InitStyle&tc.CHAR_BOX))_|=tc.CHAR_BOX;e.AuxId=t.InitAuxId}if(t.InitFieldId>0)l=t.InitFieldId;else l=e.FieldId;if(!MJ(e.CharPatBC,tc.CLR_WHITE))T=e.CharPatBC;else T=e.TextBkColor;if(!e.revised){e.InsRev=0;e.InsTime=null}if(!e.deleted){e.DelRev=0;e.DelTime=null}if(!e.FontChanged){e.FmtRev=0;e.FmtTime=null;e.FmtOrigFont=0}if(e.revised&&e.InsRev==0||e.deleted&&e.DelRev==0||e.FontChanged&&e.FmtRev==0){for(r=1;r<Al;r++)if(Tk(ul[r].name,"Unknown")==0)break;if(r==Al){r=j4();ul[r].name="Unknown";ul[r].InsColor=ul[r].DelColor=tc.Color.red}if(e.revised&&e.InsRev==0)e.InsRev=r;if(e.deleted&&e.DelRev==0)e.DelRev=r;if(e.FontChanged&&e.FmtRev==0)e.FmtRev=r}if(n=="")n=xs[0].TypeFace;if(i==0)i=xs[0].TwipsSize;if(F||A==tc.THAI_CHARSET){if(Tk(n,"Cordia New (Thai)")==0)n="Cordia New";if(Tk(n,"Arial")==0)n="Cordia New"}var v=0;if(l!=0&&t.FieldLocked)v=tc.FFLAG_FIELD_LOCKED;var p=e.AuxId;if(t.InXml&&t.FieldId==FIELD_TEXTBOX)p=t.FieldAuxId;for(r=0;r<Ys;r++){if(Dj(xs[r].InUse))continue;if(xs[r].TwipsSize!=i)continue;if(xs[r].style!=_)continue;if(xs[r].TextColor!=e.TextColor)continue;if(xs[r].TextBkColor!=T)continue;if(xs[r].HilightColor!=e.HilightColor)continue;if(xs[r].UlineColor!=e.UlineColor)continue;if(xs[r].CharStyId!=e.CharStyId)continue;if(xs[r].ParaStyId!=e.ParaStyId)continue;if(xs[r].expand!=e.expand)continue;if(xs[r].ScaleX!=e.CharScaleX)continue;if(xs[r].rtlch!=e.rtlch)continue;if(xs[r].flow!=e.CharFlow)continue;if(xs[r].lang!=e.lang)continue;if(xs[r].FieldId!=l)continue;if(xs[r].ProtExId!=t.ProtExId)continue;if(xs[r].AuxId!=p)continue;if(xs[r].CharId!=e.CharId)continue;if(xs[r].offset!=e.offset)continue;if(xs[r].TextAngle!=e.TextAngle)continue;if((xs[r].flags&tc.FFLAG_MASK)!=v)continue;if(xs[r].TempStyle!=0)continue;if(l>0&&!Cw(xs[r].FieldCode,t.FieldCode))continue;if(xs[r].CharSet!=A&&A!=ks)continue;if(Tk(xs[r].TypeFace,n)!=0)continue;if(xs[r].InsRev!=e.InsRev)continue;if(!Ak(xs[r].InsTime,e.InsTime))continue;if(xs[r].DelRev!=e.DelRev)continue;if(!Ak(xs[r].DelTime,e.DelTime))continue;if(xs[r].FmtRev!=e.FmtRev)continue;if(!Ak(xs[r].FmtTime,e.FmtTime))continue;if(xs[r].FmtOrigFont!=e.FmtOrigFont)continue;if(!Cb(xs[r].StoryIds,t.StoryIds))continue;break}f=r;if(f==Ys){for(r=0;r<Ys;r++)if(Dj(xs[r].InUse))break;f=r;if(f==Ys){if(false&&Ys==tc.MAX_FONTS)f=tc.DEFAULT_CFMT;else{if(Ys>=f_){var N=f_+f_/3+1;if(N<=Ys)N=Ys+1;Mx(N)}f=Ys;Ys++}}if(f!=tc.DEFAULT_CFMT){Fb(f);xs[f].InUse=true;xs[f].TypeFace=n;xs[f].TwipsSize=i;xs[f].TextColor=e.TextColor;xs[f].TextBkColor=T;xs[f].HilightColor=e.HilightColor;xs[f].UlineColor=e.UlineColor;xs[f].style=_;xs[f].FieldId=l;xs[f].ProtExId=t.ProtExId;xs[f].AuxId=p;xs[f].CharId=e.CharId;xs[f].lang=e.lang;xs[f].offset=e.offset;xs[f].TextAngle=e.TextAngle;xs[f].CharStyId=e.CharStyId;xs[f].ParaStyId=e.ParaStyId;xs[f].expand=e.expand;xs[f].ScaleX=e.CharScaleX;xs[f].rtlch=e.rtlch;xs[f].flow=e.CharFlow;xs[f].CharSet=A;xs[f].flags=v;if(Nj(l)&&Nj(t.FieldCode)){xs[f].FieldCode=t.FieldCode}else xs[f].FieldCode=null;if(t.StoryIds!=null){xs[f].StoryIds=t.StoryIds}else xs[f].StoryIds=null;c=e.FontFamily;if(E&&e.FontFamilyHi!=null&&e.FontFamilyHi.length>0)c=e.FontFamilyHi;c=e.FontFamily;if(E&&e.FontFamilyHi!=null&&e.FontFamilyHi.length>0)c=e.FontFamilyHi;if(Tk(c,"Roman")==0)s=tc.FF_ROMAN;else if(Tk(c,"swiss")==0)s=tc.FF_SWISS;else if(Tk(c,"modern")==0)s=tc.FF_MODERN;else if(Tk(c,"script")==0)s=tc.FF_SCRIPT;else if(Tk(c,"decor")==0)s=tc.FF_DECORATIVE;else s=tc.FF_DONTCARE;xs[f].FontFamily=s;xs[f].InsRev=e.InsRev;xs[f].InsTime=e.InsTime==null?null:e.InsTime.copy();xs[f].DelRev=e.DelRev;xs[f].DelTime=e.DelTime==null?null:e.DelTime.copy();xs[f].FmtRev=e.FmtRev;xs[f].FmtTime=e.FmtTime==null?null:e.FmtTime.copy();xs[f].FmtOrigFont=e.FmtOrigFont;var D=xs[f].CharSet;if(!Rx(Ti,f,true))f=tc.DEFAULT_CFMT;xs[f].CharSet=D}}return f}function l1(t,e){var r,i;var f;var l;var a;var n;a=t.rtf;if(Nj(t.gflags2&tc.GFLAG2_INCLUDEPICTURE_READ)){n1(a);t.gflags2=cj(t.gflags2,tc.GFLAG2_INCLUDEPICTURE_READ)}if(e.PictId>0)bT=r=e.PictId;else{if((r=Nx())==-1)return false;bT=r;if(Nj(t.gflags&tc.GFLAG_ANIM_SEQ))return X2(t,e,r)}if(-1==(n=g2(a)))return false;xs[bT].AuxId=t.AuxId;I1(n,t);Tm(n,0,1);f=ui[n].txt;f[0]=tc.PICT_CHAR;l=nb(n);l[0]=r;sb(n);ui[n].y=0;ui[n].x=0;if(PR<0)PR=0;ui[n].cid=PR;d1(n,t);if(e.PictId<=0)Y2(t,e,r);ui[n].height=xs[r].height;if(!t.revised){t.InsRev=0;t.InsTime=null}if(!t.deleted){t.DelRev=0;t.DelTime=null}if(!t.FontChanged){t.FmtRev=0;t.FmtTime=null;t.FmtOrigFont=0}xs[r].InsRev=t.InsRev;xs[r].InsTime=t.InsTime==null?null:t.InsTime.copy();xs[r].DelRev=t.DelRev;xs[r].DelTime=t.DelTime==null?null:t.DelTime.copy();xs[r].FmtRev=t.FmtRev;xs[r].FmtTime=t.FmtTime==null?null:t.FmtTime.copy();if(Nj(t.gflags2&tc.GFLAG2_IN_MATH_PICT))xs[r].ExpId=t.ExpId;if(Nj(t.gflags&tc.GFLAG_ANIM_INFO)){}var c=false;if(Dj(t.gflags&tc.GFLAG_IN_SHPRSLT)&&(t.shape.type==tc.SHPTYPE_PICT_FRAME||t.shape.type==tc.SHPTYPE_OCX))c=true;if(xs[r].PictType==tc.PICT_SHAPE&&!a.InXml)c=true;if(c){K2(t,r);a.PictFrameLine=n;a.PictFrameCol=0}if(Nj(a.TagId))C1(a,n);if(n>0&&ui[n-1].fid>0&&ui[n-1].fid!=ui[n].fid&&ui[n-1].len>0){i=ui[n-1].len;f=ui[n-1].txt;chr=f[i-1];if(chr!=Bn){iw(n,1,gk("B"));ui[n].cid=0;ui[n].flags=tc.LFLAG_PARA;Tm(n,0,1);f=ui[n].txt;f[0]=Bn;n++;a.InsLine=n;br++}}a.SomeTextRead=true;a.FirstTbLine=false;if(PR>0&&PR!=SR)a.TableTextFound=true;a.flags2|=tc.RFLAG2_FIELD_HAS_TEXT;a.flags1=cj(a.flags1,tc.RFLAG1_PARA_ENDED);if(a.FieldId>0)a.FieldResultTextFound=true;a.TextLine=n;if(Nj(t.XmgFlags&tc.XMGFLAG_IN_TEXT_BOX)){if(a.group[t.ShapeGroup].XmlShape.FirstLine==-1)a.group[t.ShapeGroup].XmlShape.FirstLine=a.group[t.ShapeGroup].XmlShape.LastLine=n;else a.group[t.ShapeGroup].XmlShape.LastLine=n}br++;return true}function a1(t,e){var r,i,f=-1,l=-1,a;if(t.ExistingHdrFtr)return false;if(br==0)return false;for(r=br-1;r>=0;r--){i=ui[r].pfmt;if(Dj(Nc[i].flags&tc.PAGE_HDR_FTR))return false;l=r;if(f>=0&&Nj(ui[r].flags&e))break;if(f<0&&Nj(ui[r].flags&e))f=r}if(r<0||f<0)return false;a=f-l+1;iw(l,a,tc.CHAR_D);br-=a;return true}function n1(t){var e;for(e=br-1;e>=0;e--){if(ui[e].len==1){var r=nb(e);var i=r[0];sb(e);if(Nj(xs[i].style&tc.PICT)){fw(e,0,1,tc.CHAR_D);gb(i);break}}}return true}function c1(t,e){var r,i,f;var l=[];var a=16,n;var c,s,_;l[0]=65535;l[1]=65280;l[2]=16776960;l[3]=16711935;l[4]=255;l[5]=16711680;l[6]=8388608;l[7]=8421376;l[8]=32768;l[9]=8388736;l[10]=128;l[11]=32896;l[12]=8421504;l[13]=12632256;l[14]=0;l[15]=16777215;for(n=0;n<a;n++)if(pJ(e)==l[n])return e;r=e.getRed();i=e.getGreen();f=e.getBlue();c=(r+i+f)/3;if(r==i&&r==f){if(r<5)r=i=f=0;else if(r<176)r=i=f=128;else if(r<216)r=i=f=192;else r=i=f=255}else if(r>128||i>128||f>128){if(c>128){s=50;_=(255-c)*s/128}else{s=75;_=(255-c)*s/255}c-=_;if(r>c)r=255;else r=0;if(i>c)i=255;else i=0;if(f>c)f=255;else f=0}else{s=3;_=(128-c)*s/128;c-=_;if(r>c)r=128;else r=0;if(i>c)i=128;else i=0;if(f>c)f=128;else f=0}return NJ(r,i,f)}function s1(t){var e=0;var r="";e=t.GroupLevel;while(true){if(!r2(t))return false;if(t.GroupBegin)continue;if(t.GroupEnd){if(t.GroupLevel<e)break;else continue}if(!t.IsControlWord&&r.length==0)r=t.CurWord}t.OvrStoryRtfId=0;if(r.length>0){var i,f=-1,l;l=LX(r);if(TE){for(i=1;i<Vn;i++)if(Yn[i].InUse&&Yn[i].type==tc.STORY_COMMENT&&Yn[i].RtfId==l)break;if(i<Vn){f=i;Yn[f].text=null;Yn[f].time=null}else return true}else if(f<0){f=zx();for(i=1;i<Vn;i++)if(Yn[i].InUse&&Yn[i].type==tc.STORY_COMMENT&&Yn[i].RtfId==l)break;if(i<Vn){var a=-9999;for(i=1;i<Vn;i++)if(Yn[i].InUse&&Yn[i].type==tc.STORY_COMMENT&&Yn[i].RtfId>a)a=Yn[i].RtfId;t.OvrStoryRtfId=a+1;if(t.OvrStoryRtfId==0)t.OvrStoryRtfId++}}if(f>0){Yn[f].InUse=true;Yn[f].type=tc.STORY_COMMENT;Yn[f].RtfId=LX(r);if(t.OvrStoryRtfId>0)Yn[f].RtfId=t.OvrStoryRtfId;Yn[f].time=null;t.StoryIds=Zx(f,t.StoryIds);t.StoryId=0}}return true}function _1(t){var e;var r=0;var i="";r=t.GroupLevel;while(true){if(!r2(t))return false;if(t.GroupBegin)continue;if(t.GroupEnd){if(t.GroupLevel<r)break;else continue}if(!t.IsControlWord&&i.length==0)i=t.CurWord}if(i.length>0){var f=LX(i);if(t.OvrStoryRtfId>0)f=t.OvrStoryRtfId;t.OvrStoryRtfId=0;for(e=1;e<Vn;e++)if(Yn[e].RtfId==f)break;if(e<Vn){t.StoryId=e;t.StoryIds=Qx(e,t.StoryIds)}}return true}function o1(t,e){var r,i=t.StoryId,f=0;var l=0;var a=false,n=false,c=true,s=false;var _=t.group;var o,u,T;var A=0,E=0;l=t.GroupLevel;if(i==0){if(t.OutBufLen>0)b1(t);i=zx();if(i>0){Yn[i].InUse=true;Yn[i].type=tc.STORY_COMMENT;Yn[i].RtfId=-1;Yn[i].time=null;t.StoryIds=Zx(i,t.StoryIds);t.StoryId=0;t.OutBuf=wY(tc.SPACE);t.OutBufLen=1;if(!b1(t))return false;t.StoryId=i;t.StoryIds=Qx(i,t.StoryIds);s=true}}if(i>0&&i<Vn&&Yn[i].InUse){if(e==tc.ANNOT_AUTH_ID)Yn[i].AuthorInit="";else if(e==tc.ANNOT_AUTH_NAME)Yn[i].author="";else if(e==tc.ANNOT_TEXT){Yn[i].text=null}}while(true){if(!r2(t))return false;if(t.GroupBegin)continue;if(t.GroupEnd){if(a&&t.GroupLevel<A)a=false;if(n&&t.GroupLevel<E)n=false;if(t.GroupLevel<l)break;else continue}if(t.IsControlWord){a=n=false;if(Tk(t.CurWord,"atnref")==0){A=t.GroupLevel;a=true}else if(Tk(t.CurWord,"atndate")==0){E=t.GroupLevel;n=true}else if(Tk(t.CurWord,"uc")==0)t.group[t.GroupLevel].UcIgnoreCount=t.IntParam;else if(Tk(t.CurWord,"u")==0){if(i>0&&i<Vn&&Yn[i].InUse){if(e==tc.ANNOT_AUTH_ID){o=t.IntParam;Yn[i].AuthorInit+=Wk(o)}else if(e==tc.ANNOT_AUTH_NAME){o=t.IntParam;Yn[i].author+=Wk(o)}else if(e==tc.ANNOT_TEXT){o=t.IntParam;var R=Wk(o);if(c){T=t.GroupLevel;t.OutBuf=R;t.OutBufLen=R.length;Yn[i].FontId=f1(t,t.group[t.GroupLevel]);t.OutBuf="";t.OutBufLen=0;c=false}if(Yn[i].text==null)Yn[i].text="";Yn[i].text+=R}f=t.group[t.GroupLevel].UcIgnoreCount}}else if(Tk(t.CurWord,"par")==0){if(e==tc.ANNOT_TEXT){var L=[13,10];if(Yn[i].text==null)Yn[i].text="";Yn[i].text+=Wk(L)}}else if(Tk(t.CurWord,"field")==0)y1(t);else if(Tk(t.CurWord,"bkmkstart")==0)y1(t);else if(Tk(t.CurWord,"bkmkend")==0)y1(t);else if(Tk(t.CurWord,"emdash")==0){u=8212;if(Dj(_[t.GroupLevel].style&tc.STRIKE))Yn[i].text+=Wk(u)}else if(Tk(t.CurWord,"endash")==0){u=8211;if(Dj(_[t.GroupLevel].style&tc.STRIKE))Yn[i].text+=Wk(u)}else if(Tk(t.CurWord,"lquote")==0){u=8216;if(Dj(_[t.GroupLevel].style&tc.STRIKE))Yn[i].text+=Wk(u)}else if(Tk(t.CurWord,"rquote")==0){u=8217;if(Dj(_[t.GroupLevel].style&tc.STRIKE))Yn[i].text+=Wk(u)}else if(Tk(t.CurWord,"ldblquote")==0){u=8220;if(Dj(_[t.GroupLevel].style&tc.STRIKE))Yn[i].text+=Wk(u)}else if(Tk(t.CurWord,"rdblquote")==0){u=8221;if(Dj(_[t.GroupLevel].style&tc.STRIKE))Yn[i].text+=Wk(u)}else if(Tk(t.CurWord,"strike")==0){T=t.GroupLevel;if(Nj(t.IntParam))_[T].style=_[T].style|tc.STRIKE;else{_[T].style=_[T].style&~tc.STRIKE;_[T].StyleOff|=tc.STRIKE}_[T].StyleMask|=tc.STRIKE}}else{if(a){var C,I=LX(t.CurWord);if(s)Yn[i].RtfId=I;else{for(C=1;C<Vn;C++)if(Yn[C].InUse&&Yn[C].RtfId==I)break;if(C<Vn)t.StoryId=i=C}a=false}else if(i>0&&i<Vn&&Yn[i].InUse){if(n){var d=LX(t.CurWord);var F=Nk(d,5,6);var g=Nk(d,10,5);var P=Nk(d,15,5);var S=Nk(d,19,4);var h=Nk(d,28,9)+1900;var O=new tc.ClsDate;try{O.dt=new Date(h,S-1,P,g,F,0,0)}catch(t){O.dt=new Date}Yn[i].time=O}else{var v="";if(f==0)v=t.CurWord;else{r=t.CurWord.length;if(r<=f){f-=r;continue}else v=cV(t.CurWord,f)}if(e==tc.ANNOT_AUTH_ID)Yn[i].AuthorInit+=v;else if(e==tc.ANNOT_AUTH_NAME)Yn[i].author+=v;else if(e==tc.ANNOT_TEXT){if(c){T=t.GroupLevel;t.OutBuf=v;t.OutBufLen=t.OutBuf.length;Yn[i].FontId=f1(t,t.group[t.GroupLevel]);t.OutBuf="";t.OutBufLen=0;c=false}if(Yn[i].text==null)Yn[i].text="";if(Dj(_[t.GroupLevel].style&tc.STRIKE))Yn[i].text+=v}}}}}if(e==tc.ANNOT_TEXT&&i>0&&(Yn[i].text==null||Yn[i].text==""))Yn[i].text=" ";if(e==tc.ANNOT_TEXT)t.StoryId=0;return true}function u1(t){var e;var r=0,i;var f;var l=t.group;r=t.GroupLevel;if(M_==0)M_=1;if(M_+1>G_){G_=M_+4;if(D_==null)D_=[G_+1]}D_[M_]=new tc.ClsExp;D_[M_].type=tc.MTYPE_EQU;t.exp=D_[M_];for(e=t.MathGroup;e<=r;e++)l[e].ExpId=M_;M_++;i=r;while(true){if(!r2(t))return tc.RTF_FILE_INCOMPLETE;if(t.GroupBegin)continue;if(t.GroupEnd){if(t.GroupLevel<i)break;if(t.GroupLevel<t.exp.RtfGroup&&t.exp.parent!=null)t.exp=t.exp.parent;continue}if(t.IsControlWord){r=t.GroupLevel;if(Tk(t.CurWord,"mr")==0){T1(t,tc.MTYPE_RUN);f="";f=t3(t);t.exp.text=f;if(xs[t.exp.FontId].CharSet==tc.GREEK_CHARSET){var a=xs[t.exp.FontId].CharSet;t.exp.text=_i.TerStrToUnicode(f,a)}t.exp=t.exp.parent}else if(Tk(t.CurWord,"mf")==0)T1(t,tc.MTYPE_FRAC);else if(Tk(t.CurWord,"mnum")==0)T1(t,tc.MTYPE_NUM);else if(Tk(t.CurWord,"mden")==0)T1(t,tc.MTYPE_DEN);else if(Tk(t.CurWord,"mrad")==0)T1(t,tc.MTYPE_RAD);else if(Tk(t.CurWord,"mdeg")==0)T1(t,tc.MTYPE_DEG);else if(Tk(t.CurWord,"me")==0)T1(t,tc.MTYPE_BASE);else if(Tk(t.CurWord,"mfunc")==0)T1(t,tc.MTYPE_FUNC);else if(Tk(t.CurWord,"mfname")==0)T1(t,tc.MTYPE_FUNC_NAME);else if(Tk(t.CurWord,"md")==0)T1(t,tc.MTYPE_DELIM_OBJ);else if(Tk(t.CurWord,"mssup")==0)T1(t,tc.MTYPE_SUP_OBJ);else if(Tk(t.CurWord,"msup")==0)T1(t,tc.MTYPE_SUP_ARG);else if(Tk(t.CurWord,"mssub")==0)T1(t,tc.MTYPE_SUB_OBJ);else if(Tk(t.CurWord,"msub")==0)T1(t,tc.MTYPE_SUB_ARG);else if(Tk(t.CurWord,"mnary")==0)T1(t,tc.MTYPE_NARY);else if(Tk(t.CurWord,"mdeghide")==0){f=t3(t);if(Tk(f,"on")==0)t.exp.flags|=tc.MFLAG_HIDE_DEG}else if(Tk(t.CurWord,"mgrow")==0){f=t3(t);if(Tk(f,"on")==0)t.exp.flags|=tc.MFLAG_GROW}else if(Tk(t.CurWord,"mtype")==0){f=t3(t);if(Tk(f,"noBar")==0)t.exp.flags|=tc.MFLAG_NO_BAR}else if(Tk(t.CurWord,"mchr")==0){f=t3(t);var n=Uk(f);if(f.length==2&&n[0]==162&&n[1]==178)t.exp.mark=8721;else if(f.length>0)t.exp.mark=n[0]}else{var c=r1(t);if(c!=0)return c;else continue}}else{T1(t,tc.MTYPE_RUN);t.exp.text=t.CurWord;t.exp=t.exp.parent}}return 0}function T1(t,e){var r=null;var i=t.exp;var f=t.group;var l=t.GroupLevel;if(i.ExpCount+1>i.MaxExpCount){i.MaxExpCount=i.ExpCount+4;if(i.exp==null)i.exp=[i.MaxExpCount+1]}if(i.exp==null)return null;r=i.exp[i.ExpCount]=new tc.ClsExp;r.type=e;r.parent=i;r.FontId=f1(t,f[l]);r.RtfGroup=l;i.ExpCount++;t.exp=r;return r}function A1(t){var e,r=-1;var i=0,f;var l;i=t.GroupLevel;while(true){if(!r2(t))return tc.RTF_FILE_INCOMPLETE;if(t.GroupBegin)continue;if(t.GroupEnd){if(t.GroupLevel<i)break;else continue}if(t.IsControlWord){for(e=0;e<tc.INFO_MAX;e++)if(Tk(LO[e],t.CurWord)==0)break;if(e==tc.INFO_MAX)continue;r=e;f=t.GroupLevel;CO[r]=t3(t)}}return 0}function E1(t){var e=-1;var r=0;r=t.GroupLevel;while(true){if(!r2(t))return tc.RTF_FILE_INCOMPLETE;if(t.GroupBegin)continue;if(t.GroupEnd){if(t.GroupLevel<r)break;else continue}if(t.IsControlWord){if(Tk(t.CurWord,"propname")==0){e=Mk();IO[e].name=t3(t)}else if(Tk(t.CurWord,"proptype")==0&&e>=0)IO[e].type=t.IntParam;else if(Tk(t.CurWord,"staticval")==0&&e>=0){IO[e].StaticVal=t3(t)}else if(Tk(t.CurWord,"linkval")==0&&e>=0){IO[e].LinkVal=t3(t)}}}return 0}function R1(t){var e,r,i;var f=0,l;var a="";f=l=t.GroupLevel;for(e=0;e<Al;e++)ul[e].RtfId=e;i=-1;while(true){if(!r2(t))return false;if(t.GroupBegin){l=t.GroupLevel;i++;a="";continue}if(t.GroupEnd){if(t.GroupLevel<f)break;else if(t.GroupLevel<l){if(i<0)continue;r=a.length;if(r>0&&a.charAt(r-1)==";")a=a.substring(0,r-1);if(Tk(a,"unknown")==0)a="";for(e=0;e<Al;e++)if(Tk(ul[e].name,a)==0)break;if(e==Al){e=j4();ul[e].name=a}ul[e].RtfId=i;continue}}if(!t.IsControlWord)a+=t.CurWord}return true}function L1(t,e,r){var i,f,l,a=0;var n;var c;var s=false,_;var o=0;t.HasIncompleteAsianChar=false;if(r.TypeFaceDB!=null&&r.TypeFaceDB.length>0&&r.CharType==tc.CHAR_DB)l=r.CharSetDB;else l=r.CharSet;pP="";if(l==2){pP=e;return false}pP=_i.TerStrToUnicode(e,l);var u=l==tc.GB2312_CHARSET||l==tc.CHINESEBIG5_CHARSET||l==tc.SHIFTJIS_CHARSET||l==tc.HANGUL_CHARSET;if(u&&pP.length>0){i=pP.length;var T=pP.charCodeAt(i-1);if(T==0){pP=pP.substring(0,i-1);t.HasIncompleteAsianChar=true}else if(pP.charAt(i-1)==gk("?")&&T!=o){pP=pP.substring(0,i-1);t.HasIncompleteAsianChar=true}}return true}function C1(t,e){if(ui[e].len==0)return true;var r=ub(e);r[0]=t.TagId;Tb(e);t.TagId=0;return true}function I1(t,e){var r;var i;var f,l,a=0;var n=false;r=e.rtf;r.flags2=cj(r.flags2,tc.RFLAG2_NEW_FRAME_CREATED);t:{if(Nj(e.gflags2&tc.GFLAG2_PICT_SHAPE))break t;if(Nj(e.gflags&tc.GFLAG_IN_SHPRSLT)||Nj(e.gflags&tc.GFLAG_USE_SHP_INFO)){if(e.shape.WrapType==tc.SWRAP_NO_WRAP)e.FrmFlags|=tc.PARA_FRAME_NO_WRAP;else if(e.shape.WrapType==tc.SWRAP_IGNORE)e.FrmFlags|=tc.PARA_FRAME_WRAP_IGNORE;else if(e.shape.WrapType==tc.SWRAP_THRU&&e.shape.type!=tc.SHPTYPE_TEXT_BOX)e.FrmFlags|=tc.PARA_FRAME_WRAP_IGNORE;else e.FrmFlags=cj(e.FrmFlags,tc.PARA_FRAME_NO_WRAP|tc.PARA_FRAME_WRAP_IGNORE);if(e.shape.WrapType!=tc.SWRAP_IGNORE&&e.shape.WrapType!=tc.SWRAP_THRU){}else if(Dj(e.FrmFlags&tc.PARA_FRAME_OBJECT)){e.gflags|=tc.GFLAG_DRAW_OBJECT;e.FrmFlags|=tc.PARA_FRAME_TEXT_BOX;e.FrmFlags|=tc.PARA_FRAME_CONV;if((e.shape.WrapType==tc.SWRAP_IGNORE||e.shape.WrapType==tc.SWRAP_THRU)&&e.shape.ZOrder==0)e.ParaFrameInfo.ZOrder=e.shape.ZOrder=-1}e.FrmFlags|=tc.PARA_FRAME_USED;if(Nj(e.gflags&tc.GFLAG_USE_SHP_INFO)){e.ParaFrameInfo=new tc.ClsRtfParaFrameInfo;e.ParaFrameInfo.x=e.shape.x;l=e.HPageGroup;r.group[l].ParaFrameInfo.x=e.shape.x;e.ParaFrameInfo.y=e.shape.y;e.ParaFrameInfo.width=e.shape.width;e.ParaFrameInfo.height=e.shape.height;e.ParaFrameInfo.ZOrder=e.shape.ZOrder;e.ParaFrameInfo.DistFromTextLeft=e.shape.DistFromTextLeft;e.ParaFrameInfo.DistFromTextRight=e.shape.DistFromTextRight;e.ParaFrameInfo.DistFromTextTop=e.shape.DistFromTextTop;e.ParaFrameInfo.DistFromTextBot=e.shape.DistFromTextBot}}else if(Nj(e.FrmFlags&tc.PARA_FRAME_OBJECT))e.FrmFlags|=tc.PARA_FRAME_WRAP_IGNORE;if(Nj(e.FrmFlags&tc.PARA_FRAME_USED)&&OR==0)r.flags|=tc.RFLAG_PARA_FRAME_FOUND;i=e.ParaFrameInfo.copy();if(Nj(e.FrmFlags&tc.PARA_FRAME_USED)&&Dj(e.gflags&tc.GFLAG_DRAW_OBJECT)){var c;var s;c=r.sect.PprWidth;if(!r.sect.IsPortrait)c=Math.max(r.sect.PprWidth,r.sect.PprHeight);c=c-r.sect.LeftMargin-r.sect.RightMargin;s=jV(c);if(Nj(e.FrmFlags&tc.PARA_FRAME_HPAGE)||Nj(e.shape.FrmFlags&tc.PARA_FRAME_HPAGE)){if(Nj(e.shape.FrmFlags&tc.PARA_FRAME_HPAGE))e.FrmFlags|=tc.PARA_FRAME_HPAGE;f=r.GroupLevel;l=r.group[f].HPageGroup;a=r.group[l].ParaFrameInfo.x;n=true;i.x=r.group[l].ParaFrameInfo.x-jV(r.sect.LeftMargin)}if(i.width==0&&Dj(e.FrmFlags&tc.PARA_FRAME_LINE)){if(Nj(e.FrmFlags&(tc.PARA_FRAME_CENTER|tc.PARA_FRAME_RIGHT_JUST)))i.width=s;else i.width=s+jV(r.sect.RightMargin)-i.x;if(i.width<tc.PARA_FRAME_MIN_WIDTH)i.width=tc.PARA_FRAME_MIN_WIDTH;e.FrmFlags|=tc.PARA_FRAME_SET_WIDTH}if(Nj(e.FrmFlags&(tc.PARA_FRAME_CENTER|tc.PARA_FRAME_RIGHT_JUST))){if(false&&Nj(e.FrmFlags&tc.PARA_FRAME_SET_WIDTH))i.x=s;else i.x=s-i.width;if(i.width<=0)i.x=s;if(Nj(e.FrmFlags&tc.PARA_FRAME_CENTER))i.x/=2}}if((!F1(i,bR)||Nj(r.flags&tc.RFLAG_NEW_FRAME))&&(r.InitialParaFID==0||t==r.FirstLine)){OR=0;r.InitialParaFID=0;xR=bR.copy();bR=i.copy();r.flags=cj(r.flags,tc.RFLAG_NEW_FRAME)}if(Dj(e.FrmFlags&tc.PARA_FRAME_USED))OR=0;if(Dj(OR)&&Nj(e.FrmFlags&tc.PARA_FRAME_USED)){if((OR=kW())>0){kl[OR].InUse=true;kl[OR].x=bR.x;kl[OR].OrgX=n?a:bR.x;kl[OR].GroupX=bR.x;kl[OR].ParaY=bR.y;kl[OR].GroupY=bR.y;kl[OR].OrgY=bR.y;kl[OR].width=bR.width;kl[OR].height=bR.height;kl[OR].MinHeight=bR.height;kl[OR].ZOrder=bR.ZOrder;kl[OR].DistFromTextLeft=bR.DistFromTextLeft;kl[OR].DistFromTextRight=bR.DistFromTextRight;kl[OR].DistFromTextTop=bR.DistFromTextTop;kl[OR].DistFromTextBot=bR.DistFromTextBot;kl[OR].BackColor=tc.Color.white;kl[OR].flags=e.FrmFlags;kl[OR].flags2=e.FrmFlags2;kl[OR].TextLine=t;kl[OR].LineColor=tc.Color.black;kl[OR].TextAngle=e.TextAngle;if(Nj(e.gflags&(tc.GFLAG_DRAW_OBJECT|tc.GFLAG_USE_SHP_INFO))){if(Nj(kl[OR].flags&tc.PARA_FRAME_TEXT_BOX)){kl[OR].margin=e.TextBoxMargin==-1?0:e.TextBoxMargin;kl[OR].TopMarg=e.TextBoxTopMarg==-1?0:e.TextBoxTopMarg;kl[OR].BotMarg=e.TextBoxBotMarg==-1?0:e.TextBoxBotMarg}else{kl[OR].margin=0;kl[OR].TopMarg=0;kl[OR].BotMarg=0}}else{kl[OR].margin=e.BorderMargin}if(Nj(e.gflags&tc.GFLAG_USE_SHP_INFO)){kl[OR].flags|=e.shape.FrmFlags;kl[OR].flags2|=e.shape.FrmFlags2;kl[OR].LineWdth=e.shape.LineWdth;kl[OR].LineColor=e.shape.LineColor;kl[OR].BackColor=e.shape.BackColor;kl[OR].FillPattern=e.shape.FillPattern;kl[OR].FillOpacity=e.shape.FillOpacity;kl[OR].LineOpacity=e.shape.LineOpacity}r.flags2|=tc.RFLAG2_NEW_FRAME_CREATED}}}e.ParaFID=OR;if(PR>0){var _=false;if(t>0&&ui[t-1].cid>0&&ui[t-1].fid==0&&ui[t-1].len>0){var o=ui[t-1].txt;if(o[0]!=tc.ROW_CHAR)_=true}if(_&&kl[OR].pict==0)OR=e.ParaFID=0}if(OR>0&&Nj(e.pflags&tc.PFLAG_PAGE_BREAK))e.ParaFID=OR=0;return true}function d1(t,e){var r,i,f,l,a,n;var c;var s;var _=e.ParaMask;var o=e.flow;s=e.rtf;if(PR<=0)s.CurTblStyle=0;if(false&&s.CurTblStyle>0&&s.DocParaMask!=0){if(Nj(s.DocParaMask&tc.PMASK_SPACING_BEF)&&s.DocParaProps.SpaceBefore==e.SpaceBefore)e.SpaceBefore=0;if(Nj(s.DocParaMask&tc.PMASK_SPACING_AFT)&&s.DocParaProps.SpaceAfter==e.SpaceAfter)e.SpaceAfter=0;if(Nj(s.DocParaMask&tc.PMASK_SPACING_BET)&&s.DocParaProps.SpaceBetween==e.SpaceBetween)e.SpaceBetween=0;if(Nj(s.DocParaMask&tc.PMASK_SPACING_LINE)&&s.DocParaProps.LineSpacing==e.LineSpacing)e.LineSpacing=0}r=YZ(0,e.tab);if(e.RtfLs>0){e.flags|=tc.BULLET;e.blt=(new tc.ClsBlt).init();e.blt.NumberType=tc.NBR_DEFAULT;var u=Q2(s,e.RtfLs);if(u==0)q2(s,e.RtfLs,$2(s))}e.blt.ls=Q2(s,e.RtfLs);if(e.blt.ls>0||Nj(e.flags&tc.BULLET)){e.blt.lvl=e.ListLvl;i=zZ(0,e.blt)}else{i=0;e.flags=cj(e.flags,tc.BULLET)}if(!e.ParaChanged){e.ParaFmtRev=0;e.ParaFmtTime=null;e.FmtOrigPara=0}if(t>=0){ui[t].tabw=null;ui[t].fid=OR}if(OR==0&&Dj(e.gflags&tc.GFLAG_IN_SHP))s.TableInFrame=false;c=e.pflags;if(Nj(OR))c|=tc.PFLAG_FRAME;if(s.InXml&&e.XmlShape.ShapeType==tc.SHPTYPE_TEXT_BOX)c|=tc.PFLAG_FRAME;if(t>=0&&Nj(ui[t].cid))c|=tc.PFLAG_CELL;if(t<0&&PR>0)c|=tc.PFLAG_CELL;f=e.BorderSpace[tc.BORDER_PARA_LEFT];l=e.BorderSpace[tc.BORDER_PARA_RIGHT];a=e.BorderSpace[tc.BORDER_PARA_TOP];n=e.BorderSpace[tc.BORDER_PARA_BOT];if(f==0)f=tc.PARA_BOX_SPACE;if(l==0)l=tc.PARA_BOX_SPACE;if(a==0)a=tc.PARA_BOX_SPACE;if(n==0)n=tc.PARA_BOX_SPACE;BorderWidth=0;if(Nj(e.flags&tc.PARA_BOX_LEFT))BorderWidth=e.BorderWidth[tc.BORDER_PARA_LEFT];else if(Nj(e.flags&tc.PARA_BOX_TOP))BorderWidth=e.BorderWidth[tc.BORDER_PARA_TOP];else if(Nj(e.flags&tc.PARA_BOX_RIGHT))BorderWidth=e.BorderWidth[tc.BORDER_PARA_RIGHT];else if(Nj(e.flags&tc.PARA_BOX_BOT))BorderWidth=e.BorderWidth[tc.BORDER_PARA_BOT];else if(Nj(e.flags&tc.PARA_BOX_BETWEEN))BorderWidth=e.BorderWidth[tc.BORDER_PARA_BETWEEN];if(Dj(e.flags&tc.PARA_BOX))BorderWidth=0;if(!s.InXml&&e.ParaStyId>=0&&Dj(e.ParaMask&tc.PMASK_FLOW)){var T=e.ParaStyId;if(Nj(W_[T].ParaMask&tc.PMASK_FLOW)){_|=tc.PMASK_FLOW;o=tc.FLOW_LTR}}var A=new tc.ClsPfmt;A.LeftIndentTwips=e.LeftIndent;A.RightIndentTwips=e.RightIndent;if(e.flow==tc.FLOW_RTL&&!s.InXml){A.LeftIndentTwips=e.LeftIndentFlow;A.RightIndentTwips=e.RightIndentFlow}A.FirstIndentTwips=e.FirstIndent;A.TabId=r;A.BltId=i;A.StyId=e.ParaStyId;A.shading=e.ParShading;A.pflags=c;A.SpaceBefore=e.SpaceBefore;A.SpaceAfter=e.SpaceAfter;A.SpaceBetween=e.SpaceBetween;A.LineSpacing=e.LineSpacing;A.BkColor=e.ParaBkColor;A.BorderColor=e.ParaBorderColor;A.BorderSpaceLeft=f;A.BorderSpaceRight=l;A.BorderSpaceTop=a;A.BorderSpaceBot=n;A.BorderWidth=BorderWidth;A.flow=o;A.flags=e.flags;A.AuxId=e.ParaAuxId;A.TextVAlign=e.TextVAlign;A.FmtRev=e.ParaFmtRev;A.FmtTime=e.ParaFmtTime==null?null:e.ParaFmtTime.copy();A.FmtOrigPara=e.FmtOrigPara;A.OutlineLevel=e.OutlineLevel;A.mask=_;A.mask2=e.ParaMask2;var E=QZ(0,A);if(t>=0)ui[t].pfmt=E;return E}function F1(t,e){if(t.x!=e.x)return false;if(t.y!=e.y)return false;if(t.width!=e.width)return false;if(t.height!=e.height)return false;if(t.ZOrder!=e.ZOrder)return false;if(t.DistFromTextLeft!=e.DistFromTextLeft)return false;if(t.DistFromTextRight!=e.DistFromTextRight)return false;if(t.DistFromTextTop!=e.DistFromTextTop)return false;if(t.DistFromTextBot!=e.DistFromTextBot)return false;return true}function g1(t){var e=S1(t,jV(t.sect.PprWidth),jV(t.sect.PprHeight));t.sect.PprKind=wP;return true}function P1(t){var e=S1(t,t.PaperWidth,t.PaperHeight);Pu=wP;return e}function S1(t,e,r){wP=null;var i;e=e/20;r=r/20;for(i=0;i<tg.DefPaperCount;i++){var f=tg.DefPaperWidth[i]*72;var l=tg.DefPaperHeight[i]*72;if(Math.abs(e-f)<1&&Math.abs(r-l)<1||Math.abs(e-l)<1&&Math.abs(r-f)<1){wP=new tc.Paper;wP.setSize(f,l)}}if(i==tg.DefPaperCount){wP=new tc.Paper;wP.setSize(e,r);t.ApplyPaperSize=true}return true}function h1(t,e){var r;r=t.GroupLevel;e[r].CharMask=0;e[r].StyleMask=0;e[r].TypeFace=xs[0].TypeFace;e[r].TypeFaceDB="";e[r].TypeFaceHi="";e[r].TypeFaceCs="";e[r].PointSize2=xs[0].TwipsSize/10;e[r].TextColor=xs[0].TextColor;if(ah<tc.RTF_CB&&e[r].TextColor==tc.Color.black)e[r].TextColor=tc.CLR_AUTO;e[r].TextColorUsesThemeColor=false;e[r].TextBkColor=tc.CLR_WHITE;e[r].HilightColor=tc.CLR_WHITE;e[r].UlineColor=tc.CLR_AUTO;e[r].style=e[r].style&tc.FNOTEALL;e[r].StyleOff=0;e[r].CharStyId=1;e[r].CharSet=ks;e[r].CharType=tc.CHAR_NORMAL;e[r].TypeFaceDB="";e[r].FontFamilyDB="";e[r].CharSetDB=0;e[r].TypeFaceHi="";e[r].FontFamilyHi="";e[r].CharSetHi=0;e[r].UseAsianTextFont=false;if(e[r].FieldId!=tc.FIELD_TEXTBOX)e[r].AuxId=0;e[r].lang=t.lang;e[r].offset=0;e[r].expand=0;e[r].CharScaleX=0;e[r].CharBorderWidth=0;e[r].rtlch=false;e[r].CharFlow=tc.FLOW_DEF;HR=false;e[r].caps=false;e[r].gflags=cj(e[r].gflags,tc.GFLAG_CAPS);e[r].CharBkPat=tc.PAT_NONE;e[r].CharPatFC=e[r].TextColor;e[r].CharPatBC=e[r].TextBkColor;if(ah<tc.RTF_CB||!Z_){e[r].revised=false;e[r].deleted=false;e[r].FontChanged=false}e[r].StyleMask=2147483647;e[r].CharMask=2147483647;return true}function O1(t,e){if(e.TypeFace.length>0)return false;if(e.PointSize2!=0)return false;if(e.TextColor!=xs[0].TextColor&&e.TextColor!=tc.CLR_AUTO)return false;if(e.TextBkColor!=tc.CLR_WHITE)return false;if(e.HilightColor!=tc.CLR_WHITE)return false;if(e.UlineColor!=tc.CLR_AUTO)return false;if(Nj(e.style&~tc.FNOTEALL))return false;if(e.CharStyId!=1)return false;if(e.CharSet!=ks)return false;if(e.AuxId!=0)return false;if(e.lang!=t.lang)return false;if(e.offset!=0)return false;if(e.CharBkPat!=tc.PAT_NONE)return false;if(e.CharPatFC!=e.TextColor)return false;if(e.CharPatBC!=e.TextBkColor)return false;return true}function v1(t,e){var r,i;var f;var l;var a;r=t.GroupLevel;l=Nj(e[r].style&tc.FNOTEALL);if(t.InitialCell==0&&!l&&Dj(e[r].gflags&tc.GFLAG_IN_NESTTABLEPROPS)){a=br>0&&ui[br-1].cid>0&&!GY(br-1,tc.INFO_ROW);if(a&&br>0&&Dj(ui[br-1].flags&(tc.LFLAG_PARA|tc.LFLAG_BREAK)))a=false;if(!a)e[r].InTable=false}if(!e[r].InTable)t.CellFlow=tc.FLOW_DEF;e[r].ParaMask=0;e[r].ParaMask2=0;e[r].LeftIndent=0;e[r].RightIndent=0;e[r].LeftIndentFlow=0;e[r].RightIndentFlow=0;e[r].FirstIndent=0;e[r].flags=BR;e[r].ParaBorderColor=tc.CLR_AUTO;e[r].flow=tc.FLOW_DEF;e[r].tab.count=0;e[r].BorderMargin=0;e[r].ParShading=0;e[r].CellShading=0;e[r].CellPatBC=tc.CLR_WHITE;e[r].CellPatFC=tc.Color.black;e[r].CellBorderType=tc.BRDRTYPE_NONE;e[r].CellColSpan=1;e[r].SpaceBefore=0;e[r].SpaceAfter=0;e[r].SpaceBetween=0;e[r].LineSpacing=0;e[r].ParaBkColor=tc.CLR_WHITE;e[r].RtfLs=0;e[r].ListLvl=0;e[r].OutlineLevel=-1;if(!l)e[r].ParaStyId=0;if(Dj(t.flags1&tc.RFLAG1_SSSUBTABLE_USED)&&!l&&(!e[r].InTable||t.InitialCell>0))e[r].level=NR;f=tc.PFLAG_STYLES;Nj(e[r].pflags&=~f);if(t.SetWidowOrphan)e[r].pflags|=tc.PFLAG_WIDOW;if(t.InitialParaFID==0&&Dj(e[r].gflags&(tc.GFLAG_DO_TEXT_READ|tc.GFLAG_IN_SHP))&&!l){a=br>0&&ui[br-1].cid>0&&!GY(br-1,tc.INFO_ROW);if(!a){e[r].ParaFrameInfo=new tc.ClsRtfParaFrameInfo;e[r].FrmFlags=0;e[r].TextBoxMargin=0;e[r].TextBoxTopMarg=0;e[r].TextBoxBotMarg=0;e[r].ParaFID=0;e[r].TextAngle=0;e[r].gflags=cj(e[r].gflags,tc.GFLAG_NEW_FRAME|tc.GFLAG_IN_FRAME)}}for(i=0;i<tc.MAX_BORDERS;i++){e[r].BorderWidth[i]=0;e[r].BorderColor[i]=tc.CLR_AUTO}if(ah<tc.RTF_CB||!Z_){e[r].ParaChanged=false}return true}function p1(t){var e,r,i=0,f=-1,l=-1,a=-1,n=-1,c,s;var _=false,o=true;for(r=$E[t].FirstCell;r>0;r=eR[r].NextCell){if(!_&&Dj(eR[r].flags&tc.CFLAG_PREEXIST))_=true;if(_&&Nj(eR[r].flags&tc.CFLAG_PREEXIST)){o=true;f=r;_=false}if(_)i++;else if(o){if(i>0){l=r;i--}}}if(br>=0&&br<Ri&&ui[br].cid==f){for(e=br;e<Ri;e++){r=ui[e].cid;if(r==0||GY(e,tc.INFO_ROW))break;if(a<0)a=e;n=e;if(r==l&&GY(e,tc.INFO_CELL))break}}if(a>0){iw(a,n-a+1,tc.CHAR_D);for(r=f;r>0;r=eR[r].NextCell){eR[r].InUse=false;if(r==l)break}c=eR[f].PrevCell;s=eR[l].NextCell;if(c>0)eR[c].NextCell=s;if(s>0)eR[s].PrevCell=c;br=a;if(br>=Ri)br=Ri-1;if(GY(br,tc.INFO_ROW)){ui[br].cid=ui[br-1].cid;br++}}return true}function N1(t,e){var r,i,f;var l=0,a=0,n,c,s;var _=false;var o=false,u=false;var T=0;if(Nj(lO&tc.TFLAG11_NO_PREF_WIDTH_CALC))return true;for(f=$E[e].FirstCell;f>0;f=eR[f].NextCell){T+=eR[f].width;if(rR[f].clftsWidth!=0)break}if(f<=0){if(Nj($E[e].flags&tc.ROWFLAG_PCT_WIDTH)&&Nj($E[gR].flags&tc.ROWFLAG_AUTO_FIT)){$E[e].PrefWidth=0;$E[e].FixWidth=-$E[e].FixWidth/50}else if(Nj($E[e].flags&tc.ROWFLAG_TWIPS_WIDTH)&&$E[e].PrefWidth>0&&$E[e].PrefWidth!=T){var A=$E[e].PrefWidth;for(f=$E[e].FirstCell;f>0;f=eR[f].NextCell){eR[f].width=Mj(eR[f].width,A,T);if(Nj($E[e].flags&tc.ROWFLAG_AUTO_FIT))eR[f].FixWidth=eR[f].width}}if(Dj($E[e].flags&tc.ROWFLAG_PCT_WIDTH))return true}if(Nj($E[e].flags&tc.ROWFLAG_TWIPS_WIDTH)&&$E[e].PrefWidth>0){TotalCellXWidth=0;TotalCellPrefWidth=0;for(f=$E[e].FirstCell;f>0;f=eR[f].NextCell){if(rR[f].clftsWidth!=3)break;TotalCellPrefWidth+=rR[f].clwWidth;TotalCellXWidth+=rR[f].XWidth}if(f<=0){if(TotalCellXWidth==$E[e].PrefWidth&&TotalCellPrefWidth!=$E[e].PrefWidth){for(f=$E[e].FirstCell;f>0;f=eR[f].NextCell){eR[f].width=rR[f].XWidth}return true}}}if(Nj($E[e].flags&tc.ROWFLAG_PCT_WIDTH)){r=$E[e].FirstCell;if(eR[r].level==0){var E=0;if(t.group[t.GroupLevel].shape.type==tc.SHPTYPE_TEXT_BOX)E=t.group[t.GroupLevel].shape.width;else{var R=t.sect.PprWidth;if(!t.sect.IsPortrait)R=Math.max(t.sect.PprWidth,t.sect.PprHeight);R=R-t.sect.LeftMargin-t.sect.RightMargin;if(t.sect.columns>1)R=(R-(t.sect.columns-1)*t.sect.ColumnSpace)/t.sect.columns;E=jV(R)}$E[e].FixWidth=$E[e].PrefWidth=Mj(E,$E[e].PrefWidth,5e3);$E[e].flags=cj($E[e].flags,tc.ROWFLAG_PCT_WIDTH);$E[e].flags|=tc.ROWFLAG_TWIPS_WIDTH}else{$E[e].PrefWidth=0;$E[e].FixWidth=-$E[e].FixWidth/50;$E[e].flags|=tc.ROWFLAG_AUTO_WIDTH_RTF;FR=true;return true}o=true}if(Dj($E[e].flags&tc.ROWFLAG_TWIPS_WIDTH))$E[e].FixWidth=$E[e].PrefWidth=0;r=i=$E[e].FirstCell;if(Dj($E[e].flags&tc.ROWFLAG_TWIPS_WIDTH)||$E[e].PrefWidth==0){if(Nj($E[e].flags&tc.ROWFLAG_NO_PREF_WIDTH)){for(f=r;f>0;f=eR[f].NextCell){if(eR[f].width<2*eR[f].margin+tc.RULER_TOLERANCE)eR[f].width=2*eR[f].margin+tc.RULER_TOLERANCE}}return true}s=0;c=0;_=true;u=true;for(f=r;f>0;f=eR[f].NextCell){if(rR[f].clftsWidth!=3)_=false;if(rR[f].clftsWidth!=2)u=false;if(rR[f].clftsWidth==2&&rR[f].clwWidth>0){eR[f].width=Mj($E[e].FixWidth,rR[f].clwWidth,5e3);c+=eR[f].width;s+=rR[f].clwWidth}else{a+=eR[f].width;i=f;l++}if(f==hR){eR[f].NextCell=-1;break}}if(s>5e3||s!=5e3&&u){c=0;for(f=r;f>0;f=eR[f].NextCell){if(rR[f].clftsWidth==2&&rR[f].clwWidth>0){eR[f].width=Mj(eR[f].width,5e3,s);if(eR[f].width<0)eR[f].width=0;c+=eR[f].width}}}if(a<=0){if(l>0){for(f=r;f>0;f=eR[f].NextCell){if(rR[f].clftsWidth==2&&rR[f].clwWidth>0)continue;eR[f].width=$E[e].PrefWidth/l;if(i==f)break}}return true}if(a>=0&&a<=$E[e].PrefWidth&&_&&!o)return true;n=$E[e].PrefWidth-c-a;if(n==0)return true;if(false&&n>0)eR[i].width+=n;else{if(false&&eR[i].width>-n)eR[i].width-=n;else{var L,C=0;for(f=r;f>0;f=eR[f].NextCell){if(rR[f].clftsWidth==2&&rR[f].clwWidth>0)continue;if(f==i||eR[f].NextCell<=0)eR[f].width+=n-C;else{L=Mj(n,eR[f].width,a);eR[f].width+=L;C+=L}}}}return true}function D1(t,e,r){var i,f,l,a,n;var c;if(Nj(t.flags&(tc.RFLAG_OUT_OF_TABLE_CELL|tc.RFLAG_OUT_OF_TABLE_ROW)))return true;if(false&&t.InitialCell>0&&!t.PastingColumn){PR=gR=0;e[r].InTable=false}if(gR<=0)return G1(t,e,r);i=$E[gR].NextRow;if(t.PastingColumn&&i<=0&&t.InitTblCol>=0){t.SuspendReading=true;return true}if(i<=0&&(i=b8())<0){QY(tc.MSG_OUT_OF_ROW_SLOT,"CopyRtfRow");t.flags|=tc.RFLAG_OUT_OF_TABLE_ROW;return true}f=gR;gR=i;if(Nj(eO&tc.TFLAG7_FORCE_RTL_TABLE))$E[i].flow=tc.FLOW_RTL;c=t.PastingColumn&&t.InitTblCol>=0&&Nj($E[gR].flags&tc.ROWFLAG_PREEXIST);if(!c){var s=Nj($E[f].flags&tc.ROWFLAG_LAST_ROW);$E[i]=$E[f].copy();tR[i]=tR[f].copy();$E[f].NextRow=i;$E[i].PrevRow=f;$E[i].NextRow=-1;$E[i].flags=cj($E[i].flags,tc.ROWFLAG_PREEXIST|tc.ROWFLAG_NEW_TABLE|tc.ROWFLAG_LAST_ROW);$E[i].flags=cj($E[i].flags,tc.ROWFLAG_HDR);tR[i].flags=cj(tR[i].flags,tc.TAUX_HAS_NEW_TEXT);tR[i].flags|=tc.TAUX_COPIED|tc.TAUX_RTF_DEL;if(s)$E[i].flags|=tc.ROWFLAG_NEW_TABLE}n=$E[f].FirstCell;while(n>0&&Nj(eR[n].flags&tc.CFLAG_PREEXIST))n=eR[n].NextCell;if(n<=0)n=$E[f].FirstCell;a=-1;if(c){if(t.InitTblCol==0)a=-1;else{var _=t.InitTblCol;a=$E[i].FirstCell;while(_>1&&eR[a].NextCell>0){_-=eR[a].ColSpan;a=eR[a].NextCell}}}else $E[i].FirstCell=$E[i].LastCell=-1;PR=hR=0;while(n>0&&Dj(eR[n].flags&tc.CFLAG_PREEXIST)){if((l=x8(false))<=0){QY(tc.MSG_OUT_OF_CELL_SLOT,"CopyRtfRow");t.flags|=tc.RFLAG_OUT_OF_TABLE_CELL;return true}Q6(n,l);eR[l].row=i;eR[l].RowSpan=eR[l].ColSpan=1;rR[l].flags=cj(rR[l].flags,tc.CAUX_CLOSED);if(eR[l].level>0)eR[l].flags=cj(eR[l].flags,tc.CFLAG_MERGED);J6(l,a,i,tc.CHAR_A);a=l;if(PR==0)PR=l;hR=l;if(Nj(eR[n].flags&tc.CFLAG_MERGED))n=M1(t,n);else n=eR[n].NextCell}if(t.PastingColumn&&t.InitTblCol>=0&&Nj($E[f].flags&tc.ROWFLAG_PREEXIST)){if(PR>0&&eR[PR].PrevCell>0)t.InsertAftCell=eR[PR].PrevCell;else t.InsertAftCell=$E[f].LastCell}else t.InitTblCol=-1;t.PrevCellX=0;return true}function M1(t,e){var r;var i=eR[e].PrevCell;var f=eR[e].NextCell;var l=eR[e].row;if(i<0)i=0;if(f<0)f=0;if(i<=0)return f;if(i>0){eR[i].NextCell=f;if(true||!t.InXml)eR[i].width+=eR[e].width;if(!t.InXml)rR[i].XWidth+=rR[e].XWidth;eR[i].ColSpan++;eR[i].border=cj(eR[i].border,tc.BORDER_RIGHT);eR[i].border|=eR[e].border&tc.BORDER_RIGHT;eR[i].BorderWidth[tc.BORDER_INDEX_RIGHT]=eR[e].BorderWidth[tc.BORDER_INDEX_RIGHT];eR[i].BorderColor[tc.BORDER_INDEX_RIGHT]=eR[e].BorderColor[tc.BORDER_INDEX_RIGHT]}if(f>0)eR[f].PrevCell=i;if($E[l].FirstCell==e)$E[l].FirstCell=f;if($E[l].LastCell==e)$E[l].LastCell=i;for(r=0;r<Ri;r++){if(ui[r].cid==i){var a=ui[r].len;if(a>0&&ui[r].txt[a-1]==TR){if(r+1<Ri&&ui[r+1].cid==e&&GY(r+1,tc.INFO_CELL)){var n=nb(r);var c=n[a-1];var s=ui[r+1].len;n=nb(r+1);n[s-1]=c}jx(r,a-1);Tm(r,a,a-1)}}if(ui[r].cid==e){ui[r].cid=i;if(r>0)ui[r].pfmt=ui[r-1].pfmt}}Z6(e);return f}function G1(t,e,r){var i,f,l,a;var n;var c;if(Nj(t.flags&(tc.RFLAG_OUT_OF_TABLE_CELL|tc.RFLAG_OUT_OF_TABLE_ROW)))return true;if(t.InitialCell>0&&!t.PastingColumn){var s=eR[t.InitialCell].level;var _=PR>0?eR[PR].level:0;if(s==_){PR=gR=0;e[r].InTable=false}}if(t.OpenRowId>0)e1(t,t.OpenRowId);t.OpenRowId=0;if(Nj(tR[gR].flags&tc.TAUX_TROWD_DONE)){var o=$E[gR].FirstCell;while(o>0&&Nj(eR[o].flags&tc.CFLAG_PREEXIST))o=eR[o].NextCell;if(o<=0||eR[o].PrevCell<=0)hR=0;else hR=eR[o].PrevCell;for(a=0;a<tc.MAX_BORDERS;a++){e[r].BorderWidth[a]=0;e[r].BorderColor[a]=tc.CLR_AUTO}e[r].CellShading=0;e[r].CellPatBC=tc.CLR_WHITE;e[r].CellPatFC=tc.Color.black;e[r].CellColSpan=1;e[r].TextAngle=0;e[r].CellBorderType=tc.BRDRTYPE_NONE;e[r].ClLeftPad=e[r].ClRightPad=e[r].ClTopPad=e[r].ClBotPad=-1;e[r].ClPadFlags=0;tR[gR].flags|=tc.TAUX_REUSE_CELL_CHAIN;$E[gR].CellMargin=0;$E[gR].AddedIndent=0;$E[gR].LeftPad=$E[gR].RightPad=$E[gR].TopPad=$E[gR].BotPad=-1;return true}i=gR;if(i>0){var u=false;if(Nj(tR[i].flags&tc.TAUX_HAS_NEW_TEXT))tR[i].flags|=tc.TAUX_REUSE_CELL_CHAIN;else{n=$E[i].FirstCell;while(n>0){if(Dj(eR[n].flags&tc.CFLAG_PREEXIST))z6(n);n=eR[n].NextCell}}if($E[i].FirstCell<=0){f=$E[i].PrevRow;l=$E[i].NextRow;$E[i]=new tc.ClsTableRow;$E[i].init();tR[i]=new tc.ClsTableAux;$E[i].InUse=true;$E[i].PrevRow=f;$E[i].NextRow=l;$E[i].flags=cj($E[i].flags,tc.ROWFLAG_PREEXIST);$E[i].CellMargin=0;$E[i].AddedIndent=0;$E[i].LeftPad=$E[i].RightPad=$E[i].TopPad=$E[i].BotPad=-1;tR[i].RowBand=-2}u=t.InitialCell>0&&t.PastingColumn;if(!u)$E[i].MinHeight=0}else if((i=b8())>0){$E[i].InUse=true;f=gR;gR=i;if(f>0){$E[f].NextRow=i;$E[i].PrevRow=f}else $E[i].PrevRow=-1;$E[i].FirstCell=-1;$E[i].NextRow=-1;$E[i].CellMargin=0;$E[i].AddedIndent=0;$E[i].LeftPad=$E[i].RightPad=$E[i].TopPad=$E[i].BotPad=-1;tR[i].RowBand=-2;e[r].RowBand=-2;if(Nj(t.flags1&tc.RFLAG1_FIRST_TABLE)){var T=(t.InitialCell==0||t.EmbedTable)&&Dj(rO&tc.TFLAG8_MERGE_TABLES_ON_PASTE);if(!TE&&T)$E[i].flags|=tc.ROWFLAG_NEW_TABLE;t.flags1=cj(t.flags1,tc.RFLAG1_FIRST_TABLE)}}if(Nj(eO&tc.TFLAG7_FORCE_RTL_TABLE))$E[i].flow=tc.FLOW_RTL;c=t.PastingColumn&&t.InitTblCol>=0&&Nj($E[i].flags&tc.ROWFLAG_PREEXIST);if(Dj(tR[i].flags&tc.TAUX_HAS_NEW_TEXT))PR=0;hR=0;if(c){var A=t.InitTblCol;if(A>0){hR=$E[i].FirstCell;while(A>1&&eR[hR].NextCell>0){A-=eR[hR].ColSpan;hR=eR[hR].NextCell}}}for(a=0;a<tc.MAX_BORDERS;a++){e[r].BorderWidth[a]=0;e[r].BorderColor[a]=tc.CLR_AUTO}e[r].CellShading=0;e[r].CellPatBC=tc.CLR_WHITE;e[r].CellPatFC=tc.Color.black;e[r].CellColSpan=1;e[r].TextAngle=0;e[r].CellBorderType=tc.BRDRTYPE_NONE;e[r].ClLeftPad=e[r].ClRightPad=e[r].ClTopPad=e[r].ClBotPad=-1;e[r].ClPadFlags=0;e[r].TblInd=0;e[r].TblIndType=0;e[r].RowSpaceBef=0;e[r].RowSpaceBefType=0;tR[gR].flags|=tc.TAUX_TROWD_DONE;t.TableRead=true;return true}function B1(t,e,r){cr=0;if(Nj(e[r].FrmFlags&tc.PARA_FRAME_USED))t.TableInFrame=true;e[r].RowColStyle=-1;if(ah>=tc.RTF_CB&&ah!=tc.RTF_CB_APPEND&&Dj(t.flags1&tc.RFLAG1_TEXT_FOUND)&&PR==0&&br>0&&ui[br-1].len>0&&ui[br-1].cid==0&&Dj(ui[br-1].flags&(tc.LFLAG_PARA|tc.LFLAG_BREAK))){t.OutBuf+=wY(Bn);t.OutBufLen++;cO|=tc.TOFLAG3_USE_PREV_PFMT;if(!b1(t)){cr=tc.RTF_END_FILE;return false}}if(t.PastingColumn&&t.SomeTextRead&&Dj(t.TableRead)){t.SuspendReading=true;oV();return false}if(Dj(e[r].gflags&tc.GFLAG_IN_NESTTABLEPROPS)&&Dj(t.flags1&tc.RFLAG1_SSSUBTABLE_USED)){e[r].level=NR+1;if(!t.EmbedTable)e[r].level--;if(t.CurTblLevel!=e[r].level)b2(t,r,e[r].level,t.CurTblLevel)}if(Nj(e[r].gflags2&tc.GFLAG2_NESTPROP_BEF_NESTCELL)&&Dj(t.flags1&tc.RFLAG1_SSSUBTABLE_USED)){if(t.CurTblLevel!=e[r].level)b2(t,r,e[r].level,t.CurTblLevel)}if(!G1(t,e,r)){cr=tc.RTF_SYNTAX_ERROR;return false}t.SkipSpaces=true;return true}function H1(t,e,r){var i,f=0,l=0,a,n,c,s,_,o;var u,T;var A=false;var E;if(e[r].clftsWidth==1){if(gR<=0||Dj($E[gR].flags&tc.ROWFLAG_AUTO_FIT)){e[r].clftsWidth=0;e[r].clwWidth=0}}f=u=e[r].clwWidth;l=T=e[r].clftsWidth;e[r].clwWidth=0;e[r].clftsWidth=0;if(Nj(t.flags&(tc.RFLAG_OUT_OF_TABLE_CELL|tc.RFLAG_OUT_OF_TABLE_ROW)))return true;if(gR==0){if(t.OpenRowId>0){gR=t.OpenRowId;PR=t.OpenCellId;hR=t.OpenLastCellX}else{if(!B1(t,e,r))return QY(tc.MSG_CELL_WITHOUT_ROW,null)}}a=-1;if(Nj(tR[gR].flags&tc.TAUX_REUSE_CELL_CHAIN)){if(hR==0)a=$E[gR].FirstCell;else{a=eR[hR].NextCell;if(a>0&&Nj(eR[a].flags&tc.CFLAG_PREEXIST))a=-1}}if(a<=0){if((a=x8(false))<=0){QY(tc.MSG_OUT_OF_CELL_SLOT,null);t.flags|=tc.RFLAG_OUT_OF_TABLE_CELL;return true}A=true;eR[a].InUse=true;eR[a].row=gR;eR[a].FirstLine=eR[a].LastLine=-1;eR[a].level=t.CurTblLevel-1;_=0;if(t.InXml){eR[a].ParentCell=_=e[r].ParentCell;eR[a].level=e[r].CellLevel}else if(t.CurTblLevel>0)eR[a].ParentCell=_=t.TblLevel[t.CurTblLevel-1].CurCellId;if(Li)eR[a].flags|=tc.CFLAG_FIX_WIDTH;if(_>0){o=eR[_].row;$E[o].flags|=tc.ROWFLAG_HAS_SUBTABLE}eR[a].PrevCell=eR[a].NextCell=-1}s=$E[gR].CellMargin;s=Math.max(s,e[r].BorderWidth[tc.BORDER_CELL_LEFT]);s=Math.max(s,e[r].BorderWidth[tc.BORDER_CELL_RIGHT]);eR[a].margin=s;if(Nj(e[r].ClPadFlags&tc.PAD_LEFT))eR[a].LeftPad=e[r].ClLeftPad;else if($E[gR].LeftPad>=0)eR[a].LeftPad=$E[gR].LeftPad;else eR[a].LeftPad=-1;if(Nj(e[r].ClPadFlags&tc.PAD_RIGHT))eR[a].RightPad=e[r].ClRightPad;else if($E[gR].RightPad>=0)eR[a].RightPad=$E[gR].RightPad;else eR[a].RightPad=-1;if(Nj(e[r].ClPadFlags&tc.PAD_TOP))eR[a].TopPad=e[r].ClTopPad;else if($E[gR].TopPad>=0)eR[a].TopPad=$E[gR].TopPad;else eR[a].TopPad=-1;if(Nj(e[r].ClPadFlags&tc.PAD_BOT))eR[a].BotPad=e[r].ClBotPad;else if($E[gR].BotPad>=0)eR[a].BotPad=$E[gR].BotPad;else eR[a].BotPad=-1;eR[a].border=0;if(Nj(e[r].BorderWidth[tc.BORDER_CELL_TOP]))eR[a].border|=tc.BORDER_TOP;if(Nj(e[r].BorderWidth[tc.BORDER_CELL_BOT]))eR[a].border|=tc.BORDER_BOT;if(Nj(e[r].BorderWidth[tc.BORDER_CELL_LEFT]))eR[a].border|=tc.BORDER_LEFT;if(Nj(e[r].BorderWidth[tc.BORDER_CELL_RIGHT]))eR[a].border|=tc.BORDER_RIGHT;if(Nj(eR[a].border&tc.BORDER_TOP))eR[a].BorderWidth[tc.BORDER_INDEX_TOP]=e[r].BorderWidth[tc.BORDER_CELL_TOP];if(Nj(eR[a].border&tc.BORDER_BOT))eR[a].BorderWidth[tc.BORDER_INDEX_BOT]=e[r].BorderWidth[tc.BORDER_CELL_BOT];if(Nj(eR[a].border&tc.BORDER_LEFT))eR[a].BorderWidth[tc.BORDER_INDEX_LEFT]=e[r].BorderWidth[tc.BORDER_CELL_LEFT];if(Nj(eR[a].border&tc.BORDER_RIGHT))eR[a].BorderWidth[tc.BORDER_INDEX_RIGHT]=e[r].BorderWidth[tc.BORDER_CELL_RIGHT];eR[a].BorderColor[tc.BORDER_INDEX_TOP]=e[r].BorderColor[tc.BORDER_CELL_TOP];eR[a].BorderColor[tc.BORDER_INDEX_BOT]=e[r].BorderColor[tc.BORDER_CELL_BOT];eR[a].BorderColor[tc.BORDER_INDEX_LEFT]=e[r].BorderColor[tc.BORDER_CELL_LEFT];eR[a].BorderColor[tc.BORDER_INDEX_RIGHT]=e[r].BorderColor[tc.BORDER_CELL_RIGHT];for(i=0;i<4;i++){e[r].BorderWidth[tc.BORDER_CELL_TOP+i]=0;e[r].BorderColor[tc.BORDER_CELL_TOP+i]=tc.CLR_AUTO}eR[a].shading=e[r].CellShading;eR[a].BackColor=e[r].CellPatBC;if(e[r].CellShading>0&&e[r].CellPatFC!=tc.Color.black){var R=e[r].CellShading;var L=e[r].CellPatFC;var C=e[r].CellPatBC;eR[a].BackColor=Yk(L,C,R);eR[a].shading=0}if(e[r].CellColSpan>0)eR[a].ColSpan=e[r].CellColSpan;eR[a].TextAngle=e[r].TextAngle;e[r].CellShading=0;e[r].CellPatBC=tc.CLR_WHITE;e[r].CellPatFC=tc.Color.black;e[r].CellColSpan=1;e[r].TextAngle=0;e[r].CellBorderType=tc.BRDRTYPE_NONE;e[r].CellMargin=0;e[r].ClLeftPad=e[r].ClRightPad=e[r].ClTopPad=e[r].ClBotPad=-1;e[r].ClPadFlags=0;E=tc.CFLAG_VALIGN_CTR|tc.CFLAG_VALIGN_BOT|tc.CFLAG_VALIGN_BASE|tc.CFLAG_FORCE_BKND_CLR;eR[a].flags=cj(eR[a].flags,E);eR[a].flags|=e[r].CellFlags&E;e[r].CellFlags=cj(e[r].CellFlags,E);if(PR==0)PR=a;if(A){J6(a,hR,gR,tc.CHAR_A)}if(hR>0)n=eR[hR].x+eR[hR].width;else n=$E[gR].indent;eR[a].x=n;c=t.IntParam;if(t.IntParam==0)$E[gR].flags|=tc.ROWFLAG_AUTO_FIT;if(Nj($E[gR].flags&tc.ROWFLAG_PREEXIST))eR[a].width=c-t.PrevCellX;else eR[a].width=c-n;if(!t.InXml){if(eR[a].PrevCell<=0)rR[a].XWidth=eR[a].width;else rR[a].XWidth=c-t.OrigPrevCellX;if(eR[a].width<=eR[a].margin*2+tc.RULER_TOLERANCE&&l==0){eR[a].width=rR[a].XWidth;if(eR[a].width<=eR[a].margin*2+tc.RULER_TOLERANCE&&Dj(t.flags&tc.RFLAG_CELL_MERGED))eR[a].width=eR[a].margin*2+tc.RULER_TOLERANCE+1}}t.OrigPrevCellX=c;if(Nj($E[gR].flags&tc.ROWFLAG_NO_PREF_WIDTH)&&Dj($E[gR].flags&tc.ROWFLAG_AUTO_FIT)&&l==3&&eR[a].width>0){f=0;l=0}rR[a].clwWidth=u;rR[a].clftsWidth=T;if(l==1||Nj($E[gR].flags&tc.ROWFLAG_AUTO_FIT)&&$E[gR].FixWidth==0){eR[a].flags|=tc.CFLAG_AUTO_WIDTH|tc.CFLAG_AUTO_WIDTH_RTF;if(eR[a].width<=eR[a].margin*2+tc.RULER_TOLERANCE)eR[a].width=eR[a].margin*2+tc.RULER_TOLERANCE}else if(f>0&&(l==3||l==2&&t.InXml)){eR[a].width=f;if(f<=eR[a].margin*2){eR[a].margin=(f-40)/2;if(eR[a].margin<0)eR[a].margin=0}c+=f-t.IntParam}if(eR[a].width<=eR[a].margin*2&&f>0&&l==3&&f>eR[a].width)eR[a].width=f;if(l==1)eR[a].FixWidth=0;else if(t.InXml&&l==2){eR[a].FixWidth=-(f/50);$E[gR].flags|=tc.ROWFLAG_AUTO_FIT|tc.ROWFLAG_LAYOUT_FIXED;eR[a].flags=cj(eR[a].flags,tc.CFLAG_AUTO_WIDTH|tc.CFLAG_AUTO_WIDTH_RTF)}else{eR[a].FixWidth=eR[a].width;eR[a].flags=cj(eR[a].flags,tc.CFLAG_AUTO_WIDTH|tc.CFLAG_AUTO_WIDTH_RTF)}if(Nj($E[gR].flags&tc.ROWFLAG_AUTO_FIT))FR=true;t.PrevCellX=c;hR=a;if(Nj(t.flags&tc.RFLAG_CELL_MERGED)){eR[a].flags|=tc.CFLAG_MERGED;t.flags=cj(t.flags,tc.RFLAG_CELL_MERGED)}else eR[a].flags=cj(eR[a].flags,tc.CFLAG_MERGED);if(Nj(t.flags1&tc.RFLAG1_ROW_SPANNED)){eR[a].flags|=tc.CFLAG_ROW_SPANNED;t.flags1=cj(t.flags1,tc.RFLAG1_ROW_SPANNED);if(gR>0){var I=$E[gR].PrevRow;$E[gR].flags=cj($E[gR].flags,tc.ROWFLAG_NEW_TABLE);if(I>0)$E[I].flags=cj($E[I].flags,tc.ROWFLAG_LAST_ROW)}}else eR[a].flags=cj(eR[a].flags,tc.CFLAG_ROW_SPANNED);return true}function m1(t,e,r){var i=t.group;var f=t.GroupLevel;var l=0,a=0,n=0;if(t.OutBufLen>0)b1(t);l=i[f].CharSet;a=i[f].CharSetDB;n=i[f].CharSetHi;i[f].CharSet=r;i[f].CharSetDB=r;i[f].CharSetHi=r;t.OutBuf+=wY(e);t.OutBufLen++;b1(t);i[f].CharSet=l;i[f].CharSetDB=a;i[f].CharSetHi=n;return true}function w1(t,e){var r=t.group;var i=false;var f=0;var l=tc.CHAR_HI;var a="";var n=t.IntParam;if(!t.OutBufHasUnicode)b1(t);if(n==8194)n=tc.SPACE;if(n==8203)n=tc.ZWNJ_CHAR;if(n==8209)n=tc.NBDASH_CHAR;if(r[e].CharSet==tc.CHINESEBIG5_CHARSET||r[e].CharSet==tc.GB2312_CHARSET||r[e].CharSet==tc.HANGUL_CHARSET||r[e].CharSet==tc.SHIFTJIS_CHARSET){if(n>=8192&&n<=8303||n==12539){if(t.OutBufLen>0)b1(t);i=true}}t.OutBuf+=wY(n);t.OutBufLen++;t.OutBufHasUnicode=true;if(i){f=r[e].CharSetHi;a=r[e].TypeFaceHi;l=r[e].CharType;r[e].TypeFaceHi="Arial";r[e].CharSetHi=0;r[e].CharType=tc.CHAR_HI;b1(t);r[e].TypeFaceHi=a;r[e].CharSetHi=f;r[e].CharType=l}r[e].IgnoreCount=r[e].UcIgnoreCount;return true}function b1(t){var e;var r=t.group[t.GroupLevel];var i=new tc.ClsRtfPict;var f=new tc.ClsRtfObject;var l;if(t.OutBufLen==0)return true;if(t.GroupLevel==0){t.OutBufLen=0;t.OutBuf="";return true}if(t.OutBufLen==1&&t.OutBuf.length>0&&t.OutBuf.charCodeAt(0)==tc.SPACE&&t.IsControlWord){var a=",clvertalb,clbrdrt,clbrdrl,clbrdrb,clbrdrr,cltxlrtb,clftsWidth2,clwWidth,clshdrawnil,cellx,row,";var n=","+t.CurWord+",";if(a.indexOf(n)>=0){t.OutBufLen=0;t.OutBuf="";return true}}if(t.InXml)t.group[t.GroupLevel].FieldId=t.FieldId;if(t.InitFieldId>0&&(t.group[t.GroupLevel].FieldId==tc.FIELD_NAME||t.group[t.GroupLevel].FieldId==tc.FIELD_TEXTBOX)){t.OutBufLen=0;t.OutBuf="";return true}if(t.group[t.GroupLevel].FieldId==tc.FIELD_NAME){l=t.OutBufLen;if(t.FieldName==null)t.FieldName=t.OutBuf;else t.FieldName+=t.OutBuf}if(Nj(t.group[t.GroupLevel].gflags&tc.GFLAG_IN_STYLE_ITEM))return true;if(Nj(r.gflags&tc.GFLAG_INPUT_FIELD)&&t.pict>=0&&t.pict<Ys&&xs[t.pict].InUse&&Nj(xs[t.pict].style&tc.PICT)){var c=xs[t.pict].form;c.InitText+=t.OutBuf;t.OutBufLen=0;t.OutBuf="";return true}if(t.group[t.GroupLevel].TypeFace==null||t.group[t.GroupLevel].TypeFace.length==0)x1(t);if(t.OutBufLen==1&&t.OutBuf.charCodeAt(0)==tc.SECT_CHAR)e=t1(tc.RTF_SECT,t.group[t.GroupLevel],t,i,f);else e=t1(tc.RTF_TEXT,t.group[t.GroupLevel],t.OutBuf,i,f);if(t.OutBufLen>0)t.PrevChar=t.OutBuf.charCodeAt(t.OutBufLen-1);if(t.HasIncompleteAsianChar&&t.OutBufLen>0){t.OutBuf=t.OutBuf.substring(t.OutBufLen-1);t.OutBufLen=t.OutBuf.length;t.HasIncompleteAsianChar=false}else{t.OutBuf="";t.OutBufLen=0}t.OutBufHasUnicode=false;t.flags|=tc.RFLAG_HDRFTR_TEXT_FOUND;t.flags1|=tc.RFLAG1_TEXT_FOUND;t.flags2|=tc.RFLAG2_FIELD_HAS_TEXT;return e}function x1(t){var e=h2(t);var r,i,f,l;if(Dj(e.gflags2&tc.GFLAG2_DEF_FONT_XLATED)){f=t.group[t.GroupLevel].DefFont;if(f>=0&&f<tc.MAX_RTF_SEQ_FONTS)i=f;else for(i=tc.MAX_RTF_SEQ_FONTS;i<e.MaxRtfFonts;i++){if(e.font[i].InUse&&e.font[i].FontId==f)break}if(i>=e.MaxRtfFonts)i=0;l=t.group[t.GroupLevel].RtfGroup;for(r=l;r<=t.GroupLevel;r++){t.group[r].DefFont=i;t.group[r].gflags2|=tc.GFLAG2_DEF_FONT_XLATED}}i=t.group[t.GroupLevel].DefFont;if(e.font[i].InUse){t.group[t.GroupLevel].TypeFace=e.font[i].name;t.group[t.GroupLevel].FontFamily=e.font[i].family;t.group[t.GroupLevel].CharSet=e.font[i].CharSet}else{t.group[t.GroupLevel].TypeFace=xs[0].TypeFace;t.group[t.GroupLevel].FontFamily="nil";t.group[t.GroupLevel].CharSet=xs[0].CharSet}return true}function y1(t){var e=0;var r,i;if(t.InXml)return 0;e=t.GroupLevel;while(true){if(!r2(t))return tc.RTF_FILE_INCOMPLETE;if(t.IsControlWord&&t.CurWord=="bin"){r=t.IntParam;t.WordLen=0;i=0;while(true){if(!i2(t))break;i++;if(i>=r)break}continue}if(t.GroupEnd&&t.GroupLevel<e)break}return 0}function W1(t){var e=null;var r=t.group;var i,f,l,a,n,c=0,s,_,o,u=-1;var T,A,E;var R=false;c=t.GroupLevel;h2(t);a=yd;e=r[a].font;for(i=0;i<r[a].MaxRtfFonts;i++)e[i].InUse=false;while(true){if(!r2(t))return tc.RTF_FILE_INCOMPLETE;if(t.GroupBegin)continue;if(t.GroupEnd){if(t.GroupLevel<c)break;else continue}if(t.GroupLevel==c&&!t.IsControlWord)continue;A=false;if(Tk(t.CurWord,"f")!=0){if(!t.IsControlWord)A=true;else if(Tk(t.CurWord,"fhiminor")==0||Tk(t.CurWord,"fhimajor")==0){R=true;continue}else{var L=r1(t);if(L!=0)return L;else continue}}if(t.IsControlWord)l=t.IntParam;else l=u+1;u=l;for(i=0;i<r[a].MaxRtfFonts;i++){if(e[i].InUse&&e[i].FontId==l)break}if(i<r[a].MaxRtfFonts){y1(t);continue}if(l>=0&&l<tc.MAX_RTF_SEQ_FONTS)n=l;else{if(r[a].MaxRtfFonts<tc.MAX_RTF_SEQ_FONTS)n=tc.MAX_RTF_SEQ_FONTS;else for(n=tc.MAX_RTF_SEQ_FONTS;n<r[a].MaxRtfFonts;n++)if(Dj(e[n].InUse))break}if(n<0||n>=tc.MAX_RTF_FONTS)return tc.RTF_SYNTAX_ERROR;if(n>=r[a].MaxRtfFonts){var C=n+50;if(C>=tc.MAX_RTF_FONTS)C=tc.MAX_RTF_FONTS-1;if(C<n+1)C=n+1;r[a].font=fV(r[a].font,C);for(i=r[a].MaxRtfFonts;i<C;i++)r[a].font[i]=(new tc.ClsRtfFont).init();r[a].MaxRtfFonts=C;e=r[a].font}e[n].InUse=true;e[n].FontId=l;e[n].CharSet=ks;e[n].family="";e[n].name="";e[n].name2="";if(!A&&!r2(t))return tc.RTF_FILE_INCOMPLETE;if(t.IsControlWord){if(Tk(t.CurWord,"fcharset")==0){e[n].CharSet=o=t.IntParam}else{var I=true;if(t.CurWord.charCodeAt(0)!=gk("f")&&t.CurWord.charCodeAt(0)!=tc.CHAR_F)I=false;if(t.CurWord.length>29)t.CurWord=t.CurWord.substring(0,29);e[n].family=t.CurWord;if(I)e[n].family=e[n].family.substring(1);else if(e[n].family.length==0)e[n].family=t.CurWord;e[n].family=e[n].family.trim()}}else A=true;s=t.GroupLevel;T=true;while(true){if(!A&&!r2(t))return tc.RTF_FILE_INCOMPLETE;A=false;if(t.GroupEnd&&t.GroupLevel<s){e[n].name=e[n].name.trim();break}if(t.WordLen==0)continue;if(t.IsControlWord){if(Tk(t.CurWord,"falt")==0){var d;E=false;d=e[n].name.toLowerCase();E=_i.TerIsAvailableFont(e[n].name);if(E||d=="arial"||d=="courier new"||d=="times new roman"){if(t.GroupLevel>s)y1(t)}else{r[t.GroupLevel].gflags2|=tc.GFLAG2_IN_ALT_FONT;T=true}}else if(Tk(t.CurWord,"fcharset")==0){e[n].CharSet=o=t.IntParam}else if(t.GroupLevel>s)y1(t);continue}if(T){if(Nj(r[t.GroupLevel].gflags2&tc.GFLAG2_IN_ALT_FONT))e[n].name2+=t.CurWord;else e[n].name+=t.CurWord}_=t.CurWord.length;if(_>0&&t.CurWord.charAt(_-1)==";"){e[n].IsHiThemeFont=R;R=false;if(t.WordHasHex){if(Nj(r[t.GroupLevel].gflags2&tc.GFLAG2_IN_ALT_FONT)){f=e[n].name2.length;e[n].name2=e[n].name2.substring(0,f-1)}else{f=e[n].name.length;e[n].name=e[n].name.substring(0,f-1)}}else{f=e[n].name.length;if(T&&f>0){E=false;e[n].name=e[n].name.substring(0,f-1);e[n].name=e[n].name.trim();if(n_.length>0&&Tk(e[n].name,"Symbol")==0)e[n].name=n_;if(c_.length>0&&Tk(e[n].name,"Wingdings")==0)e[n].name=c_;if(Tk(e[n].name,"@Arial Unicode MS")==0)e[n].name="Arial";if(e[n].CharSet==tc.GB2312_CHARSET||e[n].CharSet==tc.CHINESEBIG5_CHARSET||e[n].CharSet==tc.SHIFTJIS_CHARSET)E=true;else E=_i.TerIsAvailableFont(e[n].name);if(E&&Ck(e[n].name," CE"))e[n].CharSet=tc.EASTEUROPE_CHARSET;if(!E){var F="Western,Greek,Cyr,tc.CE,(Hebrew),(Arabic),(Baltic),";var g;if(Ck(e[n].name,"Greek"))e[n].CharSet=tc.GREEK_CHARSET;if(Ck(e[n].name," CE"))e[n].CharSet=tc.EASTEUROPE_CHARSET;var P=Uk(e[n].name);for(i=e[n].name.length-1;i>=0;i--)if(P[i]==tc.SPACE)break;if(i>0){g=e[n].name.substring(i+1);if(F.indexOf(g+",")>=0){e[n].name=e[n].name.substring(0,i);e[n].name=e[n].name.trim()}}var S=e[n].name2.length>0;if(S&&e[n].CharSet!=tc.SYMBOL_CHARSET){if(Tk(e[n].name2,"wingdings")==0)S=false;else if(Tk(e[n].name2,"symbol")==0)S=false}if(S){E=_i.TerIsAvailableFont(e[n].name);if(!E&&Dj(rO&tc.TFLAG8_DISABLE_ALT_RTF_FONT)){E=_i.TerIsAvailableFont(e[n].name2);if(E){var h=e[n].name;e[n].name=e[n].name2;e[n].name2=h}else{if(Lk(e[n].name,"Helvetica"))e[n].name="Arial";else if(e[n].family=="roman")e[n].name="Times New Roman";else if(Tk(e[n].name,"Courier")==0)e[n].name="Courier New";else e[n].name="Arial";if(e[n].name=="Arial"&&Us.length>0)e[n].name=Us}}}}var O=e[n].name.toUpperCase();if(O.indexOf("WINGDINGS")==0)e[n].CharSet=2;if(e[n].name.length==0){e[n].name=e[0].name;e[n].family=e[0].family;e[n].CharSet=e[0].CharSet}if(e[n].name.length==0)e[n].name=oi.FontTypeFace}if(t.GroupLevel==s)break;else T=false}}}}if(TO!=null&&TO.length>0){var v="";var p="",N="";var D;v=","+TO+",";v=v.toLowerCase();D=TO.indexOf(",");if(D<0)N=TO;else{N=TO.substr(0,D)}for(n=0;n<r[a].MaxRtfFonts;n++){if(e[n].InUse){if(n_.length>0&&Tk(e[n].name,n_)==0)continue;if(c_.length>0&&Tk(e[n].name,c_)==0)continue;p=","+e[n].name+",";p=p.toLowerCase();if(v.indexOf(p)<0)e[n].name=N}}}x1(t);if(ah<tc.RTF_CB){L_=t.group[t.GroupLevel].TypeFace;C_=t.group[t.GroupLevel].FontFamily;I_=t.group[t.GroupLevel].CharSet;if(r[t.GroupLevel].TypeFace!=xs[0].TypeFace||r[t.GroupLevel].PointSize2!=xs[0].TwipsSize/10||r[t.GroupLevel].style!=xs[0].style)_i.SetTerDefaultFont(r[t.GroupLevel].TypeFace,r[t.GroupLevel].PointSize2/2,r[t.GroupLevel].style,xs[0].TextColor,false)}return 0}function U1(t){var e=0,r=0,i=0;var f;var l;var a;var n=false,c=false,s=false,_=false;a=t.group;if(t.group[t.GroupLevel].TypeFace.length==0)x1(t);e=t.GroupLevel;f=new tc.ClsRtfPict;f.type=tc.PICT_FORM;f.FormId=-1;f.width=xs[0].TwipsSize/10;f.height=xs[0].TwipsSize/10;l=new tc.ClsForm;l.FontId=-1;l.TextBkColor=zT;l.name="";l.ListItems="";while(true){if(!r2(t))return tc.RTF_FILE_INCOMPLETE;if(n&&t.GroupLevel<r)n=false;if(s&&t.GroupLevel<i)s=false;if(t.GroupBegin)continue;if(t.GroupEnd){if(t.GroupLevel<e)break;else continue}if(t.IsControlWord){if(Tk(t.CurWord,"fftype")==0){if(t.IntParam==0){f.FormId=tc.FIELD_TEXTBOX}else if(t.IntParam==1){f.FormId=tc.FIELD_CHECKBOX;l.CtlClass="CheckBox"}else if(t.IntParam==2){f.FormId=tc.FIELD_COMBOBOX;l.CtlClass="ComboBox"}}else if(Tk(t.CurWord,"ssfldw")==0){f.width=t.IntParam;l.flags|=tc.FMFLAG_SSFLDW_FOUND}else if(Tk(t.CurWord,"ffhps")==0){f.height=f.width=t.IntParam*10;f.OrigWidth=f.width;f.OrigHeight=f.height}else if(Tk(t.CurWord,"ffmaxlen")==0){l.MaxLen=t.IntParam}else if(Tk(t.CurWord,"ssffborder")==0){}else if(Tk(t.CurWord,"ffres")==0){_=true;if(f.FormId==tc.FIELD_CHECKBOX&&t.IntParam!=0&&t.IntParam!=1)_=false;if(_){l.InitNum=t.IntParam;c=true}}else if(Tk(t.CurWord,"ffdefres")==0&&!c){_=true;if(f.FormId==tc.FIELD_CHECKBOX&&t.IntParam!=0&&t.IntParam!=1)_=false;if(_)l.InitNum=t.IntParam}else if(Tk(t.CurWord,"ffname")==0){n=true;r=t.GroupLevel}else if(Tk(t.CurWord,"ffl")==0){s=true;i=t.GroupLevel;if(l.ListCount>0)l.ListItems+="|";l.ListCount++}}else{if(n)l.name+=t.CurWord;if(s)l.ListItems+=t.CurWord}}if(f.FormId<0)return 0;f.form=l;return k1(t,f)}function k1(t,e){var r,i;var f;var l;var a=new tc.ClsRtfObject;l=t.group;f=e.form;if(e.FormId==tc.FIELD_TEXTBOX){i=l[t.GroupLevel].FieldGroup;if(e.width>0){var n=f1(t,l[t.GroupLevel]);var c=e.width,s,_;s=gV(xs[n].CharWidth[tc.UNDERSCORE]);if(s>0)_=c/s;else _=f.MaxLen;t.TextFieldLen=_<f.MaxLen?_:f.MaxLen}else t.TextFieldLen=f.MaxLen;l[i].FieldId=tc.FIELD_TEXTBOX;if(t.InXml)t.FieldId=tc.FIELD_TEXTBOX;t.FieldCode=mY(f.MaxLen)+"|"+f.name;var o=0;if(!t.InXml&&l[i].AuxId==0){o=5001;for(r=0;r<Ys;r++){if(xs[r].FieldId==tc.FIELD_TEXTBOX&&xs[r].AuxId>=o)o=xs[r].AuxId+1}l[i].AuxId=o}if(!t.InXml){o=t.group[i].AuxId;for(r=0;r<Ys;r++){if(xs[r].FieldId==tc.FIELD_TEXTBOX&&xs[r].AuxId>=o)o=xs[r].AuxId+1}t.group[i].AuxId=o}}else if(e.FormId==tc.FIELD_COMBOBOX&&Nj(iO&tc.TFLAG9_CONVERT_COMBO_BOX)){i=l[t.GroupLevel].FieldGroup;t.group[i].FieldId=0;if(f.ListCount>0){var u=f.InitNum;if(u>=f.ListCount||u<0)u=0;t.OutBufLen=0;t.OutBuf="";t.OutBuf=TK(f.ListItems,u,gk("|"));t.OutBufLen=t.OutBuf.length;if(t.OutBufLen>0)b1(t)}}else{t1(tc.RTF_PICT,t.group[t.GroupLevel],null,e,a)}return 0}function X1(t,e){var r=0;var i,f;r=t.GroupLevel;i="";while(true){if(!r2(t))return tc.RTF_FILE_INCOMPLETE;if(t.GroupBegin)continue;if(t.GroupEnd){if(t.GroupLevel<r)break;else continue}if(t.IsControlWord)continue;if(i.length+t.CurWord.length<tc.MAX_WIDTH)i+=t.CurWord}if(e&&t.ProtExId!=0)return 0;if(!e&&t.ProtExId==0)return 0;if(!e){t.ProtExId=0;return 0}if(i.length>8)f=cV(i,8);else f=i;if(f.length>8)f=cV(f,0,8);t.ProtExId=WK(f,f.length);return 0}function K1(t){var e=0;var r;e=t.GroupLevel;r="";while(true){if(!r2(t))return tc.RTF_FILE_INCOMPLETE;if(t.GroupBegin)continue;if(t.GroupEnd){if(t.GroupLevel<e)break;else continue}if(t.IsControlWord)continue;if(r.length+t.CurWord.length<tc.MAX_WIDTH)r+=t.CurWord}return Y1(t,r)}function Y1(t,e){var r;e=e.trim();if(e.indexOf("_Toc")==0&&Dj(iO&tc.TFLAG9_TOC_TO_TEXT))return 0;if(e.length>0){if(-1==(r=Jx()))return 0;ac[r].InUse=true;ac[r].type=tc.TERTAG_BKM;ac[r].name=e;if(Nj(t.TagId)){var i=t.TagId;while(ac[i].next>0)i=ac[i].next;ac[i].next=r}else t.TagId=r}return 0}function V1(t){var e=0,r,i=0;var f="";var l="";var a=true,n=false;e=t.GroupLevel;f="";while(true){if(!r2(t))return tc.RTF_FILE_INCOMPLETE;if(t.GroupBegin)continue;if(t.GroupEnd){if(t.GroupLevel<e)break;else continue}if(t.IsControlWord){if(t.CurWord=="sstagint"){i=t.IntParam;a=false;n=true}continue}if(a&&f.length+t.CurWord.length<tc.MAX_WIDTH)f+=t.CurWord;if(n)l+=t.CurWord}f=f.trim();if(f.length>0){if(-1==(r=Jx()))return 0;ac[r].InUse=true;ac[r].type=tc.TERTAG_USER;ac[r].AuxInt=i;ac[r].AuxText=l;ac[r].name=f;if(Nj(t.TagId)){var c=t.TagId;while(ac[c].next>0)c=ac[c].next;ac[c].next=r}else t.TagId=r}return 0}function j1(t){var e,r=0,i=0;var f,l="",a="";var n=34,c=0;var s=false,_=false,o=false,u=false;var T=false,A=false,E;var R=false,L=false,C=false,I=false;var d=false,F=false,g=false;var P=0,S,h,O;var v=tc.Color.black,p=tc.Color.white;var N=-1;r=t.GroupLevel;t.group[r].FieldLevel++;E=Nj(t.group[r].gflags&tc.GFLAG_IN_FIELD);if(Nj(cO&tc.TOFLAG3_IN_DATA_FIELD))E=true;t.group[r].gflags|=tc.GFLAG_IN_FIELD;t.group[r].FieldGroup=r;if(t.InitFieldId!=tc.FIELD_HLINK){if(Nj(t.FieldCode)&&!E&&t.InitFieldId!=tc.FIELD_TEXTBOX)t.FieldCode=null;if(Nj(t.FieldName)&&!E)t.FieldName=null}if(t.group[r].FieldLevel==1)t.FieldLocked=false;while(true){if(!r2(t))return tc.RTF_FILE_INCOMPLETE;if(t.GroupBegin)continue;if(t.GroupEnd){if(t.GroupLevel<r){if(R&&!s&&!d&&t.group[r].FieldId>0){var D=t.group[t.GroupLevel].FieldId;if(t.OutBufLen>0)if(!b1(t))return tc.RTF_FILE_INCOMPLETE;t.OutBuf="1";t.OutBufLen=1;t.group[t.GroupLevel].FieldId=t.group[r].FieldId;if(!b1(t))return tc.RTF_FILE_INCOMPLETE;t.group[t.GroupLevel].FieldId=D}break}else continue}if(Tk(t.CurWord,"fldinst")==0&&t.IsControlWord){if(t.InitFieldId>0){y1(t);R=true;continue}i=t.GroupLevel;t.group[i].FieldInstLevel++;t:while(true){if(t.GroupEnd&&t.GroupLevel<i)break;if(!r2(t))return tc.RTF_FILE_INCOMPLETE;if(t.GroupBegin)continue;if(t.GroupEnd){if(t.GroupLevel<i)break;else continue}if(T)continue;f=t.CurWord;if(t.IsControlWord){if(C&&Tk(f,"u")==0){var M=t.IntParam;t.FieldCode+=wY(M);t.group[t.GroupLevel].IgnoreCount=t.group[t.GroupLevel].UcIgnoreCount;continue}if(Tk(f,"u")==0){if(!s&&!Li){J1(t,i,r,I,t.IntParam);return 0}else continue}else if(Tk(f,"fs")==0){var G=t.GroupLevel;N=t.IntParam;t.group[G].PointSize2=t.IntParam;continue}var B=r1(t);if(B!=0)return B;if(Tk(f,"formfield")==0)s=true;continue}f=f.trim();if(f.length==0)continue;if(Tk(f,"IF")==0){g=true;T=true;continue}if(E&&(Tk(f,"INCLUDEPICTURE")!=0&&Tk(f,"INCLUDEPICT")!=0&&Tk(f,"SYMBOL")!=0&&!_)){T=true;continue}if(C){if(t.group[t.GroupLevel].IgnoreCount>0)t.group[t.GroupLevel].IgnoreCount--;else t.FieldCode+=f;continue}R=true;if(Tk(f,"SYMBOL")==0&&!o){if(!r2(t))return tc.RTF_FILE_INCOMPLETE;f=t.CurWord.trim();if(Tk(f,"\\")==0){if(!r2(t))return tc.RTF_FILE_INCOMPLETE;if(t.CurWord.length>0&&t.CurWord.charCodeAt(0)=="u"){f=t.CurWord.substring(1);f=f.trim()}}if(!t.IsControlWord){if(f=="183"&&t.group[t.GroupLevel].CharSet<128){t.OutBuf+=wY(149);t.OutBufLen++;s=true}else{_=true;o=u=false;l=a="";h=f.length;var H=Uk(f);for(e=0;e<h;e++)if(H[e]<tc.CHAR_0||H[e]>tc.CHAR_9)break;if(e==h){S=t.GroupLevel;if(t.OutBufLen>0)if(!b1(t))return tc.RTF_FILE_INCOMPLETE;JO=f;c=LX(JO);if(n_.length>0)t.group[S].TypeFace=n_;else t.group[S].TypeFace="Symbol";t.group[S].FontFamily="";t.group[S].CharType=tc.CHAR_NORMAL;P=t.group[S].style;v=t.group[S].TextColor;p=t.group[S].TextBkColor;s=true}}}}else if(_){if(f=="\\")o=u=false;if(o)l+=t.CurWord;if(u)a+=t.CurWord;if(Tk(f,"f")==0)o=true;if(Tk(f,"s")==0)u=true}else if(Tk(f,"s")==0&&_){o=false;u=true}else if(false&&Tk(f,"PAGE")==0){S=t.GroupLevel;if(t.OutBufLen>0)if(!b1(t))return tc.RTF_FILE_INCOMPLETE;t.OutBuf="1";t.OutBufLen=1;t.group[S].FieldId=tc.FIELD_PAGE_NUMBER;if(!b1(t))return tc.RTF_FILE_INCOMPLETE;s=true}else if(Tk(f,"NUMPAGES")==0||Tk(f,"SSUSER1")==0||Tk(f,"SECTIONPAGES")==0){S=t.GroupLevel;if(t.OutBufLen>0)if(!b1(t))return tc.RTF_FILE_INCOMPLETE;if(t.TextLine>=0&&t.TextLine<br&&ui[t.TextLine].len>0){var m=ib(t.TextLine,0);if(xs[m].FieldId==tc.FIELD_PAGE_COUNT){var w=t.group[S].PointSize2;t.OutBuf=" ";t.OutBufLen=1;t.group[S].FieldId=0;t.group[S].PointSize2=2;b1(t);t.group[S].PointSize2=w}}t.OutBuf="1";t.OutBufLen=1;if(Tk(f,"NUMPAGES")==0)t.group[S].FieldId=tc.FIELD_PAGE_COUNT;else if(Tk(f,"SSUSER1")==0)t.group[S].FieldId=tc.FIELD_USER1;else t.group[S].FieldId=tc.FIELD_SECT_PAGE_COUNT;if(!b1(t))return tc.RTF_FILE_INCOMPLETE;s=true}else if(Tk(f,"TIME")==0||Tk(f,"DATE")==0||Tk(f,"PRINTDATE")==0){var b="";var x=t.GroupLevel;var y=Tk(f,"PRINTDATE")==0?tc.FIELD_PRINTDATE:tc.FIELD_DATE;if(Tk(f,"TIME")==0)y=tc.FIELD_TIME;while(r2(t)){if(t.GroupBegin)continue;if(t.GroupEnd){if(t.GroupLevel<x)break;else continue}if(!t.IsControlWord)b+=t.CurWord}b=b.trim();t.FieldCode=b;if((y==tc.FIELD_DATE||y==tc.FIELD_TIME)&&Dj(qh&tc.TFLAG4_DISABLE_DATE_UPDATE)){if(y==tc.FIELD_TIME)b=GX("TIME",b,-1);else b=GX("",b,-1);if(t.OutBufLen>0)if(!b1(t))return tc.RTF_FILE_INCOMPLETE;t.OutBuf=b;t.OutBufLen=t.OutBuf.length;t.GroupLevel++;t.group[t.GroupLevel].FieldId=y;if(!b1(t))return tc.RTF_FILE_INCOMPLETE;t.GroupLevel--;s=true}else{for(e=r;e<=t.GroupLevel;e++)t.group[e].FieldId=y}if(t.GroupLevel<i)break t}else if(Tk(f,"TOC")==0&&Nj(iO&tc.TFLAG9_TOC_TO_TEXT)){F=true;break t}else if(Tk(f,"TOC")==0&&!Li||Tk(f,"LISTNUM")==0||Tk(f,"AUTONUMLGL")==0||Tk(f,"PAGEREF")==0||Tk(f,"REF")==0||Tk(f,"SEQ")==0||Tk(f,"TC")==0||Tk(f,"PAGE")==0||Tk(f,"HYPERLINK")==0||Tk(f,"FILENAME")==0||Tk(f,"DOCPROPERTY")==0||Uk(f)[0]==gk("=")&&Dj(fO&tc.TFLAG10_NO_EQ_SUPPORT)){var W;var U=Tk(f,"TOC")==0;var k=Tk(f,"LISTNUM")==0;var X=Tk(f,"AUTONUMLGL")==0;var K=Tk(f,"HYPERLINK")==0;var Y=Tk(f,"PAGEREF")==0;var V=Tk(f,"REF")==0;var j=Tk(f,"SEQ")==0;var J=Tk(f,"TC")==0;var z=Tk(f,"PAGE")==0;var Z=Tk(f,"FILENAME")==0;var Q=Tk(f,"DOCPROPERTY")==0;var q=false;var $=Uk(f)[0]==gk("=");var tt;for(e=r;e<t.GroupLevel;e++)t.group[e].TypeFace=t.group[t.GroupLevel].TypeFace;tt=t.group[t.GroupLevel].style;W=e3(t,t.GroupLevel,true);if(V&&W!=null&&W.indexOf("SSUSER1")>=0){V=false;q=true;if(t.OutBufLen>0)if(!b1(t))return tc.RTF_FILE_INCOMPLETE;t.group[t.GroupLevel].FieldId=tc.FIELD_USER1;t.OutBuf="1";t.OutBufLen=1;if(!b1(t))return tc.RTF_FILE_INCOMPLETE;s=true}if(J){var et,rt;if(t.OutBufLen>0)if(!b1(t))return tc.RTF_FILE_INCOMPLETE;t.group[t.GroupLevel].FieldId=tc.FIELD_TC;e=W.indexOf(tc.BACK_SLASH);if(e<0)et=W;else et=cV(W,0,e);et=et.trim();if(et.length>0&&et.charCodeAt(0)==tc.QUOTE)et=Jk(et);rt=IQ(W,"\\l");if(rt!=null&&rt.length>0){var it=LX(rt);t.FieldCode="\\tcl"+mY(it)}t.OutBuf=et;t.OutBufLen=et.length;t.group[t.GroupLevel].style|=tc.HIDDEN;if(!b1(t))return tc.RTF_FILE_INCOMPLETE;s=true}if(!q&&!J){if(K){W=Z1(W)}if($)t.FieldCode=f+" "+W;else t.FieldCode=W;C=true;for(e=r;e<=t.GroupLevel;e++){if(U)t.group[e].FieldId=tc.FIELD_TOC;if(k)t.group[e].FieldId=tc.FIELD_LISTNUM;if(X)t.group[e].FieldId=tc.FIELD_AUTONUMLGL;if(K)t.group[e].FieldId=tc.FIELD_HLINK;if(Y)t.group[e].FieldId=tc.FIELD_PAGE_REF;if(V)t.group[e].FieldId=tc.FIELD_REF;if(j)t.group[e].FieldId=tc.FIELD_SEQ;if(z)t.group[e].FieldId=tc.FIELD_PAGE_NUMBER;if(Z)t.group[e].FieldId=tc.FIELD_FILE_NAME;if(Q)t.group[e].FieldId=tc.FIELD_DOC_PROP;if($)t.group[e].FieldId=tc.FIELD_FORMULA;t.group[e].style|=tt}if(t.GroupLevel<i)break t}}else if(Tk(f,"EQ")==0){MR=true;s=true}else if(Tk(f,"INCLUDEPICTURE")==0||Tk(f,"INCLUDEPICT")==0){f=e3(t,i);var ft=f.indexOf(tc.QUOTE)>=0;var lt=0;var at=Jk(f);f=Xk(at);O=f.indexOf(" ");if(!ft&&O>=0)f=f.substring(0,O);if((lt=Q1(t,f))>0){s=true;t.group[r].gflags2|=GFLAG2_INCLUDEPICTURE_READ;t.group[r].IncludePictId=lt}}else if(Tk(f,"INDEX")==0&&!L){T=true}else if(Tk(f,"SET")==0&&!L){T=true;s=true}else if(Tk(f,"ASK")==0&&!L){T=true;s=true}else if(Tk(f,"include")==0&&!L){T=true}else if(Tk(f,"shape")==0&&!L){T=true}else if(MR&&Tk(f,"X(")==0){S=t.GroupLevel;if(t.OutBufLen>0)if(!b1(t))return tc.RTF_FILE_INCOMPLETE;t.group[S].style|=tc.CHAR_BOX;break}else if(Tk(f,"FORMTEXT")==0){A=true;continue}else if(Tk(f,"FORMCHECKBOX")==0||Tk(f,"FORMDROPDOWN")==0){continue}else if(Tk(f,"MERGEFIELD")==0){L=true;I=true;t.FieldName=f+" "}else if(Tk(f,"MERGEFIELD")!=0&&!s){J1(t,i,r,I,0);I=false;return 0}}if(!L&&N>=0){for(e=r;e<=t.GroupLevel;e++)t.group[e].PointSize2=N}if(_){S=t.GroupLevel;l=l.trim();a=a.trim();if(l.length>0){var nt=h2(t);var ct;if(l.charCodeAt(0)==n){l=l.substring(1,l.length-1);l=l.trim()}h=l.length;if(h>0&&(O=l.indexOf(n))>0)l=l.substring(0,O);for(ct=0;ct<nt.MaxRtfFonts;ct++){if(nt.font[ct].InUse){if(Tk(nt.font[ct].name,l)==0)break;if(Tk(nt.font[ct].name2,l)==0){l=nt.font[ct].name;break}}}t.group[S].TypeFace=l;t.group[S].TypeFaceHi=l;if(ct<nt.MaxRtfFonts)t.group[S].CharSet=nt.font[ct].CharSet;if(Tk(l,"Wingdings")==0)t.group[S].CharSet=2;else if(Tk(l,c_)==0)t.group[S].CharSet=2;else if(Tk(l,"Symbol")==0)t.group[S].CharSet=2;else if(Tk(l,"Monotype Sorts")==0)t.group[S].CharSet=2;if(t.group[S].CharSet==2)t.group[S].CharType=tc.CHAR_NORMAL}if(a.length>0){var st=LX(a);if(st>0)t.group[S].PointSize2=st*2}t.group[S].style=P;t.group[S].TextColor=v;t.group[S].TextBkColor=p;if(t.group[S].CharSet==2){if(Tk(t.group[S].TypeFace,"symbol")==0)c=AY(c);else c=RY(c)}t.OutBuf=wY(c);t.OutBufLen=1;if(!b1(t))return tc.RTF_FILE_INCOMPLETE}if(MR)break;else continue}else if(Tk(t.CurWord,"fldlock")==0&&t.IsControlWord){if(t.group[r].FieldLevel==1)t.FieldLocked=true}else if(Tk(t.CurWord,"fldrslt")==0&&t.IsControlWord){d=true;if(F){for(e=r;e<=t.GroupLevel;e++)t.group[e].gflags=cj(t.group[e].gflags,tc.GFLAG_IN_FIELD)}if(t.group[t.GroupLevel].FieldId==tc.FIELD_PAGE_NUMBER){t.OutBuf="1";t.OutBufLen=1;b1(t)}if(!s)A=false;if(t.group[t.GroupLevel].FieldInstLevel==0&&t.group[t.GroupLevel].FieldId==tc.FIELD_LISTNUM){t.flags2=cj(t.flags2,tc.RFLAG2_FIELD_HAS_TEXT)}if(A){var _t=t.GroupLevel;t.group[_t].gflags|=tc.GFLAG_INPUT_FIELD;t.flags2=cj(t.flags2,tc.RFLAG2_FIELD_HAS_TEXT);break}else if(t.group[t.GroupLevel].FieldInstLevel>0)y1(t);else if((s||!R)&&!E&&Dj(t.group[r].gflags2&tc.GFLAG2_INCLUDEPICTURE_READ)){if(g)break;y1(t)}else break}}return 0}function J1(t,e,r,f,l){var a="";var n=t.group[t.GroupLevel].IgnoreCount;if(n>0){a=t.OutBuf;t.OutBuf="";t.OutBufLen=0;t.group[t.GroupLevel].IgnoreCount=0}var c;if(t.OutBufLen>0)if(!b1(t))return false;for(i=e;i<=t.GroupLevel;i++)t.group[i].FieldId=tc.FIELD_NAME;c=t.group[t.GroupLevel].style;t.group[t.GroupLevel].style|=tc.PROTECT;t.OutBuf="{";t.OutBufLen=t.OutBuf.length;if(!b1(t))return false;t.group[t.GroupLevel].style=c;for(i=r;i<=t.GroupLevel;i++)t.group[i].gflags|=tc.GFLAG_IN_MERGE_FIELD;if(l!=0)w1(t,t.GroupLevel);else{if(n>0){t.OutBuf=a;t.OutBufLen=a.length;t.group[t.GroupLevel].IgnoreCount=n}if(f||t.CurWord.length==1){t.CurWord=$X(t.CurWord)}t.WordLen=t.CurWord.length;Q0(t)}return true}function z1(t){var e,r;var i="-+/*!#%&*():";if(t.FieldName==null)return true;var f=t.FieldName.toUpperCase();var l="MERGEFIELD";if(f.length>=l.length&&f.indexOf(l)>=0)return true;l="MERGEFORMAT";if(f.length>=l.length&&f.indexOf(l)>=0)return true;l="COMMENT";if(f.length>=l.length&&f.indexOf(l)>=0)return true;l="FILLIN";if(f.length>=l.length&&f.indexOf(l)>=0)return true;l="ADDIN";if(f.length>=l.length&&f.indexOf(l)>=0)return true;l="=";if(f.length>=l.length&&f.indexOf(l)>=0)return true;l="DDE";if(f.length>=l.length&&f.indexOf(l)>=0)return true;r=f.length;var a=Uk(f);for(e=0;e<r;e++)if(i.indexOf(a[e])>=0){if(e>0&&i.indexOf(a[e-1])>=0)continue;else if(e+1<r&&i.indexOf(a[e+1])>=0)continue;else if(a[e]==gk("*")){var n=f.substring(e);if(n.indexOf("* MERGEFORMAT")==0)continue;else if(e>0&&a[e-1]==tc.BACK_SLASH)continue;else return false}else return false}return true}function Z1(t){var e,r=0,i,f=0;var l=true;var a;var n=0;var c=true;var s=false;i=t.length;var _=Uk(t);var o=[i*2+10];for(e=0;e<=i;e++){var u=0;if(e<i)u=_[e];if(u==tc.QUOTE)s=!s;if(!s&&e>0&&_[e-2]==tc.CHAR_SPACE&&_[e-1]==tc.BACK_SLASH&&_[e]==tc.CHAR_o){if(e+1<i&&_[e+1]==tc.SPACE){o[r]=tc.BACK_SLASH;r++;c=false}}if(!c){if(e==i)break;o[r]=u;r++;continue}if(u==tc.BACK_SLASH)f++;else{if(l&&f>=2){o[r]=tc.BACK_SLASH;r++;o[r]=tc.BACK_SLASH;r++}else if(f>=1){o[r]=tc.BACK_SLASH;r++}f=0;if(u!=tc.QUOTE)l=false;if(e<i){o[r]=u;r++}if(r>0&&o[r-1]==gk("/")){n=0;if(o[0]==tc.QUOTE)n++;if(r-n=="file://".length){if(o[n]==gk("f")&&o[n+1]==gk("i")&&o[n+2]==gk("l")&&o[n+3]==gk("e")&&o[n+4]==gk(":")&&o[n+5]==gk("/")&&o[n+6]==gk("/"))l=true}}if(r>0&&o[r-1]==gk(":")){if(r>2&&o[r-3]!="\\"&&o[r-3]!=tc.QUOTE){if(e+1<i&&_[e+1]==gk("\\")){l=true;f=2}}}}}a=Wk(o,0,r);return a}function Q1(t,e){var r;var i;var f=t.group;var l=t.GroupLevel;var a=new tc.ClsRtfObject;var n=false;var c=e;if(e.indexOf("cid:")==0)return-1;e=q1(e);if(Nj(fO&tc.TFLAG10_PREFER_PLACEHOLDER_PICT)&&T_.length>0&&new File(T_).exists())n=true;else if(e.indexOf("http:")!=0&&e.indexOf("https:")!=0){if(T_.length>0&&new File(T_).exists())n=true;else return-1}if(n){r=_i.TerInsertPictureFile(T_,false,0,false);if(r>=0)xs[r].LinkFile=c}else r=_i.TerInsertPictureFile(e,false,0,false);if(r<=0)return-1;xs[r].style|=f[l].style;if(Nj(f[l].FieldId)){xs[r].FieldId=f[l].FieldId;if(Nj(t.FieldCode)){xs[r].FieldCode=t.FieldCode}}i=new tc.ClsRtfPict;i.PictId=r;t1(tc.RTF_PICT,t.group[t.GroupLevel],null,i,a);if(f[l].LinkPictWidth>0||f[l].LinkPictHeight>0)_i.TerSetPictSize(r,FV(f[l].LinkPictWidth),OV(f[l].LinkPictHeight));return r}function q1(t){var e=yD(_i,t);if(e!=null)return e;var r=Uk(t);var i=PictFILE_LENGTH>1&&r[1]==gk(":")||PictFILE_LENGTH>0&&r[0]==tc.BACK_SLASH||t.indexOf("..\\")==0||t.indexOf(".\\")==0||t.indexOf("file:")==0||t.indexOf("http:")==0||t.indexOf("https:")==0;if(!i){if(u_.length>0)t=u_+"\\"+t;else{var f="";var l;var a;if(hO.length>0)f=hO;else if(ih.length>0&&ih.charCodeAt(0)==tc.BACK_SLASH||ih.length>1&&ih.charCodeAt(1)==gk(":")||ih.indexOf("..\\")==0||ih.indexOf(".\\")==0){var n;a=ih.length;f=ih;var c=Uk(f);for(n=a-1;n>0;n--)if(c[n]==tc.BACK_SLASH)break;f=f.substring(0,n)}if(f.length>0){a=f.length;l=f.charCodeAt(a-1);if(l!=tc.BACK_SLASH)f+="\\";f+=t;t=f}}}return t}function $1(t){var e;var r,i=0,f=0,l;var a,n,c;var s=t.group;var _=false;h2(t);l=yd;if(s[l].TotalRtfColors>0){y1(t);return 0}e=s[l].color;for(r=0;r<aA;r++){e[r].color=xs[tc.DEFAULT_CFMT].TextColor;if(e[r].color==null||e[r].color==tc.Color.black)e[r].color=tc.CLR_AUTO}f=t.GroupLevel;t.IgnoreCrLfInControlWord=true;while(true){if(!r2(t))return tc.RTF_FILE_INCOMPLETE;if(t.GroupBegin)continue;if(t.GroupEnd){if(t.GroupLevel<f)break;else continue}if(t.IsControlWord){a=e[i].color.getRed();n=e[i].color.getGreen();c=e[i].color.getBlue();if(Tk(t.CurWord,"red")==0)a=t.IntParam;else if(Tk(t.CurWord,"green")==0)n=t.IntParam;else if(Tk(t.CurWord,"blue")==0)c=t.IntParam;else if(Tk(t.CurWord,"cbackgroundone")==0)_=true;if(a<0)a=0;if(a>255)a=255;if(n<0)n=0;if(n>255)n=255;if(c<0)c=0;if(c>255)c=255;e[i].color=new tc.Color(a,n,c)}else{var o=t.CurWord.trim();if(Tk(o,";")==0){if(ah==tc.RTF_CB&&_)e[i].UsesThemeColor=true;else e[i].UsesThemeColor=false;_=false;i++;if(i>=aA){var u=50;e=s[l].color=fV(e,aA+u);aA+=u}}}}s[l].TotalRtfColors=i;for(r=t.TopColorGroup;r<f;r++){t.group[r].color=t.group[l].color;t.group[r].TotalRtfColors=t.group[l].TotalRtfColors}t.IgnoreCrLfInControlWord=false;return 0}function t2(t,e){var r=t.rtf;if(Tk(r.CurWord,"brdrs")==0||Tk(r.CurWord,"brdrth")==0||Tk(r.CurWord,"brdrdb")==0||Tk(r.CurWord,"brdrtriple")==0){if(e==tc.BORDER_PARA_ALL)t.flags|=tc.PARA_BOX_TOP|tc.PARA_BOX_BOT|tc.PARA_BOX_LEFT|tc.PARA_BOX_RIGHT;if(e==tc.BORDER_PARA_LEFT)t.flags|=tc.PARA_BOX_LEFT;if(e==tc.BORDER_PARA_RIGHT)t.flags|=tc.PARA_BOX_RIGHT;if(e==tc.BORDER_PARA_TOP)t.flags|=tc.PARA_BOX_TOP;if(e==tc.BORDER_PARA_BOT)t.flags|=tc.PARA_BOX_BOT;if(e==tc.BORDER_PARA_BETWEEN)t.flags|=tc.PARA_BOX_BETWEEN}return true}function e2(t,e){var r=-1;var i=t.rtf;if(e==tc.BORDER_SECT_LEFT){i.sect.border|=tc.BORDER_LEFT;r=tc.BORDER_INDEX_LEFT}else if(e==tc.BORDER_SECT_RIGHT){i.sect.border|=tc.BORDER_RIGHT;r=tc.BORDER_INDEX_RIGHT}else if(e==tc.BORDER_SECT_TOP){i.sect.border|=tc.BORDER_TOP;r=tc.BORDER_INDEX_TOP}else if(e==tc.BORDER_SECT_BOT){i.sect.border|=tc.BORDER_BOT;r=tc.BORDER_INDEX_BOT}if(r>=0){i.sect.BorderWidth[r]=t.BorderWidth[e];i.sect.BorderSpace[r]=t.BorderSpace[e]}return true}function r2(t){var e=0,r=0,i;var f,l,a,n,c,s,_;var o,u=false,T;var A;var E=Nj(t.flags&tc.RFLAG_IGNORE_SLASH);var R=tc.MAX_WIDTH+1;var L=t.OptiLine;t.IgnoreText=false;t.PrevGroupBegin=t.GroupBegin;t:while(true){if(t.eof)return false;t.GroupBegin=t.GroupEnd=t.SubEntry=false;t.IsControlWord=false;t.CurWord="";t.WordLen=0;t.WordHasHex=false;f=0;while(i2(t)){if(f+10>R){var C=300;L=fV(L,R+C+1);R+=300}r=e;e=t.CurChar;if(f>0&&(L[f-1]!=tc.BACK_SLASH||E)){if(e==tc.LEFT_BRACE||e==tc.RIGHT_BRACE||e==tc.BACK_SLASH&&!E){l2(t);break}}L[f]=e;f++;if(f==1){if(e==tc.LEFT_BRACE||e==tc.RIGHT_BRACE)break;if(e==tc.RIGHT_PAREN&&MR)f--}else if(f==2&&L[f-2]==tc.BACK_SLASH&&L[f-1]==tc.BACK_SLASH&&!E)break;else if(f==2&&L[f-2]==tc.BACK_SLASH&&L[f-1]==10&&!E)break;else if(e==tc.SPACE&&Dj(t.flags1&tc.RFLAG1_IGNORE_SPACE)||MR&&e==gk("("))break;else if(e==tc.RIGHT_PAREN&&MR)f--;else if(t.mac&&f>1&&e==10&&r!=13)break;else if(f==4&&L[f-4]==tc.BACK_SLASH&&L[f-3]==tc.CHAR_QUOTE&&dk(L[f-2])&&dk(L[f-1]))break;if(f==tc.MAX_WIDTH)break}if(t.eof)return false;L[f]=0;if(f==1&&L[0]==tc.LEFT_BRACE&&t.group[t.GroupLevel].IgnoreCount==0){if(!b1(t))return false;if(t.GroupLevel>=wR&&Dj(t.flags2&tc.RFLAG2_CAN_EXPAND_GROUP_TABLE))return QY(tc.MSG_OUT_OF_GROUP,"GetRtfWord");if(t.GroupLevel+25>=wR&&Nj(t.flags2&tc.RFLAG2_CAN_EXPAND_GROUP_TABLE)){var I=wR+50;if(t.GroupLevel+25>=I)I=t.GroupLevel+25+50;if(I>tc.MAX_RTF_GROUPS)I=tc.MAX_RTF_GROUPS;if(t.GroupLevel>=I)return QY(tc.MSG_OUT_OF_GROUP,"GetRtfWord");t.group=fV(t.group,I+1);for(l=wR;l<I;l++)t.group[l]=t.group[l].init();wR=I}t.group[t.GroupLevel].sect=t.sect.copy();t.GroupBegin=true;t.GroupLevel++;if(t.GroupLevel>0)t.group[t.GroupLevel]=t.group[t.GroupLevel-1].copy();t.group[t.GroupLevel].ControlCount=0;t.group[t.GroupLevel].gflags=cj(t.group[t.GroupLevel].gflags,tc.GFLAG_NEW_FRAME);if(Nj(t.group[t.GroupLevel].gflags&tc.GFLAG_IN_STYLESHEET)){t.group[t.GroupLevel].gflags|=tc.GFLAG_IN_STYLE_ITEM;M2(t)}return true}if(f==1&&L[0]==tc.RIGHT_BRACE&&t.group[t.GroupLevel].IgnoreCount==0&&t.GroupLevel>0){s=t.GroupLevel;if(Nj(t.group[s].gflags&tc.GFLAG_DO_TEXT_READ)&&(s==0||Dj(t.group[s-1].gflags&tc.GFLAG_DO_TEXT_READ))&&Dj(t.flags1&tc.RFLAG1_PARA_ENDED)){t.OutBuf+=wY(Bn);t.OutBufLen++}if(t.group[t.GroupLevel].FieldId==tc.FIELD_NAME){t.OutBuf=tK(t.OutBuf);t.OutBufLen=t.OutBuf.length}if(!b1(t))return false;if(Nj(t.group[s].gflags&tc.GFLAG_INPUT_FIELD)&&t.pict>=0&&(s==0||Dj(t.group[s-1].gflags&tc.GFLAG_INPUT_FIELD))){if(t.group[s].FieldId!=tc.FIELD_TEXTBOX){kw(t.pict,null);mN(t.pict)}}if(Nj(eO&tc.TFLAG7_LOAD_EMPTY_TEXT_FIELD)&&Nj(t.group[s].gflags&tc.GFLAG_INPUT_FIELD)&&t.group[s].FieldId==tc.FIELD_TEXTBOX&&Dj(t.flags2&tc.RFLAG2_FIELD_HAS_TEXT)&&t.TextFieldLen>0){var d=[t.TextFieldLen];for(l=0;l<t.TextFieldLen;l++)d[l]=tc.SPACE;t.OutBuf=Wk(d);t.OutBufLen=t.TextFieldLen;if(!b1(t))return false}else if(Nj(t.group[s].gflags&tc.GFLAG_IN_FIELD)&&t.group[s].FieldId==tc.FIELD_LISTNUM&&Dj(t.flags2&tc.RFLAG2_FIELD_HAS_TEXT)){t.OutBuf="_";t.OutBufLen=1;if(!b1(t))return false}_=t.group[t.GroupLevel-1].FieldId;if(t.group[t.GroupLevel].FieldId==tc.FIELD_NAME&&_!=tc.FIELD_NAME){var F=t.group[t.GroupLevel].style;t.group[t.GroupLevel].style|=tc.PROTECT;t.OutBuf="}";t.OutBufLen=t.OutBuf.length;if(!b1(t))return false;t.group[t.GroupLevel].style=F}A=t.group[t.GroupLevel-1].flags&tc.PAGE_HDR_FTR;if(Nj(BR&tc.PAGE_HDR_FTR)&&A==0&&Nj(t.group[t.GroupLevel].gflags2&tc.GFLAG2_IN_HDR_FTR)){if(Dj(t.flags&tc.RFLAG_HDRFTR_TEXT_FOUND)){t.OutBuf=" "+wY(Bn);t.OutBufLen=2;if(!b1(t))return false}v1(t,t.group);t.OutBuf=wY(t.HdrFtrChar);t.OutBufLen=1;if(!b1(t))return false;BR=0}if(t.GroupLevel>0&&Nj(t.flags1&tc.RFLAG1_SSSUBTABLE_USED)&&t.group[t.GroupLevel].level!=t.group[t.GroupLevel-1].level){var g=t.GroupLevel;b2(t,g-1,t.group[g-1].level,t.group[g].level)}if(t.GroupLevel>0&&Nj(t.group[t.GroupLevel].gflags2&tc.GFLAG2_IN_OLDCPROPS)){t.group[t.GroupLevel-1].FmtOrigFont=f1(t,t.group[t.GroupLevel])}if(t.GroupLevel>0&&Nj(t.group[t.GroupLevel].gflags2&tc.GFLAG2_IN_OLDPPROPS)){t.group[t.GroupLevel-1].FmtOrigPara=d1(-1,t.group[t.GroupLevel])}t.GroupEnd=true;if(Nj(t.group[t.GroupLevel].gflags&tc.GFLAG_IN_STYLE_ITEM)&&t.GroupLevel>0&&Dj(t.group[t.GroupLevel-1].gflags&tc.GFLAG_IN_STYLE_ITEM)){V2(t)}if(Nj(t.group[t.GroupLevel].gflags2&tc.GFLAG2_IN_DOC_PARA_PROPS)){t.DocParaProps.SpaceBefore=t.group[t.GroupLevel].SpaceBefore;t.DocParaMask|=t.group[t.GroupLevel].ParaMask&tc.PMASK_SPACING_BEF;t.DocParaProps.SpaceAfter=t.group[t.GroupLevel].SpaceAfter;t.DocParaMask|=t.group[t.GroupLevel].ParaMask&tc.PMASK_SPACING_AFT;t.DocParaProps.SpaceBetween=t.group[t.GroupLevel].SpaceBetween;t.DocParaMask|=t.group[t.GroupLevel].ParaMask&tc.PMASK_SPACING_BET;t.DocParaProps.LineSpacing=t.group[t.GroupLevel].LineSpacing;t.DocParaMask|=t.group[t.GroupLevel].ParaMask&tc.PMASK_SPACING_LINE}S2(t,t.GroupLevel);t.GroupLevel--;if(t.GroupLevel>0&&t.GroupLevel>=t.group[t.GroupLevel].RtfGroup)t.sect=t.group[t.GroupLevel].sect.copy();if(Dj(t.group[t.GroupLevel].style&tc.CHAR_BOX))MR=false;if(Nj(t.group[t.GroupLevel].style&tc.FNOTEREST)&&Nj(t.group[t.GroupLevel+1].style&tc.FNOTETEXT)&&HE.length>0){t.OutBuf+=HE;t.OutBufLen=t.OutBuf.length;if(!b1(t))return false;HE="";t.group[t.GroupLevel].style=cj(t.group[t.GroupLevel].style,tc.FNOTEREST)}if(t.GroupLevel<0)return false;else if(t.GroupLevel==0&&(Dj(Qh&tc.TFLAG3_MULTIPLE_RTF_GROUPS)||Nj(nO&tc.TOFLAG2_FROM_CB)))return false;else return true}o=false;a=0;var P=null;var S=L.length+10;if(false&&S<2*tc.MAX_WIDTH)P=t.OptiCurWord;else P=[];for(l=0;l<f;l++){r=e;e=L[l];if(o){var h=false;switch(e){case tc.BACK_SLASH:case tc.LEFT_BRACE:case tc.RIGHT_BRACE:P[a]=e;a++;break;case gk("~"):P[a]=tc.NBSPACE_CHAR;a++;break;case gk("*"):t.IgnoreText=true;break;case gk(":"):if(t.group[t.GroupLevel].FieldId==tc.FIELD_XE){P[a]=e;a++}t.SubEntry=true;break;case tc.SQUOTE:if(l+2<f){i=L[l+1];if(i>=tc.CHAR_a&&i<=tc.CHAR_z)i=tc.CHAR_A+(i-tc.CHAR_a);if(i>=tc.CHAR_A)c=10+i-tc.CHAR_A;else c=i-tc.CHAR_0;c=c<<4;P[a]=c;i=L[l+2];if(i>=tc.CHAR_a&&i<=tc.CHAR_z)i=tc.CHAR_A+(i-tc.CHAR_a);if(i>=tc.CHAR_A)c=10+i-tc.CHAR_A;else c=i-tc.CHAR_0;P[a]+=c;l=l+2;var O=t.group[t.GroupLevel].CharType!=tc.CHAR_DB&&t.group[t.GroupLevel].CharSet<=2;if(O){if(P[a]==147)P[a]=tc.CHAR_QUOTE;else if(P[a]==148)P[a]=tc.CHAR_QUOTE}if(P[a]==10&&Dj(t.group[t.GroupLevel].gflags&(tc.GFLAG_IN_LEVELTEXT|tc.GFLAG_IN_LEVELNUM))&&Dj(t.group[t.GroupLevel].gflags2&tc.GFLAG2_GET_CR_LF)){P[a]=gk("l");a++;P[a]=gk("i");a++;P[a]=gk("n");a++;P[a]=gk("e");a++;t.IsControlWord=true;u=false;break}else{if(P[a]>tc.LAST_CTRL_CHAR||P[a]==10||P[a]==13||P[a]==tc.TAB||P[a]==tc.PAGE_CHAR||P[a]==tc.HIDDEN_CHAR||Nj(t.group[t.GroupLevel].gflags&(tc.GFLAG_IN_LEVELTEXT|tc.GFLAG_IN_LEVELNUM)))a++}t.WordHasHex=true}break;case gk("|"):break;case tc.HYPH:P[a]=tc.HYPH_CHAR;a++;break;case tc.UNDERSCORE:P[a]=tc.NBDASH_CHAR;a++;break;default:if(t.IsControlWord){qk(Wk(L,0,a),tg.MsgString[tc.MSG_BAD_RTF],tc.MSGTYPE_ALERT);t.eof=true;return false}t.IsControlWord=true;u=false;if(e==10||e==13){P[a]=gk("p");a++;P[a]=tc.CHAR_a;a++;P[a]=gk("r");a++;h=true;break}else{P[a]=e;a++}break}o=false;if(h){for(n=f-1;n>l;n--){t.CurChar=L[n];l2(t)}break}}else{if(e==tc.BACK_SLASH&&!E)o=true;else{if(t.IsControlWord){if(e==13){if(l+1<f&&L[l+1]==10)continue;else e=10}if(e==10){if(!t.IgnoreCrLfInControlWord){for(n=f-1;n>l;n--){t.CurChar=L[n];l2(t)}break}else continue}if(e==tc.HYPH&&(l+1==f||L[l+1]<tc.CHAR_0||L[l+1]>tc.CHAR_9)&&L[l+1]!=tc.SPACE){for(n=f-1;n>l;n--){t.CurChar=L[n];l2(t)}break}if(e==tc.PERIOD||e==tc.HYPH||e>=tc.CHAR_0&&e<=tc.CHAR_9)T=true;else T=false;if(!T&&!ak(e)&&e!=tc.SPACE){for(n=f-1;n>=l;n--){t.CurChar=L[n];l2(t)}break}else if(u&&!T){for(n=f-1;n>=l;n--){t.CurChar=L[n];l2(t)}if(e==tc.SPACE)i2(t);break}if(T)u=true}if(e!=10&&e!=13){P[a]=e;if(e<32&&e!=tc.TAB&&e!=12)P[a]=tc.UNDERSCORE;a++}else if(t.mac&&a>0&&e==10&&r!=13){P[a]=Bn;a++}}}}t.WordLen=f=a;t.CurWord=String.fromCharCode.apply(this,P);if(t.IsControlWord&&t.WordLen==1&&(t.CurWord.charCodeAt(0)==tc.CHAR_r||t.CurWord.charCodeAt(0)==tc.CHAR_n)){t.IsControlWord=false;t.CurWord="";t.WordLen=0;continue t}if(Dj(t.IsControlWord)){if(t.WordLen>0)return true;else continue t}t.CurWord=t.CurWord.trim();f=t.CurWord.length;var v=Uk(t.CurWord);for(l=0;l<f;l++){e=v[l];if(e==tc.PERIOD||e==tc.HYPH||e>=tc.CHAR_0&&e<=tc.CHAR_9)break}if(l==0)l=1;if(f==0){t.param="";t.CurWord=" ";t.WordLen=1}else{t.param=t.CurWord.substring(l);t.CurWord=t.CurWord.substring(0,l);t.WordLen=l}t.flags2=cj(t.flags2,tc.RFLAG2_NO_VAL);if(t.param.length>0){if(t.param.length==1&&t.param.charCodeAt(0)==tc.HYPH){t.IntParam=0}else{t.IntParam=LX(t.param)}}else{t.IntParam=1;t.flags2|=tc.RFLAG2_NO_VAL}break}t.group[t.GroupLevel].ControlCount++;return true}function i2(e){if(e.StackLen>0){e.StackLen--;e.CurChar=e.stack[e.StackLen];e.FilePos++;return true}e.eof=false;if(e.iFile!=null){if(e.TextIndex<e.TextLen){e.CurChar=e.text[e.TextIndex];e.TextIndex++;e.FilePos++;return true}var t=[tc.MAX_WIDTH];try{e.TextLen=e.iFile.read(e.text,0,tc.MAX_WIDTH)}catch(t){e.TextLen=0}if(e.TextLen==0){e.eof=true;return false}e.TextIndex=0;e.CurChar=e.text[e.TextIndex];e.TextIndex++;e.FilePos++;return true}else{if(e.BufLen>=0&&e.BufIndex>=e.BufLen){e.eof=true;return false}e.CurChar=e.buf[e.BufIndex];e.BufIndex++;e.FilePos++;return true}}function f2(t){var e;while(true){if(!i2(t))return false;if(t.CurChar!=10&&t.CurChar!=13&&t.CurChar!=tc.SPACE)break}if(t.CurChar>=tc.CHAR_0&&t.CurChar<=tc.CHAR_9)t.CurChar=t.CurChar-tc.CHAR_0;else if(t.CurChar>=tc.CHAR_A&&t.CurChar<=tc.CHAR_F)t.CurChar=t.CurChar-tc.CHAR_A+10;else if(t.CurChar>=tc.CHAR_a&&t.CurChar<=tc.CHAR_f)t.CurChar=t.CurChar-tc.CHAR_a+10;else return false;e=t.CurChar;e=e<<4;while(true){if(!i2(t))return false;if(t.CurChar!=10&&t.CurChar!=13&&t.CurChar!=tc.SPACE)break}if(t.CurChar>=tc.CHAR_0&&t.CurChar<=tc.CHAR_9)t.CurChar=t.CurChar-tc.CHAR_0;else if(t.CurChar>=tc.CHAR_A&&t.CurChar<=tc.CHAR_F)t.CurChar=t.CurChar-tc.CHAR_A+10;else if(t.CurChar>=tc.CHAR_a&&t.CurChar<=tc.CHAR_f)t.CurChar=t.CurChar-tc.CHAR_a+10;else return false;e=e+t.CurChar;t.CurChar=e;return true}function l2(t){if(t.StackLen>=tc.MAX_WIDTH)return QY(tc.MSG_OUT_OF_CHAR_STACK,"PushRtfChar");t.stack[t.StackLen]=t.CurChar;t.StackLen++;t.FilePos--;return true}function a2(t){var e,r,i;var f;var l,a,n=0,c=tc.BACK_SLASH;var s=Uk(t);var _;i=t.length;r=0;for(e=0;e<i;e++){a=s[e];if(n==c){if(a==tc.CHAR_QUOTE&&e+2<i){_=String.fromCharCode(s[e+1]).toUpperCase();l=_.charCodeAt(0);if(l>=tc.CHAR_A)f=10+l-tc.CHAR_A;else f=l-tc.CHAR_0;f=f<<4;s[r]=f;_=String.fromCharCode(s[e+2]).toUpperCase();l=_.charCodeAt(0);if(l>=tc.CHAR_A)f=10+l-tc.CHAR_A;else f=l-tc.CHAR_0;s[r]+=f;e=e+2;r++}else{s[r]=c;r++;if(a!=c){s[r]=a;r++}}}else if(a!=c){s[r]=a;r++}n=a}if(n==c){s[r]=c;r++}return Wk(s,0,r)}function n2(t){var e=0;var r=false,i=false,f=false;var l=null;var a=tc.OBJ_NONE;var n=tc.OASPECT_NONE;var c=false;var s=0;var _=0,o;e=t.GroupLevel;bT=-1;while(true){if(!r2(t))return tc.RTF_FILE_INCOMPLETE;if(t.GroupBegin)continue;if(t.GroupEnd){if(t.GroupLevel<e)break;continue}if(i)continue;if(t.IsControlWord){if(Tk(t.CurWord,"objemb")==0)a=tc.OBJ_EMBED;else if(Tk(t.CurWord,"objocx")==0)a=tc.OBJ_OCX;else if(Tk(t.CurWord,"objautlink")==0)a=tc.OBJ_LINK;else if(Tk(t.CurWord,"objupdate")==0)c=true;else if(Tk(t.CurWord,"sscontent")==0)n=tc.OASPECT_CONTENT;else if(Tk(t.CurWord,"ssicon")==0)n=tc.OASPECT_ICON;else if(Tk(t.CurWord,"result")==0)f=true;else if(Tk(t.CurWord,"objclass")==0||Tk(t.CurWord,"objname")==0){if(0!=(o=y1(t)))return o}else if(Tk(t.CurWord,"pict")==0){if(f){o=v2(t,0,0,1,tc.CLR_WHITE);if(Nj(o))_=o;continue}else{i=true;continue}}else if(Tk(t.CurWord,"objdata")==0){if(r)continue;if(null==(l=s2(t)))return tc.RTF_SYNTAX_ERROR;s=Md;if(s>0)r=true}else if(f){var u=r1(t);if(u!=0)return u}}else if(f){if(t.OutBufLen+t.WordLen>tc.RTF_LINE_LEN)if(!b1(t))return tc.RTF_SYNTAX_ERROR;t.OutBuf+=t.CurWord;t.OutBufLen+=t.WordLen}}if(bT>0&&(a==tc.OBJ_EMBED||a==tc.OBJ_LINK||a==tc.OBJ_OCX)){c2(t,l,a,s,n,c);return _}else{return 0}}function c2(t,e,r,i,f,l){var a=new tc.ClsRtfObject;var n=t.GroupLevel;var c=t.group;var s=new tc.ClsRtfPict;a.ObjectType=r;a.ObjectSize=i;a.ObjectAspect=f;a.ObjectUpdate=l;a.pict=bT;a.data=e;if(bT>0&&Nj(c[n].gflags&tc.GFLAG_IN_SHP)&&OR>0&&xs[bT].PictWidth>kl[OR].width-2*kl[OR].margin){var _=bT;var o=kl[OR].width-2*kl[OR].margin;xs[_].PictHeight=xs[_].OrigPictHeight=Mj(xs[_].PictHeight,o,xs[_].PictWidth);xs[_].PictWidth=xs[_].OrigPictWidth=o;HN(_,hV(xs[_].PictHeight),dV(xs[_].PictWidth),true);mN(_)}t1(tc.RTF_OBJECT,t.group[t.GroupLevel],null,s,a);return true}function s2(t){var e;var r,i,f=16384,l;r=l=Md=0;i=f;e=[i];while(true){if(!f2(t)){if(t.CurChar==tc.RIGHT_BRACE){l2(t);break}else if(t.CurChar==tc.LEFT_BRACE){l2(t);if(!r2(t))return null;if(0!=y1(t))return null;continue}else return null}if(r>=i){i+=f;e=fV(e,i)}e[r]=t.CurChar;r++}Md=l=r;return e}function _2(t,e){var r=0,i;r=t.GroupLevel;while(true){if(!r2(t))return tc.RTF_FILE_INCOMPLETE;if(t.GroupBegin)continue;if(t.GroupEnd){if(t.GroupLevel<r)break;else continue}if(t.IsControlWord){if(Tk(t.CurWord,e)==0){i=v2(t,0,0,1,tc.CLR_WHITE);if(Nj(i))return i}}}return 0}function o2(t){var e=0,r,i,f;var l=false;var a;e=t.GroupLevel;if(t.GroupLevel>0)t.GroupLevel--;v1(t,t.group);h1(t,t.group);t.GroupLevel=e;v1(t,t.group);h1(t,t.group);a=t.group;i=t.GroupLevel;t.flags=cj(t.flags,tc.RFLAG_INSERT_BEF_PARA|tc.RFLAG_INSERT_BEF_PARA);for(f=i-1;f<=i;f++){a[f].shape.type=0;a[f].FrmFlags=cj(a[f].FrmFlags,tc.PARA_FRAME_USED|tc.PARA_FRAME_TEXT_BOX);a[f].shape.FrmFlags=cj(a[f].shape.FrmFlags,tc.PARA_FRAME_USED|tc.PARA_FRAME_TEXT_BOX);a[f].gflags=cj(a[f].gflags,tc.GFLAG_USE_SHP_INFO)}while(true){if(!r2(t))return tc.RTF_FILE_INCOMPLETE;if(t.GroupEnd&&t.GroupLevel<e)break;if(t.IsControlWord){if(Tk(t.CurWord,"par")==0)l=true;r=r1(t);if(r!=0)return r}else if(t.WordLen>0){l=t.CurWord.charCodeAt(t.WordLen-1)==Bn;Q0(t)}}if(t.OutBufLen>0)b1(t);if(!l){t.OutBuf+=wY(Bn);t.OutBufLen++;b1(t)}y1(t);y1(t);return 0}function u2(t){var e,r=0,i;var f=false,l=false,a=false;var n=new tc.ClsRtfObject;r=t.GroupLevel;t.group[r].gflags|=tc.GFLAG_USE_SHP_INFO;if(t.GroupLevel>0)t.GroupLevel--;v1(t,t.group);h1(t,t.group);t.GroupLevel=r;v1(t,t.group);h1(t,t.group);while(true){if(!r2(t))return tc.RTF_FILE_INCOMPLETE;if(t.GroupEnd&&t.GroupLevel<r)break;if(t.IsControlWord){if(Tk(t.CurWord,"par")==0)f=true;i=r1(t);if(i!=0)return i}else if(t.WordLen>0){f=t.CurWord.charCodeAt(t.WordLen-1)==Bn;Q0(t)}}if(t.OutBufLen>0)b1(t);if(!f){t.OutBuf+=wY(Bn);t.OutBufLen++;b1(t)}l=t.InstGroup>0&&Nj(t.group[t.InstGroup-1].pflags&tc.PFLAG_PAGE_BREAK);a=t.group[t.InstGroup].shape.type==tc.SHPTYPE_TEXT_BOX&&t.group[t.InstGroup].shape.NextShapeId>0;if((t.sect.columns>1||t.InsLine+1<br||l||a)&&Nj(t.flags&tc.RFLAG_INSERT_BEF_PARA)){var c=t.GroupLevel;var s=t.InstGroup;var _=new tc.ClsRtfPict;t.flags=cj(t.flags,tc.RFLAG_INSERT_BEF_PARA);t.flags2=cj(t.flags2,tc.RFLAG2_INSERT_BEF_TABLE);_.type=tc.PICT_SHAPE;t.group[s].gflags2|=tc.GFLAG2_PICT_SHAPE;t.TextBoxParaFID=OR;OR=t.TextBoxParentFID;PR=t.TextBoxParentCellId;gR=t.TextBoxParentRowId;if(PR>0&&br>0&&ui[br-1].len>0){var o=ui[br-1].txt;var u=ui[br-1].len;if(o[u-1]==tc.ROW_CHAR){var T=t.TextBoxParentItapLevel-1;if(T<eR[PR].level&&eR[PR].ParentCell>0){PR=eR[PR].ParentCell;gR=eR[PR].row}}}for(e=s;e<=t.GroupLevel;e++)t.group[e].InTable=t.TextBoxParentInTable;t.GroupLevel=s;t1(tc.RTF_PICT,t.group[t.GroupLevel],null,_,n);t.GroupLevel=c}return 0}function T2(t){var e=0,r;e=t.GroupLevel;while(true){if(!r2(t))return tc.RTF_FILE_INCOMPLETE;if(t.GroupBegin)continue;if(t.GroupEnd){if(t.GroupLevel<e)break;else continue}if(t.IsControlWord){if(Tk(t.CurWord,"pict")==0){r=v2(t,0,0,1,tc.CLR_WHITE);if(Nj(r))return r}}}return 0}function A2(t){var e,r,i=0;var f=true;Gf="";e=0;i=t.GroupLevel;while(true){if(!r2(t))return tc.RTF_FILE_INCOMPLETE;if(t.GroupBegin)continue;if(t.GroupEnd){if(t.GroupLevel<i)break;else continue}if(f){r=t.CurWord.length;Gf+=t.CurWord;e+=r}}return 0}function E2(t){var e,r,f,l=0;var a=20,n=1,c=0,s=0;var _;var o="";var u;var T=true,A=false,E=false;var R;var L;l=t.GroupLevel;e=r=t.GroupLevel;_=t.group;_[e].shape.LineWdth=0;_[e].shape.LineColor=tc.Color.black;_[e].shape.BackColor=tc.Color.white;_[e].shape.FrmFlags|=tc.PARA_FRAME_SHPGRP;R=_[e].ShpGrp.copy();_[e].ShpGrp=new tc.ClsShpGrp;A=r>1&&Nj(_[r-2].gflags&tc.GFLAG_IN_SHPGRP);while(true){if(!r2(t))return tc.RTF_FILE_INCOMPLETE;if(t.GroupBegin)continue;if(t.GroupEnd){if(t.GroupLevel<l)break;else continue}e=t.GroupLevel;if(t.IsControlWord){if(Tk(t.CurWord,"shpleft")==0)_[r].ShpGrp.left=t.IntParam;else if(Tk(t.CurWord,"shpright")==0)_[r].ShpGrp.width=t.IntParam-_[r].ShpGrp.left;else if(Tk(t.CurWord,"shptop")==0)_[r].ShpGrp.top=t.IntParam;else if(Tk(t.CurWord,"shpbottom")==0)_[r].ShpGrp.height=t.IntParam-_[r].ShpGrp.top;else if(Tk(t.CurWord,"shpbxpage")==0)_[r].shape.FrmFlags|=tc.PARA_FRAME_HPAGE;else if(Tk(t.CurWord,"shpbxcolumn")==0)_[r].shape.FrmFlags|=tc.PARA_FRAME_HCOL;else if(Tk(t.CurWord,"shpbypage")==0)_[r].shape.FrmFlags|=tc.PARA_FRAME_VPAGE;else if(Tk(t.CurWord,"shpbymargin")==0)_[r].shape.FrmFlags|=tc.PARA_FRAME_VMARG;else if(Tk(t.CurWord,"shpbxignore")==0){_[r].shape.FrmFlags=cj(_[r].shape.FrmFlags,tc.PARA_FRAME_HPAGE);_[r].shape.FrmFlags|=tc.PARA_FRAME_IGNORE_X|tc.PARA_FRAME_HCOL}else if(Tk(t.CurWord,"shpbyignore")==0){_[r].shape.FrmFlags=cj(_[r].shape.FrmFlags,tc.PARA_FRAME_VPAGE|tc.PARA_FRAME_VMARG|tc.PARA_FRAME_VLINE);_[r].shape.FrmFlags|=tc.PARA_FRAME_IGNORE_Y}else if(Tk(t.CurWord,"shpwr")==0)_[r].shape.WrapType=t.IntParam;else if(Tk(t.CurWord,"shpwrk")==0)_[r].shape.WrapSide=t.IntParam;else if(Tk(t.CurWord,"shpz")==0)_[r].shape.ZOrder=t.IntParam;else if(Tk(t.CurWord,"ssshpalignleft")==0)_[r].shape.align=tc.LEFT;else if(Tk(t.CurWord,"ssshpalignright")==0)_[r].shape.align=tc.RIGHT_JUSTIFY;else if(Tk(t.CurWord,"shplid")==0)_[r].ShapeId=t.IntParam;else if(Tk(t.CurWord,"sp")==0)o="";else if(Tk(t.CurWord,"sn")==0){A2(t);o=Gf}else if(Tk(t.CurWord,"sv")==0){if(Tk(o,"groupLeft")==0){if((f=A2(t))>0)return f;u=Gf;_[r].ShpGrp.GroupLeft=LX(u)}else if(Tk(o,"groupRight")==0){if((f=A2(t))>0)return f;u=Gf;_[r].ShpGrp.GroupRight=LX(u);_[r].ShpGrp.mask|=tc.SGM_GROUP_RIGHT}else if(Tk(o,"groupTop")==0){if((f=A2(t))>0)return f;u=Gf;_[r].ShpGrp.GroupTop=LX(u)}else if(Tk(o,"groupBottom")==0){if((f=A2(t))>0)return f;u=Gf;_[r].ShpGrp.GroupBot=LX(u);_[r].ShpGrp.mask|=tc.SGM_GROUP_BOT}else if(Tk(o,"relLeft")==0){if((f=A2(t))>0)return f;u=Gf;_[r].ShpGrp.left=LX(u)}else if(Tk(o,"relRight")==0){if((f=A2(t))>0)return f;u=Gf;_[r].ShpGrp.right=LX(u);_[r].ShpGrp.mask|=tc.SGM_REL_RIGHT}else if(Tk(o,"relTop")==0){if((f=A2(t))>0)return f;u=Gf;_[r].ShpGrp.top=LX(u)}else if(Tk(o,"relBottom")==0){if((f=A2(t))>0)return f;u=Gf;_[r].ShpGrp.bot=LX(u);_[r].ShpGrp.mask|=tc.SGM_REL_BOT}else if(Tk(o,"lineWidth")==0){if((f=A2(t))>0)return f;u=Gf;a=LX(u);a=GV(a);_[r].shape.LineWdth=a;_[r].shape.FrmFlags|=tc.PARA_FRAME_BOXED}else if(Tk(o,"fLine")==0){if((f=A2(t))>0)return f;u=Gf;T=Nj(LX(u));if(T)_[r].shape.FrmFlags|=tc.PARA_FRAME_BOXED}else if(Tk(o,"lineDashing")==0){var C;if((f=A2(t))>0)return f;u=Gf;C=LX(u);if(C==6){_[r].shape.FrmFlags|=tc.PARA_FRAME_DOTTED}}else if(Tk(o,"fillOpacity")==0){if((f=A2(t))>0)return f;u=Gf;c=LX(u)/256;c++;_[r].shape.FillOpacity=c}else if(Tk(o,"lineOpacity")==0){if((f=A2(t))>0)return f;u=Gf;c=LX(u)/256;c++;_[r].shape.LineOpacity=c}else if(Tk(o,"fillColor")==0){if((f=A2(t))>0)return f;u=Gf;L=new tc.Color(LX(u));_[r].shape.BackColor=L;_[r].shape.FillPattern=n}else if(Tk(o,"fFilled")==0){if((f=A2(t))>0)return f;u=Gf;c=LX(u);if(c==0){_[r].shape.BackColor=tc.CLR_WHITE;n=_[r].shape.FillPattern=0}}else if(Tk(o,"lineColor")==0){if((f=A2(t))>0)return f;u=Gf;L=new tc.Color(LX(u));_[r].shape.LineColor=L}else if(Tk(o,"fBehindDocument")==0&&!A){var I;if((f=A2(t))>0)return f;u=Gf;I=LX(u);_[r].shape.FrmFlags2=cj(_[r].shape.FrmFlags2,tc.PF2_BEHIND_DOC);if(Nj(I))_[r].shape.FrmFlags2|=tc.PF2_BEHIND_DOC}else if(Tk(o,"fAllowOverlap")==0&&!A){var d;if((f=A2(t))>0)return f;u=Gf;d=LX(u);_[r].shape.FrmFlags2=cj(_[r].shape.FrmFlags2,tc.PF2_NO_OVERLAP);if(d==0)_[r].shape.FrmFlags2|=tc.PF2_NO_OVERLAP}else if(Tk(o,"posrelv")==0&&!A){if(Nj(_[r].shape.FrmFlags&tc.PARA_FRAME_IGNORE_Y)){if((f=A2(t))>0)return f;u=Gf;s=LX(u);if(s==4)s=1;_[r].shape.FrmFlags=cj(_[r].shape.FrmFlags,tc.PARA_FRAME_VPAGE|tc.PARA_FRAME_VMARG|tc.PARA_FRAME_VLINE);if(s==0)_[r].shape.FrmFlags|=tc.PARA_FRAME_VMARG;else if(s==1)_[r].shape.FrmFlags|=tc.PARA_FRAME_VPAGE;else if(s==3)_[r].shape.FrmFlags|=tc.PARA_FRAME_VLINE}}else if(Tk(o,"posrelh")==0&&!A){if((f=A2(t))>0)return f;u=Gf;s=LX(u);if(s==4)s=1;_[r].shape.FrmFlags=cj(_[r].shape.FrmFlags,tc.PARA_FRAME_HPAGE|tc.PARA_FRAME_HCHAR|tc.PARA_FRAME_HCOL);_[r].shape.FrmFlags2=cj(_[r].shape.FrmFlags2,tc.PF2_RIGHT_MARG);if(s==1)_[r].shape.FrmFlags|=tc.PARA_FRAME_HPAGE;if(s==2)_[r].shape.FrmFlags|=tc.PARA_FRAME_HCOL;else if(s==3)_[r].shape.FrmFlags|=tc.PARA_FRAME_HCHAR;else if(s==5)_[r].shape.FrmFlags2|=tc.PF2_RIGHT_MARG}}else{var F=r1(t);if((Tk(t.CurWord,"shpgrp")==0||Tk(t.CurWord,"shp")==0)&&!E){R2(t,r,R,A);for(i=r+1;i<=e;i++)_[i].ShpGrp=_[r].ShpGrp.copy();if(!A){for(i=r;i<=e;i++)_[i].ShpgrpId=Kl}E=true}if(F!=0)return F;else continue}}}return 0}function R2(t,e,r,i){var f=t.group;var l=f[e].ShpGrp.mask;if(Nj(l&tc.SGM_GROUP_RIGHT))f[e].ShpGrp.GroupWidth=f[e].ShpGrp.GroupRight-f[e].ShpGrp.GroupLeft;if(Nj(l&tc.SGM_GROUP_BOT))f[e].ShpGrp.GroupHeight=f[e].ShpGrp.GroupBot-f[e].ShpGrp.GroupTop;if(Nj(l&tc.SGM_REL_RIGHT)){var a=f[e].ShpGrp.left;var n=f[e].ShpGrp.right-a;var c=r.GroupWidth;var s=r.width;f[e].ShpGrp.left=r.left+Mj(a-r.GroupLeft,s,c);f[e].ShpGrp.width=Mj(n,s,c)}if(Nj(l&tc.SGM_REL_BOT)){var _=f[e].ShpGrp.top;var o=f[e].ShpGrp.bot-_;var u=r.GroupHeight;var T=r.height;f[e].ShpGrp.top=r.top+Mj(_-r.GroupTop,T,u);f[e].ShpGrp.height=Mj(o,T,u)}return true}function L2(t){var e,r,i,f=0,l=tc.OBJ_NONE;var a=0,n=20;var c;var s;var _=null;var o=0;var u=tc.OASPECT_NONE;var T=false;var A="";var E,R;var L,C=false,I=false,d=false;var F=OR,g=1;var P=OR;var S;var h=true,O=false;var v=0,p=65536;var N=-1;var D=false,M=false;var G=Nj(t.flags&tc.RFLAG_INSERT_BEF_PARA);var B=false,H=false,m=false,w=false;var b="";var x=new tc.ClsRtfObject;var y=t.TextLine;var W=false;var U=tc.Color.white;var k=0,X=0,K=0,Y=0,V=0;var j,J,z,Z,Q,q;var $,tt,et;var rt;var it;var ft=[];var lt=false;if(F>0){if(Dj(t.group[t.GroupLevel].gflags&tc.GFLAG_IN_FRAME)||kl[F].ShapeType!=0||Nj(kl[F].flags&tc.PARA_FRAME_OBJECT))F=0}f=t.GroupLevel;e=r=t.GroupLevel;c=t.group;L=Nj(c[e].gflags&tc.GFLAG_BACKGROUND)?true:false;S=c[e].InTable;if(!L)t.flags|=tc.RFLAG_READ_SHAPE_PICT;t.flags1=cj(t.flags1,tc.RFLAG1_PNG_FOUND);t.flags2=cj(t.flags2,tc.RFLAG2_PICT_FRAME_INSERTED);t.TextBoxParaFID=0;s=t.ShpGroup;for(z=t.ShpGroup;z<=t.GroupLevel;z++){c[z].shape.mask=0;c[z].shape.RelLeft=0;c[z].shape.RelRight=0;c[z].shape.RelTop=0;c[z].shape.RelBot=0;c[z].shape.GeoLeft=0;c[z].shape.GeoRight=0;c[z].shape.GeoTop=0;c[z].shape.GeoBot=0;if(Nj(c[e].gflags&tc.GFLAG_IN_SHPGRP)){}else{c[z].shape.LineWdth=0;c[z].shape.LineColor=tc.Color.black;c[z].shape.BackColor=tc.Color.white;c[z].shape.FillOpacity=0;c[z].shape.LineOpacity=0;c[z].shape.DistFromTextLeft=tc.FRAME_DIST_FROM_TEXT;c[z].shape.DistFromTextRight=tc.FRAME_DIST_FROM_TEXT;c[z].shape.DistFromTextTop=0;c[z].shape.DistFromTextBot=0;c[z].TextBoxMargin=144;c[z].TextBoxTopMarg=72;c[z].TextBoxBotMarg=72}}bT=-1;while(true){if(!r2(t))return tc.RTF_FILE_INCOMPLETE;if(t.GroupBegin)continue;if(t.GroupEnd){if(t.GroupLevel<f){if(Nj(c[t.GroupLevel].gflags&tc.GFLAG_IN_SHP)){c[t.GroupLevel].FrmFlags|=c[r].shape.FrmFlags;d2(t,r,false);if(OR>0&&kl[OR].PointCount>0)B2(t,C,I,r)}break}else continue}e=t.GroupLevel;if(t.IsControlWord){if(Tk(t.CurWord,"shpleft")==0){c[r].shape.x=t.IntParam;if(B&&OR>0)kl[OR].x=kl[OR].OrgX=c[r].shape.x}else if(Tk(t.CurWord,"shpright")==0){c[r].shape.width=t.IntParam-c[r].shape.x;if(B&&OR>0)kl[OR].width=c[r].shape.width}else if(Tk(t.CurWord,"shptop")==0){c[r].shape.y=t.IntParam;if(B&&OR>0)kl[OR].ParaY=kl[OR].OrgY=c[r].shape.y}else if(Tk(t.CurWord,"shpbottom")==0){c[r].shape.height=t.IntParam-c[r].shape.y;if(B&&OR>0)kl[OR].height=c[r].shape.height}else if(Tk(t.CurWord,"shpbxpage")==0)c[r].shape.FrmFlags|=tc.PARA_FRAME_HPAGE;else if(Tk(t.CurWord,"shpbxcolumn")==0)c[r].shape.FrmFlags|=tc.PARA_FRAME_HCOL;else if(Tk(t.CurWord,"shpbypage")==0)c[r].shape.FrmFlags|=tc.PARA_FRAME_VPAGE;else if(Tk(t.CurWord,"shpbymargin")==0)c[r].shape.FrmFlags|=tc.PARA_FRAME_VMARG;else if(Tk(t.CurWord,"shpbxignore")==0){c[r].shape.FrmFlags=cj(c[r].shape.FrmFlags,tc.PARA_FRAME_HPAGE);c[r].shape.FrmFlags|=tc.PARA_FRAME_IGNORE_X|tc.PARA_FRAME_HCOL}else if(Tk(t.CurWord,"shpbyignore")==0){c[r].shape.FrmFlags=cj(c[r].shape.FrmFlags,tc.PARA_FRAME_VPAGE|tc.PARA_FRAME_VMARG|tc.PARA_FRAME_VLINE);c[r].shape.FrmFlags|=tc.PARA_FRAME_IGNORE_Y}else if(Tk(t.CurWord,"shpwr")==0)c[r].shape.WrapType=c[s].shape.WrapType=t.IntParam;else if(Tk(t.CurWord,"shpwrk")==0)c[r].shape.WrapSide=c[s].shape.WrapSide=t.IntParam;else if(Tk(t.CurWord,"shpz")==0){c[r].shape.ZOrder=c[s].shape.ZOrder=t.IntParam}else if(Tk(t.CurWord,"ssshpalignleft")==0)c[r].shape.align=c[s].shape.align=tc.LEFT;else if(Tk(t.CurWord,"ssshpalignright")==0)c[r].shape.align=c[s].shape.align=tc.RIGHT_JUSTIFY;else if(Tk(t.CurWord,"shplid")==0)c[r].ShapeId=c[r].shape.ShapeId=t.IntParam;else if(Tk(t.CurWord,"shpfblwtxt")==0){N=t.IntParam;c[r].shape.FrmFlags=cj(c[r].shape.FrmFlags,tc.PARA_FRAME_BEHIND_TEXT);if(Nj(N))c[r].shape.FrmFlags|=tc.PARA_FRAME_BEHIND_TEXT}else if(Tk(t.CurWord,"sp")==0)A="";else if(Tk(t.CurWord,"sn")==0){A2(t);A=Gf}else if(Tk(t.CurWord,"sv")==0){var at=0,nt=0;var ct=null;if((Tk(A,"shapeType")==0||Tk(A,"pVerticies")==0)&&!L){var st=lt;lt=true;if((i=A2(t))>0)return i;E=Gf;a=0;if(Tk(A,"pVerticies")==0){j=/[\s;,\(\)\x0d\x0a]/;substr=E.split(j);ft=[];for(z=0;z<substr.length;z++){if(substr[z].length!=0)ft.push(substr[z])}substr=ft;if(substr.length>=2){at=LX(substr[0]);nt=LX(substr[1]);if(false&&nt==2)a=tc.SHPTYPE_LINE;else if(nt>1)a=tc.SHPTYPE_RECT;if(a==tc.SHPTYPE_LINE&&at==8&&substr.length>=6){var _t=LX(substr[2]);var ot=LX(substr[3]);var ut=LX(substr[4]);var Tt=LX(substr[5]);if(Nj(c[r].gflags&tc.GFLAG_IN_SHPGRP)){c[r].shape.x=_t;c[r].shape.y=ot}else{c[r].shape.x+=_t;c[r].shape.y+=ot}c[r].shape.width=ut-_t;c[r].shape.height=Tt-ot}else if(a==tc.SHPTYPE_RECT&&at==8&&substr.length>=2+nt*2){ct=[nt+1];for(z=0;z<nt;z++){ct[z]=new tc.Point;ct[z].x=LX(substr[2+z*2]);ct[z].y=LX(substr[2+z*2+1])}}}}else{a=LX(E);if(false&&a==2)a=tc.SHPTYPE_RECT;else if(a==32)a=tc.SHPTYPE_LINE;else if(a==132)a=tc.SHPTYPE_RECT;else if(a==120)a=tc.SHPTYPE_ELLIPSE;else if(a==109)a=tc.SHPTYPE_TEXT_BOX;else if(a==4)a=tc.SHPTYPE_CHART_DECISION}if(st&&c[r].shape.type!=a&&OR>0&&t.TextLine>=0&&t.TextLine<br){if(ui[t.TextLine].len==1){var At=ib(t.TextLine,0);if(xs[At].ParaFID==OR){fw(t.TextLine,0,1,"D");gb(At);kl[OR].InUse=false;OR=0;B=false;O=false;bT=-1;if(!L)t.flags|=tc.RFLAG_READ_SHAPE_PICT}}}c[r].shape.type=a;if(S){c[r].FrmFlags2|=tc.PF2_ANCHOR_IN_CELL;c[r].shape.FrmFlags2|=tc.PF2_ANCHOR_IN_CELL}if(a==tc.SHPTYPE_PICT_FRAME||a==tc.SHPTYPE_OCX)t.flags=cj(t.flags,tc.RFLAG_INSERT_BEF_PARA);if(a==tc.SHPTYPE_LINE||I2(t,a)){q=t.GroupLevel;d=a==tc.SHPTYPE_LINE;c[r].shape.FrmFlags|=d?tc.PARA_FRAME_LINE:tc.PARA_FRAME_RECT;c[r].FrmFlags|=c[r].shape.FrmFlags;c[r].gflags|=tc.GFLAG_USE_SHP_INFO;c[r].HPageGroup=r;if(Dj(c[r].shape.mask&tc.SM_FLINE)){c[r].shape.LineWdth=15;c[r].shape.FrmFlags|=tc.PARA_FRAME_BOXED}if(Nj(c[r].gflags&(tc.GFLAG_IN_SHPGRP|tc.GFLAG_IN_FRAME))||S||I2(t,a)||a==tc.SHPTYPE_LINE){it=new tc.ClsRtfPict;it.type=it.PictType=tc.PICT_SHAPE;O=true;c[r].gflags2|=tc.GFLAG2_PICT_SHAPE;OR=c[r].ParaFID;t.GroupLevel=r;t1(tc.RTF_PICT,t.group[t.GroupLevel],null,it,x);t.GroupLevel=q;B=true}else{c[r].FrmFlags|=tc.PARA_FRAME_USED;t.flags|=tc.RFLAG_INSERT_BEF_PARA;t.flags|=tc.RFLAG_NEW_FRAME;t.OutBuf+=wY(Bn);t.OutBufLen++;t.GroupLevel=r;if(!b1(t))return tc.RTF_END_FILE;t.GroupLevel=q;B=true}kl[OR].LineColor=c[r].shape.LineColor;kl[OR].BackColor=c[r].shape.BackColor;kl[OR].FillOpacity=c[r].shape.FillOpacity;kl[OR].LineOpacity=c[r].shape.LineOpacity;kl[OR].LineWdth=n;kl[OR].flags|=tc.PARA_FRAME_BOXED;kl[OR].PointCount=nt;kl[OR].pPoint=ct;if(d)G2(t,C,I);t.flags=cj(t.flags,tc.RFLAG_READ_SHAPE_PICT|tc.RFLAG_INSERT_BEF_PARA)}else if(a==tc.SHPTYPE_TEXT_BOX&&Dj(c[r].gflags&tc.GFLAG_IN_FRAME)){var Et=true;if(S){if(false&&ah>=tc.RTF_CB)Et=false;else{var Rt;for(Rt=br;Rt>0;Rt--)if(Nj(ui[Rt-1].flags&(tc.LFLAG_PARA|tc.LFLAG_BREAK)))break}}if(Et){c[r].FrmFlags|=tc.PARA_FRAME_USED|tc.PARA_FRAME_TEXT_BOX;c[r].FrmFlags|=c[r].shape.FrmFlags;c[r].gflags|=tc.GFLAG_USE_SHP_INFO;c[r].HPageGroup=r;c[r].shape.FrmFlags|=tc.PARA_FRAME_BOXED;c[r].shape.LineWdth=15;c[r].TextBoxMargin=144;c[r].TextBoxTopMarg=72;c[r].TextBoxBotMarg=72;c[r].shape.BackColor=tc.CLR_WHITE;c[r].shape.FillPattern=1;c[r].shape.FillOpacity=0;c[r].shape.LineOpacity=0;t.flags|=tc.RFLAG_INSERT_BEF_PARA;t.flags|=tc.RFLAG_NEW_FRAME}else a=0}else if(a!=tc.SHPTYPE_PICT_FRAME&&a!=tc.SHPTYPE_OCX)a=0;h=true}else if(Tk(A,"pSegmentInfo")==0){var Lt=[];if((i=A2(t))>0)return i;E=Gf;j=/[\s;,\(\)\x0d\x0a]/;substr=E.split(j);ft=[];for(z=0;z<substr.length;z++){if(substr[z].length!=0)ft.push(substr[z])}substr=ft;if(substr.length>=2){at=LX(substr[0]);nt=LX(substr[1]);if(at==2){Lt=[nt+1];for(z=0;z<nt;z++){Lt[z]=LX(substr[2+z])}kl[OR].SegmentCount=nt;kl[OR].pSegment=Lt}}}else if(Tk(A,"relLeft")==0){if((i=A2(t))>0)return i;E=Gf;c[r].shape.RelLeft=LX(E)}else if(Tk(A,"relRight")==0){if((i=A2(t))>0)return i;E=Gf;c[r].shape.RelRight=LX(E);c[r].shape.mask|=tc.SM_REL_RIGHT}else if(Tk(A,"relTop")==0){if((i=A2(t))>0)return i;E=Gf;c[r].shape.RelTop=LX(E)}else if(Tk(A,"relBottom")==0){if((i=A2(t))>0)return i;E=Gf;c[r].shape.RelBot=LX(E);c[r].shape.mask|=tc.SM_REL_BOT}else if(Tk(A,"geoLeft")==0){if((i=A2(t))>0)return i;E=Gf;c[r].shape.GeoLeft=LX(E)}else if(Tk(A,"geoTop")==0){if((i=A2(t))>0)return i;E=Gf;c[r].shape.GeoTop=LX(E)}else if(Tk(A,"geoRight")==0){if((i=A2(t))>0)return i;E=Gf;c[r].shape.GeoRight=LX(E);c[r].shape.mask|=tc.SM_GEO_RIGHT}else if(Tk(A,"geoBottom")==0){if((i=A2(t))>0)return i;E=Gf;c[r].shape.GeoBot=LX(E);c[r].shape.mask|=tc.SM_GEO_BOT}else if(Tk(A,"posv")==0){$=Nj(t.flags2&tc.RFLAG2_PICT_FRAME_INSERTED)&&t.PictFID>0?t.PictFID:OR;if((i=A2(t))>0)return i;E=Gf;tt=LX(E);if($>0){kl[$].flags=cj(kl[$].flags,tc.PARA_FRAME_VCENTER);kl[$].flags2=cj(kl[$].flags2,tc.PF2_VTOP|tc.PF2_VBOTTOM);if(tt==1)kl[$].flags2|=tc.PF2_VTOP;else if(tt==2)kl[$].flags|=tc.PARA_FRAME_VCENTER;else if(tt==3)kl[$].flags2|=tc.PF2_VBOTTOM}c[r].shape.FrmFlags=cj(c[r].shape.FrmFlags,tc.PARA_FRAME_VCENTER);c[r].shape.FrmFlags2=cj(c[r].shape.FrmFlags2,tc.PF2_VTOP|tc.PF2_VBOTTOM);if(tt==1)c[r].shape.FrmFlags2|=tc.PF2_VTOP;else if(tt==2)c[r].shape.FrmFlags|=tc.PARA_FRAME_VCENTER;else if(tt==3)c[r].shape.FrmFlags2|=tc.PF2_VBOTTOM;if(tt==2&&r>0)c[r-1].FrmFlags2|=tc.PF2_VTOP}else if(Tk(A,"posh")==0){$=Nj(t.flags2&tc.RFLAG2_PICT_FRAME_INSERTED)&&t.PictFID>0?t.PictFID:OR;if((i=A2(t))>0)return i;E=Gf;tt=LX(E);if($>0){if(tt==1)kl[$].x=kl[$].OrgX=0;else if(tt==2)kl[$].flags|=tc.PARA_FRAME_CENTER;else if(tt==3)kl[$].flags|=tc.PARA_FRAME_RIGHT_JUST}if(tt==1)c[r].shape.x=0;else if(tt==2)c[r].shape.FrmFlags|=tc.PARA_FRAME_CENTER;else if(tt==3)c[r].shape.FrmFlags|=tc.PARA_FRAME_RIGHT_JUST}else if(Tk(A,"posrelv")==0&&Dj(c[r].gflags&tc.GFLAG_IN_SHPGRP)){if(Nj(c[r].shape.FrmFlags&tc.PARA_FRAME_IGNORE_Y)){if((i=A2(t))>0)return i;E=Gf;J=LX(E);if(J==4)J=1;$=Nj(t.flags2&tc.RFLAG2_PICT_FRAME_INSERTED)&&t.PictFID>0?t.PictFID:OR;if($>0){kl[$].flags=cj(kl[$].flags,tc.PARA_FRAME_VPAGE|tc.PARA_FRAME_VMARG|tc.PARA_FRAME_VLINE);if(J==0)kl[$].flags|=tc.PARA_FRAME_VMARG;else if(J==1)kl[$].flags|=tc.PARA_FRAME_VPAGE;else if(J==3)kl[$].flags|=tc.PARA_FRAME_VLINE;if(J==5)kl[$].flags2|=tc.PF2_VBOT_MARG}c[r].shape.FrmFlags=cj(c[r].shape.FrmFlags,tc.PARA_FRAME_VPAGE|tc.PARA_FRAME_VMARG|tc.PARA_FRAME_VLINE);if(J==0)c[r].shape.FrmFlags|=tc.PARA_FRAME_VMARG;else if(J==1)c[r].shape.FrmFlags|=tc.PARA_FRAME_VPAGE;else if(J==3)c[r].shape.FrmFlags|=tc.PARA_FRAME_VLINE;if(J==5)c[r].shape.FrmFlags2|=tc.PF2_VBOT_MARG}}else if(Tk(A,"posrelh")==0&&Dj(c[r].gflags&tc.GFLAG_IN_SHPGRP)){if((i=A2(t))>0)return i;E=Gf;J=LX(E);if(J==4)J=1;$=Nj(t.flags2&tc.RFLAG2_PICT_FRAME_INSERTED)&&t.PictFID>0?t.PictFID:OR;if($>0){kl[$].flags=cj(kl[$].flags,tc.PARA_FRAME_HPAGE|tc.PARA_FRAME_HCHAR|tc.PARA_FRAME_HCOL);kl[$].flags2=cj(kl[$].flags2,tc.PF2_RIGHT_MARG);if(J==1){kl[$].x=kl[$].OrgX-jV(t.sect.LeftMargin);kl[$].flags|=tc.PARA_FRAME_HPAGE}else if(J==2)kl[$].flags|=tc.PARA_FRAME_HCOL;else if(J==3)kl[$].flags|=tc.PARA_FRAME_HCHAR;else if(J==5)kl[$].flags2|=tc.PF2_RIGHT_MARG}c[r].FrmFlags=cj(c[r].FrmFlags,tc.PARA_FRAME_HPAGE|tc.PARA_FRAME_HCHAR|tc.PARA_FRAME_HCOL);c[r].shape.FrmFlags=cj(c[r].shape.FrmFlags,tc.PARA_FRAME_HPAGE|tc.PARA_FRAME_HCHAR|tc.PARA_FRAME_HCOL);c[r].shape.FrmFlags2=cj(c[r].shape.FrmFlags2,tc.PF2_RIGHT_MARG);if(J==1)c[r].shape.FrmFlags|=tc.PARA_FRAME_HPAGE;else if(J==2)c[r].shape.FrmFlags|=tc.PARA_FRAME_HCOL;else if(J==3)c[r].shape.FrmFlags|=tc.PARA_FRAME_HCHAR;else if(J==5)c[r].shape.FrmFlags2|=tc.PF2_RIGHT_MARG}else if(Tk(A,"pctHorz")==0){if((i=A2(t))>0)return i;E=Gf;$=Nj(t.flags2&tc.RFLAG2_PICT_FRAME_INSERTED)&&t.PictFID>0?t.PictFID:OR;if($>0)kl[$].WidthFactor=LX(E);c[r].shape.WidthFactor=LX(E)}else if(Tk(A,"pctVert")==0){if((i=A2(t))>0)return i;E=Gf;$=Nj(t.flags2&tc.RFLAG2_PICT_FRAME_INSERTED)&&t.PictFID>0?t.PictFID:OR;if($>0)kl[$].HeightFactor=LX(E);c[r].shape.HeightFactor=LX(E)}else if(Tk(A,"hspNext")==0){var Ct;if((i=A2(t))>0)return i;E=Gf;Ct=LX(E);$=Nj(t.flags2&tc.RFLAG2_PICT_FRAME_INSERTED)&&t.PictFID>0?t.PictFID:c[r].ParaFID;if($>0)kl[$].NextShapeId=Ct;c[r].shape.NextShapeId=Ct}else if(Tk(A,"fHidden")==0){var It;if((i=A2(t))>0)return i;E=Gf;It=LX(E);$=Nj(t.flags2&tc.RFLAG2_PICT_FRAME_INSERTED)&&t.PictFID>0?t.PictFID:OR;if(It==1){if($>0)kl[$].flags2|=tc.PF2_HIDDEN;c[r].shape.FrmFlags2|=tc.PF2_HIDDEN}}else if(Tk(A,"fAllowOverlap")==0&&Dj(c[e].gflags&tc.GFLAG_IN_SHPGRP)){var dt;if((i=A2(t))>0)return i;E=Gf;dt=LX(E);$=Nj(t.flags2&tc.RFLAG2_PICT_FRAME_INSERTED)&&t.PictFID>0?t.PictFID:OR;if(dt==0){if($>0)kl[$].flags2|=tc.PF2_NO_OVERLAP;c[r].shape.FrmFlags2|=tc.PF2_NO_OVERLAP}}else if(Tk(A,"fFitShapeToText")==0){var Ft;if((i=A2(t))>0)return i;E=Gf;Ft=LX(E);$=Nj(t.flags2&tc.RFLAG2_PICT_FRAME_INSERTED)&&t.PictFID>0?t.PictFID:OR;if(Ft==1){if($>0)kl[$].flags2|=tc.PF2_SIZE_TO_TEXT;c[r].shape.FrmFlags2|=tc.PF2_SIZE_TO_TEXT}}else if(Tk(A,"fPseudoInline")==0&&Dj(c[r].gflags&tc.GFLAG_IN_SHPGRP)){var gt;if((i=A2(t))>0)return i;E=Gf;gt=LX(E)==1?true:false;if(gt){$=Nj(t.flags2&tc.RFLAG2_PICT_FRAME_INSERTED)&&t.PictFID>0?t.PictFID:OR;if($>0)kl[$].flags2|=tc.PF2_INLINE;c[r].shape.FrmFlags2|=tc.PF2_INLINE;if(Nj(t.flags2&tc.RFLAG2_PICT_FRAME_INSERTED)&&t.PictFID>0){Q=kl[$].pict;xs[Q].PictWidth=kl[$].width-2*kl[$].margin;xs[Q].PictHeight=kl[$].height-2*kl[$].margin;if(xs[Q].PictWidth<=0)xs[Q].PictWidth=1;if(xs[Q].PictHeight<=0)xs[Q].PictHeight=1;HN(Q,hV(xs[Q].PictHeight),dV(xs[Q].PictWidth),false);mN(Q)}}}else if(Tk(A,"fLayoutInCell")==0){if((i=A2(t))>0)return i;E=Gf;var Pt=LX(E);$=Nj(t.flags2&tc.RFLAG2_PICT_FRAME_INSERTED)&&t.PictFID>0?t.PictFID:OR;if($>0){kl[$].flags=cj(kl[$].flags,tc.PARA_FRAME_IN_CELL);if(Pt==1)kl[$].flags|=tc.PARA_FRAME_IN_CELL}c[r].shape.FrmFlags=cj(c[r].shape.FrmFlags,tc.PARA_FRAME_IN_CELL);if(Pt==1)c[r].shape.FrmFlags|=tc.PARA_FRAME_IN_CELL}else if(Tk(A,"lineWidth")==0){$=Nj(t.flags2&tc.RFLAG2_PICT_FRAME_INSERTED)&&t.PictFID>0?t.PictFID:OR;if(h){if((i=A2(t))>0)return i;E=Gf;n=LX(E);n=GV(n);if((a==tc.SHPTYPE_LINE||a==tc.SHPTYPE_RECT)&&$>0){kl[$].LineWdth=n;kl[$].flags|=tc.PARA_FRAME_BOXED}if(a==tc.SHPTYPE_TEXT_BOX||a==tc.SHPTYPE_RECT){c[r].shape.LineWdth=n;c[r].shape.FrmFlags|=tc.PARA_FRAME_BOXED}}}else if(Tk(A,"fLine")==0){$=Nj(t.flags2&tc.RFLAG2_PICT_FRAME_INSERTED)&&t.PictFID>0?t.PictFID:OR;if((i=A2(t))>0)return i;E=Gf;h=Nj(LX(E));c[r].shape.mask|=tc.SM_FLINE;if(h)n=20;else n=0;if(a==tc.SHPTYPE_TEXT_BOX||a==tc.SHPTYPE_RECT||a==tc.SHPTYPE_PICT_FRAME||!lt){if(h){if(c[r].shape.LineWdth==0)c[r].shape.LineWdth=n;c[r].shape.FrmFlags|=tc.PARA_FRAME_BOXED;if($>0){kl[$].flags|=tc.PARA_FRAME_BOXED;if(kl[$].LineWdth==0)kl[$].LineWdth=n}}else{c[r].shape.FrmFlags=cj(c[r].shape.FrmFlags,tc.PARA_FRAME_BOXED);if($>0)kl[$].flags=cj(kl[$].flags,tc.PARA_FRAME_BOXED)}}else if(a==tc.SHPTYPE_LINE){if(!h){kl[$].flags|=tc.PARA_FRAME_NO_LINE;if($>0)kl[$].flags=cj(kl[$].flags,tc.PARA_FRAME_NO_LINE)}}}else if(Tk(A,"lineDashing")==0){$=Nj(t.flags2&tc.RFLAG2_PICT_FRAME_INSERTED)&&t.PictFID>0?t.PictFID:OR;var St;if((i=A2(t))>0)return i;E=Gf;St=LX(E);if(St==6||St==2){if((a==tc.SHPTYPE_LINE||a==tc.SHPTYPE_RECT||a==tc.SHPTYPE_PICT_FRAME)&&$>0){kl[$].flags|=tc.PARA_FRAME_DOTTED|tc.PARA_FRAME_BOXED}if(a==tc.SHPTYPE_TEXT_BOX||a==tc.SHPTYPE_RECT){c[r].shape.FrmFlags|=tc.PARA_FRAME_DOTTED|tc.PARA_FRAME_BOXED}}}else if(Tk(A,"pictureTransparent")==0){if((i=A2(t))>0)return i;E=Gf;U=new tc.Color(LX(E));W=true}else if(Tk(A,"fillBlip")==0){for(z=r;z<=t.GroupLevel;z++)c[z].shape.FrmFlags|=tc.PARA_FRAME_FILL_PICT;if(!L)t.flags|=tc.RFLAG_READ_SHAPE_PICT;D=false;M=true}else if(Tk(A,"fillType")==0){var ht;if((i=A2(t))>0)return i;E=Gf;ht=LX(E);if(ht==3){for(z=r;z<=t.GroupLevel;z++)c[z].shape.FrmFlags|=tc.PARA_FRAME_FILL_PICT;if(!L)t.flags|=tc.RFLAG_READ_SHAPE_PICT;D=true}}else if(Tk(A,"pibName")==0){t.flags|=tc.RFLAG_IGNORE_SLASH;if((i=A2(t))>0)return i;R=Gf;t.flags=cj(t.flags,tc.RFLAG_IGNORE_SLASH);E=Xk(R);a2(E);if(bT<0){c[t.GroupLevel].LinkPictWidth=c[r].shape.width;c[t.GroupLevel].LinkPictHeight=c[r].shape.height;bT=Q1(t,E)}else{_i.TerPictLinkName(bT,false,E);E=LP}if(bT>=0)t.flags=cj(t.flags,tc.RFLAG_READ_SHAPE_PICT)}else if(Tk(A,"pibFlags")==0){if((i=A2(t))>0)return i;E=Gf;if(bT>=0&&E!="10"&&E!="14"){var Ot="";_i.TerPictLinkName(bT,false,Ot);Ot=LP}}else if(Tk(A,"fillOpacity")==0){if((i=A2(t))>0)return i;E=Gf;tt=LX(E)/256;tt++;c[r].shape.FillOpacity=tt;if((a==tc.SHPTYPE_LINE||I2(t,a))&&OR>0){kl[OR].FillOpacity=tt}if(a==tc.SHPTYPE_TEXT_BOX&&t.TextBoxParaFID>0){$=t.TextBoxParaFID;kl[$].FillOpacity=tt}}else if(Tk(A,"lineOpacity")==0){if((i=A2(t))>0)return i;E=Gf;tt=LX(E)/256;tt++;c[r].shape.LineOpacity=tt;if((a==tc.SHPTYPE_LINE||I2(t,a))&&OR>0){kl[OR].LineOpacity=tt}if(a==tc.SHPTYPE_TEXT_BOX&&t.TextBoxParaFID>0){$=t.TextBoxParaFID;kl[$].LineOpacity=tt}}else if(Tk(A,"fillColor")==0){if((i=A2(t))>0)return i;E=Gf;rt=new tc.Color(LX(E));if(L&&ah<tc.RTF_CB&&Dj(Qh&tc.TFLAG3_NO_RTF_BKND_COLOR)){if(Nj(tO&tc.TFLAG6_SAVE_TEXT_BK_COLOR))jT=rt;else $T=rt}if((a==tc.SHPTYPE_LINE||I2(t,a))&&OR>0){kl[OR].BackColor=rt;kl[OR].FillPattern=g}if(a==tc.SHPTYPE_TEXT_BOX&&t.TextBoxParaFID>0){$=t.TextBoxParaFID;kl[OR].BackColor=rt;kl[OR].FillPattern=g}if(a==tc.SHPTYPE_TEXT_BOX||I2(t,a)||a==tc.SHPTYPE_PICT_FRAME||!lt){c[r].shape.BackColor=rt;c[r].shape.FillPattern=g}w=true}else if(Tk(A,"fFilled")==0){if((i=A2(t))>0)return i;E=Gf;tt=LX(E);if(tt==0){c[r].shape.BackColor=tc.CLR_WHITE;g=c[r].shape.FillPattern=0;if((a==tc.SHPTYPE_LINE||I2(t,a))&&OR>0){kl[OR].BackColor=tc.CLR_WHITE;kl[OR].FillPattern=0}if(a==tc.SHPTYPE_TEXT_BOX&&t.TextBoxParaFID>0){$=t.TextBoxParaFID;kl[OR].BackColor=tc.CLR_WHITE;kl[OR].FillPattern=0}}else if(tt==1&&!w){c[r].shape.BackColor=tc.CLR_WHITE_FORCE;g=c[r].shape.FillPattern=1;if((a==tc.SHPTYPE_LINE||I2(t,a))&&OR>0){kl[OR].BackColor=tc.CLR_WHITE_FORCE;kl[OR].FillPattern=1}if(a==tc.SHPTYPE_TEXT_BOX&&t.TextBoxParaFID>0){$=t.TextBoxParaFID;kl[$].BackColor=tc.CLR_WHITE_FORCE;kl[$].FillPattern=1}w=true}m=true}else if(Tk(A,"lineColor")==0){if((i=A2(t))>0)return i;E=Gf;rt=new tc.Color(LX(E));if((a==tc.SHPTYPE_LINE||I2(t,a))&&OR>0){kl[OR].LineColor=rt}if(a==tc.SHPTYPE_TEXT_BOX||a==tc.SHPTYPE_RECT){c[r].shape.LineColor=rt}if(a==tc.SHPTYPE_PICT_FRAME){$=Nj(t.flags2&tc.RFLAG2_PICT_FRAME_INSERTED)&&t.PictFID>0?t.PictFID:OR;kl[$].LineColor=rt}}else if(Tk(A,"adjustValue")==0){if((i=A2(t))>0)return i;E=Gf;tt=LX(E);if(OR>0)kl[OR].AdjVal1=tt;c[r].shape.AdjVal1=tt}else if(Tk(A,"rotation")==0){if((i=A2(t))>0)return i;E=Gf;tt=LX(E);V=tt;if(OR>0)kl[OR].rotation=tt}else if(Tk(A,"adjust2Value")==0){if((i=A2(t))>0)return i;E=Gf;tt=LX(E);if(OR>0)kl[OR].AdjVal2=tt;c[r].shape.AdjVal2=tt}else if(Tk(A,"lineEndArrowhead")==0){if((i=A2(t))>0)return i;E=Gf;tt=LX(E);if(tt!=0&&a==tc.SHPTYPE_LINE&&OR>0){kl[OR].flags2|=tc.PF2_END_ARROW}}else if(Tk(A,"lineStartArrowhead")==0){if((i=A2(t))>0)return i;E=Gf;tt=LX(E);if(tt!=0&&a==tc.SHPTYPE_LINE&&OR>0){kl[OR].flags2|=tc.PF2_START_ARROW}}else if(Tk(A,"txflTextFlow")==0){var vt,pt=0;if((i=A2(t))>0)return i;E=Gf;vt=LX(E);if(vt==tc.TEXTFLOW_T2B||vt==tc.TEXTFLOW_T2B_NON_ANSII)pt=270;else if(vt==tc.TEXTFLOW_B2T)pt=90;for(z=t.ShpGroup;z<=t.GroupLevel;z++)c[z].TextAngle=pt}else if(Tk(A,"fBehindDocument")==0){var Nt;if((i=A2(t))>0)return i;E=Gf;Nt=LX(E);c[r].shape.FrmFlags2=cj(c[r].shape.FrmFlags2,tc.PF2_BEHIND_DOC);if(Nj(Nt))c[r].shape.FrmFlags2|=tc.PF2_BEHIND_DOC;$=Nj(t.flags2&tc.RFLAG2_PICT_FRAME_INSERTED)&&t.PictFID>0?t.PictFID:OR;if($>0&&$!=P){kl[$].flags2=cj(kl[$].flags2,tc.PF2_BEHIND_DOC);if(Nj(Nt))kl[$].flags2|=tc.PF2_BEHIND_DOC}}else if(Tk(A,"dxTextLeft")==0){if((i=A2(t))>0)return i;E=Gf;et=LX(E);c[r].TextBoxMargin=GV(et);H=true}else if(Tk(A,"dyTextTop")==0){if((i=A2(t))>0)return i;E=Gf;et=LX(E);c[r].TextBoxTopMarg=GV(et)}else if(Tk(A,"dyTextBottom")==0){if((i=A2(t))>0)return i;E=Gf;et=LX(E);c[r].TextBoxBotMarg=GV(et)}else if(Tk(A,"dxWrapDistLeft")==0){if((i=A2(t))>0)return i;E=Gf;Z=LX(E);c[r].shape.DistFromTextLeft=GV(Z)}else if(Tk(A,"dxWrapDistRight")==0){if((i=A2(t))>0)return i;E=Gf;Z=LX(E);c[r].shape.DistFromTextRight=GV(Z)}else if(Tk(A,"dyWrapDistTop")==0){if((i=A2(t))>0)return i;E=Gf;Z=LX(E);c[r].shape.DistFromTextTop=GV(Z)}else if(Tk(A,"dyWrapDistBot")==0){if((i=A2(t))>0)return i;E=Gf;Z=LX(E);c[r].shape.DistFromTextBot=GV(Z)}else if(Tk(A,"fFlipH")==0||Tk(A,"fRelFlipH")==0){if((i=A2(t))>0)return i;E=Gf;C=Nj(LX(E));if(d&&C)G2(t,C,I)}else if(Tk(A,"fFlipV")==0||Tk(A,"fRelFlipV")==0){if((i=A2(t))>0)return i;E=Gf;I=Nj(LX(E));if(d&&I)G2(t,C,I)}else if(Tk(A,"wzName")==0){if((i=A2(t))>0)return i;E=Gf;if(true||E.indexOf("WordPictureWatermark")>=0||E.indexOf("WaterMark")>=0||Tk(E,"TerPictureWatermark")==0){var Dt=Tk(E,"TerPictureWatermark")==0;if(Nj(t.flags2&tc.RFLAG2_PICT_FRAME_INSERTED)&&t.PictFID>0){if(ah<tc.RTF_CB){if(Dt)$l=t.PictFID;if(E.indexOf("WaterMark")>=0||Dt){kl[t.PictFID].flags|=tc.PARA_FRAME_WATERMARK}Q=kl[t.PictFID].pict;if(v!=0||p!=65536){F2(Q,v,p);ea=true}else{ta=null}HN(Q,hV(xs[Q].PictHeight),dV(xs[Q].PictWidth),true);mN(Q)}if(Dt)fw(t.PictFrameLine,t.PictFrameCol,1,tc.CHAR_D)}if(E.indexOf("WaterMark")>=0||Dt){c[r].FrmFlags|=tc.PARA_FRAME_WATERMARK;c[r].shape.FrmFlags|=tc.PARA_FRAME_WATERMARK}}}else if(Tk(A,"cropFromLeft")==0){if((i=A2(t))>0)return i;E=Gf;k=LX(E)}else if(Tk(A,"cropFromRight")==0){if((i=A2(t))>0)return i;E=Gf;X=LX(E)}else if(Tk(A,"cropFromTop")==0){if((i=A2(t))>0)return i;E=Gf;K=LX(E)}else if(Tk(A,"cropFromBottom")==0){if((i=A2(t))>0)return i;E=Gf;Y=LX(E)}else if(Tk(A,"pictureBrightness")==0){if((i=A2(t))>0)return i;E=Gf;v=LX(E)}else if(Tk(A,"pictureContrast")==0){if((i=A2(t))>0)return i;E=Gf;p=LX(E)}else if(Tk(A,"wzDescription")==0){if((i=A2(t))>0)return i;b=Gf}}else if(Tk(t.CurWord,"pict")==0){var Mt=bT;if(M)bT=-1;if(bT>=0||Dj(t.flags&tc.RFLAG_READ_SHAPE_PICT))y1(t);else if(M&&a==tc.SHPTYPE_LINE)y1(t);else{var Gt=k;var Bt=X;var Ht=K;var mt=Y;if(c[r].shape.width>0){k=Mj(k,c[r].shape.width,65536);X=Mj(X,c[r].shape.width,65536)}else k=X=0;if(c[r].shape.height>0){K=Mj(K,c[r].shape.height,65536);Y=Mj(Y,c[r].shape.height,65536)}else K=Y=0;if(Nj(c[r].gflags&tc.GFLAG_IN_SHPGRP))d2(t,r,false);i=p2(t,c[r].shape.width,c[r].shape.height,c[r].shape.FillPattern,c[r].shape.BackColor,k,X,K,Y);if(Nj(i))return i;if(t.TeVersion==0||t.TeVersion>=23001){if(bT>0){xs[bT].CropLeftFixed=Gt;xs[bT].CropRightFixed=Bt;xs[bT].CropTopFixed=Ht;xs[bT].CropBotFixed=mt;xs[bT].CropLeft=Mj(Gt,xs[bT].bmWidth,65536);xs[bT].CropRight=Mj(Bt,xs[bT].bmWidth,65536);xs[bT].CropTop=Mj(Ht,xs[bT].bmHeight,65536);xs[bT].CropBot=Mj(mt,xs[bT].bmHeight,65536)}}if(bT>0){xs[bT].rotation=V/6e4;if(xs[bT].rotation<=-360||xs[bT].rotation>=360)xs[bT].rotation=0;if(xs[bT].rotation<0)xs[bT].rotation=360+xs[bT].rotation}if(bT>0){$=xs[bT].ParaFID;if($>0&&Nj(kl[$].flags&tc.PARA_FRAME_RECT)&&a==tc.SHPTYPE_PICT_FRAME){kl[$].flags=cj(kl[$].flags,tc.PARA_FRAME_RECT);c[r].shape.FrmFlags=cj(c[r].shape.FrmFlags,tc.PARA_FRAME_RECT);kl[$].ShapeType=a}}if(Nj(c[t.GroupLevel].shape.FrmFlags&tc.PARA_FRAME_FILL_PICT)&&c[t.GroupLevel].shape.FillPict>0){for(z=r;z<t.GroupLevel;z++)c[z].shape.FillPict=c[t.GroupLevel].shape.FillPict;if((a==tc.SHPTYPE_LINE||a==tc.SHPTYPE_RECT)&&OR>0){kl[OR].flags|=tc.PARA_FRAME_FILL_PICT;kl[OR].FillPict=c[r].shape.FillPict}}else if(Dj(t.flags&tc.RFLAG_READ_SHAPE_PICT)&&Nj(t.flags&tc.RFLAG_INSERT_BEF_PARA)&&!L){t.OutBuf+=wY(Bn);t.OutBufLen++;b1(t)}if(M)bT=Mt;M=false}}else if(Tk(t.CurWord,"objemb")==0)l=tc.OBJ_EMBED;else if(Tk(t.CurWord,"objocx")==0)l=tc.OBJ_OCX;else if(Tk(t.CurWord,"objautlink")==0)l=tc.OBJ_LINK;else if(Tk(t.CurWord,"objupdate")==0)T=true;else if(Tk(t.CurWord,"sscontent")==0)u=tc.OASPECT_CONTENT;else if(Tk(t.CurWord,"ssicon")==0)u=tc.OASPECT_ICON;else if(Tk(t.CurWord,"objdata")==0){_=s2(t);o=Md}else if(Tk(t.CurWord,"shp")==0){y1(t)}else if(Tk(t.CurWord,"shpgrp")==0){y1(t)}else if(Dj(lO&tc.TFLAG11_PASTE_RTF_SHPTXT_IN_TABLE)&&ah>=tc.RTF_CB&&SR>0&&c[r].shape.type==tc.SHPTYPE_TEXT_BOX&&Tk(t.CurWord,"shptxt")==0&&PR>0&&c[r].InTable){if(OR>0){kl[OR].InUse=false;OR=0}if(o2(t)==0)return 0}else if(Tk(t.CurWord,"shptxt")==0){if(!lt&&Dj(lO&tc.TFLAG11_NO_DEFAULT_SHPTXT)){a=C2(t,r)}if(OR>0&&a==tc.SHPTYPE_LINE){t.flags|=tc.RFLAG_READ_SHAPE_PICT}else{if(I2(t,a)){if(br>0){var wt=br-1;if(O){for(wt=br-1;wt>=0;wt--){if(ui[wt].len==1){var bt=nb(wt);var xt=bt[0];sb(wt);if(Nj(xs[xt].style&tc.PICT)&&xs[xt].ParaFID==OR){fw(wt,0,1,tc.CHAR_D);gb(xt);kl[OR].InUse=false;OR=0;break}}}}else{for(wt=br-1;wt>=0;wt--)if(ui[wt].fid==OR)break;if(wt>=0&&ui[wt].fid>0){fw(wt,0,1,tc.CHAR_D);kl[OR].InUse=false;ui[wt].fid=OR=0}}c[r].shape.OrigType=a;c[r].shape.type=a=tc.SHPTYPE_TEXT_BOX;c[r].FrmFlags=cj(c[r].FrmFlags,tc.PARA_FRAME_RECT);c[r].shape.FrmFlags=cj(c[r].shape.FrmFlags,tc.PARA_FRAME_RECT);c[r].gflags2=cj(c[r].gflags2,tc.GFLAG2_PICT_SHAPE);c[r].FrmFlags|=tc.PARA_FRAME_USED|tc.PARA_FRAME_TEXT_BOX;c[r].shape.FrmFlags|=tc.PARA_FRAME_TEXT_BOX;c[r].FrmFlags|=c[r].shape.FrmFlags;c[r].gflags|=tc.GFLAG_USE_SHP_INFO;c[r].HPageGroup=r;if(!H)c[r].TextBoxMargin=144;if(!w)m=false;if(!m){c[r].shape.BackColor=tc.CLR_WHITE;c[r].shape.FillPattern=1}for(z=r+1;z<=t.GroupLevel;z++){c[z].shape=c[r].shape;c[z].FrmFlags=c[r].FrmFlags;c[z].gflags=c[r].gflags;c[z].gflags2=c[r].gflags2;c[z].HPageGroup=c[r].HPageGroup;c[z].TextBoxMargin=c[r].TextBoxMargin;c[z].TextBoxTopMarg=c[r].TextBoxTopMarg;c[z].TextBoxBotMarg=c[r].TextBoxBotMarg;c[z].shape.BackColor=c[r].shape.BackColor;c[z].shape.FillPattern=c[r].shape.FillPattern;c[z].shape.FillOpacity=c[r].shape.FillOpacity;c[z].shape.LineOpacity=c[r].shape.LineOpacity;c[z].shape.AdjVal1=c[r].shape.AdjVal1;c[z].shape.AdjVal2=c[r].shape.AdjVal2}t.flags|=tc.RFLAG_INSERT_BEF_PARA;t.flags|=tc.RFLAG_NEW_FRAME;t.flags|=tc.RFLAG_READ_SHAPE_PICT}}d2(t,r,true);if(a==tc.SHPTYPE_TEXT_BOX){if(c[r].shape.width<40&&c[r].shape.height<40)y1(t);else{var yt,Wt=PR,Ut=gR,kt=hR;var Xt=t.OpenRowId,Kt=t.OpenCellId,Yt=t.OpenLastCellX;var Vt=t.CurTblLevel;var jt=t.InTextBox;var Jt=t.FirstTbLine;var zt=t.TblLevel;for(z=r+1;z<=t.GroupLevel;z++){c[z].shape=c[r].shape;c[z].FrmFlags=c[r].FrmFlags;c[z].gflags=c[r].gflags;c[z].gflags2=c[r].gflags2;c[z].HPageGroup=c[r].HPageGroup;c[z].TextBoxMargin=c[r].TextBoxMargin;c[z].TextBoxTopMarg=c[r].TextBoxTopMarg;c[z].TextBoxBotMarg=c[r].TextBoxBotMarg;c[z].shape.BackColor=c[r].shape.BackColor;c[z].shape.FillPattern=c[r].shape.FillPattern;c[z].shape.FillOpacity=c[r].shape.FillOpacity;c[z].shape.LineOpacity=c[r].shape.LineOpacity}t.TextBoxParentInTable=c[r].InTable;t.TextBoxParentCellId=PR;t.TextBoxParentRowId=gR;t.TextBoxParentItapLevel=c[r].level;if(PR>0){if(c[r].InTable)t.flags2|=tc.RFLAG2_INSERT_BEF_TABLE;PR=gR=hR=0}t.CurTblLevel=0;t.OpenRowId=t.OpenCellId=t.OpenLastCellX=0;for(z=r;z<=t.GroupLevel;z++)c[z].InTable=false;t.TblLevel=[tc.MAX_TBL_LEVELS];for(z=0;z<tc.MAX_TBL_LEVELS;z++)t.TblLevel[z]=new tc.ClsRtfTableLevel;t.InstGroup=r;t.TextBoxParentFID=c[r].ParaFID;t.InTextBox=true;t.FirstTbLine=true;yt=u2(t);if(yt!=0)return yt;t.flags2=cj(t.flags2,tc.RFLAG2_INSERT_BEF_TABLE);t.InTextBox=jt;t.FirstTbLine=Jt;PR=Wt;gR=Ut;hR=kt;t.OpenRowId=Xt;t.OpenCellId=Kt;t.OpenLastCellX=Yt;t.CurTblLevel=Vt;t.TblLevel=zt;t.TextBoxParentInTable=false;t.TextBoxParentCellId=0;t.TextBoxParentRowId=0}t.flags=cj(t.flags,tc.RFLAG_READ_SHAPE_PICT)}}}}}if(a==tc.SHPTYPE_TEXT_BOX&&Nj(t.flags&tc.RFLAG_READ_SHAPE_PICT)){q=t.GroupLevel;it=new tc.ClsRtfPict;t.flags=cj(t.flags,tc.RFLAG_INSERT_BEF_PARA);t.flags2=cj(t.flags2,tc.RFLAG2_INSERT_BEF_TABLE);c[r].shape.type=tc.SHPTYPE_RECT;c[r].FrmFlags=cj(c[r].FrmFlags,tc.PARA_FRAME_TEXT_BOX);c[r].shape.FrmFlags=cj(c[r].shape.FrmFlags,tc.PARA_FRAME_TEXT_BOX);c[r].FrmFlags|=tc.PARA_FRAME_RECT;c[r].shape.FrmFlags|=tc.PARA_FRAME_RECT;c[r].FrmFlags2|=tc.PF2_EMPTY_TEXT_BOX;c[r].shape.FrmFlags2|=tc.PF2_EMPTY_TEXT_BOX;it.type=tc.PICT_SHAPE;t.group[r].gflags2|=tc.GFLAG2_PICT_SHAPE;t.InstGroup=r;t.TextBoxParentFID=c[r].ParaFID;t.TextBoxParaFID=0;OR=t.TextBoxParentFID;t.GroupLevel=r;t1(tc.RTF_PICT,t.group[t.GroupLevel],null,it,x);t.GroupLevel=q;t.flags=cj(t.flags,tc.RFLAG_READ_SHAPE_PICT)}if(_!=null&&bT>0&&o>0&&l!=tc.OBJ_NONE)c2(t,_,l,o,u,T);if(G)t.flags|=tc.RFLAG_INSERT_BEF_PARA;else t.flags=cj(t.flags,tc.RFLAG_INSERT_BEF_PARA);if(Nj(t.flags&tc.RFLAG_READ_SHAPE_PICT)&&Nj(t.flags1&tc.RFLAG1_PNG_FOUND)){c[s].shape=c[r].shape}if(bT>=0){if(b.length>0){_i.TerPictAltInfo(bT,false,b);b=PP}xs[bT].PictXparentColor=U;xs[bT].PictXparent=W}if(!D&&Dj(t.flags2&tc.RFLAG2_NEW_FRAME_CREATED))OR=F;if(a==tc.SHPTYPE_TEXT_BOX&&Dj(t.group[r].gflags2&tc.GFLAG2_PICT_SHAPE))OR=F;if(F>0&&a!=tc.SHPTYPE_TEXT_BOX&&t.TextLine==y+1)ui[t.TextLine].fid=F;t.TextBoxParaFID=0;t.PictFID=0;return 0}function C2(t,e){var r,i=0;var f=t.group;if(Nj(f[e].gflags&tc.GFLAG_IN_FRAME))return 0;f[e].shape.type=i=tc.SHPTYPE_TEXT_BOX;if(f[e].InTable){f[e].FrmFlags2|=tc.PF2_ANCHOR_IN_CELL;f[e].shape.FrmFlags2|=tc.PF2_ANCHOR_IN_CELL}f[e].FrmFlags|=tc.PARA_FRAME_USED|tc.PARA_FRAME_TEXT_BOX;f[e].FrmFlags|=f[e].shape.FrmFlags;f[e].gflags|=tc.GFLAG_USE_SHP_INFO;f[e].HPageGroup=e;t.flags|=tc.RFLAG_INSERT_BEF_PARA;t.flags|=tc.RFLAG_NEW_FRAME;for(r=e+1;r<=t.GroupLevel;r++){f[r].shape=f[e].shape;f[r].FrmFlags=f[e].FrmFlags;f[r].gflags=f[e].gflags;f[r].gflags2=f[e].gflags2;f[r].HPageGroup=f[e].HPageGroup;f[r].TextBoxMargin=f[e].TextBoxMargin;f[r].TextBoxTopMarg=f[e].TextBoxTopMarg;f[r].TextBoxBotMarg=f[e].TextBoxBotMarg;f[r].shape.BackColor=f[e].shape.BackColor;f[r].shape.FillPattern=f[e].shape.FillPattern;f[r].shape.FillOpacity=f[e].shape.FillOpacity;f[r].shape.LineOpacity=f[e].shape.LineOpacity;f[r].shape.AdjVal1=f[e].shape.AdjVal1;f[r].shape.AdjVal2=f[e].shape.AdjVal2}return i}function I2(t,e){if(e==tc.SHPTYPE_ROUND_RECT)return true;if(e==tc.SHPTYPE_ELLIPSE)return true;if(e==tc.SHPTYPE_ARROW)return true;if(e==tc.SHPTYPE_RECT)return true;if(e==tc.SHPTYPE_LBRACKET)return true;if(e==tc.SHPTYPE_RBRACKET)return true;if(e==tc.SHPTYPE_CHART_DECISION)return true;if(e==tc.SHPTYPE_RR_CALLOUT)return true;if(e==tc.SHPTYPE_CHART_ALT_PROCESS)return true;if(e==tc.SHPTYPE_CHART_ONLINE_STORAGE)return true;if(e==tc.SHPTYPE_CHART_MAG_DRUM)return true;if(e==tc.SHPTYPE_CHART_PUNCHED_CARD)return true;if(e==tc.SHPTYPE_CROSSED_CIRCLE)return true;return false}function d2(t,e,r){var i=t.group;var f=i[e].shape.mask;var l=Nj(t.flags2&tc.RFLAG2_PICT_FRAME_INSERTED)&&t.PictFID>0?t.PictFID:OR;var a;if(i[e].shape.type==tc.SHPTYPE_TEXT_BOX&&t.TextBoxParaFID>0)l=t.TextBoxParaFID;if(Nj(f&tc.SM_REL_RIGHT)){var n,c,s;n=i[e].shape.RelWidth=i[e].shape.RelRight-i[e].shape.RelLeft;c=i[e].ShpGrp.GroupWidth;s=i[e].ShpGrp.width;i[e].shape.x=i[e].ShpGrp.left+Mj(i[e].shape.RelLeft-i[e].ShpGrp.GroupLeft,s,c);if(n==0||s==0)i[e].shape.width=0;else i[e].shape.width=Mj(n,s,c);if(l>0){a=kl[l].pict;kl[l].x=kl[l].OrgX=i[e].shape.x;kl[l].width=i[e].shape.width;kl[l].GrpRelX=kl[l].x-i[e].ShpGrp.left;kl[l].GrpWidth=i[e].ShpGrp.width;kl[l].GroupId=i[e].ShpgrpId;if(a>0){xs[a].PictWidth=kl[l].width-2*kl[l].margin;if(xs[a].PictWidth<=0)xs[a].PictWidth=1;HN(a,hV(xs[a].PictHeight),dV(xs[a].PictWidth),false);mN(a)}}}if(Nj(f&tc.SM_REL_BOT)){var _,o,u;_=i[e].shape.RelHeight=i[e].shape.RelBot-i[e].shape.RelTop;o=i[e].ShpGrp.GroupHeight;u=i[e].ShpGrp.height;i[e].shape.y=i[e].ShpGrp.top+Mj(i[e].shape.RelTop-i[e].ShpGrp.GroupTop,u,o);if(_==0||u==0)i[e].shape.height=0;else i[e].shape.height=Mj(_,u,o);if(l>0){a=kl[l].pict;kl[l].y=kl[l].ParaY=kl[l].OrgY=i[e].shape.y;kl[l].height=i[e].shape.height;kl[l].GrpRelY=kl[l].y-i[e].ShpGrp.top;kl[l].GrpHeight=i[e].ShpGrp.height;kl[l].GroupId=i[e].ShpgrpId;if(a>0){xs[a].PictHeight=kl[l].height-2*kl[l].margin;if(xs[a].PictHeight<=0)xs[a].PictHeight=1;HN(a,hV(xs[a].PictHeight),dV(xs[a].PictWidth),false);mN(a)}}}if(r||l==0)return true;kl[l].ShapeId=i[e].shape.ShapeId;kl[l].flags|=i[e].shape.FrmFlags;kl[l].flags2|=i[e].shape.FrmFlags2;kl[l].AdjVal1=i[e].shape.AdjVal1;kl[l].AdjVal2=i[e].shape.AdjVal2;if(Nj(f&tc.SM_FILLED)){kl[l].FillPattern=i[e].shape.FillPattern;kl[l].BackColor=i[e].shape.BackColor}return true}function F2(t,e,r){var i=.7;return true}function g2(t){var e,r,i;var f=t.group[t.GroupLevel];if(!MY(Ri+1)){QY(tc.MSG_LINE_TRUNCATED,tg.MsgString[tc.MSG_MAX_LINES_EXCEEDED]);return-1}e=br;if(Nj(f.flags&tc.PAGE_HDR_FTR)){if(e>0){var l=ui[e-1].pfmt;if(Dj(Nc[l].flags&tc.PAGE_HDR_FTR)&&Dj(ui[e-1].flags&tc.LFLAG_SECT)){for(r=e-1;r>=0;r--){if(Nj(Nc[ui[r].pfmt].flags&tc.PAGE_HDR_FTR)||Nj(ui[r].flags&tc.LFLAG_SECT))break}e=r+1}}}if(Nj(t.flags2&tc.RFLAG2_INSERT_BEF_TABLE)){while(e>0){var a=ui[e-1].cid;if(t.InTextBox&&!t.FirstTbLine&&OR>0&&ui[e-1].fid==OR)break;if(a==0){if(Nj(t.flags&tc.RFLAG_INSERT_BEF_PARA)||Nj(f.gflags&tc.GFLAG_INSERT_BEF_PARA)){if(Nj(ui[e-1].flags&(tc.LFLAG_PARA|tc.LFLAG_BREAK))||ui[e-1].fid>0)break}else break}e--}}else if(Nj(t.flags&tc.RFLAG_INSERT_BEF_PARA)||Nj(f.gflags&tc.GFLAG_INSERT_BEF_PARA)){while(e>0){if(Nj(ui[e-1].flags&(tc.LFLAG_PARA|tc.LFLAG_BREAK))||ui[e-1].fid>0)break;if(Nj(f.XmgFlags&tc.XMGFLAG_IN_TEXT_BOX)&&e-1<=t.group[f.ShapeGroup].XmlShape.LastLine)break;e--}}else if(t.InsertBefCell>0){i=eR[t.InsertAftCell].level;for(r=0;r<Ri;r++)if(E6(i,-ui[r].cid)==t.InsertBefCell)break;if(r<Ri)e=r;br=e}else if(t.InsertAftCell>0){i=eR[t.InsertAftCell].level;for(r=0;r<Ri;r++)if(E6(i,-ui[r].cid)==t.InsertAftCell)break;if(r<Ri){for(;r<Ri;r++)if(E6(i,-ui[r].cid)!=t.InsertAftCell)break;if(r<Ri)e=r}br=e}else if(t.TextBoxBefCell>0){for(r=0;r<e;r++)if(ui[r].cid==t.TextBoxBefCell)break;if(r<e)e=r}t.InsertBefCell=t.InsertAftCell=0;if(ah>=tc.RTF_CB&&ah!=tc.RTF_CB_APPEND||e!=br){iw(e,1,gk("B"))}else{Ri++;e=br=Ri-1;Ip(e)}if(ah>=tc.RTF_CB&&!TE&&!t.SomeTextRead&&!t.TableTextFound&&PR>0&&PR!=SR&&e>0){var n=e-1;for(;n>0;n--)if(ui[n].len>0)break;if(Dj(ui[n].flags&(tc.LFLAG_PARA|tc.LFLAG_BREAK|tc.LFLAG_SECT))){iw(e,1,gk("B"));Tm(e,0,1);var c=ui[e].txt;c[0]=Bn;var s=nb(e);if(ui[n].len==0)s[0]=tc.DEFAULT_CFMT;else s[0]=ib(n,ui[n].len-1);sb(e);ui[e].pfmt=ui[n].pfmt;ui[e].cid=ui[n].cid;ui[e].fid=ui[n].fid;br=e=e+1}}t.InsLine=e;return e}function P2(t,e){var r=t.group;var i;r[e].RtfGroup=e;if(e>1){var f=r[e-1].RtfGroup;var l=r[f].DefFont;r[e].TypeFace=r[f].font[l].name;r[e].FontFamily=r[f].font[l].family;r[e].CharSet=r[f].font[l].CharSet}r[e].DefFont=0;r[e].gflags2=cj(r[e].gflags2,tc.GFLAG2_DEF_FONT_XLATED);r[e].MaxRtfFonts=200;r[e].font=[r[e].MaxRtfFonts];for(i=0;i<r[e].MaxRtfFonts;i++)r[e].font[i]=(new tc.ClsRtfFont).init();if(e==t.TopColorGroup)r[e].color=null;if(r[e].color==null||Nj(fO&tc.TFLAG10_MERGE_NESTED_RTF_PROPS)){r[e].color=[aA];for(i=0;i<aA;i++){r[e].color[i]=new tc.ClsRtfColor;r[e].color[i].color=tc.Color.black}r[e].TotalRtfColors=0;if(e>t.TopColorGroup){for(i=1;i<e;i++){r[i].color=r[e].color;r[i].TotalRtfColors=r[e].TotalRtfColors}}}r[e].MaxRtfSID=200;r[e].RtfSID=[r[e].MaxRtfSID];for(i=0;i<r[e].MaxRtfSID;i++)r[e].RtfSID[i]=-1;for(i=0;i<X_;i++)W_[i].RtfIndex=-1;return true}function S2(t,e){var r;var i,f;if(t.group[e].RtfGroup!=e)return true;r=t.group;for(i=0;i<X_;i++){if(W_[i].RtfIndex==-1)continue;if(W_[i].next==0)continue;f=W_[i].next;if(f<0||f>=r[e].MaxRtfSID)W_[i].next=0;else W_[i].next=r[e].RtfSID[f]}r[e].font=null;r[e].RtfSID=null;if(e<=t.TopColorGroup){r[e].color=null;r[e].TotalRtfColors=0}return true}function h2(t){var e;e=t.GroupLevel;yd=t.group[e].RtfGroup;return t.group[yd]}function O2(t){var e;e=t.rtf;if(e.InXml)return true;if(e.CurTblLevel!=t.level&&Dj(e.flags1&tc.RFLAG1_SSSUBTABLE_USED))b2(e,e.GroupLevel,t.level,e.CurTblLevel);if(t.InTable&&gR<=0&&e.OpenRowId>0){gR=e.OpenRowId;PR=e.OpenCellId;hR=e.OpenLastCellX}if(!t.InTable){var r=gR;if(r>0){e.OpenRowId=gR;e.OpenCellId=PR;e.OpenLastCellX=hR}gR=0;PR=0;hR=0}var i=Nj(e.OutBuf)&&e.OutBuf.length>0?e.OutBuf.charCodeAt(0):0;if(t.InTable&&PR>0&&Nj(rR[PR].flags&tc.CAUX_CLOSED)&&i!=tc.ROW_CHAR){if(eR[PR].NextCell<=0&&!H1(e,e.group,e.GroupLevel))return false;PR=eR[PR].NextCell}if(e.CurTblLevel==1&&t.InTable&&PR==0&&i!=tc.ROW_CHAR){if(gR==0)G1(e,e.group,e.GroupLevel);if(!H1(e,e.group,e.GroupLevel))return false}if(gR>0){tR[gR].flags=cj(tR[gR].flags,tc.TAUX_RTF_DEL);tR[gR].flags|=tc.TAUX_HAS_NEW_TEXT}if(Dj(e.TableRead))e.InsertBefCell=0;if(e.InsertBefCell>0&&PR>0&&eR[e.InsertBefCell].level<eR[PR].level)e.InsertBefCell=0;return true}function v2(t,e,r,i,f){return p2(t,e,r,i,f,-1,-1,-1,-1)}function p2(t,e,r,i,f,l,a,n,c){var s,_,o=0,u,T=0,A=0,E=0,R=0;var L,C=0,I;var d=false,F=false,g=false,P,S=false;var h;var O="",v="";var p=[4];var N,D;var M=new tc.ClsRtfObject;var G=0;var B=Nj(t.group[t.GroupLevel].gflags&tc.GFLAG_IN_SHP)&&t.group[t.GroupLevel].shape.type!=tc.SHPTYPE_TEXT_BOX;var H=0,m=0,w=0,b=0,x;var y,W;o=t.GroupLevel;h=new tc.ClsRtfPict;h.type=-1;P=false;while(true){if(!r2(t))return tc.RTF_FILE_INCOMPLETE;if(t.GroupBegin)continue;if(t.GroupEnd){if(t.GroupLevel<o)break;else continue}if(F||d)continue;t:{if(t.IsControlWord){P=Tk(t.CurWord,"picwset")==0||Tk(t.CurWord,"pichset")==0;if(Tk(t.CurWord,"wmetafile")==0){h.MetaType=t.IntParam;h.type=tc.PICT_METAFILE}else if(Tk(t.CurWord,"emfblip")==0)h.type=tc.PICT_ENHMETAFILE;else if(Tk(t.CurWord,"dibitmap")==0)h.type=tc.PICT_DIBITMAP;else if(Tk(t.CurWord,"wbitmap")==0)h.type=tc.PICT_BITMAP;else if(Tk(t.CurWord,"jpegblip")==0)h.type=tc.PICT_JPEG;else if(Tk(t.CurWord,"pngblip")==0){if(Nj(Qh&tc.TFLAG3_READ_PNG))h.type=tc.PICT_PNG;else t.flags1|=tc.RFLAG1_PNG_FOUND}else if(Tk(t.CurWord,"ssctl")==0)h.type=tc.PICT_CONTROL;else if(Tk(t.CurWord,"picw")==0&&Dj(t.flags2&tc.RFLAG2_NO_VAL))h.OrigWidth=E=t.IntParam;else if(Tk(t.CurWord,"pich")==0&&Dj(t.flags2&tc.RFLAG2_NO_VAL))h.OrigHeight=A=t.IntParam;else if(Tk(t.CurWord,"picwgoal")==0&&Dj(t.flags2&tc.RFLAG2_NO_VAL))h.width=t.IntParam;else if(Tk(t.CurWord,"pichgoal")==0&&Dj(t.flags2&tc.RFLAG2_NO_VAL))h.height=t.IntParam;else if(Tk(t.CurWord,"piccropl")==0&&l==-1)h.CropLeft=t.IntParam;else if(Tk(t.CurWord,"piccropr")==0&&a==-1)h.CropRight=t.IntParam;else if(Tk(t.CurWord,"piccropt")==0&&n==-1)h.CropTop=t.IntParam;else if(Tk(t.CurWord,"piccropb")==0&&c==-1)h.CropBot=t.IntParam;else if(Tk(t.CurWord,"piccropl")==0)H=t.IntParam;else if(Tk(t.CurWord,"piccropr")==0)m=t.IntParam;else if(Tk(t.CurWord,"piccropt")==0)w=t.IntParam;else if(Tk(t.CurWord,"piccropb")==0)b=t.IntParam;else if(Tk(t.CurWord,"picscalex")==0)h.ScaleX=t.IntParam;else if(Tk(t.CurWord,"picscaley")==0)h.ScaleY=t.IntParam;else if(Tk(t.CurWord,"blipupi")==0)T=t.IntParam;else if(Tk(t.CurWord,"wbmbitspixel")==0)h.BitsPerPixel=t.IntParam;else if(Tk(t.CurWord,"wbmplanes")==0)h.planes=t.IntParam;else if(Tk(t.CurWord,"wbmwidthbytes")==0)h.WidthBytes=t.IntParam;else if(Tk(t.CurWord,"sspicalign")==0)h.align=t.IntParam;else if(Tk(t.CurWord,"sn")==0){A2(t);v=Gf}else if(Tk(t.CurWord,"sv")==0){if(Tk(v,"wzDescription")==0){t.group[t.GroupLevel].gflags2|=tc.GFLAG2_GET_CR_LF;if((u=A2(t))>0)return u;O=Gf;t.group[t.GroupLevel].gflags2=cj(t.group[t.GroupLevel].gflags2,tc.GFLAG2_GET_CR_LF);if(t.group[t.GroupLevel].IncludePictId>0&&O.length>0){_i.TerPictAltInfo(t.group[t.GroupLevel].IncludePictId,false,O)}}else if(Tk(v,"fHorizRule")==0){if((u=A2(t))>0)return u;y=Gf;if(Tk(y,"1")==0)h.IsHRule=true}else if(Tk(v,"ssctlclass")==0){if(h.form==null)h.form=new tc.ClsForm;if((u=A2(t))>0)return u;h.form.CtlClass=Gf;if(h.form.CtlClass=="JTextField")h.form.border=true;h.form.id=t.group[t.GroupLevel].AuxId}else if(Tk(v,"pictureBrightness")==0){if((u=A2(t))>0)return u;y=Gf;G=LX(y)}else if(Tk(v,"rotation")==0){if((u=A2(t))>0)return u;y=Gf;R=LX(y)/65536}else y1(t)}else if(Tk(t.CurWord,"bin")==0){if(t.param!=null&&t.param.length>0){C=t.IntParam;g=true;t.WordLen=0;if(C==0){h.width=h.height=0;break}else break t}}else if(Tk(t.CurWord,"picprop")==0)continue;else if(Tk(t.CurWord,"sp")==0)continue;else if(t.IgnoreText)y1(t);continue}else if(P){if(t.WordLen>0&&t.CurWord.charCodeAt(t.WordLen-1)==tc.SPACE)P=false;continue}else{if(t.WordLen==1&&t.CurWord.charCodeAt(0)==tc.SPACE)continue}}if(t.group[t.GroupLevel].IncludePictId>0){y1(t);return 0}for(_=t.WordLen-1;_>=0;_--){t.CurChar=t.CurWord.charCodeAt(_);l2(t)}L=g?2:4;for(s=0;s<L;s++){if(!i2(t))return tc.RTF_FILE_INCOMPLETE;p[s]=t.CurChar}if(g){N=p[0];D=p[1]}else{N=Fk(p[0])*16+Fk(p[1]);D=Fk(p[2])*16+Fk(p[3])}for(s=L-1;s>=0;s--){t.CurChar=p[s];l2(t)}if(N==tc.CHAR_B&&D==tc.CHAR_M){h.type=tc.PICT_DIBITMAP;L=14;for(s=0;s<L;s++){if(g&&!i2(t))break;else if(!g&&!f2(t))break}if(g&&C>0)C-=L}var U=0;var k=8192;I=0;h.data=null;if(h.type==tc.PICT_BITMAP){U+=k;I=D2(h,I,0);I=D2(h,I,h.OrigWidth);I=D2(h,I,h.OrigHeight);I=D2(h,I,h.WidthBytes);I=N2(h,I,h.planes);I=N2(h,I,h.BitsPerPixel)}h.data="";while(true){if(g&&!i2(t))break;else if(!g&&!f2(t))break;h.data+=String.fromCharCode(t.CurChar);I++;if(C>0&&I>=C)break}if(h.data=="")h.data=null;h.DataSize=I;if(I==0)F=true;if(F)continue;if(!g)l2(t);if(e!=0){if(B){h.width=e;h.ScaleX=100}else{W=h.ScaleX==0?100:h.ScaleX;if(W>0)h.width=Mj(e,100,W)}}if(r!=0){if(B){h.height=r;h.ScaleY=100}else{W=h.ScaleY==0?100:h.ScaleY;if(W>0)h.height=Mj(r,100,W)}}if(h.type!=tc.PICT_CONTROL){h.image=null;var X;var K=t.group[o];X=Nj(t.flags2&tc.RFLAG2_PICT_FRAME_INSERTED)&&t.PictFID>0?t.PictFID:0;if(Nj(K.gflags&tc.GFLAG_IN_SHPRSLT))X=0;if(h.image!=null){ge=Nt;Pe=wt;h.OrigHeight=wt;h.OrigWidth=Nt;h.OrigPictType=h.type;h.type=tc.PICT_IMAGE;if(h.width==0){h.width=h.OrigWidth}if(h.height==0){h.height=h.OrigHeight}if(h.width==0||h.height==0){if(B){h.width=K.shape.width;h.height=K.shape.height}if(h.width==0||h.height==0)return 0}if(X>0){h.width=kl[OR].width;h.height=kl[OR].height}}}else{if(Dj(eO&tc.TFLAG7_DONT_LOAD_CONTROLS)){h.form=new tc.ClsForm;h.form.CtlClass="";for(s=0;s<I;s++){var Y=h.data.charCodeAt(s);if(Y==0)break;h.form.CtlClass+=wY(Y)}if(Tk(h.form.CtlClass,"Edit")==0)h.form.CtlClass="JTextField"}}d=true}if(h.type==tc.PICT_CONTROL&&Nj(eO&tc.TFLAG7_DONT_LOAD_CONTROLS))return 0;if(!d&&t.group[t.GroupLevel].IncludePictId>0)return 0;if(!d&&Nj(rO&tc.TFLAG8_HTML_RTF_CONV))return 0;if(!d){if(!Bk(h))return 0}if(B){h.ScaleX=h.ScaleY=100}if(Nj(t.group[t.GroupLevel].shape.FrmFlags&tc.PARA_FRAME_FILL_PICT)){if((x=Nx())==-1)return 0;if(!Y2(t.group[t.GroupLevel],h,x))return 0;t.group[t.GroupLevel].shape.FillPict=x;if(OR>0){xs[x].PictWidth=kl[OR].width;xs[x].PictHeight=kl[OR].height;HN(x,xs[x].PictHeight,xs[x].PictWidth,false)}}else t1(tc.RTF_PICT,t.group[t.GroupLevel],null,h,M);if(t.TeVersion>0&&t.TeVersion<23001&&B){x=bT;var V=A;var j=E;if(V>0&&j>0){var J=1.15;xs[x].CropLeftFixed=Mj(H*J,65536,j);xs[x].CropRightFixed=Mj(m*J,65536,j);xs[x].CropTopFixed=Mj(w*J,65536,V);xs[x].CropBotFixed=Mj(b*J,65536,V);J=1.15;xs[x].CropLeft=H*J;xs[x].CropRight=m*J;xs[x].CropTop=w*J;xs[x].CropBot=b*J}}if(bT>=0&&O.length>0){_i.TerPictAltInfo(bT,false,O);O=PP}if(bT>=0&&G!=0)F2(bT,G,65536);if(bT>=0&&R!=0)xs[bT].rotation=R;t.flags=cj(t.flags,tc.RFLAG_READ_SHAPE_PICT);return 0}function N2(t,e,r){var i="";i+=String.fromCharCode(r&255);r>>=8;i+=String.fromCharCode(r&255);if(e==0)t.data=i+t.data;else if(e==t.data.length)t.data=t.data+i;else t.data=SubString(t.data,0,e)+i+SubString(t.data,e);return e+2}function D2(t,e,r){var i="";i+=String.fromCharCode(r&255);r>>=8;i+=String.fromCharCode(r&255);r>>=8;i+=String.fromCharCode(r&255);r>>=8;i+=String.fromCharCode(r&255);if(e==0)t.data=i+t.data;else if(e==t.data.length)t.data=t.data+i;else t.data=SubString(t.data,0,e)+i+SubString(t.data,e);return e+4}function M2(t){var e;var r=t.GroupLevel;e=t.group;e[r].ParaStyId=0;e[r].CharStyId=1;e[r].TypeFace="";e[r].PointSize2=0;e[r].style=0;e[r].TextColor=xs[0].TextColor;e[r].TextBkColor=tc.CLR_WHITE;e[r].HilightColor=tc.CLR_WHITE;e[r].UlineColor=tc.CLR_AUTO;e[r].lang=0;e[r].LeftIndent=0;e[r].RightIndent=0;e[r].FirstIndent=0;e[r].flags=0;e[r].ParShading=0;e[r].SpaceBefore=0;e[r].SpaceAfter=0;e[r].SpaceBetween=0;e[r].LineSpacing=0;e[r].ParaBkColor=tc.CLR_WHITE;e[r].ParaBorderColor=tc.CLR_AUTO;e[r].tab.count=0;return true}_i.TerInsertRtfFile=function(t,e,r,i){var f;if(!lv||!QD())_i.TerCreateControl();var l=gU(t,true);if(l==null)return false;return _i.InsertRtfBuf(l,e,r,i)};function G2(t,e,r){if(Math.abs(kl[OR].width)<=1)kl[OR].width=0;if(Math.abs(kl[OR].height)<=1)kl[OR].height=0;kl[OR].MinHeight=kl[OR].height;if(e)kl[OR].flags2|=tc.PF2_FLIPH;else kl[OR].flags2=cj(kl[OR].flags2,tc.PF2_FLIPH);if(r)kl[OR].flags2|=tc.PF2_FLIPV;else kl[OR].flags2=cj(kl[OR].flags2,tc.PF2_FLIPV);return true}function B2(t,e,r,i){var f;var l,a,n,c,s=0,_=0;var o=t.group[i];var u=o.shape.RelLeft;var T=o.shape.RelWidth;var A=o.shape.RelTop;var E=o.shape.RelHeight;if(OR<=0||(a=kl[OR].PointCount)<=0)return false;f=kl[OR].pPoint;n=o.shape.width;c=o.shape.height;if(o.shape.GeoLeft!=0||o.shape.GeoRight!=0)s=Math.abs(o.shape.GeoRight-o.shape.GeoLeft);if(o.shape.GeoTop!=0||o.shape.GeoBot!=0)_=Math.abs(o.shape.GeoBot-o.shape.GeoTop);if(f!=null){for(l=0;l<a;l++){if(Nj(o.gflags&tc.GFLAG_IN_SHPGRP)){f[l].x=H2(t,f[l].x,false,i,u,T)-kl[OR].x;f[l].y=m2(t,f[l].y,false,i,A,E)-kl[OR].ParaY}else{if(s!=0)f[l].x=Mj(f[l].x,n,s);if(_!=0)f[l].y=Mj(f[l].y,c,_)}if(e)f[l].x=n-f[l].x;if(r)f[l].y=c-f[l].y}}else if(kl[OR].ShapeType==tc.SHPTYPE_LINE){var R,L,C,I;R=kl[OR].x;L=kl[OR].x+kl[OR].width;kl[OR].x=R=H2(t,R,e,i,u,T);L=H2(t,L,e,i,u,T);kl[OR].width=L-R;kl[OR].OrgX=kl[OR].x;C=kl[OR].y;I=kl[OR].y+kl[OR].height;kl[OR].y=C=m2(t,C,r,i,A,E);I=m2(t,I,r,i,A,E);kl[OR].height=I-C;kl[OR].OrgY=kl[OR].y;kl[OR].ParaY=kl[OR].y;kl[OR].PageY=kl[OR].y}return true}function H2(t,e,r,i,f,l){var a;var n=t.group;if(Nj(n[i].gflags&tc.GFLAG_IN_SHPGRP)){var c=e;c=c-n[i].shape.GeoLeft;c=c/(n[i].shape.GeoRight-n[i].shape.GeoLeft);c=c*l;c+=f;c-=n[i].ShpGrp.GroupLeft;c=c/n[i].ShpGrp.GroupWidth;c=c*n[i].ShpGrp.width;c+=n[i].ShpGrp.left;a=Math.round(c)}else a=e;return a}function m2(t,e,r,i,f,l){var a;var n=t.group;if(Nj(n[i].gflags&tc.GFLAG_IN_SHPGRP)){var c=e;c=c-n[i].shape.GeoTop;c=c/(n[i].shape.GeoBot-n[i].shape.GeoTop);c=c*l;c+=f;c-=n[i].ShpGrp.GroupTop;c=c/n[i].ShpGrp.GroupHeight;c=c*n[i].ShpGrp.height;c+=n[i].ShpGrp.top;a=Math.round(c)}else a=e;return a}function w2(t){var e,r,i=0,f;var l,a;var n;var c=true;if(Dj(rO&tc.TFLAG8_FIX_NEG_INDENT)){if(Nj(qh&tc.TFLAG4_DONT_FIX_NEG_INDENT)||Li)return true}if(!oi.FittedView)c=false;if(c&&Nj(t.flags2&tc.RFLAG2_HAS_FNOTE))c=false;if(c){for(e=0;e<Dc;e++){if(Nj(Nc[e].pflags&tc.PFLAG_FRAME)&&Nj(Nc[e].pflags&tc.PFLAG_CELL)){c=false;break}}}if(!c){return true}if(oi.PageMode&&!oi.FittedView){for(e=0;e<iR;e++){if(!$E[e].InUse)continue;if($E[e].AddedIndent<108)break}if(e==iR)return true}for(e=0;e<fR;e++){if(!eR[e].InUse)continue;f=0;if(eR[e].PrevCell>0){if(Nj(eR[e].border&tc.BORDER_LEFT)&&eR[e].margin<eR[e].BorderWidth[tc.BORDER_INDEX_LEFT])f=eR[e].BorderWidth[tc.BORDER_INDEX_LEFT]/2;a=eR[e].PrevCell;if(Nj(eR[a].border&tc.BORDER_RIGHT)&&f<eR[a].BorderWidth[tc.BORDER_INDEX_RIGHT]/2)f=eR[a].BorderWidth[tc.BORDER_INDEX_RIGHT]/2}else if(Nj(eR[e].border&tc.BORDER_LEFT))f=eR[e].BorderWidth[tc.BORDER_INDEX_LEFT];if(eR[e].NextCell>0){if(Nj(eR[e].border&tc.BORDER_RIGHT)&&eR[e].margin<eR[e].BorderWidth[tc.BORDER_INDEX_RIGHT])f=eR[e].BorderWidth[tc.BORDER_INDEX_RIGHT]/2;a=eR[e].NextCell;if(Nj(eR[a].border&tc.BORDER_LEFT)&&f<eR[a].BorderWidth[tc.BORDER_INDEX_LEFT]/2)f=eR[a].BorderWidth[tc.BORDER_INDEX_LEFT]/2}else if(Nj(eR[e].border&tc.BORDER_RIGHT))f=eR[e].BorderWidth[tc.BORDER_INDEX_RIGHT];if(eR[e].margin<f)eR[e].margin=f}for(e=0;e<Dc;e++){if(Nj(Nc[e].pflags&(tc.PFLAG_FRAME|tc.PFLAG_CELL)))continue;r=Nc[e].LeftIndentTwips;if(Nc[e].FirstIndentTwips<0){if(Nc[e].BltId==0)r+=Nc[e].FirstIndentTwips;else{var s=Nc[e].BltId;var _=xc[s].ls;var o=xc[s].lvl;var u=false;if(_>0&&_<zc){if(o<Jc[_].LevelCount){if(Jc[_].level[o].NumType==tc.LIST_NO_NUM)u=true}else{var T=Jc[_].ListIdx;if(T<Vc&&o<Kc[T].LevelCount&&Kc[T].level[o].NumType==tc.LIST_NO_NUM)u=true}}if(!u)r+=Nc[e].FirstIndentTwips}}if(r<i)i=r}for(e=0;e<iR;e++){if(!$E[e].InUse)continue;if($E[e].AddedIndent==0)continue;if(Nj($E[e].flags&(tc.CENTER|tc.RIGHT_JUSTIFY)))continue;if($E[e].PrevRow>0)continue;a=$E[e].FirstCell;if(eR[a].level>0)continue;r=-$E[e].AddedIndent;if(r<i)i=r}if(Dj(t.flags2&tc.RFLAG2_LEFT_MARG_FOUND)){for(e=0;e<Kl;e++){if(Nj(kl[e].flags&(tc.PARA_FRAME_CENTER|tc.PARA_FRAME_RIGHT_JUST)))continue;if(kl[e].x<i)i=kl[e].x}}if(i>=0)return true;i=-i;n=to[0].LeftMargin;for(e=1;e<ro;e++){if(to[e].LeftMargin<n)n=to[e].LeftMargin}n-=.25;if(n<0)n=0;if(i>n*1440)i=n*1440;for(e=0;e<Dc;e++){if(Nj(Nc[e].pflags&(tc.PFLAG_FRAME|tc.PFLAG_CELL)))continue;Nc[e].LeftIndentTwips+=i;Nc[e].LeftIndent=dV(Nc[e].LeftIndentTwips)}for(e=0;e<ro;e++){to[e].LeftMargin=to[e].LeftMargin-VV(i);if(to[e].LeftMargin<0)to[e].LeftMargin=0}for(e=0;e<Kl;e++){var A=Dj(kl[e].flags&tc.PARA_FRAME_HPAGE);if(A&&Nj(kl[e].flags&tc.PARA_FRAME_IN_CELL)&&Nj(kl[e].flags2&tc.PF2_ANCHOR_IN_CELL))A=false;if(Nj(kl[e].flags&tc.PARA_FRAME_CENTER))kl[e].x+=i/2;else if(A)kl[e].x+=i;if(A)kl[e].OrgX=kl[e].x}for(e=0;e<iR;e++){var E=$E[e].FirstCell;if($E[e].InUse&&eR[E].InUse&&eR[E].level==0){if($E[e].PrevRow<=0){$E[e].indent+=i-$E[e].AddedIndent;$E[e].AddedIndent=0}}}if(ah<tc.RTF_CB){var R,L;var C;for(l=0;l<Ri;l++){if(Nj(ui[l].cid)||Nj(ui[l].fid))continue;R=ui[l].pfmt;L=Nc[R].TabId;if(L==0)continue;C=B_[L].copy();for(e=0;e<C.count;e++)C.pos[e]+=i;L=YZ(L,C);var I=Nc[ui[l].pfmt].copy();I.TabId=L;ui[l].pfmt=QZ(ui[l].pfmt,I)}}mR=i;return true}function b2(t,e,r,i){var f,l;var a=t.group;if(t.InXml)return true;if(r==i)return true;if(r<i){if(t.OpenRowId>0)tR[t.OpenRowId].flags|=tc.TAUX_RTF_DEL;if(gR>0)tR[gR].flags|=tc.TAUX_RTF_DEL;x2(t,i);y2(t,r);a[e].level=t.CurTblLevel=r;return true}x2(t,t.CurTblLevel);l=NR;if(t.EmbedTable)l++;if(i<l)i=l;y2(t,i);for(f=i+1;f<=r;f++){if(a[e].InTable&&gR<=0&&t.OpenRowId>0){gR=t.OpenRowId;PR=t.OpenCellId;hR=t.OpenLastCellX}if(gR<=0||Dj(tR[gR].flags&(tc.TAUX_TROWD_DONE|tc.TAUX_COPIED))){t.CurTblLevel=f-1;G1(t,a,e);H1(t,a,e)}if(PR>0&&Nj(rR[PR].flags&tc.CAUX_CLOSED)){if(eR[PR].NextCell<=0&&!H1(t,t.group,t.GroupLevel))return false;PR=eR[PR].NextCell}x2(t,f-1);a[e].level=t.CurTblLevel=f;gR=PR=hR=0;t.OpenRowId=t.OpenCellId=t.OpenLastCellX=0;t.InitTblCol=-1;t.PastingColumn=false;if(!G1(t,a,e))return false;if(Dj(a[e].gflags2&tc.GFLAG2_NESTPROP_BEF_NESTCELL)&&!H1(t,a,e))return false;t.group[e].InTable=true}return true}function x2(t,e){t.TblLevel[e]=new tc.ClsRtfTableLevel;t.TblLevel[e].CurRowId=gR;t.TblLevel[e].CurCellId=PR;t.TblLevel[e].LastCellX=hR;t.TblLevel[e].OpenRowId=t.OpenRowId;t.TblLevel[e].OpenCellId=t.OpenCellId;t.TblLevel[e].OpenLastCellX=t.OpenLastCellX;t.TblLevel[e].InitTblCol=t.InitTblCol;t.TblLevel[e].PastingColumn=t.PastingColumn;return true}function y2(t,e){if(t.TblLevel[e]==null)t.TblLevel[e]=new tc.ClsRtfTableLevel;gR=t.TblLevel[e].CurRowId;PR=t.TblLevel[e].CurCellId;hR=t.TblLevel[e].LastCellX;t.OpenRowId=t.TblLevel[e].OpenRowId;t.OpenCellId=t.TblLevel[e].OpenCellId;t.OpenLastCellX=t.TblLevel[e].OpenLastCellX;t.InitTblCol=t.TblLevel[e].InitTblCol;t.PastingColumn=t.TblLevel[e].PastingColumn;t.CurTblLevel=e;return true}function W2(t){var e=0,r,i,f;var l;var a;var n=false,c=false;e=t.GroupLevel;l=t.group[e-1];a=t.group;l.blt=(new tc.ClsBlt).init();l.blt.NumberType=tc.NBR_DEFAULT;while(true){if(!r2(t))return tc.RTF_FILE_INCOMPLETE;if(t.GroupBegin)continue;if(t.GroupEnd){if(t.GroupLevel<e)break;else continue}if(t.IsControlWord){l.flags|=tc.BULLET;n=c=false;if(Tk(t.CurWord,"pnlvlblt")==0||Tk(t.CurWord,"pnlvl")==0&&t.IntParam==11)l.blt.IsBullet=true;else if(Tk(t.CurWord,"pnlvl")==0)l.blt.level=t.IntParam;else if(Tk(t.CurWord,"pnlvlcont")==0)l.blt.flags|=tc.BLTFLAG_HIDDEN;else if(Tk(t.CurWord,"pnstart")==0)l.blt.start=t.IntParam;else if(Tk(t.CurWord,"pnindent")==0&&false){if(l.LeftIndent<t.IntParam){l.LeftIndent=t.IntParam;l.FirstIndent=-t.IntParam}if(l.FirstIndent==0){l.LeftIndent+=t.IntParam;l.FirstIndent=-t.IntParam}}else if(Tk(t.CurWord,"pnf")==0){var s=h2(t);r=t.IntParam;if(r>=0&&r<tc.MAX_RTF_SEQ_FONTS)i=r;else for(i=tc.MAX_RTF_SEQ_FONTS;i<s.MaxRtfFonts;i++)if(s.font[i].InUse&&s.font[i].FontId==r)break;if(l.blt.IsBullet){if(Tk(s.font[i].name,"symbol")==0)l.blt.font=tc.BFONT_SYMBOL;else if(Tk(s.font[i].name,"wingdings")==0)l.blt.font=tc.BFONT_WINGDINGS;else l.blt.font=tc.BFONT_DEF}f=t.GroupLevel;a[f].TypeFace=s.font[i].name;a[f].FontFamily=s.font[i].family;a[f].CharSet=s.font[i].CharSet}else if(Tk(t.CurWord,"pnfs")==0){f=t.GroupLevel;a[f].PointSize2=t.IntParam}else if(Tk(t.CurWord,"pnb")==0){f=t.GroupLevel;if(Nj(t.IntParam))a[f].style=a[f].style|tc.BOLD;else a[f].style=a[f].style&~tc.BOLD}else if(Tk(t.CurWord,"pni")==0){f=t.GroupLevel;if(Nj(t.IntParam))a[f].style=a[f].style|tc.ITALIC;else a[f].style=a[f].style&~tc.ITALIC}else if(Tk(t.CurWord,"pndec")==0&&!l.blt.IsBullet)l.blt.NumberType=tc.NBR_DEC;else if(Tk(t.CurWord,"pnucltr")==0&&!l.blt.IsBullet)l.blt.NumberType=tc.NBR_UPR_ALPHA;else if(Tk(t.CurWord,"pnlcltr")==0&&!l.blt.IsBullet)l.blt.NumberType=tc.NBR_LWR_ALPHA;else if(Tk(t.CurWord,"pnucrm")==0&&!l.blt.IsBullet)l.blt.NumberType=tc.NBR_UPR_ROMAN;else if(Tk(t.CurWord,"pnlcrm")==0&&!l.blt.IsBullet)l.blt.NumberType=tc.NBR_LWR_ROMAN;else if(Tk(t.CurWord,"pntxtb")==0)n=true;else if(Tk(t.CurWord,"pntxta")==0)c=true}else{if(n){if(l.blt.IsBullet)l.blt.BulletChar=t.CurWord.charCodeAt(0);else{l.blt.BefText=t.CurWord;if(l.blt.BefText.length>tc.MAX_NUM_TEXT_LEN)l.blt.BefText=cV(l.blt.BefText,0,tc.MAX_NUM_TEXT_LEN)}}else if(c){if(!l.blt.IsBullet)l.blt.AftChar=t.CurWord.charCodeAt(0)}}}if(l.blt.BulletChar==149&&l.blt.font==tc.BFONT_DEF){l.blt.BulletChar=183;l.blt.font=tc.BFONT_SYMBOL}t.group[e-1]=l;return 0}function U2(t){var e,r;e=eo[t].hdr.FirstLine;r=eo[t].hdr.LastLine;if(e>=0&&e<Ri&&r>=0&&r<Ri&&e>=to[t].FirstLine){if(r>e+2)return true;if(r==e+2&&ui[e+1].len>1)return true}e=eo[t].ftr.FirstLine;r=eo[t].ftr.LastLine;if(e>=0&&e<Ri&&r>=0&&r<Ri&&e>=to[t].FirstLine){if(r>e+2)return true;if(r==e+2&&ui[e+1].len>1)return true}e=eo[t].fhdr.FirstLine;r=eo[t].fhdr.LastLine;if(e>=0&&e<Ri&&r>=0&&r<Ri&&e>=to[t].FirstLine){if(r>e+2)return true;if(r==e+2&&ui[e+1].len>1)return true}e=eo[t].fftr.FirstLine;r=eo[t].fftr.LastLine;if(e>=0&&e<Ri&&r>=0&&r<Ri&&e>=to[t].FirstLine){if(r>e+2)return true;if(r==e+2&&ui[e+1].len>1)return true}e=eo[t].rhdr.FirstLine;r=eo[t].rhdr.LastLine;if(e>=0&&e<Ri&&r>=0&&r<Ri&&e>=to[t].FirstLine){if(r>e+2)return true;if(r==e+2&&ui[e+1].len>1)return true}e=eo[t].rftr.FirstLine;r=eo[t].rftr.LastLine;if(e>=0&&e<Ri&&r>=0&&r<Ri&&e>=to[t].FirstLine){if(r>e+2)return true;if(r==e+2&&ui[e+1].len>1)return true}e=eo[t].lhdr.FirstLine;r=eo[t].lhdr.LastLine;if(e>=0&&e<Ri&&r>=0&&r<Ri&&e>=to[t].FirstLine){if(r>e+2)return true;if(r==e+2&&ui[e+1].len>1)return true}e=eo[t].lftr.FirstLine;r=eo[t].lftr.LastLine;if(e>=0&&e<Ri&&r>=0&&r<Ri&&e>=to[t].FirstLine){if(r>e+2)return true;if(r==e+2&&ui[e+1].len>1)return true}return false}function k2(t,e,r,i){var f,l;var a;var n=h2(t);var c,s,_,o,u=0,T=0,A=0,E=0;a=t.group[t.GroupLevel];if(!t.InXml&&Nj(a.style&tc.FNOTEALL))return true;if(t.InXml){A|=a.ParaMask&tc.PMASK_ALIGN}if(e>=n.RtfSID.length)return true;e=n.RtfSID[e];if(e<0)return true;if(e>=X_)return true;if(r==tc.SSTYPE_PARA)a.ParaStyId=e;else a.CharStyId=e;t:{if(!i)break t;_=W_[e].ParaMask;o=W_[e].ParaMask2;c=W_[e].StyleMask;s=W_[e].CharMask;c=cj(c,u);s=cj(s,T);_=cj(_,A);o=cj(o,E);if(Nj(s&tc.CMASK_FONT)&&W_[e].TypeFace!=null&&W_[e].TypeFace.length>0)a.TypeFace=W_[e].TypeFace;if(Nj(s&tc.CMASK_FONT_DB)&&W_[e].TypeFaceDB!=null&&W_[e].TypeFaceDB.length>0)a.TypeFaceDB=W_[e].TypeFaceDB;if(Nj(s&tc.CMASK_FONT_HI)&&W_[e].TypeFaceHi!=null&&W_[e].TypeFaceHi.length>0)a.TypeFaceHi=W_[e].TypeFaceHi;if(Nj(s&tc.CMASK_FONT_RTL)&&W_[e].TypeFaceCs!=null&&W_[e].TypeFaceCs.length>0)a.TypeFaceCs=W_[e].TypeFaceCs;if(Nj(s&tc.CMASK_SIZE)&&W_[e].TwipsSize>0)a.PointSize2=W_[e].TwipsSize/10;if(Nj(c))a.style|=W_[e].style&c;if(Nj(s&tc.CMASK_TEXT_COLOR))a.TextColor=W_[e].TextColor;if(Nj(s&tc.CMASK_TEXT_BK_COLOR))a.TextBkColor=W_[e].TextBkColor;if(Nj(s&tc.CMASK_ULINE_COLOR))a.UlineColor=W_[e].UlineColor;if(Nj(s&tc.CMASK_EXPAND))a.expand=W_[e].expand;if(Nj(s&tc.CMASK_OFFSET))a.offset=W_[e].offset;if(Nj(s&tc.CMASK_SCALE_X))a.CharScaleX=W_[e].CharScaleX;if(Nj(s&tc.CMASK_LANG))a.lang=W_[e].lang;if(r==tc.SSTYPE_PARA){if(Nj(_&tc.PMASK_INDENT_LEFT))a.LeftIndent=W_[e].LeftIndentTwips;if(Nj(_&tc.PMASK_INDENT_RIGHT))a.RightIndent=W_[e].RightIndentTwips;if(Nj(_&tc.PMASK_INDENT_FIRST))a.FirstIndent=W_[e].FirstIndentTwips;if(Nj(_&tc.PMASK_ALIGN)){a.flags=cj(a.flags,tc.LEFT|tc.RIGHT_JUSTIFY|tc.CENTER|tc.JUSTIFY);a.flags|=W_[e].ParaFlags&(tc.LEFT|tc.RIGHT_JUSTIFY|tc.CENTER|tc.JUSTIFY)}if(Nj(_&tc.PMASK_CONTEXTUAL_SPACE))a.flags|=W_[e].ParaFlags&tc.PARA_CONTEXTUAL_SPACE;if(Nj(_&tc.PMASK_KEEP))a.flags|=W_[e].ParaFlags&tc.PARA_KEEP;if(Nj(_&tc.PMASK_KEEP_NEXT))a.flags|=W_[e].ParaFlags&tc.PARA_KEEP_NEXT;if(Nj(_&tc.PMASK_BORDER)){a.flags|=W_[e].ParaFlags&tc.PARA_BOX;a.ParaBorderColor=W_[e].ParaBorderColor}if(Nj(_&tc.PMASK_WIDOW)){a.pflags=cj(a.pflags,tc.PFLAG_WIDOW);a.pflags|=W_[e].pflags&tc.PFLAG_WIDOW}if(Nj(_&tc.PMASK_PAGE_BREAK)){a.pflags=cj(a.pflags,tc.PFLAG_PAGE_BREAK);a.pflags|=W_[e].pflags&tc.PFLAG_PAGE_BREAK}if(Nj(_&tc.PMASK_SHADING))a.ParShading=W_[e].shading;if(Nj(_&tc.PMASK_FLOW))a.flow=W_[e].ParaFlow;if(true||Nj(_&tc.PMASK_SPACING)){if(Nj(_&tc.PMASK_SPACING_BEF))a.SpaceBefore=W_[e].SpaceBefore;if(Nj(_&tc.PMASK_SPACING_AFT))a.SpaceAfter=W_[e].SpaceAfter;if(Nj(_&tc.PMASK_SPACING_BET))a.SpaceBetween=W_[e].SpaceBetween;if(Nj(_&tc.PMASK_SPACING_LINE))a.LineSpacing=W_[e].LineSpacing;if(Nj(W_[e].ParaFlags&tc.DOUBLE_SPACE))a.flags|=tc.DOUBLE_SPACE}if(Nj(_&tc.PMASK_BK_COLOR))a.ParaBkColor=W_[e].ParaBkColor;if(Nj(_&tc.PMASK_OLVL))a.OutlineLevel=W_[e].OutlineLevel;if(Nj(_&tc.PMASK_LS))a.RtfLs=W_[e].RtfLs;if(Nj(_&tc.PMASK_LVL))a.ListLvl=W_[e].lvl;if(Nj(_&tc.PMASK_TAB)){l=W_[e].TabId;a.tab=B_[l].copy()}if(t.InXml&&Nj(_&tc.PMASK_LS)){var R=a.ParaMask;a.ParaMask|=_;t.group[t.GroupLevel]=a;xml.AddXmlListParaPropsToGroup(t,a.RtfLs,a.ListLvl);a=t.group[t.GroupLevel];a.ParaMask=R}if(t.InXml){if(Nj(_&tc.PMASK_FRAME)){a.ParaFrameInfo.x=W_[e].x;a.ParaFrameInfo.y=W_[e].y;a.ParaFrameInfo.width=W_[e].width;a.ParaFrameInfo.height=W_[e].height;a.ParaFrameInfo.DistFromTextLeft=W_[e].DistFromTextLeft;a.ParaFrameInfo.DistFromTextRight=W_[e].DistFromTextRight;a.ParaFrameInfo.DistFromTextTop=W_[e].DistFromTextTop;a.ParaFrameInfo.DistFromTextBot=W_[e].DistFromTextBot;a.ParaFrameInfo.ZOrder=W_[e].ZOrder;a.FrmFlags=W_[e].FrmFlags;a.FrmFlags2=W_[e].FrmFlags2}else if(Dj(a.FrmFlags&tc.PARA_FRAME_USED)){a.FrmFlags=0;a.FrmFlags2=0}}}if(true||!t.InXml)break t;u|=c;T|=s;A|=_;E|=o;W_[e].flags|=tc.SSFLAG_ADDED;f=W_[e].forward;if(f<0)break t;if(f>=X_)break t;if(Nj(W_[f].flags&tc.SSFLAG_ADDED))break t;if(W_[f].type!=r)break t;e=f}t.group[t.GroupLevel]=a;return true}function X2(t,e,r){var i;var f;i=t.rtf;f=i.FirstAnimPict;if(Dj(xs[f].InUse)||Dj(xs[f].style&tc.PICT))return true;if(!Y2(t,e,r))return false;return true}function K2(t,e){var r;var i;var f=t.rtf;if(t.shape.type==tc.SHPTYPE_TEXT_BOX){r=f.TextBoxParaFID;kl[r].OrigShapeType=t.shape.OrigType}else{if((r=kW())<0)return false;kl[r]=new tc.ClsParaFrame;kl[r].InUse=true;kl[r].DistFromTextLeft=tc.FRAME_DIST_FROM_TEXT;kl[r].DistFromTextRight=tc.FRAME_DIST_FROM_TEXT;kl[r].margin=0}xs[e].ParaFID=r;if(t.shape.align==tc.LEFT)xs[e].FrameType=tc.PFRAME_LEFT;else if(t.shape.align==tc.RIGHT_JUSTIFY)xs[e].FrameType=tc.PFRAME_RIGHT;else xs[e].FrameType=tc.PFRAME_FLOAT;if(Nj(t.shape.FrmFlags&(tc.PARA_FRAME_VPAGE|tc.PARA_FRAME_VMARG|tc.PARA_FRAME_HPAGE)))xs[e].FrameType=tc.PFRAME_FLOAT;r=xs[e].ParaFID;kl[r].pict=e;if(xs[e].PictType==tc.PICT_SHAPE){xs[e].PictWidth=t.shape.width;xs[e].PictHeight=t.shape.height;if(t.shape.type==tc.SHPTYPE_TEXT_BOX)kl[r].margin=t.TextBoxMargin;else kl[r].margin=0;kl[r].ShapeType=t.shape.type}if(xs[e].FrameType!=tc.PFRAME_NONE)kl[r].ShapeType=t.shape.type;if(t.shape.type!=tc.SHPTYPE_TEXT_BOX)kl[r].width=xs[e].PictWidth+2*kl[r].margin;if(t.shape.type!=tc.SHPTYPE_TEXT_BOX)kl[r].height=xs[e].PictHeight+2*kl[r].margin;kl[r].MinHeight=kl[r].height;i=t.shape.FrmFlags;if(t.shape.WrapType==tc.SWRAP_NO_WRAP)i|=tc.PARA_FRAME_NO_WRAP;else if(t.shape.WrapType==tc.SWRAP_IGNORE||t.shape.WrapType==tc.SWRAP_THRU)i|=tc.PARA_FRAME_WRAP_IGNORE;kl[r].ParaY=t.shape.y;kl[r].OrgY=t.shape.y;kl[r].GroupY=t.shape.y;kl[r].x=t.shape.x;kl[r].OrgX=t.shape.x;kl[r].GroupX=t.shape.x;if(Nj(i&tc.PARA_FRAME_HPAGE)){kl[r].x-=jV(f.sect.LeftMargin)}kl[r].ZOrder=t.shape.ZOrder;kl[r].BackColor=t.shape.BackColor;kl[r].FillPattern=t.shape.FillPattern;kl[r].FillOpacity=t.shape.FillOpacity;kl[r].LineOpacity=t.shape.LineOpacity;kl[r].flags=i;if(t.shape.type==tc.SHPTYPE_TEXT_BOX)kl[r].flags|=tc.PARA_FRAME_TEXT_BOX;kl[r].flags2=t.shape.FrmFlags2;if(Nj(t.shape.WrapType==tc.SWRAP_AROUND))kl[r].flags2|=tc.PF2_WRAP_AROUND;if(Nj(t.shape.WrapType==tc.SWRAP_TIGHT))kl[r].flags2|=tc.PF2_WRAP_TIGHT;if(Nj(t.FrmFlags2&tc.PF2_EMPTY_TEXT_BOX)){kl[r].LineWdth=t.shape.LineWdth;kl[r].LineColor=t.shape.LineColor;kl[r].BackColor=t.shape.BackColor;kl[r].FillOpacity=t.shape.FillOpacity;kl[r].LineOpacity=t.shape.LineOpacity;kl[r].ZOrder=t.shape.ZOrder;kl[r].DistFromTextLeft=t.shape.DistFromTextLeft;kl[r].DistFromTextRight=t.shape.DistFromTextRight;kl[r].DistFromTextTop=t.shape.DistFromTextTop;kl[r].DistFromTextBot=t.shape.DistFromTextBot}kl[r].ShapeId=t.shape.ShapeId;kl[r].NextShapeId=t.shape.NextShapeId;HN(e,hV(xs[e].PictHeight),dV(xs[e].PictWidth),true);mN(e);f.flags|=tc.RFLAG_PARA_FRAME_FOUND;if(xs[e].PictType==tc.PICT_SHAPE)OR=r;f.flags2|=tc.RFLAG2_PICT_FRAME_INSERTED;f.PictFID=r;return true}function Y2(t,e,r){var i;var f=t.rtf;xs[r].InUse=true;xs[r].TypeFace="";xs[r].PictType=e.type;xs[r].MetaType=e.MetaType;xs[r].ImageType=e.ImageType;xs[r].ObjectType=tc.OBJ_NONE;xs[r].style=tc.PICT|t.style;xs[r].AuxId=t.AuxId;xs[r].PictAlign=e.align;xs[r].PictData=e.data;xs[r].offset=t.offset;xs[r].CropLeft=e.CropLeft;xs[r].CropRight=e.CropRight;xs[r].CropTop=e.CropTop;xs[r].CropBot=e.CropBot;xs[r].OrigPictWidth=e.width;xs[r].OrigPictHeight=e.height;xs[r].OrigPictType=e.OrigPictType;xs[r].image=null;if(e.type!=tc.PICT_CONTROL&&e.type!=tc.PICT_FORM){xs[r].image=cD(e.data,false,null,r)}xs[r].hMeta=e.hMeta;xs[r].pMem=null;xs[r].rtlch=false;xs[r].flow=tc.FLOW_DEF;if(xs[r].PictAlign==0&&Nj(t.style&tc.SUBSCR))xs[r].PictAlign=tc.ALIGN_MIDDLE;if(Nj(t.FieldId)){xs[r].FieldId=t.FieldId;if(Nj(f.FieldCode))xs[r].FieldCode=f.FieldCode}i=xs[r].PictType;if(Nj(e.ScaleY)){e.height=Mj(e.height,e.ScaleY,100);e.CropTop=Mj(e.CropTop,e.ScaleY,100);e.CropBot=Mj(e.CropBot,e.ScaleY,100)}if(Nj(e.ScaleX)){e.width=Mj(e.width,e.ScaleX,100);e.CropLeft=Mj(e.CropLeft,e.ScaleX,100);e.CropRight=Mj(e.CropRight,e.ScaleX,100)}if(e.CropTop!=0)e.height-=e.CropTop;if(e.CropBot!=0)e.height-=e.CropBot;if(e.CropLeft!=0)e.width-=e.CropLeft;if(e.CropRight!=0)e.width-=e.CropRight;xs[r].PictHeight=e.height;xs[r].PictWidth=e.width;if(e.IsHRule){var l=f.sect.PprWidth;if(!f.sect.IsPortrait)l=Math.max(f.sect.PprWidth,f.sect.PprHeight);l=l-f.sect.LeftMargin-f.sect.RightMargin;if(f.sect.columns>1)l=(l-(f.sect.columns-1)*f.sect.ColumnSpace)/f.sect.columns;xs[r].PictWidth=jV(l)}if(i==tc.PICT_CONTROL){if(e.form==null)xs[r].form=new tc.ClsForm;else xs[r].form=e.form;kw(r,null);mN(r)}else if(i==tc.PICT_FORM){xs[r].form=e.form;xs[r].FieldId=e.FormId;if(xs[r].FieldId==tc.FIELD_TEXTBOX)f.pict=r;else{kw(r,null);mN(r)}}else{if(xs[r].PictType!=tc.PICT_SHAPE)xs[r].PictType=tc.PICT_IMAGE;xs[r].bmWidth=e.OrigWidth;xs[r].bmHeight=e.OrigHeight;HN(r,hV(xs[r].PictHeight),dV(xs[r].PictWidth),true);mN(r)}e.PictId=r;return true}function V2(t){var e,r,i,f=tc.SSTYPE_PARA,l,a;var n;var c;var s=h2(t);i=yd;if(Nj(t.group[t.GroupLevel].gflags2&tc.GFLAG2_UNSUPPORTED_STYLE))return true;c=t.OutBuf.trim();l=c.length;if(l>0&&c.charAt(l-1)==";")l--;c=c.substring(0,l);t.OutBufLen=0;t.OutBuf="";n=t.group[t.GroupLevel];if(Nj(n.gflags&tc.GFLAG_CHAR_STYLE))f=tc.SSTYPE_CHAR;if(f==tc.SSTYPE_PARA)a=n.ParaStyId;else a=n.CharStyId;if(a>=s.MaxRtfSID){if(null==(s.RtfSID=fV(s.RtfSID,a+1))){QY(tc.MSG_OUT_OF_MEM,"UpdateRtfStyleSheet");return false}for(r=s.MaxRtfSID;r<=a;r++)s.RtfSID[r]=-1;s.MaxRtfSID=a+1;t.group[i]=s}for(e=0;e<X_;e++)if(W_[e].InUse&&W_[e].type==f&&Tk(c,W_[e].name)==0)break;if(e<X_){s.RtfSID[a]=e;if(e>1||ah>=tc.RTF_CB)return true}else{e=UZ();if(e<0)return false;W_[e]=kZ()}W_[e].InUse=true;W_[e].type=f;W_[e].RtfIndex=a;s.RtfSID[a]=e;W_[e].name=c;W_[e].next=n.NextStyId;W_[e].TypeFace=n.TypeFace;W_[e].TypeFaceDB=n.TypeFaceDB;W_[e].TypeFaceHi=n.TypeFaceHi;W_[e].TypeFaceCs=n.TypeFaceCs;W_[e].FontFamily=0;W_[e].TwipsSize=n.PointSize2*10;W_[e].style=n.style;W_[e].TextColor=n.TextColor;W_[e].TextBkColor=n.TextBkColor;W_[e].UlineColor=n.UlineColor;W_[e].expand=n.expand;W_[e].CharScaleX=n.CharScaleX;W_[e].offset=n.offset;W_[e].lang=n.lang;W_[e].LeftIndentTwips=n.LeftIndent;W_[e].RightIndentTwips=n.RightIndent;W_[e].FirstIndentTwips=n.FirstIndent;W_[e].ParaFlags=n.flags;W_[e].pflags=n.pflags&tc.PFLAG_STYLES;W_[e].shading=n.ParShading;W_[e].ParaFlow=n.flow;W_[e].SpaceBefore=n.SpaceBefore;W_[e].SpaceAfter=n.SpaceAfter;W_[e].SpaceBetween=n.SpaceBetween;W_[e].LineSpacing=n.LineSpacing;W_[e].ParaBkColor=n.ParaBkColor;W_[e].ParaBorderColor=n.ParaBorderColor;W_[e].OutlineLevel=n.OutlineLevel;W_[e].LeftIndentNoList=n.LeftIndentNoList;W_[e].FirstIndentNoList=n.FirstIndentNoList;if(t.InXml&&f==tc.SSTYPE_PARA){W_[e].x=n.ParaFrameInfo.x;W_[e].y=n.ParaFrameInfo.y;W_[e].width=n.ParaFrameInfo.width;W_[e].height=n.ParaFrameInfo.height;W_[e].DistFromTextLeft=n.ParaFrameInfo.DistFromTextLeft;W_[e].DistFromTextRight=n.ParaFrameInfo.DistFromTextRight;W_[e].DistFromTextTop=n.ParaFrameInfo.DistFromTextTop;W_[e].DistFromTextBot=n.ParaFrameInfo.DistFromTextBot;W_[e].ZOrder=n.ParaFrameInfo.ZOrder;W_[e].FrmFlags=n.FrmFlags;W_[e].FrmFlags2=n.FrmFlags2}if(f==tc.SSTYPE_CHAR)W_[e].flags=tc.SSFLAG_ADD;if(Nj(n.gflags2&tc.GFLAG2_CONTEXTUAL_SPACE))W_[e].flags|=tc.SSFLAG_NO_SPACE;if(Nj(n.gflags2&tc.GFLAG2_NUM_STYLE))W_[e].flags|=tc.SSFLAG_NUM;if(n.RtfLs>0){n.flags|=tc.BULLET;n.blt=(new tc.ClsBlt).init();n.blt.NumberType=tc.NBR_DEFAULT}if(t.ListRead)n.blt.ls=Q2(t,n.RtfLs);else n.blt.ls=0;n.blt.lvl=n.ListLvl;if(Nj(n.flags&tc.BULLET))W_[e].BltId=zZ(0,n.blt);if(t.ListRead)W_[e].RtfLs=-1;else W_[e].RtfLs=n.RtfLs;if(t.InXml){W_[e].RtfLs=n.RtfLs;W_[e].lvl=n.ListLvl}W_[e].ParaMask=n.ParaMask;W_[e].ParaMask2=n.ParaMask2;W_[e].StyleMask=n.StyleMask;W_[e].CharMask=n.CharMask;W_[e].TabId=YZ(0,n.tab);if(e==0&&Nj(n.CharMask&tc.CMASK_SIZE)&&n.PointSize2!=xs[0].TwipsSize){_i.SetTerDefaultFont(xs[0].TypeFace,-n.PointSize2*10,xs[0].style,xs[0].TextColor,false)}if(false&&e==0&&ah<tc.RTF_CB){if(n.TypeFace.length>0){xs[0].TypeFace=n.TypeFace;oi.FontTypeFace=n.TypeFace}if(n.PointSize2>0){xs[0].TwipsSize=n.PointSize2*10;oi.PointSize=n.PointSize2/2}xs[0].style=n.style;xs[0].TextColor=n.TextColor;xs[0].TextBkColor=n.TextBkColor;xs[0].HilightColor=n.HilightColor;xs[0].UlineColor=n.UlineColor;xs[0].expand=n.expand;xs[0].ScaleX=n.CharScaleX;xs[0].rtlch=n.rtlch;xs[0].offset=n.offset;Rx(Ti,0,true);Nc[0].LeftIndentTwips=n.LeftIndent;Nc[0].RightIndentTwips=n.RightIndent;Nc[0].FirstIndentTwips=n.FirstIndent;Nc[0].flags=n.flags;Nc[0].shading=n.ParShading;Nc[0].SpaceBefore=n.SpaceBefore;Nc[0].SpaceAfter=n.SpaceAfter;Nc[0].SpaceBetween=n.SpaceBetween;Nc[0].LineSpacing=n.LineSpacing;Nc[0].BkColor=n.ParaBkColor;Nc[0].BorderColor=n.ParaBorderColor;Nc[0].TabId=W_[0].TabId}t.group[t.GroupLevel]=n;return true}function j2(t){var e=(new tc.ClsBlt).init();var r,i,f;for(r=0;r<X_;r++){if(!W_[r].InUse||W_[r].RtfLs<=0)continue;f=W_[r].BltId;e=xc[f];i=W_[r].RtfLs;e.ls=Q2(t,i);if(e.ls==0)continue;W_[r].BltId=zZ(0,e);W_[r].ParaFlags|=tc.BULLET;W_[r].RtfLs=-1}return true}function J2(t){var e,r=0,i=-1,f=0,l=0;var a=false,n=false,c=false;var s=0,_=0,o=0,u=0;var T=new tc.ClsList;var A=(new tc.ClsListLevel).init();var E;r=t.GroupLevel;while(true){if(!r2(t))return tc.RTF_FILE_INCOMPLETE;if(t.GroupBegin)continue;if(t.GroupEnd){if(t.GroupLevel<s&&a){if(A.NumType==tc.LIST_BLT&&o>2&&A.txt[o-1]==0)o--;if(o>0&&o-1<A.txt[0])A.txt[0]=o-1;a=false}if(c&&t.GroupLevel<_){if(i>=0){Kc[i]=T}c=false;i=-1}if(n&&t.GroupLevel<u){n=false;if(A.NumType==tc.LIST_BLT){E=A.txt[1];if(E==183){t.group[t.GroupLevel+1].TypeFace="Symbol";t.group[t.GroupLevel+1].CharSet=tc.SYMBOL_CHARSET;t.group[t.GroupLevel+1].CharMask|=tc.CMASK_FONT_LATIN}}if(O1(t,t.group[t.GroupLevel+1]))A.FontId=0;else{if(A.NumType==tc.LIST_BLT&&A.txt.length>=2){E=A.txt[1];if(E>=61440&&Tk(t.group[t.GroupLevel+1].TypeFace,"Wingdings")==0){t.group[t.GroupLevel+1].TypeFaceDB="Wingdings";t.group[t.GroupLevel+1].TypeFaceHi="Wingdings";t.group[t.GroupLevel+1].TypeFaceCs="Wingdings";t.group[t.GroupLevel+1].CharMask|=tc.CMASK_FONT_LATIN}}A.FontId=f1(t,t.group[t.GroupLevel+1])}A.FontStylesOff=t.group[t.GroupLevel+1].StyleOff;A.StyleMask=t.group[t.GroupLevel+1].StyleMask;A.CharMask=t.group[t.GroupLevel+1].CharMask;T.level[f]=A}if(t.GroupLevel<r)break;else continue}if(t.IsControlWord){if(Tk(t.CurWord,"list")==0){T=new tc.ClsList;c=true;_=t.GroupLevel;T.InUse=true;T.LevelCount=l=9;T.level=[l];for(e=0;e<l;e++)T.level[e]=(new tc.ClsListLevel).init();f=-1}else if(Tk(t.CurWord,"listtemplateid")==0){T.TmplId=t.IntParam}else if(Tk(t.CurWord,"listrestarthdn")==0){if(Nj(t.IntParam))T.flags|=tc.LISTFLAG_RESTART_SEC}else if(Tk(t.CurWord,"listsimple")==0||Tk(t.CurWord,"listhybrid")==0){if(Tk(t.CurWord,"listhybrid")==0)l=9;else if(t.param=="0")l=9;else l=1;if(T.LevelCount!=l){T.level=[l];for(e=0;e<l;e++)T.level[e]=(new tc.ClsListLevel).init()}T.LevelCount=l}else if(Tk(t.CurWord,"listname")==0){var R;var L;R=t3(t);L=R.length;if(L>0&&R.charAt(L-1)==";")R=R.substring(0,L-1);T.name=R}else if(Tk(t.CurWord,"listid")==0){T.id=T.RtfId=t.IntParam;T.flags|=tc.LISTFLAG_NEW_LIST;if(ah>=tc.RTF_CB&&Nj(iO&tc.TFLAG9_NEW_RTF_LISTS)||t.InContainer){while(true){for(e=1;e<Vc;e++)if(Kc[e].InUse&&Kc[e].id==T.id&&Kc[e].TmplId!=T.TmplId)break;if(e>=Vc)break;T.id++}}else{if(ah>=tc.RTF_CB){for(e=1;e<Vc;e++){if(Kc[e].InUse&&Dj(Kc[e].flags&tc.LISTFLAG_NEW_LIST)&&Kc[e].TmplId==T.TmplId&&vQ(Kc[e],T))break}}else{for(e=1;e<Vc;e++){if(Kc[e].InUse&&Kc[e].id==T.id)break}}}if(e<Vc){i=e;MQ(i)}else{if((i=SQ())<0)return tc.RTF_SYNTAX_ERROR}}else if(Tk(t.CurWord,"listlevel")==0){f++;if(f>=0&&f<l){A=T.level[f];A.start=1;a=false;n=true;u=t.GroupLevel;h1(t,t.group);if(X_>0&&W_[0].TwipsSize!=0)t.group[t.GroupLevel].PointSize2=W_[0].TwipsSize/10;t.group[t.GroupLevel].StyleMask=0;t.group[t.GroupLevel].CharMask=0}}else if(Tk(t.CurWord,"levelstartat")==0){if(f>=0&&f<l)A.start=t.IntParam}else if(Tk(t.CurWord,"levelnfc")==0){if(f>=0&&f<l)A.NumType=t.IntParam}else if(Tk(t.CurWord,"levelnfcn")==0){if(f>=0&&f<l)A.NumType=t.IntParam}else if(Tk(t.CurWord,"leveljc")==0){if(f>=0&&f<l){A.flags=cj(A.flags,tc.LISTLEVEL_RIGHT|tc.LISTLEVEL_CENTER);if(t.IntParam==1)A.flags|=tc.LISTLEVEL_CENTER;else if(t.IntParam==2)A.flags|=tc.LISTLEVEL_RIGHT}}else if(Tk(t.CurWord,"levelfollow")==0){if(f>=0&&f<l)A.CharAft=t.IntParam}else if(Tk(t.CurWord,"levelindent")==0){if(f>=0&&f<l)A.MinIndent=t.IntParam}else if(Tk(t.CurWord,"levelold")==0){if(f>=0&&f<l&&t.IntParam>0)A.flags|=tc.LISTLEVEL_OLD}else if(Tk(t.CurWord,"levellegal")==0){if(f>=0&&f<l&&t.IntParam>0)A.flags|=tc.LISTLEVEL_LEGAL}else if(Tk(t.CurWord,"levelnorestart")==0){if(f>=0&&f<l)A.flags|=tc.LISTLEVEL_NO_RESET}else if(Tk(t.CurWord,"s")==0){if(f>=0&&f<l)A.ParaStyId=t.IntParam}else if(Tk(t.CurWord,"leveltext")==0){t.group[t.GroupLevel].gflags|=tc.GFLAG_IN_LEVELTEXT;if(f>=0&&f<l){a=true;s=t.GroupLevel;o=0}}else if(Tk(t.CurWord,"levelnumbers")==0){t.group[t.GroupLevel].gflags|=tc.GFLAG_IN_LEVELNUM}else{if(Tk(t.CurWord,"plain")!=0){var C=r1(t);if(C!=0)return C}}}else{if(a){if(t.OutBufLen>0){var I=Uk(t.OutBuf);for(e=0;e<t.OutBufLen;e++,o++){if(o<49){A.txt[o]=z2(I[e])}}}var d=Uk(t.CurWord);for(e=t.group[t.GroupLevel].IgnoreCount;e<t.WordLen;e++,o++){if(o<49)A.txt[o]=d[e]}t.OutBuf="";t.OutBufLen=0;t.group[t.GroupLevel].IgnoreCount=0;if(o>=50)o=49;A.txt[o]=0}else{t.OutBuf="";t.OutBufLen=0;t.group[t.GroupLevel].IgnoreCount=0;t.OutBufHasUnicode=false}}}return 0}function z2(t){if(t==61607)return 9642;else if(t==61656){if(_i.InAndroid)return 5125;else return 11162}else if(t==61558)return 10070;else if(t==61623)return 9679;else if(t==61692)return 8999;else if(t==61553)return 9723;else if(t==11162&&_i.InAndroid)return 5125;else return t}function Z2(t){var e,r,i=0,f=0,l=0,a=0,n=0,c=0;var s=false,_=false,o=false,u=false;var T=0,A=0;var E=new tc.ClsListOr;var R=(new tc.ClsListLevel).init();var L=false;var C;i=t.GroupLevel;for(e=0;e<zc;e++)Jc[e].RtfLs=0;while(true){if(!r2(t))return tc.RTF_FILE_INCOMPLETE;if(t.GroupBegin)continue;if(t.GroupEnd){if(t.GroupLevel<T){if(A>0&&A-1<R.txt[0])R.txt[0]=A-1;s=false}if(o&&t.GroupLevel<c){o=false;if(f>=0)E.level[f]=R}if(_&&t.GroupLevel<n){var I;_=false;if(R.NumType==tc.LIST_BLT){C=R.txt[1];if(C==183){t.group[t.GroupLevel+1].TypeFace="Symbol";t.group[t.GroupLevel+1].CharSet=tc.SYMBOL_CHARSET;t.group[t.GroupLevel+1].CharMask|=tc.CMASK_FONT_LATIN}}if(R.NumType==tc.LIST_BLT&&R.txt.length>=2){C=R.txt[1];if(C>=61440&&Tk(t.group[t.GroupLevel+1].TypeFace,"Wingdings")==0){t.group[t.GroupLevel+1].TypeFaceDB="Wingdings";t.group[t.GroupLevel+1].TypeFaceHi="Wingdings";t.group[t.GroupLevel+1].TypeFaceCs="Wingdings";t.group[t.GroupLevel+1].CharMask|=tc.CMASK_FONT_LATIN}}I=f1(t,t.group[t.GroupLevel+1]);if(I>0)R.FontId=I;R.FontStylesOff=t.group[t.GroupLevel+1].StyleOff;R.StyleMask=t.group[t.GroupLevel+1].StyleMask;R.CharMask=t.group[t.GroupLevel+1].CharMask}if(u&&t.GroupLevel<a){u=false;if(ah>=tc.RTF_CB){for(e=0;e<zc;e++){if(!Jc[e].InUse)continue;if(Jc[e].RtfLs>0)continue;if(pQ(Jc[e],E)){GQ(e);break}}}else e=zc;if(e==zc){if((e=hQ())<0)return tc.RTF_SYNTAX_ERROR}Jc[e]=E;q2(t,E.RtfLs,e)}if(t.GroupLevel<i)break;else continue}if(t.IsControlWord){if(Tk(t.CurWord,"listoverride")==0){E=new tc.ClsListOr;E.InUse=true;E.LevelCount=l=0;f=-1;_=false;u=true;a=t.GroupLevel}else if(Tk(t.CurWord,"listoverridecount")==0){l=t.IntParam;if(E.LevelCount!=l){E.level=null;if(l>0){E.level=[l];for(e=0;e<l;e++)E.level[e]=(new tc.ClsListLevel).init()}}E.LevelCount=l}else if(Tk(t.CurWord,"listid")==0){for(e=Vc-1;e>=0;e--)if(Kc[e].InUse&&Nj(Kc[e].flags&tc.LISTFLAG_NEW_LIST)&&Kc[e].RtfId==t.IntParam)break;if(e<0)e=Vc-1;E.ListIdx=e}else if(Tk(t.CurWord,"ls")==0){E.RtfLs=t.IntParam}else if(Tk(t.CurWord,"lfolevel")==0){f++;if(f>=0&&f<l){var d;o=true;c=t.GroupLevel;R=E.level[f];s=false;d=Kc[E.ListIdx];if(f<d.LevelCount){R=d.level[f].copy()}h1(t,t.group);L=false}}else if(Tk(t.CurWord,"listlevel")==0){if(f>=0&&f<l){_=true;n=t.GroupLevel;if(X_>0&&W_[0].TwipsSize!=0)t.group[t.GroupLevel].PointSize2=W_[0].TwipsSize/10;t.group[t.GroupLevel].StyleMask=0;t.group[t.GroupLevel].CharMask=0}}else if(Tk(t.CurWord,"listoverridestartat")==0){L=true;if(f>=0&&f<l)R.flags|=tc.LISTLEVEL_RESTART}else if(Tk(t.CurWord,"levelnorestart")==0){if(f>=0&&f<l)R.flags|=tc.LISTLEVEL_NO_RESET}else if(Tk(t.CurWord,"listoverrideformat")==0){if(f>=0&&f<l)R.flags|=tc.LISTLEVEL_REFORMAT}else if(Tk(t.CurWord,"levelstartat")==0){if(f>=0&&f<l&&L)R.start=t.IntParam}else if(Tk(t.CurWord,"levelnfc")==0){if(f>=0&&f<l)R.NumType=t.IntParam}else if(Tk(t.CurWord,"levelnfcn")==0){if(f>=0&&f<l)R.NumType=t.IntParam}else if(Tk(t.CurWord,"leveljc")==0){if(f>=0&&f<l){R.flags=cj(R.flags,tc.LISTLEVEL_RIGHT|tc.LISTLEVEL_CENTER);if(t.IntParam==1)R.flags|=tc.LISTLEVEL_CENTER;else if(t.IntParam==2)R.flags|=tc.LISTLEVEL_RIGHT}}else if(Tk(t.CurWord,"levelfollow")==0){if(f>=0&&f<l)R.CharAft=t.IntParam}else if(Tk(t.CurWord,"levelindent")==0){if(f>=0&&f<l)R.MinIndent=t.IntParam}else if(Tk(t.CurWord,"levellegal")==0){if(f>=0&&f<l&&t.IntParam>0)R.flags|=tc.LISTLEVEL_LEGAL}else if(Tk(t.CurWord,"s")==0){if(f>=0&&f<l)R.ParaStyId=t.IntParam}else if(Tk(t.CurWord,"leveltext")==0){t.group[t.GroupLevel].gflags|=tc.GFLAG_IN_LEVELTEXT;if(f>=0&&f<l){s=true;T=t.GroupLevel;A=0}}else if(Tk(t.CurWord,"levelnumbers")==0){t.group[t.GroupLevel].gflags|=tc.GFLAG_IN_LEVELNUM}else{if(Tk(t.CurWord,"plain")!=0){var F=r1(t);if(F!=0)return F}}}else{if(s){if(t.OutBufLen>0){var g=Uk(t.OutBuf);for(e=0;e<t.OutBufLen;e++,A++){if(A<49){R.txt[A]=g[e];if(R.txt[A]==61623)R.txt[A]=9679}}}var P=Uk(t.CurWord);for(e=t.group[t.GroupLevel].IgnoreCount;e<t.WordLen;e++,A++){if(A<49)R.txt[A]=P[e]}t.OutBuf="";t.OutBufLen=0;t.group[t.GroupLevel].IgnoreCount=0;if(A>=50)A=49;R.txt[A]=0}else{t.OutBuf="";t.OutBufLen=0;t.group[t.GroupLevel].IgnoreCount=0;t.OutBufHasUnicode=false}}}for(e=1;e<Vc;e++){if(Kc[e].id>2e9)Kc[e].id=Kc[e].id/10}for(e=1;e<Vc;e++){for(r=0;r<Vc;r++){if(e==r)continue;if(Kc[e].id==Kc[r].id)break}if(r<Vc){Kc[e].id++;e--}}return 0}function Q2(t,e){if(e<tc.MAX_RTF_LS)return t.XlateLs[e];else{var r;for(r=0;r<t.TotalXlateLs2;r++){if(t.XlateLs2[r]==e)return t.XlateLsOr2[r]}}return 0}function q2(t,e,r){if(e<tc.MAX_RTF_LS)t.XlateLs[e]=r;else{t.XlateLs2[t.TotalXlateLs2]=e;t.XlateLsOr2[t.TotalXlateLs2]=r;t.TotalXlateLs2++}return true}function $2(t){var e,r,i=9;var f=0,l=0;var a;var n;for(r=0;r<Vc;r++){if(Kc[r].id>f)f=Kc[r].id;if(Kc[r].TmplId>l)l=Kc[r].TmplId}f++;l++;if((e=SQ())<0)return 0;Kc[e].InUse=true;Kc[e].id=f;Kc[e].TmplId=l;Kc[e].FontId=0;Kc[e].LevelCount=i;Kc[e].flags=0;if(t.InXml)Kc[e].name="default "+mY(e);else Kc[e].name="hidden "+mY(e);Kc[e].level=[i];a=Kc[e].level;for(r=0;r<i;r++){a[r]=new tc.ClsListLevel;a[r].NumType=t.InXml?tc.LIST_DEC:tc.LIST_NO_NUM;a[r].start=1;a[r].CharAft=tc.LISTAFT_TAB;a[r].text=[];a[r].txt[0]=0;if(t.InXml){a[r].txt[0]=1;a[r].txt[1]=0}}if((n=hQ())<0)return 0;Jc[n].InUse=true;Jc[n].ListIdx=e;Jc[n].LevelCount=0;return n}function t3(t){var e=t.GroupLevel;return e3(t,e,false)}function e3(t,e,r){var i=t.group[e].UcIgnoreCount;var f=0;var l;var a=Nj(t.group[e].gflags&tc.GFLAG_IN_FIELD);var n=-1;l="";while(r2(t)){if(t.GroupBegin)continue;if(t.GroupEnd){if(t.GroupLevel<e)break;else continue}if(t.GroupLevel<n)n=-1;if(!t.IsControlWord){if(n<0){if(f>0){var c=t.CurWord.length;if(c>f)l+=cV(t.CurWord,f,c-f);f-=c;if(f<0)f=0}else l+=t.CurWord}}else if(a&&(Tk(t.CurWord,"bkmkstart")==0||Tk(t.CurWord,"bkmkend")==0))n=t.GroupLevel;else if(j0(t.CurWord,"uc")==0)i=t.IntParam;else if(j0(t.CurWord,"u")==0){l+=t.IntParam;f=i}else if(r&&j0(t.CurWord,"par")==0)continue;else if(r&&j0(t.CurWord,"line")==0)continue;else{var s=r1(t);if(s!=0)return""}}if(Dj(t.group[e].gflags2|=tc.GFLAG2_IN_MATH))l=l.trim();return l}function r3(t,e){var r;var i;var f,l,a;if(ui[e].len==0)return true;l=ui[e].len;r=nb(e);a=r[l-1];if(Dj(xs[a].style&tc.FNOTEALL)){Oc=a;uA=tc.HILIGHT_OFF;_i.SetTerCharStyle(tc.FNOTE,true,false);for(f=0;f<l;f++)r[f]=Oc;mE=Oc;Oc=-1;if(t.EndnoteMarker!=null&&t.EndnoteMarker.length>0){var n=t.EndnoteMarker.length;Tm(e,ui[e].len,n);i=ui[e].txt;r=nb(e);var c=Uk(t.EndnoteMarker);for(f=0;f<n;f++){i[f]=c[f];r[f]=mE}}}sb(e);t.EndnoteMarker="";return true}function i3(t,e,r){BP="";if(r==tc.NBR_UPR_ALPHA)BP=KX(e,true);else if(r==tc.NBR_LWR_ALPHA)BP=KX(e,false);else if(r==tc.NBR_UPR_ROMAN)BP=YX(e,true);else if(r==tc.NBR_LWR_ROMAN)BP=YX(e,false);else BP=mY(e);return true}function f3(t){return t}_i.TerGetRtfSel=function(){var t=null;if(!lv||!QD())_i.TerCreateControl();if(uA==tc.HILIGHT_OFF)return null;if(!ON())return null;if(l3(tc.RTF_CB_BUF,"")){return HP}else return null};function l3(t,e){var r=null;var i=null;var f,l,a;var n;var c;var s,_,o,u,T,A;var E=false,R=false;var L=false;var C=null;var I=false;var d=false;var F=Nj($h&tc.TFLAG5_FRAME_TEXT_ONLY);var g;var P=null;var S;HP=null;BR=0;DR=false;YT=null;VT=null;for(s=0;s<Vn;s++)Yn[s].flags=cj(Yn[s].flags,tc.FSTORY_OPENED|tc.FSTORY_CLOSED);if(t==tc.RTF_FILE)return false;if(t>=tc.RTF_CB){l=sA;a=_A;u=0;T=ui[a].len;if(uA==tc.HILIGHT_CHAR){u=TA;T=AA}if(Nj(Qh&tc.TFLAG3_NO_FULL_CELL_COPY)&&ui[l].cid>0&&ui[l].cid==ui[a].cid&&GY(a,tc.INFO_CELL)&&T>=ui[a].len&&T>0){d=true;T--;I=true}}else{if(Ri>0&&(ui[Ri-1].fid>0||ui[Ri-1].cid>0)){Ri++;f=Ri-1;Ip(f);Tm(f,0,1);n=ui[f].txt;n[0]=Bn;c=nb(f);c[0]=0;sb(f);ui[f].pfmt=0;ui[f].fid=0;ui[f].cid=0}l=0;u=0;a=Ri-1;T=ui[a].len}if(l==0&&u==0&&a==Ri-1&&T==ui[a].len)E=true;for(s=1;s<Kl;s++){if(kl[s].NextId>0){if(kl[s].ShapeType==tc.SHPTYPE_TEXT_BOX)break;else if(kl[s].ShapeType==tc.SHPTYPE_RECT&&Nj(kl[s].flags2&tc.PF2_EMPTY_TEXT_BOX))break}}if(s<Kl){P=[Ri+1];for(f=0;f<Ri;f++){P[f]=ui[f].fid;if(ui[f].fid>0&&kl[ui[f].fid].PrevId>0)ui[f].fid=aU(f)}}r=new tc.ClsRtfOut;r.text=[tc.MAX_WIDTH+1];r.group=[tc.MAX_RTF_GROUPS+1];for(s=0;s<tc.MAX_RTF_GROUPS;s++)r.group[s]=new tc.ClsRtfOutGroup;r.XlateLs=[tc.MAX_RTF_LS];r.output=t;if(r.output==tc.RTF_FILE)r.oFile=oFile;else{r.BufLen=0;for(f=l;f<=a;f++)r.BufLen=r.BufLen+ui[f].len+2;r.BufLen=r.BufLen*3/2;if(r.BufLen<=0)r.BufLen=1;r.buf=[r.BufLen];r.BufIndex=0;r.oFile=null;if(r.output>=tc.RTF_CB&&uA==tc.HILIGHT_CHAR&&!I)r.TblHilight=T6()}Te=1;gi=false;if(t>=tc.RTF_CB){if(!r.TblHilight||uA!=tc.HILIGHT_CHAR){Te=0;gi=true}else{var h=ui[sA].cid;var O=ui[_A].cid;var v=eR[h].level<eR[O].level?eR[h].level:eR[O].level;var p;var N=false;h=E6(v,-h);O=E6(v,-O);if(h!=O)Te=v+1;else if(c3(l,u,a,T,v))Te=v+1;if(ui[sA].cid>0&&ui[sA].cid==ui[_A].cid){if(d||GY(_A,tc.INFO_CELL)){if(sA==0||ui[sA-1].cid!=ui[sA].cid)N=true}}if(!N&&h==O){var D=false;v=99;p=0;for(f=l;f<=a;f++){if((S=ui[f].cid)==0){D=true;continue}if(eR[S].level<v)v=eR[S].level;if(eR[S].level>p)p=eR[S].level;if(v<p||D){gi=true;break}}}}}if(uA!=tc.HILIGHT_OFF){for(f=l;f<=a;f++){if(pm(f))ui[f].flags|=tc.LFLAG_SELECTED;else ui[f].flags=sj(ui[f].flags,tc.LFLAG_SELECTED)}}i=r.color=[aA+1];for(s=0;s<aA;s++){i[s]=new tc.ClsRtfColor;i[s].color=tc.Color.black}if(Dj(zh&tc.TFLAG_NO_HOUR_GLASS)){C=XQ(U)}if(r.TblHilight){m6();for(s=0;s<fR;s++)eR[s].flags=_j(eR[s].flags,tc.CFLAG_RTF_SEL);for(f=l;f<=a;f++)if(Nj(ui[f].flags&tc.LFLAG_SELECTED))eR[ui[f].cid].flags|=tc.CFLAG_RTF_SEL;S=ui[l].cid;if(S>0&&eR[S].PrevCell<=0){S=ui[a].cid;if(S>0&&eR[S].NextCell<=0&&GY(a,tc.INFO_ROW|tc.INFO_CELL)&&T>=ui[a].len-1)L=true}}V3(r,l,a);if(Nj(fO&tc.TFLAG10_NO_LAST_PARA_MARKER)&&T>0)T--;t:{if(!I5(r))break t;if(!R5(r,"rtf",tc.PARAM_INT,1))break t;if(!R5(r,"ssteh",tc.PARAM_INT,28e3))break t;if(!R5(r,"johab",tc.PARAM_NONE,0))break t;if(!R5(r,"deflang",tc.PARAM_INT,MO))break t;if(!R5(r,"ftnbj",tc.PARAM_NONE,0))break t;if(!R5(r,"uc",tc.PARAM_INT,1))break t;if(!H3(r))break t;if(!w3(r))break t;if(!y3(r))break t;if(!x3(r))break t;if(!j3(r))break t;var M=Nj(tO&tc.TFLAG6_SAVE_TEXT_BK_COLOR)?jT:$T;if(!MJ(M,tc.CLR_WHITE)&&(!Li||!MJ(M,new tc.Color(12632256)))&&!$3(r,M))break t;if(!z3(r))break t;if(Nj(aO&tc.TOFLAG_DEL_CELL)&&!R5(r,"ssdelcell",tc.PARAM_NONE,0))break t;if(L&&!R5(r,"sswholetablerows",tc.PARAM_NONE,0))break t;A=G5(l);if(true||t<tc.RTF_CB||E){if(!Z3(r,A))break t}o=tc.DEFAULT_CFMT;r.group[r.GroupLevel].FontId=-1;if(!R5(r,"plain",tc.PARAM_NONE,0))return false;if(!o3(r,o,false,l,u))break t;r.PrevPfmt=ui[l].pfmt;r.PrevCell=ui[l].cid;r.PrevFID=ui[l].fid;if(ui[l].cid>0){r.PrevPfmt=tc.DEFAULT_PFMT;r.PrevCell=0;if(r.TblHilight||c3(l,u,a,T,-1))r.flags|=tc.ROFLAG_WRITE_TROWD}else if(s3(l,u,a,T)){r.PrevPfmt=tc.DEFAULT_PFMT}else if(t<tc.RTF_CB&&l==a&&Nj(fO&tc.TFLAG10_NO_LAST_PARA_MARKER))r.PrevPfmt=tc.DEFAULT_PFMT;if(r.PrevFID>0){var G=a;if(T==ui[a].len&&G+1<Ri)G++;if(F||ui[l].fid!=ui[G].fid)r.PrevFID=0}if(uA==tc.HILIGHT_OFF)NR=0;else{NR=C6(l,a);if(!c3(l,u,a,T,NR))NR++}pR=NR;g=0;if(r.PrevFID>0&&ui[l].fid>0&&ui[l].fid==ui[a].fid){g=ui[l].fid;r.PrevFID=0}if(!a3(r,g,l,u,a,T))break t;f=a+1;if(DR){if(Nj(aO&tc.TOFLAG_DEL_CELL)&&!R5(r,"sstblend",tc.PARAM_NONE,0))break t;q3(r,ib(f,0));for(s=pR;s>NR;s--){if(!R5(r,"intbl",tc.PARAM_NONE,0))break t;if(!R5(r,"itap",tc.PARAM_INT,s-NR+1))break t;if(Dj(r.flags&tc.ROFLAG_CELL_CLOSED)&&!R5(r,"nestcell",tc.PARAM_NONE,0))break t;if(!D3(r,0,E6(s,f),s,Ri-1))break t;r.flags=cj(r.flags,tc.ROFLAG_CELL_CLOSED)}if(!R5(r,"intbl",tc.PARAM_NONE,0))break t;if(Dj(r.flags&tc.ROFLAG_CELL_CLOSED)&&!R5(r,"cell",tc.PARAM_NONE,0))break t;if(!R5(r,"row",tc.PARAM_NONE,0))break t}for(_=r.GroupLevel;_>0;_--)if(!d5(r))break t;R=true}S5(r);if(t==tc.RTF_FILE){try{oFile.close()}catch(t){}}else if(t==tc.RTF_BUF){oi.hBuffer=Wk(r.buf,0,r.BufIndex);oi.BufferLen=r.BufIndex}else{r.buf=fV(r.buf,r.BufIndex);if(t==tc.RTF_CB){YT=r.buf;VT=new tc.ClsClipInfo;VT.size=12;VT.TblLevel=Te;VT.EmbTable=gi;Te=1;gi=true;VT.CellsCopied=0;VT.RowsCopied=0;VT.RowsInCol=0;if(ui[sA].cid>0&&ui[_A].cid>0){var B=ui[sA].cid;var H=ui[_A].cid;var m=eR[B].row;var w=eR[H].row;var b=1;if(m==w&&B!=H){for(S=B;S>0&&S!=H;S=eR[S].NextCell)b++;VT.CellsCopied=b}if(eR[B].PrevCell<=0&&eR[H].NextCell<=0){if(m==w)VT.RowsCopied=1;else{while(m>0){VT.RowsCopied++;if(m==w)break;m=$E[m].NextRow}}}else{if(m==w)VT.RowsInCol=1;else{while(m>0){VT.RowsInCol++;if(m==w)break;m=$E[m].NextRow}}}}}else{HP=Wk(r.buf);Ls=r.BufIndex}}if(Nj(C))XQ(C);if(P!=null){for(f=0;f<Ri;f++)ui[f].fid=P[f]}if(t==tc.RTF_FILE||t==tc.RTF_BUF){if(oi.modified!=Ro)Ro=-1;oi.modified=0;lr=0}return R}function a3(t,e,r,i,f,l){var a;var n;var c;var s,_,o,u,T,A,E,R=0,L=-1;var C=false;var I;var d=Nj($h&tc.TFLAG5_FRAME_TEXT_ONLY)||e>0;var F=-1;var g=t.output;var P=false;P=e>0&&(kl[e].ShapeType==tc.SHPTYPE_TEXT_BOX||Nj(kl[e].flags&tc.PARA_FRAME_TEXT_BOX));for(a=r;a<=f;a++){if(e>0){if(ui[a].fid!=e)continue}else{var S=ui[a].fid;if(kl[S].pict>0&&kl[S].ShapeType==tc.SHPTYPE_TEXT_BOX)continue}t.line=a;if(Nj(Nc[ui[a].pfmt].pflags&tc.PFLAG_ENDNOTE))continue;if(t.TblHilight){if(Dj(ui[a].flags&tc.LFLAG_SELECTED)){if(!GY(a,tc.INFO_ROW))continue;else if(Nj(ui[a].cid)&&L6(a)>NR)continue}}vR=pR;pR=L6(a);if(ui[a].len==1&&Nj(ui[a].flags&tc.LFLAG_HDRS_FTRS)){if(Dj(BR)){var h=a+2<Ri&&Nj(ui[a+2].flags&tc.LFLAG_HDRS_FTRS)&&ui[a+1].len==1;if(h&&ui[a+1].tag!=null)h=false;if(h){a=a+2;continue}S5(t);if(!I5(t))return false;BR=tc.PAGE_HDR_FTR;if(Nj(ui[a].flags&tc.LFLAG_HDR)){if(!R5(t,"header",tc.PARAM_NONE,0))return false;if($l>0&&Dj(t.WatermarkWritten&tc.LFLAG_HDR)&&g<tc.RTF_CB&&!r5(t,false,tc.LFLAG_HDR))return false}else if(Nj(ui[a].flags&tc.LFLAG_FTR)&&!R5(t,"footer",tc.PARAM_NONE,0))return false;else if(Nj(ui[a].flags&tc.LFLAG_LHDR)){if(!R5(t,"headerl",tc.PARAM_NONE,0))return false;if($l>0&&Dj(t.WatermarkWritten&tc.LFLAG_LHDR)&&g<tc.RTF_CB&&!r5(t,false,tc.LFLAG_LHDR))return false}else if(Nj(ui[a].flags&tc.LFLAG_LFTR)&&!R5(t,"footerl",tc.PARAM_NONE,0))return false;else if(Nj(ui[a].flags&tc.LFLAG_RHDR)){if(!R5(t,"headerr",tc.PARAM_NONE,0))return false;if($l>0&&Dj(t.WatermarkWritten&tc.LFLAG_RHDR)&&g<tc.RTF_CB&&!r5(t,false,tc.LFLAG_RHDR))return false}else if(Nj(ui[a].flags&tc.LFLAG_RFTR)&&!R5(t,"footerr",tc.PARAM_NONE,0))return false;else if(Nj(ui[a].flags&tc.LFLAG_FHDR)){if(!R5(t,"headerf",tc.PARAM_NONE,0))return false;if($l>0&&Dj(t.WatermarkWritten&tc.LFLAG_FHDR)&&g<tc.RTF_CB&&!r5(t,false,tc.LFLAG_FHDR))return false}else if(Nj(ui[a].flags&tc.LFLAG_FFTR)&&!R5(t,"footerf",tc.PARAM_NONE,0))return false;t.flags|=tc.ROFLAG_WRITE_FONT}else{u=0;if(!o3(t,u,false,a,0))return false;if(!d5(t))return false;S5(t);BR=0;t.PrevPfmt=-1}continue}if(BR==0&&$l>0&&Dj(t.WatermarkWritten)&&g<tc.RTF_CB&&!r5(t,true,tc.LFLAG_HDR))return false;T=0;A=ui[a].len;if(a==r)T=i;if(a==f)A=l;if(Nj(tO&tc.TFLAG6_WRITE_PNTEXT)&&Dj(eO&tc.TFLAG7_WRITE_LISTTEXT)&&Nj(ui[a].flags&tc.LFLAG_PARA_FIRST))O3(t,a);if(Nj(eO&tc.TFLAG7_WRITE_LISTTEXT)&&T==0&&Nj(ui[a].flags&tc.LFLAG_PARA_FIRST))v3(t,a);_=d?0:ui[a].fid;if(ui[a].pfmt!=t.PrevPfmt||ui[a].cid!=t.PrevCell||_!=t.PrevFID||a==F+1){q3(t,ib(a,0));if(!F3(t,ui[a].pfmt,t.PrevPfmt,ui[a].cid,t.PrevCell,_,t.PrevFID,a))return false;t.PrevPfmt=ui[a].pfmt;t.PrevCell=ui[a].cid;t.PrevFID=_;if(t.group[t.GroupLevel].FieldId==0){if(!o3(t,0,false,a,0))return false}}t:{if(T>=A)break t;n=ui[a].txt;c=nb(a);u=c[T];o=0;if(Nj(ui[a].flags2&tc.LFLAG2_TEMP_HYPH)&&A>0&&A-1>T&&n[A-1]==tc.HYPH_CHAR)A--;for(s=T;s<=A;s++){var O=false;R=Nj(ui[a].tag)&&s<A?ui[a].tag[s]:0;if(Nj(R)&&s==T)L5(t,R);I=s<A&&u<Ys&&c[s]<Ys&&xs[u].FieldId==tc.FIELD_NAME&&xs[c[s]].FieldId==tc.FIELD_NAME&&Nj(xs[c[s]].style&tc.PROTECT)&&n[s]==tc.LEFT_BRACE;if(s<A&&c[s]!=u){O=n3(c[s],u);if(!O)u=c[s]}if(s==A||O||n[s]==Bn||n[s]==TR||n[s]==tc.LINE_CHAR||n[s]==tc.ROW_CHAR||n[s]==tc.SECT_CHAR||c[s]<Ys&&Nj(xs[c[s]].style&tc.PICT)||Nj(R)&&s>T||I){var v=s-o;if(u<Ys&&xs[u].FieldId==tc.FIELD_NAME&&Nj(xs[u].style&tc.PROTECT)){if(n[v]==tc.LEFT_BRACE){o--;v++}if(s>0&&n[s-1]==tc.RIGHT_BRACE)o--}_3(t,true,a,v);if(ny(true,a,v,false,0,0,true))U3(t,true);if(I&&Nj(t.flags&tc.ROFLAG_IN_FIELD_NAME))I3(t,tc.FIELD_NAME,u,a,s,xs[u].flags);if(o>0){if(L!=-1&&s<A){var p=xs[c[v]].FieldId;if(Iw(p)||p==tc.FIELD_HLINK){L5(t,L);L=-1}}if(Nj(t.flags&tc.ROFLAG_IN_HIDDEN_GROUP)){if(!d5(t))return false;t.flags=cj(t.flags,tc.ROFLAG_IN_HIDDEN_GROUP);t.flags|=tc.ROFLAG_WRITE_PARA_PROPS}if(Nj(t.flags&tc.ROFLAG_WRITE_PARA_PROPS)){if(!F3(t,ui[a].pfmt,t.PrevPfmt,ui[a].cid,t.PrevCell,_,t.PrevFID,a))return false;t.PrevPfmt=ui[a].pfmt;t.flags=cj(t.flags,tc.ROFLAG_WRITE_PARA_PROPS)}if(!o3(t,u,false,a,s))return false;if(Nj(xs[u].style&tc.FNOTEAUTO)&&Nj(xs[u].style&(tc.FNOTE|tc.FNOTETEXT)))t.flags|=tc.ROFLAG_IS_FNOTEAUTO;if(L!=-1){L5(t,L);L=-1}if(Dj(t.flags&tc.ROFLAG_HIDDEN_TEXT)&&t.DelRevCount<=0&&xs[u].FieldId!=tc.FIELD_INCLUDEPICTURE&&!C5(t,lV(n,v),o))return false;t.flags=cj(t.flags,tc.ROFLAG_CELL_CLOSED|tc.ROFLAG_IS_FNOTEAUTO)}if(ny(false,a,v+o-1,false,0,0,true))U3(t,false);_3(t,false,a,v+o);if(s==A)break;o=0}if(Nj(R)&&s>T)L=R;u=c[s];if(u<Ys&&Nj(xs[u].style&tc.PICT)){if(xs[u].FieldId==tc.FIELD_TEXTBOX&&xs[u].form!=null){var N=xs[u].form;var D=N.FontId;var M=xs[D].TextBkColor;xs[D].TextBkColor=tc.CLR_WHITE;if(!o3(t,D,false,a,s))return false;xs[D].TextBkColor=M}else{if(!o3(t,u,false,a,s))return false}if(L!=-1){L5(t,L);L=-1}C=true;if(xs[u].ParaFID>0){if(xs[u].ExpId>0)t5(t,u);if(!P)C=i5(t,u);else C=n5(t,u,P);if(xs[u].ExpId>0){d5(t);d5(t)}}else if(g==tc.RTF_FRAME_BUF){C=R5(t,"subpictid",tc.PARAM_INT,u)}else if(true||xs[u].ObjectType==tc.OBJ_NONE||xs[u].ObjectType==tc.OBJ_EMBED_TEMP){if(xs[u].ExpId>0)t5(t,u);C=n5(t,u,P);if(xs[u].ExpId>0){d5(t);d5(t)}}else{C=Q3(t,u)}if(!C)return false}else if(n[s]==Bn){var G=t.PrevFID;if(!o3(t,u,false,a,s))return false;if(L!=-1){L5(t,L);L=-1}if(G==0||Dj(kl[G].flags&(tc.PARA_FRAME_LINE|tc.PARA_FRAME_RECT))){if(Dj(t.flags&tc.ROFLAG_HIDDEN_TEXT)){if(t.ParaFmtOnParaEnd&&!F3(t,ui[a].pfmt,0,ui[a].cid,t.PrevCell,_,t.PrevFID,a))return false;t.ParaFmtOnParaEnd=false;if(t.DelRevCount<=0&&!R5(t,"par",tc.PARAM_NONE,0))return false;S5(t)}}t.FieldHasPara=true}else if(n[s]==TR||n[s]==tc.LINE_CHAR){if(Nj(iO&tc.TFLAG9_ALWAYS_WRITE_ROW_PROPS)&&n[s]==TR)t.flags|=tc.ROFLAG_WRITE_FONT;if(!o3(t,u,false,a,s))return false;if(Nj(iO&tc.TFLAG9_ALWAYS_WRITE_ROW_PROPS)&&n[s]==TR)t.flags=cj(t.flags,tc.ROFLAG_WRITE_FONT);if(L!=-1){L5(t,L);L=-1}if(n[s]==TR){var B=eR[ui[a].cid].ColSpan;var H=eR[ui[a].cid].level;if(t.ParaFmtOnParaEnd&&!F3(t,ui[a].pfmt,0,ui[a].cid,t.PrevCell,_,t.PrevFID,a))return false;t.ParaFmtOnParaEnd=false;var m=H==NR?"cell":"nestcell";if(!R5(t,m,tc.PARAM_NONE,0))return false;if(Nj(rO&tc.TFLAG8_WRITE_MERGE_TAG)&&H==NR){while(B>1){if(!R5(t,m,tc.PARAM_NONE,0))return false;if(H>NR)M3(t);B--}}else if(H>NR)M3(t);t.flags|=tc.ROFLAG_CELL_CLOSED;S5(t)}if(n[s]==tc.LINE_CHAR&&xs[u].CharId>0&&!R5(t,"lbr",tc.PARAM_INT,xs[u].CharId))return false;if(n[s]==tc.LINE_CHAR&&!R5(t,"line",tc.PARAM_NONE,0))return false}else if(n[s]==tc.ROW_CHAR){var w=L6(a);if(!o3(t,u,false,a,s))return false;if(!R5(t,"intbl",tc.PARAM_NONE,0))return false;if(L!=-1){L5(t,L);L=-1}if(w==NR){if(Dj(t.flags&tc.ROFLAG_CELL_CLOSED))R5(t,"cell",tc.PARAM_NONE,0);if(!R5(t,"row",tc.PARAM_NONE,0))return false;S5(t);DR=false}else{if(!R5(t,"itap",tc.PARAM_INT,w-NR+1))return false}t.flags=cj(t.flags,tc.ROFLAG_CELL_CLOSED)}else if(n[s]==tc.SECT_CHAR){if(Nj(ui[a].tabw)&&Nj(ui[a].tabw.type&tc.INFO_SECT)){if(!o3(t,u,true,a,s))return false;if(L!=-1){L5(t,L);L=-1}if(a>r&&ui[a-1].cid>0)if(!R5(t,"pard",tc.PARAM_NONE,0))return false;if(!R5(t,"sect",tc.PARAM_NONE,0))return false;E=G5(a+1);if(!Z3(t,E))return false;F=a}}else o++}sb(a)}if(!oi.WordWrap&&a<f&&!R5(t,"par",tc.PARAM_NONE,0))return false}return true}function n3(t,e){if(xs[t].TwipsSize!=xs[e].TwipsSize)return true;if(Tk(xs[t].TypeFace,xs[e].TypeFace)!=0)return true;if(xs[t].CharSet!=xs[e].CharSet)return true;if(xs[t].style!=xs[e].style)return true;if(xs[t].CharStyId!=xs[e].CharStyId)return true;if(xs[t].ParaStyId!=xs[e].ParaStyId)return true;if(xs[t].offset!=xs[e].offset)return true;if(xs[t].expand!=xs[e].expand)return true;if(xs[t].lang!=xs[e].lang)return true;if(xs[t].ScaleX!=xs[e].ScaleX)return true;if(xs[t].TextAngle!=xs[e].TextAngle)return true;if(xs[t].AuxId!=xs[e].AuxId)return true;if(xs[t].Aux1Id!=xs[e].Aux1Id)return true;if(!MJ(xs[t].TextColor,xs[e].TextColor))return true;if(!MJ(xs[t].TextBkColor,xs[e].TextBkColor))return true;if(!MJ(xs[t].UlineColor,xs[e].UlineColor))return true;if(!MJ(xs[t].WlineColor,xs[e].WlineColor))return true;if(!MJ(xs[t].HilightColor,xs[e].HilightColor))return true;if(xs[t].InsRev!=xs[e].InsRev)return true;if(xs[t].DelRev!=xs[e].DelRev)return true;if(xs[t].FmtRev!=xs[e].FmtRev)return true;if(xs[t].VarWidth!=xs[e].VarWidth)return true;if(xs[t].rtl!=xs[e].rtl)return true;if(xs[t].CharId!=xs[e].CharId)return true;if(xs[t].rtlch!=xs[e].rtlch)return true;if(xs[t].flow!=xs[e].flow)return true;if(xs[t].ProtExId!=xs[e].ProtExId)return true;if(xs[t].offset!=xs[e].offset)return true;if(xs[t].FieldId!=xs[e].FieldId)return true;if(!Cw(xs[t].FieldCode,xs[e].FieldCode))return true;if(!Cb(xs[t].StoryIds,xs[e].StoryIds))return true;return false}function c3(t,e,r,i,f){var l;var a;if(uA==tc.HILIGHT_OFF)return true;for(l=t;l<=r;l++){if(l==r)a=i;else a=ui[l].len;if(a>0){var n=ui[l].txt;if(n[a-1]==TR){if(f<0)return true;else if(eR[ui[l].cid].level==f)return true}}}return false}function s3(t,e,r,i){var f;var l;if(uA==tc.HILIGHT_OFF)return true;for(f=t;f<=r;f++){if(f==r)l=i;else l=ui[f].len;if(l>0){var a=ui[f].txt;if(a[l-1]==Bn)return true}}return false}function _3(t,e,r,i){var f;var l=nO;var a,n;var c;if(i>=ui[r].len){if(r+1>=Ri)i=ui[r].len-1;else{r++;i=0}if(i<0)i=0}nO|=tc.TOFLAG2_NO_COMPRESS_CFMT;f=ib(r,i);nO=l;n=xs[f].ProtExId;a=t.PrevProtExId;if(a==n)return true;if(e){if(a!=0){if(!I5(t))return false;if(!R5(t,"*",tc.PARAM_NONE,0))return false;if(!R5(t,"protend",tc.PARAM_NONE,0))return false;c="ffff0100"+Integer.toHexString(a);C5(t,c,c.length);if(!d5(t))return false;t.PrevProtExId=n}if(n!=0){if(!I5(t))return false;if(!R5(t,"*",tc.PARAM_NONE,0))return false;if(!R5(t,"protstart",tc.PARAM_NONE,0))return false;c="ffff0100"+Integer.toHexString(n);C5(t,c,c.length);if(!d5(t))return false;t.PrevProtExId=n}}else{if(n==0){if(!I5(t))return false;if(!R5(t,"*",tc.PARAM_NONE,0))return false;if(!R5(t,"protend",tc.PARAM_NONE,0))return false;c="ffff0100"+Integer.toHexString(a);C5(t,c,c.length);if(!d5(t))return false;t.PrevProtExId=0}}return true}function o3(t,e,r,i,f){var l,a;var n,c;var s;var _,o;var u;var T=tc.FNOTEALL;var A;if(Nj(Qh&tc.TFLAG3_OLD_WORD_FORMAT))T|=tc.CHAR_BOX;if(e>=Ys)return true;if(e<0)return true;u=t.group[t.GroupLevel];s=u.FontId;if(s<0)s=0;o=xs[s].style;o=cj(o,T);c=u.FieldCode;a=u.FieldId;o|=u.style&T;_=xs[e].style;if(r){n="";l=0}else{n=xs[e].FieldCode;l=xs[e].FieldId}if(a==0&&l>0&&Nj(o&tc.HIDDEN)&&Dj(_&tc.HIDDEN)){R5(t,"v",tc.PARAM_INT,0)}var E=l==tc.FIELD_TEXTBOX&&(l!=a||xs[s].AuxId!=xs[e].AuxId||!Cw(n,c));if(Dj(t.flags&tc.ROFLAG_IN_MERGE_FIELD)&&l==tc.FIELD_DATA)l=0;if(l!=tc.FIELD_NAME&&l!=tc.FIELD_DATA&&(a==tc.FIELD_NAME||a==tc.FIELD_DATA)){if(!d5(t))return false;if(a==tc.FIELD_NAME){if(!I5(t))return false;R5(t,"fldrslt",tc.PARAM_NONE,0);if(!d5(t))return false}if(!d5(t))return false;t.flags=cj(t.flags,tc.ROFLAG_IN_FIELD_NAME|tc.ROFLAG_IN_MERGE_FIELD);if(t.FieldHasPara)t.ParaFmtOnParaEnd=true}if(l==tc.FIELD_DATA&&a==tc.FIELD_NAME){if(!d5(t))return false;if(!I5(t))return false;R5(t,"fldrslt",tc.PARAM_NONE,0);t.flags=cj(t.flags,tc.ROFLAG_IN_FIELD_NAME)}if((Iw(a)||a==tc.FIELD_TOC||a==tc.FIELD_HLINK||a==tc.FIELD_TEXTBOX||a==tc.FIELD_INCLUDEPICTURE)&&(a!=l||E||!Cw(c,n))){if(!d5(t))return false;if(!d5(t))return false;t.flags=cj(t.flags,tc.ROFLAG_HIDDEN_TEXT);if(t.FieldHasPara)t.ParaFmtOnParaEnd=true}if(a==tc.FIELD_TC&&a!=l){if(!d5(t))return false;t.flags=cj(t.flags,tc.ROFLAG_IN_FIELD_TC);t.flags=cj(t.flags,tc.ROFLAG_HIDDEN_TEXT)}if(a==tc.FIELD_XE&&a!=l){if(!d5(t))return false;t.flags=cj(t.flags,tc.ROFLAG_IN_FIELD_XE)}if(Nj(Qh&tc.TFLAG3_OLD_WORD_FORMAT)&&Nj(o&tc.CHAR_BOX)!=Nj(_&tc.CHAR_BOX)){if(Nj(o&tc.CHAR_BOX)){C5(t,")",1);if(!d5(t))return false;if(!I5(t))return false;if(!R5(t,"fldrslt",tc.PARAM_NONE,0))return false;if(!d5(t))return false;if(!d5(t))return false}else{if(!I5(t))return false;if(!R5(t,"field",tc.PARAM_NONE,0))return false;if(!I5(t))return false;if(!R5(t,"*",tc.PARAM_NONE,0))return false;if(!R5(t,"fldinst",tc.PARAM_NONE,0))return false;if(!C5(t,"EQ \\X(",6))return false}}if(Nj(fO&tc.TFLAG10_HIDDEN_IN_GROUP)){if(Nj(t.flags&tc.ROFLAG_IN_HIDDEN_GROUP)){if(!d5(t))return false;t.flags=cj(t.flags,tc.ROFLAG_IN_HIDDEN_GROUP)}if(Nj(_&tc.HIDDEN)){if(!I5(t))return false;t.flags|=tc.ROFLAG_IN_HIDDEN_GROUP}}if(Nj(o&tc.FNOTETEXT)&&Nj(_&tc.FNOTEREST))if(!d5(t))return false;if(Nj(o&tc.FNOTEREST)&&Dj(_&(tc.FNOTETEXT|tc.FNOTEREST)))if(!d5(t))return false;if(Nj(o&tc.FNOTE)&&Dj(_&(tc.FNOTE|tc.FNOTETEXT|tc.FNOTEREST)))if(!d5(t))return false;if(Nj(o&tc.FNOTETEXT)&&Dj(_&(tc.FNOTETEXT|tc.FNOTEREST))){if(!d5(t))return false;if(!d5(t))return false}if(l==tc.FIELD_NAME&&a!=tc.FIELD_NAME){I3(t,a,-1,i,f,xs[e].flags)}if(Dj(o&tc.FNOTE)&&Nj(_&tc.FNOTE))if(!I5(t))return false;if(Nj(o&tc.FNOTE)&&Nj(_&tc.FNOTETEXT)){if(!I5(t))return false;if(!R5(t,"footnote",tc.PARAM_NONE,0))return false;if(Nj(_&tc.ENOTETEXT)&&!R5(t,"ftnalt",tc.PARAM_NONE,0))return false;if(Nc[ui[i].pfmt].flow==tc.FLOW_RTL)R5(t,"rtlpar",tc.PARAM_NONE,0);if(!R5(t,"plain",tc.PARAM_NONE,0))return false;if(mR>0&&!R5(t,"li",tc.PARAM_INT,mR))return false;t.flags|=tc.ROFLAG_WRITE_FONT;t.group[t.GroupLevel].flags|=tc.ROGFLAG_WRITE_FONT}if((Iw(l)||l==tc.FIELD_TOC||l==tc.FIELD_HLINK||l==tc.FIELD_TEXTBOX||l==tc.FIELD_INCLUDEPICTURE)&&(l!=a||E||!Cw(n,c))){if(!u3(t,e))return false;if(l==tc.FIELD_HLINK&&Dj(fO&tc.TFLAG10_NO_HLINK_BOOKMARK)){if(n!=null&&n.indexOf("name=")>=0){var R,L=n.indexOf("name=")+5;var C=n.length;var I=false;var d="";var F=Uk(n);if(L+1<n.length&&F[L]==tc.CHAR_QUOTE){L++;I=true}for(R=L+1;R<C;R++){if(I){if(F[R]==tc.CHAR_QUOTE)break}else if(F[R]==tc.SPACE||F[R]==tc.RIGHT_BRACE)break}d=cV(n,L,R-L);if(!I5(t))return false;if(!R5(t,"*",tc.PARAM_NONE,0))return false;if(!R5(t,"bkmkstart",tc.PARAM_NONE,0))return false;if(!C5(t,d,d.length))return false;if(!d5(t))return false;if(!I5(t))return false;if(!R5(t,"*",tc.PARAM_NONE,0))return false;if(!R5(t,"bkmkend",tc.PARAM_NONE,0))return false;if(!C5(t,d,d.length))return false;if(!d5(t))return false}}if(!I5(t))return false;if(!R5(t,"field",tc.PARAM_NONE,0))return false;if(!I5(t))return false;if(!R5(t,"*",tc.PARAM_NONE,0))return false;if(!R5(t,"fldinst",tc.PARAM_NONE,0))return false;if(l==tc.FIELD_PAGE_NUMBER||l==tc.FIELD_PAGE_COUNT||l==tc.FIELD_SECT_PAGE_COUNT||l==tc.FIELD_DATE||l==tc.FIELD_TIME||l==tc.FIELD_PRINTDATE||l==tc.FIELD_FILE_NAME||l==tc.FIELD_DOC_PROP){if(!u3(t,e))return false}if(l==tc.FIELD_PAGE_NUMBER)if(!C5(t,"PAGE",4))return false;if(l==tc.FIELD_PAGE_COUNT)if(!C5(t,"NUMPAGES",8))return false;if(l==tc.FIELD_SECT_PAGE_COUNT)if(!C5(t,"SECTIONPAGES",12))return false;if(l==tc.FIELD_USER1)if(!C5(t,"SSUSER1",7))return false;if(l==tc.FIELD_FILE_NAME)if(!C5(t,"FILENAME",4))return false;if(l==tc.FIELD_DOC_PROP)if(!C5(t,"DOCPROPERTY",11))return false;if(l==tc.FIELD_PAGE_NUMBER||l==tc.FIELD_PAGE_COUNT||l==tc.FIELD_FILE_NAME||l==tc.FIELD_DOC_PROP){if(n!=null){if(!C5(t," ",1))return false;if(!C5(t,n,n.length))return false}}if(l==tc.FIELD_FORMULA&&n!=null){if(!C5(t,n,n.length))return false}if(l==tc.FIELD_DATE||l==tc.FIELD_TIME||l==tc.FIELD_PRINTDATE){A=l==tc.FIELD_DATE?"DATE":"PRINTDATE";if(l==tc.FIELD_TIME)A="TIME";if(Nj(n)&&n!=""){if(n.indexOf("\\@")<0){A+=" \\@ ";A=jk(A,tc.CHAR_QUOTE);A+=n;A=jk(A,tc.CHAR_QUOTE)}else{A+=" ";A+=n}}if(!C5(t,A,A.length))return false}if(l==tc.FIELD_TOC){A="TOC ";if(Nj(n)){if(!C5(t,A,A.length))return false;if(!C5(t,n,n.length))return false;t.flags=sj(t.flags,tc.ROFLAG_IGNORE_SLASH)}else{A+="\\o ";A=jk(A,tc.CHAR_QUOTE);A+="1-9";A=jk(A,tc.CHAR_QUOTE);if(!C5(t,A,A.length))return false}}if(l==tc.FIELD_LISTNUM||l==tc.FIELD_AUTONUMLGL||l==tc.FIELD_HLINK||l==tc.FIELD_PAGE_REF||l==tc.FIELD_REF||l==tc.FIELD_INCLUDEPICTURE||l==tc.FIELD_SEQ){A="";if(l==tc.FIELD_LISTNUM)A="LISTNUM";if(l==tc.FIELD_AUTONUMLGL)A="AUTONUMLGL";if(l==tc.FIELD_HLINK)A="HYPERLINK";if(l==tc.FIELD_PAGE_REF)A="PAGEREF";if(l==tc.FIELD_REF)A="REF";if(l==tc.FIELD_SEQ)A="SEQ";if(l==tc.FIELD_INCLUDEPICTURE)A="INCLUDEPICTURE";if(Nj(n)){A+=" ";if(l==tc.FIELD_HLINK)A+=L3(t,n);else if(l==tc.FIELD_INCLUDEPICTURE){A=jk(A,tc.CHAR_QUOTE);A+=n;A=jk(A,tc.CHAR_QUOTE)}else{A+=n;if(l==tc.FIELD_PAGE_REF||l==tc.FIELD_REF)A+=" "}}if(!C5(t,A,A.length))return false}if(l==tc.FIELD_TEXTBOX&&!u5(t,n))return false;if(!d5(t))return false;if(!I5(t))return false;if(!R5(t,"fldrslt",tc.PARAM_NONE,0))return false}if(l==tc.FIELD_TC&&a!=tc.FIELD_TC&&Dj(t.flags&tc.ROFLAG_IN_FIELD_TC)){if(!I5(t))return false;if(!R5(t,"tc",tc.PARAM_NONE,0))return true;if(n!=null&&n.length>0){t.flags|=tc.ROFLAG_IN_FIELD_TC;C5(t,n,n.length);t.flags=cj(t.flags,tc.ROFLAG_IN_FIELD_TC)}}if(l==tc.FIELD_XE&&a!=tc.FIELD_XE&&Dj(t.flags&tc.ROFLAG_IN_FIELD_XE)){t.flags|=tc.ROFLAG_IN_FIELD_XE;if(!I5(t))return false;if(!R5(t,"xe",tc.PARAM_NONE,0))return true}u=t.group[t.GroupLevel];if(r){u.FieldId=0;u.FieldCode=null}else{u.FieldId=xs[e].FieldId;u.FieldCode=xs[e].FieldCode}t.group[t.GroupLevel]=u;if(!u3(t,e))return false;return true}function u3(t,e){var r="",i="";var f,l;var a,n;var c,s,_,o;var u,T,A;var E,R,L,C;var I,d,F,g,P,S,h,O,v;var p,N,D;var M,G;var B,H;var m,w;var b,x;var y=tc.FNOTEALL;var W;var U;var k=false,X=false;var K,Y,V,j,J,z;var Z,Q,q,$,tt,et;var rt,it;var ft;if(Nj(Qh&tc.TFLAG3_OLD_WORD_FORMAT))y|=tc.CHAR_BOX;if(e>=Ys)return true;if(e<0)return true;r=xs[e].TypeFace;if(r==null)r="";f=xs[e].FontFamily;a=xs[e].style;G=xs[e].TextColor;H=xs[e].TextBkColor;w=xs[e].HilightColor;x=xs[e].UlineColor;c=xs[e].CharStyId;T=xs[e].TwipsSize;if(T==0&&Nj(xs[e].style&tc.PICT))T=oi.PointSize*20;_=xs[e].AuxId;E=xs[e].expand;L=xs[e].ScaleX;N=xs[e].rtlch;O=xs[e].flow;I=xs[e].lang;h=xs[e].CharSet;F=xs[e].offset;if(xs[e].FieldId==tc.FIELD_COMBOBOX)F+=xs[e].PictHeight/3;K=xs[e].InsRev;V=xs[e].DelRev;J=xs[e].FmtRev;Z=xs[e].InsTime;q=xs[e].DelTime;tt=xs[e].FmtTime;rt=xs[e].FmtOrigFont;if(Nj(Zh&tc.TFLAG2_NO_HIDDEN_RTF_TEXT)){if(Nj(a&tc.HIDDEN))t.flags|=tc.ROFLAG_HIDDEN_TEXT;else t.flags=cj(t.flags,tc.ROFLAG_HIDDEN_TEXT)}U=t.group[t.GroupLevel];if(U.FontId<0||Nj(t.flags&tc.ROFLAG_WRITE_FONT)||Nj(t.group[t.GroupLevel].flags&tc.ROGFLAG_WRITE_FONT)){U.FontId=0;k=true;t.flags=_j(t.flags,tc.ROFLAG_WRITE_FONT)}n=U.style&y;P=U.FontId;X=false;if(P>=0&&xs[P].flow!=tc.FLOW_DEF&&O==tc.FLOW_DEF)X=true;if(P>=0&&Nj(xs[P].style&tc.SUPSCR)&&Dj(a&tc.SUPSCR))X=true;if(P>=0&&Nj(xs[P].style&tc.SUBSCR)&&Dj(a&tc.SUBSCR))X=true;if(!X&&P>=0&&(t.output<tc.RTF_CB||!Z_)){if(xs[P].InsRev!=K)X=true;else if(!X&&xs[P].DelRev!=V)X=true;else if(!X&&xs[P].FmtRev!=J)X=true;else if(!X&&xs[P].InsTime!=Z)X=true;else if(!X&&xs[P].DelTime!=q)X=true;else if(!X&&xs[P].FmtTime!=tt)X=true;else if(!X&&xs[P].FmtOrigFont!=rt)X=true}if(P==0&&MJ(xs[0].TextColor,tc.CLR_AUTO))X=true;if(X)k=true;if(!k&&xs[P].CharSet==2)k=X=true;if(!k&&Nj(rO&tc.TFLAG8_HTML_RTF_CONV)&&MJ(H,tc.CLR_WHITE)&&P>=0&&!MJ(xs[P].TextBkColor,tc.CLR_WHITE))k=X=true;if(P>=0&&P!=e)k=X=true;if(k){i="";l=0;M=tc.CLR_AUTO;B=tc.CLR_WHITE;m=tc.CLR_WHITE;b=tc.CLR_AUTO;s=1;A=0;o=0;R=0;C=0;D=false;v=tc.FLOW_DEF;d=0;S=ks;g=0;Y=0;j=0;z=0;Q=null;$=null;et=null;it=0}else{i=xs[P].TypeFace;l=xs[P].FontFamily;W=xs[P].style;W=cj(W,y);n|=W;M=xs[P].TextColor;B=xs[P].TextBkColor;m=xs[P].HilightColor;b=xs[P].UlineColor;s=xs[P].CharStyId;A=xs[P].TwipsSize;o=xs[P].AuxId;R=xs[P].expand;C=xs[P].ScaleX;D=xs[P].rtlch;v=xs[P].flow;d=xs[P].lang;S=xs[P].CharSet;g=xs[P].offset;Y=xs[P].InsRev;j=xs[P].DelRev;z=xs[P].FmtRev;Q=xs[P].InsTime;$=xs[P].DelTime;et=xs[P].FmtTime;it=xs[P].FmtOrigFont}if(V!=j&&t.output>=tc.RTF_CB&&Z_){if(V!=0)t.DelRevCount++;else t.DelRevCount--}else if(V==0&&t.DelRevCount>0&&t.output>=tc.RTF_CB&&Z_)t.DelRevCount--;if(!k&&T3(t,U.FontId,e)&&U.style==(xs[e].style&y))return true;U.FontId=e;U.style=xs[e].style&y;t.group[t.GroupLevel]=U;if(r==oi.FontTypeFace&&T==oi.PointSize*20&&(MJ(G,tc.Color.black)||MJ(G,tc.CLR_AUTO))&&MJ(H,tc.CLR_WHITE)&&MJ(w,tc.CLR_WHITE)&&MJ(x,tc.CLR_AUTO)&&(a&~y)==0&&c==1&&(I==0||I==MO)&&F==0&&_==0&&E==0&&L==0&&N==false&&O==tc.FLOW_DEF&&K==0&&V==0&&J==0){if(!R5(t,"plain",tc.PARAM_NONE,0))return false;if(e>=0&&!R5(t,"f",tc.PARAM_INT,xs[e].RtfIndex))return false;if(!R5(t,"fs",tc.PARAM_INT,T/10))return false;t.flags=cj(t.flags,tc.ROFLAG_HIDDEN_TEXT);return true}if(X){if(!R5(t,"plain",tc.PARAM_NONE,0))return false;if(e>=0&&!R5(t,"f",tc.PARAM_INT,xs[e].RtfIndex))return false;if(!R5(t,"fs",tc.PARAM_INT,T/10))return false}if(c!=s){if(!R5(t,"cs",tc.PARAM_INT,c))return false}if(I!=d&&!R5(t,"lang",tc.PARAM_INT,Nj(xs[e].lang)?xs[e].lang:MO))return false;if(Tk(r,i)!=0||f!=l||I!=d||h!=S){if(!R5(t,"hich",tc.PARAM_NONE,0))return false;if(!R5(t,"f",tc.PARAM_INT,xs[e].RtfIndex))return false;if(!R5(t,"dbch",tc.PARAM_NONE,0))return false;if(!R5(t,"f",tc.PARAM_INT,xs[e].RtfIndex))return false;if(!R5(t,"loch",tc.PARAM_NONE,0))return false;if(!R5(t,"f",tc.PARAM_INT,xs[e].RtfIndex))return false}if(!MJ(G,M)){for(u=0;u<t.TotalColors;u++)if(MJ(t.color[u].color,G))break;if(u==t.TotalColors)u=0;if(!R5(t,"cf",tc.PARAM_INT,u))return false}if(!MJ(H,B)){for(u=0;u<t.TotalColors;u++)if(MJ(t.color[u].color,H))break;if(u==t.TotalColors)u=0;if(Nj(tO&tc.TFLAG6_WORDPAD_COMPATIBLE_PICT)&&!R5(t,"highlight",tc.PARAM_INT,u))return false;if(!R5(t,"cb",tc.PARAM_INT,u))return false;if(!R5(t,"chcbpat",tc.PARAM_INT,u))return false}if(!MJ(w,m)){for(u=0;u<t.TotalColors;u++)if(MJ(t.color[u].color,w))break;if(u==t.TotalColors)u=0;if(!R5(t,"highlight",tc.PARAM_INT,u))return false}if(!MJ(x,b)){for(u=0;u<t.TotalColors;u++)if(MJ(t.color[u].color,x))break;if(u==t.TotalColors)u=0;if(!R5(t,"ulc",tc.PARAM_INT,u))return false}if(T!=A)if(!R5(t,"fs",tc.PARAM_INT,T/10))return false;if(_!=o&&!Li&&!R5(t,"sscharaux",tc.PARAM_INT,_))return false;if(E!=R){if(!R5(t,"expnd",tc.PARAM_INT,E*4/20))return false;if(!R5(t,"expndtw",tc.PARAM_INT,E))return false}if(L!=C){if(!R5(t,"charscalex",tc.PARAM_INT,L+100))return false}if(false&&O==tc.FLOW_DEF&&v==tc.FLOW_DEF){if(N!=D){if(!R5(t,N?"rtlch":"ltrch",tc.PARAM_NONE,0))return false;if(N){if(!R5(t,"f",tc.PARAM_INT,xs[e].RtfIndex))return false;if(!R5(t,"fs",tc.PARAM_INT,T/10))return false}}}else if(O!=tc.FLOW_DEF){if(!R5(t,O==tc.FLOW_RTL?"rtlch":"ltrch",tc.PARAM_NONE,0))return false;if(N){if(!R5(t,"f",tc.PARAM_INT,xs[e].RtfIndex))return false;if(!R5(t,"fs",tc.PARAM_INT,T/10))return false;if(xs[e].lang!=0&&!R5(t,"lang",tc.PARAM_INT,xs[e].lang))return false}}if(F!=g){if(F==0)p=R5(t,g>0?"up":"dn",tc.PARAM_INT,0);else p=R5(t,F>0?"up":"dn",tc.PARAM_INT,tj(Math.abs(F)*2))}if(K!=Y){if(t.output<tc.RTF_CB||!Z_){if(K!=0){if(!R5(t,"revised",tc.PARAM_NONE,0))return false;if(!R5(t,"revauth",tc.PARAM_INT,K))return false;if(!R5(t,"revdttm",tc.PARAM_INT,A3(Z)))return false}else if(!R5(t,"revised",tc.PARAM_INT,0))return false}}if(V!=j){if(t.output<tc.RTF_CB||!Z_){if(V!=0){if(!R5(t,"deleted",tc.PARAM_NONE,0))return false;if(!R5(t,"revauthdel",tc.PARAM_INT,V))return false;if(!R5(t,"revdttmdel",tc.PARAM_INT,A3(q)))return false}else if(!R5(t,"deleted",tc.PARAM_INT,0))return false}}ft=false;if(J!=z||J==z&&rt!=it||J==z&&e!=P){if(t.output<tc.RTF_CB||!Z_){if(J!=0){S5(t);if(!R5(t,"crauth",tc.PARAM_INT,J))return false;if(!R5(t,"crdate",tc.PARAM_INT,A3(tt)))return false;ft=true}}}if(!R3(t,a,n))return false;if(ft&&!E3(t,e))return false;return true}function T3(t,e,r){if(e<0||r<0)return false;if(xs[e].TypeFace!=xs[r].TypeFace)return false;if(xs[e].TwipsSize!=xs[r].TwipsSize)return false;if(!MJ(xs[e].TextColor,xs[r].TextColor))return false;if(!MJ(xs[e].TextBkColor,xs[r].TextBkColor))return false;if(!MJ(xs[e].HilightColor,xs[r].HilightColor))return false;if(!MJ(xs[e].UlineColor,xs[r].UlineColor))return false;if((xs[e].style&~tc.FNOTEALL)!=(xs[r].style&~tc.FNOTEALL))return false;if(xs[e].CharStyId!=xs[r].CharStyId)return false;if(xs[e].CharSet!=xs[r].CharSet)return false;if(xs[e].AuxId!=xs[r].AuxId)return false;if(xs[e].lang!=xs[r].lang)return false;if(xs[e].offset!=xs[r].offset)return false;if(xs[e].expand!=xs[r].expand)return false;if(xs[e].ScaleX!=xs[r].ScaleX)return false;if(xs[e].rtlch!=xs[r].rtlch)return false;if(xs[e].flow!=xs[r].flow)return false;if(xs[e].InsRev!=xs[r].InsRev)return false;if(xs[e].DelRev!=xs[r].DelRev)return false;if(xs[e].FmtRev!=xs[r].FmtRev)return false;if(xs[e].InsTime!=xs[r].InsTime)return false;if(xs[e].DelTime!=xs[r].DelTime)return false;if(xs[e].FmtTime!=xs[r].FmtTime)return false;return true}function A3(t){if(t==null){t=new tc.ClsDate;t.dt=new Date}var e=t.dt.getMinutes()|t.dt.getHours()<<6|t.dt.getDay()<<11|t.dt.getMonth()<<16|t.dt.getFullYear()-1900<<20|t.dt.getDay()<<29;return e}function E3(t,e){var r;var i=xs[e].FmtOrigFont;if(!I5(t))return false;if(!R5(t,"*",tc.PARAM_NONE,0))return false;if(!R5(t,"oldcprops",tc.PARAM_NONE,0))return false;if(Tk(xs[i].TypeFace,xs[e].TypeFace)!=0||xs[i].CharSet!=xs[e].CharSet){if(!R5(t,"f",tc.PARAM_INT,xs[i].RtfIndex))return false}if(xs[i].TwipsSize!=xs[e].TwipsSize&&!R5(t,"fs",tc.PARAM_INT,xs[i].TwipsSize/10))return false;if(!MJ(xs[i].TextColor,xs[e].TextColor)){for(r=0;r<t.TotalColors;r++)if(MJ(t.color[r].color,xs[i].TextColor))break;if(r==t.TotalColors)r=0;if(!R5(t,"cf",tc.PARAM_INT,r))return false}if(!MJ(xs[i].TextBkColor,xs[e].TextBkColor)){for(r=0;r<t.TotalColors;r++)if(MJ(t.color[r].color,xs[i].TextBkColor))break;if(r==t.TotalColors)r=0;if(!R5(t,"cb",tc.PARAM_INT,r))return false;if(!R5(t,"chcbpat",tc.PARAM_INT,r))return false}if(!MJ(xs[i].HilightColor,xs[e].HilightColor)){for(r=0;r<t.TotalColors;r++)if(MJ(t.color[r].color,xs[i].HilightColor))break;if(r==t.TotalColors)r=0;if(!R5(t,"highlight",tc.PARAM_INT,r))return false}if(!MJ(xs[i].UlineColor,xs[e].UlineColor)){for(r=0;r<t.TotalColors;r++)if(MJ(t.color[r].color,xs[i].UlineColor))break;if(r==t.TotalColors)r=0;if(!R5(t,"ulc",tc.PARAM_INT,r))return false}if(xs[i].expand!=xs[e].expand){if(!R5(t,"expnd",tc.PARAM_INT,xs[i].expand*4/20))return false;if(!R5(t,"expndtw",tc.PARAM_INT,xs[i].expand))return false}if(xs[i].ScaleX!=xs[e].ScaleX){if(!R5(t,"charscalex",tc.PARAM_INT,xs[i].ScaleX+100))return false}if(xs[i].offset!=xs[e].offset){var f=xs[i].offset;R5(t,f>0?"up":"dn",tc.PARAM_INT,tj(Math.abs(f)*2))}R3(t,xs[i].style,xs[e].style);if(!d5(t))return false;return true}function R3(t,e,r){var i;if(Nj(e&tc.BOLD)!=Nj(r&tc.BOLD)){if(Nj(e&tc.BOLD))i=R5(t,"b",tc.PARAM_NONE,0);else i=R5(t,"b",tc.PARAM_INT,0);if(!i)return false}if(Nj(e&tc.HLINK)!=Nj(r&tc.HLINK)){if(Nj(e&tc.HLINK))i=R5(t,"sshlink",tc.PARAM_NONE,0);else i=R5(t,"sshlink",tc.PARAM_INT,0);if(!i)return false}if(Nj(e&tc.ULINE)!=Nj(r&tc.ULINE)){if(Nj(e&tc.ULINE))i=R5(t,"ul",tc.PARAM_NONE,0);else i=R5(t,"ul",tc.PARAM_INT,0);if(!i)return false}if(Nj(e&tc.ULINED)!=Nj(r&tc.ULINED)){if(Nj(e&tc.ULINED))i=R5(t,"uldb",tc.PARAM_NONE,0);else i=R5(t,"uldb",tc.PARAM_INT,0);if(!i)return false}if(Nj(e&tc.ULINE_DOTTED)!=Nj(r&tc.ULINE_DOTTED)){if(Nj(e&tc.ULINE_DOTTED))i=R5(t,"uld",tc.PARAM_NONE,0);else i=R5(t,"uld",tc.PARAM_INT,0);if(!i)return false}if(Nj(e&tc.EMBOSS)!=Nj(r&tc.EMBOSS)){if(Nj(e&tc.EMBOSS))i=R5(t,"embo",tc.PARAM_NONE,0);else i=R5(t,"embo",tc.PARAM_INT,0);if(!i)return false}if(Nj(e&tc.ITALIC)!=Nj(r&tc.ITALIC)){if(Nj(e&tc.ITALIC))i=R5(t,"i",tc.PARAM_NONE,0);else i=R5(t,"i",tc.PARAM_INT,0);if(!i)return false}if(Nj(Zh&tc.TFLAG2_NO_HIDDEN_RTF_TEXT)){if(Nj(e&tc.HIDDEN))t.flags|=tc.ROFLAG_HIDDEN_TEXT;else t.flags=cj(t.flags,tc.ROFLAG_HIDDEN_TEXT)}else if(Nj(e&tc.HIDDEN)!=Nj(r&tc.HIDDEN)){if(Nj(e&tc.HIDDEN))i=R5(t,"v",tc.PARAM_NONE,0);else i=R5(t,"v",tc.PARAM_INT,0);if(!i)return false}if(Nj(e&tc.STRIKE)!=Nj(r&tc.STRIKE)){if(Nj(e&tc.STRIKE))i=R5(t,"strike",tc.PARAM_NONE,0);else i=R5(t,"strike",tc.PARAM_INT,0);if(!i)return false}if(Nj(e&tc.DOUBLE_STRIKE)!=Nj(r&tc.DOUBLE_STRIKE)){if(Nj(e&tc.DOUBLE_STRIKE))i=R5(t,"striked",tc.PARAM_INT,1);else i=R5(t,"striked",tc.PARAM_INT,0);if(!i)return false}if(Nj(e&tc.CAPS)!=Nj(r&tc.CAPS)){if(Nj(e&tc.CAPS))i=R5(t,"caps",tc.PARAM_NONE,0);else i=R5(t,"caps",tc.PARAM_INT,0);if(!i)return false}if(Nj(e&tc.SCAPS)!=Nj(r&tc.SCAPS)){if(Nj(e&tc.SCAPS))i=R5(t,"scaps",tc.PARAM_NONE,0);else i=R5(t,"scaps",tc.PARAM_INT,0);if(!i)return false}if(Nj(e&tc.PROTECT)!=Nj(r&tc.PROTECT)){if(Nj(e&tc.PROTECT))i=R5(t,"protect",tc.PARAM_NONE,0);else i=R5(t,"protect",tc.PARAM_INT,0);if(!i)return false}if(Nj(e&tc.CHAR_BOX)!=Nj(r&tc.CHAR_BOX)){if(Nj(e&tc.CHAR_BOX)){if(!R5(t,"chbrdr",tc.PARAM_NONE,0))return false;if(!R5(t,"brdrs",tc.PARAM_NONE,0))return false;if(!R5(t,"brdrw",tc.PARAM_INT,10))return false}else{if(!R5(t,"chbrdr",tc.PARAM_INT,0))return false}}if(Nj(e&tc.LEFT_LINE)!=Nj(r&tc.LEFT_LINE)){if(Nj(e&tc.LEFT_LINE))i=R5(t,"ssleftline",tc.PARAM_NONE,0);else i=R5(t,"ssleftline",tc.PARAM_INT,0);if(!i)return false}if((e&tc.SUPSCR)!=(r&tc.SUPSCR)){if(Nj(e&tc.SUPSCR))i=R5(t,"super",tc.PARAM_NONE,0);else i=R5(t,"nosupersub",tc.PARAM_NONE,0);if(!i)return false}if((e&tc.SUBSCR)!=(r&tc.SUBSCR)){if(Nj(e&tc.SUBSCR))i=R5(t,"sub",tc.PARAM_NONE,0);else i=R5(t,"nosupersub",tc.PARAM_NONE,0);if(!i)return false}return true}function L3(t,e){var r;var i;var f,l,a,n;var c="";var s;r=e.toUpperCase().indexOf("HREF=");if((Li||Nj(qh&tc.TFLAG4_HTML_INPUT)||vr)&&r>=0){f=r;f+=5;l=e.length;s=Uk(e);while(s[f]==tc.SPACE&&f<l)f++;if(f<l){i=s[f];a=f;for(f=a+1;f<l;f++){if(i==gk("'")||i==tc.CHAR_QUOTE){if(s[f]==i){f++;break}}else if(s[f]==tc.SPACE)break}n=f;c+=cV(e,a,n-a);var _=c;if(c.length>0)c=Zk(_,2)}else{e=Zk(e,2);if(e.indexOf(" ")>0&&e.indexOf('"')<0)e=zk(e);c+=e}}else{if(uK(e,tc.CHAR_l)){c+=e}else{var o;var u=false,T=false;var A=0;var E=false,R=false;l=e.length;s=Uk(e);for(f=0;f<l;f++){if(!u&&s[f]==tc.QUOTE){u=true;A=f}else if(!u&&s[f]!=tc.SPACE){u=true;A=f;R=true}else if(u&&(E&&s[f]==tc.QUOTE||R&&s[f]==tc.SPACE)){var L=f-A+1;var C=cV(e,A,L);o=Zk(C,2);o=cV(e,0,A)+o+cV(e,A+L);c+=o;T=true;break}}if(!T){e=Zk(e,2);if(e.indexOf('"')<0)e=zk(e);c+=e}}}return c}function C3(t){var e=t.group[t.GroupLevel];if(!R5(t,"plain",tc.PARAM_NONE,0))return false;if(!R5(t,"f",tc.PARAM_INT,xs[0].RtfIndex))return false;if(!R5(t,"fs",tc.PARAM_INT,xs[0].TwipsSize/10))return false;e.FontId=0;t.group[t.GroupLevel]=e;return true}function I3(t,e,r,i,f,l){var a="";var n;var c=false;if(i>=0&&i<Ri&&f>=0&&f<ui[i].len){var s,_;var o=ui[i].txt;for(s=f;s>=0;s--)if(o[s]==tc.LEFT_BRACE)break;for(_=f;_<ui[i].len;_++)if(o[_]==tc.RIGHT_BRACE)break;if(s>=0)a=Wk(ui[i].txt,s,_-s);a=a.toUpperCase()}c=!d3(a,"QUOTE")&&!d3(a,"FILENAME");if(e==tc.FIELD_DATA||e==tc.FIELD_NAME){if(Nj(t.flags&tc.ROFLAG_IN_MERGE_FIELD)){if(!d5(t))return false;if(!d5(t))return false;t.flags=cj(t.flags,tc.ROFLAG_IN_MERGE_FIELD)}}if(!I5(t))return false;if(!R5(t,"field",tc.PARAM_NONE,0))return false;t.flags|=tc.ROFLAG_IN_MERGE_FIELD;if(c&&(Nj(l&tc.FFLAG_FIELD_LOCKED)||Nj(fO&tc.TFLAG10_LOCK_DATA_FIELD))&&!R5(t,"fldlock",tc.PARAM_NONE,0))return false;if(!I5(t))return false;if(!R5(t,"*",tc.PARAM_NONE,0))return false;if(!R5(t,"fldinst",tc.PARAM_NONE,0))return false;if(c){n="MERGEFIELD ";C5(t,n,n.length)}t.flags|=tc.ROFLAG_IN_FIELD_NAME;if(r>=0){var u=t.group[t.GroupLevel];u.style=xs[r].style;u.FieldId=xs[r].FieldId;u.FieldCode=xs[r].FieldCode;t.group[t.GroupLevel]=u}return true}function d3(t,e){var r=t.indexOf(e);var i=t.length;if(r<0)return false;if(r==0)return true;if(r+1==i)return true;var f=Uk(t);if(r>0&&(f[r-1]==tc.SPACE||f[r-1]==tc.LEFT_BRACE)){if(r+1<i&&(f[r+1]==tc.SPACE||f[r+1]==tc.RIGHT_BRACE))return true}return false}function F3(t,e,r,i,f,l,a,n){var c,s,_=0;var o,u=0;var T,A=0;var E,R=0;var L,C=0;var I,d=0,F,g;var P,S=0;var h,O=0;var v,p=0;var N,D=0;var M,G=0;var B,H=0;var m,w=0;var b,x=0;var y,W=0;var U,k=0;var X,K=tc.FLOW_DEF;var Y,V=0;var j,J=0;var z,Z=-1;var Q,q=tc.CLR_WHITE;var $,tt=tc.CLR_AUTO;var et,rt=false,it=false;var ft=false;var lt,at=0;var nt=null,ct=null;var st,_t=0;var ot=false;var ut,Tt=0;var At,Et=0;var Rt,Lt=0;var Ct,It=0;var dt,Ft=0;var gt,Pt=0;if(r>=Dc||e>=Dc)return true;if(e<0)return true;if(r>0){_=Nc[r].LeftIndentTwips;u=Nc[r].RightIndentTwips;A=Nc[r].FirstIndentTwips;d=Nc[r].flags;if(Nj(a)&&Nj(f))d=cj(d,tc.PARA_BOX);d=cj(d,tc.PAGE_HDR_FTR);R=Nc[r].TabId;C=Nc[r].BltId;p=Nc[r].shading;W=Nc[r].StyId;G=Nc[r].SpaceBefore;H=Nc[r].SpaceAfter;w=Nc[r].SpaceBetween;x=Nc[r].LineSpacing;Pt=Nc[r].TextVAlign;q=Nc[r].BkColor;tt=Nc[r].BorderColor;K=Nc[r].flow;k=Nc[r].pflags&tc.PFLAG_STYLES;J=Nc[r].AuxId;at=Nc[r].FmtRev;ct=Nc[r].FmtTime==null?null:Nc[r].FmtTime.copy();_t=Nc[r].FmtOrigPara;Z=Nc[r].OutlineLevel;Tt=Nj(d&tc.PARA_BOX_LEFT)?Nc[r].BorderSpaceLeft:0;Et=Nj(d&tc.PARA_BOX_RIGHT)?Nc[r].BorderSpaceRight:0;Lt=Nj(d&tc.PARA_BOX_TOP)?Nc[r].BorderSpaceTop:0;It=Nj(d&tc.PARA_BOX_BOT)?Nc[r].BorderSpaceBot:0;Ft=Nj(d&tc.PARA_BOX)?Nc[r].BorderWidth:0}S=f;O=eR[S].row;V=eR[f].level;D=a;s=Nc[e].LeftIndentTwips;o=Nc[e].RightIndentTwips;T=Nc[e].FirstIndentTwips;I=Nc[e].flags;if(Nj(l)&&Nj(i))I=cj(I,tc.PARA_BOX);I=cj(I,tc.PAGE_HDR_FTR);E=Nc[e].TabId;L=Nc[e].BltId;P=i;h=eR[P].row;v=Nc[e].shading;N=l;y=Nc[e].StyId;M=Nc[e].SpaceBefore;B=Nc[e].SpaceAfter;m=Nc[e].SpaceBetween;b=Nc[e].LineSpacing;gt=Nc[e].TextVAlign;Q=Nc[e].BkColor;$=Nc[e].BorderColor;X=Nc[e].flow;U=Nc[e].pflags&tc.PFLAG_STYLES;j=Nc[e].AuxId;lt=Nc[e].FmtRev;nt=Nc[e].FmtTime==null?null:Nc[e].FmtTime.copy();st=Nc[e].FmtOrigPara;z=Nc[e].OutlineLevel;ut=Nj(I&tc.PARA_BOX_LEFT)?Nc[e].BorderSpaceLeft:0;At=Nj(I&tc.PARA_BOX_RIGHT)?Nc[e].BorderSpaceRight:0;Rt=Nj(I&tc.PARA_BOX_TOP)?Nc[e].BorderSpaceTop:0;Ct=Nj(I&tc.PARA_BOX_BOT)?Nc[e].BorderSpaceBot:0;dt=Nj(I&tc.PARA_BOX)?Nc[e].BorderWidth:0;Y=eR[i].level;if(Y!=V)S5(t);if(D>0&&D!=N&&Nj(kl[D].flags&tc.PARA_FRAME_TEXT_BOX)){if(!N3(t,a))return false}if(N!=D&&N>0){if(Nj(kl[N].flags&tc.PARA_FRAME_OBJECT))P3(t,N,I,l);else h3(t,N);_=u=A=R=C=0;G=H=w=x=0;d=0;k=0;W=0;q=tc.Color.white;tt=tc.CLR_AUTO;K=tc.FLOW_DEF;Z=-1;Tt=0;Et=0;Lt=0;It=0;Ft=0;Pt=0;rt=true}if(h!=O){var St=eR[i].ParentCell;var ht=eR[St].row;if(V>NR&&O!=ht){if(n>0&&GY(n-1,tc.INFO_ROW))D3(t,0,f,V,n)}if(Y==NR&&h>0){D3(t,i,0,V,n);DR=true}}if(s==0&&o==0&&T==0&&I==0&&E==0&&P==0&&v==0&&N==0&&D==0&&M==0&&B==0&&m==0&&b==0&&y==0&&X==tc.FLOW_DEF&&U==0&&MJ(Q,tc.CLR_WHITE)&&lt==0&&z==-1&&ut==0&&At==0&&Rt==0&&Ct==0&&dt==0&&gt==0){return R5(t,"pard",tc.PARAM_NONE,0)}F=tc.PARA_CONTEXTUAL_SPACE|tc.PARA_KEEP|tc.PARA_KEEP_NEXT|tc.PARA_BOX_ATTRIB|tc.BULLET|tc.DOUBLE_SPACE;g=tc.PFLAG_WIDOW|tc.PFLAG_NO_WRAP|tc.PFLAG_PAGE_BREAK|tc.PFLAG_NO_SNAP_TO_GRID;ft=n>0&&n<Ri&&Nj(ui[n-1].tabw)&&Nj(ui[n-1].tabw.type&tc.INFO_SECT);if(P!=S||E!=R||L!=C||N!=D||y!=W||K!=tc.FLOW_DEF&&X==tc.FLOW_DEF||(I&F)!=(d&F)||(U&g)!=(k&g)||(I&(tc.AUTO_SPACE_BEFORE|tc.AUTO_SPACE_AFTER))!=(d&(tc.AUTO_SPACE_BEFORE|tc.AUTO_SPACE_AFTER))||ft||lt!=at||!Ak(nt,ct)||st!=_t||z!=Z||!MJ(Q,q)||ut!=Tt||At!=Et||Rt!=Lt||Ct!=It||dt!=Ft||gt!=Pt||X==tc.FLOW_RTL||Nj(t.flags&tc.ROFLAG_WRITE_PARA_PROPS)){R5(t,"pard",tc.PARAM_NONE,0);if(Dj(kl[N].flags&tc.PARA_FRAME_OBJECT))h3(t,N);if(P>0&&eR[P].level>=NR){R5(t,"intbl",tc.PARAM_NONE,0);if(Y>NR)R5(t,"itap",tc.PARAM_INT,Y-NR+1)}_=u=A=R=C=0;G=H=w=x=0;d=0;k=0;W=p=0;K=tc.FLOW_DEF;q=tc.CLR_WHITE;tt=tc.CLR_AUTO;Z=-1;Tt=0;Et=0;Lt=0;It=0;Ft=0;Pt=0;rt=true}if((j!=J||rt)&&!Li&&!R5(t,"ssparaaux",tc.PARAM_INT,j))return false;if(y!=W||rt){var Ot=true;if(Nj(Zh&tc.TFLAG2_COMP_WPF)&&P>0)Ot=false;if(Ot&&!R5(t,"s",tc.PARAM_INT,y))return false;if(Nj(W_[y].flags&tc.SSFLAG_NO_SPACE)&&!R5(t,"contextualspace",tc.PARAM_NONE,0))return false}if(E!=R||rt){if(!Y3(t,E))return false;A=_=u=C=0;G=H=w=x=0;d=d=0;K=0;q=tc.CLR_WHITE;tt=tc.CLR_AUTO}if(Nj(I&tc.BULLET)&&(rt||Dj(d&tc.BULLET))){if(!p3(t,L,n))return false}if(Dj(I&(tc.PARA_BOX|tc.PARA_BOX_THICK|tc.PARA_BOX_DOUBLE)))$=tc.CLR_AUTO;if(Dj(d&(tc.PARA_BOX|tc.PARA_BOX_THICK|tc.PARA_BOX_DOUBLE)))tt=tc.CLR_AUTO;if(rt||Nj(I&(tc.PARA_BOX|tc.PARA_BOX_THICK|tc.PARA_BOX_DOUBLE))!=Nj(d&(tc.PARA_BOX|tc.PARA_BOX_THICK|tc.PARA_BOX_DOUBLE))||!MJ($,tt)){if(Dj($h&tc.TFLAG5_FRAME_TEXT_ONLY)&&!X3(t,I,$,N,ut,At,Rt,Ct,dt))return false;A=_=u=0;d=0;k=0;K=0}if(T!=A){if(!R5(t,"fi",tc.PARAM_INT,T))return false}if(s!=_){if(!R5(t,"li",tc.PARAM_INT,s))return false}if(o!=u){if(!R5(t,"ri",tc.PARAM_INT,o))return false}if(M!=G){if(Dj(I&tc.AUTO_SPACE_BEFORE)&&!R5(t,"sb",tc.PARAM_INT,M))return false}if(B!=H){if(Dj(I&tc.AUTO_SPACE_AFTER)&&!R5(t,"sa",tc.PARAM_INT,B))return false}if(m!=w){if(!R5(t,"sl",tc.PARAM_INT,m))return false}else if(b!=x){if(!R5(t,"sl",tc.PARAM_INT,Mj(b,240,100)+240))return false;if(!R5(t,"slmult",tc.PARAM_INT,1))return false}if(gt!=Pt){if(gt==tc.TEXT_VALIGN_TOP&&!R5(t,"fahang",tc.PARAM_INT,1))return false;if(gt==tc.TEXT_VALIGN_BOT&&!R5(t,"favar",tc.PARAM_INT,1))return false;if(gt==tc.TEXT_VALIGN_CENTER&&!R5(t,"facenter",tc.PARAM_INT,1))return false;if(gt==tc.TEXT_VALIGN_BASE&&!R5(t,"faroman",tc.PARAM_INT,1))return false}if(X!=K){if(X==tc.FLOW_RTL&&!R5(t,"rtlpar",tc.PARAM_NONE,0))return false;if(X==tc.FLOW_LTR&&!R5(t,"ltrpar",tc.PARAM_NONE,0))return false}if(Nj(I&tc.RIGHT_JUSTIFY)){if(Dj(d&tc.RIGHT_JUSTIFY)||K!=X){et=R5(t,"qr",tc.PARAM_NONE,0);if(!et)return false}}else if(Nj(I&tc.CENTER)){if(Dj(d&tc.CENTER)||K!=X){et=R5(t,"qc",tc.PARAM_NONE,0);if(!et)return false}}else if(Nj(I&tc.JUSTIFY)){if(Dj(d&tc.JUSTIFY)||(I&tc.JUSTIFY_DIST)!=(d&tc.JUSTIFY_DIST)||K!=X){if(Nj(I&tc.JUSTIFY_DIST))et=R5(t,"qd",tc.PARAM_NONE,0);else et=R5(t,"qj",tc.PARAM_NONE,0);if(!et)return false}}else if(Nj(I&tc.LEFT)||Dj(I&(tc.RIGHT_JUSTIFY|tc.CENTER|tc.JUSTIFY))){if(Dj(d&tc.LEFT)||Nj(d&(tc.RIGHT_JUSTIFY|tc.CENTER|tc.JUSTIFY))||K!=X){et=R5(t,"ql",tc.PARAM_NONE,0);if(!et)return false}}if(Nj(I&tc.DOUBLE_SPACE)!=Nj(d&tc.DOUBLE_SPACE)&&m==w&&b==x){if(Nj(I&tc.DOUBLE_SPACE)){et=R5(t,"sl",tc.PARAM_INT,480);et=R5(t,"slmult",tc.PARAM_INT,1)}else et=R5(t,"sl",tc.PARAM_INT,0);if(!et)return false}if(Nj(I&tc.PARA_CONTEXTUAL_SPACE)&&Dj(d&tc.PARA_CONTEXTUAL_SPACE)){et=R5(t,"contextualspace",tc.PARAM_NONE,0)}if(Nj(I&tc.PARA_KEEP)&&Dj(d&tc.PARA_KEEP)){et=R5(t,"keep",tc.PARAM_NONE,0)}if(Nj(I&tc.PARA_KEEP_NEXT)&&Dj(d&tc.PARA_KEEP_NEXT)){et=R5(t,"keepn",tc.PARAM_NONE,0)}if(Nj(I&tc.AUTO_SPACE_BEFORE)&&Dj(d&tc.AUTO_SPACE_BEFORE)){R5(t,"sb",tc.PARAM_INT,100);et=R5(t,"sbauto",tc.PARAM_INT,Nj(I&tc.AUTO_SPACE_BEFORE)?1:0)}if(Nj(I&tc.AUTO_SPACE_AFTER)&&Dj(d&tc.AUTO_SPACE_AFTER)){R5(t,"sa",tc.PARAM_INT,100);et=R5(t,"saauto",tc.PARAM_INT,Nj(I&tc.AUTO_SPACE_AFTER)?1:0)}if(Nj(U&tc.PFLAG_WIDOW)&&Dj(k&tc.PFLAG_WIDOW)){et=R5(t,"widctlpar",tc.PARAM_NONE,0)}if(Nj(U&tc.PFLAG_NO_SNAP_TO_GRID)&&Dj(k&tc.PFLAG_NO_SNAP_TO_GRID)){et=R5(t,"nosnaplinegrid",tc.PARAM_NONE,0)}if(Nj(U&tc.PFLAG_NO_WRAP)&&Dj(k&tc.PFLAG_NO_WRAP)){et=R5(t,"ssparnw",tc.PARAM_NONE,0)}if(Nj(U&tc.PFLAG_PAGE_BREAK)&&Dj(k&tc.PFLAG_PAGE_BREAK)){et=R5(t,"pagebb",tc.PARAM_NONE,0)}if(z!=Z&&z>=0){if(!R5(t,"outlinelevel",tc.PARAM_INT,z))return false;it=true}if(v!=p){if(!R5(t,"shading",tc.PARAM_INT,v))return false;it=true}if(!MJ(Q,q)){for(c=0;c<t.TotalColors;c++)if(MJ(t.color[c].color,Q))break;if(c==t.TotalColors)c=0;if(!R5(t,"cbpat",tc.PARAM_INT,c))return false}if(lt!=at||!Ak(nt,ct)||st!=_t){if(t.output<tc.RTF_CB||!Z_){if(lt!=0){S5(t);if(!R5(t,"prauth",tc.PARAM_INT,lt))return false;if(!R5(t,"prdate",tc.PARAM_INT,A3(nt)))return false;ot=true}}}if(ot&&!g3(t,e,n))return false;if(it)C3(t);return true}function g3(t,e,r){var i;var f=Nc[e].FmtOrigPara;var l=false;var a;var n=Nc[f].flags;var c=Nc[f].LeftIndentTwips;var s=Nc[f].RightIndentTwips;var _=Nc[f].FirstIndentTwips;var o=Nc[f].TabId;var u=Nc[f].BltId;var T=Nc[f].shading;var A=Nc[f].SpaceBefore;var E=Nc[f].SpaceAfter;var R=Nc[f].SpaceBetween;var L=Nc[f].LineSpacing;var C=Nc[f].flow;var I=Nc[f].pflags;var d=Nc[f].AuxId;var F=Nc[f].BkColor;var g=Nc[f].BorderColor;var P=Nc[e].flags;var S=Nc[e].LeftIndentTwips;var h=Nc[e].RightIndentTwips;var O=Nc[e].FirstIndentTwips;var v=Nc[e].TabId;var p=Nc[e].BltId;var N=Nc[e].shading;var D=Nc[e].SpaceBefore;var M=Nc[e].SpaceAfter;var G=Nc[e].SpaceBetween;var B=Nc[e].LineSpacing;var H=Nc[e].flow;var m=Nc[e].pflags;var w=Nc[e].AuxId;var b=Nc[e].BkColor;var x=Nc[e].BorderColor;if(!I5(t))return false;if(!R5(t,"*",tc.PARAM_NONE,0))return false;if(!R5(t,"oldpprops",tc.PARAM_NONE,0))return false;if(!R5(t,"pard",tc.PARAM_NONE,0))return false;if(Nc[e].TabId!=Nc[f].TabId){if(!Y3(t,Nc[f].TabId))return false}if(Nj(n&tc.BULLET)&&Nc[f].BltId!=Nc[e].BltId){if(!p3(t,Nc[f].BltId,r))return false}if(Dj(n&(tc.PARA_BOX|tc.PARA_BOX_THICK|tc.PARA_BOX_DOUBLE)))g=tc.CLR_AUTO;if(Dj(P&(tc.PARA_BOX|tc.PARA_BOX_THICK|tc.PARA_BOX_DOUBLE)))x=tc.CLR_AUTO;if((n&(tc.PARA_BOX|tc.PARA_BOX_THICK|tc.PARA_BOX_DOUBLE))!=(P&(tc.PARA_BOX|tc.PARA_BOX_THICK|tc.PARA_BOX_DOUBLE))||!MJ(g,x)||Nj(P&(tc.PARA_BOX|tc.PARA_BOX_THICK|tc.PARA_BOX_DOUBLE))){if(Dj($h&tc.TFLAG5_FRAME_TEXT_ONLY)&&!X3(t,n,g,0,Nc[e].BorderSpaceLeft,Nc[e].BorderSpaceRight,Nc[e].BorderSpaceTop,Nc[e].BorderSpaceBot,Nc[e].BorderWidth))return false;O=S=h=0;P=m=H=0}if(O!=0||_!=O){if(!R5(t,"fi",tc.PARAM_INT,_))return false}if(S!=0||c!=S){if(!R5(t,"li",tc.PARAM_INT,c))return false}if(h!=0||s!=h){if(!R5(t,"ri",tc.PARAM_INT,s))return false}if(D!=0||A!=D){if(!R5(t,"sb",tc.PARAM_INT,A))return false}if(M!=0||E!=M){if(!R5(t,"sa",tc.PARAM_INT,E))return false}if(B!=0||L!=B){if(!R5(t,"sl",tc.PARAM_INT,Mj(L,240,100)+240))return false;if(!R5(t,"slmult",tc.PARAM_INT,1))return false}else if(G!=0||R!=G){if(!R5(t,"sl",tc.PARAM_INT,R))return false}if(H!=tc.FLOW_LTR||C!=H){if(C==tc.FLOW_RTL&&!R5(t,"rtlpar",tc.PARAM_NONE,0))return false;if(C==tc.FLOW_LTR&&!R5(t,"ltrpar",tc.PARAM_NONE,0))return false}a=tc.LEFT|tc.RIGHT_JUSTIFY|tc.CENTER|tc.JUSTIFY;if(Nj(P&(tc.RIGHT_JUSTIFY|tc.CENTER|tc.JUSTIFY))||(n&a)!=(P&a)){if(Nj(n&tc.RIGHT_JUSTIFY))R5(t,"qr",tc.PARAM_NONE,0);else if(Nj(n&tc.CENTER))R5(t,"qc",tc.PARAM_NONE,0);else if(Nj(n&tc.JUSTIFY)){if(Nj(n&tc.JUSTIFY_DIST))R5(t,"qd",tc.PARAM_NONE,0);else R5(t,"qj",tc.PARAM_NONE,0)}else R5(t,"ql",tc.PARAM_NONE,0)}if((n&tc.DOUBLE_SPACE)!=(P&tc.DOUBLE_SPACE)||Nj(P&tc.DOUBLE_SPACE)&&(R==G&&L==B)){if(Nj(n&tc.DOUBLE_SPACE)){l=R5(t,"sl",tc.PARAM_INT,480);l=R5(t,"slmult",tc.PARAM_INT,1)}else l=R5(t,"sl",tc.PARAM_INT,0);if(!l)return false}if(Nj(n&tc.PARA_CONTEXTUAL_SPACE)){l=R5(t,"contextualspace",tc.PARAM_NONE,0)}if(Nj(n&tc.PARA_KEEP)){l=R5(t,"keep",tc.PARAM_NONE,0)}if(Nj(n&tc.PARA_KEEP_NEXT)){l=R5(t,"keepn",tc.PARAM_NONE,0)}if(Nj(n&tc.AUTO_SPACE_BEFORE)){R5(t,"sb",tc.PARAM_INT,100);l=R5(t,"sbauto",tc.PARAM_INT,Nj(n&tc.AUTO_SPACE_BEFORE)?1:0)}if(Nj(n&tc.AUTO_SPACE_AFTER)){R5(t,"sa",tc.PARAM_INT,100);l=R5(t,"saauto",tc.PARAM_INT,Nj(n&tc.AUTO_SPACE_AFTER)?1:0)}if(Nj(I&tc.PFLAG_WIDOW)){l=R5(t,"widctlpar",tc.PARAM_NONE,0)}if(Nj(I&tc.PFLAG_NO_SNAP_TO_GRID)){l=R5(t,"nosnaplinegrid",tc.PARAM_NONE,0)}if(Nj(I&tc.PFLAG_NO_WRAP)){l=R5(t,"ssparnw",tc.PARAM_NONE,0)}if(Nj(I&tc.PFLAG_PAGE_BREAK)){l=R5(t,"pagebb",tc.PARAM_NONE,0)}if(T!=N||N!=0){if(!R5(t,"shading",tc.PARAM_INT,T))return false}if(!MJ(Nc[f].BkColor,Nc[e].BkColor)||!MJ(Nc[e].BkColor,tc.CLR_WHITE)){for(i=0;i<t.TotalColors;i++)if(MJ(t.color[i].color,Nc[f].BkColor))break;if(i==t.TotalColors)i=0;if(!R5(t,"cbpat",tc.PARAM_INT,i))return false}if(!d5(t))return false;return true}function P3(t,e,r,i){var f;var l=false,a=false,n=false;if(Nj(kl[e].flags&(tc.PARA_FRAME_LINE|tc.PARA_FRAME_RECT))){if(Nj(r&tc.PARA_KEEP_NEXT))R5(t,"keepn",tc.PARAM_NONE,0)}S5(t);if(Nj($h&tc.TFLAG5_WRITE_DOB)){if(!I5(t))return false;if(!R5(t,"do",tc.PARAM_NONE,0))return false;if(Dj(kl[e].flags&tc.PARA_FRAME_HPAGE)&&!R5(t,"dobxmargin",tc.PARAM_NONE,0))return false;if(Nj(kl[e].flags&tc.PARA_FRAME_HPAGE)&&!R5(t,"dobxpage",tc.PARAM_NONE,0))return false;if(Dj(kl[e].flags&(tc.PARA_FRAME_VPAGE|tc.PARA_FRAME_VMARG))&&!R5(t,"dobypara",tc.PARAM_NONE,0))return false;if(Nj(kl[e].flags&tc.PARA_FRAME_VMARG)&&!R5(t,"dobymargin",tc.PARAM_NONE,0))return false;if(Nj(kl[e].flags&tc.PARA_FRAME_VPAGE)&&!R5(t,"dobypage",tc.PARAM_NONE,0))return false;f=kl[e].ZOrder;if(f<0)f=0;if(!R5(t,"dodhgt",tc.PARAM_INT,f))return false;if(Nj(kl[e].flags&tc.PARA_FRAME_TEXT_BOX)){if(!R5(t,"dptxbx",tc.PARAM_NONE,0))return false;if(!R5(t,"dptxbxmar",tc.PARAM_INT,kl[e].margin))return false;if(kl[e].TextAngle==90&&!R5(t,"dptxbtlr",tc.PARAM_NONE,0))return false;if(kl[e].TextAngle==270&&!R5(t,"dptxtbrl",tc.PARAM_NONE,0))return false;if(!I5(t))return false;if(!R5(t,"dptxbxtext",tc.PARAM_NONE,0))return false}else if(Nj(kl[e].flags&tc.PARA_FRAME_LINE)){if(!R5(t,"dpline",tc.PARAM_NONE,0))return false;N3(t,i)}else if(Nj(kl[e].flags&tc.PARA_FRAME_RECT)){if(!R5(t,"dprect",tc.PARAM_NONE,0))return false;N3(t,i)}}else{var c=kl[e];var s;var _;R5(t,"pard",tc.PARAM_NONE,0);S5(t);if(!I5(t))return false;if(!R5(t,"shp",tc.PARAM_NONE,0))return false;if(!I5(t))return false;if(!R5(t,"*",tc.PARAM_NONE,0))return false;if(!R5(t,"shpinst",tc.PARAM_NONE,0))return false;if(!R5(t,"shpleft",tc.PARAM_INT,c.x))return false;if(!R5(t,"shpright",tc.PARAM_INT,c.x+c.width))return false;if(!R5(t,"shptop",tc.PARAM_INT,c.ParaY))return false;if(!R5(t,"shpbottom",tc.PARAM_INT,c.ParaY+c.height))return false;if(!R5(t,"shpbxmarg",tc.PARAM_NONE,0))return false;if(Nj(c.flags&tc.PARA_FRAME_IGNORE_X)&&!R5(t,"shpbxignore",tc.PARAM_NONE,0))return false;if(Nj(c.flags&tc.PARA_FRAME_VMARG)){if(!R5(t,"shpbymargin",tc.PARAM_NONE,0))return false;if(!R5(t,"shpbxignore",tc.PARAM_NONE,0))return false;if(!l5(t,"posrelv",0))return false}if(Nj(c.flags&tc.PARA_FRAME_VPAGE)&&!R5(t,"shpbypage",tc.PARAM_NONE,0))return false;if(Dj(c.flags&(tc.PARA_FRAME_VPAGE|tc.PARA_FRAME_VMARG))&&!R5(t,"shpbypara",tc.PARAM_NONE,0))return false;if(Nj(c.flags&tc.PARA_FRAME_IGNORE_Y)&&!R5(t,"shpbyignore",tc.PARAM_NONE,0))return false;if(Nj(c.flags&tc.PARA_FRAME_LINE)){if(!R5(t,"shpwr",tc.PARAM_INT,tc.SWRAP_IGNORE))return false;if(!R5(t,"shpwrk",tc.PARAM_INT,tc.WRAPSIDE_BOTH))return false}else{if(Nj(c.flags2&tc.PF2_HTML))R5(t,"shpwr",tc.PARAM_INT,tc.SWRAP_NO_WRAP);else{if(Nj(c.flags&tc.PARA_FRAME_NO_WRAP)&&!R5(t,"shpwr",tc.PARAM_INT,tc.SWRAP_NO_WRAP))return false;if(Nj(c.flags&tc.PARA_FRAME_WRAP_IGNORE)&&!R5(t,"shpwr",tc.PARAM_INT,tc.SWRAP_IGNORE))return false;if(Dj(c.flags&(tc.PARA_FRAME_NO_WRAP|tc.PARA_FRAME_WRAP_IGNORE))){if(!R5(t,"shpwr",tc.PARAM_INT,Nj(c.flags2&tc.PF2_WRAP_TIGHT)?tc.SWRAP_TIGHT:tc.SWRAP_AROUND))return false;if(!R5(t,"shpwrk",tc.PARAM_INT,tc.WRAPSIDE_BOTH))return false}}}if(c.ZOrder>=0&&!R5(t,"shpz",tc.PARAM_INT,c.ZOrder))return false;if(c.NextId>0||c.PrevId>0)R5(t,"shplid",tc.PARAM_INT,c.ShapeId);if(Nj(c.flags2&tc.PF2_BEHIND_DOC)){if(!a5(t,"fBehindDocument","1"))return false}if(Nj(c.flags&tc.PARA_FRAME_LINE))s=tc.SHPTYPE_LINE;else if(Nj(c.flags&tc.PARA_FRAME_RECT))s=tc.SHPTYPE_RECT;else s=tc.SHPTYPE_TEXT_BOX;_=mY(s);if(!a5(t,"shapeType",_))return false;if(Nj(c.flags&tc.PARA_FRAME_IGNORE_X)){if(Dj(c.flags&(tc.PARA_FRAME_RIGHT_JUST|tc.PARA_FRAME_CENTER))){if(!l5(t,"posh",0))return false;l=true}if(Nj(c.flags&tc.PARA_FRAME_HPAGE)){if(!l5(t,"posrelh",1))return false}else if(Nj(c.flags2&tc.PF2_RIGHT_MARG)){if(!l5(t,"posrelh",5))return false}else if(Nj(c.flags&tc.PARA_FRAME_HCOL)){if(!l5(t,"posrelh",2))return false}else if(Nj(c.flags&tc.PARA_FRAME_HCHAR)){if(!l5(t,"posrelh",3))return false}else if(!l5(t,"posrelh",0))return false;a=true}if(Nj(c.flags&tc.PARA_FRAME_IGNORE_Y)){if(!l5(t,"posv",0))return false;if(Nj(c.flags2&tc.PF2_VBOT_MARG)){if(!l5(t,"posrelv",5))return false}else{if(Nj(c.flags&tc.PARA_FRAME_VPAGE)){if(!l5(t,"posrelv",1))return false}else if(Nj(c.flags&tc.PARA_FRAME_VMARG)){if(!l5(t,"posrelv",0))return false}else if(Nj(c.flags&tc.PARA_FRAME_VLINE)){if(!l5(t,"posrelv",3))return false}else if(!l5(t,"posrelv",2))return false}n=true}_=mY(BV(c.DistFromTextLeft));if(!a5(t,"dxWrapDistLeft",_))return false;_=mY(BV(c.DistFromTextRight));if(!a5(t,"dxWrapDistRight",_))return false;_=mY(BV(c.DistFromTextTop));if(!a5(t,"dyWrapDistTop",_))return false;_=mY(BV(c.DistFromTextBot));if(!a5(t,"dyWrapDistBot",_))return false;if(e==$l||Nj(c.flags&tc.PARA_FRAME_WATERMARK)){if(ta!=null){if(!a5(t,"pictureContrast","19661"))return false;if(!a5(t,"pictureBrightness","22938"))return false}if(!a5(t,"wzName",e==$l?"TerPictureWatermark":"WordPictureWatermark3"))return false;if(!l&&!a5(t,"posh","2"))return false;if(!a&&!a5(t,"posrelh","0"))return false;if(!n&&!a5(t,"posrelv","0"))return false}if(s==tc.SHPTYPE_LINE){if(Nj(c.flags&tc.PARA_FRAME_NO_LINE)){if(!a5(t,"fLine","0"))return false}if(Nj(c.flags2&tc.PF2_FLIPH)&&!a5(t,"fFlipH","1"))return false;if(Nj(c.flags2&tc.PF2_FLIPV)&&!a5(t,"fFlipV","1"))return false;if(Nj(c.flags2&tc.PF2_START_ARROW)&&!a5(t,"lineStartArrowhead","1"))return false;if(Nj(c.flags2&tc.PF2_END_ARROW)&&!a5(t,"lineEndArrowhead","1"))return false}else{_=mY(Nj(c.flags&tc.PARA_FRAME_BOXED)&&c.LineWdth>0?1:0);if(!a5(t,"fLine",_))return false}if(Nj(c.flags&tc.PARA_FRAME_IN_CELL)){if(!a5(t,"fLayoutInCell","1"))return false}if(s==tc.SHPTYPE_LINE||Nj(c.flags&tc.PARA_FRAME_BOXED)){_=mY(BV(c.LineWdth));if(!a5(t,"lineWidth",_))return false;_=mY(pJ(c.LineColor));if(!a5(t,"lineColor",_))return false;if(Nj(c.flags&tc.PARA_FRAME_DOTTED)){_="6";if(!a5(t,"lineDashing",_))return false}if(c.LineOpacity>0){_=mY((c.LineOpacity-1)*256);if(!a5(t,"lineOpacity",_))return false}}if(Nj(c.flags2&tc.PF2_NO_OVERLAP)&&Dj(c.flags&tc.PARA_FRAME_SHPGRP)){if(!l5(t,"fAllowOverlap",0))return false}if(s==tc.SHPTYPE_RECT||s==tc.SHPTYPE_TEXT_BOX){_=mY(kl[e].FillPattern==0?0:1);if(!a5(t,"fFilled",_))return false;if(kl[e].FillPattern>0){_=mY(pJ(c.BackColor));if(!a5(t,"fillColor",_))return false}if(c.FillOpacity>0){_=mY((c.FillOpacity-1)*256);if(!a5(t,"fillOpacity",_))return false}}if(s==tc.SHPTYPE_TEXT_BOX){if(kl[e].TextAngle!=0){_=mY(kl[e].TextAngle==90?tc.TEXTFLOW_B2T:tc.TEXTFLOW_T2B);if(!a5(t,"txflTextFlow",_))return false}_=mY(BV(c.margin));if(!a5(t,"dxTextLeft",_))return false;if(!a5(t,"dxTextRight",_))return false;if(!a5(t,"dyTextTop",_))return false;if(!a5(t,"dyTextBottom",_))return false;if(!I5(t))return false;if(!R5(t,"shptxt",tc.PARAM_NONE,0))return false;t.flags|=tc.ROFLAG_WRITE_FONT}else{N3(t,i)}}return true}function S3(t,e,r,i){var f;if(Nj(kl[e].flags&(tc.PARA_FRAME_LINE|tc.PARA_FRAME_RECT))){if(Nj(r&tc.PARA_KEEP_NEXT))R5(t,"keepn",tc.PARAM_NONE,0)}S5(t);if(!I5(t))return false;if(!R5(t,"do",tc.PARAM_NONE,0))return false;if(Dj(kl[e].flags&tc.PARA_FRAME_HPAGE)&&!R5(t,"dobxmargin",tc.PARAM_NONE,0))return false;if(Nj(kl[e].flags&tc.PARA_FRAME_HPAGE)&&!R5(t,"dobxpage",tc.PARAM_NONE,0))return false;if(Dj(kl[e].flags&(tc.PARA_FRAME_VPAGE|tc.PARA_FRAME_VMARG))&&!R5(t,"dobypara",tc.PARAM_NONE,0))return false;if(Nj(kl[e].flags&tc.PARA_FRAME_VMARG)&&!R5(t,"dobymargin",tc.PARAM_NONE,0))return false;if(Nj(kl[e].flags&tc.PARA_FRAME_VPAGE)&&!R5(t,"dobypage",tc.PARAM_NONE,0))return false;f=kl[e].ZOrder;if(f<0)f=0;if(!R5(t,"dodhgt",tc.PARAM_INT,f))return false;if(Nj(kl[e].flags&tc.PARA_FRAME_TEXT_BOX)){if(!R5(t,"dptxbx",tc.PARAM_NONE,0))return false;if(!R5(t,"dptxbxmar",tc.PARAM_INT,kl[e].margin))return false;if(kl[e].TextAngle==90&&!R5(t,"dptxbtlr",tc.PARAM_NONE,0))return false;if(kl[e].TextAngle==270&&!R5(t,"dptxtbrl",tc.PARAM_NONE,0))return false;if(!I5(t))return false;if(!R5(t,"dptxbxtext",tc.PARAM_NONE,0))return false}else if(Nj(kl[e].flags&tc.PARA_FRAME_LINE)){if(!R5(t,"dpline",tc.PARAM_NONE,0))return false;N3(t,i)}else if(Nj(kl[e].flags&tc.PARA_FRAME_RECT)){if(!R5(t,"dprect",tc.PARAM_NONE,0))return false;N3(t,i)}return true}function h3(t,e){if(e==0)return true;if(Nj(kl[e].flags&tc.PARA_FRAME_VPAGE)&&!R5(t,"pvpg",tc.PARAM_NONE,0))return false;else if(Nj(kl[e].flags&tc.PARA_FRAME_VMARG)&&!R5(t,"pvmrg",tc.PARAM_NONE,0))return false;else if(Dj(kl[e].flags&(tc.PARA_FRAME_VPAGE|tc.PARA_FRAME_VMARG))&&!R5(t,"pvpara",tc.PARAM_NONE,0))return false;if(Dj(kl[e].flags&tc.PARA_FRAME_HPAGE)&&!R5(t,"phmrg",tc.PARAM_NONE,0))return false;if(!R5(t,"posx",tc.PARAM_INT,kl[e].x))return false;if(Nj(kl[e].flags&tc.PARA_FRAME_VCENTER)&&!R5(t,"posyc",tc.PARAM_NONE,0))return false;else if(Nj(kl[e].flags2&tc.PF2_VBOTTOM)&&!R5(t,"posyb",tc.PARAM_NONE,0))return false;else if(!R5(t,"posy",tc.PARAM_INT,kl[e].ParaY))return false;var r=kl[e].MinHeight;if(Nj(kl[e].flags&tc.PARA_FRAME_FIXED_HEIGHT))r=-r;if(!R5(t,"absh",tc.PARAM_INT,r))return false;if(!R5(t,"absw",tc.PARAM_INT,kl[e].width))return false;if(!R5(t,"dxfrtext",tc.PARAM_INT,(kl[e].DistFromTextLeft+kl[e].DistFromTextRight)/2))return false;if(!R5(t,"dfrmtxtx",tc.PARAM_INT,(kl[e].DistFromTextLeft+kl[e].DistFromTextRight)/2))return false;if(!R5(t,"dfrmtxty",tc.PARAM_INT,(kl[e].DistFromTextTop+kl[e].DistFromTextBot)/2))return false;if(Nj(kl[e].flags&tc.PARA_FRAME_NO_WRAP)&&!R5(t,"nowrap",tc.PARAM_NONE,0))return false;if(Nj(kl[e].flags2&tc.PF2_OVERLAY)&&!R5(t,"overlay",tc.PARAM_NONE,0))return false;if(Nj(kl[e].flags2&tc.PF2_NO_OVERLAP)&&!R5(t,"absnoovrlp",tc.PARAM_INT,1))return false;if(kl[e].TextAngle==90&&!R5(t,"frmtxbtlr",tc.PARAM_NONE,0))return false;if(kl[e].TextAngle==270&&!R5(t,"frmtxtblr",tc.PARAM_NONE,0))return false;return true}function O3(t,e){var r;var i;var f;if(e<0||e>=Ri)return true;if(Nj(t.flags&tc.ROFLAG_IN_STYLESHEET))return true;f=ui[e].pfmt;i=Nc[f].BltId;if(i==0)return true;if(Nj(ui[e].tabw)&&ui[e].tabw.ListTextWidth>0&&ui[e].tabw.ListText!=null&&ui[e].tabw.ListText.length>0){if(!I5(t))return false;if(!R5(t,"pntext",tc.PARAM_NONE,0))return false;if(!R5(t,"pard",tc.PARAM_NONE,0))return false;if(!R5(t,"plain",tc.PARAM_NONE,0))return false;r=ui[e].tabw.ListFontId;if(r>=0&&r<Ys){if(!R5(t,"f",tc.PARAM_INT,xs[r].RtfIndex))return false;if(!R5(t,"fs",tc.PARAM_INT,xs[r].TwipsSize/10))return false;if(!R3(t,xs[r].style,0))return false}var l=false;if(ui[e].tabw.ListText.length==1){var a=Uk(ui[e].tabw.ListText);var n=a[0];var c=0;if(n==61607)c=167;else if(n==61656)c=216;else if(n==61558)c=gk("v");else if(n==61623)c=183;else if(n==61692)c=252;else if(n==61553)c=gk("q");if(c!=0){if(!C5(t,wY(c),1))return false;l=true}}if(!l&&!C5(t,ui[e].tabw.ListText,ui[e].tabw.ListText.length))return false;if(!R5(t,"tab",tc.PARAM_NONE,20))return false;if(!d5(t))return false}return true}function v3(t,e){var r;var i,f;var l;var a;var n;if(e<0||e>=Ri)return true;if(Nj(t.flags&tc.ROFLAG_IN_STYLESHEET))return true;l=ui[e].pfmt;i=Nc[l].BltId;if(i==0)return true;if(Nj(ui[e].tabw)&&ui[e].tabw.ListTextWidth>0&&ui[e].tabw.ListText!=null&&ui[e].tabw.ListText.length>0){S5(t);if(!I5(t))return false;if(!R5(t,"listtext",tc.PARAM_NONE,0))return false;if(!R5(t,"pard",tc.PARAM_NONE,0))return false;if(!R5(t,"plain",tc.PARAM_NONE,0))return false;r=ui[e].tabw.ListFontId;if(Nj(fO&tc.TFLAG10_DST)&&n_.length>0){if(ui[e].tabw.ListText.length==1){a=Uk(ui[e].tabw.ListText);n=a[0];if(n==9679||n==183){var c=n_;for(f=0;f<Ys;f++)if(xs[f].InUse&&Dj(xs[f].style&tc.PICT)&&Tk(xs[f].TypeFace,c)==0)break;if(f<Ys)r=f}}}if(r>=0&&r<Ys){if(!R5(t,"f",tc.PARAM_INT,xs[r].RtfIndex))return false;if(!R5(t,"fs",tc.PARAM_INT,xs[r].TwipsSize/10))return false;if(!R3(t,xs[r].style,0))return false}var s=false;if(ui[e].tabw.ListText.length==1){a=Uk(ui[e].tabw.ListText);n=a[0];var _=0;if(n==61607)_=167;else if(n==61656)_=216;else if(n==61558)_=gk("v");else if(n==61623)_=183;else if(n==61692)_=252;else if(n==61553)_=gk("q");if(_!=0){if(!C5(t,wY(_),1))return false;s=true}}if(!s&&!C5(t,ui[e].tabw.ListText,ui[e].tabw.ListText.length))return false;if(!R5(t,"tab",tc.PARAM_NONE,20))return false;if(!d5(t))return false;S5(t)}return true}function p3(t,e,r){var i,f;var l="";var a=false;var n=false;var c=false;var s=xc[e].IsBullet;var _;e=nQ(e);c=e>0&&xc[e].ls==0;if(!s&&xc[e].ls>0){var o=(new tc.ClsListLevel).init();o=sQ(xc[e].ls,xc[e].lvl);s=o.NumType==tc.LIST_BLT}if(Dj(eO&tc.TFLAG7_WRITE_LISTTEXT)||c){if(!I5(t))return false;if(!R5(t,"*",tc.PARAM_NONE,0))return false;if(!R5(t,"pn",tc.PARAM_NONE,0))return false;if(Nj(xc[e].flags&tc.BLTFLAG_HIDDEN)){if(!R5(t,"pnlvlcont",tc.PARAM_NONE,0))return false;a=true}if(s){if(!a&&!R5(t,"pnlvlblt",tc.PARAM_NONE,0))return false}else{if(xc[e].level==0||xc[e].level==10){if(!a&&!R5(t,"pnlvlbody",tc.PARAM_NONE,0))return false}else{if(!a&&!R5(t,"pnlvl",tc.PARAM_INT,xc[e].level))return false}if(!R5(t,"pnstart",tc.PARAM_INT,xc[e].start==0?1:xc[e].start))return false;if(xc[e].NumberType==tc.NBR_UPR_ALPHA&&!R5(t,"pnucltr",tc.PARAM_NONE,0))return false;else if(xc[e].NumberType==tc.NBR_LWR_ALPHA&&!R5(t,"pnlcltr",tc.PARAM_NONE,0))return false;else if(xc[e].NumberType==tc.NBR_UPR_ROMAN&&!R5(t,"pnucrm",tc.PARAM_NONE,0))return false;else if(xc[e].NumberType==tc.NBR_LWR_ROMAN&&!R5(t,"pnlcrm",tc.PARAM_NONE,0))return false;else if(xc[e].NumberType==tc.NBR_DEC&&!R5(t,"pndec",tc.PARAM_NONE,0))return false;if(zc>1){_=xc[e].ls;if(_>0){if(!R5(t,"ls",tc.PARAM_INT,t.XlateLs[_]))return false;if(!R5(t,"ilvl",tc.PARAM_INT,xc[e].lvl))return false;n=true}}}if(zc>1){_=xc[e].ls;if(_>0){if(!R5(t,"ls",tc.PARAM_INT,t.XlateLs[_]))return false;if(!R5(t,"ilvl",tc.PARAM_INT,xc[e].lvl))return false;n=true}}if(!R5(t,"pnhang",tc.PARAM_NONE,0))return false;if(s){f=0;if(xc[e].font==tc.BFONT_SYMBOL){if(n_.length>0)l=n_;else l="Symbol"}else if(xc[e].font==tc.BFONT_WINGDINGS){if(c_.length>0)l=c_;else l="Wingdings"}for(i=0;i<Ys;i++)if(xs[i].InUse&&Dj(xs[i].style&tc.PICT)&&xs[i].TypeFace==l)break;if(i<Ys)f=i;if(!R5(t,"pnf",tc.PARAM_INT,xs[f].RtfIndex))return false;if(!I5(t))return false;if(!R5(t,"pntxtb",tc.PARAM_NONE,0))return false;var u=xc[e].BulletChar==0?183:xc[e].BulletChar;if(!F5(t,u))return false;if(!d5(t))return false}else{if(xc[e].BefText.length>0){if(!I5(t))return false;if(!R5(t,"pntxtb",tc.PARAM_NONE,0))return false;t.WritingControl=true;C5(t,xc[e].BefText,xc[e].BefText.length);t.WritingControl=false;if(!d5(t))return false}var T=xc[e].AftChar;if(T==0)T=tc.PERIOD;if(!I5(t))return false;if(!R5(t,"pntxta",tc.PARAM_NONE,0))return false;if(!F5(t,T))return false;if(!d5(t))return false}if(!d5(t))return false}if(n||zc>1){_=xc[e].ls;if(_>0){if(!R5(t,"ls",tc.PARAM_INT,t.XlateLs[_]))return false;if(!R5(t,"ilvl",tc.PARAM_INT,xc[e].lvl))return false}}return true}function N3(t,e){var r;var i;if(e<=0)return true;if(Dj($h&tc.TFLAG5_WRITE_DOB)){if(Nj(kl[e].flags&tc.PARA_FRAME_TEXT_BOX)){if(!d5(t))return false}if(!d5(t))return false;if(!d5(t))return false;S5(t);return true}if(Nj(kl[e].flags&tc.PARA_FRAME_TEXT_BOX)){if(!d5(t))return false}if(Nj(kl[e].flags&tc.PARA_FRAME_LINE)){var f=0,l,a=0,n;f=kl[e].x;a=kl[e].ParaY;l=f+kl[e].width;n=a+kl[e].height;if(Nj(kl[e].flags2&tc.PF2_FLIPH)){f=WY(f,l);l=JC}if(Nj(kl[e].flags2&tc.PF2_FLIPV)){a=WY(a,n);n=JC}if(!R5(t,"dpptx",tc.PARAM_INT,f))return false;if(!R5(t,"dppty",tc.PARAM_INT,a))return false;if(!R5(t,"dpptx",tc.PARAM_INT,l))return false;if(!R5(t,"dppty",tc.PARAM_INT,n))return false}if(!R5(t,"dpx",tc.PARAM_INT,kl[e].x))return false;if(!R5(t,"dpy",tc.PARAM_INT,kl[e].ParaY))return false;if(!R5(t,"dpxsize",tc.PARAM_INT,kl[e].width))return false;i=kl[e].MinHeight;if(i==0)i=kl[e].height;if(!R5(t,"dpysize",tc.PARAM_INT,i))return false;if(Nj(kl[e].flags&tc.PARA_FRAME_BOXED)){if(Nj(kl[e].flags&tc.PARA_FRAME_DOTTED))r="dplinedot";else r="dplinesolid";if(!R5(t,r,tc.PARAM_NONE,0))return false}else if(!R5(t,"dplinehollow",tc.PARAM_NONE,0))return false;if(!R5(t,"dplinecor",tc.PARAM_INT,kl[e].LineColor.getRed()))return false;if(!R5(t,"dplinecog",tc.PARAM_INT,kl[e].LineColor.getGreen()))return false;if(!R5(t,"dplinecob",tc.PARAM_INT,kl[e].LineColor.getBlue()))return false;if(!R5(t,"dplinew",tc.PARAM_INT,kl[e].LineWdth))return false;if(!R5(t,"dpfillbgcr",tc.PARAM_INT,kl[e].BackColor.getRed()))return false;if(!R5(t,"dpfillbgcg",tc.PARAM_INT,kl[e].BackColor.getGreen()))return false;if(!R5(t,"dpfillbgcb",tc.PARAM_INT,kl[e].BackColor.getBlue()))return false;if(!R5(t,"dpfillpat",tc.PARAM_INT,kl[e].FillPattern))return false;if(!d5(t))return false;S5(t);return true}function D3(t,e,r,i,f){var l,a=false;var n,c,s;var _,o,u,T;var A,E,R,L;var C;var I;var d=false;var F;R=e;E=eR[R].row;if(e==0)d=true;t:{e:{if(d){S5(t);if(!I5(t))return false;if(!I5(t))return false;if(!R5(t,"*",tc.PARAM_NONE,0))return false;if(!R5(t,"nesttableprops",tc.PARAM_NONE,0))return false;break e}L=$E[E].PrevRow;if(Nj(iO&tc.TFLAG9_ALWAYS_WRITE_ROW_PROPS))break e;if(L<0||eR[r].level>NR||Nj(t.flags&tc.ROFLAG_WRITE_TROWD)||t.TblHilight||$E[L].flags!=$E[E].flags||Nj($E[E].flags&tc.ROWFLAG_HDR)||$E[L].CellMargin!=$E[E].CellMargin||$E[L].indent!=$E[E].indent||$E[L].AddedIndent!=$E[E].AddedIndent||$E[L].MinHeight!=$E[E].MinHeight||$E[L].FixWidth!=$E[E].FixWidth||$E[L].border!=$E[E].border||$E[L].flow!=$E[E].flow||$E[L].LeftPad!=$E[E].LeftPad||$E[L].RightPad!=$E[E].RightPad||$E[L].TopPad!=$E[E].TopPad||$E[L].BotPad!=$E[E].BotPad||$E[L].id!=$E[E].id)break e;c=$E[E].FirstCell;s=$E[L].FirstCell;C=tc.CFLAG_ROW_SPANNED|tc.CFLAG_VALIGN_CTR|tc.CFLAG_VALIGN_BOT|tc.CFLAG_AUTO_WIDTH_RTF;while(c>0){if(s<0)break e;if(eR[s].x!=eR[c].x||eR[s].width!=eR[c].width||eR[s].border!=eR[c].border||eR[s].shading!=eR[c].shading||!MJ(eR[s].BackColor,eR[c].BackColor)||eR[s].RowSpan!=eR[c].RowSpan||eR[s].ColSpan!=eR[c].ColSpan||eR[s].TextAngle!=eR[c].TextAngle||eR[s].LeftPad!=eR[c].LeftPad||eR[s].RightPad!=eR[c].RightPad||eR[s].TopPad!=eR[c].TopPad||eR[s].BotPad!=eR[c].BotPad||eR[s].margin!=eR[c].margin||(eR[s].flags&C)!=(eR[c].flags&C))break e;if(Nj(eR[c].border)){for(n=0;n<4;n++){if(eR[s].BorderWidth[n]!=eR[c].BorderWidth[n])break e;if(!MJ(eR[s].BorderColor[n],eR[c].BorderColor[n]))break e}}c=eR[c].NextCell;s=eR[s].NextCell}if(s>0)break e;break t}if(d)A=eR[r].row;else A=E;if(!d)S5(t);if(!R5(t,"trowd",tc.PARAM_NONE,0))return false;l=true;if(Nj($E[A].flags&tc.CENTER))l=R5(t,"trqc",tc.PARAM_NONE,0);else if(Nj($E[A].flags&tc.RIGHT_JUSTIFY))l=R5(t,"trqr",tc.PARAM_NONE,0);if(!l)return l;if(!R5(t,"trgaph",tc.PARAM_INT,$E[A].CellMargin))return false;if(Nj($E[A].flags&tc.ROWFLAG_LAST_ROW))R5(t,"lastrow",tc.PARAM_NONE,0);else if($E[A].NextRow>0){var g=$E[A].NextRow;if(Nj($E[g].flags&tc.ROWFLAG_NEW_TABLE))R5(t,"lastrow",tc.PARAM_NONE,0)}if($E[A].FixWidth>0){if(!R5(t,"trftsWidth",tc.PARAM_INT,3))return false;if(!R5(t,"trwWidth",tc.PARAM_INT,$E[A].FixWidth))return false}if(Dj(fO&tc.TFLAG10_WRITE_FIX_WIDTH_TABLE)){if(Nj($E[A].flags&(tc.ROWFLAG_AUTO_WIDTH_RTF|tc.ROWFLAG_AUTO_FIT))){if($E[A].FixWidth==0&&!R5(t,"trftsWidth",tc.PARAM_INT,1))return false;if(!R5(t,"trautofit",tc.PARAM_INT,1))return false}}if((_=c8($E[A].FirstCell))>0){S5(t);if($E[A].BorderWidth[tc.BORDER_INDEX_TOP]>0){if(!R5(t,"trbrdrt",tc.PARAM_NONE,0))return false;if(!R5(t,"brdroutset",tc.PARAM_NONE,0))return false;if(!R5(t,"brdrw",tc.PARAM_INT,$E[A].BorderWidth[tc.BORDER_INDEX_TOP]))return false;for(n=0;n<t.TotalColors;n++)if(MJ(t.color[n].color,$E[A].BorderColor[tc.BORDER_INDEX_TOP]))break;if(n==t.TotalColors)n=0;if(!R5(t,"brdrcf",tc.PARAM_INT,n))return false}if($E[A].BorderWidth[tc.BORDER_INDEX_BOT]>0){if(!R5(t,"trbrdrb",tc.PARAM_NONE,0))return false;if(!R5(t,"brdroutset",tc.PARAM_NONE,0))return false;if(!R5(t,"brdrw",tc.PARAM_INT,$E[A].BorderWidth[tc.BORDER_INDEX_BOT]))return false;for(n=0;n<t.TotalColors;n++)if(MJ(t.color[n].color,$E[A].BorderColor[tc.BORDER_INDEX_BOT]))break;if(n==t.TotalColors)n=0;if(!R5(t,"brdrcf",tc.PARAM_INT,n))return false}if($E[A].BorderWidth[tc.BORDER_INDEX_LEFT]>0){if(!R5(t,"trbrdrl",tc.PARAM_NONE,0))return false;if(!R5(t,"brdroutset",tc.PARAM_NONE,0))return false;if(!R5(t,"brdrw",tc.PARAM_INT,$E[A].BorderWidth[tc.BORDER_INDEX_LEFT]))return false;for(n=0;n<t.TotalColors;n++)if(MJ(t.color[n].color,$E[A].BorderColor[tc.BORDER_INDEX_LEFT]))break;if(n==t.TotalColors)n=0;if(!R5(t,"brdrcf",tc.PARAM_INT,n))return false}if($E[A].BorderWidth[tc.BORDER_INDEX_RIGHT]>0){if(!R5(t,"trbrdrr",tc.PARAM_NONE,0))return false;if(!R5(t,"brdroutset",tc.PARAM_NONE,0))return false;if(!R5(t,"brdrw",tc.PARAM_INT,$E[A].BorderWidth[tc.BORDER_INDEX_RIGHT]))return false;for(n=0;n<t.TotalColors;n++)if(MJ(t.color[n].color,$E[A].BorderColor[tc.BORDER_INDEX_RIGHT]))break;if(n==t.TotalColors)n=0;if(!R5(t,"brdrcf",tc.PARAM_INT,n))return false}S5(t);if(!R5(t,"trspdt",tc.PARAM_INT,_/2))return false;if(!R5(t,"trspdb",tc.PARAM_INT,_/2))return false;if(!R5(t,"trspdl",tc.PARAM_INT,_/2))return false;if(!R5(t,"trspdr",tc.PARAM_INT,_/2))return false;if(!R5(t,"trspdft",tc.PARAM_INT,3))return false;if(!R5(t,"trspdfb",tc.PARAM_INT,3))return false;if(!R5(t,"trspdfl",tc.PARAM_INT,3))return false;if(!R5(t,"trspdfr",tc.PARAM_INT,3))return false;S5(t)}F=$E[A].LeftPad>=0||$E[A].RightPad>=0||$E[A].TopPad>=0||$E[A].BotPad>=0;if(F){if(!R5(t,"trpaddl",tc.PARAM_INT,$E[A].LeftPad>=0?$E[A].LeftPad:0))return false;if(!R5(t,"trpaddfl",tc.PARAM_INT,3))return false;if(!R5(t,"trpaddr",tc.PARAM_INT,$E[A].RightPad>=0?$E[A].RightPad:0))return false;if(!R5(t,"trpaddfr",tc.PARAM_INT,3))return false;if(!R5(t,"trpaddt",tc.PARAM_INT,$E[A].TopPad>=0?$E[A].TopPad:0))return false;if(!R5(t,"trpaddft",tc.PARAM_INT,3))return false;if(!R5(t,"trpaddb",tc.PARAM_INT,$E[A].BotPad>=0?$E[A].BotPad:0))return false;if(!R5(t,"trpaddfb",tc.PARAM_INT,3))return false}else{if(!R5(t,"trpaddl",tc.PARAM_INT,$E[A].CellMargin))return false;if(!R5(t,"trpaddfl",tc.PARAM_INT,3))return false;if(!R5(t,"trpaddr",tc.PARAM_INT,$E[A].CellMargin))return false;if(!R5(t,"trpaddfr",tc.PARAM_INT,3))return false}if(!R5(t,"trleft",tc.PARAM_INT,$E[A].indent-$E[A].AddedIndent))return false;if($E[A].TblIndType==3){var P=$E[A].indent;if($E[A].LeftPad>=0)P+=$E[A].LeftPad;else P+=$E[A].CellMargin;if(!R5(t,"tblindtype",tc.PARAM_INT,$E[A].TblIndType))return false;if(!R5(t,"tblind",tc.PARAM_INT,P))return false}if($E[A].MinHeight!=0&&!R5(t,"trrh",tc.PARAM_INT,$E[A].MinHeight))return false;if(Nj($E[A].flags&tc.ROWFLAG_HDR)&&!R5(t,"trhdr",tc.PARAM_NONE,0))return false;if(Nj($E[A].flags&tc.ROWFLAG_KEEP)&&!R5(t,"trkeep",tc.PARAM_NONE,0))return false;if($E[A].id!=0&&!R5(t,"sstrid",tc.PARAM_INT,$E[A].id))return false;if(Nj($E[A].border&tc.BORDER_TOP)){if(!R5(t,"trbrdrt",tc.PARAM_NONE,0))return false;if(!R5(t,"brdrs",tc.PARAM_NONE,0))return false;if(!R5(t,"brdrw",tc.PARAM_INT,$E[A].BorderWidth[tc.BORDER_INDEX_TOP]))return false}if(Nj($E[A].border&tc.BORDER_BOT)){if(!R5(t,"trbrdrb",tc.PARAM_NONE,0))return false;if(!R5(t,"brdrs",tc.PARAM_NONE,0))return false;if(!R5(t,"brdrw",tc.PARAM_INT,$E[A].BorderWidth[tc.BORDER_INDEX_BOT]))return false}if(Nj($E[A].border&tc.BORDER_LEFT)){if(!R5(t,"trbrdrl",tc.PARAM_NONE,0))return false;if(!R5(t,"brdrs",tc.PARAM_NONE,0))return false;if(!R5(t,"brdrw",tc.PARAM_INT,$E[A].BorderWidth[tc.BORDER_INDEX_LEFT]))return false}if(Nj($E[A].border&tc.BORDER_RIGHT)){if(!R5(t,"trbrdrr",tc.PARAM_NONE,0))return false;if(!R5(t,"brdrs",tc.PARAM_NONE,0))return false;if(!R5(t,"brdrw",tc.PARAM_INT,$E[A].BorderWidth[tc.BORDER_INDEX_RIGHT]))return false}if($E[A].flow==tc.FLOW_RTL&&!R5(t,"rtlrow",tc.PARAM_NONE,0))return false;if($E[A].flow==tc.FLOW_LTR&&!R5(t,"ltrrow",tc.PARAM_NONE,0))return false;T=0;if(t.output>=tc.RTF_CB&&uA!=tc.HILIGHT_OFF){for(I=_A;I>sA;I--){if(Dj(ui[I].flags&tc.LFLAG_SELECTED))continue;if(eR[ui[I].cid].row==A)break}T=ui[I].cid}c=$E[A].FirstCell;o=$E[A].indent;while(c>0){if(!a){if(t.TblHilight)a=Nj(eR[c].flags&tc.CFLAG_RTF_SEL);else a=true}if(a){if(t.TblHilight&&Dj(eR[c].flags&tc.CFLAG_RTF_SEL))break;u=eR[c].x;eR[c].x=o;o+=eR[c].width;G3(t,c);eR[c].x=u}if(c==T)break;c=eR[c].NextCell}if(d){if(f>=0&&ui[f].len>0){var S=ib(f,ui[f].len-1);if(Nj(xs[S].style&tc.HIDDEN))R5(t,"v",tc.PARAM_NONE,0)}if(!R5(t,"nestrow",tc.PARAM_NONE,0))return false;if(!d5(t))return false;M3(t);if(!d5(t))return false;S5(t)}t.flags=t.flags=cj(t.flags,tc.ROFLAG_WRITE_TROWD)}if(i==NR)DR=true;return true}function M3(t){if(!I5(t))return false;if(!R5(t,"nonesttables",tc.PARAM_NONE,0))return false;if(!R5(t,"par",tc.PARAM_NONE,0))return false;if(!d5(t))return false;return true}function G3(t,e){var r=eR[e].row,i,f,l;var a=eR[e].flags;S5(t);if(Dj(a&(tc.CFLAG_VALIGN_CTR|tc.CFLAG_VALIGN_BOT|tc.CFLAG_VALIGN_BASE))&&!R5(t,"clvertalt",tc.PARAM_NONE,0))return false;if(Nj(a&tc.CFLAG_VALIGN_CTR)&&!R5(t,"clvertalc",tc.PARAM_NONE,0))return false;if(Nj(a&tc.CFLAG_VALIGN_BOT)&&!R5(t,"clvertalb",tc.PARAM_NONE,0))return false;if(Nj(a&tc.CFLAG_VALIGN_BASE)&&!R5(t,"ssclvertalbs",tc.PARAM_NONE,0))return false;if(Nj(a&tc.CFLAG_AUTO_WIDTH_RTF)){if(!R5(t,"clftsWidth",tc.PARAM_INT,1))return false}if(eR[e].RowSpan>1&&Dj(eR[e].flags&tc.CFLAG_ROW_SPANNED)&&!R5(t,"clvmgf",tc.PARAM_NONE,0))return false;if(Nj(eR[e].flags&tc.CFLAG_ROW_SPANNED)){var n=rR[e].SpanningCell;if(n>0&&eR[n].RowSpan>1&&!R5(t,"clvmrg",tc.PARAM_NONE,0))return false}if(Nj(rO&tc.TFLAG8_WRITE_MERGE_TAG)&&eR[e].ColSpan>1){if(eR[e].level==NR&&!R5(t,"clmgf",tc.PARAM_NONE,0))return false;if(eR[e].level!=NR&&!R5(t,"sscolspan",tc.PARAM_INT,eR[e].ColSpan))return false}if(!B3(t,e))return false;if(eR[e].shading>0&&!R5(t,"clshdng",tc.PARAM_INT,eR[e].shading*100))return false;if(!MJ(eR[e].BackColor,tc.CLR_WHITE)||eR[e].ParentCell>0||Nj(eR[e].flags&tc.CFLAG_FORCE_BKND_CLR)){var c=eR[e].BackColor;for(f=1;f<t.TotalColors;f++)if(MJ(t.color[f].color,c))break;if(f==t.TotalColors&&MJ(c,tc.CLR_BLACK)){c=tc.CLR_AUTO;for(f=0;f<t.TotalColors;f++)if(MJ(t.color[f].color,c))break}if(f==t.TotalColors)f=0;if(!R5(t,"clcbpat",tc.PARAM_INT,f))return false}if(Nj(fO&tc.TFLAG10_DST)){if(eR[e].LeftPad>0){if(!R5(t,"clpadt",tc.PARAM_INT,eR[e].LeftPad))return false;if(!R5(t,"clpadft",tc.PARAM_INT,3))return false}if(eR[e].RightPad>0){if(!R5(t,"clpadr",tc.PARAM_INT,eR[e].RightPad))return false;if(!R5(t,"clpadfr",tc.PARAM_INT,3))return false}if(eR[e].TopPad>0){if(!R5(t,"clpadl",tc.PARAM_INT,eR[e].TopPad))return false;if(!R5(t,"clpadfl",tc.PARAM_INT,3))return false}if(eR[e].BotPad>0){if(!R5(t,"clpadb",tc.PARAM_INT,eR[e].BotPad))return false;if(!R5(t,"clpadfb",tc.PARAM_INT,3))return false}}else{if(eR[e].LeftPad>=0){if(!R5(t,"clpadt",tc.PARAM_INT,eR[e].LeftPad))return false;if(!R5(t,"clpadft",tc.PARAM_INT,3))return false}if(eR[e].RightPad>=0){if(!R5(t,"clpadr",tc.PARAM_INT,eR[e].RightPad))return false;if(!R5(t,"clpadfr",tc.PARAM_INT,3))return false}if(eR[e].TopPad>=0){if(!R5(t,"clpadl",tc.PARAM_INT,eR[e].TopPad))return false;if(!R5(t,"clpadfl",tc.PARAM_INT,3))return false}if(eR[e].BotPad>=0){if(!R5(t,"clpadb",tc.PARAM_INT,eR[e].BotPad))return false;if(!R5(t,"clpadfb",tc.PARAM_INT,3))return false}}if(eR[e].TextAngle==90&&!R5(t,"cltxbtlr",tc.PARAM_NONE,0))return false;if(eR[e].TextAngle==270&&!R5(t,"cltxtbrl",tc.PARAM_NONE,0))return false;l=eR[e].x+eR[e].width;i=eR[e].ColSpan;if(Nj(rO&tc.TFLAG8_WRITE_MERGE_TAG)&&i>1&&eR[e].level==NR)l-=2*$E[r].CellMargin*(i-1);if(!R5(t,"cellx",tc.PARAM_INT,l))return false;S5(t);if(Nj(rO&tc.TFLAG8_WRITE_MERGE_TAG)&&eR[e].level==NR){while(i>1){R5(t,"clmrg",tc.PARAM_NONE,0);if(!B3(t,e))return false;l+=2*$E[r].CellMargin;if(!R5(t,"cellx",tc.PARAM_INT,l))return false;i--}}S5(t);return true}function B3(t,e){var r=tc.CLR_AUTO,i;var f=-1,l,a,n,c;for(a=0;a<4;a++){c=eR[e].BorderWidth[a];if(a==tc.BORDER_INDEX_TOP&&Dj(eR[e].border&tc.BORDER_TOP))c=0;if(a==tc.BORDER_INDEX_BOT&&Dj(eR[e].border&tc.BORDER_BOT))c=0;if(a==tc.BORDER_INDEX_LEFT&&Dj(eR[e].border&tc.BORDER_LEFT))c=0;if(a==tc.BORDER_INDEX_RIGHT&&Dj(eR[e].border&tc.BORDER_RIGHT))c=0;if(c==0&&MJ(eR[e].BorderColor[a],tc.CLR_AUTO))continue;if(a==tc.BORDER_INDEX_TOP&&!R5(t,"clbrdrt",tc.PARAM_NONE,0))return false;if(a==tc.BORDER_INDEX_BOT&&!R5(t,"clbrdrb",tc.PARAM_NONE,0))return false;if(a==tc.BORDER_INDEX_LEFT&&!R5(t,"clbrdrl",tc.PARAM_NONE,0))return false;if(a==tc.BORDER_INDEX_RIGHT&&!R5(t,"clbrdrr",tc.PARAM_NONE,0))return false;if(c>0){if(!R5(t,"brdrs",tc.PARAM_NONE,0))return false;if(!R5(t,"brdrw",tc.PARAM_INT,c))return false}if(!MJ(i=eR[e].BorderColor[a],tc.CLR_AUTO)){if(MJ(i,r))l=f;else{for(n=0;n<t.TotalColors;n++)if(MJ(t.color[n].color,i))break;if(n==t.TotalColors)n=0;r=i;f=l=n}if(!R5(t,"brdrcf",tc.PARAM_INT,l))return false}}return true}function H3(t){var e,r,i;var f,l;var a;var n="Times New Roman";var c="roman";var s=0;var _="";var o="";var u;if(L_.length>0){n=L_;c=C_;s=I_}else{n=xs[0].TypeFace;a=xs[0].FontFamily;if(a==tc.FF_ROMAN)c="roman";else if(a==tc.FF_SWISS)c="swiss";else if(a==tc.FF_MODERN)c="modern";else if(a==tc.FF_SCRIPT)c="script";else if(a==tc.FF_DECORATIVE)c="decor";else c="nil";s=xs[0].CharSet}if(!R5(t,"deff",tc.PARAM_INT,0))return false;S5(t);for(e=0;e<Dc;e++)if(Nj(Nc[e].flags&tc.BULLET))break;if(e<Dc){if(jY(n_)>0){for(e=0;e<Ys;e++)if(xs[e].InUse&&Tk(xs[e].TypeFace,n_)==0)break;if(e==Ys)Rb(Ti,0,n_,12*20,0,tc.CLR_BLACK,tc.CLR_WHITE,tc.CLR_AUTO,0,0,0,1,0,0,0,0,null,0,tc.SYMBOL_CHARSET,0,0)}else{for(e=0;e<Ys;e++)if(xs[e].InUse&&xs[e].TypeFace=="Symbol")break;if(e==Ys)Rb(Ti,0,"Symbol",12*20,0,tc.CLR_BLACK,tc.CLR_WHITE,tc.CLR_AUTO,0,0,0,1,0,0,0,0,null,0,ks,0,0)}if(jY(c_)>0){for(e=0;e<Ys;e++)if(xs[e].InUse&&Tk(xs[e].TypeFace,c_)==0)break;if(e==Ys)Rb(Ti,0,c_,12*20,0,tc.CLR_BLACK,tc.CLR_WHITE,tc.CLR_AUTO,0,0,0,1,0,0,0,0,null,0,tc.SYMBOL_CHARSET,0,0)}else{for(e=0;e<Ys;e++)if(xs[e].InUse&&xs[e].TypeFace=="Wingdings")break;if(e==Ys)Rb(Ti,0,"Wingdings",12*20,0,tc.CLR_BLACK,tc.CLR_WHITE,tc.CLR_AUTO,0,0,0,1,0,0,0,0,null,0,ks,0,0)}}if(!I5(t))return false;if(!R5(t,"fonttbl",tc.PARAM_NONE,0))return false;i=0;m3(t,i,n,c,s);i++;for(e=0;e<Ys;e++){if(!xs[e].InUse||Nj(xs[e].style&tc.PICT)){xs[e].RtfIndex=0;continue}for(r=0;r<e;r++){if(xs[r].TypeFace==xs[e].TypeFace&&xs[r].FontFamily==xs[e].FontFamily&&xs[r].CharSet==xs[e].CharSet)break}if(r<e){xs[e].RtfIndex=xs[r].RtfIndex;continue}if(xs[e].TypeFace==n&&xs[e].CharSet==s){xs[e].RtfIndex=0;continue}if(TO!=null&&TO.length>0){_=","+TO+",";_=_.toLowerCase();if(xs[e].TypeFace!=n_&&xs[e].TypeFace!=c_){o=","+xs[e].TypeFace.toLowerCase()+",";if(_.indexOf(o)<0){xs[e].RtfIndex=0;continue}}}f=xs[e].TypeFace;a=xs[e].FontFamily;if(a==tc.FF_ROMAN)l="roman";else if(a==tc.FF_SWISS)l="swiss";else if(a==tc.FF_MODERN)l="modern";else if(a==tc.FF_SCRIPT)l="script";else if(a==tc.FF_DECORATIVE)l="decor";else l="nil";m3(t,i,f,l,xs[e].CharSet);xs[e].RtfIndex=i;i++;t.WritingControl=false}for(e=0;e<X_;e++){W_[e].RtfIndex=0;if(!W_[e].InUse||W_[e].TypeFace.length==0)continue;for(r=0;r<Ys;r++){if(xs[r].InUse&&xs[r].TypeFace==W_[e].TypeFace&&(xs[r].FontFamily==W_[e].FontFamily||W_[e].FontFamily==0))break}if(r<Ys){W_[e].RtfIndex=xs[r].RtfIndex;continue}for(r=0;r<e;r++){if(W_[r].InUse&&W_[r].TypeFace==W_[e].TypeFace&&W_[r].FontFamily==W_[e].FontFamily)break}if(r<e){W_[e].RtfIndex=W_[r].RtfIndex;continue}if(TO!=null&&TO.length>0){_=","+TO+",";_=_.toLowerCase();if(W_[e].TypeFace!=n_&&W_[e].TypeFace!=c_){o=","+W_[e].TypeFace.toLowerCase()+",";if(_.indexOf(o)<0){W_[e].RtfIndex=0;continue}}}f=W_[e].TypeFace;a=W_[e].FontFamily;if(a==tc.FF_ROMAN)l="roman";else if(a==tc.FF_SWISS)l="swiss";else if(a==tc.FF_MODERN)l="modern";else if(a==tc.FF_SCRIPT)l="script";else if(a==tc.FF_DECORATIVE)l="decor";else l="nil";m3(t,i,f,l,ks);W_[e].RtfIndex=i;i++;t.WritingControl=false}if(!d5(t))return false;S5(t);return true}function m3(t,e,r,i,f){if(!I5(t))return false;if(!R5(t,"f",tc.PARAM_INT,e))return false;t.WritingControl=true;if(i.length>0){if(!P5(t,tc.BACK_SLASH))return false;if(!P5(t,gk("f")))return false;if(!C5(t,i,i.length))return false;if(!C5(t," ",1))return false}if((ri||f!=tc.DEFAULT_CHARSET)&&!R5(t,"fcharset",tc.PARAM_INT,f))return false;if(!C5(t,r,r.length))return false;if(!C5(t,";",1))return false;if(!d5(t))return false;return true}function w3(t){var e,r,i,f;var l,a,n;var c;S5(t);c=t.color;c[0].color=tc.CLR_AUTO;f=1;if(!MJ($T,tc.CLR_WHITE)&&!MJ(c[0].color,$T)){c[f].color=$T;f++}for(e=0;e<Ys;e++){for(r=0;r<f;r++){if(MJ(xs[e].TextColor,c[r].color))break}if(f+10>=aA){aA=f+f/3+10;b3(f)}if(r==f&&f<aA){c[f].color=xs[e].TextColor;f++}for(r=0;r<f;r++){if(MJ(xs[e].TextBkColor,c[r].color))break}if(r==f&&f<aA){c[f].color=xs[e].TextBkColor;f++}for(r=0;r<f;r++){if(MJ(xs[e].HilightColor,c[r].color))break}if(r==f&&f<aA){c[f].color=xs[e].HilightColor;f++}for(r=0;r<f;r++){if(MJ(xs[e].UlineColor,c[r].color))break}if(r==f&&f<aA){c[f].color=xs[e].UlineColor;f++}}for(e=0;e<X_;e++){for(r=0;r<f;r++){if(MJ(W_[e].TextColor,c[r].color))break}if(f+10>=aA){aA=f+f/3+10;b3(f)}if(r==f&&f<aA){c[f].color=W_[e].TextColor;f++}for(r=0;r<f;r++){if(MJ(W_[e].TextBkColor,c[r].color))break}if(r==f&&f<aA){c[f].color=W_[e].TextBkColor;f++}for(r=0;r<f;r++){if(MJ(W_[e].UlineColor,c[r].color))break}if(r==f&&f<aA){c[f].color=W_[e].UlineColor;f++}for(r=0;r<f;r++){if(MJ(W_[e].ParaBkColor,c[r].color))break}if(r==f&&f<aA){c[f].color=W_[e].ParaBkColor;f++}if(!MJ(W_[e].ParaBorderColor,tc.CLR_AUTO)){for(r=0;r<f;r++){if(MJ(W_[e].ParaBorderColor,c[r].color))break}if(r==f&&f<aA){c[f].color=W_[e].ParaBorderColor;f++}}}for(e=0;e<ro;e++){if(Dj(to[e].border))continue;for(r=0;r<f;r++){if(MJ(to[e].BorderColor,c[r].color))break}if(f+10>=aA){aA=f+f/3+10;b3(f)}if(r==f&&f<aA){c[f].color=to[e].BorderColor;f++}}for(e=1;e<fR;e++){if(!eR[e].InUse)continue;for(r=0;r<f;r++){if(MJ(eR[e].BackColor,c[r].color))break}if(f+10>=aA){aA=f+f/3+10;b3(f)}if(r==f&&f<aA){c[f].color=eR[e].BackColor;f++}for(i=0;i<4;i++){if(eR[e].BorderWidth[i]<=0)continue;if(MJ(eR[e].BorderColor[i],tc.CLR_AUTO))continue;for(r=0;r<f;r++){if(MJ(eR[e].BorderColor[i],c[r].color))break}if(r==f&&f<aA){c[f].color=eR[e].BorderColor[i];f++}}}for(e=1;e<iR;e++){if($E[e].BorderWidth==null||$E[e].BorderColor==null)continue;for(i=0;i<4;i++){if($E[e].BorderWidth[i]<=0)continue;if(MJ($E[e].BorderColor[i],tc.CLR_AUTO))continue;for(r=0;r<f;r++){if(MJ($E[e].BorderColor[i],c[r].color))break}if(f+10>=aA){aA=f+f/3+10;b3(f)}if(r==f&&f<aA){c[f].color=$E[e].BorderColor[i];f++}}}for(e=0;e<Dc;e++){for(r=0;r<f;r++){if(MJ(Nc[e].BkColor,c[r].color))break}if(f+10>=aA){aA=f+f/3+10;b3(f)}if(r==f&&f<aA){c[f].color=Nc[e].BkColor;f++}if(!MJ(Nc[e].BorderColor,tc.CLR_AUTO)){for(r=0;r<f;r++){if(MJ(Nc[e].BorderColor,c[r].color))break}if(r==f&&f<aA){c[f].color=Nc[e].BorderColor;f++}}}t.TotalColors=f;t.color=c;if(!I5(t))return false;if(!R5(t,"colortbl",tc.PARAM_NONE,0))return false;for(e=0;e<f;e++){if(e>0||t.output>=tc.RTF_CB&&Dj(tO&tc.TFLAG6_WRITE_DEFAULT_COLOR)||Nj(Zh&tc.TFLAG2_WRITE_FIRST_RTF_COLOR)){if(c[e].color==null)c[e].color=tc.CLR_BLACK;l=c[e].color.getRed();a=c[e].color.getGreen();n=c[e].color.getBlue();if(MJ(c[e].color,tc.CLR_AUTO))l=a=n=0;if(!R5(t,"red",tc.PARAM_INT,l))return false;if(!R5(t,"green",tc.PARAM_INT,a))return false;if(!R5(t,"blue",tc.PARAM_INT,n))return false}if(!C5(t,";",1))return false}if(!d5(t))return false;S5(t);return true}function b3(t){var e;for(e=t;e<aA;e++){color[e]=new tc.ClsRtfColor;color[e].color=tc.Color.black}}function x3(t){var e;var r;if(t.output>=tc.RTF_CB&&Z_)return true;S5(t);if(!I5(t))return false;if(!R5(t,"*",tc.PARAM_NONE,0))return false;if(!R5(t,"revtbl",tc.PARAM_NONE,0))return false;for(e=0;e<Al;e++){if(!I5(t))return false;r=ul[e].name==null||ul[e].name.length==0?"Unknown":ul[e].name;if(!C5(t,r,r.length))return false;if(!C5(t,";",1))return false;if(!d5(t))return false}if(!d5(t))return false;S5(t);return true}function y3(t){var e;S5(t);if(!I5(t))return false;if(!R5(t,"stylesheet",tc.PARAM_NONE,0))return false;t.flags|=tc.ROFLAG_IN_STYLESHEET;for(e=0;e<X_;e++){if(!W_[e].InUse)continue;if(!I5(t))return false;if(W_[e].type==tc.SSTYPE_CHAR){if(!R5(t,"cs",tc.PARAM_INT,e))return false;if(!W3(t,e))return false}else{if(e>0&&!R5(t,"s",tc.PARAM_INT,e))return false;if(e>0&&!R5(t,"snext",tc.PARAM_INT,W_[e].next))return false;if(e>0&&W_[e].OutlineLevel>=0&&!R5(t,"outlinelevel",tc.PARAM_INT,W_[e].OutlineLevel))return false;if(!W3(t,e))return false;if(!k3(t,e))return false}if(Nj(W_[e].flags&tc.SSFLAG_NO_SPACE)&&!R5(t,"contextualspace",tc.PARAM_NONE,0))return false;if(!C5(t,W_[e].name,W_[e].name.length))return false;if(!C5(t,";",1))return false;if(!d5(t))return false}t.flags=cj(t.flags,tc.ROFLAG_IN_STYLESHEET);if(!d5(t))return false;S5(t);return true}function W3(t,e){var r;var i=W_[e].style;if(Nj(W_[e].CharMask&tc.CMASK_FONT)){if(!R5(t,"f",tc.PARAM_INT,W_[e].RtfIndex))return false}if(Nj(W_[e].CharMask&tc.CMASK_SIZE)&&!R5(t,"fs",tc.PARAM_INT,W_[e].TwipsSize/10))return false;if(Nj(W_[e].StyleMask&tc.BOLD)&&!R5(t,"b",Nj(i&tc.BOLD)?tc.PARAM_NONE:tc.PARAM_INT,0))return false;if(Nj(W_[e].StyleMask&tc.ULINE)&&!R5(t,"ul",Nj(i&tc.ULINE)?tc.PARAM_NONE:tc.PARAM_INT,0))return false;if(Nj(W_[e].StyleMask&tc.ULINED)&&!R5(t,"uldb",Nj(i&tc.ULINED)?tc.PARAM_NONE:tc.PARAM_INT,0))return false;if(Nj(W_[e].StyleMask&tc.ULINE_DOTTED)&&!R5(t,"uld",Nj(i&tc.ULINE_DOTTED)?tc.PARAM_NONE:tc.PARAM_INT,0))return false;if(Nj(W_[e].StyleMask&tc.EMBOSS)&&!R5(t,"embo",Nj(i&tc.EMBOSS)?tc.PARAM_NONE:tc.PARAM_INT,0))return false;if(Nj(W_[e].StyleMask&tc.ITALIC)&&!R5(t,"i",Nj(i&tc.ITALIC)?tc.PARAM_NONE:tc.PARAM_INT,0))return false;if(Nj(W_[e].StyleMask&tc.HIDDEN)&&!R5(t,"v",Nj(i&tc.HIDDEN)?tc.PARAM_NONE:tc.PARAM_INT,0))return false;if(Nj(W_[e].StyleMask&tc.STRIKE)&&!R5(t,"strike",Nj(i&tc.STRIKE)?tc.PARAM_NONE:tc.PARAM_INT,0))return false;if(Nj(W_[e].StyleMask&tc.DOUBLE_STRIKE)&&!R5(t,"striked",Nj(i&tc.DOUBLE_STRIKE)?tc.PARAM_NONE:tc.PARAM_INT,0))return false;if(Nj(W_[e].StyleMask&tc.PROTECT)&&!R5(t,"protect",Nj(i&tc.PROTECT)?tc.PARAM_NONE:tc.PARAM_INT,0))return false;if(Nj(W_[e].StyleMask&tc.SUPSCR)&&!R5(t,"super",Nj(i&tc.SUPSCR)?tc.PARAM_NONE:tc.PARAM_INT,0))return false;if(Nj(W_[e].StyleMask&tc.SUBSCR)&&!R5(t,"sub",Nj(i&tc.SUBSCR)?tc.PARAM_NONE:tc.PARAM_INT,0))return false;if(Nj(W_[e].StyleMask&tc.HLINK)&&!R5(t,"sshlink",Nj(i&tc.HLINK)?tc.PARAM_NONE:tc.PARAM_INT,0))return false;if(Nj(W_[e].StyleMask&tc.CAPS)&&!R5(t,"caps",Nj(i&tc.CAPS)?tc.PARAM_NONE:tc.PARAM_INT,0))return false;if(Nj(W_[e].StyleMask&tc.SCAPS)&&!R5(t,"scaps",Nj(i&tc.SCAPS)?tc.PARAM_NONE:tc.PARAM_INT,0))return false;if(Nj(W_[e].CharMask&tc.CMASK_TEXT_COLOR)){for(r=0;r<t.TotalColors;r++)if(MJ(t.color[r].color,W_[e].TextColor))break;if(r==t.TotalColors)r=0;if(!R5(t,"cf",tc.PARAM_INT,r))return false}if(Nj(W_[e].CharMask&tc.CMASK_TEXT_BK_COLOR)){for(r=0;r<t.TotalColors;r++)if(MJ(t.color[r].color,W_[e].TextBkColor))break;if(r==t.TotalColors)r=0;if(!R5(t,"cb",tc.PARAM_INT,r))return false;if(!R5(t,"chcbpat",tc.PARAM_INT,r))return false}if(Nj(W_[e].CharMask&tc.CMASK_ULINE_COLOR)){for(r=0;r<t.TotalColors;r++)if(MJ(t.color[r].color,W_[e].UlineColor))break;if(r==t.TotalColors)r=0;if(!R5(t,"ulc",tc.PARAM_INT,r))return false}if(Nj(W_[e].CharMask&tc.CMASK_EXPAND)){if(!R5(t,"expnd",tc.PARAM_INT,Math.round(W_[e].expand*4/20)))return false;if(!R5(t,"expndtw",tc.PARAM_INT,W_[e].expand))return false}if(Nj(W_[e].CharMask&tc.CMASK_SCALE_X)){if(!R5(t,"charscalex",tc.PARAM_INT,W_[e].CharScaleX+100))return false}if(Nj(W_[e].CharMask&tc.CMASK_OFFSET)){var f=W_[e].offset;R5(t,f>0?"up":"dn",tc.PARAM_INT,tj(Math.abs(f)*2))}return true}function U3(t,e){var r,i,f;var l="";var a;if(e){S5(t);for(r=1;r<Vn;r++){if(!Yn[r].InUse||Yn[r].type!=tc.STORY_COMMENT||Dj(Yn[r].flags&tc.FSTORY_BEGINS))continue;if(Nj(Yn[r].flags&tc.FSTORY_OPENED))continue;if(!I5(t))return false;if(!R5(t,"*",tc.PARAM_NONE,0))return false;if(!R5(t,"atrfstart",tc.PARAM_NONE,0))return false;l=mY(Yn[r].RtfId);C5(t,l,l.length);if(!d5(t))return false;Yn[r].flags|=tc.FSTORY_OPENED}}else{S5(t);for(r=1;r<Vn;r++){if(!Yn[r].InUse||Yn[r].type!=tc.STORY_COMMENT||Dj(Yn[r].flags&tc.FSTORY_ENDS))continue;if(Nj(Yn[r].flags&tc.FSTORY_CLOSED))continue;if(!I5(t))return false;if(!R5(t,"*",tc.PARAM_NONE,0))return false;if(!R5(t,"atrfend",tc.PARAM_NONE,0))return false;l=mY(Yn[r].RtfId);C5(t,l,l.length);if(!d5(t))return false;if(!I5(t))return false;if(!R5(t,"*",tc.PARAM_NONE,0))return false;if(!R5(t,"atnid",tc.PARAM_NONE,0))return false;f=Yn[r].AuthorInit.length;if(f>0)C5(t,Yn[r].AuthorInit,f);if(!d5(t))return false;if(!I5(t))return false;if(!R5(t,"*",tc.PARAM_NONE,0))return false;if(!R5(t,"atnauthor",tc.PARAM_NONE,0))return false;f=Yn[r].author.length;if(f>0)C5(t,Yn[r].author,f);if(!d5(t))return false;if(!R5(t,"chatn",tc.PARAM_NONE,0))return false;if(!I5(t))return false;if(!R5(t,"*",tc.PARAM_NONE,0))return false;if(!R5(t,"annotation",tc.PARAM_NONE,0))return false;if(!I5(t))return false;if(!R5(t,"*",tc.PARAM_NONE,0))return false;if(!R5(t,"atnref",tc.PARAM_NONE,0))return false;l=mY(Yn[r].RtfId);C5(t,l,l.length);if(!d5(t))return false;if(Yn[r].time!=null){var n=Yn[r].time.dt;var c=n.getMinutes();var s=n.getHours();var _=n.getDate();var o=n.getMonth()+1;var u=n.getFullYear();var T=0;T=Dk(T,5,6,c);T=Dk(T,10,5,s);T=Dk(T,15,5,_);T=Dk(T,19,4,o);T=Dk(T,28,9,u-1900);if(!I5(t))return false;if(!R5(t,"*",tc.PARAM_NONE,0))return false;if(!R5(t,"atndate",tc.PARAM_NONE,0))return false;l=mY(T);C5(t,l,l.length);if(!d5(t))return false}if(!R5(t,"pard",tc.PARAM_NONE,0))return false;if(!R5(t,"plain",tc.PARAM_NONE,0))return false;if(Yn[r].FontId!=0){var A=t.flags;t.flags|=tc.ROFLAG_WRITE_FONT;u3(t,Yn[r].FontId);t.flags=A}a=Yn[r].text;if(a!=null&&a.length>0){f=a.length;for(i=0;i<f;i++){var E=Uk(a);var R=E[i];t.flags|=tc.ROFLAG_NO_FLUSH;if(R==13&&i+1<f&&E[i+1]==10){if(!R5(t,"par",tc.PARAM_NONE,0))return false;i++}else if(!C5(t,wY(R),1))return false}t.flags=cj(t.flags,tc.ROFLAG_NO_FLUSH)}if(!d5(t))return false;Yn[r].flags|=tc.FSTORY_CLOSED}S5(t)}return true}function k3(t,e){var r,i=W_[e].ParaFlags;var f=W_[e].pflags;var l=W_[e];if(Nj(l.ParaMask&tc.PMASK_TAB)&&l.TabId>0&&!Y3(t,l.TabId))return false;if(Nj(l.ParaMask&(tc.PMASK_BORDER|tc.PMASK_BORDER_COLOR))){if(!X3(t,i,l.ParaBorderColor,0,0,0,0,0,0))return false}if(Nj(l.ParaMask&tc.PMASK_INDENT_FIRST)&&!R5(t,"fi",tc.PARAM_INT,l.FirstIndentTwips))return false;if(Nj(l.ParaMask&tc.PMASK_INDENT_LEFT)&&!R5(t,"li",tc.PARAM_INT,l.LeftIndentTwips))return false;if(Nj(l.ParaMask&tc.PMASK_INDENT_RIGHT)&&!R5(t,"ri",tc.PARAM_INT,l.RightIndentTwips))return false;if(Nj(l.ParaMask&tc.PMASK_SPACING)){if(!R5(t,"sb",tc.PARAM_INT,l.SpaceBefore))return false;if(!R5(t,"sa",tc.PARAM_INT,l.SpaceAfter))return false;if(l.LineSpacing!=0){if(!R5(t,"sl",tc.PARAM_INT,Mj(l.LineSpacing,240,100)+240))return false;if(!R5(t,"slmult",tc.PARAM_INT,1))return false}else if(!R5(t,"sl",tc.PARAM_INT,l.SpaceBetween))return false;if(Nj(i&tc.DOUBLE_SPACE)){if(!R5(t,"sl",tc.PARAM_INT,480))return false;if(!R5(t,"slmult",tc.PARAM_INT,1))return false}}if(Nj(l.ParaMask&tc.PMASK_SHADING)&&!R5(t,"shading",tc.PARAM_INT,l.shading))return false;if(Nj(l.ParaMask&tc.PMASK_FLOW)){if(Nj(l.ParaFlow==tc.FLOW_RTL))R5(t,"rtlpar",tc.PARAM_NONE,0);if(Nj(l.ParaFlow==tc.FLOW_LTR))R5(t,"ltrpar",tc.PARAM_NONE,0)}if(Nj(l.ParaMask&tc.PMASK_OLVL)&&!R5(t,"outlinelevel",tc.PARAM_INT,l.OutlineLevel))return false;if(Nj(l.ParaMask&tc.PMASK_BULLET)&&Nj(i&tc.BULLET)&&!p3(t,l.BltId,-1))return false;if(Dj(l.ParaMask&tc.PMASK_BULLET)&&Nj(l.ParaMask&tc.PMASK_LS)&&l.BltId>0){var a=l.BltId;var n=xc[a].ls;if(n>0){if(!R5(t,"ls",tc.PARAM_INT,t.XlateLs[n]))return false;if(!R5(t,"ilvl",tc.PARAM_INT,xc[a].lvl))return false}}if(Nj(l.ParaMask&tc.PMASK_ALIGN)){if(Nj(i&tc.RIGHT_JUSTIFY)&&!R5(t,"qr",tc.PARAM_NONE,0))return false;if(Nj(i&tc.CENTER)&&!R5(t,"qc",tc.PARAM_NONE,0))return false;if(Nj(i&tc.JUSTIFY)&&!R5(t,"qj",tc.PARAM_NONE,0))return false}if(Nj(l.ParaMask&tc.PMASK_CONTEXTUAL_SPACE)&&Nj(i&tc.PARA_CONTEXTUAL_SPACE)&&!R5(t,"contextualspace",tc.PARAM_NONE,0))return false;if(Nj(l.ParaMask&tc.PMASK_KEEP)&&Nj(i&tc.PARA_KEEP)&&!R5(t,"keep",tc.PARAM_NONE,0))return false;if(Nj(l.ParaMask&tc.PMASK_KEEP_NEXT)&&Nj(i&tc.PARA_KEEP_NEXT)&&!R5(t,"keepn",tc.PARAM_NONE,0))return false;if(Nj(l.ParaMask&tc.PMASK_BK_COLOR)){for(r=0;r<t.TotalColors;r++)if(MJ(t.color[r].color,l.ParaBkColor))break;if(r==t.TotalColors)r=0;if(!R5(t,"cbpat",tc.PARAM_INT,r))return false}if(Nj(f&tc.PFLAG_PAGE_BREAK)){if(!R5(t,"pagebb",tc.PARAM_NONE,0))return false}return true}function X3(t,e,r,i,f,l,a,n,c){var s=true;if(f!=l)s=false;else if(f!=a)s=false;else if(f!=n)s=false;if((e&tc.PARA_BOX)==tc.PARA_BOX&&Dj(e&tc.PARA_BOX_BETWEEN)&&s){if(!R5(t,"box",tc.PARAM_NONE,0))return false;if(c>0&&!R5(t,"brdrw",tc.PARAM_INT,c))return false;if(Nj(e&tc.PARA_BOX_DOUBLE)&&!R5(t,"brdrdb",tc.PARAM_NONE,0))return false;if(Dj(e&tc.PARA_BOX_DOUBLE)&&!R5(t,"brdrs",tc.PARAM_NONE,0))return false;R5(t,"brsp",tc.PARAM_INT,f);if(r!=tc.CLR_AUTO)K3(t,r)}else{if(Nj(e&tc.PARA_BOX_TOP)){if(!R5(t,"brdrt",tc.PARAM_NONE,0))return false;if(c>0&&!R5(t,"brdrw",tc.PARAM_INT,c))return false;if(Nj(e&tc.PARA_BOX_DOUBLE)&&!R5(t,"brdrdb",tc.PARAM_NONE,0))return false;if(Dj(e&tc.PARA_BOX_DOUBLE)&&!R5(t,"brdrs",tc.PARAM_NONE,0))return false;R5(t,"brsp",tc.PARAM_INT,a);if(r!=tc.CLR_AUTO)K3(t,r)}if(Nj(e&tc.PARA_BOX_BOT)){if(!R5(t,"brdrb",tc.PARAM_NONE,0))return false;if(c>0&&!R5(t,"brdrw",tc.PARAM_INT,c))return false;if(Nj(e&tc.PARA_BOX_DOUBLE)&&!R5(t,"brdrdb",tc.PARAM_NONE,0))return false;if(Dj(e&tc.PARA_BOX_DOUBLE)&&!R5(t,"brdrs",tc.PARAM_NONE,0))return false;R5(t,"brsp",tc.PARAM_INT,n);if(r!=tc.CLR_AUTO)K3(t,r)}if(Nj(e&tc.PARA_BOX_BETWEEN)){if(!R5(t,"brdrbtw",tc.PARAM_NONE,0))return false;if(c>0&&!R5(t,"brdrw",tc.PARAM_INT,c))return false;if(Nj(e&tc.PARA_BOX_DOUBLE)&&!R5(t,"brdrdb",tc.PARAM_NONE,0))return false;if(Dj(e&tc.PARA_BOX_DOUBLE)&&!R5(t,"brdrs",tc.PARAM_NONE,0))return false;if(r!=tc.CLR_AUTO)K3(t,r)}if(Nj(e&tc.PARA_BOX_LEFT)){if(!R5(t,"brdrl",tc.PARAM_NONE,0))return false;if(c>0&&!R5(t,"brdrw",tc.PARAM_INT,c))return false;if(Nj(e&tc.PARA_BOX_DOUBLE)&&!R5(t,"brdrdb",tc.PARAM_NONE,0))return false;if(Dj(e&tc.PARA_BOX_DOUBLE)&&!R5(t,"brdrs",tc.PARAM_NONE,0))return false;R5(t,"brsp",tc.PARAM_INT,f);if(r!=tc.CLR_AUTO)K3(t,r)}if(Nj(e&tc.PARA_BOX_RIGHT)){if(!R5(t,"brdrr",tc.PARAM_NONE,0))return false;if(c>0&&!R5(t,"brdrw",tc.PARAM_INT,c))return false;if(Nj(e&tc.PARA_BOX_DOUBLE)&&!R5(t,"brdrdb",tc.PARAM_NONE,0))return false;if(Dj(e&tc.PARA_BOX_DOUBLE)&&!R5(t,"brdrs",tc.PARAM_NONE,0))return false;R5(t,"brsp",tc.PARAM_INT,l);if(r!=tc.CLR_AUTO)K3(t,r)}}if(Nj(e&tc.PARA_BOX)&&i>0&&Dj(kl[i].flags&tc.PARA_FRAME_OBJECT)){var _=kl[i].margin;if(_<0)_=0;if(!R5(t,"brsp",tc.PARAM_INT,_))return false}return true}function K3(t,e){var r;if(!MJ(e,tc.CLR_AUTO)){for(r=0;r<t.TotalColors;r++)if(MJ(t.color[r].color,e))break;if(r==t.TotalColors)r=0;if(!R5(t,"brdrcf",tc.PARAM_INT,r))return false}return true}function Y3(t,e){var r,i;i=B_[e].count;if(i>tc.TE_MAX_TAB_STOPS)i=0;for(r=0;r<i;r++){if(B_[e].type[r]==tc.TAB_RIGHT)if(!R5(t,"tqr",tc.PARAM_NONE,0))return false;if(B_[e].type[r]==tc.TAB_DECIMAL)if(!R5(t,"tqdec",tc.PARAM_NONE,0))return false;if(B_[e].type[r]==tc.TAB_CENTER)if(!R5(t,"tqc",tc.PARAM_NONE,0))return false;if(B_[e].flags[r]==tc.TAB_DOT)if(!R5(t,"tldot",tc.PARAM_NONE,0))return false;if(B_[e].flags[r]==tc.TAB_HYPH)if(!R5(t,"tlhyph",tc.PARAM_NONE,0))return false;if(B_[e].flags[r]==tc.TAB_ULINE)if(!R5(t,"tlul",tc.PARAM_NONE,0))return false;if(!R5(t,"tx",tc.PARAM_INT,B_[e].pos[r]))return false}return true}function V3(t,e,r){var i,f,l,a;if(Nj(iO&tc.TFLAG9_SHRINK_LIST_TABLE)){for(i=0;i<yc;i++)xc[i].flags=cj(xc[i].flags,tc.BLTFLAG_USED);for(l=0;l<Ri;l++){var n,c,s;if(ui[l].fid==0&&(l<e||l>r))continue;n=ui[l].pfmt;c=Nc[n].StyId;s=Nc[n].BltId;xc[s].flags|=tc.BLTFLAG_USED;s=W_[c].BltId;xc[s].flags|=tc.BLTFLAG_USED}}else{for(i=0;i<yc;i++)xc[i].flags|=tc.BLTFLAG_USED}t.XlateLs[0]=0;a=1;for(i=1;i<zc;i++){t.XlateLs[i]=0;if(!Jc[i].InUse)continue;for(f=0;f<yc;f++)if(xc[f].ls==i&&Nj(xc[f].flags&tc.BLTFLAG_USED))break;if(f>=yc)continue;t.XlateLs[i]=a;a++}return true}function j3(t){var e,r,i,f;var l;var a,n;if(Vc==1&&zc==1)return true;S5(t);if(!I5(t))return false;if(!R5(t,"*",tc.PARAM_NONE,0))return false;if(!R5(t,"listtable",tc.PARAM_NONE,0))return false;for(e=1;e<Vc;e++){if(!Kc[e].InUse)continue;S5(t);if(!I5(t))return false;if(!R5(t,"list",tc.PARAM_NONE,0))return false;n=Kc[e].TmplId;if(Nj(fO&tc.TFLAG10_WRITE_RANDOM_LIST_TMPL_ID)){var c=new Date;var s=new Date("January 1, 2016");n=Math.floor((c.getTime()-s.getTime())/1e3)+e*Vc}if(n>2e9)n=n/10;if(!R5(t,"listtemplateid",tc.PARAM_INT,n))return false;if(Kc[e].LevelCount==1&&!R5(t,"listsimple",tc.PARAM_NONE,0))return false;if(Nj(Kc[e].flags&tc.LISTFLAG_RESTART_SEC)&&!R5(t,"listrestarthdn",tc.PARAM_NONE,0))return false;for(r=0;r<Kc[e].LevelCount;r++){if(!J3(t,Kc[e].level[r]))return false}if(!I5(t))return false;if(!R5(t,"listname",tc.PARAM_NONE,0))return false;if(Nj(Kc[e].name))l=Kc[e].name;else l="";l+=";";if(!C5(t,l,l.length))return false;if(!d5(t))return false;n=Kc[e].id;if(n>2e9)n=n/10;if(!R5(t,"listid",tc.PARAM_INT,n))return false;S5(t);if(!d5(t))return false;S5(t)}if(!d5(t))return false;S5(t);S5(t);if(!I5(t))return false;if(!R5(t,"*",tc.PARAM_NONE,0))return false;if(!R5(t,"listoverridetable",tc.PARAM_NONE,0))return false;for(e=1;e<zc;e++){if(!Jc[e].InUse||t.XlateLs[e]==0)continue;for(r=0;r<yc;r++)if(xc[r].ls==e)break;if(r>=yc)continue;S5(t);if(!I5(t))return false;if(!R5(t,"listoverride",tc.PARAM_NONE,0))return false;f=Jc[e].ListIdx;a=Kc[f].id;if(a>2e9)a=a/10;if(!R5(t,"listid",tc.PARAM_INT,a))return false;if(!R5(t,"listoverridecount",tc.PARAM_INT,Jc[e].LevelCount))return false;for(r=0;r<Jc[e].LevelCount;r++){S5(t);if(!I5(t))return false;if(!R5(t,"lfolevel",tc.PARAM_NONE,0))return false;if(Nj(Jc[e].level[r].flags&tc.LISTLEVEL_REFORMAT)&&!R5(t,"listoverrideformat",tc.PARAM_NONE,0))return false;if(Nj(Jc[e].level[r].flags&tc.LISTLEVEL_RESTART)&&!R5(t,"listoverridestartat",tc.PARAM_NONE,0))return false;if(!J3(t,Jc[e].level[r]))return false;if(!d5(t))return false;S5(t)}i=t.XlateLs[e];if(!R5(t,"ls",tc.PARAM_INT,i))return false;if(!d5(t))return false;S5(t)}if(!d5(t))return false;S5(t);return true}function J3(t,e){var r,i,f,l=-1;var a,n;S5(t);if(!I5(t))return false;if(!R5(t,"listlevel",tc.PARAM_NONE,0))return false;if(!R5(t,"levelnfc",tc.PARAM_INT,e.NumType))return false;if(!R5(t,"levelfollow",tc.PARAM_INT,e.CharAft))return false;if(!R5(t,"levelstartat",tc.PARAM_INT,e.start))return false;if(Nj(e.flags&tc.LISTLEVEL_NO_RESET)&&!R5(t,"levelnorestart",tc.PARAM_NONE,0))return false;if(e.MinIndent>0&&!R5(t,"levelindent",tc.PARAM_INT,e.MinIndent))return false;if(Nj(e.flags&tc.LISTLEVEL_OLD)&&!R5(t,"levelold",tc.PARAM_NONE,0))return false;if(Nj(e.flags&tc.LISTLEVEL_LEGAL)&&!R5(t,"levellegal",tc.PARAM_NONE,0))return false;if(!I5(t))return false;if(!R5(t,"leveltext",tc.PARAM_NONE,0))return false;i=e.txt[0]+1;if(e.NumType==tc.LIST_BLT){t.flags|=tc.ROFLAG_NO_FLUSH;if(e.txt[0]==0){if(!F5(t,1))return false;if(!R5(t,"u",tc.PARAM_INT,-3913))return false;if(!C5(t,"?",1))return false}else{for(r=0;r<i;r++){a=r==0||e.txt[r]<9;t.flags|=tc.ROFLAG_NO_FLUSH;if(a&&!F5(t,e.txt[r]))return false;if(!a&&!C5(t,lV(e.txt,r),1))return false}}t.flags=cj(t.flags,tc.ROFLAG_NO_FLUSH);if(n_.length>0){var c=n_;for(r=0;r<Ys;r++)if(xs[r].InUse&&Dj(xs[r].style&tc.PICT)&&Tk(xs[r].TypeFace,c)==0)break;if(r<Ys)l=r}}else{for(r=0;r<i;r++){a=r==0||e.txt[r]<9;t.flags|=tc.ROFLAG_NO_FLUSH;if(a&&!F5(t,e.txt[r]))return false;if(!a&&!C5(t,lV(e.txt,r),1))return false}cj(t.flags,tc.ROFLAG_NO_FLUSH)}t.flags=cj(t.flags,tc.ROFLAG_NO_FLUSH);if(!d5(t))return false;if(!I5(t))return false;if(!R5(t,"levelnumbers",tc.PARAM_NONE,0))return false;for(r=0;r<i;r++){n=r!=0&&e.txt[r]<9;if(n&&!F5(t,r))return false}if(!d5(t))return false;f=e.FontId;if(l>=0)f=l;if(f>0){var s;if(Nj(e.CharMask&tc.CMASK_FONT_LATIN)){if(!R5(t,"f",tc.PARAM_INT,xs[f].RtfIndex))return false}if(Nj(e.CharMask&tc.CMASK_FONT_DB)){if(!R5(t,"fcs",tc.PARAM_INT,1))return false;if(!R5(t,"f",tc.PARAM_INT,xs[f].RtfIndex))return false;if(!R5(t,"af",tc.PARAM_INT,xs[f].RtfIndex))return false;if(!R5(t,"fcs",tc.PARAM_INT,0))return false}if(Nj(e.CharMask&tc.CMASK_FONT_RTL)){if(!R5(t,"rtlch",tc.PARAM_NONE,0))return false;if(!R5(t,"f",tc.PARAM_INT,xs[f].RtfIndex))return false;if(!R5(t,"af",tc.PARAM_INT,xs[f].RtfIndex))return false;if(!R5(t,"ltrch",tc.PARAM_NONE,0))return false}if(Nj(e.CharMask&tc.CMASK_SIZE)){if(!R5(t,"fs",tc.PARAM_INT,xs[f].TwipsSize/10))return false}if(!R3(t,xs[f].style,0))return false;s=xs[f].TextColor;if(Nj(e.CharMask&tc.CMASK_TEXT_COLOR)&&!MJ(s,tc.CLR_AUTO)){for(r=0;r<t.TotalColors;r++)if(MJ(t.color[r].color,s))break;if(r==t.TotalColors)r=0;if(!R5(t,"cf",tc.PARAM_INT,r))return false}}if(e.ParaStyId>0&&!R5(t,"s",tc.PARAM_INT,e.ParaStyId))return false;if(e.FirstIndent>0&&!R5(t,"fi",tc.PARAM_INT,e.FirstIndent))return false;if(e.LeftIndent>0&&!R5(t,"li",tc.PARAM_INT,e.LeftIndent))return false;if(e.RightIndent>0&&!R5(t,"ri",tc.PARAM_INT,e.RightIndent))return false;if(!d5(t))return false;S5(t);return true}function z3(t){var e,r;var i;var f;S5(t);if(t.output<tc.RTF_CB){for(i=0;i<tc.INFO_MAX;i++)if(Nj(CO[i]))break;if(i<tc.INFO_MAX){if(!I5(t))return false;if(!R5(t,"info",tc.PARAM_NONE,0))return false;for(i=0;i<tc.INFO_MAX;i++){if(Dj(CO[i]))continue;if(!I5(t))return false;if((i==tc.INFO_PWHASH||i==tc.INFO_SSUSER)&&!R5(t,"*",tc.PARAM_NONE,0))return false;if(!R5(t,LO[i],tc.PARAM_NONE,0))return false;C5(t,CO[i],CO[i].length);if(!d5(t))return false}if(!d5(t))return false}}if(IO!=null&&dO>0){S5(t);if(!I5(t))return false;if(!R5(t,"*",tc.PARAM_NONE,0))return false;if(!R5(t,"userprops",tc.PARAM_NONE,0))return false;for(i=0;i<dO;i++){if(!I5(t))return false;if(!R5(t,"propname",tc.PARAM_NONE,0))return false;if(IO[i].name!=null)C5(t,IO[i].name,IO[i].name.length);if(!d5(t))return false;if(!R5(t,"proptype",tc.PARAM_INT,IO[i].type))return false;if(IO[i].StaticVal!=null){if(!I5(t))return false;if(!R5(t,"staticval",tc.PARAM_NONE,0))return false;C5(t,IO[i].StaticVal,IO[i].StaticVal.length);if(!d5(t))return false}if(IO[i].LinkVal!=null){if(!I5(t))return false;if(!R5(t,"linkval",tc.PARAM_NONE,0))return false;C5(t,IO[i].LinkVal,IO[i].LinkVal.length);if(!d5(t))return false}}if(!d5(t))return false;S5(t)}r=8.5;e=11;if(!R5(t,"paperw",tc.PARAM_INT,jV(r)))return false;if(!R5(t,"paperh",tc.PARAM_INT,jV(e)))return false;if(!R5(t,"margl",tc.PARAM_INT,jV(to[0].LeftMargin)))return false;if(!R5(t,"margr",tc.PARAM_INT,jV(to[0].RightMargin)))return false;if(!R5(t,"margt",tc.PARAM_INT,jV(to[0].TopMargin*(Nj(to[0].flags&tc.SECT_EXACT_MARGT)?-1:1))))return false;if(!R5(t,"margb",tc.PARAM_INT,jV(to[0].BotMargin*(Nj(to[0].flags&tc.SECT_EXACT_MARGB)?-1:1))))return false;if(!R5(t,"headery",tc.PARAM_INT,jV(to[0].HdrMargin)))return false;if(!R5(t,"footery",tc.PARAM_INT,jV(to[0].FtrMargin)))return false;if(hu>0&&!R5(t,"gutter",tc.PARAM_INT,jV(hu)))return false;if(Di&&!R5(t,"htmautsp",tc.PARAM_INT,1))return false;if(!R5(t,"nogrowautofit",tc.PARAM_NONE,0))return false;if(Nj(nO&tc.TOFLAG2_DONT_ULINE_TRAIL_SPC)&&!R5(t,"noultrlspc",tc.PARAM_NONE,0))return false;if(!R5(t,"deftab",tc.PARAM_INT,m_))return false;if(!R5(t,"formshade",tc.PARAM_NONE,0))return false;if(mh&&!R5(t,"formprot",tc.PARAM_NONE,0))return false;if(OS){if(!R5(t,"annotprot",tc.PARAM_NONE,0))return false;if(!R5(t,"readprot",tc.PARAM_NONE,0))return false}if(Gi&&!R5(t,"nofeaturethrottle",tc.PARAM_INT,1))return false;if(Hi&&!R5(t,"useltbaln",tc.PARAM_INT,1))return false;if(qi&&!R5(t,"dntblnsbdb",tc.PARAM_NONE,0))return false;if(zi&&!R5(t,"nouicompat",tc.PARAM_INT,1))return false;if(Zi&&!R5(t,"noindnmbrts",tc.PARAM_INT,1))return false;if($i&&!R5(t,"expshrtn",tc.PARAM_NONE,0))return false;if(ff&&!R5(t,"spltpgpar",tc.PARAM_NONE,0))return false;if(Nj(wE)){f="";if(wE==tc.NBR_UPR_ROMAN)f="ftnnruc";else if(wE==tc.NBR_LWR_ROMAN)f="ftnnrlc";else if(wE==tc.NBR_UPR_ALPHA)f="ftnnauc";else if(wE==tc.NBR_LWR_ALPHA)f="ftnnalc";if(f.length>0&&!R5(t,f,tc.PARAM_NONE,0))return false}if(!R5(t,"fet",tc.PARAM_INT,4))return false;if(!R5(t,BE?"aendnotes":"aenddoc",tc.PARAM_NONE,0))return false;if(Nj(bE)){f="";if(bE==tc.NBR_UPR_ROMAN)f="aftnnruc";else if(bE==tc.NBR_LWR_ROMAN)f="aftnnrlc";else if(bE==tc.NBR_UPR_ALPHA)f="aftnnauc";else if(bE==tc.NBR_LWR_ALPHA)f="aftnnalc";if(f.length>0&&!R5(t,f,tc.PARAM_NONE,0))return false}if(!R5(t,"pgbrdrhead",tc.PARAM_NONE,0))return false;if(!R5(t,"pgbrdrfoot",tc.PARAM_NONE,0))return false;if(SS&&!R5(t,"notabind",tc.PARAM_NONE,0))return false;if(mr==tc.FLOW_RTL&&!R5(t,"rtldoc",tc.PARAM_NONE,0))return false;if(mr==tc.FLOW_LTR&&!R5(t,"ltrdoc",tc.PARAM_NONE,0))return false;if(Z_&&!R5(t,"revisions",tc.PARAM_NONE,0))return false;S5(t);return true}function Z3(t,e){var r;var i;var f;S5(t);if(!R5(t,"sectd",tc.PARAM_NONE,0))return false;if(t.output<tc.RTF_CB){if(Nj(to[e].border)){if(to[e].BorderOpts>0&&!R5(t,"pgbrdropt",tc.PARAM_INT,to[e].BorderOpts))return false;for(r=0;r<4;r++){if(r==tc.BORDER_INDEX_TOP&&!R5(t,"pgbrdrt",tc.PARAM_NONE,0))return false;else if(r==tc.BORDER_INDEX_BOT&&!R5(t,"pgbrdrb",tc.PARAM_NONE,0))return false;else if(r==tc.BORDER_INDEX_LEFT&&!R5(t,"pgbrdrl",tc.PARAM_NONE,0))return false;else if(r==tc.BORDER_INDEX_RIGHT&&!R5(t,"pgbrdrr",tc.PARAM_NONE,0))return false;if(to[e].BorderType==tc.BRDRTYPE_NONE&&!R5(t,"brdrnone",tc.PARAM_NONE,0))return false;else if(to[e].BorderType==tc.BRDRTYPE_SINGLE&&!R5(t,"brdrs",tc.PARAM_NONE,0))return false;else if(to[e].BorderType==tc.BRDRTYPE_DBL&&!R5(t,"brdrdb",tc.PARAM_NONE,0))return false;else if(to[e].BorderType==tc.BRDRTYPE_TRIPLE&&!R5(t,"brdrtriple",tc.PARAM_NONE,0))return false;else if(to[e].BorderType==tc.BRDRTYPE_SHADOW&&!R5(t,"brdrsh",tc.PARAM_NONE,0))return false;else if(to[e].BorderType==tc.BRDRTYPE_THICK_THIN&&!R5(t,"brdrthtnmg",tc.PARAM_NONE,0))return false;else if(to[e].BorderType==tc.BRDRTYPE_THICK_THIN_THICK&&!R5(t,"brdrthtnthmg",tc.PARAM_NONE,0))return false;else if(to[e].BorderType==tc.BRDRTYPE_THIN_THICK&&!R5(t,"brdrtnthmg",tc.PARAM_NONE,0))return false;else if(to[e].BorderType==tc.BRDRTYPE_THIN_THICK_THIN&&!R5(t,"brdrtnthtnmg",tc.PARAM_NONE,0))return false;if(!R5(t,"brdrw",tc.PARAM_INT,to[e].BorderWidth[r]))return false;if(!R5(t,"brsp",tc.PARAM_INT,to[e].BorderSpace[r]))return false;if(!MJ(to[e].BorderColor,tc.CLR_AUTO)){var l;for(l=0;l<t.TotalColors;l++)if(MJ(t.color[l].color,to[e].BorderColor))break;if(l==t.TotalColors)l=0;if(!R5(t,"brdrcf",tc.PARAM_INT,l))return false}}}}var a=8.5;var n=11;if(!to[e].IsPortrait&&!R5(t,"lndscpsxn",tc.PARAM_NONE,0))return false;a=eo[e].PgWidth;n=eo[e].PgHeight;if(!R5(t,"pgwsxn",tc.PARAM_INT,jV(a)))return false;if(!R5(t,"pghsxn",tc.PARAM_INT,jV(n)))return false;if(!R5(t,"guttersxn",tc.PARAM_INT,jV(to[e].gutter)))return false;i=h5(to[e].FirstPageBin);if(i!=0&&i!=tc.DMBIN_AUTO&&!R5(t,"binfsxn",tc.PARAM_INT,i))return false;i=h5(to[e].bin);if(i!=0&&i!=tc.DMBIN_AUTO&&!R5(t,"binsxn",tc.PARAM_INT,i))return false;if(Nj(to[e].flags&tc.SECT_HAS_TITLE_PAGE)){if(!R5(t,"titlepg",tc.PARAM_NONE,0))return false}if(Nj(to[e].flags&tc.SECT_HAS_FACING_PAGES)){if(!R5(t,"facingp",tc.PARAM_NONE,0))return false}if(Nj(to[e].flags&tc.SECT_UNLOCKED)){if(!R5(t,"sectunlocked",tc.PARAM_INT,1))return false}var c=to[e].LeftMargin;if(Nj(to[e].flags&tc.SECT_GUTTER_ADDED))c-=to[e].gutter;if(!R5(t,"marglsxn",tc.PARAM_INT,jV(c)))return false;if(!R5(t,"margrsxn",tc.PARAM_INT,jV(to[e].RightMargin)))return false;if(!R5(t,"margtsxn",tc.PARAM_INT,jV(to[e].TopMargin*(Nj(to[e].flags&tc.SECT_EXACT_MARGT)?-1:1))))return false;if(!R5(t,"margbsxn",tc.PARAM_INT,jV(to[e].BotMargin*(Nj(to[e].flags&tc.SECT_EXACT_MARGB)?-1:1))))return false;if(!R5(t,"headery",tc.PARAM_INT,jV(to[e].HdrMargin)))return false;if(!R5(t,"footery",tc.PARAM_INT,jV(to[e].FtrMargin)))return false;if(Dj(to[e].flags&tc.SECT_NEW_PAGE))if(!R5(t,"sbknone",tc.PARAM_NONE,0))return false;if(Nj(to[e].flags&tc.SECT_NEW_PAGE)){if(Nj(to[e].flags&tc.SECT_START_ON_EVEN_PAGE))R5(t,"sbkeven",tc.PARAM_NONE,0);else if(Nj(to[e].flags&tc.SECT_START_ON_ODD_PAGE))R5(t,"sbkodd",tc.PARAM_NONE,0);else R5(t,"sbkpage",tc.PARAM_NONE,0)}if(Nj(to[e].flags&tc.SECT_RESTART_PAGE_NO)){if(!R5(t,"pgnstarts",tc.PARAM_INT,to[e].FirstPageNo))return false;if(!R5(t,"pgnrestart",tc.PARAM_NONE,0))return false}else if(!R5(t,"pgncont",tc.PARAM_NONE,0))return false;if(Nj(to[e].flags&tc.SECT_VALIGN_CTR)&&!R5(t,"vertalc",tc.PARAM_NONE,0))return false;else if(Nj(to[e].flags&tc.SECT_VALIGN_BOT)&&!R5(t,"vertal",tc.PARAM_NONE,0))return false;if(to[e].columns>1){if(!R5(t,"cols",tc.PARAM_INT,to[e].columns))return false;if(!R5(t,"colsx",tc.PARAM_INT,jV(to[e].ColumnSpace)))return false;if(Nj(to[e].flags&tc.SECT_VAR_COL_WIDTH)){for(r=0;r<to[e].columns;r++){if(!R5(t,"colno",tc.PARAM_INT,r+1))return false;if(!R5(t,"colw",tc.PARAM_INT,to[e].ColWidth[r]))return false;if(r+1<to[e].columns&&!R5(t,"colsr",tc.PARAM_INT,to[e].ColSpace[r]))return false}}if(Nj(to[e].flags&tc.SECT_LINE_BET_COL)&&!R5(t,"linebetcol",tc.PARAM_NONE,0))return false}if(to[e].PageNumFmt==tc.NBR_UPR_ROMAN)f="pgnucrm";else if(to[e].PageNumFmt==tc.NBR_LWR_ROMAN)f="pgnlcrm";else if(to[e].PageNumFmt==tc.NBR_UPR_ALPHA)f="pgnucltr";else if(to[e].PageNumFmt==tc.NBR_LWR_ALPHA)f="pgnlcltr";else f="pgndec";if(!R5(t,f,tc.PARAM_NONE,0))return false;if(to[e].flow==tc.FLOW_RTL&&!R5(t,"rtlsect",tc.PARAM_NONE,0))return false;if(to[e].flow==tc.FLOW_LTR&&!R5(t,"ltrsect",tc.PARAM_NONE,0))return false;if(Nj(to[e].flags&tc.SECT_LINE)){var s=to[e].LineStep;if(s<1)s=1;if(!R5(t,"linemod",tc.PARAM_INT,s))return false}if(Nj(to[e].LineSpace!=0)&&Nj(to[e].flags&tc.SECT_SNAP_LINE_GRID)){if(!R5(t,"sectlinegrid",tc.PARAM_INT,to[e].LineSpace))return false;if(!R5(t,"sectspecifyl",tc.PARAM_NONE,0))return false}t.sect=e;S5(t);return true}function Q3(t,e){return true}function q3(t,e){var r=t.group[t.GroupLevel].FieldId;if(Nj(t.flags&tc.ROFLAG_IN_FIELD_NAME)){if(!d5(t))return false;if(!d5(t))return false;t.flags=cj(t.flags,tc.ROFLAG_IN_FIELD_NAME)}if(r==tc.FIELD_DATA&&xs[e].FieldId!=tc.FIELD_DATA){if(!d5(t))return false;if(!d5(t))return false}if(r==tc.FIELD_HLINK){if(!d5(t))return false;if(!d5(t))return false;t.group[t.GroupLevel].FieldId=0;t.group[t.GroupLevel].FieldCode=""}if(Nj(t.flags&tc.ROFLAG_IN_HIDDEN_GROUP)){if(!d5(t))return false;t.flags=cj(t.flags,tc.ROFLAG_IN_HIDDEN_GROUP);t.flags|=tc.ROFLAG_WRITE_PARA_PROPS}return true}function $3(t,e){var r;var i;if(Nj(Qh&tc.TFLAG3_NO_RTF_BKND_COLOR))return true;if(false&&iR>1){for(i=0;i<Ri;i++){if(ui[i].cid>0||ui[i].len<=1)continue;return true}}if(false&&!R5(t,"viewkind",tc.PARAM_INT,5))return false;if(!R5(t,"viewbksp",tc.PARAM_INT,1))return false;if(!I5(t))return false;if(!R5(t,"*",tc.PARAM_NONE,0))return false;if(!R5(t,"background",tc.PARAM_NONE,0))return false;if(!I5(t))return false;if(!R5(t,"shp",tc.PARAM_NONE,0))return false;if(!I5(t))return false;if(!R5(t,"*",tc.PARAM_NONE,0))return false;if(!R5(t,"shpinst",tc.PARAM_NONE,0))return false;if(!R5(t,"shpleft",tc.PARAM_INT,0))return false;if(!R5(t,"shpright",tc.PARAM_INT,0))return false;if(!R5(t,"shptop",tc.PARAM_INT,0))return false;if(!R5(t,"shpbottom",tc.PARAM_INT,0))return false;if(!R5(t,"shpbymargin",tc.PARAM_NONE,0))return false;if(!R5(t,"shpwr",tc.PARAM_INT,tc.SWRAP_NO_WRAP))return false;if(!R5(t,"shpwrk",tc.PARAM_INT,tc.WRAPSIDE_BOTH))return false;r=mY(tc.SHPTYPE_RECT);if(!a5(t,"shapeType",r))return false;r=mY(pJ(e));if(!a5(t,"fillColor",r))return false;if(!d5(t))return false;if(!d5(t))return false;if(!d5(t))return false;return true}function t5(t,e){var r=xs[e].ExpId;var i;S5(t);if(!I5(t))return false;if(!R5(t,"mmath",tc.PARAM_NONE,0))return false;if(!I5(t))return false;if(!R5(t,"*",tc.PARAM_NONE,0))return false;if(!R5(t,"moMath",tc.PARAM_NONE,0))return false;if(r>0){for(i=0;i<D_[r].ExpCount;i++)e5(t,D_[r].exp[i])}if(!d5(t))return false;if(!I5(t))return false;if(!R5(t,"mmathPict",tc.PARAM_NONE,0))return false;S5(t);return true}function e5(t,e){var r,i=e.FontId;var f;var l;S5(t);if(!R5(t,"f",tc.PARAM_INT,xs[i].RtfIndex))return false;if(!R5(t,"fs",tc.PARAM_INT,xs[i].TwipsSize/10))return false;if(!R3(t,xs[i].style,0))return false;f=xs[i].TextColor;if(f!=tc.CLR_AUTO){for(r=0;r<t.TotalColors;r++)if(MJ(t.color[r].color,f))break;if(r==t.TotalColors)r=0;if(!R5(t,"cf",tc.PARAM_INT,r))return false}if(!I5(t))return false;if(e.type==tc.MTYPE_RUN){if(!R5(t,"mr",tc.PARAM_NONE,0))return false;if(!R5(t,"msty",tc.PARAM_INT,e.style))return false;if(!R5(t,"mscr",tc.PARAM_INT,e.script))return false;if(e.text!=null)C5(t,e.text,e.text.length)}else if(e.type==tc.MTYPE_FRAC){if(!R5(t,"mf",tc.PARAM_NONE,0))return false;if(I5(t)){if(!R5(t,"mfPr",tc.PARAM_NONE,0))return false;if(Nj(e.flags&tc.MFLAG_NO_BAR)){if(I5(t)){if(!R5(t,"mtype",tc.PARAM_NONE,0))return false;l="noBar";C5(t,l,l.length);d5(t)}}d5(t)}for(r=0;r<e.ExpCount;r++)e5(t,e.exp[r])}else if(e.type==tc.MTYPE_NUM){if(!R5(t,"mnum",tc.PARAM_NONE,0))return false;for(r=0;r<e.ExpCount;r++)e5(t,e.exp[r])}else if(e.type==tc.MTYPE_DEN){if(!R5(t,"mden",tc.PARAM_NONE,0))return false;for(r=0;r<e.ExpCount;r++)e5(t,e.exp[r])}else if(e.type==tc.MTYPE_RAD){if(!R5(t,"mrad",tc.PARAM_NONE,0))return false;if(I5(t)){if(!R5(t,"mradPr",tc.PARAM_NONE,0))return false;if(Nj(e.flags&tc.MFLAG_HIDE_DEG)){if(I5(t)){if(!R5(t,"mdegHide",tc.PARAM_NONE,0))return false;l="on";C5(t,l,l.length);d5(t)}}d5(t)}for(r=0;r<e.ExpCount;r++)e5(t,e.exp[r])}else if(e.type==tc.MTYPE_DEG){if(!R5(t,"mdeg",tc.PARAM_NONE,0))return false;for(r=0;r<e.ExpCount;r++)e5(t,e.exp[r])}else if(e.type==tc.MTYPE_BASE){if(!R5(t,"me",tc.PARAM_NONE,0))return false;for(r=0;r<e.ExpCount;r++)e5(t,e.exp[r])}else if(e.type==tc.MTYPE_FUNC){if(!R5(t,"mfunc",tc.PARAM_NONE,0))return false;for(r=0;r<e.ExpCount;r++)e5(t,e.exp[r])}else if(e.type==tc.MTYPE_FUNC_NAME){if(!R5(t,"mfName",tc.PARAM_NONE,0))return false;for(r=0;r<e.ExpCount;r++)e5(t,e.exp[r])}else if(e.type==tc.MTYPE_DELIM_OBJ){if(!R5(t,"md",tc.PARAM_NONE,0))return false;for(r=0;r<e.ExpCount;r++)e5(t,e.exp[r])}else if(e.type==tc.MTYPE_SUP_OBJ){if(!R5(t,"msSup",tc.PARAM_NONE,0))return false;for(r=0;r<e.ExpCount;r++)e5(t,e.exp[r])}else if(e.type==tc.MTYPE_SUP_ARG){if(!R5(t,"msup",tc.PARAM_NONE,0))return false;for(r=0;r<e.ExpCount;r++)e5(t,e.exp[r])}else if(e.type==tc.MTYPE_SUB_OBJ){if(!R5(t,"msSub",tc.PARAM_NONE,0))return false;for(r=0;r<e.ExpCount;r++)e5(t,e.exp[r])}else if(e.type==tc.MTYPE_SUB_ARG){if(!R5(t,"msub",tc.PARAM_NONE,0))return false;for(r=0;r<e.ExpCount;r++)e5(t,e.exp[r])}else if(e.type==tc.MTYPE_NARY){if(!R5(t,"mnary",tc.PARAM_NONE,0))return false;if(I5(t)){if(!R5(t,"mnaryPr",tc.PARAM_NONE,0))return false;if(e.mark!=0){if(I5(t)){if(!R5(t,"mchr",tc.PARAM_NONE,0))return false;l=wY(e.mark);C5(t,l,l.length);d5(t)}}if(Nj(e.flags&tc.MFLAG_GROW)){if(I5(t)){if(!R5(t,"mgrow",tc.PARAM_NONE,0))return false;l="on";C5(t,l,l.length);d5(t)}}d5(t)}for(r=0;r<e.ExpCount;r++)e5(t,e.exp[r])}if(!d5(t))return false;return true}function r5(t,e,r){var i;t.WatermarkWritten|=r;i=kl[$l].pict;if(e){if(!I5(t))return false;if(!R5(t,"header",tc.PARAM_NONE,0))return false}i5(t,i);if(e){if(!d5(t))return false}return true}function i5(t,e){var r,i,f,l=xs[e].ParaFID;var a=kl[l];var n,c;var s;var _,o;var u;var T,A=false;var E;var R;var L=false;c=a.flags;u=xs[e].anim;if(u!=null&&(xs[e].anim.FirstPict==0||xs[e].anim.FirstPict==e))A=true;T=Nj(xs[e].LinkFile)&&xs[e].LinkFile.indexOf(".tc.GIF")>=0&&A;if(true||T)A=false;if(A){if(!I5(t))return false;if(!R5(t,"ssanimdelay",tc.PARAM_INT,u.delay))return false;if(!R5(t,"ssanimloops",tc.PARAM_INT,u.OrigLoopCount))return false}S5(t);o=Nj(kl[l].flags&tc.PARA_FRAME_SHPGRP);if(!I5(t))return false;if(!R5(t,o?"shpgrp":"shp",tc.PARAM_NONE,0))return false;if(!I5(t))return false;if(!R5(t,"*",tc.PARAM_NONE,0))return false;if(!R5(t,"shpinst",tc.PARAM_NONE,0))return false;var C=xs[e].FrameType!=tc.PFRAME_FLOAT||Nj(a.flags&(tc.PARA_FRAME_CENTER|tc.PARA_FRAME_RIGHT_JUST))||Nj(a.flags2&tc.PF2_LEFT);if(a.canvas>0&&!C&&Dj(a.flags2&tc.PF2_INLINE)){R=a.canvas;if(Nj(kl[R].flags&tc.PARA_FRAME_IGNORE_X)){i=kl[R].OrgX;if(Nj(kl[R].flags&tc.PARA_FRAME_HPAGE)){E=G5(t.line);i-=to[E].LeftMargin*1440;L=true}}else if(Nj(kl[R].flags&tc.PARA_FRAME_HCOL)){i=kl[R].OrgX}else i=kl[R].x;i+=a.OrgX}else{if(Nj(a.flags&tc.PARA_FRAME_IGNORE_X)){i=a.OrgX;if(Nj(a.flags&tc.PARA_FRAME_HPAGE)){E=G5(t.line);i-=to[E].LeftMargin*1440;L=true}}else if(Nj(a.flags&tc.PARA_FRAME_HCOL)){i=a.OrgX}else i=a.x}if(!R5(t,"shpleft",tc.PARAM_INT,i))return false;if(!R5(t,"shpright",tc.PARAM_INT,i+a.width))return false;if(a.canvas>0&&Dj(a.flags2&tc.PF2_INLINE)){R=a.canvas;f=Nj(kl[R].flags&tc.PARA_FRAME_IGNORE_Y)?kl[R].OrgY:kl[R].ParaY;f+=a.ParaY}else{f=Nj(a.flags&tc.PARA_FRAME_IGNORE_Y)?a.OrgY:a.ParaY;if(Nj(a.flags2&tc.PF2_NO_OVERLAP)&&Nj(a.flags&tc.PARA_FRAME_SHPGRP)){f+=a.OverlapAddedY}}if(!R5(t,"shptop",tc.PARAM_INT,f))return false;if(!R5(t,"shpbottom",tc.PARAM_INT,f+a.height))return false;if(L)c=cj(c,tc.PARA_FRAME_HPAGE);if(Nj(c&tc.PARA_FRAME_HPAGE)){if(!R5(t,"shpbxpage",tc.PARAM_NONE,0))return false}else if(Nj(c&tc.PARA_FRAME_HCOL)){if(!R5(t,"shpbxcolumn",tc.PARAM_NONE,0))return false}else if(!R5(t,"shpbxmarg",tc.PARAM_NONE,0))return false;if(Nj(a.flags&tc.PARA_FRAME_VMARG)){if(!R5(t,"shpbymargin",tc.PARAM_NONE,0))return false;if(!R5(t,"shpbxignore",tc.PARAM_NONE,0))return false;if(!l5(t,"posrelv",0))return false}if(Nj(a.flags&tc.PARA_FRAME_VCENTER))l5(t,"posv",2);else if(Nj(a.flags2&tc.PF2_VBOTTOM))l5(t,"posv",1);else if(Nj(a.flags2&tc.PF2_VTOP))l5(t,"posv",3);if(Nj(a.flags&tc.PARA_FRAME_VPAGE)&&!R5(t,"shpbypage",tc.PARAM_NONE,0))return false;if(Dj(a.flags&(tc.PARA_FRAME_VPAGE|tc.PARA_FRAME_VMARG))&&!R5(t,"shpbypara",tc.PARAM_NONE,0))return false;if(Nj(a.flags&tc.PARA_FRAME_IGNORE_X)&&!R5(t,"shpbxignore",tc.PARAM_NONE,0))return false;if(Nj(a.flags&tc.PARA_FRAME_IGNORE_Y)&&!R5(t,"shpbyignore",tc.PARAM_NONE,0))return false;if(a.ShapeType==tc.SHPTYPE_LINE){if(!R5(t,"shpwr",tc.PARAM_INT,tc.SWRAP_IGNORE))return false;if(!R5(t,"shpwrk",tc.PARAM_INT,tc.WRAPSIDE_BOTH))return false}else{if(Nj(a.flags2&tc.PF2_HTML))R5(t,"shpwr",tc.PARAM_INT,tc.SWRAP_NO_WRAP);else{if(Nj(a.flags&tc.PARA_FRAME_NO_WRAP)&&!R5(t,"shpwr",tc.PARAM_INT,tc.SWRAP_NO_WRAP))return false;if(Nj(a.flags&tc.PARA_FRAME_WRAP_IGNORE)&&!R5(t,"shpwr",tc.PARAM_INT,tc.SWRAP_IGNORE))return false;if(Dj(a.flags&(tc.PARA_FRAME_NO_WRAP|tc.PARA_FRAME_WRAP_IGNORE))){if(!R5(t,"shpwr",tc.PARAM_INT,Nj(a.flags2&tc.PF2_WRAP_TIGHT)?tc.SWRAP_TIGHT:tc.SWRAP_AROUND))return false;if(!R5(t,"shpwrk",tc.PARAM_INT,tc.WRAPSIDE_BOTH))return false}}}if(a.ZOrder>=0&&!R5(t,"shpz",tc.PARAM_INT,a.ZOrder))return false;if(a.NextId>0||a.PrevId>0)R5(t,"shplid",tc.PARAM_INT,a.ShapeId);if(Nj(a.flags2&tc.PF2_BEHIND_DOC)||a.ZOrder<0||l==$l){if(!a5(t,"fBehindDocument","1"))return false}if(xs[e].FrameType==tc.PFRAME_LEFT&&!R5(t,"ssshpalignleft",tc.PARAM_NONE,0))return false;if(xs[e].FrameType==tc.PFRAME_RIGHT&&!R5(t,"ssshpalignright",tc.PARAM_NONE,0))return false;n=kl[l].ShapeType;if(o){if(!a5(t,"groupLeft","0"))return false;if(!a5(t,"groupTop","0"))return false;if(!a5(t,"groupRight",mY(a.width)))return false;if(!a5(t,"groupBottom",mY(a.height)))return false;if(Nj(a.flags&tc.PARA_FRAME_IN_CELL)){s="1";if(!a5(t,"fLayoutInCell",s))return false}}else{if(xs[e].ObjectType==tc.OBJ_OCX)n=tc.SHPTYPE_OCX;if(n==tc.SHPTYPE_RECT&&Nj(a.flags2&tc.PF2_EMPTY_TEXT_BOX))n=tc.SHPTYPE_TEXT_BOX;if(n==tc.SHPTYPE_RECT&&a.PointCount>0&&a.pPoint!=null)n=0;s=mY(n);if(n==tc.SHPTYPE_RECT&&a.PointCount>0&&a.pPoint!=null)s="0";if(n==tc.SHPTYPE_TEXT_BOX&&a.OrigShapeType!=0)s=mY(a.OrigShapeType);if(!a5(t,"shapeType",s))return false;f5(t,n,a)}if(Nj(a.flags&tc.PARA_FRAME_IGNORE_X)){if(Dj(a.flags&(tc.PARA_FRAME_RIGHT_JUST|tc.PARA_FRAME_CENTER))){if(!l5(t,"posh",0))return false}if(Nj(c&tc.PARA_FRAME_HPAGE)){if(!l5(t,"posrelh",1))return false}else if(Nj(a.flags2&tc.PF2_RIGHT_MARG)){if(!l5(t,"posrelh",5))return false}else if(Nj(c&tc.PARA_FRAME_HCOL)){if(!l5(t,"posrelh",2))return false}else if(Nj(c&tc.PARA_FRAME_HCHAR)){if(!l5(t,"posrelh",3))return false}else if(!l5(t,"posrelh",0))return false}if(Nj(a.flags&tc.PARA_FRAME_IGNORE_Y)){if(!l5(t,"posv",0))return false;if(Nj(a.flags2&tc.PF2_VBOT_MARG)){if(!l5(t,"posrelv",5))return false}else{if(Nj(a.flags&tc.PARA_FRAME_VPAGE)){if(!l5(t,"posrelv",1))return false}else if(Nj(a.flags&tc.PARA_FRAME_VMARG)){if(!l5(t,"posrelv",0))return false}else if(Nj(a.flags&tc.PARA_FRAME_VLINE)){if(!l5(t,"posrelv",3))return false}else if(!l5(t,"posrelv",2))return false}}if(Nj(a.flags2&tc.PF2_INLINE)){if(!l5(t,"fPseudoInline",1))return false}if(Nj(a.flags2&tc.PF2_HIDDEN)){if(!l5(t,"fHidden",1))return false}if(Nj(a.flags2&tc.PF2_SIZE_TO_TEXT)){if(!l5(t,"fFitShapeToText",1))return false}if(Nj(a.flags2&tc.PF2_NO_OVERLAP)&&Dj(a.flags&tc.PARA_FRAME_SHPGRP)){if(!l5(t,"fAllowOverlap",0))return false}if(o){S5(t);if(!I5(t))return false;if(!R5(t,"shp",tc.PARAM_NONE,0))return false;if(!I5(t))return false;if(!R5(t,"*",tc.PARAM_NONE,0))return false;if(!R5(t,"shpinst",tc.PARAM_NONE,0))return false;if(n==tc.SHPTYPE_RECT&&a.PointCount>0&&a.pPoint!=null){if(!a5(t,"geoRight",mY(a.width)))return false;if(!a5(t,"geoBottom",mY(a.height)))return false}i=0;f=0;if(!a5(t,"relLeft",mY(i)))return false;if(!a5(t,"relTop",mY(f)))return false;i+=a.width;f+=a.height;if(!a5(t,"relRight",mY(i)))return false;if(!a5(t,"relBottom",mY(f)))return false;n=kl[l].ShapeType;if(n==tc.SHPTYPE_RECT&&a.PointCount>0&&a.pPoint!=null)n=0;s=mY(n);if(!a5(t,"shapeType",s))return false;f5(t,n,a)}if(n==tc.SHPTYPE_TEXT_BOX&&a.PrevId==0){var I,d=a.FirstLine,F=a.LastLine;var g=l;var P=t.PrevPfmt;var S=t.PrevCell;var h=t.PrevFID;if(a.FirstLine<0||a.LastLine<0||ui[a.FirstLine].fid!=l||ui[a.LastLine].fid!=l){a.FirstLine=-1;for(I=0;I<Ri;I++){if(ui[I].fid==l){if(a.FirstLine==-1)d=a.FirstLine=I;F=a.LastLine=I;continue}else if(a.FirstLine!=-1)break}}while(true){F=kl[g].LastLine;if(kl[g].NextId==0)break;g=kl[g].NextId;if(g==0||kl[g].ShapeType!=tc.SHPTYPE_TEXT_BOX)break}if(a.FirstLine>=0){if(!I5(t))return false;if(!R5(t,"shptxt",tc.PARAM_NONE,0))return false;_=a3(t,l,a.FirstLine,0,F,ui[F].len);if(!d5(t))return false}t.PrevPfmt=P;t.PrevCell=S;t.PrevFID=h}if(Nj(xs[e].LinkFile)&&xs[e].ObjectType==tc.OBJ_NONE&&Dj(zh&tc.TFLAG_IGNORE_PICT_LINK)){s=Zk(xs[e].LinkFile,2);t.flags|=tc.ROFLAG_IGNORE_SLASH;if(!a5(t,"pibName",s))return false;t.flags=cj(t.flags,tc.ROFLAG_IGNORE_SLASH);if(!a5(t,"pibFlags","14"))return false}else{if(xs[e].PictType!=tc.PICT_SHAPE){if(!a5(t,"pib",null))return false;t.flags|=tc.ROFLAG_NO_ANIM;if(!n5(t,e,false))return false;t.flags=cj(t.flags,tc.ROFLAG_NO_ANIM);if(!d5(t))return false;if(!d5(t))return false}}if(xs[e].ObjectType!=tc.OBJ_NONE&&xs[e].ObjectType!=tc.OBJ_EMBED_TEMP){if(!I5(t))return false;if(!R5(t,"shptxt",tc.PARAM_NONE,0))return false;Q3(t,e);if(!d5(t))return false}if(o){if(!d5(t))return false;if(!d5(t))return false}if(l==$l||Nj(kl[l].flags&tc.PARA_FRAME_WATERMARK)){if(ta!=null){if(!a5(t,"pictureContrast","19661"))return false;if(!a5(t,"pictureBrightness","22938"))return false}if(!a5(t,"wzName",l==$l?"TerPictureWatermark":"WordPictureWatermark3"))return false;if(!a5(t,"posh","2"))return false;if(!a5(t,"posrelh","0"))return false;if(!a5(t,"posrelv","0"))return false}if(!d5(t))return false;if(!o&&xs[e].PictType!=tc.PICT_SHAPE){if(!I5(t))return false;if(!R5(t,"shprslt",tc.PARAM_NONE,0))return false;if(xs[e].ObjectType==tc.OBJ_NONE||xs[e].ObjectType==tc.OBJ_EMBED_TEMP)_=n5(t,e,false);else _=Q3(t,e);if(!_)return false;if(!d5(t))return false}if(!d5(t))return false;if(A){if(!d5(t))return false;c5(t,e)}return true}function f5(t,e,r){var i;var f;var l;if(e==0&&r.PointCount>0&&r.pPoint!=null&&r.SegmentCount>0&&r.pSegment!=null){var a;a5(t,"pVerticies",null);f=r.PointCount;i=SY("8;%d",f);if(!C5(t,i,i.length))return false;for(a=0;a<f;a++){l=t.flags;i=SY(";(%d,%d)",r.pPoint[a].x,r.pPoint[a].y);t.flags|=tc.ROFLAG_NO_CRLF;if(!C5(t,i,i.length))return false;t.flags=l;if(a>0&&a%15==0)S5(t)}if(!d5(t))return false;if(!d5(t))return false;a5(t,"pSegmentInfo",null);f=r.SegmentCount;i=SY("2;%d",f);if(!C5(t,i,i.length))return false;for(a=0;a<f;a++){l=t.flags;i=SY(";%d",r.pSegment[a]);t.flags|=tc.ROFLAG_NO_CRLF;if(!C5(t,i,i.length))return false;t.flags=l;if(a>0&&a%25==0)S5(t)}if(!d5(t))return false;if(!d5(t))return false;e=tc.SHPTYPE_RECT}if(e==tc.SHPTYPE_LINE){if(Nj(r.flags&tc.PARA_FRAME_NO_LINE)){if(!a5(t,"fLine","0"))return false}if(Nj(r.flags2&tc.PF2_FLIPH)&&!a5(t,"fFlipH","1"))return false;if(Nj(r.flags2&tc.PF2_FLIPV)&&!a5(t,"fFlipV","1"))return false;if(Nj(r.flags2&tc.PF2_START_ARROW)&&!a5(t,"lineStartArrowhead","1"))return false;if(Nj(r.flags2&tc.PF2_END_ARROW)&&!a5(t,"lineEndArrowhead","1"))return false}else{i=mY(Nj(r.flags&tc.PARA_FRAME_BOXED)&&r.LineWdth>0?1:0);if(!a5(t,"fLine",i))return false}if(e==tc.SHPTYPE_LINE||Nj(r.flags&tc.PARA_FRAME_BOXED)){i=mY(BV(r.LineWdth));if(!a5(t,"lineWidth",i))return false;if(r.LineColor!=null){i=mY(pJ(r.LineColor));if(!a5(t,"lineColor",i))return false}if(Nj(r.flags&tc.PARA_FRAME_DOTTED)){i="6";if(!a5(t,"lineDashing",i))return false}if(r.LineOpacity>0){i=mY((r.LineOpacity-1)*256);if(!a5(t,"lineOpacity",i))return false}}if(e==tc.SHPTYPE_RECT||e==tc.SHPTYPE_TEXT_BOX||e==tc.SHPTYPE_ELLIPSE||e==tc.SHPTYPE_ROUND_RECT){i=mY(r.FillPattern==0?0:1);if(!a5(t,"fFilled",i))return false;if(r.FillPattern>0&&r.BackColor!=null){i=mY(pJ(r.BackColor));if(!a5(t,"fillColor",i))return false}if(r.FillOpacity>0){i=mY((r.FillOpacity-1)*256);if(!a5(t,"fillOpacity",i))return false}}if(Nj(r.flags&tc.PARA_FRAME_IN_CELL)){i="1";if(!a5(t,"fLayoutInCell",i))return false}if(Nj(r.flags2&tc.PF2_NO_OVERLAP)&&Dj(r.flags&tc.PARA_FRAME_SHPGRP)){if(!l5(t,"fAllowOverlap",0))return false}if(Nj(r.flags&tc.PARA_FRAME_RIGHT_JUST)){if(!a5(t,"posh","3"))return false}else if(Nj(r.flags&tc.PARA_FRAME_CENTER)){if(!a5(t,"posh","2"))return false}if(e==tc.SHPTYPE_TEXT_BOX){if(r.TextAngle!=0){i=mY(r.TextAngle==90?tc.TEXTFLOW_B2T:tc.TEXTFLOW_T2B);if(!a5(t,"txflTextFlow",i))return false}}if(r.NextId>0||r.PrevId>0){if(r.NextShapeId>0&&!l5(t,"hspNext",r.NextShapeId))return false}if(r.AdjVal1!=0)l5(t,"adjustValue",r.AdjVal1);if(r.AdjVal2!=0)l5(t,"adjust2Value",r.AdjVal2);if(r.rotation!=0)l5(t,"rotation",r.rotation);var n=r.pict;if(n>0){if(xs[n].CropLeftFixed!=0)l5(t,"cropFromLeft",xs[n].CropLeftFixed);if(xs[n].CropRightFixed!=0)l5(t,"cropFromRight",xs[n].CropRightFixed);if(xs[n].CropTopFixed!=0)l5(t,"cropFromTop",xs[n].CropTopFixed);if(xs[n].CropBotFixed!=0)l5(t,"cropFromBottom",xs[n].CropBotFixed)}return true}function l5(t,e,r){return a5(t,e,mY(r))}function a5(t,e,r){S5(t);if(!I5(t))return false;if(!R5(t,"sp",tc.PARAM_NONE,0))return false;if(!I5(t))return false;if(!R5(t,"sn",tc.PARAM_NONE,0))return false;if(!C5(t,e,e.length))return false;if(!d5(t))return false;if(!I5(t))return false;if(!R5(t,"sv",tc.PARAM_NONE,0))return false;if(r==null)return true;if(!C5(t,r,r.length))return false;if(!d5(t))return false;if(!d5(t))return false;return true}function n5(t,e,r){var i=false;var f=false;var l;var a=true;var n;var c;t.flags=cj(t.flags,tc.ROFLAG_ORIG_PICT_WRITTEN);l=xs[e].anim;if(l!=null){if(Dj(t.flags&tc.ROFLAG_IN_ANIM)&&(xs[e].anim.FirstPict==0||xs[e].anim.FirstPict==e))i=true;else f=true}n=Nj(xs[e].LinkFile)&&xs[e].LinkFile.indexOf(".tc.GIF")>=0&&(i||f);if(true||n)i=f=false;if(i||f){if(!I5(t))return false;if(f){if(!R5(t,"*",tc.PARAM_NONE,0))return false;if(!R5(t,"ssanimseq",tc.PARAM_NONE,0))return false}if(!R5(t,"ssanimdelay",tc.PARAM_INT,l.delay))return false;if(i&&!R5(t,"ssanimloops",tc.PARAM_INT,l.OrigLoopCount))return false}if(!r&&Nj(xs[e].LinkFile)&&Dj(zh&tc.TFLAG_IGNORE_PICT_LINK)){a=A5(t,e);t.flags|=tc.ROFLAG_ORIG_PICT_WRITTEN}else{if(xs[e].PictType==tc.PICT_CONTROL)a=T5(t,e);else if(xs[e].PictType==tc.PICT_FORM)a=o5(t,e,true);else if(xs[e].PictType==tc.PICT_IMAGE){a=_5(t,e,xs[e].OrigPictType,xs[e].PictData);t.flags|=tc.ROFLAG_ORIG_PICT_WRITTEN}}if((i||f)&&!d5(t))return false;if(i&&Dj(t.flags&tc.ROFLAG_NO_ANIM))c5(t,e);return a}function c5(t,e){var r;var i;t.flags|=tc.ROFLAG_IN_ANIM;r=e;while(true){i=xs[r].anim;if(i==null)break;r=i.NextPict;if(r==0||xs[r].anim==null)break;if(!n5(t,r,false))break}t.flags=cj(t.flags,tc.ROFLAG_IN_ANIM);return true}function s5(t,e){var r=false;var i="";i="";_i.TerPictAltInfo(e,true,i);i=PP;if(i!=null&&i.length>0)r=true;if(r){var f=xs[e].ParaFID;if(f>0)r=false}if(!r)return true;if(!I5(t))return false;if(!R5(t,"*",tc.PARAM_NONE,0))return false;if(!R5(t,"picprop",tc.PARAM_NONE,0))return false;if(i.length>0)a5(t,"wzDescription",i);if(!d5(t))return false;return true}function _5(t,e,r,i){var f=true;var l,a,n,c,s,_,o;var u,T;var A;var E;if(xs[e].image==null)return false;if(r==tc.PICT_JPEG)E="jpegblip";else if(r==tc.PICT_PNG)E="pngblip";else if(r==tc.PICT_ENHMETAFILE)E="emfblip";else if(r==tc.PICT_METAFILE)E="wmetafile8";else{E="pngblip"}A=i.length;S5(t);if(Dj(lO&tc.TFLAG11_NO_SHPPICT)&&xs[e].ParaFID==0){if(!I5(t))return false;if(!R5(t,"*",tc.PARAM_NONE,0))return false;if(!R5(t,"shppict",tc.PARAM_NONE,0))return false}a=xs[e].PictHeight;n=xs[e].PictWidth;c=gV(xs[e].bmWidth);s=vV(xs[e].bmHeight);if(!I5(t))return false;if(!R5(t,"pict",tc.PARAM_NONE,0))return false;if(!s5(t,e))return false;if(!R5(t,E,tc.PARAM_INT,0))return false;_=c;if(xs[e].OrigPictWidth!=0)_=xs[e].OrigPictWidth;if(_>=32768)_=2e4;u=Mj(xs[e].PictWidth,100,_-xs[e].CropLeft-xs[e].CropRight);o=s;if(xs[e].OrigPictHeight!=0)o=xs[e].OrigPictHeight;if(o>=32768)o=2e4;T=Mj(xs[e].PictHeight,100,o-xs[e].CropTop-xs[e].CropBot);if(xs[e].ParaFID>0){u=T=0}if(xs[e].CropLeft!=0&&!R5(t,"piccropl",tc.PARAM_INT,xs[e].CropLeft))return false;if(xs[e].CropRight!=0&&!R5(t,"piccropr",tc.PARAM_INT,xs[e].CropRight))return false;if(xs[e].CropTop!=0&&!R5(t,"piccropt",tc.PARAM_INT,xs[e].CropTop))return false;if(xs[e].CropBot!=0&&!R5(t,"piccropb",tc.PARAM_INT,xs[e].CropBot))return false;if(!R5(t,"picw",tc.PARAM_INT,xs[e].bmWidth))return false;if(!R5(t,"pich",tc.PARAM_INT,xs[e].bmHeight))return false;if(u==0){if(!R5(t,"picwgoal",tc.PARAM_INT,xs[e].PictWidth))return false;if(!R5(t,"picscalex",tc.PARAM_INT,100))return false}else{if(!R5(t,"picwgoal",tc.PARAM_INT,_))return false;if(!R5(t,"picscalex",tc.PARAM_INT,u))return false}if(T==0){if(!R5(t,"pichgoal",tc.PARAM_INT,xs[e].PictHeight))return false;if(!R5(t,"picscaley",tc.PARAM_INT,100))return false}else{if(!R5(t,"pichgoal",tc.PARAM_INT,o))return false;if(!R5(t,"picscaley",tc.PARAM_INT,T))return false}if(!R5(t,"sspicalign",tc.PARAM_INT,xs[e].PictAlign))return false;if(Nj(qh&tc.TFLAG4_BINARY_RTF_PICT)){if(!R5(t,"bin",tc.PARAM_INT,A))return false;t.flags|=tc.ROFLAG_NO_CRLF;t.SpacePending=false}t:{var R=Uk(i);for(l=0;l<A;l++){if(Nj(qh&tc.TFLAG4_BINARY_RTF_PICT))f=P5(t,R[l]);else f=g5(t,R[l]);if(!f)break t}if(Nj(qh&tc.TFLAG4_BINARY_RTF_PICT))t.flags=cj(t.flags,tc.ROFLAG_NO_CRLF)}if(!d5(t))return false;if(Dj(lO&tc.TFLAG11_NO_SHPPICT)&&xs[e].ParaFID==0)d5(t);S5(t);return f}function o5(t,e,r){var i="";var f;var l=xs[e].form;var a=false;var n;if(!r&&l.CtlClass=="CheckBox")a=true;if(!I5(t))return false;if(!R5(t,"field",tc.PARAM_NONE,0))return false;if(!I5(t))return false;if(!R5(t,"*",tc.PARAM_NONE,0))return false;if(!R5(t,"fldinst",tc.PARAM_NONE,0))return false;if(xs[e].FieldId==tc.FIELD_CHECKBOX||a)i="FORMCHECKBOX";if(xs[e].FieldId==tc.FIELD_COMBOBOX)i="FORMDROPDOWN";if(i.length>0){if(!I5(t))return false;if(!C5(t,i,i.length))return false;if(!d5(t))return false}if(!I5(t))return false;if(!R5(t,"*",tc.PARAM_NONE,0))return false;if(!R5(t,"formfield",tc.PARAM_NONE,0))return false;f=0;if(xs[e].FieldId==tc.FIELD_CHECKBOX||a)f=1;if(xs[e].FieldId==tc.FIELD_COMBOBOX)f=2;if(f==0)return false;if(!R5(t,"fftype",tc.PARAM_INT,f))return false;if((xs[e].FieldId==tc.FIELD_CHECKBOX||a)&&xs[e].ctl!=null){n=xs[e].ctl;if(!R5(t,"ffres",tc.PARAM_INT,n.isSelected()?1:0))return false;if(!R5(t,"ffhps",tc.PARAM_INT,2*xs[e].PictHeight/20))return false}else if(xs[e].FieldId==tc.FIELD_COMBOBOX&&xs[e].ctl!=null){n=xs[e].ctl;var c,s=0,_=0;var o;s=n.getSelectedIndex();if(s>=0&&!R5(t,"ffres",tc.PARAM_INT,s))return false;if(!R5(t,"ffhaslistbox",tc.PARAM_NONE,0))return false;_=n.getItemCount();for(c=0;c<_;c++){o=n.getItemAt(c);if(o==null||o=="")o=" ";if(!I5(t))return false;if(!R5(t,"*",tc.PARAM_NONE,0))return false;if(!R5(t,"ffl",tc.PARAM_NONE,0))return false;if(!C5(t,o,o.length))return false;if(!d5(t))return false}}if(!I5(t))return false;if(!R5(t,"*",tc.PARAM_NONE,0))return false;if(!R5(t,"ffname",tc.PARAM_NONE,0))return false;if(l.name!=null&&!C5(t,l.name,l.name.length))return false;if(!d5(t))return false;if(!d5(t))return false;if(!d5(t))return false;if(!I5(t))return false;if(!R5(t,"fldrslt",tc.PARAM_NONE,0))return false;if(!d5(t))return false;if(!d5(t))return false;return true}function u5(t,e){var r="";var i;if(e==null)return false;r="FORMTEXT";if(!I5(t))return false;if(!C5(t,r,r.length))return false;if(!d5(t))return false;if(!I5(t))return false;if(!R5(t,"*",tc.PARAM_NONE,0))return false;if(!R5(t,"formfield",tc.PARAM_NONE,0))return false;i=0;if(!R5(t,"fftype",tc.PARAM_INT,i))return false;var f=TK(e,0,gk("|"));var l=LX(f);if(l>0&&!R5(t,"ffmaxlen",tc.PARAM_INT,l))return false;if(!I5(t))return false;if(!R5(t,"*",tc.PARAM_NONE,0))return false;if(!R5(t,"ffdeftext",tc.PARAM_NONE,0))return false;if(!C5(t," ",1))return false;if(!d5(t))return false;if(!I5(t))return false;if(!R5(t,"*",tc.PARAM_NONE,0))return false;if(!R5(t,"ffname",tc.PARAM_NONE,0))return false;var a=TK(e,1,gk("|"));if(!C5(t,a,a.length))return false;if(!d5(t))return false;if(!d5(t))return false;return true}function T5(t,e){var r=true;var i,f,l;var a=xs[e].PictData;var n=xs[e].form;f=xs[e].PictHeight;l=xs[e].PictWidth;if(n!=null&&n.CtlClass=="CheckBox")return o5(t,e,false);if(!I5(t))return false;if(!R5(t,"*",tc.PARAM_NONE,0))return false;if(!R5(t,"sscontrol",tc.PARAM_NONE,0))return false;if(!R5(t,"ssctl",tc.PARAM_NONE,0))return false;if(n!=null&&n.CtlClass!=null){if(!a5(t,"ssctlclass",n.CtlClass))return false}if(!R5(t,"picw",tc.PARAM_INT,xs[e].bmWidth))return false;if(!R5(t,"pich",tc.PARAM_INT,xs[e].bmHeight))return false;if(!R5(t,"picwgoal",tc.PARAM_INT,l))return false;if(!R5(t,"pichgoal",tc.PARAM_INT,f))return false;if(!R5(t,"sspicalign",tc.PARAM_INT,xs[e].PictAlign))return false;if(Nj(qh&tc.TFLAG4_BINARY_RTF_PICT)){if(!R5(t,"bin",tc.PARAM_INT,a.length))return false;t.flags|=tc.ROFLAG_NO_CRLF;t.SpacePending=false}t:{if(a!=null){for(i=0;i<a.length;i++){if(Nj(qh&tc.TFLAG4_BINARY_RTF_PICT))r=P5(t,a[i]);else r=g5(t,a[i]);if(!r)break t}}if(Nj(qh&tc.TFLAG4_BINARY_RTF_PICT))t.flags=cj(t.flags,tc.ROFLAG_NO_CRLF)}if(!d5(t))return false;return r}function A5(t,e){if(!I5(t))return false;if(!R5(t,"sslinkpictw",tc.PARAM_INT,xs[e].PictWidth))return false;if(!R5(t,"sslinkpicth",tc.PARAM_INT,xs[e].PictHeight))return false;if(!I5(t))return false;if(!R5(t,"field",tc.PARAM_NONE,0))return false;if(!I5(t))return false;if(!R5(t,"*",tc.PARAM_NONE,0))return false;if(!R5(t,"fldinst",tc.PARAM_NONE,0))return false;JO="INCLUDEPICTURE ";t.flags|=tc.ROFLAG_NO_CRLF;if(!C5(t,JO,JO.length))return false;t.flags=cj(t.flags,tc.ROFLAG_NO_CRLF);var r=xs[e].LinkFile;if(Nj(tO&tc.TFLAG6_DONT_WRITE_PICT_PATH)){var i=LinkFILE_LENGTH,f;if(i>0){var l=Uk(r);for(f=i-1;f>=0;f--){if(l[f]==tc.BACK_SLASH||l[f]==gk(":"))break}if(f>=0)r=cV(r,f+1)}}var a;a=Zk(r,4);if(a.indexOf(" ")>=0)a=zk(a);a+=" \\\\d";t.flags|=tc.ROFLAG_IGNORE_SLASH|tc.ROFLAG_NO_FLUSH|tc.ROFLAG_NO_CRLF;if(!C5(t,a,a.length))return false;t.flags=t.flags=cj(t.flags,tc.ROFLAG_IGNORE_SLASH|tc.ROFLAG_NO_FLUSH|tc.ROFLAG_NO_CRLF);if(!d5(t))return false;if(!I5(t))return false;if(!R5(t,"fldrslt",tc.PARAM_NONE,0))return false;if(xs[e].PictAlt!=null&&xs[e].PictAlt.length>0)E5(t,xs[e].PictAlt);if(!d5(t))return false;if(!d5(t))return false;if(!d5(t))return false;return true}function E5(t,e){if(!I5(t))return false;if(!R5(t,"pict",tc.PARAM_NONE,0))return false;if(!I5(t))return false;if(!R5(t,"*",tc.PARAM_NONE,0))return false;if(!R5(t,"picprop",tc.PARAM_NONE,0))return false;a5(t,"wzDescription",e);if(!d5(t))return false;if(!d5(t))return false;return true}function R5(t,e,r,i){var f;if(arguments.length!=4||typeof e!="string"||typeof r!="number"||typeof i!="number")console.trace();if(i%1!=0)i=Math.round(i);t.SpacePending=false;t.WritingControl=true;if(!P5(t,tc.BACK_SLASH))return false;if(!C5(t,e,e.length))return false;if(r==tc.PARAM_INT){f=mY(i);if(!C5(t,f,f.length))return false}else if(r==tc.PARAM_DBL){f=i.toString();if(!C5(t,f,f.length))return false}t.SpacePending=true;t.WritingControl=false;return true}function L5(t,e){if(e<=0||e>=Ac||!ac[e].InUse)return true;while(Nj(e)){if(e<=0||e>=Ac||!ac[e].InUse)return true;if(ac[e].type==tc.TERTAG_BKM){if(!I5(t))return false;if(!R5(t,"*",tc.PARAM_NONE,0))return false;if(!R5(t,"bkmkstart",tc.PARAM_NONE,0))return false;if(!C5(t,ac[e].name,ac[e].name.length))return false;if(!d5(t))return false;if(!I5(t))return false;if(!R5(t,"*",tc.PARAM_NONE,0))return false;if(!R5(t,"bkmkend",tc.PARAM_NONE,0))return false;if(!C5(t,ac[e].name,ac[e].name.length))return false;if(!d5(t))return false}else if(ac[e].type==tc.TERTAG_USER){if(!I5(t))return false;if(!R5(t,"*",tc.PARAM_NONE,0))return false;if(!R5(t,"sstag",tc.PARAM_NONE,0))return false;if(!C5(t,ac[e].name,ac[e].name.length))return false;if(!R5(t,"sstagint",tc.PARAM_INT,ac[e].AuxInt))return false;var r=ac[e].AuxText;if(r!=null&&r.length>0&&!C5(t,r,r.length))return false;if(!d5(t))return false}e=ac[e].next}return true}function C5(t,e,r){var i;var f;var l=34;var a=Nj(t.flags&tc.ROFLAG_IGNORE_SLASH);var n=Nj(t.flags&tc.ROFLAG_IS_FNOTEAUTO);if(typeof e=="string")e=Uk(e);if(Nj(t.flags&tc.ROFLAG_IN_FIELD_TC)&&Dj(t.WritingControl))a=true;if(r==0)return true;for(i=0;i<r;i++){f=e[i];if(f==13||f==10||f==tc.HIDDEN_CHAR||tg.InIE&&f==l){if(f==tc.HIDDEN_CHAR&&Dj(rO&tc.TFLAG8_DONT_HIDE_HIDDEN_CHAR))R5(t,"v",tc.PARAM_NONE,0);if(!F5(t,f))return false;if(f==tc.HIDDEN_CHAR&&Dj(rO&tc.TFLAG8_DONT_HIDE_HIDDEN_CHAR))R5(t,"v",tc.PARAM_INT,1);continue}if(n){t.flags=cj(t.flags,tc.ROFLAG_IS_FNOTEAUTO);if(i==0)R5(t,"chftn",tc.PARAM_NONE,0);continue}if(f==tc.BACK_SLASH&&!a||f==tc.LEFT_BRACE||f==tc.RIGHT_BRACE||f==tc.NBSPACE_CHAR||f==tc.NBDASH_CHAR||f==tc.HYPH_CHAR){if(!P5(t,tc.BACK_SLASH))return false;t.flags|=tc.ROFLAG_NO_FLUSH}if(f==tc.TAB){if(!R5(t,"tab",tc.PARAM_NONE,0))return false}else if(f==tc.ZWNJ_CHAR){if(!R5(t,"zwnj",tc.PARAM_NONE,0))return false}else if(f==tc.NBSPACE_CHAR){if(!P5(t,gk("~")))return false}else if(f==tc.NBDASH_CHAR){if(!P5(t,tc.UNDERSCORE))return false}else if(f==tc.HYPH_CHAR){if(!P5(t,tc.HYPH))return false}else if(f==tc.PAGE_CHAR){if(!R5(t,"page",tc.PARAM_NONE,0))return false;if(t.line+1<Ri&&ui[t.line].cid==0&&ui[t.line+1].cid>0){if(!R5(t,"par",tc.PARAM_NONE,0))return false}}else if(f==tc.COL_CHAR){if(!R5(t,"column",tc.PARAM_NONE,0))return false}else if(f==tc.HPARA_CHAR){if(!R5(t,"par",tc.PARAM_NONE,0))return false}else if(!P5(t,f))return false;t.flags=t.flags=cj(t.flags,tc.ROFLAG_NO_FLUSH)}return true}function I5(t){t.SpacePending=false;if(t.GroupLevel+1<tc.MAX_RTF_GROUPS){t.GroupLevel++;t.group[t.GroupLevel]=t.group[t.GroupLevel-1]}return P5(t,tc.LEFT_BRACE)}function d5(t){t.SpacePending=false;if(t.GroupLevel>0)t.GroupLevel--;return P5(t,tc.RIGHT_BRACE)}function F5(t,e){if(Nj(fO&tc.TFLAG10_DST)){if(e==183)e=149}if(!P5(t,tc.BACK_SLASH))return false;t.flags|=tc.ROFLAG_NO_FLUSH;if(!P5(t,gk("'")))return false;if(!g5(t,e))return false;t.flags=cj(t.flags,tc.ROFLAG_NO_FLUSH);return true}function g5(t,e){var r,i,f;var l;r=(e&240)>>4;i=e&15;if(r<=9)f=tc.CHAR_0+r;else f=tc.CHAR_a+r-10;if(!P5(t,f))return false;if(i<=9)f=tc.CHAR_0+i;else f=tc.CHAR_a+i-10;l=t.WritingControl;t.WritingControl=true;if(!P5(t,f))return false;t.WritingControl=l;return true}function P5(t,e){var r=Nj(t.flags&tc.ROFLAG_IGNORE_SLASH);if(arguments.length!=2||typeof e!="number")console.trace();if(e%1!=0)console.trace();if(t.SpacePending){t.text[t.TextLen]=tc.SPACE;t.TextLen++;t.SpacePending=false}if(!t.WritingControl&&Dj(t.flags&tc.ROFLAG_NO_FLUSH)){if(t.TextLen>tc.MAX_WIDTH/4&&t.text[t.TextLen-1]==tc.SPACE&&!S5(t))return false;if(t.TextLen>tc.MAX_WIDTH/3&&!S5(t))return false}if(e==tc.BACK_SLASH&&!r&&t.TextLen>tc.MAX_WIDTH/2)if(!S5(t))return false;if(t.TextLen+2>tc.MAX_WIDTH)if(!S5(t))return false;if(e>=0&&e<=255){if(e<128){t.text[t.TextLen]=e;t.TextLen++}else F5(t,e)}else{if(Nj(lO&tc.TFLAG11_WRITE_RTF_UNICODE_VAL)){if(!R5(t,"u",tc.PARAM_INT,e))return false;if(!C5(t,"?",1))return false}else{var i=false;if(Nj(fO&tc.TFLAG10_DST)){i=true;if(e==8212){if(!R5(t,"u",tc.PARAM_INT,e))return false;F5(t,151)}else if(e==8220){if(!R5(t,"u",tc.PARAM_INT,e))return false;F5(t,147)}else if(e==8221){if(!R5(t,"u",tc.PARAM_INT,e))return false;F5(t,148)}else if(e==8226){if(!R5(t,"u",tc.PARAM_INT,e))return false;F5(t,149)}else if(e==8225){if(!R5(t,"u",tc.PARAM_INT,e))return false;F5(t,135)}else if(e==8249){if(!R5(t,"u",tc.PARAM_INT,e))return false;F5(t,139)}else if(e==8250){if(!R5(t,"u",tc.PARAM_INT,e))return false;F5(t,155)}else if(e==8482){if(!R5(t,"u",tc.PARAM_INT,e))return false;F5(t,153)}else if(e==9679){if(!R5(t,"u",tc.PARAM_INT,e))return false;if(!C5(t,wY(183),1))return false}else i=false}if(!i){if(e==8216)R5(t,"lquote",tc.PARAM_NONE,0);else if(e==8217)R5(t,"rquote",tc.PARAM_NONE,0);else if(e==8220)R5(t,"ldblquote",tc.PARAM_NONE,0);else if(e==8221)R5(t,"rdblquote",tc.PARAM_NONE,0);else if(e==8212)R5(t,"emdash",tc.PARAM_NONE,0);else if(e==8211)R5(t,"endash",tc.PARAM_NONE,0);else{if(!R5(t,"u",tc.PARAM_INT,e))return false;if(!C5(t,"?",1))return false}}}}return true}function S5(t){var e;if(t.TextLen==0)return true;if(t.SpacePending){t.text[t.TextLen]=tc.SPACE;t.TextLen++;t.SpacePending=false}if(Dj(t.flags&tc.ROFLAG_NO_CRLF)&&Dj(fO&tc.TFLAG10_NO_CRLF)){t.text[t.TextLen]=13;t.TextLen++;t.text[t.TextLen]=10;t.TextLen++}else if(Nj(fO&tc.TFLAG10_NO_CRLF)&&t.SpacePending){t.text[t.TextLen]=tc.SPACE;t.TextLen++;t.SpacePending=false}if(false){try{var r=t.TextLen;var i=[r];for(e=0;e<r;e++)i[e]=t.text[e]}catch(t){return QY(tc.MSG_ERR_FILE_WRITE,"FlushRtfLine")}}else{if(t.BufIndex+t.TextLen+1>t.BufLen){t.BufLen=t.BufLen+t.BufLen/4;if(t.BufLen<t.BufIndex+t.TextLen+1)t.BufLen=t.BufIndex+t.TextLen+1;t.buf=fV(t.buf,t.BufLen)}for(e=0;e<t.TextLen;e++)t.buf[t.BufIndex+e]=t.text[e];t.BufIndex=t.BufIndex+t.TextLen}t.TextLen=0;t.SpacePending=false;return true}function h5(t){return 0}_i.TerSetSect=function(t,e,r){return _i.TerSetSectEx(t,e,r,0)};_i.TerSetSectEx=function(t,e,r,i){if(!lv||!QD())_i.TerCreateControl();return O5(t,e,r,i,false,0,0,-1,-1,false,true)};_i.TerSetSect2=function(t,e,r,i,f,l){if(!lv||!QD())_i.TerCreateControl();return O5(t,e,r,i,true,f,l,-1,-1,false,true)};_i.TerSetSect3=function(t,e,r,i,f,l,a,n,c){if(!lv||!QD())_i.TerCreateControl();return O5(t,e,r,i,true,l,a,n,c,false,true)};_i.TerSetSect3=function(t,e,r,i,f,l,a,n,c,s){if(!lv||!QD())_i.TerCreateControl();return O5(t,e,r,i,f,l,a,n,c,true,s)};function O5(t,e,r,i,f,l,a,n,c,s,_){var o;if(t!=0){B5();if(n<0||n>=ro)n=G5(br);if(t>0)to[n].columns=t;to[n].ColumnSpace=VV(e);if(r)to[n].flags|=tc.SECT_NEW_PAGE;else to[n].flags=cj(to[n].flags,tc.SECT_NEW_PAGE);if(i>0){to[n].flags|=tc.SECT_RESTART_PAGE_NO;to[n].FirstPageNo=i}else to[n].flags=cj(to[n].flags,tc.SECT_RESTART_PAGE_NO);if(f)to[n].FirstPageBin=l;if(f)to[n].bin=a;if(c!=-1){}if(s)to[n].IsPortrait=_;return v5(n)}n=G5(br);var u=_i.DlgCompHeight;var T=_i.DlgFont;var A=new $t.DialogBox(te,"Edit Picture Parameters",T,true,X);var E=A.cvs;metric=Nj(zh&tc.TFLAG_METRIC);A.addGroupBox(0,0,4,2,"Column",T,0,JV(10),0,0);e=0;if(metric)e=lj(to[n].ColumnSpace);else e=to[n].ColumnSpace;var R=new $t.Label(E,0,0,T,"Number of Columns");A.addComp(R,1,0,1,1,"left","middle",JV(10));var L=new $t.TextBox(E,0,0,JV(60),u,to[n].columns.toString(),T,_i.caret,false,true,null);A.addComp(L,1,1,1,1,"left","middle",JV(10));var C=new $t.Label(E,0,0,T,"Space Between the");A.addComp(C,2,0,1,1,"left","top",JV(10));var I=new $t.Label(E,0,0,T,"Columns "+(metric?"(cm)":"(Inches)"));A.addComp(I,2,0,1,1,"left","bottom",JV(10),-JV(10));var d=new $t.TextBox(E,0,0,JV(60),u,AX(e,2),T,_i.caret,false,true,null);A.addComp(d,2,1,1,1,"left","top",JV(10));var F=new $t.CheckBox(E,0,0,JV(15),JV(16),T,"Line Between Columns",Nj(to[n].flags&tc.SECT_LINE_BET_COL),null);A.addComp(F,3,0,1,2,"Left","middle",JV(10));A.addGroupBox(0,2,4,1,"Text Flow",T,0,JV(10),0,0);var g=to[n].flow;var P=new $t.RadioButton(E,0,0,JV(15),T,"Default",g==tc.FLOW_DEF,null,null);A.addComp(P,1,2,1,1,"left","bottom",JV(10),0,JV(70));var S=new $t.RadioButton(E,0,0,JV(15),T,"Right-to-left",g==tc.FLOW_RTL,P,null);A.addComp(S,2,2,1,1,"left","middle",JV(10),0);var h=new $t.RadioButton(E,0,0,JV(15),T,"Left-to-Right",g==tc.FLOW_LTR,S,null);A.addComp(h,3,2,1,1,"left","top",JV(10),0);A.addGroupBox(4,0,3,2,"",T,0,JV(10),0,0);var O=new $t.CheckBox(E,0,0,JV(15),JV(16),T,"Start Section on New Page",Nj(to[n].flags&tc.SECT_NEW_PAGE),null);A.addComp(O,5,0,1,2,"Left","bottom",JV(10),JV(5));var v=new $t.CheckBox(E,0,0,JV(15),JV(16),T,"Restart Page Number at",Nj(to[n].flags&tc.SECT_RESTART_PAGE_NO),N);A.addComp(v,6,0,1,1,"Left","middle",JV(10),0);var p=new $t.TextBox(E,0,0,JV(60),u,mY(to[n].FirstPageNo),T,_i.caret,false,true,null);A.addComp(p,6,1,1,1,"left","middle",JV(10),0);if(Dj(to[n].flags&tc.SECT_RESTART_PAGE_NO))p.setEnable(false);function N(t,e,r){p.setEnable(v.isSelected())}A.addGroupBox(4,2,3,1,"",T,0,JV(10),0,0);var D=new $t.Label(E,4,2,T,"Orientation");A.addComp(D,5,2,1,1,"left","top",JV(10),JV(-5));var M=new $t.RadioButton(E,0,0,JV(15),T,"Portrait",to[n].IsPortrait,null,null);A.addComp(M,5,2,1,1,"left","bottom",JV(20),JV(5));var G=new $t.RadioButton(E,0,0,JV(15),T,"Landscape",!to[n].IsPortrait,M,null);A.addComp(G,6,2,1,1,"left","middle",JV(20),0);A.addGroupBox(8,0,4,3,"Paper Size",T,0,JV(10),0,0);PaperSizeIdx=-1;var B,H;var m=tg.DefPaperCount-1;for(o=0;o<tg.DefPaperCount;o++){B=tg.DefPaperWidth[o];H=tg.DefPaperHeight[o];if(to[n].PprWidth==B&&to[n].PprHeight==H)PaperSizeIdx=o;else if(to[n].PprWidth==H&&to[n].PprHeight==B)PaperSizeIdx=o;if(PaperSizeIdx>=0)break}if(PaperSizeIdx<0)PaperSizeIdx=m;var w=new $t.ListBox(E,0,0,JV(200),JV(110),T,true,true,k);w.setItems(tg.DefPaperName,tg.DefPaperSize,PaperSizeIdx,false);A.addComp(w,9,0,3,1,"Left","top",JV(10),JV(10));var b=new $t.Label(E,0,0,T,"Width (inches)");A.addComp(b,9,1,1,1,"left","bottom",JV(10));var x=new $t.TextBox(E,0,0,JV(60),u,"0",T,_i.caret,false,true,null);A.addComp(x,9,2,1,1,"left","bottom",JV(10));var y=new $t.Label(E,0,0,T,"Height (inches)");A.addComp(y,10,1,1,1,"left","middle",JV(10));var W=new $t.TextBox(E,0,0,JV(60),u,"0",T,_i.caret,false,true,null);A.addComp(W,10,2,1,1,"left","middle",JV(10));U();function U(){var t,e;var r=false;if(PaperSizeIdx==m){t=to[n].PprWidth;e=to[n].PprHeight;r=true}else{t=tg.DefPaperWidth[PaperSizeIdx];e=tg.DefPaperHeight[PaperSizeIdx]}if(metric){b.setText("Width (cm)");y.setText("Height (cm)");x.setText(AX(lj(t),2));W.setText(AX(lj(e),2))}else{b.setText("Width (inches)");y.setText("Height (inches)");x.setText(AX(t,2));W.setText(AX(e,2))}b.setEnabled(PaperSizeIdx==m);y.setEnabled(PaperSizeIdx==m);x.setEnabled(PaperSizeIdx==m);W.setEnabled(PaperSizeIdx==m)}function k(t,e,r){PaperSizeIdx=w.getSelectedIdx();if(PaperSizeIdx<0)PaperSizeIdx=0;U()}if(!oi.PrintView){L.setEnabled(false);d.setEnabled(false);M.setEnabled(false);G.setEnabled(false);P.setEnabled(false);S.setEnabled(false);h.setEnabled(false);F.setEnabled(false)}A.show();L.setFocus();function X(t,e,r){if(t=="Cancel"){A.hide();return}else if(t=="OK"){if(oi.PrintView){if(!EX(this,"I",L,1,4))return;if(!EX(this,"F",d,.1,4))return;to[n].columns=LX(L);space=CX(d);if(metric)to[n].ColumnSpace=fj(space);else to[n].ColumnSpace=space;to[n].flags=cj(to[n].flags,tc.SECT_LINE_BET_COL);if(F.isSelected())to[n].flags|=tc.SECT_LINE_BET_COL;to[n].IsPortrait=M.isSelected();g=tc.FLOW_DEF;if(S.isSelected())g=tc.FLOW_RTL;else if(h.isSelected())g=tc.FLOW_LTR;to[n].flow=g}if(O.isSelected())to[n].flags|=tc.SECT_NEW_PAGE;else to[n].flags=cj(to[n].flags,tc.SECT_NEW_PAGE);if(v.isSelected()){to[n].flags|=tc.SECT_RESTART_PAGE_NO;to[n].FirstPageNo=LX(p);if(to[n].FirstPageNo<1)to[n].FirstPageNo=1}else to[n].flags=cj(to[n].flags,tc.SECT_RESTART_PAGE_NO);B=CX(x);if(metric)to[n].PprWidth=fj(B);else to[n].PprWidth=B;H=CX(W);if(metric)to[n].PprHeight=fj(H);else to[n].PprHeight=H;A.hide();return v5(n)}}}function v5(t){var e;oi.modified++;Ro=0;e=eo[t].PrevSect;if(e>=0&&to[t].IsPortrait!=to[e].IsPortrait)to[t].flags|=tc.SECT_NEW_PAGE;b5();lo=true;if(oi.PrintView){cG();if(Fo>to[t].FirstLine-1)Fo=to[t].FirstLine-1;if(Fo<0)Fo=0;zQ()}return true}function p5(t){var e;if(Dj(Nc[ui[t].pfmt].flags&tc.PAGE_HDR_FTR))return true;if(Nj(ui[t].flags&(tc.LFLAG_HDRS|tc.LFLAG_FTRS)))return false;for(e=0;e<ro;e++){if(Nj(Nc[ui[t].pfmt].flags&tc.PAGE_HDR)){if(eo[e].hdr.used&&t>=eo[e].hdr.FirstLine&&t<=eo[e].hdr.LastLine)return true;if(eo[e].fhdr.used&&t>=eo[e].fhdr.FirstLine&&t<=eo[e].fhdr.LastLine)return true;if(eo[e].rhdr.used&&t>=eo[e].rhdr.FirstLine&&t<=eo[e].rhdr.LastLine)return true;if(eo[e].lhdr.used&&t>=eo[e].lhdr.FirstLine&&t<=eo[e].lhdr.LastLine)return true}else{if(eo[e].ftr.used&&t>=eo[e].ftr.FirstLine&&t<=eo[e].ftr.LastLine)return true;if(eo[e].fftr.used&&t>=eo[e].fftr.FirstLine&&t<=eo[e].fftr.LastLine)return true;if(eo[e].rftr.used&&t>=eo[e].rftr.FirstLine&&t<=eo[e].rftr.LastLine)return true;if(eo[e].lftr.used&&t>=eo[e].lftr.FirstLine&&t<=eo[e].lftr.LastLine)return true}}return false}function N5(t,e){var r;if(Dj(Nc[ui[t].pfmt].flags&tc.PAGE_HDR_FTR))return true;for(r=0;r<ro;r++){if(Nj(Nc[ui[t].pfmt].flags&tc.PAGE_HDR)){if(t>=eo[r].hdr.FirstLine&&t<=eo[r].hdr.LastLine){eo[r].hdr.used=e;return true}if(t>=eo[r].fhdr.FirstLine&&t<=eo[r].fhdr.LastLine){eo[r].fhdr.used=e;return true}if(t>=eo[r].rhdr.FirstLine&&t<=eo[r].rhdr.LastLine){eo[r].rhdr.used=e;return true}if(t>=eo[r].lhdr.FirstLine&&t<=eo[r].lhdr.LastLine){eo[r].lhdr.used=e;return true}}else{if(t>=eo[r].ftr.FirstLine&&t<=eo[r].ftr.LastLine){eo[r].ftr.used=e;return true}if(t>=eo[r].fftr.FirstLine&&t<=eo[r].fftr.LastLine){eo[r].fftr.used=e;return true}if(t>=eo[r].rftr.FirstLine&&t<=eo[r].rftr.LastLine){eo[r].rftr.used=e;return true}if(t>=eo[r].lftr.FirstLine&&t<=eo[r].lftr.LastLine){eo[r].lftr.used=e;return true}}}return false}_i.TerSectBreak=function(t){var e;var r;var i,f,l;var a;if(!lv||!QD())_i.TerCreateControl();if(!MY(Ri+1))return true;n9();if(ui[br].cid>0)return false;if(Nj(Nc[ui[br].pfmt].flags&tc.PAGE_HDR_FTR))return false;if(WR)return false;if(!Cm(br,jt))return false;if(jt>0)sm(0,false,false);iw(br,1,gk("B"));f=G5(br);for(i=0;i<ro;i++)if(!to[i].InUse)break;if(i==ro){if(ro>=fo){D5(-1);if(ro>=fo)return QY(tc.MSG_SECTION_FULL,"e.TerSectBreak")}ro++}to[i]=to[f].copy();eo[i]=eo[f].copy();to[i].LastLine=br;to[f].FirstLine=br+1;eo[f].hdr.FirstLine=-1;eo[f].ftr.FirstLine=-1;eo[f].PrevSect=i;l=eo[i].PrevSect;if(l>=0)eo[l].NextSect=i;Tm(br,0,1);e=ui[br].txt;r=nb(br);e[0]=tc.SECT_CHAR;r[0]=tc.DEFAULT_CFMT;if(br>0){var n=ui[br-1].len;if(n>0){var c=ib(br-1,n-1);if(xs[c].FieldId==0&&Dj(xs[c].style&tc.PICT))r[0]=c}}ui[br].flags|=tc.LFLAG_SECT;a="Section"+mY(i);Bx(br,0,tc.TERTAG_SECT,a,null,i);if(br>0&&Dj(ui[br-1].flags&tc.LFLAG_PARA))ui[br].pfmt=ui[br-1].pfmt;else ui[br].pfmt=0;ui[br].fid=0;if(xX(br)){ui[br].tabw.type=tc.INFO_SECT;ui[br].tabw.section=i}sb(br);br++;jt=0;if(br-fr>=Dt||br-fr<0){fr=br-Dt/2;if(fr<0)fr=0}we=br-fr;uA=tc.HILIGHT_OFF;oi.modified++;lo=true;_z(true);n9();if(t)cG();return true};_i.TerColBreak=function(t){var e;var r;if(!lv||!QD())_i.TerCreateControl();if(!MY(Ri+1))return true;n9();if(ui[br].cid>0)return false;if(Nj(Nc[ui[br].pfmt].flags&tc.PAGE_HDR_FTR))return false;iw(br,1,gk("B"));Tm(br,0,1);e=ui[br].txt;r=nb(br);e[0]=tc.COL_CHAR;r[0]=tc.DEFAULT_CFMT;sb(br);V8(br,0,br,0,tc.CHAR_I);br++;if(br-fr>=Dt||br-fr<0){fr=br-Dt/2;if(fr<0)fr=0}we=br-fr;uA=tc.HILIGHT_OFF;oi.modified++;if(t)cG();return true};function D5(t){var e;if(t<0)t=fo*3/2;to=fV(to,t);eo=fV(eo,t);for(e=fo;e<t;e++){to[e].init();eo[e].init()}fo=t;return true}function M5(t,e,r){var i,f,l,a,n=0;ud=Td=0;i=Ai*to[t].LeftMargin;f=Ai*to[t].RightMargin;l=Ai*eo[t].PgWidth-i-f;if(oi.FittedView)l=wV(je);a=to[e].columns;od=Ai*to[e].ColumnSpace;if(a==1)od=0;_d=(l-(a-1)*od)/a;if(Ci)ud=er+i;if(r==0)n=Ei*to[t].TopMargin;else n=Ei*to[t].HdrMargin;if(Ci){Td=n+rr}else if(yR){Td=n-eo[t].HiddenY}return true}function G5(t){var e;var r,i,f,l,a,n,c,s,_=-1;var o;var u;var T;if(!oi.WordWrap)return 0;if(ro==1)return 0;if(ao>=0&&t>=no&&t<=co)return ao;for(r=0;r<ro;r++){if(!to[r].InUse)continue;f=to[r].FirstLine;l=to[r].LastLine;if(f<0||f>=Ri)break;if(l<0||l>=Ri)break;if(f>l)break;c=eo[r].PrevSect;if(c>=0)a=to[c].LastLine;else a=-1;if(f!=a+1)break;s=eo[r].NextSect;if(s>=0)n=to[s].FirstLine;else n=Ri;if(l!=n-1)break;if(t>=f&&t<=l)_=r}if(r>=ro&&_>=0)return _;o=0;for(e=0;e<Ri;e++){i=ui[e].len;if(i>0&&ui[e].txt[i-1]==tc.SECT_CHAR){if(Vx(e,i-1,tc.TERTAG_SECT)>0){_=WC;to[_].LastLine=e;s=eo[_].NextSect;if(s>=0)to[s].FirstLine=e+1;if(o==0)to[_].FirstLine=0;o++}}}to[0].LastLine=Ri-1;for(r=1;r<ro;r++){if(to[r].InUse&&t>=to[r].FirstLine&&t<=to[r].LastLine)return r}return 0}function B5(){var t,e;var r,i=0,f,l=0;var a,n=0,c,s=0;var _,o=0,u,T=0;var A,E=0,R,L=0;var C,I,d,F=-1,g,P;var S=false;var h;var O;var v;if(!oi.WordWrap)return false;for(C=0;C<ro;C++)to[C].InUse=false;e=0;d=Ro;r=f=-1;a=c=-1;_=u=-1;A=R=-1;for(t=0;t<Ri;t++){if(Nj(ui[t].flags&tc.LFLAG_RHDR)){if(_==-1)_=t;o=t}else if(Nj(ui[t].flags&tc.LFLAG_LHDR)){if(A==-1)A=t;E=t}else if(Nj(ui[t].flags&tc.LFLAG_FHDR)){if(a==-1)a=t;n=t}else if(Nj(ui[t].flags&tc.LFLAG_HDR)){if(r==-1)r=t;i=t}else if(Nj(ui[t].flags&tc.LFLAG_RFTR)){if(u==-1)u=t;T=t}else if(Nj(ui[t].flags&tc.LFLAG_LFTR)){if(R==-1)R=t;L=t}else if(Nj(ui[t].flags&tc.LFLAG_FFTR)){if(c==-1)c=t;s=t}else if(Nj(ui[t].flags&tc.LFLAG_FTR)){if(f==-1)f=t;l=t}g=-1;P=ui[t].len;h=ui[t].txt;if(P>0&&h[P-1]==tc.SECT_CHAR){if(Vx(t,P-1,tc.TERTAG_SECT)>0)g=WC;else g=-1}if(g==-1){if(Nj(ui[t].tabw)&&Nj(ui[t].tabw.type&tc.INFO_SECT))ui[t].tabw.type=cj(ui[t].tabw.type,tc.INFO_SECT)}else{if(Dj(ui[t].tabw))ui[t].tabw=new tc.TejTabw;ui[t].tabw.type|=tc.INFO_SECT;ui[t].tabw.section=g;I=ui[t].tabw.section;to[I].InUse=true;if(to[I].FirstLine!=e||to[I].LastLine!=t){S=true}to[I].FirstLine=e;to[I].LastLine=t;if(e==0)to[I].flags|=tc.SECT_NEW_PAGE;eo[I].PrevSect=F;eo[I].NextSect=-1;if(F>=0)eo[F].NextSect=I;eo[I].hdr.FirstLine=r;eo[I].hdr.LastLine=i;eo[I].ftr.FirstLine=f;eo[I].ftr.LastLine=l;eo[I].fhdr.FirstLine=a;eo[I].fhdr.LastLine=n;eo[I].fftr.FirstLine=c;eo[I].fftr.LastLine=s;eo[I].rhdr.FirstLine=_;eo[I].rhdr.LastLine=o;eo[I].rftr.FirstLine=u;eo[I].rftr.LastLine=T;eo[I].lhdr.FirstLine=A;eo[I].lhdr.LastLine=E;eo[I].lftr.FirstLine=R;eo[I].lftr.LastLine=L;F=I;r=f=-1;a=c=-1;_=u=-1;A=R=-1;e=t+1}}if(to[0].FirstLine!=e)S=true;to[0].FirstLine=e;to[0].LastLine=Ri-1;eo[0].PrevSect=F;eo[0].NextSect=-1;if(F>=0)eo[F].NextSect=0;eo[0].hdr.FirstLine=r;eo[0].hdr.LastLine=i;eo[0].ftr.FirstLine=f;eo[0].ftr.LastLine=l;eo[0].fhdr.FirstLine=a;eo[0].fhdr.LastLine=n;eo[0].fftr.FirstLine=c;eo[0].fftr.LastLine=s;eo[0].rhdr.FirstLine=_;eo[0].rhdr.LastLine=o;eo[0].rftr.FirstLine=u;eo[0].rftr.LastLine=T;eo[0].lhdr.FirstLine=A;eo[0].lhdr.LastLine=E;eo[0].lftr.FirstLine=R;eo[0].lftr.LastLine=L;to[0].InUse=true;oo=false;for(C=0;C<ro;C++){if(to[C].InUse&&to[C].columns>1){oo=true;break}}b5();lo=false;if(Ro!=d)return true;if(S)return true;else return false}function H5(){var t,e,r,i,f,l,a,n,c;for(t=0;t<ro;t++){if(!to[t].InUse)continue;if(to[t].columns==1&&Nj(to[t].flags&tc.SECT_VAR_COL_WIDTH))to[t].flags=cj(to[t].flags,tc.SECT_VAR_COL_WIDTH);if(Dj(to[t].flags&tc.SECT_VAR_COL_WIDTH))continue;r=(eo[t].PgWidth-to[t].LeftMargin-to[t].RightMargin)*1440;i=to[t].columns;if(i<=0)i=1;a=to[t].ColumnSpace*1440;l=(r-(i-1)*a)/i;f=0;for(e=0;e<i;e++){if(to[t].ColWidth[e]==0)to[t].ColWidth[e]=l;f+=to[t].ColWidth[e];if(e+1<i){if(to[t].ColSpace[e]==0)to[t].ColSpace[e]=a;f+=to[t].ColSpace[e]}}n=r-f;if(n!=0){c=0;for(e=0;e<i;e++){if(e+1==i){to[t].ColWidth[e]=r-c;break}to[t].ColWidth[e]=Mj(to[t].ColWidth[e],r,f);to[t].ColSpace[e]=Mj(to[t].ColSpace[e],r,f);c+=to[t].ColWidth[e]+to[t].ColSpace[e]}}}return true}function m5(t,e){var r;for(r=0;r<ro;r++){if(!to[r].InUse)continue;if(to[r].FirstLine>t&&to[r].FirstLine>0)to[r].FirstLine+=e;if(to[r].LastLine>t)to[r].LastLine+=e;if(eo[r].hdr.FirstLine>t)eo[r].hdr.FirstLine+=e;if(eo[r].hdr.LastLine>t)eo[r].hdr.LastLine+=e;if(eo[r].ftr.FirstLine>t)eo[r].ftr.FirstLine+=e;if(eo[r].ftr.LastLine>t)eo[r].ftr.LastLine+=e}to[0].LastLine=Ri-1;lo=true;return true}function w5(t){to[t]=new tc.ClsSect;eo[t]=new tc.ClsSect1;to[t].InUse=true;to[t].LeftMargin=to[t].RightMargin=1.25;to[t].TopMargin=to[t].BotMargin=1;to[t].HdrMargin=to[t].FtrMargin=.5;to[t].columns=1;to[t].ColumnSpace=.5;to[t].FirstLine=0;to[t].LastLine=Ri-1;to[t].flags=tc.SECT_NEW_PAGE;to[t].IsPortrait=Su;to[t].FirstPageNo=1;to[t].BorderColor=tc.CLR_AUTO;to[t].PprWidth=xo;to[t].PprHeight=yo;eo[t].hdr=new tc.ClsHdrFtr;eo[t].hdr.FirstLine=-1;eo[t].ftr=new tc.ClsHdrFtr;eo[t].ftr.FirstLine=-1;eo[t].fhdr=new tc.ClsHdrFtr;eo[t].fhdr.FirstLine=-1;eo[t].fftr=new tc.ClsHdrFtr;eo[t].fftr.FirstLine=-1;eo[t].rhdr=new tc.ClsHdrFtr;eo[t].rhdr.FirstLine=-1;eo[t].rftr=new tc.ClsHdrFtr;eo[t].rftr.FirstLine=-1;eo[t].lhdr=new tc.ClsHdrFtr;eo[t].lhdr.FirstLine=-1;eo[t].lftr=new tc.ClsHdrFtr;eo[t].lftr.FirstLine=-1;eo[t].PgWidth=xo;eo[t].PgHeight=yo;eo[t].hdr.height=eo[t].ftr.height=0;eo[t].fhdr.height=eo[t].fftr.height=0;eo[t].PrevSect=-1;return true}_i.TerSetSectPageSize=function(t,e,r,i,f){var l;var a,n;if(!lv||!QD())_i.TerCreateControl();if(t==tc.SECT_CUR)t=G5(br);else if(t==tc.SECT_ALL)t=-1;else if(t<0||t>=ro)return false;if(false&&l<tc.MAX_PAPERS){a=tg.DefPaperWidth[l];n=tg.DefPaperHeight[l]}else{a=r/1440;n=i/1440}for(l=0;l<ro;l++){if(t>=0&&l!=t)continue;if(a>0)to[l].PprWidth=a;if(n>0)to[l].PprHeight=n;if(t>=0)break}b5();if(f){if(oi.PrintView){yJ(false,false,0,true);Ro=oi.modified++;Fo=0}cG()}return true};function b5(){var t;var e=Nj(rO&tc.TFLAG8_ALLOW_NARROW_PAGE)?.1:tc.MIN_TEXT_WIDTH;for(t=0;t<ro;t++){if(to[t].IsPortrait){eo[t].PgWidth=to[t].PprWidth;eo[t].PgHeight=to[t].PprHeight;eo[t].HiddenX=Xo;eo[t].HiddenY=Ko}else{eo[t].PgWidth=to[t].PprHeight;eo[t].PgHeight=to[t].PprWidth;eo[t].HiddenX=Yo;eo[t].HiddenY=Vo}if(Dj(aO&tc.TOFLAG_IN_MERGE_PRINT)){if(to[t].LeftMargin+to[t].RightMargin>eo[t].PgWidth-e){to[t].RightMargin=eo[t].PgWidth-e-to[t].LeftMargin;if(to[t].RightMargin<0){to[t].LeftMargin+=to[t].RightMargin;to[t].RightMargin=0}}if(to[t].TopMargin+to[t].BotMargin>eo[t].PgHeight-tc.MIN_TEXT_HEIGHT&&Dj($h&tc.TFLAG5_VARIABLE_PAGE_SIZE)){to[t].BotMargin=eo[t].PgHeight-tc.MIN_TEXT_HEIGHT-to[t].TopMargin;if(to[t].BotMargin<0){to[t].TopMargin+=to[t].BotMargin;to[t].BotMargin=0}}}}return true}_i.TerHdrFtrExists=function(t){var e,r=0,i=0,f;if(!lv||!QD())_i.TerCreateControl();if(t<0)e=br;else{for(e=0;e<Ri;e++){if(r==t)break;if(Nj(ui[e].flags&tc.LFLAG_SECT))r++}if(e==Ri)return i}for(;e<Ri;e++){f=ui[e].pfmt;if(Dj(Nc[f].flags&tc.PAGE_HDR_FTR))break}if(e==Ri)return i;for(;e>=0;e--){i|=ui[e].flags&tc.LFLAG_HDRS_FTRS;if(t!=tc.SECT_ALL&&Nj(ui[e].flags&tc.LFLAG_SECT))break}return i};_i.TerGetHdrFtrPos=function(t){var e;if(!lv||!QD())_i.TerCreateControl();if(t<0)t=br;if(t<0||t>=Ri)return 0;e=ui[t].pfmt;if(Dj(Nc[e].flags&tc.PAGE_HDR_FTR))return 0;for(;t<Ri;t++)if(Nj(ui[t].flags&tc.LFLAG_HDRS_FTRS))break;if(t==Ri)return 0;return ui[t].flags&tc.LFLAG_HDRS_FTRS};_i.TerPosHdrFtr=function(t,e,r,i){return _i.TerPosHdrFtrEx(t,e?tc.HDR_CHAR:tc.FTR_CHAR,r,i)};_i.TerPosHdrFtrEx=function(t,e,r,i){var f,l=false;var a;var n,c;var s;var _=e==tc.FHDR_CHAR||e==tc.FFTR_CHAR;var o=e==tc.LHDR_CHAR||e==tc.LFTR_CHAR||(e==tc.RHDR_CHAR||e==tc.RFTR_CHAR);var u;var T;var A=false;if(!lv||!QD())_i.TerCreateControl();if(!oi.PageMode)return false;if(r!=tc.POS_BEG&&r!=tc.POS_END)return false;f=si;si=i;if(!WR)y5();si=f;t:while(true){n=0;a=0;while(n<t){while(a<Ri){if(Nj(ui[a].tabw)&&Nj(ui[a].tabw.type&tc.INFO_SECT)){n++;a++;break}a++}if(a==Ri)break}if(a==Ri)return false;if(_){B5();s=G5(a);u=e==tc.FHDR_CHAR&&eo[s].fhdr.FirstLine<0||e==tc.FFTR_CHAR&&eo[s].fftr.FirstLine<0;if(u){if(A)return false;f=si;si=i;br=a;jt=0;_i.TerCreateFirstHdrFtr(e==tc.FHDR_CHAR);si=f;A=true;continue t}}else if(o){B5();s=G5(a);u=e==tc.LHDR_CHAR&&eo[s].lhdr.FirstLine<0||e==tc.LFTR_CHAR&&eo[s].lftr.FirstLine<0||e==tc.RHDR_CHAR&&eo[s].rhdr.FirstLine<0||e==tc.RFTR_CHAR&&eo[s].rftr.FirstLine<0;if(u){if(A)return false;f=si;si=i;br=a;jt=0;_i.TerCreateLeftRightHdrFtr(e);si=f;A=true;continue t}}break}while(a<Ri){if(Nj(ui[a].tabw)&&Nj(ui[a].tabw.type&tc.INFO_SECT))return false;if(!l){if(Nj(ui[a].flags&tc.LFLAG_HDR))T=tc.HDR_CHAR;else if(Nj(ui[a].flags&tc.LFLAG_FTR))T=tc.FTR_CHAR;else if(Nj(ui[a].flags&tc.LFLAG_FHDR))T=tc.FHDR_CHAR;else if(Nj(ui[a].flags&tc.LFLAG_FFTR))T=tc.FFTR_CHAR;else if(Nj(ui[a].flags&tc.LFLAG_RHDR))T=tc.RHDR_CHAR;else if(Nj(ui[a].flags&tc.LFLAG_RFTR))T=tc.RFTR_CHAR;else if(Nj(ui[a].flags&tc.LFLAG_LHDR))T=tc.LHDR_CHAR;else if(Nj(ui[a].flags&tc.LFLAG_LFTR))T=tc.LFTR_CHAR;else T=0;if(T==e){l=true;if(r==tc.POS_BEG){MT=tc.CURS_FORWARD;_i.SetTerCursorPos(a+1,0,i);return true}a++;continue}}if(l){if(Nj(ui[a].flags&tc.LFLAG_HDRS_FTRS)){c=ui[a-1].len-1;if(c<0)c=0;MT=tc.CURS_BACKWARD;_i.SetTerCursorPos(a-1,c,i);return true}}a++}return false};function x5(t,e){var r,i;var f,l;var a;var n;var c;var s=t==tc.HDR_CHAR||t==tc.FHDR_CHAR||t==tc.LHDR_CHAR||t==tc.RHDR_CHAR;if(!MY(Ri+3))return false;i=G5(br);l=to[e].FirstLine;r=0;c=Nc[r].flags;if(s)c=c&~tc.PAGE_FTR|tc.PAGE_HDR;else c=c&~tc.PAGE_HDR|tc.PAGE_FTR;r=ZZ(r,Nc[r].LeftIndentTwips,Nc[r].RightIndentTwips,Nc[r].FirstIndentTwips,Nc[r].TabId,Nc[r].BltId,Nc[r].AuxId,Nc[r].Aux1Id,Nc[r].StyId,Nc[r].shading,Nc[r].pflags,Nc[r].SpaceBefore,Nc[r].SpaceAfter,Nc[r].SpaceBetween,Nc[r].LineSpacing,Nc[r].BkColor,Nc[r].BorderSpaceLeft,Nc[r].flow,c);iw(l,3,gk("B"));to[e].FirstLine=l;for(f=l;f<l+3;f++){Tm(f,0,1);a=ui[f].txt;n=nb(f);a[0]=t;if(f==l+1)a[0]=Bn;n[0]=tc.DEFAULT_CFMT;sb(f);ui[f].pfmt=r;if(f==l||f==l+2)X5(f,t)}if(t==tc.HDR_CHAR&&e==i&&!GR)br=l+1;else if(br>=l)br=br+3;if(l<sA)sA+=3;if(l<_A)_A+=3;oi.modified++;return true}function y5(){var t,e,r,i,f,l;var a,n,c=false,s,_=false;var o=false;var u;var T,A;if(!oi.PageMode)return false;B5();if(WR){r=i=-1;A=0;for(t=0;t<=Ri;t++){if(t<Ri&&Nj(ui[t].flags&tc.LFLAG_FHDR_FFTR))o=!o;if(t<Ri&&!o)T=Nc[ui[t].pfmt].flags&tc.PAGE_HDR_FTR;else T=0;if((t>=Ri||T!=A)&&r>=0){u=G5(r);f=i-r+1;s=true;if(to[u].FirstLine==0)s=false;if(f!=3)s=false;if(ui[r+1].len!=1)s=false;if(Dj(ui[r].flags&(tc.LFLAG_HDR|tc.LFLAG_FTR)))s=false;if(Dj(ui[i].flags&(tc.LFLAG_HDR|tc.LFLAG_FTR)))s=false;if(s){iw(r,f,tc.CHAR_D);if(i<sA)sA-=f;if(i<_A)_A-=f;l=0;for(e=0;e<f;e++)if(r+e<br)l++;br-=l;if(br<0)br=0;c=true;t-=f}r=-1}if(t>=Ri)break;if(Nj(T)&&r==-1)r=t;i=t;A=T}if(c){B5();if(br>=Ri)br=Ri-1;if(Ri<tc.SMALL_FILE)yJ(false,false,0,true)}WR=false;cG()}else{for(u=0;u<ro;u++){if(!to[u].InUse)continue;a=n=false;for(t=to[u].FirstLine;t<=to[u].LastLine;t++){if(Nj(ui[t].flags&tc.LFLAG_HDR))a=true;if(Nj(ui[t].flags&tc.LFLAG_FTR))n=true;if(a&&n)break}if(!n)if(!x5(tc.FTR_CHAR,u))return false;if(!a)if(!x5(tc.HDR_CHAR,u))return false;if(!a||!n)_=true}yR=WR=true;if(_){B5();if(Ri<tc.SMALL_FILE)yJ(false,false,0,true)}if(!oi.PageMode)Gz();else cG()}return true}function W5(){var t=false,e=false;var r;if(!oi.PrintView)return false;if(yR){if(WR)y5();yR=false}else{B5();r=G5(0);if(eo[r].hdr.FirstLine>=0)t=true;if(eo[r].ftr.FirstLine>=0)e=true;if(!e)if(!x5(tc.FTR_CHAR,r))return false;if(!t)if(!x5(tc.HDR_CHAR,r))return false;yR=true;if(!t||!e){B5();if(Ri<tc.SMALL_FILE)yJ(false,false,0,true)}}if(!oi.PageMode)Gz();else cG();return true}function U5(t){var e,r,i,f,l,a,n;var c,s=false,_;var o,u;var T;var A,E;if(!oi.WordWrap)return true;if(uA!=tc.HILIGHT_OFF)uA=tc.HILIGHT_OFF;B5();c=o=u=false;i=f=-1;a=n=-1;E=0;for(e=Ri-1;e>=-1;e--){if(e>=0)_=Nj(ui[e].flags&tc.LFLAG_SECT)||GY(e,tc.INFO_SECT);else _=false;if(_&&e>=0){T=ui[e].txt;for(A=0;A<ui[e].len;A++)if(T[A]==tc.SECT_CHAR)break;if(A==ui[e].len)_=false}if(e==-1||_){if(c&&a>=0){i=a;f=n;a=n=-1}if(c&&i>e+1){k5(i,f);l=f-i+1;if(!MY(Ri+l))return true;iw(e+1,l,gk("B"));i+=l;f+=l;for(r=0;r<l;r++){dp(e+r+1);ui[e+r+1]=ui[i+r];ui[i+r]=null}iw(i,l,tc.CHAR_D);s=true}if(false&&Nj(to[E].flags&tc.SECT_HAS_TITLE_PAGE)&&eo[E].PrevSect<0){if(!u&&!x5(tc.FFTR_CHAR,E))return false;if(!o&&!x5(tc.FHDR_CHAR,E))return false;to[E].flags=cj(to[E].flags,tc.SECT_HAS_TITLE_PAGE);s=true}if(e==-1)break;c=o=u=false;i=f=-1;a=n=-1;if(e>=0&&GY(e,tc.INFO_SECT))E=ui[e].tabw.section}if(Nj(Nc[ui[e].pfmt].flags&tc.PAGE_HDR_FTR)){if(ui[e].len==1&&Sm(e,0)==tc.FHDR_CHAR)o=true;if(ui[e].len==1&&Sm(e,0)==tc.FFTR_CHAR)u=true;if(f==-1)f=e;i=e}else if(f>=0){if(c){if(n>=0&&n!=f){iw(a,n-a+1,tc.CHAR_D);s=true;a=n=-1}}else c=true;n=f;a=i;i=f=-1}}if(Ri<=0){Ri=1;Ip(0)}if(br>=Ri)br=Ri-1;if(s){B5();Z4(false);if(Ri<tc.SMALL_FILE)yJ(false,false,0,true)}lo=false;UR=false;if(t)cG();return true}function k5(t,e){var r,i=0;var f;var l=-1;var a;var n;for(a=t;a<=e;a++){if(ui[a].len==1)r=Sm(a,0);else r=0;f=hj(r);if(f){if(l==-1){l=a;i=r}else{l=-1;if(r!=i){n=ui[a].txt;n[0]=i}}X5(a,i);continue}ui[a].flags=cj(ui[a].flags,tc.LFLAG_HDRS_FTRS)}return true}function X5(t,e){ui[t].flags=cj(ui[t].flags,tc.LFLAG_HDRS_FTRS);if(e==tc.HDR_CHAR)ui[t].flags|=tc.LFLAG_HDR;else if(e==tc.FTR_CHAR)ui[t].flags|=tc.LFLAG_FTR;else if(e==tc.LHDR_CHAR)ui[t].flags|=tc.LFLAG_LHDR;else if(e==tc.LFTR_CHAR)ui[t].flags|=tc.LFLAG_LFTR;else if(e==tc.RHDR_CHAR)ui[t].flags|=tc.LFLAG_RHDR;else if(e==tc.RFTR_CHAR)ui[t].flags|=tc.LFLAG_RFTR;else if(e==tc.FHDR_CHAR)ui[t].flags|=tc.LFLAG_FHDR;else if(e==tc.FFTR_CHAR)ui[t].flags|=tc.LFLAG_FFTR;return true}function K5(t){var e;if(t<0||t>=Ri)return 0;if(Dj(Nc[ui[t].pfmt].flags&tc.PAGE_HDR_FTR))return 0;for(e=t;e<Ri;e++)if(Nj(ui[e].flags&tc.LFLAG_HDRS_FTRS))return ui[e].flags&tc.LFLAG_HDRS_FTRS;return 0}function Y5(t,e){var r,i=0,f=0;var l;var a;OC=pC=0;l=false;f=0;for(r=e;r<Ri;r++){a=ui[r].pfmt;if(Dj(Nc[a].flags&tc.PAGE_HDR_FTR))return false;if(l)f++;if(ui[r].len==1&&ui[r].txt[0]==t){if(!l){l=true;i=r;f++}else break}}if(!l||r==Ri)return false;OC=i;pC=f;return true}_i.TerCreateFirstHdrFtr=function(t){var e;if(!lv||!QD())_i.TerCreateControl();if(!oi.WordWrap||!oi.PageMode)return false;if(!WR)y5();if(!WR)return false;B5();e=G5(br);if(t&&eo[e].fhdr.FirstLine>=0)return false;if(!t&&eo[e].fftr.FirstLine>=0)return false;n9();to[e].flags|=tc.SECT_HAS_TITLE_PAGE;x5(t?tc.FHDR_CHAR:tc.FFTR_CHAR,e);B5();if(t)br=eo[e].fhdr.FirstLine+1;else br=eo[e].fftr.FirstLine+1;if(br<0)br=0;jt=0;if(Ri<tc.SMALL_FILE)yJ(false,false,0,true);else cG();return true};_i.TerCreateLeftRightHdrFtr=function(t){var e,r;if(!lv||!QD())_i.TerCreateControl();if(!oi.WordWrap||!oi.PageMode)return false;if(t!=tc.RHDR_CHAR&&t!=tc.RFTR_CHAR&&t!=tc.LHDR_CHAR&&t!=tc.LFTR_CHAR)return false;if(!WR)y5();if(!WR)return false;B5();e=G5(br);if(t==tc.RHDR_CHAR&&eo[e].rhdr.FirstLine>=0)return false;if(t==tc.RFTR_CHAR&&eo[e].rftr.FirstLine>=0)return false;if(t==tc.LHDR_CHAR&&eo[e].lhdr.FirstLine>=0)return false;if(t==tc.LFTR_CHAR&&eo[e].lftr.FirstLine>=0)return false;n9();if(t==tc.LHDR_CHAR||t==tc.LFTR_CHAR){for(r=0;r<ro;r++)to[r].flags|=tc.SECT_HAS_FACING_PAGES}x5(t,e);B5();if(t==tc.RHDR_CHAR)br=eo[e].rhdr.FirstLine+1;else if(t==tc.RFTR_CHAR)br=eo[e].rftr.FirstLine+1;else if(t==tc.LHDR_CHAR)br=eo[e].lhdr.FirstLine+1;else if(t==tc.LFTR_CHAR)br=eo[e].lftr.FirstLine+1;if(br<0)br=0;jt=0;if(Ri<tc.SMALL_FILE)yJ(false,false,0,true);else cG();return true};_i.TerDeleteFirstHdrFtr=function(t,e){return _i.TerDeleteHdrFtr(t?tc.FHDR_CHAR:tc.FFTR_CHAR,e)};_i.TerDeleteHdrFtr=function(t,e){var r,i;var f,l,a;var n;var c;if(!lv||!QD())_i.TerCreateControl();if(!oi.WordWrap||!oi.PageMode)return false;if(WR)y5();if(WR)return false;B5();i=G5(br);if(t==tc.HDR_CHAR){f=eo[i].hdr.FirstLine;l=eo[i].hdr.LastLine}else if(t==tc.FHDR_CHAR){f=eo[i].fhdr.FirstLine;l=eo[i].fhdr.LastLine}else if(t==tc.RHDR_CHAR){f=eo[i].rhdr.FirstLine;l=eo[i].rhdr.LastLine}else if(t==tc.LHDR_CHAR){f=eo[i].lhdr.FirstLine;l=eo[i].lhdr.LastLine}else if(t==tc.FTR_CHAR){f=eo[i].ftr.FirstLine;l=eo[i].ftr.LastLine}else if(t==tc.FFTR_CHAR){f=eo[i].fftr.FirstLine;l=eo[i].fftr.LastLine}else if(t==tc.RFTR_CHAR){f=eo[i].rftr.FirstLine;l=eo[i].rftr.LastLine}else{f=eo[i].lftr.FirstLine;l=eo[i].lftr.LastLine}if(f<0)return false;if(e){if(t==tc.HDR_CHAR||t==tc.RHDR_CHAR||t==tc.LHDR_CHAR)n=tg.MsgString[tc.MSG_DEL_HDR];else if(t==tc.FHDR_CHAR)n=tg.MsgString[tc.MSG_DEL_FIRST_HDR];else if(t==tc.FTR_CHAR||t==tc.RFTR_CHAR||t==tc.LFTR_CHAR)n=tg.MsgString[tc.MSG_DEL_FTR];else n=tg.MsgString[tc.MSG_DEL_FIRST_FTR];if(tc.MSGRESULT_CANCEL==qk(n,tg.MsgString[tc.MSG_IRREVERSIBLE_DEL],tc.MSGTYPE_OK_CANCEL))return false}n9();c=Nj(Nc[ui[br].pfmt].flags&tc.PAGE_HDR_FTR);a=l-f+1;iw(f,a,tc.CHAR_D);if(t==tc.FHDR_CHAR&&(eo[i].fftr==null||eo[i].fftr.FirstLine<0))to[i].flags=cj(to[i].flags,tc.SECT_HAS_TITLE_PAGE);if(t==tc.FFTR_CHAR&&(eo[i].fhdr==null||eo[i].fhdr.FirstLine<0))to[i].flags=cj(to[i].flags,tc.SECT_HAS_TITLE_PAGE);if(t==tc.LHDR_CHAR&&(eo[i].lftr==null||eo[i].lftr.FirstLine<0))to[i].flags=cj(to[i].flags,tc.SECT_HAS_FACING_PAGES);if(t==tc.LFTR_CHAR&&(eo[i].lhdr==null||eo[i].lhdr.FirstLine<0))to[i].flags=cj(to[i].flags,tc.SECT_HAS_FACING_PAGES);for(r=0;r<ro;r++){if(eo[r].hdr.FirstLine>l){eo[i].hdr.FirstLine-=a;eo[i].hdr.LastLine-=a}if(eo[r].fhdr.FirstLine>l){eo[i].fhdr.FirstLine-=a;eo[i].fhdr.LastLine-=a}if(eo[r].rhdr.FirstLine>l){eo[i].rhdr.FirstLine-=a;eo[i].rhdr.LastLine-=a}if(eo[r].lhdr.FirstLine>l){eo[i].lhdr.FirstLine-=a;eo[i].lhdr.LastLine-=a}if(eo[r].ftr.FirstLine>l){eo[i].ftr.FirstLine-=a;eo[i].ftr.LastLine-=a}if(eo[r].fftr.FirstLine>l){eo[i].fftr.FirstLine-=a;eo[i].fftr.LastLine-=a}if(eo[r].rftr.FirstLine>l){eo[i].rftr.FirstLine-=a;eo[i].rftr.LastLine-=a}if(eo[r].lftr.FirstLine>l){eo[i].lftr.FirstLine-=a;eo[i].lftr.LastLine-=a}}B5();if(c){for(;br+1<Ri;br++)if(Dj(Nc[ui[br].pfmt].flags&tc.PAGE_HDR_FTR))break}else if(f<br)br-=a;if(br<0)br=0;jt=0;if(l<sA)sA-=a;if(l<_A)_A-=a;if(Ri<tc.SMALL_FILE)yJ(false,false,0,true);else cG();return true};function V5(t){if(WR&&t.FirstLine>=0)return true;return j5(t)}function j5(t){if(t.FirstLine<0)return false;if(t.LastLine-t.FirstLine>2)return true;if(t.FirstLine>=0&&t.FirstLine+1<Ri&&ui[t.FirstLine+1].len>1)return true;return false}function J5(t){t.FirstLine=-1;t.height=0;t.TextHeight=0;return true}_i.TerInsertFootnote=function(t,e,r,i){return _i.TerInsertFootnote2(t,e,r,true,i)};_i.TerInsertFootnote2=function(a,n,c,s,_){if(!lv||!QD())_i.TerCreateControl();if(GE)return false;if(a!=null&&a.length>0&&n!=null&&n.length>0)return z5(a,n,c,s,_);var t=_i.DlgCompHeight;var e=_i.DlgFont;var o=new $t.DialogBox(te,s?"Footnote":"Endnoe",e,true,l,JV(2));var r=o.cvs;var i=new $t.Label(r,0,0,e,s?"Footnote Marker":"Endnote Marker");o.addComp(i,0,0,1,1,"Left","middle");var u=new $t.TextBox(r,0,0,JV(60),t,"",e,_i.caret,false,true,null);o.addComp(u,0,1,1,1,"left","middle");var f=new $t.Label(r,0,0,e,s?"Footnote Text":"Endnote Text");o.addComp(f,2,0,1,1,"Left","bottom");var T=new $t.TextBox(r,0,0,JV(400),t,"",e,_i.caret,false,true,null);o.addComp(T,3,0,1,3,"left","middle");var A=new $t.CheckBox(r,0,0,JV(15),JV(16),e,s?"Superscript Footnote Marker":"Superscript Endnote Marker",true,null);o.addComp(A,5,0,1,2,"left","middle",0);o.show();u.setFocus();function l(t,e,r){if(t=="Cancel"){o.hide();return}else if(t=="OK"){var i;JO=u.getText();if(JO.length==0){return}var f=Uk(JO);for(i=0;i<JO.length;i++){if(f[i]==tc.CHAR_SPACE||BY(f[i])){qk(MsgString[tc.MSG_BAD_FNOTE_MARKER],null);u.setFocus()}}zO=T.getText();if(zO.length==0){return}var l=Uk(zO);for(i=0;i<zO.length;i++){if(BY(l[i])){qk(MsgString[tc.MSG_BAD_FNOTE_MARKER],null);T.setFocus();return}}Ls=0;if(A.isSelected())Ls=tc.SUPSCR;a=JO;n=a;n+=" ";n+=zO;if(Nj(Ls))c=tc.PROTECT|tc.SUPSCR;else c=tc.PROTECT;o.hide();return z5(a,n,c,s,_)}else return}};function z5(t,e,r,i,f){var l,a,n,c,s,_=0,o=0,u,T,A;var E,R;var L;var C;var I,d;E=t;E+=e;e=E;r=cj(r,tc.FNOTEALL);a=t.length;n=e.length;if(uA!=tc.HILIGHT_OFF)uA=tc.HILIGHT_OFF;Oc=$w();I=tc.FNOTE|tc.FNOTETEXT|r;if(!i)I|=tc.ENOTETEXT;if(Nj(xs[Oc].style&(I|r))){_i.SetTerCharStyle(I|r,false,false)}if(MO!=tc.ENGLISH)Oc=Zb(Oc,null);T=Oc;_i.SetTerCharStyle(tc.FNOTE|r,true,false);c=Oc;Oc=T;d=i?tc.FNOTETEXT:tc.FNOTETEXT|tc.ENOTETEXT;_i.SetTerCharStyle(d,true,false);s=Oc;if(n>a){Oc=T;_i.SetTerCharStyle(d|r,true,false);o=Oc}if(false&&a>1){Oc=T;_i.SetTerCharStyle(tc.FNOTEREST|r,true,false);_=Oc}Oc=-1;fw(br,jt,a+n,gk("B"));L=ui[br].txt;C=nb(br);u=0;L[jt]=Uk(t)[0];C[jt]=c;u++;var F=Uk(t);for(l=1;l<a;l++){L[jt+u]=F[l];C[jt+u]=c;u++}A=a;var g=Uk(e);for(l=0;l<a;l++){L[jt+u]=g[l];C[jt+u]=o;u++}g=Uk(e);for(l=0;l<n-A;l++){L[jt+u]=g[A+l];C[jt+u]=s;if(MO!=tc.ENGLISH){if(db(Uk(e),A+l,n))C[jt+u]=Zb(C[jt+u],null)}u++}sb(br);jt+=a+n;n9();if(!i){ui[br].flags2|=tc.LFLAG2_ENOTETEXT;Xz();_z(true)}if(f)cG();else T9(br,30);return true}function Z5(t){if(t)DE=!DE;else ME=!ME;Ex(Ti);Ro=-1;Fo=0;cG();return true}_i.TerInsertToc=function(t){return _i.TerInsertToc2(tc.TOC_HEADINGS,"",1,9,t)};_i.TerInsertToc2=function(t,e,r,i,f){var l,a;var n,c;var s;var _;var o;if(!lv||!QD())_i.TerCreateControl();if(!oi.PageMode)return false;if(!Qk())return false;if(t<0||t>tc.TOC_LAST)t=tc.TOC_HEADINGS;if(r<1)r=1;if(i>9)i=9;if(i<r)i=r;uA=tc.HILIGHT_OFF;if(t==tc.TOC_HEADINGS&&r==1&&i==9){s=Rw(ib(br,jt),tc.FIELD_TOC,0,null,br,jt)}else{a="";if(e==null)e="";if(t==tc.TOC_CUSTOM)a="\\h \\z \\t "+tc.QUOTE+e+tc.QUOTE;else if(t==tc.TOC_FIELD)a="\\f ";else if(t==tc.TOC_USER)a=e;else{a="\\o "+tc.QUOTE+mY(r)+"-"+mY(i)+tc.QUOTE;if(t==tc.TOC_OUTLINES)a+=" \\u"}s=Rw(ib(br,jt),tc.FIELD_TOC,0,a,br,jt)}Oc=-1;if(s<0||xs[s].FieldId!=tc.FIELD_TOC)return false;l="Table of Contents";l=jk(l,Bn);c=l.length;iw(br,1,gk("B"));Tm(br,0,c);_=ui[br].txt;o=nb(br);var u=Uk(l);for(n=0;n<c;n++){_[n]=u[n];o[n]=s}ui[br].flags|=tc.LFLAG_TOC;sb(br);n9();if(f)_i.TerRepaginate(true);return true};function Q5(){var t,e,r,i,f;var l;var a,n,c,s,_,o,u,T,A;var E=oi.modified,R,L=0,C=0,I=0;var d,F,g,P;var S=0;var h;var O;var v,p=0;var N;var D,M,G="";var B,H,m,w;var b,x,y,W,U=false,k=false;var X,K,Y,V=false,j=false,J=false;var z,Z,Q,q,$,tt=false,et=true;var rt,it="";var ft;var lt,at,nt,ct,st;var _t;var ot=false;var ut=0;var Tt,At;var Et;var Rt=0;var Lt=0;ZU("CreateToc");if(Nj(qh&tc.TFLAG4_NO_TOC_UPDATE))return true;for(t=0;t<Ri;t++){if(Dj(ui[t].tag))continue;l=ui[t].tag;s=ui[t].len;for(a=0;a<s;a++){if(Nj(l[a])){Ux(t,a,tc.TERTAG_TOC,null);if(Nj(ui[t].tag))Ux(t,a,tc.TERTAG_HEADING,null);if(Dj(ui[t].tag))break}}}uL=TL=false;e=0;t:{e:while(true){d=0;for(t=e;t<Ri;t++)if(Nj(ui[t].flags&tc.LFLAG_TOC))break;if(t==Ri)break t;r=t;rt="";B=m=tc.CHAR_1;H=w=tc.CHAR_9;X=K=J=j=Y=V=false;et=true;h=nb(r);for(a=0;a<ui[r].len;a++){nt=h[a];if(xs[nt].FieldId==tc.FIELD_TOC){if(Nj(xs[nt].FieldCode)){rt=xs[nt].FieldCode;for(n=1;n<rt.length;n++){Tt=Uk(rt);if(Tt[n-1]==tc.BACK_SLASH){if(Tt[n]==tc.CHAR_o)X=true;if(Tt[n]==tc.CHAR_f)K=true;if(Tt[n]==tc.CHAR_t)Y=true;if(Tt[n]==tc.CHAR_u)V=true;if(Tt[n]==tc.CHAR_n)et=false;if(Tt[n]==tc.CHAR_c)j=true}if(Tt[n]==tc.HYPH&&X){B=Tt[n-1];H=Tt[n+1]}}if(Y){if((M=IQ(rt,"\\t"))==null)Y=false;else{G=","+M;G=G.toLowerCase()}}if(j){if((it=IQ(rt,"\\c"))!=null){J=true;Rt=Nc[ui[r].pfmt].StyId;Lt=ui[r].pfmt}}if(B<tc.CHAR_1)B=tc.CHAR_1;if(H>tc.CHAR_9)H=tc.CHAR_9;if(B>H)B=H;if(X){m=B;w=H}rt=xs[nt].FieldCode.toLowerCase();Tt=Uk(rt);M="heading ";if((c=rt.indexOf(M))>=0){c+=M.length;m=Tt[c];w=Tt[c+2];if(m<tc.CHAR_1)m=tc.CHAR_1;if(w>tc.CHAR_9)w=tc.CHAR_9;if(m>w)m=w}rt=xs[nt].FieldCode}break}}if(!K&&!J&&!Y&&!V)X=true;if(Y)V=false;for(t=r;t<Ri;t++){if(Dj(ui[t].flags&tc.LFLAG_TOC)){if(ui[t].len==0)continue;break}if(Nj(ui[t].flags&tc.LFLAG_SECT)){if(t+1==Ri||Dj(ui[t+1].flags&tc.LFLAG_TOC)){s=ui[t].len;O=ui[t].txt;if(s>1&&O[s-1]==tc.SECT_CHAR){fw(t,0,s-1,tc.CHAR_D);ui[t].flags=_j(ui[t].flags,tc.LFLAG_TOC);ui[t].pfmt=0}}break}}i=t-1;if(i<r){e=r+1;continue e}f=i-r+1;iw(r,f,tc.CHAR_D);b=br>i;x=uA!=tc.HILIGHT_OFF&&sA>i;y=uA!=tc.HILIGHT_OFF&&_A>i;if(b)br-=f;if(x)sA-=f;if(y)_A-=f;if(!uL){uL=true;RL=Lq(r,0)}else TL=true;W=false;for(t=0;t<Ri;t++){if(ui[t].len==0||ui[t].len==1&&Nj(ui[t].flags&(tc.LFLAG_PARA|tc.LFLAG_BREAK))&&Nj(ui[t].flags&tc.LFLAG_PARA_FIRST))continue;if(Nj(Nc[ui[t].pfmt].flags&tc.PAGE_HDR_FTR))continue;if(ui[t].len>1&&(Nj(ui[t].flags&(tc.LFLAG_PARA|tc.LFLAG_BREAK))&&Nj(ui[t].flags&tc.LFLAG_PARA_FIRST))){s=ui[t].len-1;O=ui[t].txt;for(a=0;a<s;a++)if(O[a]!=tc.SPACE&&O[a]!=tc.TAB)break;if(a==s)continue}if(W){if(Nj(ui[t].flags&(tc.LFLAG_PARA|tc.LFLAG_BREAK)))W=false;continue}if(Nj(ui[t].flags&tc.LFLAG_TOC))continue;_=ui[t].pfmt;o=Nc[_].StyId;if(o==0&&!K&&!V)continue;z=Z=Q=false;if(V&&Nc[_].OutlineLevel>=0){var Ct=Nc[_].OutlineLevel+tc.CHAR_1;if(Ct>=B&&Ct<=H){z=true;S=Ct}}else if(Nj(o)&&(X||Y)){z=false;var It=W_[o].name.toLowerCase();if(X&&W_[o].name.length=="heading 1".length&&It.startsWith("heading ")){s="heading ".length;M=W_[o].name;if(M.length>s)M=cV(M,0,s);if(Tk(M,"heading ")==0)z=true}if(z){s="heading ".length;if(W_[o].name.length>s+1){Et=W_[o].name.charCodeAt(s+1);if(Et!=tc.SPACE&&Et!=tc.COMMA)z=false}if(z)S=W_[o].name.charCodeAt(s)}if(z){if((S<B||S>H)&&(S<m||S>w))z=false}if(Y){var dt=W_[o].name;at=dt.indexOf(",");if(at>0)dt=cV(dt,0,at);M=","+dt+",";M=M.toLowerCase();if(G.length>=M.length&&(c=G.indexOf(M))>=0){c+=M.length;if(c<G.length){S=G.charCodeAt(c)-tc.CHAR_0;z=true}}}if(!z&&X){if(W_[o].OutlineLevel>=0){S=W_[o].OutlineLevel+gk("1");if(S>=B&&S<=H)z=true;else if(S>=m&&S<=w)z=true}}}if(z){q=false;h=nb(t);s=0;for(a=0;a<ui[t].len;a++)if(Nj(xs[h[a]].style&(tc.HIDDEN|tc.FNOTEALL))||xs[h[a]].FieldId==tc.FIELD_NAME)s++;sb(t);if(Nj(ui[t].flags&(tc.LFLAG_PARA|tc.LFLAG_BREAK))&&s>0)s++;if(s>=ui[t].len)q=true;if(q)z=false}if(J){var Ft;for(Ft=t-1;Ft>0;Ft--){if(Nj(ui[Ft].flags&(tc.LFLAG_PARA|tc.LFLAG_BREAK)))break;if(Nj(ui[Ft].flags2&tc.LFLAG2_SEQ)&&$5(Ft,it)){Q=true;break}}if(!Q){for(Ft=t;Ft<Ri;Ft++){if(Nj(ui[Ft].flags2&tc.LFLAG2_SEQ)&&$5(Ft,it)){Q=true;break}if(Nj(ui[Ft].flags&(tc.LFLAG_PARA|tc.LFLAG_BREAK)))break}}if(Q)S=gk("1")}ot=false;if(!z&&!Q&&K&&Nj(ui[t].flags2&tc.LFLAG2_TC))Z=true;if(!z&&!Z&&!Q){var gt,Pt;if(Dj(ui[t].flags&tc.LFLAG_PARA_FIRST))continue;h=nb(t);s=ui[t].len;gt=h[0];Pt=xs[gt].CharStyId;if(Pt>1&&W_[Pt].link>0){var St=W_[Pt].link;var ht=W_[St].name;at=ht.indexOf(",");if(at>0)ht=cV(ht,0,at);M=","+ht+",";M=M.toLowerCase();if(G.length>=M.length&&(c=G.indexOf(M))>=0){c+=M.length;if(c<G.length){S=G.charCodeAt(c)-tc.CHAR_0;ot=true}}}if(ot){ut=1;for(a=1;a<ui[t].len;a++){gt=h[a];if(xs[gt].CharStyId!=Pt)break;ut++}}else continue}if(!MY(Ri+1))return true;iw(r,1,gk("B"));if(t>=r)t++;if(b)br++;if(x)sA++;if(y)_A++;if(z||Q){Tm(r,0,ui[t].len);lw(t,0,r,0,ui[t].len);ui[r].pfmt=ui[t].pfmt;if(r+1<Ri){ui[r].cid=ui[r+1].cid;ui[r].fid=ui[r+1].fid}s=ui[r].len;if(Nj(ui[t].flags&tc.LFLAG_HPARA)){O=ui[t].txt;for(a=0;a<s;a++)if(O[a]==tc.HPARA_CHAR)break;if(a<s&&a>0){Tm(r,ui[t].len,a+1);s=ui[r].len;O=ui[r].txt;O[s-1]=Bn;W=true}}if(Nj(ui[t].flags&tc.LFLAG_SECT)){s=ui[r].len;O=ui[r].txt;if(s>0&&O[s-1]==tc.SECT_CHAR){if(s==1||O[s-2]!=Bn)O[s-1]=Bn;else Tm(r,s,s-1)}}s=ui[r].len;if(s>0&&Nj(ui[t].flags&(tc.LFLAG_PARA|tc.LFLAG_BREAK))){O=ui[r].txt;Et=O[s-1];if(Et==TR||xY(qS,Et))O[s-1]=Bn;h=nb(r);nt=h[s-1];if(Nj(xs[nt].style&tc.HIDDEN)){if(s>=2)h[s-1]=h[s-2];else h[s-1]=Db(h[s-1],tc.HIDDEN,false)}sb(r)}h=nb(r);nt=-1;for(a=0;a<ui[r].len;a++){ct=nt;nt=h[a];if(a==0||ct!=nt){st=nt;if(Nj(xs[st].style&(tc.HIDDEN|tc.ULINE|tc.ULINED)))st=Db(st,tc.HIDDEN|tc.ULINE|tc.ULINED,false);st=vx(st,oi.PointSize*20,0,r,0);h[a]=st}else h[a]=h[a-1]}}else if(Z){var Ot=-1,vt=-1;var pt="";h=nb(t);O=ui[t].txt;$=W=false;S=gk("1");for(a=0;a<ui[t].len;a++){if(Ot==-1&&xs[h[a]].FieldId==tc.FIELD_TC)Ot=a;if(Ot!=-1){if(!$&&Ot==a){pt=xs[h[a]].FieldCode;if(pt!=null){At=Uk(pt);if(pt!=null&&pt.length>=4)$=At[0]==tc.BACK_SLASH&&At[1]==gk("t")&&At[2]==gk("c")&&At[3]==gk("l");if($&&pt.length>=5)S=At[4]}}vt=a;if(xs[h[a]].FieldId!=tc.FIELD_TC){vt=a-1;W=true;break}}}if(Ot==-1)continue;if(vt==-1)vt=ui[t].len-1;if(vt>Ot){Tm(r,0,vt-Ot+1);lw(t,Ot,r,0,ui[r].len)}else{pt=yk(pt,'"');pt=yk(pt,8220);pt=yk(pt,8221);if(pt=="")continue;Ot=vt=-1;At=Uk(pt);for(a=0;a<pt.length;a++){if(At[a]==tc.BACK_SLASH&&(a+1==pt.length||At[a+1]!=tc.BACK_SLASH))break;if(Ot==-1)Ot=a;vt=a}if(vt>Ot){var Nt=cV(pt,Ot,vt-Ot+1);var Dt="";Dt=IQ(pt,"\\l");if(Dt.length>0)S=Dt.charCodeAt(0)-tc.CHAR_0;Tm(r,0,vt-Ot+1);O=ui[r].txt;var Mt=Uk(Nt);for(a=0;a<ui[r].len;a++)O[a]=Mt[a]}else continue}ui[r].pfmt=0;ui[r].cid=ui[r+1].cid;ui[r].fid=ui[r+1].fid;s=ui[r].len;h=nb(r);nt=-1;for(a=0;a<ui[r].len;a++){ct=nt;nt=h[a];if(a==0||ct!=nt){st=nt;if(Nj(xs[st].style&(tc.HIDDEN|tc.ULINE|tc.ULINED)))st=Db(st,tc.HIDDEN|tc.ULINE|tc.ULINED,false);st=Ew(st,0,null);st=vx(st,oi.PointSize*20,0,r,0);h[a]=st}else h[a]=h[a-1]}if(!W||Nj(ui[t].flags&(tc.LFLAG_PARA|tc.LFLAG_BREAK)))W=true;if(W){s=ui[r].len;Tm(r,s,s+1);O=ui[r].txt;h=nb(r);O[s]=Bn;h[s]=h[s-1];ui[r].flags|=tc.LFLAG_PARA}}else if(ot){Tm(r,0,ut+1);lw(t,0,r,0,ut);ui[r].txt[ut]=Bn;ui[r].flags|=tc.LFLAG_PARA;h=nb(r);h[ut]=h[ut-1];ui[r].pfmt=0;ui[r].cid=ui[r+1].cid;ui[r].fid=ui[r+1].fid;s=ui[r].len;nt=-1;for(a=0;a<ui[r].len;a++){ct=nt;nt=h[a];if(a==0||ct!=nt){st=nt;if(Nj(xs[st].style&(tc.HIDDEN|tc.ULINE|tc.ULINED)))st=Db(st,tc.HIDDEN|tc.ULINE|tc.ULINED,false);st=Ew(st,0,null);st=vx(st,oi.PointSize*20,0,r,0);h[a]=st}else h[a]=h[a-1]}}O=ui[r].txt;s=ui[r].len;tt=s<=1;U=true;if(Nj(ui[t].tabw)&&Nj(ui[t].tabw.ListText)&&Nj(ui[t].flags&tc.LFLAG_LIST))U=false;k=true;I=0;for(a=0;a<s;a++)if(O[a]==tc.TAB||O[a]==tc.PICT_CHAR||O[a]==tc.LINE_CHAR||O[a]==tc.HPARA_CHAR){if(O[a]==tc.TAB&&U&&k){cO|=tc.TOFLAG3_REPAGINATE;if(a+1==s)k=U=false;else{var Gt=Fq(a,t,tc.LEFT);if(Gt<dV(670))I=dV(670);else I=Fq(a+1,t,tc.LEFT);k=false;continue}}O[a]=tc.SPACE}for(a=1;a<ui[r].len;a++){if(O[a-1]==tc.SPACE&&O[a]==tc.SPACE){fw(r,a,1,tc.CHAR_D);O=ui[r].txt;a--}}s=ui[r].len;for(a=0;a<ui[r].len;a++){nt=ib(r,a);if(Nj(xs[nt].style&(tc.HIDDEN|tc.FNOTEALL))||xs[nt].FieldId==tc.FIELD_NAME||xs[nt].FieldId==tc.FIELD_XE){fw(r,a,1,tc.CHAR_D);a--}else if(a==0&&ui[r].txt[a]==tc.SPACE&&ui[r].len>1){fw(r,a,1,tc.CHAR_D);a--}}s=ui[r].len;if(Nj(ui[r].tag)){l=ui[r].tag;for(a=0;a<s;a++)l[a]=0;Tb(r)}var Bt=false;if((z||ot)&&Nj(ui[t].tabw)&&Nj(ui[t].tabw.ListText)&&Nj(ui[t].flags&tc.LFLAG_LIST)){var Ht;var mt=ui[t].tabw.ListText.length;Ht=ui[t].tabw.ListText;if(mt>0&&Uk(Ht)[mt-1]!=tc.SPACE){if(ui[t].len>1){if(Q)F=Rt;else F=t4(S);if(Ht.length<4&&W_[F].TabId==0){Ht+="\t";Bt=true}else Ht+="    "}mt=Ht.length}fw(r,0,mt,gk("B"));O=ui[r].txt;h=nb(r);var wt=Uk(Ht);for(a=0;a<mt;a++){O[a]=wt[a];h[a]=xs[ui[t].tabw.ListFontId].CharSet==tc.SYMBOL_CHARSET?ui[t].tabw.ListFontId:h[mt]}}s=ui[r].len;h=nb(r);v=65535;for(a=0;a<s;a++){if(h[a]!=v){v=h[a];if(Nj(xs[v].style&tc.PICT)){O=ui[r].txt;O[a]=tc.SPACE;p=Rw(tc.DEFAULT_CFMT,tc.FIELD_TOC,0,rt.length==0?null:rt,r,a);if(xs[p].CharStyId!=1)p=GZ(p,1,0,"",r,0)}else{var bt=xs[v].style;p=Rw(xs[v].CharSet==tc.SYMBOL_CHARSET?v:0,tc.FIELD_TOC,0,rt.length==0?null:rt,r,a);if(bt!=0)p=Db(p,bt,true);if(xs[p].CharStyId!=1)p=GZ(p,1,0,"",r,0)}}if(Dj(xs[v].style&tc.PICT)&&Nj(xs[v].style&tc.CAPS)){O=ui[r].txt;O[a]=ok(O[a])}h[a]=p}if(Q)F=Rt;else F=t4(S);if(z)g=Nc[ui[t].pfmt].StyId;else g=0;if(r>0&&Dj(ui[r-1].flags&tc.LFLAG_PARA)){ui[r].pfmt=ui[r-1].pfmt}else{if(Q)N=Nc[Lt];else{N=Nc[ui[t].pfmt].copy();N.pflags=0;mZ(N,W_[N.StyId],W_[F],true)}if(N.TabId==0){var xt=new tc.TejTab;var yt;var Wt=L==0;if(!Wt&&Bt&&C==0)Wt=true;if(Wt){xt.SetSize(Bt||U&&I>0?2:1);yt=M9(r,-1);yt=gV(yt)-90;c=0;if(Bt){xt.pos[c]=570;xt.type[c]=tc.TAB_LEFT;xt.flags[c]=tc.TAB_NONE;c++}else if(U&&I>0){xt.pos[c]=gV(I);xt.type[c]=tc.TAB_LEFT;xt.flags[c]=tc.TAB_NONE;c++}xt.pos[c]=yt;xt.type[c]=LL;xt.flags[c]=_i.TocTabLeader;if(Bt)C=_i.TerCreateTabId(xt);else L=_i.TerCreateTabId(xt)}if(Wt&&!Bt&&U&&I>0)N.TabId=_i.TerCreateTabId(xt);else if(Bt)N.TabId=C;else N.TabId=L}ui[r].pfmt=ZZ(ui[t].pfmt,N.LeftIndentTwips,N.RightIndentTwips,N.FirstIndentTwips,N.TabId,N.BltId,N.AuxId,N.Aux1Id,F,N.shading,N.pflags,N.SpaceBefore,N.SpaceAfter,N.SpaceBetween,N.LineSpacing,N.BkColor,N.BorderSpaceLeft,N.flow,N.flags)}NZ(r,F,g,Q);ui[r].flags|=tc.LFLAG_TOC;if(Nj(ui[t].flags&(tc.LFLAG_PARA|tc.LFLAG_SECT))||W)ui[r].flags|=tc.LFLAG_PARA;if(Nj(ui[r].flags&tc.LFLAG_PARA)&&ui[t].len>0&&AL&&et){var Ut,kt;var Xt="";var Kt=0;R=ui[t].page;s=ui[t].len;if(ot)Kt=0;else Kt=s-1;if(TL)A=Vx(t,Kt,tc.TERTAG_HEADING);else{M="Heading"+d;d++;A=Bx(t,Kt,tc.TERTAG_HEADING,M,null,R)}Ut=po[R].TopSect;kt=to[Ut].PageNumFmt;R=po[R].DispNbr;if(kt==tc.NBR_UPR_ALPHA)Xt=KX(R,true);else if(kt==tc.NBR_LWR_ALPHA)Xt=KX(R,false);else if(kt==tc.NBR_UPR_ROMAN)Xt=YX(R,true);else if(kt==tc.NBR_LWR_ROMAN)Xt=YX(R,false);else Xt=mY(R);D=wY(tc.TAB);var Yt=D.length;D+=Xt;u=D.length;T=ui[r].len;if(T>0){P=T-1;fw(r,P,u,gk("B"));O=ui[r].txt;h=nb(r);var Vt=Uk(D);for(a=0;a<u;a++){O[P+a]=Vt[a];h[P+a]=Db(h[P+a],tc.BOLD|tc.ITALIC|tc.ULINE,false)}M="Toc"+d;A=Bx(r,P+Yt,tc.TERTAG_TOC,M,null,A)}}if(tt&&Nj(ui[r].flags&tc.LFLAG_PARA)&&(r==0||Nj(ui[r-1].flags&tc.LFLAG_PARA)))fw(r,0,ui[r].len,tc.CHAR_D);tt=false;r++}e=r}}if(br>=Ri)br=Ri-1;if(jt>=ui[br].len){if(br>=Ri)jt=ui[br].len-1;else{br++;jt=0}}if(jt<0)jt=0;if(uA!=tc.HILIGHT_OFF){if(sA>=Ri)sA=Ri-1;if(TA>=ui[sA].len)TA=ui[sA].len-1;if(TA<0)TA=0;if(_A>=Ri)_A=Ri-1;if(AA>ui[_A].len)AA=ui[_A].len}oi.modified=E;return true}function q5(){var t,e,r,i;var f,l,a,n,c,s;var _=oi.modified,o;var u;var T;var A,E,R,L="";var C,I=0,d;var F;ZU("UpdateToc");for(f=0;f<Ys;f++){if(!xs[f].InUse||xs[f].FieldId!=tc.FIELD_TOC)continue;if(xs[f].FieldCode==null||xs[f].FieldCode=="")continue;if((E=IQ(xs[f].FieldCode,"\\t"))!=null){var g=","+E;g=g.toLowerCase();if(L.indexOf(g)<0)L+=g}}EL=false;for(t=0;t<Ri;t++){if(Nj(ui[t].flags&tc.LFLAG_TOC))continue;if(Dj(ui[t].flags&tc.LFLAG_PARA)&&Dj(ui[t].flags&tc.LFLAG_SECT)&&Dj(ui[t].flags2&tc.LFLAG2_HAS_LINKED_STYLE))continue;a=ui[t].pfmt;n=Nc[a].StyId;if(n==0&&Nc[a].OutlineLevel<0)continue;if(!EL&&L.length>0){E=","+W_[n].name+",";E=E.toLowerCase();if(L.indexOf(E)>=0)EL=true}if(!EL){if(W_[n].OutlineLevel>=0)EL=true;else if(Nc[a].OutlineLevel>=0)EL=true;else{l="heading ".length;E=W_[n].name;if(l<E.length)E=cV(E,0,l);if(Tk(E,"heading ")!=0)continue;if(W_[n].name.length>l+1)continue;T=Uk(W_[n].name)[l];if(T<gk("1")||T>tc.CHAR_9)continue;EL=true}}if(!uL||!AL)return true;c=Vx(t,ui[t].len-1,tc.TERTAG_HEADING);if(c<=0||c>=Ac){if(Nj(ui[t].flags2&tc.LFLAG2_HAS_LINKED_STYLE))c=c=Vx(t,0,tc.TERTAG_HEADING)}if(c<=0||c>=Ac)continue;ac[c].AuxInt=t}Cq(RL);e=PC;C=SC;t:{e:while(true){for(t=e;t<Ri;t++)if(Nj(ui[t].flags&tc.LFLAG_TOC))break;if(t==Ri)break t;r=t;for(;t<Ri;t++)if(Dj(ui[t].flags&tc.LFLAG_TOC))break;i=t-1;for(t=r;t<=i;t++){var P,S;var h="";var O=0;if(Dj(ui[t].flags&tc.LFLAG_PARA))continue;if(Dj(ui[t].tag))continue;l=ui[t].len;for(f=0;f<l;f++){if(0!=(I=Vx(t,f,tc.TERTAG_TOC)))break}if(f==l)continue;u=f;d=l-u-1;c=ac[I].AuxInt;if(c<=0||c>=Ac)continue;var v=ac[c].AuxInt;if(v>=Ri)s=To-1;else s=ui[v].page;P=po[s].TopSect;S=to[P].PageNumFmt;s=po[s].DispNbr;if(S==tc.NBR_UPR_ALPHA)h=KX(s,true);else if(S==tc.NBR_LWR_ALPHA)h=KX(s,false);else if(S==tc.NBR_UPR_ROMAN)h=YX(s,true);else if(S==tc.NBR_LWR_ROMAN)h=YX(s,false);else h=mY(s);A=h;rw(t,u,d,A);t=PC;u=SC}if(TL){e=t;continue e}break}}if(br>=Ri)br=Ri-1;if(jt>=ui[br].len)jt=ui[br].len-1;if(jt<0)jt=0;if(uA!=tc.HILIGHT_OFF){if(sA>=Ri)sA=Ri-1;if(TA>=ui[sA].len)TA=ui[sA].len-1;if(TA<0)TA=0;if(_A>=Ri)_A=Ri-1;if(AA>ui[_A].len)AA=ui[_A].len}oi.modified=_;return true}function $5(t,e){var r,i;var f;if(Dj(ui[t].flags2&tc.LFLAG2_SEQ))return false;f=nb(t);r=ui[t].len;for(i=0;i<r;i++){var l=f[i];if(xs[l].FieldId==tc.FIELD_SEQ){var a=xs[l].FieldCode;if(a!=null&&a.indexOf(e)>=0)return true}}return false}function t4(t){var e="toc ";var r,i;ZU("GetTocStyle");if(t>tc.CHAR_0)t-=tc.CHAR_0;e+=wY(tc.CHAR_0+t);for(r=0;r<X_;r++){if(W_[r].InUse&&W_[r].type==tc.SSTYPE_PARA&&W_[r].name==e)break}if(r<X_)return r;i=UZ();if(i<0)return 0;W_[i]=new tc.ClsStyleId;W_[i].InUse=true;W_[i].type=tc.SSTYPE_PARA;W_[i].name=e;W_[i].TypeFace=xs[0].TypeFace;W_[i].FontFamily=xs[0].FontFamily;W_[i].TwipsSize=10*20;W_[i].style=0;W_[i].TextColor=xs[0].TextColor;W_[i].TextBkColor=xs[0].TextBkColor;W_[i].CharMask=tc.CMASK_FONT|tc.CMASK_SIZE|tc.CMASK_TEXT_COLOR|tc.CMASK_TEXT_BK_COLOR;W_[i].LeftIndentTwips=200*(t-1);W_[i].ParaBkColor=jT;W_[i].TabId=0;W_[i].ParaMask=tc.PMASK_BK_COLOR|tc.PMASK_INDENT;W_[i].flags|=tc.SSFLAG_ADD;return i}_i.TerSetSectAlign=function(t,e,r){var i;if(!lv||!QD())_i.TerCreateControl();if(e!=0&&e!=tc.SECT_VALIGN_CTR&&e!=tc.SECT_VALIGN_BOT)return false;if(t==tc.SECT_CUR){B5();t=G5(br)}if(t!=tc.SECT_ALL&&(t<0||t>=ro))return false;for(i=0;i<ro;i++){if(t!=tc.SECT_ALL&&t!=i)continue;to[i].flags=_j(to[i].flags,tc.SECT_VALIGN_CTR|tc.SECT_VALIGN_BOT);to[i].flags|=e}oi.modified++;_z(true);if(r)cG();return true};_i.TerSetSectLineNbr=function(t,e,r){return _i.TerSetSectLineNbr2(t,e,1,r)};_i.TerSetSectLineNbr2=function(t,e,r,i){var f;if(!lv||!QD())_i.TerCreateControl();if(t==tc.SECT_CUR)t=G5(br);else if(t==tc.SECT_ALL)t=-1;else if(t<0||t>=ro)return false;for(f=0;f<ro;f++){if(t>=0&&f!=t)continue;if(e){to[f].flags|=tc.SECT_LINE;to[f].LineStep=r}else to[f].flags=cj(to[f].flags,tc.SECT_LINE);if(t>=0)break}oi.modified++;if(i)cG();return true};_i.TerGetSectAlign=function(t){if(!lv||!QD())_i.TerCreateControl();if(t==tc.SECT_CUR){B5();t=G5(br)}return to[t].flags&(tc.SECT_VALIGN_CTR|tc.SECT_VALIGN_BOT)};_i.TerSetPageNumFmt=function(t,e){var r;if(!lv||!QD())_i.TerCreateControl();if(t==tc.SECT_CUR){B5();t=G5(br)}if(t!=tc.SECT_ALL&&(t<0||t>=ro))return false;for(r=0;r<ro;r++){if(t!=tc.SECT_ALL&&t!=r)continue;to[r].PageNumFmt=e}return true};_i.TerGetPageNumFmt=function(t){if(!lv||!QD())_i.TerCreateControl();if(t==tc.SECT_CUR){B5();t=G5(br)}if(t<0||t>=ro)return-1;return to[t].PageNumFmt};_i.TerSetMargin=function(t,e,r,i,f){return _i.TerSetMarginEx(tc.SECT_CUR,t,e,r,i,-1,-1,f)};_i.TerSetMarginEx=function(t,e,r,i,f,l,a,n){var c;if(!lv||!QD())_i.TerCreateControl();if(t==tc.SECT_CUR){B5();t=G5(br)}if(t!=tc.SECT_ALL&&(t<0||t>=ro))return false;for(c=0;c<ro;c++){if(t!=tc.SECT_ALL&&t!=c)continue;if(e>=0)to[c].LeftMargin=VV(e);if(r>=0)to[c].RightMargin=VV(r);if(i!=-1){if(i>=0){to[c].TopMargin=VV(i);to[c].flags=cj(to[c].flags,tc.SECT_EXACT_MARGT)}else{to[c].TopMargin=VV(-i);to[c].flags|=tc.SECT_EXACT_MARGT}}if(f!=-1){if(f>=0){to[c].BotMargin=VV(f);to[c].flags=cj(to[c].flags,tc.SECT_EXACT_MARGB)}else{to[c].BotMargin=VV(-f);to[c].flags|=tc.SECT_EXACT_MARGB}}if(l>=0)to[c].HdrMargin=VV(l);if(a>=0)to[c].FtrMargin=VV(a)}oi.modified++;sH();_z(true);if(n)cG();return true};_i.TerGetMarginEx=function(t){if(!lv||!QD())_i.TerCreateControl();Ig=dg=Fg=gg=Pg=Sg=0;if(t==tc.SECT_CUR)t=G5(br);if(t<0||t>=ro)return 0;Ig=jV(to[t].LeftMargin);dg=jV(to[t].RightMargin);Fg=jV(to[t].TopMargin);if(Nj(to[t].flags&tc.SECT_EXACT_MARGT))Fg=-Fg;gg=jV(to[t].BotMargin);if(Nj(to[t].flags&tc.SECT_EXACT_MARGB))gg=-gg;Pg=jV(to[t].HdrMargin);Sg=jV(to[t].FtrMargin);return ro};_i.TerGetSectInfo=function(){var t;if(!lv||!QD())_i.TerCreateControl();hg=Og=vg=0;Mg=true;B5();t=G5(br);hg=to[t].columns;Og=to[t].ColumnSpace*1440;Mg=Nj(to[t].flags&tc.SECT_NEW_PAGE);if(Nj(to[t].flags&tc.SECT_RESTART_PAGE_NO))vg=to[t].FirstPageNo;return true};_i.TerGetSectBins=function(t){if(!lv||!QD())_i.TerCreateControl();Gg=Bg=0;if(t==tc.SECT_CUR){B5();t=G5(br)}Gg=to[t].FirstPageBin;Bg=to[t].bin;return true};_i.TerGetSeqSect=function(t){var e;if(!lv||!QD())_i.TerCreateControl();if(t>=ro)return-1;B5();e=0;while(eo[t].PrevSect>=0){e++;t=eo[t].PrevSect}return e};_i.TerCopyHeadersFooters=function(t,e,r,i,f,l,a){if(!lv||!QD())_i.TerCreateControl();if(t==e)return true;if(e4(t)<0)return false;if(e4(e)<0)return false;if(i&&!r4(t,e,tc.FTR_CHAR))return false;if(l&&!r4(t,e,tc.FFTR_CHAR))return false;if(r&&!r4(t,e,tc.HDR_CHAR))return false;if(f&&!r4(t,e,tc.FHDR_CHAR))return false;_i.TerRepaginate(a);return true};function e4(t){var e;var r;if(t==0)return 0;for(e=0;e<Ri;e++){r=ui[e].len;if(r>0&&ui[e].txt[r-1]==tc.SECT_CHAR)t--;if(t==0){if(e+1<Ri)e++;return e}}return-1}function r4(t,e,r){var i,f,l,a;if((f=e4(t))<0)return false;if(!Y5(r,f))return true;f=OC;a=pC;for(i=f;i<f+a;i++)if(Nj(ui[i].cid)||Nj(ui[i].fid))return false;if((l=e4(e))<0)return false;iw(l,a,gk("B"));if(l<f)f+=a;if(uA!=tc.HILIGHT_OFF&&l<sA)sA+=a;if(uA!=tc.HILIGHT_OFF&&l<_A)_A+=a;for(i=0;i<a;i++,f++,l++){cw(f,l);ui[l].cid=0;ui[l].fid=0}if(Y5(r,l)){l=OC;a=pC;iw(l,a,tc.CHAR_D);if(uA!=tc.HILIGHT_OFF&&l<sA)sA+=a;if(uA!=tc.HILIGHT_OFF&&l<_A)_A+=a}return true}_i.TerSetPaper=function(t,e,r,i){if(!lv||!QD())_i.TerCreateControl();xo=VV(t);yo=VV(e);if(!GR){var f=G5(br);to[f].IsPortrait=r=r}if(i4())Y$(r);K$(t,e);b5();if(i){if(oi.PrintView){yJ(false,false,0,true);Ro=oi.modified++;Fo=0}cG()}return true};function i4(){if(Nj(zh&tc.TFLAG_APPLY_PRT_PROPS))return true;return false}_i.TerSetSectBorder=function(t,e,r,i,f,l){var a,n;if(typeof f=="string")f=yK(f);if(!lv||!QD())_i.TerCreateControl();if(e<0||e>tc.BRDRTYPE_LAST)return false;if(t==tc.SECT_CUR)t=G5(br);else if(t==tc.SECT_ALL)t=-1;else if(t<0||t>=ro)return false;for(a=0;a<ro;a++){if(t>=0&&a!=t)continue;to[a].BorderType=e;if(e==tc.BRDRTYPE_NONE)to[a].border=0;else{to[a].border=15;to[a].BorderWidth=[4];to[a].BorderSpace=[4];for(n=0;n<4;n++){to[a].BorderWidth[n]=r;to[a].BorderSpace[n]=i}to[a].BorderColor=f;to[a].BorderOpts=32}if(t>=0)break}oi.modified++;if(l)cG();return true};_i.TerSetSectVertAlign=function(t,e,r){var i;if(!lv||!QD())_i.TerCreateControl();if(e!=0&&e!=tc.SECT_VALIGN_CTR&&e!=tc.SECT_VALIGN_BOT)return false;if(t==tc.SECT_CUR)t=G5(br);else if(t==tc.SECT_ALL)t=-1;else if(t<0||t>=ro)return false;for(i=0;i<ro;i++){if(t>=0&&i!=t)continue;to[i].flags=cj(to[i].flags,tc.SECT_VALIGN_CTR|tc.SECT_VALIGN_BOT);if(e==tc.SECT_VALIGN_CTR)to[i].flags|=tc.SECT_VALIGN_CTR;else if(e==tc.SECT_VALIGN_BOT)to[i].flags|=tc.SECT_VALIGN_BOT;if(t>=0)break}oi.modified++;if(r)_i.TerRepaginate(true);else _z(true);return true};_i.TerSetSectParam=function(t,e,r,i){var f;if(!lv||!QD())_i.TerCreateControl();if(t==tc.SECT_CUR)t=G5(br);else if(t==tc.SECT_ALL)t=-1;else if(t<0||t>=ro)return false;for(f=0;f<ro;f++){if(t>=0&&f!=t)continue;if(e==tc.SP_LINE_BET_COL){if(Nj(r))to[f].flags|=tc.SECT_LINE_BET_COL;else to[f].flags=cj(to[f].flags,tc.SECT_LINE_BET_COL)}else if(e==tc.SP_FLAGS)to[f].flags=r;else if(e==tc.SP_GUTTER_MARG){if(Nj(to[f].flags&tc.SECT_GUTTER_ADDED))to[f].LeftMargin-=to[f].gutter;to[f].gutter=VV(r);to[f].LeftMargin+=to[f].gutter;to[f].flags|=tc.SECT_GUTTER_ADDED}else return false;if(t>=0)break}oi.modified++;if(i)_i.TerRepaginate(true);else _z(true);return true};_i.TerGetSectParam=function(t,e){var r;var i,f;if(!lv||!QD())_i.TerCreateControl();if(t==tc.SECT_CUR){B5();t=G5(br)}if(e==tc.SP_FLAGS)return to[t].flags;else if(e==tc.SP_LINE_STEP)return to[t].LineStep;else if(e==tc.SP_BORDER_TYPE)return Nj(to[t].border)?to[t].BorderType:tc.BRDRTYPE_NONE;else if(e==tc.SP_BORDER_WIDTH)return to[t].BorderWidth[0];else if(e==tc.SP_BORDER_SPACE)return to[t].BorderSpace[0];else if(e==tc.SP_FIRST_PAGE_HDR_HT){i=to[t].FirstLine;f=ui[i].page;if(Cz(f)<0)return to[t].TopMargin*1440;else{r=jF;return HV(r.height)+to[t].HdrMargin*1440}}else if(e==tc.SP_FIRST_PAGE_BODY_HT){i=to[t].FirstLine;f=ui[i].page;return HV(po[f].BodyHt)}else if(e==tc.SP_IN_USE)return to[t].InUse?1:0;else if(e==tc.SP_PREV_SECT)return eo[t].PrevSect;else if(e==tc.SP_NEXT_SECT)return eo[t].NextSect;else if(e==tc.SP_LEFT_MARG)return to[t].LeftMargin*1440;else if(e==tc.SP_RIGHT_MARG)return to[t].RightMargin*1440;else if(e==tc.SP_TOP_MARG)return to[t].TopMargin*1440;else if(e==tc.SP_BOT_MARG)return to[t].BotMargin*1440;else if(e==tc.SP_HDR_MARG)return to[t].HdrMargin*1440;else if(e==tc.SP_FTR_MARG)return to[t].FtrMargin*1440;else if(e==tc.SP_GUTTER_MARG)return to[t].gutter*1440;else if(e==tc.SP_NUM_COLS)return to[t].columns;else if(e==tc.SP_COL_SPACE)return to[t].ColumnSpace*1440;return tc.FP_ERROR};_i.TerGetSectParamClr=function(t,e){UP=tc.CLR_AUTO;if(!lv||!QD())_i.TerCreateControl();if(t==tc.SECT_CUR){B5();t=G5(br)}if(e==tc.SP_BORDER_COLOR)UP=to[t].BorderColor;else return false;return true};_i.TerGetSectBorder=function(t){if(!lv||!QD())_i.TerCreateControl();Ng=pg=Dg=0;UP=tc.CLR_BLACK;if(t==tc.SECT_CUR)t=G5(br);if(t<0||t>=ro)return false;Ng=to[t].BorderType;if(Ng==0)Ng=tc.BRDRTYPE_NONE;if(Ng!=tc.BRDRTYPE_NONE){pg=to[t].BorderWidth[0];Dg=to[t].BorderSpace[0];UP=to[t].BorderColor}return true};_i.TerSetSectOrient=function(t,e){var r,i;r=G5(br);to[r].IsPortrait=t;if(i4())for(i=0;i<ro;i++)to[i].IsPortrait=t;b5();if(e){if(oi.PrintView){yJ(false,false,0,true);Ro=oi.modified++;Fo=0}cG()}return true};_i.TerSetSectColWidth=function(t,e,r,i,f){var l,a,n;if(!lv||!QD())_i.TerCreateControl();if(t<0)t=G5(br);if(t>=ro)return false;if(to[t].columns==1)return false;if(e<0)to[t].flags=cj(to[t].flags,tc.SECT_VAR_COL_WIDTH);else{if(e>=to[t].columns)return false;if(Dj(to[t].flags&tc.SECT_VAR_COL_WIDTH)){var c=to[t].columns;var s=eo[t].PgWidth-to[t].LeftMargin-to[t].RightMargin;s-=to[t].ColumnSpace*(c-1);s=s/c;a=s*1440;n=to[t].ColumnSpace*1440;if(a==r&&n==i)return true;for(l=0;l<c;l++){to[t].ColWidth[l]=a;to[t].ColSpace[l]=n}to[t].flags|=tc.SECT_VAR_COL_WIDTH}to[t].ColWidth[e]=r;to[t].ColSpace[e]=i}if(f){if(oi.PrintView){yJ(false,false,0,true);Ro=oi.modified++;Fo=0}cG()}return true};_i.TerGetSectColWidth=function(t,e,r){if(!lv||!QD())_i.TerCreateControl();if(t<0)t=G5(br);if(t>=ro)return-1;if(to[t].columns==1)return-1;if(Dj(to[t].flags&tc.SECT_VAR_COL_WIDTH))return-1;if(e<0||e>=to[t].columns)return-1;if(r)return to[t].ColWidth[e];else return to[t].ColSpace[e]};_i.TerSetSectTextFlow=function(t,e,r){var i;if(!lv||!QD())_i.TerCreateControl();if(e!=tc.FLOW_DEF&&e!=tc.FLOW_RTL&&e!=tc.FLOW_LTR)return false;if(t==tc.SECT_CUR)t=G5(br);else if(t==tc.SECT_ALL)t=-1;else if(t<0||t>=ro)return false;for(i=0;i<ro;i++){if(t>=0&&i!=t)continue;to[i].flow=e;if(t>=0)break}oi.modified++;if(r)_i.TerRepaginate(true);else _z(true);return true};var f4,l4;var a4=[];var n4=",";function c4(){StSearched=true;tg.stj=null;if(Nj($h&tc.TFLAG5_NO_SPELLTIME))return false;if(typeof sc!="undefined"&&sc!=null&&typeof sc.st5!="undefined"&&sc.st5!=null)tg.stj=sc.st5;else tg.stj=null;return true}_i.TerInitSpellTime=function(t){var e="";var r=0;if(tg.stj==null||Nj(tO&tc.TFLAG6_DONT_USE_SPELLTIME))return false;if(t!=null){kO=t;return true}if(KO!=""){e=KO;var i=e.charCodeAt(e.length-1);if(i!=gk("\\")&&i!=gk("/")&&i!=gk(":"))e+="\\";e+="dict35.d"}t=new SpellTime(tg.StDictUrlPrefix,tg.StDictExt,r,_i,tg.StKey);tg.ST_INTERACTIVE=sc.ST_INTERACTIVE;tg.ST_MAX_WORD_LEN=sc.ST_MAX_WORD_LEN;tg.ST_MAX_SUG_WORDS=sc.ST_MAX_SUG_WORDS;tg.ST_INTERACTIVE=sc.ST_INTERACTIVE;tg.ST_ERROR=sc.ST_ERROR;tg.ST_IGNORE=sc.ST_IGNORE;tg.ST_REPLACE=sc.ST_REPLACE;tg.ST_ADD=sc.ST_ADD;tg.ST_INTERACTIVE=sc.ST_INTERACTIVE;tg.ST_EXIT=sc.ST_EXIT;kO=t;return true};_i.TerResetUserDict=function(t){h4(t)};_i.TerGetSpellTimeObject=function(){return kO};function s4(){var t,e;if(be!=br)return false;t=Q>=q&&Q<=q+$;e=jt>=q&&jt<=q+$;return t&&e}_i.TerResetAutoSpell=function(){var t;if(!lv||!QD())TerCreateControl();for(t=0;t<Ri;t++)ui[t].flags2=cj(ui[t].flags2,tc.LFLAG2_SPELL_CHECKED);cG();return true};function _4(){return oi.WordWrap&&Dj(oi.ReadOnly)&&kO!=null&&Nj(qh&tc.TFLAG4_AUTO_SPELL)}function o4(t){var e,r,i,f=-1,a=0,n=-1,c=-1;var s,_,o,u;var T;var A;var E="";var R=false;r=ui[t].len;if(r==0)return true;if(Nj(rO&tc.TFLAG8_DONT_SPELL_CHECK_HDR_FTR)&&Nj(Nc[ui[t].pfmt].flags&tc.PAGE_HDR_FTR))return true;T=nb(t);f=-1;for(e=0;e<r;e++){i=T[e];if(Nj(xs[i].flags&tc.FFLAG_AUTO_SPELL)){if(i!=f){a=uy(i,tc.FFLAG_AUTO_SPELL,false);f=i}T[e]=a}}A=Wk(ui[t].txt,0,ui[t].len);_=o=0;while(true){mP=E;Kd=_;jd=o;if((s=P4(A,ui[t].len))<=0)break;E=mP;_=Kd;o=jd;jd=o;if(A4(A,E,_,ui[t].len))continue;o=jd;r=E.length;for(e=0;e<r;e++){i=T[_+e];if(i==0||i==c)continue;if(i==n)break;if(xs[i].FieldId==tc.FIELD_NAME||um(i)||Nj(eO&tc.TFLAG7_NO_SPELLCHECK_FIELDS)&&xs[i].FieldId>0||Nj(xs[i].style&(tc.PICT|tc.PROTECT|tc.SUPSCR|tc.SUBSCR))){n=i;break}else c=i}if(e>0){E=cV(E,0,e);o-=s-e;s=e}else continue;if(be>=0){var L=be==t&&Q>=_&&Q<=_+s;var C=br==t&&jt>=_&&jt<=_+s;if(L){if(C){R=true;q=_;$=s;continue}else if(be==t)be=-1}}if(u4(E))continue;if(!F4(E,0)){u=cr;if(Nj(u&tg.ST_ERROR))break;f=-1;for(e=0;e<s;e++){i=T[_+e];if(i!=f){a=uy(i,tc.FFLAG_AUTO_SPELL,true);f=i}T[_+e]=a}if(Ck(E,"xxx")&&E.length>3){var I=E.substr(0,E.length-3);kO.StDelUserWord(I);n4="";for(l=0;l<Ri;l++)ui[l].flags2=cj(ui[l].flags2,tc.LFLAG2_SPELL_CHECKED)}}else T4(E)}sb(t);if(R)ti=true;else{ui[t].flags2|=tc.LFLAG2_SPELL_CHECKED;if(!s4()&&be==t)be=-1}return true}function u4(t){t=","+t+",";return n4.indexOf(t)>=0}function T4(t){n4+=t+","}function A4(t,e,r,i){var f,l;var a=Uk(t);if(Tk(e,"http")==0||Tk(e,"https")==0||Tk(e,"www")==0){l=e.length;for(f=r+l;f<i;f++)if(a[f]==tc.SPACE)break;jd=f;return true}if(r>0&&a[r-1]==tc.PERIOD){l=e.length;if(r+l<i){if(a[r+l]==tc.PERIOD)return true;if(l>=40&&a[r+l]!=tc.SPACE){for(f=jd;f<i;f++)if(a[f]==tc.SPACE||a[f]==tc.PERIOD)break;jd=f;return true}}}return false}_i.TerSpellCheckCurWord=function(t,e){var r=new MouseEvent("click",{clientX:t,clientY:e});return R4(r)};function E4(t){var e;var r=0,i=0;$Q(t,true);return C4(Da,Ma,r,i)}function R4(t){var e;var r=0,i=0;var f,l,a,n;var c;var s;if(uA!=tc.HILIGHT_OFF)return true;if(ei){ei=false;rv=iv}$Q(t,true);Ke=Da;Fe=Ma;if(!C4(Da,Ma,r,i))return false;e=mP;r=Kd;i=Yd;if(F4(e,0)){for(c=0;c<Ri;c++)ui[c].flags2=cj(ui[c].flags2,tc.LFLAG2_SPELL_CHECKED);repaint();return false}var _=O4();if(_>6)_=6;_i.TerTextPosToPix(tc.REL_WINDOW,Da,r+i);f=td;l=ed;var o=new tc.JMenuItem;n=tc.IDP_FIRST_WORD;for(a=0;a<_;a++,n++){a4[a]=v4(a);zj(o,a4[a],n,false,null,true)}if(_>0)Zj(o,true);zj(o,tg.MsgString[tc.MSG_IGNORE_ALL],tc.IDP_IGNORE,false,null,true);zj(o,tg.MsgString[tc.MSG_ADD],tc.IDP_ADD,false,null,true);ei=true;xj(f,l+yV(ui[Da].height),o.item,-1);rv=iv;return true}function L4(t){var e;var r=0,i=0,f=0,l=0;var a;var n=uE;var c="";rv=iv;if(!C4(Ke,Fe,r,i))return false;e=mP;r=Kd;i=Yd;if(t>=tc.IDP_FIRST_WORD&&t<=tc.IDP_LAST_WORD){d4(e,Ke,r,l,f,a4[t-tc.IDP_FIRST_WORD],n);l=jd;f=Vd;ui[Ke].flags2=cj(ui[Ke].flags2,tc.LFLAG2_SPELL_CHECKED)}else if(t==tc.IDP_IGNORE||t==tc.IDP_ADD){e=N4(e);var s=e.indexOf("'s");if(s>0)e=cV(e,0,s);if(t==tc.IDP_IGNORE)D4(e,tc.CHAR_I,"");else{p4(e);h4(null)}for(a=0;a<Ri;a++)ui[a].flags2=cj(ui[a].flags2,tc.LFLAG2_SPELL_CHECKED)}cG();return true}function C4(t,e,r,i){var f;var l,a,n,c,s;var _="";Kd=r;Yd=i;if(t<0||t>=Ri)return false;a=ui[t].len;if(e<0||e>=a)return false;f=nb(t);n=f[e];if(Dj(xs[n].flags&tc.FFLAG_AUTO_SPELL))return false;for(l=e-1;l>=0;l--){n=f[l];if(Dj(xs[n].flags&tc.FFLAG_AUTO_SPELL))break}c=l+1;s=0;for(l=c;l<a;l++,s++){n=f[l];if(Dj(xs[n].flags&tc.FFLAG_AUTO_SPELL))break}sb(t);var o=ui[t].txt;mP=Wk(o,c,s);Kd=c;Yd=s;return true}_i.TerSpellCheck=function(t,e){var r;return _i.TerSpellCheck2(t,e)};_i.TerSpellCheck2=function(t,e){var r,i;var f,l;var a,n,c,s,_;var o;var u;var T=0,A=0;var E="";var R=null;var L=-1,C,I=-1;var d;var F;var g;var P;var S=null;EF=false;if(kO==null)return false;g=uE;if(uA==tc.HILIGHT_LINE){ON();r=sA;f=0;i=_A;l=ui[i].len;if(l<0)l=0;uA=tc.HILIGHT_OFF;OA=false}else if(uA==tc.HILIGHT_CHAR){ON();r=sA;f=TA;if(f>=ui[r].len)f=ui[r].len-1;if(f<0)f=0;i=_A;l=AA-1;if(l>=ui[i].len)l=ui[i].len-1;if(l<0)l=0;if(r==i&&f>l)f=l;uA=tc.HILIGHT_OFF;OA=false}else{r=0;f=0;i=Ri-1;if(i<0)i=0;l=ui[i].len;if(l<0)l=0}if(Dj(zh&tc.TFLAG_NO_HOUR_GLASS)){R=JQ();XQ(U)}F=Zh&tc.TFLAG2_NO_AUTO_REPAGE;Zh|=tc.TFLAG2_NO_AUTO_REPAGE;nO|=tc.TOFLAG2_NO_WRAP;if(Dj($h&tc.TFLAG5_NO_CLEAR_SPL_HIST))g4();t:{for(br=r;br<=i;br++){if(ui[br].len==0)continue;if(Nj(rO&tc.TFLAG8_DONT_SPELL_CHECK_HDR_FTR)&&Nj(Nc[ui[br].pfmt].flags&tc.PAGE_HDR_FTR))continue;if(oi.PageMode&&Nj(Nc[ui[br].pfmt].flags&tc.PAGE_HDR_FTR)&&!p5(br))continue;o=Wk(ui[br].txt,0,ui[br].len);n=0;while(true){if(n>=ui[br].len)break;c=ui[br].len;while(true){mP=E;Kd=f4;jd=n;if((l4=P4(o,c))<=0)break;E=mP;f4=Kd;n=jd;if(n>=ui[br].len)break;if(br==r&&f4<f)continue;if(br==i&&f4>l)continue;jd=n;if(A4(o,E,f4,c))continue;n=jd;if(n>=ui[br].len)break;d=nb(br);s=E.length;for(a=0;a<s;a++){C=d[f4+a];if(C==0||C==I)continue;if(C==L)break;if(xs[C].FieldId==tc.FIELD_NAME||um(C)||Nj(eO&tc.TFLAG7_NO_SPELLCHECK_FIELDS)&&xs[C].FieldId>0||Nj(xs[C].style&(tc.PICT|tc.PROTECT|tc.SUPSCR|tc.SUBSCR))||xs[C].rtl){L=C;break}else I=C}sb(br);if(a>0){E=cV(E,0,a);n-=l4-a;s=l4=a}else continue;if(!F4(E,0)){var h;_=cr;if(Nj(_&tg.ST_ERROR))break t;if(t)return false;if(R!=null)XQ(R);var O=br;I4();br=O;h=nO;nO|=tc.TOFLAG2_NO_WRAP;F4(E,tg.ST_INTERACTIVE);_=cr;nO=h;br=O;if(Nj(_&(tg.ST_IGNORE|tg.ST_REPLACE|tg.ST_ADD|tg.ST_INPUT))){A++}else if(Nj(_&(tg.ST_EXIT|tg.ST_ERROR))){if(Nj(_&tg.ST_EXIT))EF=true;break t}P=S4();if(P.length>0){d4(E,br,f4,n,c,P,g);n=jd;c=Vd;c=ui[br].len;o=Wk(ui[br].txt,0,ui[br].len)}if(R!=null)XQ(U)}T++}if(c==ui[br].len)break;n=c}ui[br].flags2=cj(ui[br].flags2,tc.LFLAG2_SPELL_CHECKED)}br=i}h4(null);if(R!=null)XQ(R);uA=tc.HILIGHT_OFF;if(Dj(F))Zh=_j(Zh,tc.TFLAG2_NO_AUTO_REPAGE);uj(tc.TOFLAG2_NO_WRAP);if(br-fr>=Dt-1||br-fr<0){fr=br-Dt/2;if(fr<0)fr=0}we=br-fr;jt=0;Br=tc.PAINT_WIN;cG();u=tg.MsgString[tc.MSG_SPL_CHECKED]+mY(T)+" "+tg.MsgString[tc.MSG_SPL_INCORRECT]+mY(A);if(e&&!t)qk(u,tg.MsgString[tc.MSG_SPELL_OVER]);return A==0};function I4(){uA=tc.HILIGHT_CHAR;sA=_A=br;jt=TA=f4;AA=f4+l4;if(br-fr>Dt/2||br-fr<0){fr=br-Dt/4;if(fr<0)fr=0}we=br-fr;yn=tc.WRAP_OFF;aO|=tc.TOFLAG_NO_ADJUST_POS;if(!VR)TerEngageCaret(true);Ui=true;cG();oj(tc.TOFLAG_NO_ADJUST_POS)}function d4(t,e,r,i,f,l,a){var n,c,s,_,o;var u;jd=i;Vd=f;n=t.length;c=l.length;s=c-n;if(s!=0){if(ui[e].len+s>ft-1)return false;i=i+s;f=f+s}uE=a;V8(e,r,e,r+n,gk("D"));if(s<0)fw(e,r,Math.abs(s),gk("D"));if(s>0)fw(e,r,Math.abs(s),gk("B"));u=ui[e].txt;var T=Uk(l);for(_=0;_<c;_++)u[r+_]=T[_];uE=a;V8(e,r,e,r+c,gk("I"));o=Lq(e,r);HD(_i,o,t,l);ui[e].flags2=cj(ui[e].flags2,tc.LFLAG2_SPELL_CHECKED);oi.modified++;jd=i;Vd=f;return true}function F4(t,e){if(kO==null)return false;var r=new sc.StInteger(0);var i=kO.SpellWord(t,e,r);cr=r.getValue();return i}function g4(){if(kO==null)return false;return kO.StClearHist()}function P4(t,e){if(kO==null)return 0;var r=new sc.StString(mP);var i=new sc.StInteger(Kd);var f=new sc.StInteger(jd);var l=kO.StParseLine(t,r,i,f,e);mP=r.getValue();Kd=i.getValue();jd=f.getValue();return l}function S4(){if(kO==null)return"";return kO.StGetReplacement()}function h4(t){if(kO==null)return false;return kO.StResetUserDict(t,null)}function O4(){if(kO==null)return 0;return kO.StGetAlternateWordCount()}function v4(t){if(kO==null)return"";return kO.StGetAlternateWord(t)}function p4(t){if(kO==null)return false;return kO.ToUserDict(t)}function N4(t){if(kO==null)return"";return kO.StStrLwr(t)}function D4(t,e,r){if(kO==null)return false;return kO.ToSpellHist(t,e,r)}function M4(){Q_=!Q_;Ex(Ti);Ro=-1;Fo=0;cG();return true}_i.TerAcceptChanges=function(t,e,r){var i;var f;var l,a;var n=0,c;var s=false;if(!lv||!QD())_i.TerCreateControl();if(Z_)return-1;if(!t){if(G4(br,jt)){if(r)cG();return 1}else return 0}if(e&&tc.MSGRESULT_CANCEL==qk(tg.MsgString[tc.MSG_ACCEPT_CHANGES],"",tc.MSGTYPE_OK_CANCEL))return-1;i=uE;f=br;l=jt;br=0;jt=0;a=ib(br,jt);s=H4(a,ui[br].pfmt);while(s||_i.TerFindNextChange(true,false)){s=false;uE=i;if(!G4(br,jt))break;if(br==Ri-1&&jt+1>=ui[br].len){n++;break}if(br==0&&jt==0){a=ib(br,jt);s=H4(a,ui[br].pfmt)}else{a=ib(br,jt);if(m4(a))Em()}n++}if(n==0){br=f;jt=l}else if(r){cG()}if(e){var _=tg.MsgString[tc.MSG_CHANGES_COUNT]+" "+mY(n);qk(_,"",tc.MSGTYPE_ALERT)}return n};function G4(t,e){var r,i,f,l,a,n=uE;var c,s,_;var o,u,T,A;var E;var R=false;t:{a=ui[t].pfmt;if(Nc[a].FmtRev==0)break t;Y4(t,tc.TRACK_NONE);uE=n;R=true}f=ib(t,e);if(!m4(f))return R;s=_=t;o=u=e;if(!b4(s,o))return false;s=rI;o=$C;if(!_i.TerLocateChangedChar2(xs[f].InsRev,xs[f].DelRev,xs[f].FmtRev,false,_,u,true))return false;_=zC;u=ZC;if(xs[f].DelRev>0){var L=Nj(zh&tc.TFLAG_UNPROTECTED_DEL);var C=tO;var I=iO;sA=s;TA=o;_A=_;AA=u;OA=false;uA=tc.HILIGHT_CHAR;zh|=tc.TFLAG_UNPROTECTED_DEL;tO=_j(tO,tc.TFLAG6_DEL_CELL_TEXT);iO|=tc.TFLAG9_DONT_PROTECT_PARA_BEF_TABLE;_i.TerDeleteBlock(false);tO=C;iO=I;if(!L)Aj(tc.TFLAG_UNPROTECTED_DEL);return true}V8(s,o,_,u,tc.CHAR_F);for(c=s;c<=_;c++){T=c==s?o:0;A=c==_?u:ui[c].len;E=nb(c);for(r=T;r<A;r++){i=E[r];l=xs[i].InsRev;i=V4(i,tc.TRACK_NONE);if(ul[l].InsColor==xs[i].TextColor){}if(Nj(ul[l].InsStyle&xs[i].style)){i=Db(i,ul[l].InsStyle,false)}E[r]=i}sb(c)}oi.modified++;return true}_i.TerRejectChanges=function(t,e,r){var i;var f;var l,a;var n=0,c;var s=false;if(!lv||!QD())_i.TerCreateControl();if(Z_)return-1;if(!t){if(B4(br,jt)){if(r)cG();return 1}else return 0}if(e&&tc.MSGRESULT==qk(tg.MsgString[tc.MSG_REJECT_CHANGES],"",tc.MSGTYPE_OK_CANCEL))return-1;i=uE;f=br;l=jt;br=0;jt=0;a=ib(br,jt);s=H4(a,ui[br].pfmt);while(s||_i.TerFindNextChange(true,false)){s=false;uE=i;if(!B4(br,jt))break;a=ib(br,jt);if(m4(a))Em();n++}if(n==0){br=f;jt=l}else if(r){cG()}if(e){var _=tg.MsgString[tc.MSG_REJECT_COUNT]+" "+mY(n);qk(_,"",tc.MSGTYPE_ALERT)}return n};function B4(t,e){var r,i,f,l;var a,n,c;var s,_,o,u,T,A;var E;var R=false;var L=uE;t:{T=ui[t].pfmt;if(Nc[T].FmtRev==0)break t;A=Nc[T].FmtOrigPara;if(A>=0&&A<Dc){JZ(t);n=zC;c=iI;_i.TerSetParaId(n,c,A);uE=L}R=true}f=ib(t,e);if(!m4(f)){if(R)cG();return R}if(xs[f].DelRev>0){n=c=t;s=_=e;if(!x4(n,s))return false;n=rI;s=$C;if(!_i.TerLocateChangedChar(-1,xs[f].DelRev,false,c,_,true))return false;c=zC;_=ZC;V8(n,s,c,_,tc.CHAR_F);for(a=n;a<=c;a++){o=a==n?s:0;u=a==c?_:ui[a].len;E=nb(a);for(r=o;r<u;r++){i=E[r];l=xs[i].DelRev;i=V4(i,tc.TRACK_NO_DEL);if(false&&ul[l].DelColor==xs[i].TextColor){i=fx(i,pJ(tc.CLR_AUTO),0,"",a,r)}if(Nj(ul[l].DelStyle&xs[i].style)){i=Db(i,ul[l].DelStyle,false)}E[r]=i}sb(a)}oi.modified++;return true}if(xs[f].FmtRev>0){n=c=t;s=_=e;if(!b4(n,s))return false;n=rI;s=$C;if(!_i.TerLocateChangedChar2(-1,-1,xs[f].FmtRev,false,c,_,true))return false;c=zC;_=ZC;V8(n,s,c,_,tc.CHAR_F);for(a=n;a<=c;a++){o=a==n?s:0;u=a==c?_:ui[a].len;E=nb(a);for(r=o;r<u;r++){i=E[r];if(xs[i].FmtRev==0)continue;i=xs[i].FmtOrigFont;l=xs[i].FmtRev;if(l>0){i=V4(i,tc.TRACK_NO_FMT);if(Nj(ul[l].FmtStyle&xs[i].style)){i=Db(i,ul[l].FmtStyle,false)}}E[r]=i}sb(a)}oi.modified++;return true}if(xs[f].InsRev>0){var C=Nj(zh&tc.TFLAG_UNPROTECTED_DEL);n=c=t;s=_=e;if(!b4(n,s))return false;n=rI;s=$C;if(!_i.TerLocateChangedChar(xs[f].InsRev,xs[f].DelRev,false,c,_,true))return false;c=zC;_=ZC;sA=n;TA=s;_A=c;AA=_;OA=false;uA=tc.HILIGHT_CHAR;zh|=tc.TFLAG_UNPROTECTED_DEL;_i.TerDeleteBlock(false);if(!C)Aj(tc.TFLAG_UNPROTECTED_DEL);return true}return true}function H4(t,e){return m4(t)||w4(e)}function m4(t){return xs[t].InsRev>0||xs[t].DelRev>0||xs[t].FmtRev>0}function w4(t){return Nc[t].FmtRev>0}function b4(t,e){var r=t;var i,f,l=e;var a;rI=t;$C=e;if(l==0){i=ui[r].pfmt;f=Nc[i].FmtRev}else f=0;a=ib(r,l);if(_i.TerLocateChangedChar3(xs[a].InsRev,xs[a].DelRev,xs[a].FmtRev,f,false,r,l,false)){r=zC;l=ZC;Rm(r,l);r=PC;l=SC}else{var n=ib(0,0);if(xs[n].InsRev==xs[a].InsRev&&xs[n].DelRev==xs[a].DelRev&&xs[n].FmtRev==xs[a].FmtRev){r=0;l=0}else return false}t=rI=r;e=$C=l;return true}function x4(t,e){var r=t;var i=e;var f;rI=t;$C=e;f=ib(r,i);if(_i.TerLocateChangedChar(-1,xs[f].DelRev,false,r,i,false)){r=zC;i=ZC;Rm(r,i);r=PC;i=SC}else{var l=ib(0,0);if(xs[l].DelRev==xs[f].DelRev){r=0;i=0}else return false}t=rI=r;e=$C=i;return true}_i.TerFindNextChange=function(t,e){var r;var i=false;var f;var l;if(!lv||!QD())_i.TerCreateControl();f=br;l=jt;t:{r=ib(f,l);if(xs[r].DelRev>0){if(!_i.TerLocateChangedChar(-1,xs[r].DelRev,false,f,l,t))break t;f=zC;l=ZC}else if(xs[r].InsRev>0){if(!_i.TerLocateChangedChar(xs[r].InsRev,0,false,f,l,t))break t;f=zC;l=ZC}else if(xs[r].FmtRev>0){if(!_i.TerLocateChangedChar2(-1,-1,xs[r].FmtRev,false,f,l,t))break t;f=zC;l=ZC}else if(l==0&&p9(f)){var a=ui[f].pfmt;if(Nc[a].FmtRev>0){if(t)Rm(f,l);else Em(f,l);f=PC;l=SC}}i=_i.TerLocateChangedChar3(-1,-1,-1,-1,true,f,l,t);f=zC;l=ZC;if(i&&!t){b4(f,l);f=rI;l=$C}}if(i){jt=l;if(e)Iq(f+1);else br=f}else{if(e)qk(tg.MsgString[tc.MSG_NO_CHANGED_TEXT],"",tc.MSGTYPE_ALERT)}return i};_i.TerDeleteReviewer=function(t){var e;if(!lv||!QD())_i.TerCreateControl();if(t<=0||t>=Al)return false;if(Z_)return false;J4(t);for(e=t;e<Al-1;e++)ul[e]=ul[e+1];Al--;for(e=0;e<Ys;e++){if(xs[e].InsRev>t)xs[e].InsRev--;if(xs[e].DelRev>t)xs[e].DelRev--;if(xs[e].FmtRev>t)xs[e].FmtRev--}return true};_i.TerGetReviewerInfo=function(t){if(!lv||!QD())_i.TerCreateControl();LP="";if(t<=0||t>=Al)return false;LP=ul[t].name;return true};_i.TerLocateChangedChar=function(t,e,r,i,f,l){return _i.TerLocateChangedChar2(t,e,-1,r,i,f,l)};_i.TerLocateChangedChar2=function(t,e,r,i,f,l,a){return _i.TerLocateChangedChar3(t,e,r,-1,i,f,l,a)};_i.TerLocateChangedChar3=function(t,e,r,i,f,l,a,n){var c;var s,_,o,u,T,A,E,R;var L;if(!lv||!QD())_i.TerCreateControl();zC=l;ZC=a;for(s=0;s<Ys;s++)xs[s].flags=cj(xs[s].flags,tc.FFLAG_CHECKED);if(n){for(c=l;c<Ri;c++){if(c==l)_=a;else _=0;if(_>=ui[c].len)continue;if(ui[c].len==0)continue;L=nb(c);for(s=_;s<ui[c].len;s++){u=L[s];if(Nj(xs[u].flags&tc.FFLAG_CHECKED)&&s!=0)continue;xs[u].flags|=tc.FFLAG_CHECKED;T=xs[u].InsRev;A=xs[u].DelRev;E=xs[u].FmtRev;if(s==0){o=ui[c].pfmt;R=Nc[o].FmtRev}else R=0;if(y4(f,t,e,r,i,T,A,E,R)){l=zC=c;a=ZC=s;sb(c);return true}}sb(c);if(c==Ri-1){l=zC=c;a=ZC=ui[c].len;return true}}}else{for(c=l;c>=0;c--){if(c==l)_=a;else _=ui[c].len-1;if(_<0)continue;if(ui[c].len==0)continue;L=nb(c);for(s=_;s>=0;s--){u=L[s];if(Nj(xs[u].flags&tc.FFLAG_CHECKED)&&s!=0)continue;xs[u].flags|=tc.FFLAG_CHECKED;T=xs[u].InsRev;A=xs[u].DelRev;E=xs[u].FmtRev;if(s==0){o=ui[c].pfmt;R=Nc[o].FmtRev}else R=0;if(y4(f,t,e,r,i,T,A,E,R)){l=zC=c;a=ZC=s;sb(c);return true}}sb(c)}}return false};function y4(t,e,r,i,f,l,a,n,c){var s=0,_=0;if(t){if(e>=0)_++;if(r>=0)_++;if(i>=0)_++;if(f>=0)_++;if(_==0)_=1;if(e==-1&&l>0)s++;else if(e==0&&l==0)s++;else if(e>0&&l==e)s++;if(r==-1&&a>0)s++;else if(r==0&&a==0)s++;else if(r>0&&a==r)s++;if(i==-1&&n>0)s++;else if(i==0&&n==0)s++;else if(i>0&&n==i)s++;if(f==-1&&c>0)s++;else if(f==0&&c==0)s++;else if(f>0&&c==f)s++;return s>=_}else{var o=true;if(o&&e>=0&&e!=l)o=false;if(o&&r>=0&&r!=a)o=false;if(o&&i>=0&&i!=n)o=false;if(o&&f>=0&&f!=c)o=false;return!o}}function W4(t,e,r,i,f,l,a){if(t){if(i>=0&&i!=a)return false;if(e==r&&e>0){if(e==f||r==l)return true}else{if(e==f&&r==l)return true;if(e==f&&r==-1)return true;if(e==-1&&r==l)return true;if(e<0&&r<0&&(f>0||l>0))return true}}else{if(i>=0){if(i>0&&i==a)return false;if(i==0&&a>0)return false}if(e==r&&e>0){if(e!=f&&r!=l)return true}else{if(e>=0&&r>=0&&(e!=f||r!=l))return true;if(e<0&&r>=0&&r!=l)return true;if(r<0&&e>=0&&e!=f)return true;if(e<0&&r<0&&(f==0&&l==0))return true}}return false}function U4(t,e,r,i,f,l){var a;var n,c,s,_,o;var u;var T;var A;var E;var R;var L=0,C,I,d;if(!Z_)return false;if(t==0&&e==0&&r==Ri-1&&i>=ui[r].len){i--;if(i<0&&r>0){r--;i=ui[r].len-1}}A=false;for(a=t;a<=r;a++){if(Dj(ui[a].flags2&tc.LFLAG2_INS_REV)){A=true;break}c=a==t?e:0;s=a==r?i:ui[a].len;u=nb(a);for(n=c;n<s;n++){o=u[n];if(xs[o].InsRev!=q_){A=true;break}}sb(a);if(A)break}if(!A)return false;I=_=Lq(r,i);C=uE;V8(t,e,r,i-1,tc.CHAR_D);d=Ys;T=[d+1];for(n=0;n<d;n++)T[n]=-1;for(a=t;a<=r;a++){c=a==t?e:0;s=a==r?i:ui[a].len;E=Dj(ui[a].flags2&tc.LFLAG2_INS_REV);if(E){u=nb(a);for(n=c;n<s;n++){o=u[n];if(xs[o].DelRev!=q_){if(o<d&&T[o]>=0)u[n]=T[o];else{u[n]=V4(u[n],tc.TRACK_DEL);if(o<d)T[o]=u[n]}}}sb(a);continue}R=true;u=nb(a);for(n=c;n<s;n++){o=u[n];if(xs[o].InsRev!=q_||Nj(xs[o].DelRev)){R=false;break}}sb(a);if(R&&c==0&&s==ui[a].len){L+=ui[a].len;_-=ui[a].len;if(a<br)br--;if(a==br){if(br>0)br--;jt=ui[br].len-1}iw(a,1,tc.CHAR_D);r--;a--;continue}u=nb(a);for(n=c;n<s;n++){o=u[n];if(Nj(xs[o].DelRev))continue;if(xs[o].InsRev==q_){fw(a,n,1,tc.CHAR_D);u=nb(a);n--;s--;_--;L++;if(a==br&&n<jt)jt--}else{if(xs[o].DelRev!=q_)u[n]=V4(u[n],tc.TRACK_DEL)}}sb(a)}uE=C;I-=L;Cq(I);r=PC;i=SC;V8(t,e,r,i-1,tc.CHAR_I);Cq(_,gk("C"));if(false&&t==0&&e==0&&r==Ri-1&&i+1>=ui[r].len){Ri++;br=Ri-1;Ip(br);ui[br].fid=0;ui[br].cid=0;ui[br].pfmt=0}if(br>=Ri)br=Ri-1;if(jt>=ui[br].len)jt=ui[br].len-1;if(jt<0)jt=0;nO|=tc.TOFLAG2_TRACK_DELETION;if(f)uA=tc.HILIGHT_OFF;if(l)cG();return true}function k4(t,e,r){var i;var f;var l=br;if(!Z_)return false;i=ib(t,e);if(Nj(xs[i].style&tc.PICT))return false;if(xs[i].InsRev==q_)return false;t:{if(Nj(xs[i].DelRev))break t;V8(t,e,t,e,tc.CHAR_F);f=nb(t);f[e]=V4(f[e],tc.TRACK_DEL);sb(t)}if(r)Rm();oi.modified++;return true}_i.TerEnableTracking=function(i,f,l,a,n,c,s){var t=i&&(f==null||f=="");if(t){f=Mp(tg.UserNameStorageFile);if(f!=null&&f.length>0)_=false}if(!t)return X4(i,f,l,a,n,c,s);var e=_i.DlgCompHeight;var r=_i.DlgFont;var _=new $t.DialogBox(te,"Reviewer Information",r,true,A);var o=_.cvs;var u=new $t.Label(o,0,0,r,"Your Name");_.addComp(u,0,0,1,3,"Left","bottom");var T=new $t.TextBox(o,0,0,JV(400),e,"",r,_i.caret,false,true,null);_.addComp(T,1,0,1,3,"left","middle");_.show();T.setFocus();function A(t,e,r){if(t=="Cancel"){_.hide();return}else if(t=="OK"){f=T.getText();if(f.length==0){return}Gp(tg.UserNameStorageFile,f);_.hide();return X4(i,f,l,a,n,c,s)}else return}};function X4(t,e,r,i,f,l,a){var n=null;var c;var s;var _=false;if(typeof f=="string")f=yK(f);if(typeof a=="string")a=yK(a);if(!lv||!QD())_i.TerCreateControl();if(!oi.WordWrap)return false;if(Z_==t){if(!r&&e!=null){for(c=1;c<Al;c++)if(Tk(ul[c].name,e)==0)break;if(c<Al){ul[c].InsStyle=i;ul[c].DelStyle=l;ul[c].InsColor=f;ul[c].DelColor=a;ul[c].FmtColor=f}}return true}Z_=t;if(t){if(Nj(e)&&e.length>0)n=e;else n="Unknown";for(c=1;c<Al;c++)if(Tk(ul[c].name,n)==0)break;if(c==Al){c=j4();ul[c].name=n;_=true;if(r){ul[c].InsStyle=0;ul[c].DelStyle=tc.STRIKE;s=tc.CLR_AUTO;if(c==1)s=new tc.Color(255,0,0);else if(c==2)s=new tc.Color(0,255,0);else if(c==3)s=new tc.Color(0,0,255);else if(c==4)s=new tc.Color(255,255,0);else if(c==5)s=new tc.Color(255,0,255);else if(c==6)s=new tc.Color(0,255,255);else if(c==7)s=new tc.Color(128,0,0);else if(c==8)s=new tc.Color(0,128,0);else if(c==9)s=new tc.Color(0,0,128);else if(c==10)s=new tc.Color(128,128,0);else if(c==11)s=new tc.Color(128,0,128);else if(c==12)s=new tc.Color(0,128,128);ul[c].InsColor=ul[c].DelColor=s}}if(!r){ul[c].InsStyle=i;ul[c].DelStyle=l;ul[c].InsColor=f;ul[c].DelColor=a;ul[c].FmtColor=f}q_=c;$_=new tc.ClsDate;$_.dt=new Date;ES=true;if(!_){Ex(Ti);_z(true);cG()}}else{q_=0;$_=null}return true}function K4(t,e){var r=ib(t,e);var i;var f=null;GP="";if(Nj(tO&tc.TFLAG6_NO_TRACK_MSG))return false;if(Q_)return false;t:{if(Dj(xs[r].InsRev)&&Dj(xs[r].DelRev)&&Dj(xs[r].FmtRev))break t;if(Nj(xs[r].InsRev)){i=xs[r].InsRev;if(xs[r].InsTime!=null)f=xs[r].InsTime.dt;GP+=tg.MsgString[tc.MSG_INSERTED_BY]+ul[i].name;if(f!=null)GP+="\n    @ "+f.toDateString()}if(Nj(xs[r].DelRev)){i=xs[r].DelRev;if(xs[r].DelTime!=null)f=xs[r].DelTime.dt;else f=null;if(GP.length>0)GP+="\n";GP+=tg.MsgString[tc.MSG_DELETED_BY]+ul[i].name;if(f!=null)GP+="\n    @ "+f.toDateString()}if(Nj(xs[r].FmtRev)){i=xs[r].FmtRev;if(xs[r].FmtTime!=null)f=xs[r].FmtTime.dt;else f=null;if(GP.length>0)GP+="\n";GP+=tg.MsgString[tc.MSG_FMT_BY]+ul[i].name;if(f!=null)GP+="\n    @ "+f.toDateString()}}var l=ui[t].pfmt;if(Nj(Nc[l].FmtRev)){i=Nc[l].FmtRev;if(Nc[l].FmtTime!=null)f=Nc[l].FmtTime.dt;else f=null;if(GP.length>0)GP+="\n";GP+=tg.MsgString[tc.MSG_PARA_FMT_BY]+ul[i].name;if(f!=null)GP+="\n    @ "+f.toDateString()}return GP.length>0}function Y4(t,e){var r,i;var f;var l=t,a=t;r=ui[t].pfmt;f=Nc[r].copy();if(e==tc.TRACK_FMT){f.FmtRev=q_;f.FmtTime=$_.copy()}else{f.FmtRev=0;f.FmtTime=null;f.FmtOrigPara=0}i=QZ(r,f);JZ(t);l=zC;a=iI;_i.TerSetParaId(l,a,i);return true}function V4(t,e){var r;var i;if(Nj(xs[t].style&tc.PICT)){xs[t].InsRev=0;xs[t].DelRev=0;xs[t].FmtRev=0;xs[t].InsTime=null;xs[t].DelTime=null;xs[t].FmtTime=null;if(e==tc.TRACK_INS){xs[t].InsRev=q_;xs[t].InsTime=$_.copy();xs[t].DelRev=0;xs[t].DelTime=null}else if(e==tc.TRACK_DEL){xs[t].DelRev=q_;xs[t].DelTime=$_.copy()}else if(e==tc.TRACK_NO_DEL){xs[t].DelRev=0;xs[t].DelTime=null}else{xs[t].InsRev=0;xs[t].DelRev=0;xs[t].InsTime=null;xs[t].DelTime=null}HN(t,hV(xs[t].PictHeight),dV(xs[t].PictWidth),true);mN(t);return t}i=xs[t].ShallowCopy();if(e==tc.TRACK_INS){i.InsRev=q_;i.InsTime=$_.copy();i.DelRev=0;i.DelTime=null;i.FmtRev=0;i.FmtTime=null;i.FmtOrigFont=0}else if(e==tc.TRACK_DEL){i.DelRev=q_;i.DelTime=$_.copy()}else if(e==tc.TRACK_NO_DEL){i.DelRev=0;i.DelTime=null}else if(e==tc.TRACK_FMT){i.FmtRev=q_;i.FmtTime=$_.copy()}else if(e==tc.TRACK_NO_FMT){i.FmtRev=0;i.FmtTime=null;i.FmtOrigFont=0}else{i.InsRev=0;i.DelRev=0;i.FmtRev=0;i.InsTime=null;i.DelTime=null;i.FmtTime=null;i.FmtOrigFont=0}if((r=Lb(Ti,t,i))>=0)return r;else return t}_i.TerIsDeletedLine=function(t){var e;var r,i;var f=false;if(!lv||!QD())_i.TerCreateControl();i=ui[t].len;e=nb(t);for(r=0;r<i;r++)if(xs[e[r]].DelRev==0)break;if(r==i)f=true;sb(t);return f};function j4(){var t,e;var r;if(Al>=Tl){e=Tl+Tl/2;Tl=e}ul[Al]=new tc.ClsReviewer;Al++;t=Al-1;ul[t].name="";ul[t].InsStyle=0;ul[t].DelStyle=tc.STRIKE;ul[t].FmtStyle=tc.ULINE_DOTTED;r=tc.CLR_AUTO;if(t==1)r=NJ(3683537);else if(t==2)r=NJ(13924352);else if(t==3)r=NJ(9967496);else if(t==4)r=NJ(361033);else if(t==5)r=new tc.Color(255,0,255);else if(t==6)r=new tc.Color(0,255,255);else if(t==7)r=new tc.Color(128,0,0);else if(t==8)r=new tc.Color(0,128,0);else if(t==9)r=new tc.Color(0,0,128);else if(t==10)r=new tc.Color(128,128,0);else if(t==11)r=new tc.Color(128,0,128);else if(t==12)r=new tc.Color(0,128,128);ul[t].InsColor=r.copy();ul[t].DelColor=r.copy();ul[t].FmtColor=r.copy();return Al-1}function J4(t){if(t<0||t>=Al)return false;return true}function z4(t,e){var r;if(Nj(ui[t].fid)){r=ui[t].fid;if(Nj(kl[r].flags&(tc.PARA_FRAME_RECT|tc.PARA_FRAME_LINE)))return false}if(Nj(ui[t].cid)&&Dj(Qh&tc.TFLAG3_EMBEDDED_TABLES))return false;return dm(t,e)}function Z4(t){var e;var r,i=0,f,l;var a=0,n;var c;if(iR==1&&fR==1)return true;for(e=1;e<Ri;e++){var s,_=ui[e].cid;l=eR[_].row;var o=eR[_].level;i=ui[e-1].cid;n=eR[i].row;var u=eR[i].level;if(_>0&&o<u-1){f=eR[i].ParentCell;ew(e,TR,tc.DEFAULT_CFMT,0,tc.INFO_CELL,f);if(e<Fo)Fo=e;e++;ew(e,tc.ROW_CHAR,tc.DEFAULT_CFMT,0,tc.INFO_ROW,f);e++}if(Nj(ui[e].flags&tc.LFLAG_HDRS_FTRS)&&ui[e].cid>0)ui[e].cid=0}for(r=0;r<iR;r++){$E[r].flags=cj($E[r].flags,tc.ROWFLAG_HAS_SUBTABLE);if($E[r].PrevRow==r)$E[r].PrevRow=0;if($E[r].NextRow==r)$E[r].NextRow=0}c=false;for(e=Ri-1;e>=0;e--){if(L6(e)>0){f=eR[ui[e].cid].ParentCell;if(f<0)eR[ui[e].cid].ParentCell=0;else $E[eR[f].row].flags|=tc.ROWFLAG_HAS_SUBTABLE}if(c){if(ui[e].cid==0)c=false;else if(Nj(ui[e].tabw)&&Nj(ui[e].tabw.type&(tc.INFO_ROW|tc.INFO_CELL)))a=ui[e].cid;else if(eR[ui[e].cid].level<eR[a].level)a=ui[e].cid;else if(ui[e].cid!=a&&GR){ui[e].cid=a;if(e<Fo)Fo=e}}else{if(Nj(ui[e].tabw)&&Nj(ui[e].tabw.type&(tc.INFO_ROW|tc.INFO_CELL))){c=true;a=ui[e].cid}else{if(ui[e].cid>0){ui[e].cid=0;if(e<Fo)Fo=e}}}}for(e=0;e<Ri;e++){if(ui[e].cid>0)e=$4(e,0)}for(r=0;r<fR;r++)if(eR[r].InUse){eR[r].RowSpan=1;if(eR[r].width==0)eR[r].width=1;if(eR[r].width>50*1440&&eR[r].PrevCell<=0&&eR[r].NextCell<=0)eR[r].width=10*1440}for(r=0;r<iR;r++){if(!$E[r].InUse||$E[r].FirstCell<=0)continue;a=$E[r].FirstCell;if(GR&&t&&Dj($E[r].flags&tc.ROWFLAG_HAD_ZERO_WIDTH_CELL)){if($E[r].PrevRow<0||Nj($E[r].flags&tc.ROWFLAG_NEW_TABLE))v8(a)}else if(Nj(cO&tc.TOFLAG3_SET_COL_SPAN)&&Dj($E[r].flags&tc.ROWFLAG_HAD_ZERO_WIDTH_CELL)){if($E[r].PrevRow<0||Nj($E[r].flags&tc.ROWFLAG_NEW_TABLE))v8(a)}while(a>0){rR[a].SpanningCell=0;if(Nj(eR[a].flags&tc.CFLAG_ROW_SPANNED)){var T=true;var A,E=2,R,L;A=eR[a].row;l=$E[A].PrevRow;while(l>0&&T){if(($E[A].flags&(tc.LEFT|tc.CENTER|tc.RIGHT_JUSTIFY|tc.JUSTIFY))!=($E[l].flags&(tc.LEFT|tc.CENTER|tc.RIGHT_JUSTIFY|tc.JUSTIFY)))T=false;if($E[A].indent!=$E[l].indent)T=false;if(Math.abs(d6(A)-d6(l))>tc.RULER_TOLERANCE)T=false;l=$E[l].PrevRow}i=a;if(T){L=i;while((i=p6(i,true,true))>0&&Nj(eR[i].flags&tc.CFLAG_ROW_SPANNED)){if(L==i)break;else L=i;E++}}else{L=i;while((i=P6(i,false,true))>0&&Nj(eR[i].flags&tc.CFLAG_ROW_SPANNED)){if(L==i)break;else L=i;E++}}if(i>0){if(E>eR[i].RowSpan)eR[i].RowSpan=E;rR[a].SpanningCell=i}eR[a].flags=cj(eR[a].flags,tc.CFLAG_ROW_SPANNED_LAST);if(T)R=M6(a);else R=h6(a,false);if(R<=0||Dj(eR[R].flags&tc.CFLAG_ROW_SPANNED)){eR[a].flags|=tc.CFLAG_ROW_SPANNED_LAST;rR[rR[a].SpanningCell].LastSpannedCell=a}}a=eR[a].NextCell}}for(r=0;r<iR;r++){var C;if(!$E[r].InUse)continue;if($E[r].PrevRow==r||$E[r].PrevRow>=iR)$E[r].PrevRow=0;if($E[r].NextRow==r||$E[r].NextRow>=iR)$E[r].NextRow=0;n=$E[r].PrevRow;if(n>0&&$E[n].NextRow!=r)$E[r].PrevRow=0;C=$E[r].NextRow;if(C>0&&$E[C].PrevRow!=r)$E[r].NextRow=0}for(r=0;r<iR;r++){if($E[r].PrevRow<=0){var I=r,d;for(d=$E[I].NextRow;d>0;d=$E[d].NextRow){$E[d].flags=cj($E[d].flags,tc.CENTER|tc.RIGHT_JUSTIFY|tc.JUSTIFY);$E[d].flags|=$E[I].flags&(tc.CENTER|tc.RIGHT_JUSTIFY|tc.JUSTIFY);if($E[I].TblIndType>0){$E[d].indent=$E[I].indent;$E[d].AddedIndent=$E[I].AddedIndent;$E[d].CurIndent=$E[I].CurIndent;$E[d].TblIndType=$E[I].TblIndType;$E[d].TblInd=$E[I].TblInd}}}}Q4();e6();Tj(tc.TOFLAG3_SET_COL_SPAN);return true}function Q4(){var t,e;for(t=1;t<iR;t++){if(!$E[t].InUse)continue;tR[t].flags=cj(tR[t].flags,tc.TAUX_IGNORE_EXACT_HEIGHT);for(e=$E[t].FirstCell;e>0;e=eR[e].NextCell){rR[e].MinHeight=rR[e].MinHeightWithBotPad=$E[t].MinHeight;if(eR[e].RowSpan>1)q4(t,e);else if(rR[e].MinHeight!=0&&eR[e].BotPad>0&&Dj(fO&tc.TFLAG10_DONT_PAD_TABLE_HEIGHT)){if(eR[e].BotPad>0){if(rR[e].MinHeight<0)rR[e].MinHeightWithBotPad-=eR[e].BotPad;else if(rR[e].MinHeight>0)rR[e].MinHeightWithBotPad+=eR[e].BotPad}}}}return true}function q4(t,e){var r=$E[t].MinHeight;var i=0;var f=t;t=$E[t].NextRow;for(i=1;i<eR[e].RowSpan&&t>0;i++){var l=$E[t].MinHeight;if(l<0)r=-(Math.abs(r)+Math.abs(l));else if(l>0)r=Math.abs(r)+Math.abs(l);else r=Math.abs(r);t=$E[t].NextRow}if($E[f].MinHeight<0&&r>=0)tR[f].flags|=tc.TAUX_IGNORE_EXACT_HEIGHT;rR[e].MinHeight=rR[e].MinHeightWithBotPad=r;if(Dj(fO&tc.TFLAG10_DONT_PAD_TABLE_HEIGHT)){var a=K8(e);if(a>0&&eR[a].BotPad>0){if(rR[e].MinHeight<0)rR[e].MinHeightWithBotPad-=eR[a].BotPad;else if(rR[e].MinHeight>0)rR[e].MinHeightWithBotPad+=eR[a].BotPad}}return true}function $4(t,e){var r,i;var f,l,a,n,c;var s,_,o;f=a=n=-1;for(r=t;r<Ri;r++){c=ui[r].cid;if(eR[c].level<0)eR[c].level=0;if(L6(r)>e){r=$4(r,e+1);continue}c=ui[r].cid;if(c==0||eR[c].level<e){if(r>t+1){var u=ui[r-1].cid;var T=eR[u].level;if(T>e){var A=E6(e,r-1);var E=true;if(zS==2e4&&ui[r].fid>0)E=false;if(A>0&&eR[A].level==e&&E){ew(r,TR,tc.DEFAULT_CFMT,0,tc.INFO_CELL,A);if(r<Fo)Fo=r;r++;ew(r,tc.ROW_CHAR,tc.DEFAULT_CFMT,0,tc.INFO_ROW,A);r++}}else if(T==e&&c>0&&eR[c].level+1==e&&GY(r,tc.INFO_ROW)){var R=false;var L,C;if(zS>0&&zS<19e3){for(L=r+1;L<Ri;L++){if(ui[L].fid!=ui[r].fid)break;if(ui[L].cid>0&&ui[L].cid!=ui[r].cid)break;if(ui[L].cid==ui[r].cid){iw(r,1,tc.CHAR_D);for(C=r;C<L;C++)ui[C].cid=c;if(r<Fo)Fo=r;R=true;break}}}if(!R){ew(r,TR,tc.DEFAULT_CFMT,0,tc.INFO_CELL,c);if(r<Fo)Fo=r;r++}}}return r-1}if(eR[c].width<=2*eR[c].margin&&!Li&&!vr&&Dj(eR[c].flags&tc.CFLAG_MERGED)){if(eR[c].width>0)eR[c].margin=0;else{eR[c].width=tc.RULER_TOLERANCE;eR[c].margin=0}}f=c;eR[f].PrevCell=-1;eR[f].NextCell=-1;eR[f].x=0;_=f;o=$E[eR[f].row].id;i=-1;for(;r<Ri;r++){if(L6(r)>e){r=$4(r,e+1);continue}l=ui[r].cid;if(r>t&&l>0&&eR[l].level<e){if(ui[r-1].tabw==null||Dj(ui[r-1].tabw.type&tc.INFO_ROW)){if(MY(Ri+1)){ew(r,tc.ROW_CHAR,tc.DEFAULT_CFMT,0,tc.INFO_ROW,ui[r-1].cid);if(r<Fo)Fo=r;l=ui[r].cid}}}if(Nj(ui[r].tabw)&&Nj(ui[r].tabw.type&tc.INFO_ROW)){if(l>0&&!eR[l].InUse)ui[r].cid=c;if(GR&&l!=c)ui[r].cid=c;l=ui[r].cid;var I=false;var d=0;if(r>0){d=ui[r-1].cid;if(d==0)I=true;else{if(eR[d].level>eR[l].level)d=E6(eR[l].level,-d);if(d!=l)I=true}}else I=true;if(I){ew(r,TR,tc.DEFAULT_CFMT,0,tc.INFO_CELL,l);if(r<Fo)Fo=r;r++;if(d>0){eR[d].NextCell=l;eR[l].PrevCell=d}$E[eR[l].row].LastCell=l}t6(r);if(Nj(tR[eR[l].row].flags&tc.TAUX_PAGE_BREAK_AFTER)){tR[eR[l].row].flags=cj(tR[eR[l].row].flags,tc.TAUX_PAGE_BREAK_AFTER);if(eR[l].level==0){var F=eR[l].row;var g=$E[F].NextRow;if(r<Fo)Fo=r;ew(r+1,tc.PAGE_CHAR,tc.DEFAULT_CFMT,0,INFO_PAGE,0);ui[r+1].flags|=tc.LFLAG_BREAK;ui[r+1].cid=0;r++;ew(r+1,Bn,tc.DEFAULT_CFMT,0,0,0);ui[r+1].cid=0;r++;$E[F].NextRow=0;if(g>0)$E[g].PrevRow=0;return r-1}}break}if(l>0&&eR[l].width<=2*eR[l].margin&&!Li&&!vr){var P=eR[l].row;if(Dj($E[P].flags&(tc.ROWFLAG_AUTO_FIT|tc.ROWFLAG_AUTO_WIDTH_RTF))){var S=eR[l].width/4;if(S<10){iw(r,1,tc.CHAR_D);eR[l].InUse=false;r--;continue}else eR[l].margin=S}}if(Nj(ui[r].tabw)&&Nj(ui[r].tabw.type&tc.INFO_CELL))i=r;c=ui[r].cid;if(c==0)break;rR[c].PrevColCell=rR[c].NextColCell=0;if(c!=_){eR[_].NextCell=c;eR[c].PrevCell=_;eR[c].NextCell=-1;eR[c].x=eR[_].x+eR[_].width;_=c}}if(r>=Ri)break;if(r==Ri||c==0||Dj(ui[r].tabw)||Dj(ui[r].tabw.type&tc.INFO_ROW)){if(MY(Ri+1)){ew(r,tc.ROW_CHAR,tc.DEFAULT_CFMT,0,tc.INFO_ROW,ui[r-1].cid);if(r<Fo)Fo=r}}if(i>=0&&i+1<r){iw(i+1,r-i-1,tc.CHAR_D);r=i+1}if(ui[r].tabw!=null&&Nj(ui[r].tabw.type&tc.INFO_ROW)&&r>0&&E6(e,r)!=E6(e,r-1)){if(MY(Ri+1)){ew(r,TR,tc.DEFAULT_CFMT,-1,tc.INFO_CELL,-1);ui[r].pfmt=ui[r+1].pfmt;ui[r].cid=ui[r+1].cid;if(r<Fo)Fo=r;r++}}s=_;a=eR[s].row;if(n>0&&Nj($E[n].flags&tc.ROWFLAG_LAST_ROW)){$E[a].flags|=tc.ROWFLAG_NEW_TABLE;n=-1}if(Nj($E[a].flags&tc.ROWFLAG_NEW_TABLE)&&Li)n=-1;$E[a].FirstCell=f;$E[a].LastCell=0;$E[a].PrevRow=n;$E[a].NextRow=-1;$E[a].id=o;tR[a].ParaFID=ui[r].fid;if(Nj($E[a].flags&tc.ROWFLAG_HDR)){if(n>0&&Dj($E[n].flags&tc.ROWFLAG_HDR))$E[a].flags=cj($E[a].flags,tc.ROWFLAG_HDR)}if(n>=0){var h,O,v,p;p=$E[a].indent;for(h=s=$E[a].FirstCell;h>0;h=eR[h].NextCell){p+=eR[h].width;s=h}v=$E[n].indent;for(h=$E[n].FirstCell;h>0;h=eR[h].NextCell)v+=eR[h].width;O=p-v;if(Math.abs(O)<tc.RULER_TOLERANCE/4&&eR[s].width>O)eR[s].width-=O}if(n>=0)$E[n].NextRow=a;n=a;c=f;while(c>0){eR[c].row=a;$E[a].LastCell=c;c=eR[c].NextCell}}return r-1}function t6(t){var e,r=ui[t].cid,i,f;var l=eR[r].row,a,n;var c=1,s=1,_,o;var u=0;while(true){if(r==0||l==0||$E[l].NextRow<=0)return true;for(e=$E[l].FirstCell;e>0;e=eR[e].NextCell){var T=eR[e].RowSpan;if(T==1||Nj(eR[e].flags&tc.CFLAG_ROW_SPANNED))return true;if(e==$E[l].FirstCell)c=s=T;else{if(T<c)c=T;else if(T>s)s=T}}if(s==c||c<=1)return true;a=$E[l].NextRow;i=t+1;u=eR[r].level;for(f=i;ui[f].cid>0;f++){e=ui[f].cid;if(eR[e].level>u)continue;if(GY(f,tc.INFO_ROW))break;if(eR[e].row!=a){f--;break}}iw(i,f-i+1,"D");n=$E[a].NextRow;$E[l].NextRow=n;if(n>0)$E[n].PrevRow=l;$E[a].InUse=false;for(e=$E[l].FirstCell;e>0;e=eR[e].NextCell)eR[e].RowSpan--;_=$E[l].MinHeight;o=$E[a].MinHeight;if(o<0)_=-(Math.abs(_)+Math.abs(o));else if(o>0)_=Math.abs(_)+Math.abs(o);else _=Math.abs(_);$E[l].MinHeight=_}}function e6(){var t,e,r,i,f,l=-1,a=0,n,c=0,s=0,_=0;var o,u,T,A,E;var R=false;var L=-1;for(f=1;f<iR;f++){if(Dj($E[f].flags&tc.ROWFLAG_TFOOT))continue;i=$E[f].FirstCell;if(i>0&&eR[i].level>L)L=eR[i].level}if(L<0)return true;for(r=L;r>=0;r--){for(t=0;t<Ri;t++){i=ui[t].cid;if(i>0){if(eR[i].level>r)i=E6(r,-i);else if(eR[i].level<r)i=0}if(i>0){f=eR[i].row;if(Nj($E[f].flags&tc.ROWFLAG_NEW_TABLE)){if(l>=0&&c!=f)i=0}}if(i>0){f=eR[i].row;if(Nj($E[f].flags&tc.ROWFLAG_TFOOT)){if(!R){l=a=t;c=s=_=eR[i].row;R=true}s=eR[i].row}else{if(R){a=t-1;R=false}}_=eR[i].row;continue}if(R){R=false;l=-1;continue}if(l<0)continue;n=t;o=a-l+1;u=l;T=n;iw(T,o,gk("B"));for(e=0;e<o;e++,u++,T++)cw(u,T);iw(l,o,tc.CHAR_D);A=$E[c].PrevRow;E=$E[s].NextRow;if(A>0)$E[A].NextRow=E;if(E>0)$E[E].PrevRow=A;E=-1;if(_>0){E=$E[_].NextRow;$E[_].NextRow=c}$E[c].PrevRow=_;$E[s].NextRow=E;if(E>0)$E[E].PrevRow=s;for(f=c;f<=s;f++)$E[f].flags=cj($E[f].flags,tc.ROWFLAG_TFOOT);R=false;l=-1}}return true}function r6(t,e,r,i,f){if(arguments.length==1)return i6(t);else return f6(t,e,r,i,f)}function i6(t){var e=sA;var r=TA;var i=_A;var f=AA;var l;l=f6(e,r,i,f,t);sA=qC;TA=$C;_A=tI;AA=eI;return l}function f6(t,e,r,i,f){var l=t;var a=r;var n,c,s;var _=e,o,u,T,A;var E=i;var R,L,C,I,d,F,g,P,S,h;var O=true,v=true,p,N,D=false;var M=0,G=0,B,H,m,w=0;var b,x;qC=t;$C=e;tI=r;eI=i;if(uA!=tc.HILIGHT_CHAR)return false;if(Nj(ui[l].tabw)&&Nj(ui[l].tabw.type&tc.INFO_ROW)&&l>0){l--;_=ui[l].len}if(Nj(ui[a].tabw)&&Nj(ui[a].tabw.type&tc.INFO_ROW)&&a>0){a--;E=ui[a].len}if(Nj(zh&tc.TFLAG_SELECT_FULL_HLINK)){b=ib(l,_);x=ib(a,E);p=oU(b);N=oU(x);if(MT==tc.CURS_FORWARD||Af){if(p){EU(l,_);l=PC;_=SC}if(N){RU(a,E);a=PC;E=SC;br=a;jt=E}}else if(MT==tc.CURS_BACKWARD){if(p){RU(l,_);l=PC;_=SC}if(N){EU(a,E);a=PC;E=SC;br=a;jt=E}}}if(l>a){l=WY(l,a);a=JC;_=WY(_,E);E=JC;v=false}if(l==a&&_>E){_=WY(_,E);E=JC;v=false}if(false&&Nj(zh&tc.TFLAG_SELECT_FULL_HLINK)){var y=v;b=ib(l,_);x=ib(a,E);p=oU(b);N=oU(x);if(E>0&&N){var W=ib(a,E-1);if(!Lw(x,W))N=false}if(p||N){if(v){if(p){EU(l,_);l=PC;_=SC}if(y&&N){RU(a,E);a=PC;E=SC}if(!y&&N){EU(a,E);a=PC;E=SC;a=PC;E=SC}br=a;jt=E}else{if(N){RU(a,E);a=PC;E=SC}if(y&&p){RU(l,_);l=PC;_=SC}if(!y&&p){EU(l,_);l=PC;_=SC}br=l;jt=_}if(jt>=ui[br].len&&br+1<Ri){br++;jt=0}}}t:{e:{if(!oi.PageMode)break t;S=h=C6(l,a);F=E6(S,l);g=E6(S,a);w=0;if(F==g&&F!=0){w=F;if(L6(a)==S&&GY(a,tc.INFO_CELL)&&E==ui[a].len){while(E6(S,l)==F&&l>=0)l--;l++;_=0}if(L6(l)==L6(a))break t;else break e}r:while(true){s=a;if(F!=g&&g!=0&&eR[g].RowSpan>1){c=a;for(n=a+1;n<Ri&&ui[n].cid>0;n++){C=ui[n].cid;if(C==g)continue;if(eR[C].level<S)break;if(rR[C].SpanningCell==g)c=n}a=c;g=E6(S,a)}if(F!=g&&g!=0&&F!=0&&g!=0){P=eR[g].row;if(Dj(eR[g].flags&tc.CFLAG_ROW_SPANNED)){for(L=1;L<eR[g].RowSpan;L++)P=$E[P].NextRow}d=P;C=F;L=eR[C].RowSpan-1;for(P=eR[C].row;P>0;P=$E[P].NextRow,C=rR[C].NextColCell){if(rR[C].SpanningCell>0)L--;else L=eR[C].RowSpan-1;if(P==d)break}for(R=0;R<L;R++)P=$E[P].NextRow;for(C=g;C>0;C=rR[C].NextColCell)if(eR[C].row==P)break;I=C;c=a;for(n=a+1;n<Ri&&ui[n].cid>0;n++){C=ui[n].cid;if(eR[C].level<S)break;if(C==I)c=n}a=c;g=E6(S,a)}if(s!=a)continue r;break}}F=ui[l].cid;g=ui[a].cid;O=n6(F,g);if(O){o=G6(F,true);T=o+eR[F].ColSpan-1;u=G6(g,true);A=u+eR[g].ColSpan-1;if(true||pA){if(u<o){M=T;G=u}else{M=o;G=A}}else{M=o<u?o:u;G=T>A?T:A}}if(F>0){if(O)B=M;else B=0;H=G6(F,true);S=eR[F].level;if(w==0){while(l>0){C=E6(h,l);if(eR[C].level==h){if(C!=E6(h,l-1))break}l--}}else if(eR[F].level>eR[g].level){var U=eR[g].level+1;while(l>0){C=E6(U,l);if(eR[C].level==U){var k=ui[l-1].cid;if(eR[k].level<U)break;if(eR[k].level==U&&GY(l-1,tc.INFO_ROW))break}l--}}else if(eR[F].level==eR[g].level){while(H>B&&l>0){if(ui[l-1].cid==0)break;if(L6(l-1)!=S)break;if(GY(l-1,tc.INFO_ROW)&&S==L6(l-1))break;l--;if(GY(l,tc.INFO_CELL)&&S==L6(l))H-=eR[ui[l].cid].ColSpan}}while(l>0){if(ui[l-1].cid!=F)break;l--}if(w==0||w!=F)_=0}if(g>0){H=G6(g,true)+eR[g].ColSpan-1;if(eR[g].level>=eR[F].level){var X=0;if(O)B=G;else{B=9999;if(pA){while(a+1<Ri){g=E6(S,a);P=eR[g].row;if($E[P].NextRow<=0)break;a++}H=0}}if(w!=0&&g!=w)X=eR[F].level+1;else X=S;while(H<B&&a+1<Ri){if(ui[a+1].cid==0)break;if(GY(a+1,tc.INFO_ROW)&&L6(a+1)==X)break;if(GY(a,tc.INFO_CELL)&&L6(a)==X)H+=eR[ui[a].cid].ColSpan;a++}m=E6(X,a);while(a+1<Ri){if(GY(a,tc.INFO_CELL)&&L6(a)==X)break;if(E6(X,a+1)!=m)break;a++}E=ui[a].len;if(E<0)E=0}else{var K=false;if(w==0)K=true;else if(GY(a,tc.INFO_CELL)&&E>=ui[a].len)K=true;if(K){S=eR[g].level;while(a+1<Ri){if(GY(a,tc.INFO_CELL|tc.INFO_ROW)&&L6(a)==S)break;a++}E=ui[a].len;if(E<0)E=0}}}F=ui[l].cid;g=ui[a].cid;M=G6(F,true);G=G6(g,true);if(O&&F>0&&g>0&&G<M){var Y;var V=M-G+1;Y=eR[F].level;while(V>0&&l>=0){l--;if(l<0)break;C=ui[l].cid;S=eR[C].level;if(S>Y)continue;if(C==0||S<Y||GY(l,tc.INFO_ROW))break;if(GY(l,tc.INFO_CELL)){L=eR[C].ColSpan;if(L<1)L=1;V-=L}}if(true||l>0||ui[l].cid==0)l++;V=M-G+1;Y=eR[g].level;while(V>0&&a+1<Ri){a++;C=ui[a].cid;S=eR[C].level;if(S>Y)continue;if(ui[a].cid==0||S<Y||GY(a,tc.INFO_ROW))break;if(GY(a,tc.INFO_CELL)){L=eR[C].ColSpan;if(L<1)L=1;V-=L}}a--}}var j=false;h=99;F=ui[l].cid;g=ui[a].cid;if(F==0||g==0){h=0;j=true}else{C=ui[l].cid;var J=C==0?0:eR[C].row;for(n=l;n<=a;n++){C=ui[n].cid;if(C==0){h=0;j=true;break}else if(eR[C].level<h)h=eR[C].level}if(!j&&(eR[F].level!=eR[g].level||h<eR[F].level||h<eR[g].level)){j=true;h++}}if(j&&h!=99){for(;l>0;l--){if(ui[l].cid==0)break;C=ui[l-1].cid;if(C==0||eR[C].level<h)break;if(eR[C].level==h&&GY(l-1,tc.INFO_ROW))break}var z=a;for(;a+1<Ri;a++){C=ui[a].cid;if(C==0||eR[C].level<h)break;if(eR[C].level==h&&GY(a,tc.INFO_ROW))break}if(a!=z)E=ui[a].len}if(false&&!O&&ui[a].cid>0&&a+1<Ri&&GY(a+1,tc.INFO_ROW)){a++;E=1}if(!v){l=WY(l,a);a=JC;_=WY(_,E);E=JC}if(ui[l].cid!=ui[a].cid){_=0;E=ui[a].len}D=t!=l||e!=_||r!=a||i!=E;t=l;e=_;r=a;i=E;if(OA&&f){br=r;jt=i;if(jt>=ui[br].len&&br+1<Ri){br++;jt=0}we=br-fr;if(we<0)we=0;fr=br-we}qC=t;$C=e;tI=r;eI=i;return D}_i.TerDeleteCells=function(i,f){var t,e;var r,l,a,n,c,s,_;var o,u,T,A,E,R,L=0,C=0;var I=false;var d=0;if(!lv||!QD())_i.TerCreateControl();if(uA==tc.HILIGHT_CHAR&&(ui[sA].cid>0||ui[_A].cid>0))I=true;if(I){var F=C6(sA,_A);l=E6(F,br)}else l=ui[br].cid;if(!oi.PrintView||l==0&&!I)return true;if(Nj(i)){if(i==tc.SEL_CELLS)i=tc.IDC_TABLE_SEL_CELLS;else if(i==tc.SEL_ROWS)i=tc.IDC_TABLE_SEL_ROWS;else if(i==tc.SEL_COLS)i=tc.IDC_TABLE_SEL_COLS;else return false;return l6(i,f)}var g=_i.DlgCompHeight;var P=_i.DlgFont;var S=new $t.DialogBox(te,"Delete Table Cells",P,true,N,JV(2));var h=S.cvs;var O=new $t.RadioButton(h,0,0,JV(15),P,"Delete Cells",true,null,null);S.addComp(O,0,0,1,1,"left","middle",JV(15));var v=new $t.RadioButton(h,1,0,JV(15),P,"Delete Columns",false,O,null);S.addComp(v,1,0,1,1,"left","middle",JV(15));var p=new $t.RadioButton(h,2,0,JV(15),P,"Delete Rows",false,v,null);S.addComp(p,2,0,1,1,"left","middle",JV(15));S.show();O.setFocus();function N(t,e,r){if(t=="Cancel"){S.hide();return}else if(t=="OK"){i=0;if(O.isSelected())i=tc.IDC_TABLE_SEL_CELLS;else if(v.isSelected())i=tc.IDC_TABLE_SEL_COLS;else i=tc.IDC_TABLE_SEL_ROWS;S.hide();return l6(i,f)}else return}};function l6(t,e){var r,i;var f,l,a,n,c,s,_;var o,u,T,A,E,R,L=0,C=0;var I=false;var d=0;if(!lv||!QD())_i.TerCreateControl();if(uA==tc.HILIGHT_CHAR&&(ui[sA].cid>0||ui[_A].cid>0))I=true;if(I){var F=C6(sA,_A);l=E6(F,br)}else l=ui[br].cid;if(uA!=tc.HILIGHT_OFF){ON();for(r=sA;r<=_A;r++)if(ui[r].cid==0)break;if(r<_A)return _i.TerDeleteBlock(e)}if(t==tc.IDC_TABLE_SEL_COLS&&(uA==tc.HILIGHT_OFF||!pA))t=tc.IDC_TABLE_SEL_COLS_DEL;if(!B6(t))return false;uA=tc.HILIGHT_OFF;m6();if(a6(true,true))return false;if(!TE){O8();E=OC;R=vC;A=uE;if(E!=-1){V8(E,0,R,0,tc.UNDO_ROW_DEL);f=E6(0,FE);L=eR[f].row;f=E6(0,gE);C=eR[f].row}}for(f=0;f<fR;f++){if(Dj(eR[f].InUse)||Dj(eR[f].flags&(tc.CFLAG_SEL1|tc.CFLAG_SEL2)))continue;if(eR[f].FirstLine==-1||eR[f].LastLine==-1)continue;c=eR[f].row;s=$E[c].PrevRow;_=$E[c].NextRow;a=eR[f].PrevCell;n=eR[f].NextCell;T=eR[f].LastLine;if(f==$E[c].FirstCell&&f==$E[c].LastCell)T++;if(a>0){eR[a].NextCell=n}else{if(n<=0){if(s>0)$E[s].NextRow=_;if(_>0)$E[_].PrevRow=s;eR[f].LastLine++;$E[c].InUse=false;if(!TE){if(c==L&&c==C)L=C=0;else{if(c==L)L=_;if(c==C)C=s}}}else{$E[c].FirstCell=n}}if(n>0)eR[n].PrevCell=a;else{$E[c].LastCell=a;u=eR[f].LastLine+1;if(Nj(ui[u].tabw)&&Nj(ui[u].tabw.type&tc.INFO_ROW)){ui[u].cid=a}}o=eR[f].LastLine-eR[f].FirstLine+1;iw(eR[f].FirstLine,o,tc.CHAR_D);for(i=0;i<fR;i++){if(eR[i].InUse&&eR[i].FirstLine>eR[f].LastLine){eR[i].FirstLine-=o;eR[i].LastLine-=o}}eR[f].InUse=false}aO=oj(tc.TOFLAG_DEL_CELL);if(uA!=tc.HILIGHT_OFF){br=sA;jt=TA}if(br>=Ri)br=Ri-1;if(jt>=ui[br].len)jt=ui[br].len-1;if(jt<0)jt=0;if(!TE){var g=false;if(L>0&&$E[L].InUse)g=true;if(C>0&&$E[C].InUse)g=true;if(g){var P=L>0?$E[L].FirstCell:0;var S=C>0?$E[C].LastCell:0;if(P>0&&eR[P].InUse){for(d=L;d>0;d=$E[d].NextRow){if(!$E[d].InUse)break;if(d==C)break;if($E[d].NextRow<=0)break}C=d;S=$E[C].LastCell}else if(S>0&&eR[S].InUse){for(d=C;d>0;d=$E[d].PrevRow){if(!$E[d].InUse)break;if(d==L)break;if($E[d].PrevRow<=0)break}L=d;P=$E[L].FirstCell}if(P>0&&eR[P].InUse&&S>0&&eR[S].InUse){A=uE;m6();V8(eR[P].FirstLine,0,eR[S].LastLine,0,tc.UNDO_ROW_INS)}}}oi.modified++;if(e)cG();return true}function a6(t,e){var r=false;var i;var f=uA;var l=sA;var a=TA;var n=_A;var c=AA;var s=OA;for(i=0;i<fR;i++){if(!eR[i].InUse||Dj(eR[i].flags&(tc.CFLAG_SEL1|tc.CFLAG_SEL2)))continue;if(eR[i].FirstLine==-1||eR[i].LastLine==-1)continue;uA=tc.HILIGHT_CHAR;sA=eR[i].FirstLine;TA=0;_A=eR[i].LastLine;AA=ui[_A].len;r=wN(t,e);if(r)break}uA=f;sA=l;TA=a;_A=n;AA=c;OA=s;return r}_i.TerDeleteCellText=function(t,e){var r,i;var f,l;var a,n,c,s,_;var o;if(!lv||!QD())_i.TerCreateControl();if(uA==tc.HILIGHT_CHAR){if(!T6())return false;i=C6(sA,_A);l=E6(i,br)}else{l=ui[br].cid;if(l==0)return false;i=eR[l].level}if(Nj(t)){if(t==tc.SEL_CELLS)t=tc.IDC_TABLE_SEL_CELLS;else if(t==tc.SEL_ROWS)t=tc.IDC_TABLE_SEL_ROWS;else if(t==tc.SEL_COLS)t=tc.IDC_TABLE_SEL_COLS;else return false}else{t=0;if(FX(new terdlg_del_cell(_i))){t=hs}if(t==0)return true}n=uE;if(!B6(t))return false;uA=tc.HILIGHT_OFF;m6();for(f=0;f<fR;f++){if(Dj(eR[f].InUse)||Dj(eR[f].flags&(tc.CFLAG_SEL1|tc.CFLAG_SEL2)))continue;if(eR[f].level!=i)continue;c=eR[f].FirstLine;s=eR[f].LastLine;if(c==-1||s==-1||c>=Ri||s>=Ri)continue;if(c==s&&ui[c].len==1)continue;_=ui[s].len-2;if(_<0){s--;_=ui[s].len-1;if(s<c)continue;o=true}else o=false;uE=n;V8(c,0,s,_,tc.CHAR_D);a=s-c+1;if(o){iw(c,a,tc.CHAR_D)}else{a--;if(a>0)iw(c,a,tc.CHAR_D);s-=a;fw(s,0,_+1,tc.CHAR_D)}for(r=0;r<fR;r++){if(eR[r].InUse&&eR[r].FirstLine>eR[f].LastLine){eR[r].FirstLine-=a;eR[r].LastLine-=a}}br=c}jt=0;if(br>=Ri)br=Ri-1;if(jt>=ui[br].len)jt=ui[br].len-1;if(jt<0)jt=0;oi.modified++;if(e){VR=true;cG()}return true};function n6(t,e){var r,i;if(t==0||e==0)return false;if(t==e)return true;r=eR[t].row;while(!s6(r))r=$E[r].PrevRow;i=eR[e].row;while(!s6(i))i=$E[i].PrevRow;return r==i}function c6(t){var e,r,i,f;var l,a,n;var c,s;var _;l=ui[t].cid;if(l==0)return false;c=eR[l].level;if(c<=0)return false;s=c-1;a=E6(s,t);n=eR[a].row;_=eR[l].row;var o=ui[t].page;for(e=t-1;e>=0;e--){r=ui[e].cid;if(r==0)return true;i=eR[r].row;if(i==_)continue;f=eR[r].level;if(f==c)return false;if(f<s)return true;if(f==s&&eR[r].row!=n)return true;if(f==s&&r!=a)return true;if(f==s&&ui[e].page<o)return true}return true}function s6(t){var e;if($E[t].PrevRow<=0)return true;if(Nj($E[t].flags&tc.ROWFLAG_NEW_TABLE))return true;e=$E[t].PrevRow;if(Nj($E[e].flags&tc.ROWFLAG_LAST_ROW))return true;return false}function _6(t){var e;var r;for(r=t;r>0;r=$E[r].PrevRow){if(Nj($E[r].flags&tc.ROWFLAG_NEW_TABLE))return r;e=$E[r].PrevRow;if(e<=0)return r;if(Nj($E[e].flags&tc.ROWFLAG_LAST_ROW))return r}return t}function o6(t,e,r){if(Dj($E[e].flags&tc.ROWFLAG_SPLIT))return false;if(t)return r>tR[e].FirstPage&&r<=tR[e].LastPage;else return r==tR[e].FirstPage}function u6(t){var e;if($E[t].NextRow<=0||Nj($E[t].flags&tc.ROWFLAG_LAST_ROW))return true;if(true||Li){e=$E[t].NextRow;if(e>0&&Nj($E[e].flags&tc.ROWFLAG_NEW_TABLE))return true}return false}function T6(){var t,e,r,i,f;if(!oi.PageMode)return false;i=C6(sA,_A);t=E6(i,sA);e=E6(i,_A);if(t==0&&e==0)return false;if(t==e){if(Nj(aO&tc.TOFLAG_SEL_CELL_CONTENT)&&AA==ui[_A].len&&AA>0)AA--;r=ui[_A].len-1;if(Nj(zh&tc.TFLAG_NO_AUTO_FULL_CELL_SEL))r++;f=ui[_A].cid;return(sA==0||E6(i,sA-1)!=t)&&TA==0&&GY(_A,tc.INFO_CELL|tc.INFO_ROW)&&eR[f].level==i&&AA>=r}return n6(t,e)}_i.TerGetLevelCell=function(t,e){if(!lv||!QD())_i.TerCreateControl();return E6(t,e)};function A6(t,e){var r;if(e>=0)r=ui[e].cid;else r=-e;return r==0||eR[r].level<t}function E6(t,e){var r;if(e>=0)r=ui[e].cid;else r=-e;if(r==0||eR[r].level==0||eR[r].level==t)return r;while((r=eR[r].ParentCell)>0)if(eR[r].level==t)break;return r}function R6(t,e){var r=$E[e].FirstCell,i;var f=eR[r].level;if(f==0)return e;i=E6(t,-r);return eR[i].row}_i.TerSelectCellText=function(t){var e;var r;if(!lv||!QD())_i.TerCreateControl();e=ui[br].cid;if(e==0)return false;for(r=br;r>0;r--)if(ui[r-1].cid!=e)break;sA=r;TA=0;for(r=br;r<Ri-1;r++)if(ui[r+1].cid!=e)break;if(GY(r,tc.INFO_ROW))r--;_A=r;AA=ui[r].len-1;if(AA<0)AA=0;OA=false;uA=tc.HILIGHT_CHAR;if(t)cG();return true};_i.TerGetTableLevel=function(t){if(!lv||!QD())_i.TerCreateControl();if(t<0){var e=-t;if(e>=fR||!eR[e].InUse)return 0;return eR[e].level}return L6(t)};function L6(t){var e;if(t<0||t>=Ri)return 0;e=ui[t].cid;if(e==0)return 0;return eR[e].level}function C6(t,e){var r;var i;if(L6(t)==0&&L6(e)==0)return 0;if(t>e){t=WY(t,e);e=PC}r=L6(t);for(i=t+1;i<=e;i++)if(L6(i)<r)r=L6(i);return r}function I6(t,e){var r,i=t;var f,l,a,n,c,s,_;if(Fo>=Ri){r=e?rR[t].NextColCell:rR[t].PrevColCell;if(r>0&&r<fR&&eR[r].InUse)return r}t:while(true){f=eR[t].row;if(e)l=$E[f].NextRow;else l=$E[f].PrevRow;if(l<=0)return 0;n=eR[t].x;c=n+eR[t].width;a=$E[l].FirstCell;while(a>0){s=eR[a].x;_=s+eR[a].width;if(Math.abs(n-s)<=tc.RULER_TOLERANCE&&Math.abs(c-_)<=tc.RULER_TOLERANCE){if(e&&Nj(eR[a].flags&tc.CFLAG_ROW_SPANNED)){t=a;continue t}if(e)rR[i].NextColCell=a;else rR[i].PrevColCell=a;return a}a=eR[a].NextCell}break}return 0}function d6(t){var e=0,r;if(t<=0||t>=iR)return 0;r=$E[t].FirstCell;while(r>0){e+=eR[r].width;r=eR[r].NextCell}return e}function F6(t,e){var r,i;var f,l=-1,a;f=eR[t].row;if(e)i=$E[f].NextRow;else{if((i=$E[f].PrevRow)<=0)return 0;r=$E[i].FirstCell;while(i>0&&Nj(eR[r].flags&tc.CFLAG_ROW_SPANNED)){if((i=$E[i].PrevRow)<=0)return 0;r=$E[i].FirstCell}}if(i<=0)return 0;if(i>0&&$E[f].indent!=$E[i].indent)return 0;if(Nj($E[f].flags&(tc.RIGHT_JUSTIFY|tc.CENTER))!=Nj($E[i].flags&(tc.RIGHT_JUSTIFY|tc.CENTER)))return 0;if(Math.abs(d6(f)-d6(i))>tc.RULER_TOLERANCE)return 0;r=$E[i].FirstCell;while(r>0){a=0;if(e&&Nj(eR[r].border&tc.BORDER_TOP))a=eR[r].BorderWidth[tc.BORDER_INDEX_TOP];if(!e&&Nj(eR[r].border&tc.BORDER_BOT))a=eR[r].BorderWidth[tc.BORDER_INDEX_BOT];if(l==-1)l=a;if(l!=a)return 0;r=eR[r].NextCell}return $E[i].FirstCell}function g6(t,e,r){var i;if(t<0||t>=iR||!$E[t].InUse)return 0;i=$E[t].FirstCell;while(e>0&&eR[i].NextCell>0){if(r)e-=eR[i].ColSpan;else e--;if(e<0)break;i=eR[i].NextCell}return i}function P6(t,e,r){return S6(t,-1,e,r)}function S6(t,e,r,i){var f,l,a,n,c,s;if(t==-1)return-1;if(e<0)e=G6(t,true);l=eR[t].row;a=$E[l].PrevRow;if(a==-1)return-1;n=$E[a].FirstCell;for(f=eR[n].ColSpan-1;f<e;f++){if(eR[n].NextCell<=0)break;n=eR[n].NextCell;f+=eR[n].ColSpan-1}if(i)return n;if(!r){if(eR[n].x<=eR[t].x&&eR[n].x+eR[n].width>=eR[t].x+eR[t].width)return n;else return-1}c=Math.abs(eR[n].x-eR[t].x);s=Math.abs(eR[n].width-eR[t].width);if(c<tc.RULER_TOLERANCE&&s<tc.RULER_TOLERANCE)return n;else return-1}function h6(t,e){return O6(t,-1,e)}function O6(t,e,r){var i,f,l,a,n,c;if(t==-1)return-1;if(e<0)e=G6(t,false);f=eR[t].row;l=$E[f].NextRow;if(l==-1)return-1;a=$E[l].FirstCell;for(i=0;i<e;i++){if(eR[a].NextCell==-1)break;i+=eR[a].ColSpan-1;a=eR[a].NextCell}if(!r)return a;n=Math.abs(eR[a].x-eR[t].x);c=Math.abs(eR[a].width-eR[t].width);if(n<tc.RULER_TOLERANCE&&c<tc.RULER_TOLERANCE)return a;else return-1}function v6(t,e){return p6(t,e,false)}function p6(t,e,r){var i,f,l,a,n,c,s=0;var _=tc.RULER_TOLERANCE;var o;if(t<=0)return-1;i=N6(t);f=eR[t].row;if(r)s=$E[f].PrevRow;while(true){if(s==f)_+=tc.RULER_TOLERANCE;else{f=$E[f].PrevRow;if(f==-1)return-1}l=$E[f].FirstCell;o=false;n=c=0;while(true){a=Math.abs(N6(l)-i);if(a<_){if(!o||o&&a<n){o=true;c=l;n=a}}if(eR[l].NextCell<=0){if(o)return c;else break}l=eR[l].NextCell}}}function N6(t){var e;var r;var i;if(t<=0||t>=fR||Dj(eR[t].InUse))return 0;e=eR[t].row;r=$E[e].indent;i=$E[e].FirstCell;while(true){if(i==-1||i==0)break;r+=eR[i].width;if(i==t)break;i=eR[i].NextCell}return r}function D6(t,e){var r;if(t<0||t>=iR||Dj($E[t].InUse))return-1;r=$E[t].FirstCell;while(e>0){r=eR[r].NextCell;if(r==-1)break;e--}return r}function M6(t){var e,r,i,f,l,a;var n;if(t==-1)return-1;e=N6(t);r=eR[t].row;while(true){r=$E[r].NextRow;if(r<=0)return-1;i=$E[r].FirstCell;n=false;l=a=0;while(true){f=Math.abs(N6(i)-e);if(f<tc.RULER_TOLERANCE){if(!n||n&&f<l){n=true;a=i;l=f}}if(eR[i].NextCell<=0){if(n)return a;else break}if(i==eR[i].NextCell)return-1;i=eR[i].NextCell}}}function G6(t,e){var r;var i=0;var f;if(t<0||t>=fR||Dj(eR[t].InUse))return 0;r=eR[t].row;f=$E[r].FirstCell;while(true){if(f==-1||f==0)break;if(f==t)return i;if(e)i+=eR[f].ColSpan;else i++;f=eR[f].NextCell}return 0}function B6(t){var e;var r,i,f,l,a,n,c;var s;var _=uA;for(e=0;e<fR;e++)eR[e].flags=cj(eR[e].flags,tc.CFLAG_SEL1|tc.CFLAG_SEL2);if(t==tc.IDC_TABLE_ALL){i=ui[br].cid;if(i==0)return true;l=eR[i].row;while($E[l].PrevRow>0)l=$E[l].PrevRow;while(l>0){i=$E[l].FirstCell;while(i>0){eR[i].flags|=tc.CFLAG_SEL1;i=eR[i].NextCell}l=$E[l].NextRow}return true}var o=false;if(uA==tc.HILIGHT_OFF&&t==tc.IDC_TABLE_SEL_COLS&&Dj(fO&tc.TFLAG10_DONT_MARK_WITH_SEL_COL)){if(_i.TerSelectCol(false))o=true}if(uA==tc.HILIGHT_OFF){i=ui[br].cid;if(i>0)eR[i].flags=eR[i].flags|tc.CFLAG_SEL1}else{if(!ON())return false;a=C6(sA,_A);f=0;for(s=sA;s<=_A;s++){if(!pm(s))continue;i=ui[s].cid;if(eR[i].level>a)continue;if(i!=f){f=i;if(f>0)eR[f].flags=eR[f].flags|tc.CFLAG_SEL1}}}if(_==tc.HILIGHT_OFF)_i.DeselectTerText(false);if(o)return true;if(t==tc.IDC_TABLE_SEL_COLS){for(r=0;r<fR;r++){if(Dj(eR[r].InUse)||Dj(eR[r].flags&tc.CFLAG_SEL1))continue;i=r;while((i=M6(i))>0){eR[i].flags=eR[i].flags|tc.CFLAG_SEL2}i=r;while((i=v6(i,true))>0){eR[i].flags=eR[i].flags|tc.CFLAG_SEL2}}}if(t==tc.IDC_TABLE_SEL_COLS2){for(r=0;r<fR;r++){if(Dj(eR[r].InUse)||Dj(eR[r].flags&tc.CFLAG_SEL1))continue;c=eR[r].row;var u=Nj($E[c].flags&(tc.ROWFLAG_AUTO_FIT|tc.ROWFLAG_AUTO_WIDTH_RTF));n=G6(r,true);i=r;while((i=O6(i,n,false))>0){eR[i].flags=eR[i].flags|tc.CFLAG_SEL2}i=r;while((i=S6(i,n,false,true))>0){eR[i].flags=eR[i].flags|tc.CFLAG_SEL2}}}if(t==tc.IDC_TABLE_SEL_COLS_DEL){var T=-1,A=-1,E;if(uA==tc.HILIGHT_OFF)i=ui[br].cid;else i=ui[sA].cid;if(i==0)i=ui[br].cid;if(i>0){n=0;c=eR[i].row;for(r=$E[c].FirstCell;r>0;r=eR[r].NextCell){if(Nj(eR[r].flags&tc.CFLAG_SEL1)){if(T==-1)T=n;A=n+eR[r].ColSpan}n+=eR[r].ColSpan}while(!s6(c))c=$E[c].PrevRow;for(;c>0;c=$E[c].NextRow){n=0;for(r=$E[c].FirstCell;r>0;r=eR[r].NextCell){eR[r].flags=cj(eR[r].flags,tc.CFLAG_SEL1);E=eR[r].ColSpan;while(E>0){if(n>=T&&n<A)eR[r].flags|=tc.CFLAG_SEL2;n++;E--}}if(u6(c))break}}}if(t==tc.IDC_TABLE_SEL_ROWS){var R=false,L=false;for(r=0;r<fR;r++){if(Dj(eR[r].InUse)||Dj(eR[r].flags&tc.CFLAG_SEL1))continue;l=eR[r].row;i=$E[l].FirstCell;R=L=false;while(i>0){eR[i].flags=eR[i].flags|tc.CFLAG_SEL2;if(rR[i].SpanningCell>0)L=true;if(eR[i].RowSpan>1||Nj(eR[i].flags&tc.CFLAG_ROW_SPANNED)&&Dj(eR[i].flags&tc.CFLAG_ROW_SPANNED_LAST))R=true;i=eR[i].NextCell}if(L)H6($E[l].PrevRow,false);if(R)H6($E[l].NextRow,true)}}for(e=0;e<fR;e++){if(Dj(eR[e].InUse)||Nj(eR[e].flags&(tc.CFLAG_SEL1|tc.CFLAG_SEL2)))continue;r=rR[e].SpanningCell;if(r==0||r<0||r>=fR)continue;if(Nj(eR[r].flags&(tc.CFLAG_SEL1|tc.CFLAG_SEL2)))eR[e].flags|=tc.CFLAG_SEL2}return true}function H6(t,e){var r;var i=false,f=false;if(t<=0)return true;for(r=$E[t].FirstCell;r>0;r=eR[r].NextCell){eR[r].flags=eR[r].flags|tc.CFLAG_SEL2;if(rR[r].SpanningCell>0)i=true;if(eR[r].RowSpan>1||Nj(eR[r].flags&tc.CFLAG_ROW_SPANNED)&&Dj(eR[r].flags&tc.CFLAG_ROW_SPANNED_LAST))f=true}if(i&&!e)H6($E[t].PrevRow,false);if(f&&e)H6($E[t].NextRow,true);return true}function m6(){var t,e,r,i;var f;for(e=0;e<iR;e++)$E[e].InUse=false;for(t=0;t<fR;t++){eR[t].FirstLine=eR[t].LastLine=-1;eR[t].InUse=false}for(f=0;f<Ri;f++){r=ui[f].cid;if(Dj(ui[f].tabw)||Dj(ui[f].tabw.type&tc.INFO_ROW)){if(eR[r].FirstLine==-1){eR[r].FirstLine=f;for(i=eR[r].ParentCell;i>0;i=eR[i].ParentCell){if(eR[i].FirstLine==-1)eR[i].FirstLine=eR[i].LastLine=f}}eR[r].LastLine=f;eR[r].InUse=true;e=eR[r].row;$E[e].InUse=true;if(eR[r].level>0){for(t=r;t>0;t=eR[t].ParentCell){eR[t].InUse=true;e=eR[t].row;$E[e].InUse=true}}}}return true}function w6(t){var e,r,i,f;var l,a=0;var n=false;for(l=Ri-1;l>=0;l--){e=ui[l].cid;if(n){if(e!=t)break}else if(e==t){if(!GY(l,tc.INFO_ROW))n=true}}a=l+1;for(l=a;l<Ri;l++){i=ui[l].cid;if(Dj(ui[l].tabw)||Dj(ui[l].tabw.type&tc.INFO_ROW)){if(eR[i].FirstLine==-1){eR[i].FirstLine=l;for(f=eR[i].ParentCell;f>0;f=eR[f].ParentCell){if(eR[f].FirstLine==-1)eR[f].FirstLine=eR[f].LastLine=l}}eR[i].LastLine=l;eR[i].InUse=true;r=eR[i].row;$E[r].InUse=true;if(eR[i].level>0){for(e=i;e>0;e=eR[e].ParentCell){eR[e].InUse=true;r=eR[e].row;$E[r].InUse=true}}}}return true}function b6(t,e){var r=0,i,f,l=ui[t].page,a;var n=0;var c=t,s;if(Dj(oi.PageMode))return 0;while(true){if(t==0||L6(t-1)<=L6(c))return r;f=ui[t-1].cid;if(f<=0)return r;i=eR[f].row;while(i>0){n=i;if(l>tR[i].LastPage)return r;if(Nj($E[i].flags&tc.ROWFLAG_SPLIT))a=tR[i].TopRowHt;else a=$E[i].height;a+=$E[i].FrmSpcBef;if(e)r+=yV(a);else r+=a;if(Nj($E[i].flags&tc.ROWFLAG_SPLIT))return r;i=$E[i].PrevRow}if(true||Li){var _=L6(t-1);s=t-1;if(eR[ui[s].cid].row!=n){for(;s>=0;s--)if(eR[ui[s].cid].row==n)break}for(;s>=0;s--){if(L6(s)>_)continue;if(eR[ui[s].cid].row!=n)break}t=s+1}else break}return r}function x6(t){if(t<0&&t>=fR)return 0;if(eR[t].LeftPad>=0){if(Nj(eR[t].border&tc.BORDER_LEFT)&&eR[t].LeftPad<eR[t].BorderWidth[tc.BORDER_INDEX_LEFT])return eR[t].BorderWidth[tc.BORDER_INDEX_LEFT];else return eR[t].LeftPad}else return eR[t].margin}function y6(t){if(t<0&&t>=fR)return 0;if(eR[t].RightPad>=0){if(Nj(eR[t].border&tc.BORDER_RIGHT)&&eR[t].RightPad<eR[t].BorderWidth[tc.BORDER_INDEX_RIGHT])return eR[t].BorderWidth[tc.BORDER_INDEX_RIGHT];else return eR[t].RightPad}else return eR[t].margin}function W6(t){var e;var r=0;if(t<0&&t>=fR)return 0;e=eR[t].row;for(t=$E[e].FirstCell;t>0;t=eR[t].NextCell){if(eR[t].TopPad>r)r=eR[t].TopPad}return r}function U6(t){var e;var r=0;if(t<0&&t>=fR)return 0;e=eR[t].row;for(t=$E[e].FirstCell;t>0;t=eR[t].NextCell){if(eR[t].BotPad>r)r=eR[t].BotPad}return r}function k6(t){var e,r,i,f,l,a,n,c;var s=false;ZU("AdjustTableRowWidth");if(Nj(iO&tc.TFLAG9_NO_NESTED_TABLE_WIDTH_ADJ))return true;l=$E[t].FirstCell;r=eR[l].ParentCell;if(r<=0)return false;f=eR[r].width-x6(r)-y6(r);i=eR[r].row;a=n=0;for(c=l;c>0;c=eR[c].NextCell)a+=eR[c].width;if(Dj($E[t].flags&(tc.RIGHT_JUSTIFY|tc.CENTER)))n=$E[t].indent;if(a+n>f){var _=true;var o=i;var u;while(o>0){if(Dj($E[o].flags&tc.ROWFLAG_AUTO_FIT)){_=false;break}u=$E[o].FirstCell;if(eR[u].level==0)break;u=eR[u].ParentCell;o=eR[u].row}if(_&&X6(r,a+n))return true}if(a+n>f)n=f-a;if(n>=0){$E[t].indent=n;return false}$E[t].indent=0;$E[t].TblIndType=0;$E[t].TblInd=0;for(e=t;e>0;e=$E[e].PrevRow){if(Nj($E[e].flags&tc.ROWFLAG_HAS_SUBTABLE))s=true;if(s||s6(e))break}for(e=$E[t].NextRow;e>0;e=$E[e].NextRow){if(Nj($E[e].flags&tc.ROWFLAG_HAS_SUBTABLE))s=true;if(s||u6(e))break}if(!s){var T=0;for(c=l;c>0;c=eR[c].NextCell){if(rR[c].clftsWidth==3&&eR[c].NextCell>0){if(Dj(lO&tc.TFLAG11_SHRINK_SUBTABLE_TO_FIT)){T+=eR[c].width;continue}}if(eR[c].NextCell>0){eR[c].width=Mj(eR[c].width,f,a);if(eR[c].width<=2*eR[c].margin)eR[c].width=2*eR[c].margin+10;T+=eR[c].width}else{var A=rR[c].clftsWidth==3&&rR[c].clwWidth==eR[c].width;if(!A||eR[c].width>f-T){eR[c].width=f-T;if(eR[c].width<=2*eR[c].margin)eR[c].width=2*eR[c].margin+10}}}return true}var E=0;for(c=l;c>0;c=eR[c].NextCell){eR[c].width=Mj(eR[c].width,f,a);if(eR[c].width<=2*eR[c].margin)eR[c].width=2*eR[c].margin+10;if(eR[c].width<rR[c].MinTextWidth){E+=rR[c].MinTextWidth-eR[c].width;eR[c].width=rR[c].MinTextWidth}}if(E>0){for(c=l;c>0;c=eR[c].NextCell){if(eR[c].width>rR[c].MinTextWidth){eR[c].width-=E;E=0;if(eR[c].width<rR[c].MinTextWidth){E=rR[c].MinTextWidth-eR[c].width;eR[c].width=rR[c].MinTextWidth}if(E<=0)break}}}if(E>0){a=0;for(c=l;c>0;c=eR[c].NextCell)a+=eR[c].width;for(c=l;c>0;c=eR[c].NextCell){eR[c].width-=Mj(eR[c].width,E,a);if(eR[c].width<=2*eR[c].margin)eR[c].width=2*eR[c].margin+10}}return true}function X6(t,e){var r,i,f,l,a,n;t:{r=eR[t].row;if(Dj($E[r].flags&tc.ROWFLAG_AUTO_FIT))return false;f=eR[t].width-2*eR[t].margin;if(f>=e)return true;l=e-f;eR[t].width+=l;n=0;for(i=eR[t].NextCell;i>0;i=eR[i].NextCell)n++;if(n==0)break t;for(i=eR[t].NextCell;i>0;i=eR[i].NextCell,n--){if(n<=0||l<=0)break;a=l/n;if(eR[i].width-a<2*eR[i].margin)a=eR[i].width-2*eR[i].margin-10;if(a<=0)continue;eR[i].width-=a;l-=a}}return true}function K6(t,e,r,i){var f,l,a,n,c;if(Nj($E[e].flags&(tc.RIGHT_JUSTIFY|tc.CENTER))){var s=$E[e].FirstCell;l=0;f=$E[e].FirstCell;while(f>0){l+=eR[f].width;f=eR[f].NextCell}$E[e].indent=MV(i)-l;if(Nj($E[e].flags&tc.CENTER))$E[e].indent=$E[e].indent/2;if(ui[t].fid>0&&eR[s].ParentCell<=0){var _=ui[t].fid;$E[e].indent-=kl[_].DistFromTextLeft}if($E[e].indent<0&&oi.FittedView)$E[e].indent=0;if(r>=0&&to[r].flow==tc.FLOW_RTL&&Nj($E[e].flags&tc.RIGHT_JUSTIFY))$E[e].indent=0}a=DV($E[e].indent);n=BW(t,r);if(n>a&&n>0)a+=n;$E[e].CurIndent=a;for(c=$E[e].NextRow;c>0;c=$E[c].NextRow){if(E8(c))$E[c].CurIndent=a;else break}return a}function Y6(t){var e=ui[t].cid;return e>0&&Nj(eR[e].flags&tc.CFLAG_VALIGN_BASE)}function V6(){var t,e,r=0;var i,f;if(Nj(Qh&tc.TFLAG3_CURSOR_IN_CELL))return true;i=ui[br].cid;f=eR[i].level;for(t=br+1;t<Ri;t++){if(ui[t].cid==0||ui[t].cid!=i&&Dj(eR[ui[t].cid].flags&tc.CFLAG_ROW_SPANNED))break}if(t>=Ri)return true;i=E6(f,t);if(i==0||eR[i].level<f){if(Nj(eO&tc.TFLAG7_AUTO_NEW_ROW))return _i.TerInsertTableRow(false,true);else return true}e=t;for(t=e+1;t<Ri;t++){if(L6(t)!=L6(br))continue;if(ui[t].cid!=i||Nj(ui[t].tabw)&&Nj(ui[t].tabw.type&tc.INFO_ROW)){r=t-1;break}}if(r>=Ri)r=Ri-1;br=r;jt=ui[r].len-1;if(jt<0)jt=0;uA=tc.HILIGHT_OFF;sA=e;TA=0;_A=br;AA=jt;if(sA!=_A||TA!=AA)uA=tc.HILIGHT_CHAR;cG();return true}function j6(){var t,e,r;var i;if(Nj(Qh&tc.TFLAG3_CURSOR_IN_CELL))return true;i=ui[br].cid;for(t=br-1;t>=0;t--){if(ui[t].cid==0||ui[t].cid!=i&&Nj(ui[t].tabw)&&Nj(ui[t].tabw.type&tc.INFO_CELL)&&Dj(eR[ui[t].cid].flags&tc.CFLAG_ROW_SPANNED))break}if(t<0)return true;i=ui[t].cid;if(i==0)return true;r=t;for(t=r-1;t>=0;t--){if(L6(t)!=L6(br))continue;if(ui[t].cid!=i)break}e=t+1;br=r;jt=ui[r].len-1;if(jt<0)jt=0;uA=tc.HILIGHT_OFF;sA=e;TA=0;_A=br;AA=jt;if(sA!=_A||TA!=AA)uA=tc.HILIGHT_CHAR;cG();return true}function J6(t,e,r,i){var f,l,a,n;if($E[r].FirstCell<=0||$E[r].LastCell<=0){$E[r].FirstCell=$E[r].LastCell=t}else{if(i==gk("B")){if(e==$E[r].FirstCell){$E[r].FirstCell=t;eR[t].PrevCell=-1;eR[t].NextCell=e;eR[e].PrevCell=t}else if(e<=0){f=$E[r].LastCell;$E[r].LastCell=t;eR[f].NextCell=t;eR[t].PrevCell=f;eR[t].NextCell=-1}else{a=eR[e].PrevCell;eR[t].PrevCell=a;if(a>0)eR[a].NextCell=t;eR[t].NextCell=e;eR[e].PrevCell=t}}else if(i==tc.CHAR_A){if(e==$E[r].LastCell){f=$E[r].LastCell;$E[r].LastCell=t;eR[f].NextCell=t;eR[t].PrevCell=f;eR[t].NextCell=-1}else if(e<=0){l=$E[r].FirstCell;$E[r].FirstCell=t;eR[t].PrevCell=-1;eR[t].NextCell=l;eR[l].PrevCell=t}else{n=eR[e].NextCell;eR[t].NextCell=n;if(n>0)eR[n].PrevCell=t;eR[t].PrevCell=e;eR[e].NextCell=t}}}eR[t].InUse=true;eR[t].row=r;return true}function z6(t){var e=eR[t].row;var r,i,f,l;if(t==$E[e].FirstCell&&t==$E[e].LastCell)$E[e].FirstCell=$E[e].LastCell=-1;else if(t==$E[e].FirstCell){r=eR[t].NextCell;$E[e].FirstCell=r;if(r>0)eR[r].PrevCell=-1}else if(t==$E[e].LastCell){i=eR[t].PrevCell;$E[e].LastCell=i;if(i>0)eR[i].NextCell=-1}else{f=eR[t].PrevCell;l=eR[t].NextCell;if(f>0)eR[f].NextCell=l;if(l>0)eR[l].PrevCell=f}eR[t].InUse=false;if(nR==0)nR=t;else if(t<nR)nR=t;return true}function Z6(t){eR[t].InUse=false;if(nR==0)nR=t;else if(t<nR)nR=t;return true}function Q6(t,e){eR[e]=eR[t].copy();rR[e]=rR[t].copy();return true}_i.TerCreateTable=function(t,e,r){return _i.TerCreateTable2(t,e,false,r)};_i.TerCreateTable2=function(i,f,l,a){if(!lv||!QD())_i.TerCreateControl();if(ui[br].cid>0&&Dj(Qh&tc.TFLAG3_EMBEDDED_TABLES))return false;if(i>0)return q6(i,f,l,a);var t=_i.DlgCompHeight;var e=_i.DlgFont;var n=new $t.DialogBox(te,"New Table Parameters",e,true,function(t,e,r){T(t,e,r)});var r=n.cvs;var c=new $t.Label(r,0,0,e,"Number of Rows (1-999)");n.addComp(c,0,0,1,2,"left","middle");var s=new $t.TextBox(r,0,0,JV(60),t,"3",e,_i.caret,false,true,null);n.addComp(s,0,2,1,1,"left","middle");var _=new $t.Label(r,0,0,e,"Number of Columns (1-30)");n.addComp(_,1,0,1,2,"left","top");var o=new $t.TextBox(r,0,0,JV(60),t,"2",e,_i.caret,false,true,null);n.addComp(o,1,2,1,1,"left","top");var u=new $t.CheckBox(r,0,0,JV(15),JV(16),e,"AutoFit",l,null);n.addComp(u,2,0,1,1,"left","middle",0);n.show();s.setFocus();function T(t,e,r){if(t=="Cancel"){n.hide();return}else if(t=="OK"){if(!EX(this,tc.CHAR_I,s,1,999))return;if(!EX(this,tc.CHAR_I,o,1,30))return;i=LX(s.getText());f=LX(o.getText());l=u.isSelected();n.hide()}else return;return q6(i,f,l,a)}return true};function q6(t,e,r,i){var f,l,a;var n,c,s,_,o=-1,u,T,A,E=0;var R,L,C=0,I=0;var d;var F=true;var g=null;oR=t;uR=e;L=uE;if(!Qk())return false;if(uA!=tc.HILIGHT_OFF){uE=L;_i.TerDeleteBlock(false)}R=br;if(ui[br].cid==0){var P=0;T=A=0;l=M9(br,-1);l=gV(l);if(ui[br].tabw!=null)P=MV(ui[br].tabw.FrameWidth);if(P>0&&l>P+tc.RULER_TOLERANCE)l-=P+tc.RULER_TOLERANCE}else{var S=ui[br].cid;T=eR[S].level+1;l=eR[S].width-2*eR[S].margin;A=S}l=l/uR;f=oR*uR;f+=oR;if(!MY(Ri+f))return true;d=$w();if(!MJ(xs[d].TextBkColor,tc.CLR_WHITE))d=lx(d,16777215,0,"",0,0);if(xs[d].FieldId>0)d=0;if(Z_){if(Nj(xs[d].DelRev))d=V4(d,tc.TRACK_NONE);d=V4(d,tc.TRACK_INS)}else if(Nj(xs[d].InsRev)||Nj(xs[d].DelRev))d=V4(d,tc.TRACK_NONE);a=ui[br].fid;if(Dj(zh&tc.TFLAG_NO_HOUR_GLASS)){g=XQ(U)}if(A>0){uE=L;V8(br,0,br,0,tc.UNDO_ROW_DEL);if(_E>0){Cq(sE[_E-1].beg);C=PC;Cq(sE[_E-1].end);I=PC}else C=I=br}for(n=0;n<oR;n++){if((_=b8())==-1)continue;$E[_].InUse=true;$E[_].PrevRow=o;$E[_].NextRow=-1;$E[_].FirstCell=0;$E[_].LastCell=0;$E[_].CellMargin=CR;if(Li&&n==0)$E[_].flags|=tc.ROWFLAG_NEW_TABLE;if(o>0)$E[o].NextRow=_;o=_;s=-1;for(c=0;c<uR;c++){if(!F)zh|=tc.TFLAG_USE_NEXT_ID;if((u=x8(F))==-1)continue;if(u==fR-1)F=false;eR[u].InUse=true;eR[u].row=_;eR[u].width=l;eR[u].margin=CR;eR[u].border=0;eR[u].level=T;eR[u].ParentCell=A;if(sR>0){eR[u].border=tc.BORDER_LEFT|tc.BORDER_RIGHT|tc.BORDER_TOP|tc.BORDER_BOT;eR[u].BorderWidth[tc.BORDER_INDEX_LEFT]=sR;eR[u].BorderWidth[tc.BORDER_INDEX_RIGHT]=sR;eR[u].BorderWidth[tc.BORDER_INDEX_TOP]=sR;eR[u].BorderWidth[tc.BORDER_INDEX_BOT]=sR;eR[u].BorderColor[tc.BORDER_INDEX_LEFT]=_R;eR[u].BorderColor[tc.BORDER_INDEX_RIGHT]=_R;eR[u].BorderColor[tc.BORDER_INDEX_TOP]=_R;eR[u].BorderColor[tc.BORDER_INDEX_BOT]=_R}else if(Li){eR[u].border=tc.BORDER_LEFT|tc.BORDER_RIGHT|tc.BORDER_TOP|tc.BORDER_BOT;eR[u].BorderWidth[tc.BORDER_INDEX_LEFT]=15;eR[u].BorderWidth[tc.BORDER_INDEX_RIGHT]=15;eR[u].BorderWidth[tc.BORDER_INDEX_TOP]=15;eR[u].BorderWidth[tc.BORDER_INDEX_BOT]=15;eR[u].flags|=tc.CFLAG_FIX_WIDTH;eR[u].FixWidth=eR[u].width}if(r){eR[u].flags=cj(eR[u].flags,tc.CFLAG_FIX_WIDTH|tc.CFLAG_FIX_WIDTH_PCT);eR[u].flags|=tc.CFLAG_AUTO_WIDTH|tc.CFLAG_AUTO_WIDTH_RTF;eR[u].width=tc.MIN_AUTO_CELL_WIDTH;$E[_].flags|=tc.ROWFLAG_AUTO_WIDTH_RTF;FR=true}eR[u].PrevCell=s;eR[u].NextCell=-1;if(s>0)eR[u].x=eR[s].x+eR[s].width;else eR[u].x=0;if(s>0)eR[s].NextCell=u;s=u;if($E[_].FirstCell==0)$E[_].FirstCell=u;$E[_].LastCell=u;ew(br,TR,d,ui[br].pfmt,tc.INFO_CELL,u);ui[br].fid=a;br++}ew(br,tc.ROW_CHAR,d,ui[br].pfmt,tc.INFO_ROW,ui[br-1].cid);ui[br].fid=a;E=br;br++}if(g!=null)XQ(g);I+=br-R;br=R;jt=0;_z(false);uE=L;if(A>0)V8(C,0,I,0,tc.UNDO_ROW_INS);else V8(br,jt,E,0,tc.UNDO_ROW_INS);if(oR*uR>300)_i.TerRepaginate(i);else if(i)cG();return true}_i.TerInsertTableRow=function(t,e){var r,i,f,l,a,n,c;var s,_,o,u;var T;var A;var E;var R;var L,C;var I;if(!lv||!QD())_i.TerCreateControl();i=ui[br].cid;if(!oi.PrintView||i==0)return true;I=uE;if(eR[i].level>0){uE=I;V8(br,0,br,0,tc.UNDO_ROW_DEL)}u=eR[i].row;if(!t){while(true){if($E[u].NextRow<0)break;u=$E[u].NextRow}}n=0;a=$E[u].FirstCell;while(a>0){n++;a=eR[a].NextCell}m6();A=n+1;if(!MY(Ri+A))return true;R=$w();R=rb(R,true);if((_=b8())==-1)return true;$E[_]=$E[u].copy();tR[_]=tR[u].copy();$E[_].FirstCell=0;$E[_].LastCell=0;if(t){o=$E[u].PrevRow;$E[_].PrevRow=o;if(o>0)$E[o].NextRow=_;$E[_].NextRow=u;$E[u].PrevRow=_;$E[u].flags=cj($E[u].flags,tc.ROWFLAG_NEW_TABLE);$E[_].flags=cj($E[_].flags,tc.ROWFLAG_LAST_ROW)}else{$E[_].PrevRow=u;$E[u].NextRow=_;$E[u].flags=cj($E[u].flags,tc.ROWFLAG_LAST_ROW);$E[_].NextRow=-1}f=$E[u].FirstCell;if(t){br=eR[f].FirstLine}else{f=$E[u].FirstCell;l=$E[u].LastCell;br=eR[l].LastLine;br=br+2}L=br;for(c=f;c>0;c=eR[c].NextCell){var d=eR[c].LastLine,F=ui[d].len-1;rR[c].TempPfmt=ui[eR[c].LastLine].pfmt;rR[c].TempFont=F>=0?ib(d,F):R}jt=0;T=$E[u].FirstCell;r=-1;for(E=0;E<n;E++){if((i=x8(true))==-1)continue;Q6(T,i);C=eR[T].LastLine;s=rR[T].TempPfmt;R=rR[T].TempFont;T=eR[T].NextCell;eR[i].InUse=true;eR[i].row=_;eR[i].PrevCell=r;eR[i].NextCell=-1;eR[i].RowSpan=1;if(r>0)eR[r].NextCell=i;r=i;if($E[_].FirstCell==0)$E[_].FirstCell=i;$E[_].LastCell=i;ew(br,TR,R,s,tc.INFO_CELL,i);br++}ew(br,tc.ROW_CHAR,R,ui[br].pfmt,tc.INFO_ROW,ui[br-1].cid);br++;uE=I;V8(br-1,0,br-1,0,tc.UNDO_ROW_INS);if(!t){br=L;jt=0;if(Zt==tc.ID_TAB){if(e)_i.TerRepaginate(true);else _z(false)}}_z(false);if(e)cG();return true};_i.TerInsertTableCol=function(t,e,r){var i,f,l,a,n,c,s;var _,o,u,T=0,A=-1;var E,R,L=0;if(!lv||!QD())_i.TerCreateControl();a=ui[br].cid;if(a==0)return false;L=eR[a].row;var C=Nj($E[L].flags&(tc.ROWFLAG_AUTO_FIT|tc.ROWFLAG_AUTO_WIDTH_RTF));m6();uA=tc.HILIGHT_OFF;if(!t){L=eR[a].row;c=$E[L].LastCell;uA=tc.HILIGHT_CHAR;sA=eR[c].FirstLine;_A=eR[c].LastLine;TA=0;AA=ui[_A].len}if(!B6(e?tc.IDC_TABLE_SEL_COLS2:0))return false;uA=tc.HILIGHT_OFF;O8();E=OC;R=vC;_=uE;if(E!=-1)V8(E,0,R,0,tc.UNDO_ROW_DEL);if(!t){for(i=0;i<fR;i++){if(eR[i].NextCell>0){if(!eR[i].InUse||Dj(eR[i].flags&(tc.CFLAG_SEL1|tc.CFLAG_SEL2)))continue;eR[i].flags=cj(eR[i].flags,tc.CFLAG_SEL1|tc.CFLAG_SEL2);while(eR[i].NextCell>0)i=eR[i].NextCell;eR[i].flags|=tc.CFLAG_SEL1|tc.CFLAG_SEL2}}}for(i=0;i<fR;i++){if(Dj(eR[i].InUse)||Dj(eR[i].flags&(tc.CFLAG_SEL1|tc.CFLAG_SEL2)))continue;if(!MY(Ri+1))return true;if((n=x8(true))==-1)continue;Q6(i,n);eR[n].flags=cj(eR[n].flags,tc.CFLAG_SEL1|tc.CFLAG_SEL2);if(A<0){A=eR[i].width/eR[i].ColSpan;T=eR[i].FixWidth}eR[n].width=A;eR[n].FixWidth=T;eR[n].ColSpan=1;if(t){if(eR[i].PrevCell<0){L=eR[i].row;$E[L].FirstCell=n;eR[n].PrevCell=-1;eR[n].NextCell=i;eR[i].PrevCell=n}else{var I=eR[i].PrevCell;eR[I].NextCell=n;eR[n].PrevCell=I;eR[i].PrevCell=n;eR[n].NextCell=i}o=eR[i].FirstLine;l=ui[o].pfmt;u=o}else{L=eR[i].row;$E[L].LastCell=n;eR[n].NextCell=-1;eR[n].PrevCell=i;eR[i].NextCell=n;o=eR[i].LastLine+1;l=ui[eR[i].LastLine].pfmt;u=eR[i].LastLine;ui[o].cid=n}if(Oc>=0)s=Oc;else s=_i.TerGetCurFont(u,0);s=rb(s,true);ew(o,TR,s,l,tc.INFO_CELL,n);if(br>=o)br++;for(f=i;f<fR;f++){if(Dj(eR[f].InUse)||Dj(eR[f].flags&(tc.CFLAG_SEL1|tc.CFLAG_SEL2)))continue;if(eR[f].FirstLine>=o)eR[f].FirstLine++;if(eR[f].LastLine>=o)eR[f].LastLine++}}m6();O8();E=OC;R=vC;uE=_;if(E!=-1)V8(E,0,R,0,tc.UNDO_ROW_INS);oi.modified++;if(C){if(E>=0)v8(ui[E].cid);FR=true;_i.TerAdjustHtmlTable();FR=false}if(r)cG();else if(Dj($h&tc.TFLAG5_GROUP_UNDO))uE++;return true};function $6(){var t,e,r,i,f,l,a,n;var c,s,_;var o;if(uA!=tc.HILIGHT_OFF)return true;if(!oi.PrintView)return true;s=uE;_=br;V8(_,0,_,0,tc.UNDO_ROW_DEL);e=i=ui[br].cid;n=eR[e].RowSpan;f=G6(e,true);while(true){if(e==0)break;if(Nj(ui[br].tabw)&&Nj(ui[br].tabw.type&tc.INFO_ROW))break;if(eR[e].width<=tc.MIN_CELL_WIDTH){oV();break}if(!MY(Ri+1))break;o=$w();l=e;r=eR[e].NextCell;a=eR[e].row;c=br;while(c<Ri){if(Nj(ui[c].tabw)&&Nj(ui[c].tabw.type&tc.INFO_ROW))break;if(r>0&&ui[c].cid==r)break;if(ui[c].cid==0||c==Ri-1){return QY(tc.MSG_MISSING_ROW_MARKER,"TerSplitCell")}c++}br=c;jt=0;if((e=x8(true))==-1)return false;Q6(l,e);eR[e].InUse=true;eR[e].PrevCell=l;if(l>0)eR[l].NextCell=e;eR[e].NextCell=r;if(r>0)eR[r].PrevCell=e;eR[e].width=eR[l].width=eR[l].width/2;eR[e].x=eR[l].x+eR[l].width;if(eR[l].ColSpan>1)eR[l].ColSpan--;eR[e].ColSpan=1;if($E[a].LastCell==l)$E[a].LastCell=e;ew(br,TR,o,ui[br-1].pfmt,tc.INFO_CELL,e);if(br<Ri-1&&Nj(ui[br+1].tabw)&&Nj(ui[br+1].tabw.type&tc.INFO_ROW))ui[br+1].cid=ui[br].cid;n--;if(n<1)break;t=eR[i].row;t=$E[t].NextRow;if(t<=0)break;i=g6(t,f,true);while(br+1<Ri){if(ui[br].cid==i)break;br++}jt=0;e=ui[br].cid}uE=s;V8(_,0,_,0,tc.UNDO_ROW_INS);cG();return true}function t8(){var t,e,r,i,f,l,a,n;t=ui[br].cid;if(t<=0)return true;e=eR[t].row;if(e==0||$E[e].PrevRow<=0)return true;a=eR[t].level;for(r=br;r>0;r--){i=ui[r-1].cid;f=eR[i].level;if(f!=a)i=E6(a,r);if(eR[i].row!=e)break}if(r<=0)return true;l=ib(r,0);n=eR[t].ParentCell;ew(r,Bn,l,ui[r].pfmt,0,n);br=r;jt=0;V8(r,0,r,0,"I");cG();return true}function e8(){var t,e,r,i,f,l,a,n,c;var s,_,o,u,T,A,E,R,L;var C;var I=0;if(uA!=tc.HILIGHT_OFF)return true;if(!oi.PrintView)return true;C=uE;o=A=br;V8(o,0,o,0,tc.UNDO_ROW_DEL);e=l=f=ui[br].cid;c=eR[e].RowSpan;a=G6(e,true);r=eR[f].row;if(c>1){eR[e].RowSpan--;T=eR[e].RowSpan;for(t=r;t>0&&T>0;t=$E[t].NextRow)T--;if(t>0){for(u=$E[t].FirstCell;u>0;u=eR[u].NextCell){if(rR[u].SpanningCell==e&&Nj(eR[u].flags&tc.CFLAG_ROW_SPANNED)){eR[u].flags=_j(eR[u].flags,tc.CFLAG_ROW_SPANNED);rR[u].SpanningCell=0}}}}else{m6();if((t=b8())==-1)return false;$E[t]=$E[r].copy();tR[t]=tR[r].copy();$E[t].flags=cj($E[t].flags,tc.ROWFLAG_NEW_TABLE);$E[t].FirstCell=0;$E[t].LastCell=0;E=$E[r].NextRow;$E[r].NextRow=t;$E[t].NextRow=E;$E[r].MinHeight=$E[t].MinHeight=$E[r].MinHeight/2;if(E>0)$E[E].PrevRow=t;$E[t].PrevRow=r;i=$E[r].FirstCell;for(s=eR[i].LastLine;s<Ri;s++){u=ui[s].cid;if(u==0||eR[u].row!=r)break;if(GY(s,tc.INFO_CELL)){_=ui[s].len-1;if(_<0)_=0;rR[u].TempPfmt=ui[s].pfmt;rR[u].TempFont=ib(s,_)}}A=s;s=A;n=0;for(u=$E[r].FirstCell;u>0;u=eR[u].NextCell){if((R=x8(true))==-1)continue;Q6(u,R);L=rR[u].TempPfmt;I=rR[u].TempFont;eR[R].InUse=true;eR[R].row=t;eR[R].PrevCell=n;eR[R].NextCell=-1;if(n>0)eR[n].NextCell=R;n=R;if($E[t].FirstCell==0)$E[t].FirstCell=R;$E[t].LastCell=R;ew(s,TR,I,L,tc.INFO_CELL,R);s++;if(u!=f){var d=u;if(Nj(eR[u].flags&tc.CFLAG_ROW_SPANNED))d=rR[u].SpanningCell;eR[d].RowSpan++;eR[R].flags|=tc.CFLAG_ROW_SPANNED;rR[R].SpanningCell=d;if(Nj(eR[u].flags&tc.CFLAG_ROW_SPANNED_LAST)){var F=eR[R].row;eR[u].flags=cj(eR[u].flags,tc.CFLAG_ROW_SPANNED_LAST);eR[R].flags|=tc.CFLAG_ROW_SPANNED_LAST}}}ew(s,tc.ROW_CHAR,I,ui[s].pfmt,tc.INFO_ROW,ui[s-1].cid);s++}uE=C;V8(o,0,A,0,tc.UNDO_ROW_INS);cG();return true}function r8(){var t,e,r=0,i,f,l,a,n;var c,s,_,o,u;var T,A,E,R;var L,C;var I;var d,F,g=false,P=false;if(uA==tc.HILIGHT_OFF)return true;if(!ON())return false;s=_A;for(c=sA;c<=s;c++)if(ui[c].cid==0)break;if(c<=s)return false;B6(0);O8();E=OC;R=vC;A=uE;if(E!=-1)V8(E,0,R,0,tc.UNDO_ROW_DEL);e=ui[s].cid;t=eR[e].row;F=true;if($E[t].NextRow>0){a=G6(e,true);n=g6($E[t].NextRow,a,true);if(eR[n].ColSpan==1){if(Math.abs(eR[e].x-eR[n].x)>tc.RULER_TOLERANCE)F=false;if(Math.abs(eR[e].width-eR[n].width)>tc.RULER_TOLERANCE)F=false}}if($E[t].PrevRow>0){a=G6(e,true);n=g6($E[t].PrevRow,a,true);if(eR[n].ColSpan==1){if(Math.abs(eR[e].x-eR[n].x)>tc.RULER_TOLERANCE)F=false;if(Math.abs(eR[e].width-eR[n].width)>tc.RULER_TOLERANCE)F=false}}d=false;for(c=s;c>=sA;c--){if(Nj(ui[c].tabw)&&Nj(ui[c].tabw.type&tc.INFO_ROW)){e=ui[c].cid;t=eR[e].row;continue}if(Dj(eR[ui[c].cid].flags&tc.CFLAG_SEL1)){d=true;continue}if(d){e=ui[c].cid;d=false;continue}r=ui[c].cid;if(r==e)continue;if(Nj(ui[c].tabw)&&Nj(ui[c].tabw.type&tc.INFO_CELL)){if(ui[c].len==1){iw(c,1,tc.CHAR_D);_A--}else{L=ui[c].txt;f=ui[c].len;if(f>0&&L[f-1]==TR){if(c+1<Ri&&ui[c+1].len>1)L[f-1]=Bn;else fw(c,f-1,1,tc.CHAR_D)}ui[c].tabw.type=cj(ui[c].tabw.type,tc.INFO_CELL)}eR[e].x=eR[r].x;eR[e].width+=eR[r].width;if(F)eR[e].ColSpan++;i=eR[r].PrevCell;if(i>0){eR[i].NextCell=e;eR[e].PrevCell=i}else{eR[e].PrevCell=-1;$E[t].FirstCell=e}eR[e].border=_j(eR[e].border,tc.BORDER_LEFT);eR[e].border|=eR[r].border&tc.BORDER_LEFT;eR[e].BorderWidth[tc.BORDER_INDEX_LEFT]=eR[r].BorderWidth[tc.BORDER_INDEX_LEFT];eR[e].LeftPad=eR[r].LeftPad}ui[c].cid=e;br=sA}if(r!=e&&r!=0){c=sA-1;while(c>=0){if(ui[c].cid!=r)break;ui[c].cid=e;c--}}P=false;s=_A;T=ui[sA].cid;l=eR[T].RowSpan;for(c=sA;c<=s;c++)if(Nj(ui[c].tabw)&&Nj(ui[c].tabw.type&tc.INFO_CELL))break;_=c;var S=0;for(c=_+1;c<=s;c++){if(Nj(ui[c].tabw)&&Nj(ui[c].tabw.type&tc.INFO_ROW))continue;e=ui[c].cid;if(Dj(eR[e].flags&tc.CFLAG_SEL1))continue;if(Nj(ui[c].tabw)&&Nj(ui[c].tabw.type&tc.INFO_CELL)){if(Dj(eR[e].flags&tc.CFLAG_ROW_SPANNED))l+=eR[e].RowSpan;eR[e].flags|=tc.CFLAG_ROW_SPANNED;eR[e].RowSpan=1;rR[e].SpanningCell=T;P=true;S=eR[e].row}f=ui[_].len;L=ui[_].txt;if(f>0&&L[f-1]==TR){if(f==1)Tm(_,ui[_].len,0);else{L[f-1]=Bn;if(Nj(ui[_].tabw))ui[_].tabw.type=cj(ui[_].tabw.type,tc.INFO_CELL)}}iw(_,1,tc.CHAR_A);_++;c++;s++;f=ui[c].len;Tm(_,ui[_].len,f);lw(c,0,_,0,f);ui[_].pfmt=ui[c].pfmt;ui[_].cid=T;ui[_].fid=ui[_-1].fid;C=ui[c].txt;I=nb(c);if(C[f-1]==TR){C[0]=C[f-1];I[0]=I[f-1];Tm(c,ui[c].len,1);if(Dj(ui[_].tabw))xX(_);if(Nj(ui[_].tabw))ui[_].tabw.type|=tc.INFO_CELL}else Tm(c,ui[c].len,0);sb(c);sb(_)}eR[T].RowSpan=l;if(P){var h=eR[T].row;g=false;m6();for(o=$E[h].NextRow;o>0;o=$E[o].NextRow){var O=$E[o].NextRow;for(u=$E[o].FirstCell;u>0;u=eR[u].NextCell)if(Dj(eR[u].flags&tc.CFLAG_ROW_SPANNED))break;if(u>0)break;for(u=$E[o].FirstCell;u>0;u=eR[u].NextCell){R=eR[u].LastLine;if(eR[u].NextCell<=0&&R+1<Ri&&ui[R+1].cid==u)R++;for(c=eR[u].FirstLine;c<=R;c++){if(ui[c].len>0)Tm(c,ui[c].len,0);eR[u].InUse=false;if(O>0){var v=$E[O].FirstCell;ui[c].cid=v;if(c<eR[v].FirstLine)eR[v].FirstLine=c}else ui[c].cid=0;if(rR[u].SpanningCell>0){var p=rR[u].SpanningCell;if(p>0&&eR[p].RowSpan>1)eR[p].RowSpan--}}}if($E[h].MinHeight<0){if($E[o].MinHeight<0)$E[h].MinHeight+=$E[o].MinHeight}else if($E[h].MinHeight>0){if($E[o].MinHeight>0)$E[h].MinHeight+=$E[o].MinHeight}else if($E[h].MinHeight==0){$E[h].MinHeight=Math.abs($E[o].MinHeight)}$E[o].InUse=false;$E[h].NextRow=O;if(O>0)$E[O].PrevRow=h;g=true;if(o==S||$E[o].NextRow<=0)break}if(g){while(s>0&&ui[s].len==0)s--}}oi.modified++;br=sA;jt=0;uE=A;if(E!=-1)V8(E,0,s,0,tc.UNDO_ROW_INS);if(g)Z4(false);uA=tc.HILIGHT_OFF;cG();_i.TerRepaginate(true);FN(true);return true}_i.TerRowPosition=function(t,e,r){return _i.TerRowPositionEx(t,0,e,r)};_i.TerRowPositionEx=function(i,f,l,a){var t,e;var r,n,c;var s;var _;if(!lv||!QD())_i.TerCreateControl();if(i!=0||f!=0)return i8(i,f,l,a);n=ui[br].cid;if(!oi.PrintView||n==0)return true;var o=_i.DlgCompHeight;var u=_i.DlgFont;var T=new $t.DialogBox(te,"Table Row Alignment",u,true,d,JV(2));var A=T.cvs;T.addGroupBox(0,0,4,1,"",u,0,JV(7),JV(10),JV(10));s=eR[n].row;var E=$E[s].flags;var R=new $t.RadioButton(A,0,0,JV(15),u,"Left Justified",Dj(E&(tc.CENTER|tc.RIGHT_JUSTIFY)),null,null);T.addComp(R,1,0,1,1,"left","middle",JV(15));var L=new $t.RadioButton(A,1,0,JV(15),u,"Centered",Nj(E&tc.CENTER),R,null);T.addComp(L,2,0,1,1,"left","middle",JV(15));var C=new $t.RadioButton(A,2,0,JV(15),u,"Right Justified",Nj(E&tc.RIGHT_JUSTIFY),L,null);T.addComp(C,3,0,1,1,"left","middle",JV(15));var I=new $t.CheckBox(A,0,0,JV(15),JV(16),u,"All Rows in the Table",true,null);T.addComp(I,5,0,1,1,"left","middle");T.show();R.setFocus();function d(t,e,r){if(t=="Cancel"){T.hide();return}else if(t=="OK"){i=tc.LEFT;if(L.isSelected())i=tc.CENTER;else if(C.isSelected())i=tc.RIGHT_JUSTIFY;l=false;if(I.isSelected())l=true;T.hide();return i8(i,f,l,a)}else return}};function i8(t,e,r,i){var f,l;var a,n,c;var s;var _;n=ui[br].cid;if(!oi.PrintView||n==0)return true;if(Nj(e))t=tc.LEFT;oi.modified++;if(br<Fo)Fo=br;if(r){n=ui[br].cid;s=eR[n].row;while(true){if($E[s].PrevRow<=0)break;s=$E[s].PrevRow}V8(-1,$E[s].FirstCell,-1,0,tc.UNDO_TABLE_ATTRIB);while(s>0){$E[s].flags=cj($E[s].flags,tc.CENTER|tc.RIGHT_JUSTIFY);$E[s].flags=$E[s].flags|t;$E[s].indent=e;s=$E[s].NextRow}if(i)yJ(false,true,0,true);return true}for(f=0;f<fR;f++)eR[f].flags=cj(eR[f].flags,tc.CFLAG_SEL1|tc.CFLAG_SEL2);if(uA==tc.HILIGHT_OFF){n=ui[br].cid;eR[n].flags=eR[n].flags|tc.CFLAG_SEL1;V8(-1,n,-1,n,tc.UNDO_TABLE_ATTRIB)}else{if(!ON())return false;V8(sA,0,_A,0,tc.UNDO_TABLE_ATTRIB);c=ui[sA].cid;eR[c].flags=eR[c].flags|tc.CFLAG_SEL1;for(_=sA+1;_<=_A;_++){if(!pm(_))continue;n=ui[_].cid;if(n!=c){c=n;eR[c].flags=eR[c].flags|tc.CFLAG_SEL1}}}for(a=0;a<fR;a++){if(Dj(eR[a].InUse)||Dj(eR[a].flags&tc.CFLAG_SEL1))continue;s=eR[a].row;$E[s].flags=cj($E[s].flags,tc.CENTER|tc.RIGHT_JUSTIFY);$E[s].flags=$E[s].flags|t;$E[s].indent=e}if(i)yJ(false,true,0,true);return true}_i.TerRowHeightHtml=function(t,e){var r,i;if(!lv||!QD())_i.TerCreateControl();if(t<=0||t>=fR||!eR[t].InUse)return false;r=eR[t].row;for(i=r;i>0;i=$E[i].NextRow){$E[i].MinHeight=e;if(u6(i))break}for(i=$E[i].PrevRow;i>0;i=$E[i].PrevRow){$E[i].MinHeight=e;if(s6(i))break}return true};_i.TerRowHeight=function(i,f,l){var t,e;var r,a,n;var c;var s;if(!lv||!QD())_i.TerCreateControl();if(i!=-1)return f8(i,f,l);a=ui[br].cid;c=eR[a].row;var _=_i.DlgCompHeight;var o=_i.DlgFont;var u=new $t.DialogBox(te,"Table Row Height",o,true,P,JV(2));var T=u.cvs;u.addGroupBox(0,0,4,3,"",o,0,JV(7),JV(10),JV(10));c=eR[a].row;var A=$E[c].flags;var E=new $t.RadioButton(T,0,0,JV(15),o,"Auto",false,null,S);u.addComp(E,1,0,1,1,"left","middle",JV(15),0,JV(10));var R=new $t.RadioButton(T,JV(1),0,JV(15),o,"Minimum",false,E,S);u.addComp(R,1,1,1,1,"left","middle",JV(15));var L=new $t.RadioButton(T,2,0,JV(15),o,"Exact",false,R,S);u.addComp(L,1,2,1,1,"left","middle",JV(15),0,JV(10));var C=new $t.Label(T,0,0,o," ");u.addComp(C,1,3,1,1,"Left","middle",0,0,JV(10),0);var I=new $t.Label(T,0,0,o,"Height (inches)");u.addComp(I,3,1,1,1,"Left","middle",0,0,JV(15),0);var d=new $t.TextBox(T,0,0,JV(60),_,"",o,_i.caret,false,true,null);u.addComp(d,3,2,1,1,"left","middle");var F=new $t.CheckBox(T,0,0,JV(15),JV(16),o,"Apply to all rows in the current table",true,null);u.addComp(F,5,0,1,3,"left","middle");u.show();i=$E[c].MinHeight;var g=false;oX(I,"Height",false);if(i==0){E.setSelected(true);g=true}else if(i>0){TX(d,i,false);R.setSelected(true)}else{TX(d,-i,false);L.setSelected(true)}d.setEnabled(!g);d.setEnabled(!g);E.setFocus();function P(t,e,r){if(t=="Cancel"){u.hide();return}else if(t=="OK"){i=0;if(!E.isSelected()){i=uX(this,d,false,0,jV(yo));if(L.isSelected())i=-i}f=false;if(F.isSelected())f=true;u.hide();return f8(i,f,l)}else return}function S(){var t=E.isSelected();I.setEnabled(!t);d.setEnabled(!t)}};function f8(t,e,r){var i,f;var l,a,n;var c;var s;a=ui[br].cid;if(!oi.PrintView||a==0)return true;oi.modified++;if(e){a=ui[br].cid;c=eR[a].row;while(true){if($E[c].PrevRow<=0)break;c=$E[c].PrevRow}V8(-1,$E[c].FirstCell,-1,0,tc.UNDO_TABLE_ATTRIB);while(c>0){$E[c].MinHeight=t;c=$E[c].NextRow}if(r)cG();return true}for(i=0;i<fR;i++)eR[i].flags=cj(eR[i].flags,tc.CFLAG_SEL1|tc.CFLAG_SEL2);if(uA==tc.HILIGHT_OFF){a=ui[br].cid;eR[a].flags=eR[a].flags|tc.CFLAG_SEL1;V8(-1,a,-1,a,tc.UNDO_TABLE_ATTRIB)}else{if(!ON())return false;V8(sA,0,_A,0,tc.UNDO_TABLE_ATTRIB);n=ui[sA].cid;eR[n].flags=eR[n].flags|tc.CFLAG_SEL1;for(s=sA+1;s<=_A;s++){if(!pm(s))continue;a=ui[s].cid;if(a!=n){n=a;eR[n].flags=eR[n].flags|tc.CFLAG_SEL1}}}for(l=0;l<fR;l++){if(Dj(eR[l].InUse)||Dj(eR[l].flags&tc.CFLAG_SEL1))continue;c=eR[l].row;$E[c].MinHeight=t}if(r){_z(true);cG()}return true}_i.TerSetRowKeep=function(t,e,r){var i,f;if(!lv||!QD())_i.TerCreateControl();if(!oi.PageMode)return true;if(uA==tc.HILIGHT_OFF){if(t<=0)t=ui[br].cid;if(t==0)return true;i=eR[t].row;if(e)$E[i].flags|=tc.ROWFLAG_KEEP;else $E[i].flags=cj($E[i].flags,tc.ROWFLAG_KEEP)}else{if(!ON())return false;for(f=sA;f<=_A;f++){if(ui[f].cid==0)continue;t=ui[f].cid;i=eR[t].row;if(e)$E[i].flags|=tc.ROWFLAG_KEEP;else $E[i].flags=cj($E[i].flags,tc.ROWFLAG_KEEP)}}oi.modified++;if(br<Fo)Fo=br;if(r)yJ(false,true,0,true);return true};_i.TerSetHdrRow=function(t,e,r){var i,f;if(!lv||!QD())_i.TerCreateControl();if(!oi.PageMode)return true;if(uA==tc.HILIGHT_OFF){if(t<=0)t=ui[br].cid;if(t==0)return true;i=eR[t].row;if(e)$E[i].flags|=tc.ROWFLAG_HDR;else $E[i].flags=cj($E[i].flags,tc.ROWFLAG_HDR)}else{if(!ON())return false;for(f=sA;f<=_A;f++){if(ui[f].cid==0)continue;t=ui[f].cid;i=eR[t].row;if(e)$E[i].flags|=tc.ROWFLAG_HDR;else $E[i].flags=cj($E[i].flags,tc.ROWFLAG_HDR)}}oi.modified++;if(br<Fo)Fo=br;if(r)yJ(false,true,0,true);return true};_i.TerSetRowFlags=function(t,e,r,i){var f;if(!lv||!QD())_i.TerCreateControl();if(t<=0)t=ui[br].cid;if(!oi.PageMode||t==0)return true;f=eR[t].row;if(r!=0){$E[f].flags=cj($E[f].flags,r);if(Nj(r&tc.ROWFLAG_RTL))$E[f].flow=tc.FLOW_DEF}if(e!=0){$E[f].flags|=e;if(Nj(e&tc.ROWFLAG_RTL))$E[f].flow=tc.FLOW_RTL}oi.modified++;if(br<Fo)Fo=br;if(i)yJ(false,true,0,true);return true};_i.TerSetRowTextFlow=function(t,i,f,l){var e,r;var a,n,c;var s;var _;if(!lv||!QD())_i.TerCreateControl();if(f!=tc.FLOW_DEF&&f!=tc.FLOW_RTL&&f!=tc.FLOW_LTR)return false;n=ui[br].cid;if(!oi.PrintView||n==0)return true;s=eR[n].row;f=$E[s].flow;if(!t)return l8(i,f,l);var o=_i.DlgCompHeight;var u=_i.DlgFont;var T=new $t.DialogBox(te,"Table Text Flow",u,true,I,JV(2));var A=T.cvs;T.addGroupBox(0,0,4,1,"",u,0,JV(7),0,JV(10));var E=new $t.RadioButton(A,0,0,JV(15),u,"Left-to-right",f==tc.FLOW_LTR,null,null);T.addComp(E,1,0,1,1,"left","middle",JV(15));var R=new $t.RadioButton(A,1,0,JV(15),u,"Right-to-left",f==tc.FLOW_RTL,E,null);T.addComp(R,2,0,1,1,"left","middle",JV(15));var L=new $t.RadioButton(A,2,0,JV(15),u,"Default text flow",f==tc.FLOW_DEF,R,null);T.addComp(L,3,0,1,1,"left","middle",JV(15));var C=new $t.CheckBox(A,0,0,JV(15),JV(16),u,"Apply to all rows in the table",true,null);T.addComp(C,5,0,1,1,"left","middle",0,0,JV(15));T.show();E.setFocus();function I(t,e,r){if(t=="Cancel"){T.hide();return}else if(t=="OK"){f=tc.FLOW_DEF;if(R.isSelected())f=tc.FLOW_RTL;else if(E.isSelected())f=tc.FLOW_LTR;i=false;if(C.isSelected())i=true;T.hide();return l8(i,f,l)}else return}};function l8(t,e,r){var i,f;var l,a,n;var c;var s;a=ui[br].cid;if(!oi.PrintView||a==0)return true;c=eR[a].row;oi.modified++;if(t){a=ui[br].cid;c=eR[a].row;while(true){if($E[c].PrevRow<=0)break;c=$E[c].PrevRow}V8(-1,$E[c].FirstCell,-1,0,tc.UNDO_TABLE_ATTRIB);while(c>0){$E[c].flow=e;c=$E[c].NextRow}if(r)_i.TerRepaginate(true);else _z(true);return true}for(i=0;i<fR;i++)eR[i].flags=cj(eR[i].flags,tc.CFLAG_SEL1|tc.CFLAG_SEL2);if(uA==tc.HILIGHT_OFF){a=ui[br].cid;eR[a].flags=eR[a].flags|tc.CFLAG_SEL1;V8(-1,a,-1,a,tc.UNDO_TABLE_ATTRIB)}else{if(!ON())return false;V8(sA,0,_A,0,tc.UNDO_TABLE_ATTRIB);n=ui[sA].cid;eR[n].flags=eR[n].flags|tc.CFLAG_SEL1;for(s=sA+1;s<=_A;s++){if(!pm(s))continue;a=ui[s].cid;if(a!=n){n=a;eR[n].flags=eR[n].flags|tc.CFLAG_SEL1}}}for(l=0;l<fR;l++){if(Dj(eR[l].InUse)||Dj(eR[l].flags&tc.CFLAG_SEL1))continue;c=eR[l].row;$E[c].flow=e}if(r)_i.TerRepaginate(true);else _z(true);return true}_i.TerCellWidth=function(f,l,a,n){var t,e,r;var i=false;if(!lv||!QD())_i.TerCreateControl();if(uA==tc.HILIGHT_CHAR&&(ui[sA].cid>0||ui[_A].cid>0))i=true;if(i)r=ui[sA].cid;else r=ui[br].cid;if(!oi.PrintView||r==0&&!i)return true;if(r==0&&f==tc.SEL_ALL)return true;if(f>0){if(f==tc.SEL_CELLS)f=tc.IDC_TABLE_SEL_CELLS;else if(f==tc.SEL_COLS)f=tc.IDC_TABLE_SEL_COLS;else if(f==tc.SEL_ROWS)f=tc.IDC_TABLE_SEL_ROWS;else if(f==tc.SEL_ALL)f=tc.IDC_TABLE_ALL;else f=0;return a8(f,l,a,n)}var c=_i.DlgCompHeight;var s=_i.DlgFont;var _=new $t.DialogBox(te,"Set Cell Width",s,true,d,JV(2));var o=_.cvs;_.addGroupBox(0,0,4,3,"Range",s,0,JV(7),0,0);var u=new $t.RadioButton(o,0,0,JV(15),s,"All Cells",false,null,null);_.addComp(u,1,0,1,1,"left","middle",JV(15),0,JV(30));var T=new $t.RadioButton(o,1,0,JV(15),s,"Selected Cells",false,u,null);_.addComp(T,2,0,1,1,"left","middle",JV(15),0,JV(30));var A=new $t.RadioButton(o,2,0,JV(15),s,"Columns",false,T,null);_.addComp(A,1,1,1,1,"left","middle",0);var E=new $t.RadioButton(o,2,0,JV(15),s,"Rows",false,A,null);_.addComp(E,2,1,1,1,"left","middle",0);_.addGroupBox(4,0,3,3,"",s,0,JV(7),0,JV(10));var R=new $t.Label(o,0,0,s,"Width (inch)");_.addComp(R,5,0,1,1,"Left","middle",JV(15),0,JV(40));var L=new $t.TextBox(o,0,0,60,c,"",s,_i.caret,false,true,null);_.addComp(L,5,1,1,2,"left","middle",0,0,0,JV(10));var C=new $t.Label(o,0,0,s,"Margin (inch)");_.addComp(C,6,0,1,1,"Left","middle",JV(15),0,JV(40));var I=new $t.TextBox(o,0,0,JV(60),c,"",s,_i.caret,false,true,null);_.addComp(I,6,1,1,2,"left","middle");oX(R,"Width",false);oX(C,"Margin",true);_.show();if(uA==tc.HILIGHT_OFF)TX(L,eR[r].width,false);if(uA==tc.HILIGHT_OFF)TX(I,eR[r].margin,true);T.setSelected(true);L.setFocus();function d(t,e,r){if(t=="Cancel"){_.hide();return}else if(t=="OK"){var i;l=a=-1;if(L.getText().length>0){i=uX(this,L,false,0,0);if(!aP)return;l=i}if(I.getText().length>0){i=uX(this,I,true,0,720);if(!aP)return;a=i}if(u.isSelected())f=tc.IDC_TABLE_ALL;else if(T.isSelected())f=tc.IDC_TABLE_SEL_CELLS;else if(A.isSelected())f=tc.IDC_TABLE_SEL_COLS;else f=tc.IDC_TABLE_SEL_ROWS;_.hide();return a8(f,l,a,n)}else return}};function a8(t,e,r,i){var f,l,a;var n=false;if(uA==tc.HILIGHT_CHAR&&(ui[sA].cid>0||ui[_A].cid>0))n=true;if(n)a=ui[sA].cid;else a=ui[br].cid;if(!oi.PrintView||a==0&&!n)return true;if(a==0&&t==tc.SEL_ALL)return true;if(t==0)return true;if(!B6(t))return false;V8(0,0,0,0,tc.UNDO_TABLE_ATTRIB);for(f=0;f<fR;f++){if(Dj(eR[f].InUse)||Dj(eR[f].flags&(tc.CFLAG_SEL1|tc.CFLAG_SEL2)))continue;if(e>=0){eR[f].width=eR[f].FixWidth=e;eR[f].flags=cj(eR[f].flags,tc.CFLAG_AUTO_WIDTH|tc.CFLAG_AUTO_WIDTH_RTF);eR[f].FixWidth=0;l=eR[f].row;$E[l].flags=cj($E[l].flags,tc.ROWFLAG_AUTO_FIT|tc.ROWFLAG_AUTO_WIDTH_RTF);$E[l].FixWidth=0}if(r>=0){eR[f].margin=r;$E[eR[f].row].CellMargin=r}if(eR[f].width<3*eR[f].margin)eR[f].FixWidth=eR[f].width=3*eR[f].margin;if(r>0){if(Nj(eR[f].border&tc.BORDER_LEFT)&&eR[f].BorderWidth[tc.BORDER_INDEX_LEFT]>r)eR[f].BorderWidth[tc.BORDER_INDEX_LEFT]=r;if(Nj(eR[f].border&tc.BORDER_RIGHT)&&eR[f].BorderWidth[tc.BORDER_INDEX_RIGHT]>r)eR[f].BorderWidth[tc.BORDER_INDEX_RIGHT]=r;if(Nj(eR[f].border&tc.BORDER_TOP)&&eR[f].BorderWidth[tc.BORDER_INDEX_TOP]>r)eR[f].BorderWidth[tc.BORDER_INDEX_TOP]=r;if(Nj(eR[f].border&tc.BORDER_BOT)&&eR[f].BorderWidth[tc.BORDER_INDEX_BOT]>r)eR[f].BorderWidth[tc.BORDER_INDEX_BOT]=r}}if(eR[a].level>0){var c=eR[a].ParentCell;var s=eR[c].row;if(Nj($E[s].flags&tc.ROWFLAG_AUTO_WIDTH_RTF)){var _=0,o=0,u;l=eR[a].row;u=_6(l);for(l=u;l>0;l=$E[l].NextRow){_=0;for(f=$E[l].FirstCell;f>0;f=eR[f].NextCell)_+=eR[f].width;if(_>o)o=_}if(o>eR[c].width-x6(c)-y6(c)){for(l=u;l>0;l=$E[l].NextRow){for(f=$E[l].FirstCell;f>0;f=eR[f].NextCell)eR[f].FixWidth=eR[f].width}cO|=tc.TOFLAG3_SET_COL_SPAN;FR=true;dR=s;_i.TerRepaginate(true)}}}bG(true);oi.modified++;if(i)cG();return true}_i.TerCellBorder=function(t,e,r,i,f,l){return _i.TerCellBorder2(t,e,r,i,f,false,l)};_i.TerCellBorder2=function(f,l,a,n,c,s,_){var t,o;var e=false;if(!lv||!QD())_i.TerCreateControl();if(f>0){if(f==tc.SEL_CELLS)f=tc.IDC_TABLE_SEL_CELLS;else if(f==tc.SEL_COLS)f=tc.IDC_TABLE_SEL_COLS;else if(f==tc.SEL_ROWS)f=tc.IDC_TABLE_SEL_ROWS;else if(f==tc.SEL_ALL)f=tc.IDC_TABLE_ALL;else f=0;return n8(f,l,a,n,c,s,-1,_)}if(uA==tc.HILIGHT_CHAR&&(ui[sA].cid>0||ui[_A].cid>0))e=true;if(e)t=ui[sA].cid;else t=ui[br].cid;if(!oi.PrintView||t==0&&!e)return true;if(t==0&&f==tc.SEL_ALL)return true;o=eR[t].margin;var r=_i.DlgCompHeight;var i=_i.DlgFont;var u=new $t.DialogBox(te,"Set Cell Border Width",i,true,G,JV(2));var T=u.cvs;u.addGroupBox(0,0,7,1,"Range",i,0,JV(7),0,0);var A=new $t.RadioButton(T,0,0,JV(15),i,"All Cells",false,null,null);u.addComp(A,2,0,1,1,"left","middle",JV(15),0,JV(30));var E=new $t.RadioButton(T,1,0,JV(15),i,"Selected Cells",false,A,null);u.addComp(E,3,0,1,1,"left","middle",JV(15),0,JV(30));var R=new $t.RadioButton(T,2,0,JV(15),i,"Columns",false,E,null);u.addComp(R,4,0,1,1,"left","middle",JV(15),0,JV(30));var L=new $t.RadioButton(T,2,0,JV(15),i,"Rows",false,R,null);u.addComp(L,5,0,1,1,"left","middle",JV(15),0,JV(30));var C=new $t.Label(T,0,0,i,"Border Width");u.addComp(C,0,1,1,2,"Left","top",JV(5),JV(-7),JV(40));u.addGroupBox(0,1,7,2,"",i,0,JV(7),0,0);var I=new $t.Label(T,0,0,i,"All");u.addComp(I,1,1,1,1,"Left","middle",JV(15),0,JV(45));var d=new $t.TextBox(T,0,0,JV(60),r,"",i,_i.caret,false,true,B);u.addComp(d,1,2,1,1,"left","middle",0,JV(-7),JV(30),JV(15));var F=new $t.Label(T,0,0,i,"Top");u.addComp(F,2,1,1,1,"Left","middle",JV(15),0,JV(45));var g=new $t.TextBox(T,0,0,60,r,"",i,_i.caret,false,true,null);u.addComp(g,2,2,1,1,"left","middle",0,0,JV(30),JV(10));var P=new $t.Label(T,0,0,i,"Bottom");u.addComp(P,3,1,1,1,"Left","middle",JV(15),0,JV(45));var S=new $t.TextBox(T,0,0,60,r,"",i,_i.caret,false,true,null);u.addComp(S,3,2,1,1,"left","middle",0,0,JV(30),0);var h=new $t.Label(T,0,0,i,"Left");u.addComp(h,4,1,1,1,"Left","middle",JV(15),0,JV(45));var O=new $t.TextBox(T,0,0,JV(60),r,"",i,_i.caret,false,true,null);u.addComp(O,4,2,1,1,"left","middle",0,0,JV(30),0);var v=new $t.Label(T,0,0,i,"Right");u.addComp(v,5,1,1,1,"Left","middle",JV(15),0,JV(45));var p=new $t.TextBox(T,0,0,JV(60),r,"",i,_i.caret,false,true,null);u.addComp(p,5,2,1,1,"left","middle",0,0,JV(30),0);u.addGroupBox(7,0,4,3,"",i,0,JV(7),0,0);var N=new $t.CheckBox(T,0,0,JV(15),JV(16),i,"Draw outline around selected cells",false,null);u.addComp(N,8,0,1,3,"left","middle",JV(7),0);var D=new $t.Label(T,0,0,i,"CellMargin (points)");u.addComp(D,10,0,1,1,"Left","middle",JV(7),JV(-10),JV(40));var M=new $t.TextBox(T,0,0,JV(60),r,"",i,_i.caret,false,true,null);u.addComp(M,10,1,1,1,"left","middle",JV(5),JV(-10),0,0);oX(C,"Border Width",true);oX(D,"Cell Margin",true);u.show();if(Nj(eR[t].border&tc.BORDER_TOP))width=eR[t].BorderWidth[tc.BORDER_INDEX_TOP];else width=0;if(width>0||uA==tc.HILIGHT_OFF)TX(g,width,true);if(Nj(eR[t].border&tc.BORDER_BOT))width=eR[t].BorderWidth[tc.BORDER_INDEX_BOT];else width=0;if(width>0||uA==tc.HILIGHT_OFF)TX(S,width,true);if(Nj(eR[t].border&tc.BORDER_LEFT))width=eR[t].BorderWidth[tc.BORDER_INDEX_LEFT];else width=0;if(width>0||uA==tc.HILIGHT_OFF)TX(O,width,true);if(Nj(eR[t].border&tc.BORDER_RIGHT))width=eR[t].BorderWidth[tc.BORDER_INDEX_RIGHT];else width=0;if(width>0||uA==tc.HILIGHT_OFF)TX(p,width,true);if(uA==tc.HILIGHT_OFF)A.setSelected(true);else E.setSelected(true);if(uA==tc.HILIGHT_OFF)TX(M,eR[t].margin,true);d.setFocus();function G(t,e,r){if(t=="Cancel"){u.hide();return}else if(t=="OK"){var i;o=-1;l=a=n=c=-1;if(M.getText().length>0){i=uX(this,M,true,0,720);if(!aP)return;o=i}if(LX(g)>o||LX(S)>o||LX(O)>o||LX(p)>o){QY(tc.MSG_SMALL_CELL_MARGIN,"terdlg_cell_border");M.setFocus();return}if(g.getText().length>0){l=uX(this,g,true,0,o)}if(S.getText().length>0){a=uX(this,S,true,0,o)}if(O.getText().length>0){n=uX(this,O,true,0,o)}if(p.getText().length>0){c=uX(this,p,true,0,o)}s=N.isSelected();if(A.isSelected())f=tc.IDC_TABLE_ALL;else if(E.isSelected())f=tc.IDC_TABLE_SEL_CELLS;else if(R.isSelected())f=tc.IDC_TABLE_SEL_COLS;else f=tc.IDC_TABLE_SEL_ROWS;u.hide();return n8(f,l,a,n,c,s,o,_)}else return}function B(t,e,r){if(t=="change"){var i=d.getText();if(i.length>0){g.setText(i);S.setText(i);O.setText(i);p.setText(i)}}}};function n8(t,e,r,i,f,l,a,n){var c;var s,_,o;var u=[];var T=[];var A=false;var E=true;var R=0;var L=0;if(uA==tc.HILIGHT_CHAR&&(ui[sA].cid>0||ui[_A].cid>0))A=true;if(A)_=ui[sA].cid;else _=ui[br].cid;if(!oi.PrintView||_==0&&!A)return true;if(_==0&&t==tc.SEL_ALL)return true;for(c=0;c<4;c++)u[c]=eR[_].BorderWidth[c];o=eR[_].margin;if(t>0){eR[_].BorderWidth[tc.BORDER_INDEX_TOP]=e;eR[_].BorderWidth[tc.BORDER_INDEX_BOT]=r;eR[_].BorderWidth[tc.BORDER_INDEX_LEFT]=i;eR[_].BorderWidth[tc.BORDER_INDEX_RIGHT]=f}for(c=0;c<4;c++){T[c]=eR[_].BorderWidth[c];eR[_].BorderWidth[c]=u[c]}if(a==-1)a=eR[_].margin;eR[_].margin=o;$E[eR[_].row].CellMargin=o;if(t==0)return true;if(!B6(t))return false;V8(0,0,0,0,tc.UNDO_TABLE_ATTRIB);for(s=0;s<fR;s++){if(Dj(eR[s].InUse)||Dj(eR[s].flags&(tc.CFLAG_SEL1|tc.CFLAG_SEL2)))continue;if(a>eR[s].width/3)a=eR[s].width/3}for(s=0;s<fR;s++){var C=false,I=false,d=false;if(Dj(eR[s].InUse)||Dj(eR[s].flags&(tc.CFLAG_SEL1|tc.CFLAG_SEL2)))continue;C=eR[s].margin!=a;I=eR[s].LeftPad>=0&&eR[s].LeftPad!=a;d=eR[s].RightPad>=0&&eR[s].RightPad!=a;if(C||I||d){if(eR[s].margin==eR[s].LeftPad&&eR[s].margin==eR[s].RightPad){eR[s].margin=eR[s].LeftPad=eR[s].RightPad=a}else{eR[s].margin=a;if(eR[s].LeftPad>=0)eR[s].LeftPad=a;if(eR[s].RightPad>=0)eR[s].RightPad=a}}$E[eR[s].row].CellMargin=a;if(T[tc.BORDER_INDEX_TOP]>=0){if(T[tc.BORDER_INDEX_TOP]>0){E=true;if(l){R=v6(s,false);if(R>0&&Nj(eR[R].flags&(tc.CFLAG_SEL1|tc.CFLAG_SEL2)))E=false}if(E){eR[s].border|=tc.BORDER_TOP;eR[s].BorderWidth[tc.BORDER_INDEX_TOP]=Math.min(a,T[tc.BORDER_INDEX_TOP])}}else eR[s].border=cj(eR[s].border,tc.BORDER_TOP)}if(T[tc.BORDER_INDEX_BOT]>=0){if(T[tc.BORDER_INDEX_BOT]>0){E=true;if(l){L=M6(s);if(L>0&&Nj(eR[L].flags&(tc.CFLAG_SEL1|tc.CFLAG_SEL2)))E=false}if(E){eR[s].border|=tc.BORDER_BOT;eR[s].BorderWidth[tc.BORDER_INDEX_BOT]=Math.min(a,T[tc.BORDER_INDEX_BOT])}}else eR[s].border=cj(eR[s].border,tc.BORDER_BOT)}if(T[tc.BORDER_INDEX_LEFT]>=0){if(T[tc.BORDER_INDEX_LEFT]>0){E=true;if(l){R=eR[s].PrevCell;if(R>0&&Nj(eR[R].flags&(tc.CFLAG_SEL1|tc.CFLAG_SEL2)))E=false}if(E){eR[s].border|=tc.BORDER_LEFT;eR[s].BorderWidth[tc.BORDER_INDEX_LEFT]=Math.min(a,T[tc.BORDER_INDEX_LEFT])}}else eR[s].border=cj(eR[s].border,tc.BORDER_LEFT)}if(T[tc.BORDER_INDEX_RIGHT]>=0){if(T[tc.BORDER_INDEX_RIGHT]>0){E=true;if(l){L=eR[s].NextCell;if(L>0&&Nj(eR[L].flags&(tc.CFLAG_SEL1|tc.CFLAG_SEL2)))E=false}if(E){eR[s].border|=tc.BORDER_RIGHT;eR[s].BorderWidth[tc.BORDER_INDEX_RIGHT]=Math.min(a,T[tc.BORDER_INDEX_RIGHT])}}else eR[s].border=cj(eR[s].border,tc.BORDER_RIGHT)}}bG(true);oi.modified++;if(n)cG();return true}function c8(t){var e=eR[t].row;if(Nj(Qh&tc.TFLAG3_PLAIN_TABLE_BORDER))return 0;if($E[e].CellSpacing>0)return $E[e].CellSpacing;else if(Nj(eR[t].flags&tc.CFLAG_3D))return 60;else return 0}_i.TerTableOutlineBorder=function(t,e,r,i){return _i.TerTableOutlineBorder2(t,e,r,e,r,e,r,e,r,i)};_i.TerTableOutlineBorder2=function(t,e,r,i,f,l,a,n,c,s){var _,o,u,T;if(!lv||!QD())_i.TerCreateControl();if(t<=0||t>=fR)return false;o=eR[t].row;while(o>0&&!s6(o)){if($E[o].PrevRow<=0)break;o=$E[o].PrevRow}u=o;while(o>0&&!u6(o)){if($E[o].NextRow<=0)break;o=$E[o].NextRow}T=o;for(o=u;o>0;o=$E[o].NextRow){$E[o].BorderWidth[tc.BORDER_INDEX_TOP]=e;$E[o].BorderWidth[tc.BORDER_INDEX_BOT]=i;$E[o].BorderWidth[tc.BORDER_INDEX_LEFT]=l;$E[o].BorderWidth[tc.BORDER_INDEX_RIGHT]=n;$E[o].BorderColor[tc.BORDER_INDEX_TOP]=r;$E[o].BorderColor[tc.BORDER_INDEX_BOT]=f;$E[o].BorderColor[tc.BORDER_INDEX_LEFT]=a;$E[o].BorderColor[tc.BORDER_INDEX_RIGHT]=c;if(o==T)break}if(c8(t)>0)return true;if(e>=0){_=$E[u].FirstCell;while(_>0){eR[_].BorderWidth[tc.BORDER_INDEX_TOP]=e;if(eR[_].margin<e)eR[_].margin=e;if(eR[_].TopPad>=0&&eR[_].TopPad<e)eR[_].TopPad=e;eR[_].BorderColor[tc.BORDER_INDEX_TOP]=JG(r,true);if(e>0)eR[_].border|=tc.BORDER_TOP;else eR[_].border=cj(eR[_].border,tc.BORDER_TOP);_=eR[_].NextCell}}if(i>=0){_=$E[T].FirstCell;while(_>0){eR[_].BorderWidth[tc.BORDER_INDEX_BOT]=i;if(eR[_].margin<i)eR[_].margin=i;if(eR[_].BotPad>=0&&eR[_].BotPad<i)eR[_].BotPad=i;eR[_].BorderColor[tc.BORDER_INDEX_BOT]=JG(f,false);if(i>0)eR[_].border|=tc.BORDER_BOT;else eR[_].border=cj(eR[_].border,tc.BORDER_BOT);_=eR[_].NextCell}}o=u;while(o>0){_=$E[o].FirstCell;if(l>=0){eR[_].BorderWidth[tc.BORDER_INDEX_LEFT]=l;if(eR[_].margin<l)eR[_].margin=l;if(eR[_].LeftPad>=0&&eR[_].LeftPad<l)eR[_].LeftPad=l;eR[_].BorderColor[tc.BORDER_INDEX_LEFT]=JG(a,true);if(l>0)eR[_].border|=tc.BORDER_LEFT;else eR[_].border=cj(eR[_].border,tc.BORDER_LEFT)}while(_>0){if(eR[_].NextCell<=0&&n>=0){eR[_].BorderWidth[tc.BORDER_INDEX_RIGHT]=n;if(eR[_].margin<n)eR[_].margin=n;if(eR[_].RightPad>=0&&eR[_].RightPad<n)eR[_].RightPad=n;eR[_].BorderColor[tc.BORDER_INDEX_RIGHT]=JG(c,false);if(n>0)eR[_].border|=tc.BORDER_RIGHT;else eR[_].border=cj(eR[_].border,tc.BORDER_RIGHT);break}_=eR[_].NextCell}o=$E[o].NextRow}oi.modified++;if(s)cG();return true};_i.TerCellBorderColor=function(t,e,r,i,f,l){return _i.TerCellBorderColor(t,Tk(e,"clr_error")==0?tc.CLR_ERROR:yK(e),Tk(r,"clr_error")==0?tc.CLR_ERROR:yK(r),Tk(i,"clr_error")==0?tc.CLR_ERROR:yK(i),Tk(f,"clr_error")==0?tc.CLR_ERROR:yK(f),l)};_i.TerCellBorderColor=function(i,f,l,a,n,c){var t;var e=false;if(!lv||!QD())_i.TerCreateControl();if(i>0){if(i==tc.SEL_CELLS)i=tc.IDC_TABLE_SEL_CELLS;else if(i==tc.SEL_COLS)i=tc.IDC_TABLE_SEL_COLS;else if(i==tc.SEL_ROWS)i=tc.IDC_TABLE_SEL_ROWS;else if(i==tc.SEL_ALL)i=tc.IDC_TABLE_ALL;else i=0;return s8(i,f,l,a,n,c)}if(uA==tc.HILIGHT_CHAR&&(ui[sA].cid>0||ui[_A].cid>0))e=true;if(e)t=ui[sA].cid;else t=ui[br].cid;if(!oi.PrintView||t==0&&!e)return true;if(t==0&&i==tc.SEL_ALL)return true;f=eR[t].BorderColor[tc.BORDER_INDEX_TOP];l=eR[t].BorderColor[tc.BORDER_INDEX_BOT];a=eR[t].BorderColor[tc.BORDER_INDEX_LEFT];n=eR[t].BorderColor[tc.BORDER_INDEX_RIGHT];var r=_i.DlgCompHeight;var s=_i.DlgFont;var _=new $t.DialogBox(te,"Set Cell Border Color",s,true,R,JV(2));var o=_.cvs;_.addGroupBox(0,0,7,1,"Range",s,0,JV(7),0,0);var u=new $t.RadioButton(o,0,0,JV(15),s,"All Cells",false,null,null);_.addComp(u,2,0,1,1,"left","middle",JV(15),0,JV(30));var T=new $t.RadioButton(o,1,0,JV(15),s,"Selected Cells",false,u,null);_.addComp(T,3,0,1,1,"left","middle",JV(15),0,JV(30));var A=new $t.RadioButton(o,2,0,JV(15),s,"Columns",false,T,null);_.addComp(A,4,0,1,1,"left","middle",JV(15),0,JV(30));var E=new $t.RadioButton(o,2,0,JV(15),s,"Rows",false,A,null);_.addComp(E,5,0,1,1,"left","middle",JV(15),0,JV(30));_.addGroupBox(0,1,7,1,"Border Color",s,0,JV(7),0,0);FldAllColor=new $t.Button(o,0,0,JV(100),r,s,"All...",true,L);_.addComp(FldAllColor,1,1,1,1,"left","middle",0,JV(-7),JV(30),JV(15));FldTopColor=new $t.Button(o,0,0,JV(100),r,s,"Top...",true,C);_.addComp(FldTopColor,2,1,1,1,"left","middle",0,0,JV(30),0);FldBotColor=new $t.Button(o,0,0,JV(100),r,s,"Bottom...",true,I);_.addComp(FldBotColor,3,1,1,1,"left","middle",0,0,JV(30),0);FldLeftColor=new $t.Button(o,0,0,JV(100),r,s,"Left...",true,d);_.addComp(FldLeftColor,4,1,1,1,"left","middle",0,0,JV(30),0);FldRightColor=new $t.Button(o,0,0,JV(100),r,s,"Right...",true,F);_.addComp(FldRightColor,5,1,1,1,"left","middle",0,0,JV(30),0);_.show();if(uA==tc.HILIGHT_OFF)u.setSelected(true);else T.setSelected(true);FldAllColor.setFocus();function R(t,e,r){if(t=="Cancel"){_.hide();return}else if(t=="OK"){if(u.isSelected())i=tc.IDC_TABLE_ALL;else if(T.isSelected())i=tc.IDC_TABLE_SEL_CELLS;else if(A.isSelected())i=tc.IDC_TABLE_SEL_COLS;else i=tc.IDC_TABLE_SEL_ROWS;_.hide();return s8(i,f,l,a,n,c)}else return}function L(t,e,r){Dy("All Border Color","line",f,function(t){f=l=a=n=t})}function C(t,e,r){Dy("Top Border Color","line",f,function(t){f=t})}function I(t,e,r){Dy("Bottom Border Color","line",l,function(t){l=t})}function d(t,e,r){Dy("Left Border Color","line",a,function(t){a=t})}function F(t,e,r){Dy("Right Border Color","line",n,function(t){n=t})}};function s8(t,e,r,i,f,l){var a;var n,c;var s=[];var _=false;if(uA==tc.HILIGHT_CHAR&&(ui[sA].cid>0||ui[_A].cid>0))_=true;if(_)c=ui[sA].cid;else c=ui[br].cid;if(!oi.PrintView||c==0&&!_)return true;if(c==0&&t==tc.SEL_ALL)return true;s[tc.BORDER_INDEX_TOP]=e;s[tc.BORDER_INDEX_BOT]=r;s[tc.BORDER_INDEX_LEFT]=i;s[tc.BORDER_INDEX_RIGHT]=f;if(t==0)return true;if(!B6(t))return false;V8(0,0,0,0,tc.UNDO_TABLE_ATTRIB);for(n=0;n<fR;n++){if(Dj(eR[n].InUse)||Dj(eR[n].flags&(tc.CFLAG_SEL1|tc.CFLAG_SEL2)))continue;if(!MJ(e,tc.CLR_ERROR))eR[n].BorderColor[tc.BORDER_INDEX_TOP]=s[tc.BORDER_INDEX_TOP];if(!MJ(r,tc.CLR_ERROR))eR[n].BorderColor[tc.BORDER_INDEX_BOT]=s[tc.BORDER_INDEX_BOT];if(!MJ(i,tc.CLR_ERROR))eR[n].BorderColor[tc.BORDER_INDEX_LEFT]=s[tc.BORDER_INDEX_LEFT];if(!MJ(f,tc.CLR_ERROR))eR[n].BorderColor[tc.BORDER_INDEX_RIGHT]=s[tc.BORDER_INDEX_RIGHT]}bG(true);oi.modified++;if(l)cG();return true}_i.TerCellShading=function(i,f,l){var t,e,r;var a;var n=false;var c=false;if(!lv||!QD())_i.TerCreateControl();if(uA==tc.HILIGHT_CHAR&&(ui[sA].cid>0||ui[_A].cid>0))n=true;if(n)r=ui[sA].cid;else r=ui[br].cid;if(!oi.PrintView||r==0&&!n)return true;if(i>0){if(f<0)f=0;if(f>100)f=100;if(i==tc.SEL_CELLS)i=tc.IDC_TABLE_SEL_CELLS;else if(i==tc.SEL_COLS)i=tc.IDC_TABLE_SEL_COLS;else if(i==tc.SEL_ROWS)i=tc.IDC_TABLE_SEL_ROWS;else if(i==tc.SEL_ALL)i=tc.IDC_TABLE_ALL;else i=0;return _8(i,f,l)}var s=_i.DlgCompHeight;var _=_i.DlgFont;var o=new $t.DialogBox(te,"Set Cell Shading",_,true,I,JV(2));var u=o.cvs;o.addGroupBox(0,0,4,3,"Range",_,0,JV(7),0,0);var T=new $t.RadioButton(u,0,0,JV(15),_,"All Cells",false,null,null);o.addComp(T,1,0,1,1,"left","middle",JV(15),0,JV(30));var A=new $t.RadioButton(u,1,0,JV(15),_,"Selected Cells",false,T,null);o.addComp(A,2,0,1,1,"left","middle",JV(15),0,JV(30));var E=new $t.RadioButton(u,2,0,JV(15),_,"Columns",false,A,null);o.addComp(E,1,1,1,1,"left","middle",0);var R=new $t.RadioButton(u,2,0,JV(15),_,"Rows",false,E,null);o.addComp(R,2,1,1,1,"left","middle",0);o.addGroupBox(4,0,2,3,"",_,0,JV(7),0,JV(10));var L=new $t.Label(u,0,0,_,"Shading Percentage");o.addComp(L,5,0,1,1,"Left","middle",JV(15),0,JV(40));var C=new $t.TextBox(u,0,0,JV(60),s,"",_,_i.caret,false,true,null);o.addComp(C,5,1,1,2,"left","middle",0,0,0,JV(10));o.show();if(uA!=tc.HILIGHT_OFF){f=-1;if(AA==0)EndRow=_A-1;else EndRow=_A;for(t=sA;t<=EndRow;t++){if(!pm(t))continue;e=ui[t].cid;if(e==0)continue;if(f<0)f=eR[e].shading;if(eR[e].shading!=f){c=false;break}}if(f<0)f=0}else f=eR[r].shading;if(c)CellShadsetText(f.toString());A.setSelected(true);C.setFocus();function I(t,e,r){if(t=="Cancel"){o.hide();return}else if(t=="OK"){if(!EX(this,"I",C,0,100))return;f=LX(C);if(T.isSelected())i=tc.IDC_TABLE_ALL;else if(A.isSelected())i=tc.IDC_TABLE_SEL_CELLS;else if(E.isSelected())i=tc.IDC_TABLE_SEL_COLS;else i=tc.IDC_TABLE_SEL_ROWS;o.hide();return _8(i,f,l)}else return}};function _8(t,e,r){var i,f;var l;var a=false;if(!lv||!QD())_i.TerCreateControl();if(uA==tc.HILIGHT_CHAR&&(ui[sA].cid>0||ui[_A].cid>0))a=true;if(a)f=ui[sA].cid;else f=ui[br].cid;if(t==0)return true;if(!B6(t))return false;V8(0,0,0,0,tc.UNDO_TABLE_ATTRIB);uA=tc.HILIGHT_OFF;for(i=0;i<fR;i++){if(Dj(eR[i].InUse)||Dj(eR[i].flags&(tc.CFLAG_SEL1|tc.CFLAG_SEL2)))continue;eR[i].shading=e}bG(true);oi.modified++;if(r)cG();return true}_i.TerMarkCells=function(t){if(!lv||!QD())_i.TerCreateControl();if(t==tc.SEL_CELLS)t=tc.IDC_TABLE_SEL_CELLS;else if(t==tc.SEL_COLS)t=tc.IDC_TABLE_SEL_COLS;else if(t==tc.SEL_ROWS)t=tc.IDC_TABLE_SEL_ROWS;else if(t==tc.SEL_ALL)t=tc.IDC_TABLE_ALL;else t=0;if(t==0)return false;if(!B6(t))return false;return true};_i.TerCellColor=function(t,e,r){return _i.TerCellColor(t,yK(e),r)};_i.TerCellColor=function(i,f,a){var t,e;var r;var n=false,c=false;if(!lv||!QD())_i.TerCreateControl();if(uA==tc.HILIGHT_CHAR&&(ui[sA].cid>0||ui[_A].cid>0))n=true;if(n)e=ui[sA].cid;else e=ui[br].cid;if(!oi.PrintView||e==0&&!n)return true;if(e==0&&i==tc.SEL_ALL)return true;if(i>0){if(i==tc.SEL_CELLS)i=tc.IDC_TABLE_SEL_CELLS;else if(i==tc.SEL_COLS)i=tc.IDC_TABLE_SEL_COLS;else if(i==tc.SEL_ROWS)i=tc.IDC_TABLE_SEL_ROWS;else if(i==tc.SEL_ALL)i=tc.IDC_TABLE_ALL;else i=0;return o8(i,f,a)}f=eR[e].BackColor;var s=_i.DlgCompHeight;var _=_i.DlgFont;var o=new $t.DialogBox(te,"Set Cell Color",_,true,C,JV(2));var u=o.cvs;o.addGroupBox(0,0,4,3,"Range",_,0,JV(7),0,0);var T=new $t.RadioButton(u,0,0,JV(15),_,"All Cells",false,null,null);o.addComp(T,1,0,1,1,"left","middle",JV(15),0,JV(30));var A=new $t.RadioButton(u,1,0,JV(15),_,"Selected Cells",false,T,null);o.addComp(A,2,0,1,1,"left","middle",JV(15),0,JV(30));var E=new $t.RadioButton(u,2,0,JV(15),_,"Columns",false,A,null);o.addComp(E,1,1,1,1,"left","middle",0,0,JV(30));var R=new $t.RadioButton(u,2,0,JV(15),_,"Rows",false,E,null);o.addComp(R,2,1,1,1,"left","middle",0);o.addGroupBox(4,0,2,3,"",_,0,JV(7),0,JV(10));var L=new $t.Button(u,0,0,JV(200),s,_,"Set Color..",true,function(t,e){Dy("Cell Background Color","bknd",f,function(t){f=t})});o.addComp(L,5,0,1,2,"center","middle",0,JV(-2));o.show();if(uA!=tc.HILIGHT_OFF){f=Color.white;if(AA==0)EndRow=_A-1;else EndRow=_A;for(l=sA;l<=EndRow;l++){if(!pm(l))continue;t=ui[l].cid;if(t==0)continue;if(f==Color.white)f=eR[t].BackColor;if(eR[t].BackColor!=f){c=false;break}}}else f=eR[e].BackColor;if(!c)f=tc.CLR_WHITE;if(uA==tc.HILIGHT_OFF)T.setSelected(true);else A.setSelected(true);L.setFocus();function C(t,e,r){if(t=="Cancel"){o.hide();return}else if(t=="OK"){if(T.isSelected())i=tc.IDC_TABLE_ALL;else if(A.isSelected())i=tc.IDC_TABLE_SEL_CELLS;else if(E.isSelected())i=tc.IDC_TABLE_SEL_COLS;else i=tc.IDC_TABLE_SEL_ROWS;o.hide();return o8(i,f,a)}else return}if(false&&i<=0){Cs=e;r=eR[e].BackColor;if(!FX(new terdlg_cell_color(_i)))return true;i=hs;f=eR[e].BackColor;eR[e].BackColor=r}};function o8(t,e,r){var i,f;var l;var a=false;if(!lv||!QD())_i.TerCreateControl();if(uA==tc.HILIGHT_CHAR&&(ui[sA].cid>0||ui[_A].cid>0))a=true;if(a)f=ui[sA].cid;else f=ui[br].cid;if(!oi.PrintView||f==0&&!a)return true;if(f==0&&t==tc.SEL_ALL)return true;if(t==0)return true;if(!B6(t))return false;V8(0,0,0,0,tc.UNDO_TABLE_ATTRIB);uA=tc.HILIGHT_OFF;for(i=0;i<fR;i++){if(Dj(eR[i].InUse)||Dj(eR[i].flags&(tc.CFLAG_SEL1|tc.CFLAG_SEL2)))continue;eR[i].BackColor=e}bG(true);oi.modified++;if(r)cG();return true}_i.TerCellVertAlign=function(f,a,n){var t;var e=false;if(!lv||!QD())_i.TerCreateControl();if(uA==tc.HILIGHT_CHAR&&(ui[sA].cid>0||ui[_A].cid>0))e=true;if(e)t=ui[sA].cid;else t=ui[br].cid;if(!oi.PrintView||t==0&&!e)return true;if(f>0){if(a!=tc.CFLAG_VALIGN_CTR&&a!=tc.CFLAG_VALIGN_BOT&&a!=tc.CFLAG_VALIGN_BASE)a=0;if(f==tc.SEL_CELLS)f=tc.IDC_TABLE_SEL_CELLS;else if(f==tc.SEL_COLS)f=tc.IDC_TABLE_SEL_COLS;else if(f==tc.SEL_ROWS)f=tc.IDC_TABLE_SEL_ROWS;else if(f==tc.SEL_ALL)f=tc.IDC_TABLE_ALL;else f=0;return u8(f,a,n)}var r=_i.DlgCompHeight;var i=_i.DlgFont;var c=new $t.DialogBox(te,"Vertical Cell Alignment",i,true,F,JV(2));var s=c.cvs;c.addGroupBox(0,0,6,1,"Range",i,0,JV(7),0,0);var _=new $t.RadioButton(s,0,0,JV(15),i,"All Cells",false,null,null);c.addComp(_,1,0,1,1,"left","middle",JV(15),0,JV(30));var o=new $t.RadioButton(s,1,0,JV(15),i,"Selected Cells",false,_,null);c.addComp(o,2,0,1,1,"left","middle",JV(15),0,JV(30));var u=new $t.RadioButton(s,2,0,JV(15),i,"Columns",false,o,null);c.addComp(u,3,0,1,1,"left","middle",JV(15),0,JV(30));var T=new $t.RadioButton(s,2,0,JV(15),i,"Rows",false,u,null);c.addComp(T,4,0,1,1,"left","middle",JV(15),0,JV(30));var A=new $t.Label(s,0,0,i,"     ");c.addComp(A,5,0,1,1,"left","middle",0,0,0,-JV(8));c.addGroupBox(0,1,6,1,"Vertical Alignment",i,0,JV(7),0,0);var E=new $t.RadioButton(s,0,0,JV(15),i,"Top",false,null,null);c.addComp(E,1,1,1,1,"left","middle",JV(15),0,JV(80));var R=new $t.RadioButton(s,1,0,JV(15),i,"Center",false,E,null);c.addComp(R,2,1,1,1,"left","middle",JV(15),0,JV(80));var L=new $t.RadioButton(s,2,0,JV(15),i,"Bottom",false,R,null);c.addComp(L,3,1,1,1,"left","middle",JV(15),0,JV(80));var C=new $t.RadioButton(s,2,0,JV(15),i,"Baseline",false,L,null);c.addComp(C,4,1,1,1,"left","middle",JV(15),0,JV(80));c.show();var I=tc.CFLAG_VALIGN_CTR|tc.CFLAG_VALIGN_BOT|tc.CFLAG_VALIGN_BASE;var d=true;if(uA!=tc.HILIGHT_OFF){a=0;AlignSet=false;if(AA==0)EndRow=_A-1;else EndRow=_A;for(l=sA;l<=EndRow;l++){if(!pm(l))continue;cl=ui[l].cid;if(cl==0)continue;if(!AlignSet){a=eR[cl].flags&I;AlignSet=true}if((eR[cl].flags&I)!=a){d=false;break}}}else a=eR[t].flags&I;if(d){E.setSelected(a==0);R.setSelected(a==tc.CFLAG_VALIGN_CTR);L.setSelected(a==tc.CFLAG_VALIGN_BOT);C.setSelected(a==tc.CFLAG_VALIGN_BASE)}if(uA==tc.HILIGHT_OFF)_.setSelected(true);else o.setSelected(true);E.setFocus();function F(t,e,r){if(t=="Cancel"){c.hide();return}else if(t=="OK"){var i=false;if(E.isSelected()||R.isSelected()||L.isSelected()||C.isSelected())i=true;if(!i)return true;a=0;if(R.isSelected())a=tc.CFLAG_VALIGN_CTR;if(L.isSelected())a=tc.CFLAG_VALIGN_BOT;if(C.isSelected())a=tc.CFLAG_VALIGN_BASE;if(_.isSelected())f=tc.IDC_TABLE_ALL;else if(o.isSelected())f=tc.IDC_TABLE_SEL_CELLS;else if(u.isSelected())f=tc.IDC_TABLE_SEL_COLS;else f=tc.IDC_TABLE_SEL_ROWS;c.hide();return u8(f,a,n)}else return}};function u8(t,e,r){var i,f;var l;var a=false;var n=tc.CFLAG_VALIGN_CTR|tc.CFLAG_VALIGN_BOT|tc.CFLAG_VALIGN_BASE;if(uA==tc.HILIGHT_CHAR&&(ui[sA].cid>0||ui[_A].cid>0))a=true;if(a)f=ui[sA].cid;else f=ui[br].cid;if(t==0)return true;if(!B6(t))return false;V8(0,0,0,0,tc.UNDO_TABLE_ATTRIB);for(i=0;i<fR;i++){if(Dj(eR[i].InUse)||Dj(eR[i].flags&(tc.CFLAG_SEL1|tc.CFLAG_SEL2)))continue;eR[i].flags=cj(eR[i].flags,n);eR[i].flags|=e}bG(true);oi.modified++;if(e==tc.CFLAG_VALIGN_BASE){if(Fo>br)Fo=br;_z(false)}if(r)cG();return true}_i.TerCellRotateText=function(f,l,a){var t,e,r;var i=false;if(!lv||!QD())_i.TerCreateControl();if(f>0){angle=0;if(l==tc.TEXT_TOP_TO_BOT)angle=270;if(l==tc.TEXT_BOT_TO_TOP)angle=90;if(f==tc.SEL_CELLS)f=tc.IDC_TABLE_SEL_CELLS;else if(f==tc.SEL_COLS)f=tc.IDC_TABLE_SEL_COLS;else if(f==tc.SEL_ROWS)f=tc.IDC_TABLE_SEL_ROWS;else if(f==tc.SEL_ALL)f=tc.IDC_TABLE_ALL;else f=0;return T8(f,l,a)}if(uA==tc.HILIGHT_CHAR&&(ui[sA].cid>0||ui[_A].cid>0))i=true;if(i)r=ui[sA].cid;else r=ui[br].cid;var n=_i.DlgCompHeight;var c=_i.DlgFont;var s=new $t.DialogBox(te,"Cell Text Rotation",c,true,d,JV(2));var _=s.cvs;s.addGroupBox(0,0,6,1,"Range",c,0,JV(7),0,0);var o=new $t.RadioButton(_,0,0,JV(15),c,"All Cells",false,null,null);s.addComp(o,1,0,1,1,"left","middle",JV(15),0,JV(30));var u=new $t.RadioButton(_,1,0,JV(15),c,"Selected Cells",false,o,null);s.addComp(u,2,0,1,1,"left","middle",JV(15),0,JV(30));var T=new $t.RadioButton(_,2,0,JV(15),c,"Columns",false,u,null);s.addComp(T,3,0,1,1,"left","middle",JV(15),0,JV(30));var A=new $t.RadioButton(_,2,0,JV(15),c,"Rows",false,T,null);s.addComp(A,4,0,1,1,"left","middle",JV(15),0,JV(30));var E=new $t.Label(_,0,0,c,"     ");s.addComp(E,5,0,1,1,"left","middle",0,0,0,JV(-80));s.addGroupBox(0,1,6,1,"Text Rotation",c,0,JV(7),0,0);var R=new $t.RadioButton(_,0,0,JV(15),c,"Horizotal",false,null,null);s.addComp(R,1,1,1,1,"left","middle",JV(15),JV(10),JV(80));var L=new $t.RadioButton(_,1,0,JV(15),c,"Top to Bottom",false,R,null);s.addComp(L,2,1,1,1,"left","middle",JV(15),JV(10),JV(80));var C=new $t.RadioButton(_,2,0,JV(15),c,"Bottom to Top",false,L,null);s.addComp(C,3,1,1,1,"left","middle",JV(15),JV(10),JV(80));s.show();var I=true;if(false&&uA!=tc.HILIGHT_OFF){angle=0;VTextSet=false;if(AA==0)EndRow=_A-1;else EndRow=_A;for(t=sA;t<=EndRow;t++){if(!pm(t))continue;e=ui[t].cid;if(e==0)continue;if(!VTextSet){angle=eR[e].TextAngle;VTextSet=true}if(eR[e].TextAngle!=angle){I=false;break}}}else angle=eR[r].TextAngle;if(I){R.setSelected(angle==0);L.setSelected(angle==270);C.setSelected(angle==90)}u.setSelected(true);R.setFocus();function d(t,e,r){if(t=="Cancel"){s.hide();return}else if(t=="OK"){var i=false;if(R.isSelected()||L.isSelected()||C.isSelected())i=true;if(!i)return true;l=tc.TEXT_HORZ;if(L.isSelected())l=tc.TEXT_TOP_TO_BOT;if(C.isSelected())l=tc.TEXT_BOT_TO_TOP;if(o.isSelected())f=tc.IDC_TABLE_ALL;else if(u.isSelected())f=tc.IDC_TABLE_SEL_CELLS;else if(T.isSelected())f=tc.IDC_TABLE_SEL_COLS;else f=tc.IDC_TABLE_SEL_ROWS;s.hide();return T8(f,l,a)}else return}};function T8(t,e,r){var i,f,l;var a=false;l=0;if(e==tc.TEXT_TOP_TO_BOT)l=270;else if(e==tc.TEXT_BOT_TO_TOP)l=90;if(uA==tc.HILIGHT_CHAR&&(ui[sA].cid>0||ui[_A].cid>0))a=true;if(a)f=ui[sA].cid;else f=ui[br].cid;if(!oi.PrintView||f==0&&!a)return true;if(t==0)return true;if(!B6(t))return false;V8(0,0,0,0,tc.UNDO_TABLE_ATTRIB);for(i=0;i<fR;i++){if(Dj(eR[i].InUse)||Dj(eR[i].flags&(tc.CFLAG_SEL1|tc.CFLAG_SEL2)))continue;eR[i].TextAngle=l}bG(true);oi.modified++;if(Fo>br)Fo=br;_z(false);if(r)cG();return true}_i.TerSelectCol=function(t){if(!lv||!QD())_i.TerCreateControl();if(ui[br].cid==0)return false;g8(br,true,false);OA=false;pA=false;if(t)cG();return true};function A8(){if(Dj(oi.PageMode))return true;ER=!ER;bG(true);cG();return true}function E8(t){var e;if(t<0)t=eR[-t].row;e=$E[t].FirstCell;while(e>0){if(Nj(eR[e].flags&tc.CFLAG_ROW_SPANNED))return true;e=eR[e].NextCell}return false}function R8(t){var e;if(t<0)t=eR[-t].row;e=$E[t].FirstCell;while(e>0){if(Nj(eR[e].flags&tc.CFLAG_ROW_SPANNED)){var r=rR[e].SpanningCell;if(r>0){var i=eR[r].row;if(Nj($E[i].flags&tc.ROWFLAG_HDR))return true}}e=eR[e].NextCell}return false}function L8(t){var e;if(t<0)t=eR[-t].row;e=$E[t].FirstCell;while(e>0){if(eR[e].RowSpan>1)return true;e=eR[e].NextCell}return false}function C8(t){return Nj(eR[t].flags&tc.CFLAG_ROW_SPANNED)&&I8(t)<=1}function I8(t){var e,r,i,f;i=eR[t].row;r=rR[t].SpanningCell;e=eR[r].RowSpan;f=eR[r].row;while(f!=i&&f>0){e--;f=$E[f].NextRow}if(e<1)e=1;return e}function d8(t,e){var r,i,f=0,l=0,a=0,n=0,c;NC=c=0;r=eR[t].row;if(e>=0){a=R6(eR[t].level,po[e].FirstRow);n=R6(eR[t].level,po[e].LastRow)}if(Nj(eR[t].flags&tc.CFLAG_ROW_SPANNED)){if(e<0)return 0;if(r!=a)return 0;i=I8(t)}else i=eR[t].RowSpan;if(e<0||n!=r){r=$E[r].NextRow;while(r>0&&i>1){if(Nj($E[r].flags&tc.ROWFLAG_SPLIT)&&tR[r].FirstPage==e){f+=tR[r].BotRowHt;l+=yV(tR[r].BotRowHt)}else{var s=true;if(e>0&&rR[t].FirstPage<e){if(Dj(tR[r].flags&tc.TAUX_IN_HDR_FTR)&&tR[r].PageNo<e)s=false}if(Nj($E[r].flags&tc.ROWFLAG_HDR))s=true;if(s){f+=$E[r].height;l+=yV($E[r].height)}}if(e>=0&&n==r)break;r=$E[r].NextRow;i--}}c=NC=l;return f}function F8(t,e){var r,i,f,l=0,a,n=0,c;NC=c=0;if(Dj(eR[t].flags&tc.CFLAG_ROW_SPANNED))return 0;a=rR[t].SpanningCell;if(e>=0){var s=rR[a].FirstPage;var _=rR[a].LastPage;if(e==s)l=rR[a].FirstPageHt;else if(e==_)l=rR[a].LastPageHt;else if(s!=_)l=po[e].BodyHt;else l=rR[a].height}else l=rR[a].height;r=eR[t].row;i=eR[a].row;f=eR[a].RowSpan;if(e>=0)n=R6(eR[t].level,po[e].FirstRow);while(f>1){r=$E[r].PrevRow;if(r<=0)break;if(r==i&&rR[a].FirstPage!=rR[a].LastPage){if(e>=0&&e!=rR[a].FirstPage)break}l-=$E[r].height;f--;if(r==i||f==1)break;if(e>=0&&r==n&&r!=i)return 0}NC=c;if(l<0)l=0;return l}function g8(t,e,r){var i,f,l,a,n,c,s,_;var o,u,T;var A=20;var E=0;if(t<0||t>=Ri||ui[t].cid==0)return true;_=uA;u=sA;T=_A;c=TA;s=AA;i=ui[t].cid;var R=eR[i].level;a=n=eR[i].row;while(!s6(a))a=$E[a].PrevRow;l=G6(i,true);if(eR[i].row!=a)i=g6(a,l,true);while(!u6(n))n=$E[n].NextRow;f=g6(n,l,true);if(Math.abs(eR[f].x-eR[i].x)>A){var L=f;while((f=eR[f].PrevCell)>0){if(Math.abs(eR[f].x-eR[i].x)<A)break}if(f<=0)f=L}if(Math.abs(eR[f].x-eR[i].x)>A){while((n=$E[n].PrevRow)>0){f=g6(n,l,true);if(Math.abs(eR[f].x-eR[i].x)<A)break}if(n<=0){n=a;f=i}}if(eR[i].ColSpan>1){var C=eR[i].ColSpan;while(C>1&&eR[f].NextCell>0){C-=eR[f].ColSpan;if(C<=0)break;if(Math.abs(eR[i].x+eR[i].width-(eR[f].x+eR[f].width))<A){eR[i].ColSpan-=C;if(eR[i].ColSpan<1)eR[i].ColSpan=1;break}f=eR[f].NextCell}}if(uA!=tc.HILIGHT_CHAR||e){o=t;while(o>=0&&ui[o].cid!=i)o--;while(o>=0&&ui[o].cid==i)o--;sA=o+1;TA=0;uA=tc.HILIGHT_CHAR}o=t;while(o<Ri&&ui[o].cid>0&&ui[o].cid!=f){E=ui[o+1].cid;if(eR[E].level<R)break;o++}if(o<Ri)while(o<Ri&&ui[o].cid==f){E=ui[o+1].cid;if(eR[E].level<R)break;o++}o--;if(o>=Ri)o--;if(o<0)o=0;if(Nj(ui[o].tabw)&&Nj(ui[o].tabw.type&tc.INFO_ROW))o--;_A=o;AA=ui[o].len-1;if(sA==_A&&TA==AA)AA++;if(AA<0)AA=0;OA=true;pA=Bh;if(r&&(uA!=_||sA!=u||TA!=c||_A!=T||AA!=s))cG();return true}function P8(){var t,e,r,i;var f;if(br==0&&jt==0)return true;t=ui[sA].cid;e=ui[_A].cid;if(br!=_A){br=_A;jt=ui[br].len-1}yn=tc.WRAP_OFF;Br=tc.PAINT_MIN;DA=false;if(t==e){if(jt>0){jt--;cG();return true}if(br>0&&ui[br].cid==ui[br-1].cid){br--;jt=ui[br].len-1;if(jt<0)jt=0;cG();return true}}if(br>0){f=n6(t,e);if(f){if(eR[e].PrevCell>0){br--;while(br>0){if(Nj(ui[br].tabw)&&Nj(ui[br].tabw.type&tc.INFO_CELL))break;br--}}else{r=eR[e].row;r=$E[r].PrevRow;if(r>0)i=$E[r].FirstCell;else i=0;br--;while(br>0){if(ui[br].cid==0)break;if(ui[br].cid==i&&Nj(ui[br].tabw)&&Nj(ui[br].tabw.type&tc.INFO_CELL))break;br--}}}else{br--;while(br>0){if(ui[br].cid==0)break;if(Nj(ui[br].tabw)&&Nj(ui[br].tabw.type&tc.INFO_ROW)&&Nj(ui[br-1].tabw)&&Nj(ui[br-1].tabw.type&tc.INFO_CELL)){br--;break}br--}}}jt=ui[br].len-1;if(jt<0)jt=0;cG();return true}function S8(t){var e,r,i;var f,l;e=ui[sA].cid;r=ui[_A].cid;yn=tc.WRAP_OFF;Br=tc.PAINT_MIN;DA=false;if(e==r){if(jt+1<ui[br].len)jt++;else if(br+1<Ri){br++;jt=0}i=ui[br].cid;if(eR[i].row==eR[e].row){cG();return true}}br=_A;jt=ui[br].len-1;if(jt<0)jt=0;if(br+1<Ri){f=n6(e,r);if(f){if(eR[e].row==eR[r].row&&eR[r].NextCell>0){br++;while(br+1<Ri){if(Nj(ui[br].tabw)&&Nj(ui[br].tabw.type&tc.INFO_CELL))break;br++}}else{br++;if(Nj(ui[br].tabw)&&Nj(ui[br].tabw.type&tc.INFO_ROW))br++;l=Nj(ui[br-1].tabw)&&Nj(ui[br-1].tabw.type&tc.INFO_ROW);if(ui[br].cid==0){jt=0;cG();return true}else{while(br+1<Ri){if(Nj(ui[br].tabw)&&Nj(ui[br].tabw.type&tc.INFO_CELL)){if(!l)break;if(Nj(ui[br+1].tabw)&&Nj(ui[br+1].tabw.type&tc.INFO_ROW)){br++;break}}br++}}}}else{br++;if(Nj(ui[br].tabw)&&Nj(ui[br].tabw.type&tc.INFO_ROW))br++;if(ui[br].cid==0){jt=0;cG();return true}else{while(br+1<Ri){if(Nj(ui[br].tabw)&&Nj(ui[br].tabw.type&tc.INFO_CELL)&&Nj(ui[br+1].tabw)&&Nj(ui[br+1].tabw.type&tc.INFO_ROW))break;br++}br++}}}jt=ui[br].len-1;if(jt<0)jt=0;cG();return true}function h8(t){var e,r,i,f;var l,a;var n=pl[t].CellId;if(uA==tc.HILIGHT_OFF)return false;if(pl[t].empty||n==0)return false;e=pl[t].PageFirstLine;r=pl[t].PageLastLine;if(!pm(e)&&!pm(r))return false;if(_A>sA||_A==sA&&AA>=TA){i=sA;l=TA;f=_A;a=AA}else{i=_A;l=AA;f=sA;a=TA}if(ui[i].cid!=ui[f].cid){if(ui[i].cid==n)i=e;if(ui[f].cid==n)f=r;l=0;a=ui[f].len}if(e>i||e==i&&l==0){if(r<f||r==f&&a==ui[f].len)return true}return false}function O8(){var t,e;OC=t=vC=e=-1;for(cl=0;cl<fR;cl++){if(Dj(eR[cl].InUse)||Dj(eR[cl].flags&(tc.CFLAG_SEL1|tc.CFLAG_SEL2)))continue;if(t==-1)t=eR[cl].FirstLine;if(eR[cl].FirstLine<t)t=eR[cl].FirstLine;if(eR[cl].LastLine>e)e=eR[cl].LastLine}OC=t;vC=e;return true}_i.TerSetDefaultCellBorderWidth=function(t,e){if(!lv||!QD())_i.TerCreateControl();sR=t;_R=e;return true};_i.TerRecreateColSpan=function(t){if(!lv||!QD())_i.TerCreateControl();return v8(t)};function v8(t){var e,r;var i,f,l,a,n,c;var s=[tc.MAX_TBL_COLS+1];var _=[tc.MAX_TBL_COLS+1];var o=0,u=0;var T=tc.RULER_TOLERANCE;if(!lv||!QD())_i.TerCreateControl();if(t<=0)t=ui[br].cid;if(t==0)return false;for(e=eR[t].row;e>0;e=$E[e].PrevRow)if(s6(e))break;if(e<=0)return false;r=e;for(e=r;e>0;e=$E[e].NextRow){for(a=$E[e].FirstCell;a>0;a=eR[a].NextCell,o++){if(eR[a].width/2<T)T=eR[a].width/2}if($E[e].NextRow==e)$E[e].NextRow=-1;if(u6(e))break}for(e=r;e>0;e=$E[e].NextRow){if(e==r){s[0]=0;o=1;n=0;for(a=$E[e].FirstCell;a>0;a=eR[a].NextCell,o++){u=rR[a].XWidth;if(u==0)u=eR[a].width;else if(u<2*eR[a].margin+tc.RULER_TOLERANCE)u=2*eR[a].margin+tc.RULER_TOLERANCE;n+=u;s[o]=n}}else{n=0;for(a=$E[e].FirstCell;a>0;a=eR[a].NextCell){u=rR[a].XWidth;if(u==0)u=eR[a].width;else if(u<2*eR[a].margin+tc.RULER_TOLERANCE)u=2*eR[a].margin+tc.RULER_TOLERANCE;n+=u;for(i=0;i<o;i++){if(Math.abs(n-s[i])<=T)break;if(n>s[i]&&(i+1==o||n<s[i+1]-T)){for(f=o;f>i+1;f--)s[f]=s[f-1];o++;if(o+1>tc.MAX_TBL_COLS)return false;s[i+1]=n}}}}if($E[e].NextRow==e)$E[e].NextRow=-1;if(u6(e))break}o--;for(i=0;i<o;i++)_[i]=s[i+1]-s[i];for(e=r;e>0;e=$E[e].NextRow){n=0;for(a=$E[e].FirstCell;a>0;a=eR[a].NextCell){c=rR[a].XWidth;if(c==0)c=eR[a].width;else if(c<2*eR[a].margin+tc.RULER_TOLERANCE)c=2*eR[a].margin+tc.RULER_TOLERANCE;rR[a].XWidth=0;eR[a].ColSpan=1;for(i=0;i<o;i++)if(Math.abs(s[i]-n)<=T)break;if(i<o){l=0;for(f=i;f<o;f++){l+=_[f];if(Math.abs(l-c)<=T){eR[a].ColSpan=f-i+1;break}}if(f==o)eR[a].ColSpan=f-i;else if(eR[a].NextCell<=0){if(o-i>eR[a].ColSpan)eR[a].ColSpan=o-i}}n+=c}if(u6(e))break}return true}function p8(t,e,r,i,f){var l,a;if(f+1>=tc.MAX_TBL_COLS)return-1;for(l=f;l>t;l--){e[l]=e[l-1];r[l]=r[l-1]}a=r[t];r[t]=i-e[t];e[t+1]=i;r[t+1]=a-r[t];return f+1}_i.TerSetHtmlColSpan=function(t){var e,r,i;var f=[tc.MAX_TBL_COLS+1],l=[tc.MAX_TBL_COLS+1];var a,n,c,s,_=-1,o,u,T;var A;var E=tc.RULER_TOLERANCE/4;var R;var L;if(!lv||!QD())_i.TerCreateControl();DC=R=0;Zg=L=null;if(Nj(Qh&tc.TFLAG3_HTML_CONT_TABLE))return false;f[0]=0;c=1;i=t;for(r=t;r>0;r=$E[r].NextRow){if($E[r].CurIndent!=$E[r].CurIndent)break;if(r!=t&&Nj($E[r].flags&tc.ROWFLAG_NEW_TABLE))break;o=0;s=0;A=false;u=c;for(e=$E[r].FirstCell;e>0;e=eR[e].NextCell){if(e!=$E[r].FirstCell){if(!A)A=Nj(eR[e].flags&tc.CFLAG_ROW_SPANNED);for(a=0;a<c;a++)if(Math.abs(f[a]-s)<=E)break;if(a==c&&c+1<tc.MAX_TBL_COLS){f[c]=s;c++}}s+=eR[e].width}if(_<0)_=s;o=s;if(Math.abs(o-_)>E&&!A){c=u;break}i=r}r=$E[i].NextRow;if(r>0)$E[r].flags|=tc.ROWFLAG_NEW_TABLE;for(a=0;a<c;a++){for(n=a+1;n<c;n++){if(f[n]<f[a]){f[n]=WY(f[n],f[a]);f[a]=JC}}}f[c]=_;for(a=0;a<c;a++)l[a]=f[a+1]-f[a];for(r=t;r>0;r=$E[r].NextRow){if(r!=t&&Nj($E[r].flags&tc.ROWFLAG_NEW_TABLE))break;T=0;for(e=$E[r].FirstCell;e>0;e=eR[e].NextCell,T++){if(Math.abs(l[T]-eR[e].width)<=E)eR[e].ColSpan=1;else{var C=0;eR[e].ColSpan=0;for(;T<c;T++){C+=l[T];eR[e].ColSpan++;if(Math.abs(C-eR[e].width)<=E)break}}}}R=c;L=[tc.MAX_TBL_COLS];for(a=0;a<c;a++)L[a]=l[a];DC=R;Zg=L;return true};_i.TerDifTableRows=function(t,e){var r,i,f,l,a,n,c;var s=false;if(!lv||!QD())_i.TerCreateControl();if(Nj(Qh&tc.TFLAG3_HTML_CONT_TABLE))return false;if(t<0){t=$E[e].NextRow;if(t<=0)return false;if(Nj($E[t].flags&tc.ROWFLAG_NEW_TABLE))return true}if($E[t].PrevRow<=0)return true;for(r=$E[e].FirstCell;r>0;r=eR[r].NextCell){if(eR[r].RowSpan>1){s=true;break}}i=$E[t].FirstCell;f=$E[e].FirstCell;l=eR[i].ColSpan;a=eR[f].ColSpan;n=eR[i].width;c=eR[f].width;while(true){if(i<=0&&f<=0)break;if(i<=0&&f>0)return true;if(f<=0&&i>0)return true;if(l<=0){l=eR[i].ColSpan;n+=eR[i].width}if(a<=0){a=eR[f].ColSpan;c+=eR[f].width}if(l==a&&Math.abs(n-c)>tc.RULER_TOLERANCE){if(s){if(N8(t,e))return false}return true}l--;a--;if(l==0&&a==0)n=c=0;if(l<=0)i=eR[i].NextCell;if(a<=0)f=eR[f].NextCell}return false};function N8(t,e){var r,i,f,l;r=$E[t].FirstCell;i=$E[e].FirstCell;f=eR[r].width;l=eR[i].width;if(eR[r].ColSpan!=eR[i].ColSpan)eR[r].ColSpan=eR[i].ColSpan=1;while(true){if(Math.abs(f-l)<=tc.RULER_TOLERANCE){r=eR[r].NextCell;i=eR[i].NextCell;if(r<=0||i<=0)return true;f=eR[r].width;l=eR[i].width;if(eR[r].ColSpan!=eR[i].ColSpan)eR[r].ColSpan=eR[i].ColSpan=1;continue}if(f<l){eR[i].ColSpan++;r=eR[r].NextCell;if(r<=0)return false;f+=eR[r].width;eR[r].ColSpan=1}else{eR[r].ColSpan++;i=eR[i].NextCell;if(i<=0)return false;l+=eR[i].width;eR[i].ColSpan=1}}}_i.TerSetCellBorderColor=function(t,e,r,i,f){if(!lv||!QD())_i.TerCreateControl();if(!oi.PageMode)return false;if(t<=0||t>=fR||!eR[t].InUse)return false;eR[t].BorderColor[tc.BORDER_INDEX_TOP]=e;eR[t].BorderColor[tc.BORDER_INDEX_BOT]=r;eR[t].BorderColor[tc.BORDER_INDEX_LEFT]=i;eR[t].BorderColor[tc.BORDER_INDEX_RIGHT]=f;return true};_i.TerSetHtmlCellHeight=function(t,e){if(!lv||!QD())_i.TerCreateControl();if(!oi.PageMode)return false;if(t<=0||t>=fR||!eR[t].InUse)return false;rR[t].HtmlHeight=e;return true};_i.TerSetSpannedCellProp=function(t,e){var r,i,f,l,a=0,n,c,s,_=0;if(!lv||!QD())_i.TerCreateControl();if(!oi.PageMode)return false;if(t<=0||t>=fR||!eR[t].InUse)return false;l=G6(t,true);f=c=eR[t].row;s=$E[f].PrevRow;i=g6(s,l,true);eR[t].border=eR[i].border;for(r=0;r<4;r++){eR[t].BorderWidth[r]=eR[i].BorderWidth[r];eR[t].BorderColor[r]=eR[i].BorderColor[r]}if(e){if($E[f].MinHeight==0)_=f;for(f=s;f>0;f=$E[f].PrevRow){n=$E[f].MinHeight;if(_==0&&n==0)_=f;a+=Math.abs(n);i=g6(f,l,true);if(i>0&&eR[i].RowSpan>1){a=rR[i].HtmlHeight-a;if(_==0||_==c){if(a>$E[c].MinHeight)$E[c].MinHeight=a}else{a+=Math.abs($E[c].MinHeight);if(a>$E[_].MinHeight)$E[_].MinHeight=a}return true}}}return true};_i.TerSetHtmlTblWidth=function(t,e){var r;var i=false;if(!lv||!QD())_i.TerCreateControl();if(t<=0){t=ui[br].cid;i=true}if(t<=0||t>=fR||!eR[t].InUse)return false;r=eR[t].row;if(i){while(!s6(r))r=$E[r].PrevRow;while(r>0){$E[r].FixWidth=e;r=$E[r].NextRow}}else $E[r].FixWidth=e;return true};_i.TerSetHtmlTblCellSpacing=function(t,e){var r;var i=false;if(!lv||!QD())_i.TerCreateControl();if(t<=0){t=ui[br].cid;i=true}if(t<=0||t>=fR||!eR[t].InUse)return false;r=eR[t].row;if(i){while(!s6(r))r=$E[r].PrevRow;while(r>0){$E[r].CellSpacing=e;r=$E[r].NextRow}}else $E[r].CellSpacing=e;return true};_i.TerSetHtmlCellPadding=function(t,e,r){if(!lv||!QD())_i.TerCreateControl();if(e>=0)eR[t].TopPad=e;if(r>=0)eR[t].BotPad=r;return true};_i.TerSetHtmlCellPaddingH=function(t,e,r){if(!lv||!QD())_i.TerCreateControl();if(e>=0)eR[t].LeftPad=e;if(r>=0)eR[t].RightPad=r;return true};_i.TerEquateHtmlTable=function(t,e){var r,i,f,l,a,n,c;var s=0,_=0;var o;if(!lv||!QD())_i.TerCreateControl();if(t<0||t>=fR||!eR[t].InUse)return false;o=[e+1];for(r=0;r<e+1;r++)o[r]=0;i=eR[t].row;while($E[i].PrevRow>0)i=$E[i].PrevRow;if(i>0)_=$E[i].FirstCell;c=_i.TerCreateParaId(-1,true,0,0,0,0,0,0,0,0,0,0,-20,0);while(i>0){a=0;f=$E[i].FirstCell;while(true){n=eR[f].ColSpan;for(r=a;r<a+n;r++){if(Nj(eR[f].flags&tc.CFLAG_ROW_SPANNED))o[r]--;else o[r]=eR[f].RowSpan-1}a+=n;if(eR[f].NextCell<=0)break;f=eR[f].NextCell}if(a<e){while(a<e){w6(_);if((l=x8(false))==-1)return false;Q6(f,l);eR[l].RowSpan=1;eR[l].ColSpan=1;eR[l].FixWidth=0;if(o[a]>0){eR[l].flags=tc.CFLAG_ROW_SPANNED;o[a]--}else eR[l].flags=cj(eR[l].flags,tc.CFLAG_ROW_SPANNED);eR[l].flags|=tc.CFLAG_ADDED_CELL;eR[l].width=eR[f].width/eR[f].ColSpan;eR[f].NextCell=l;eR[l].PrevCell=f;$E[i].LastCell=l;s=eR[f].LastLine;ew(s+1,TR,0,c,tc.INFO_CELL,l);f=l;a++}if(s+2<Ri)ui[s+2].cid=ui[s+1].cid}i=$E[i].NextRow}return true};_i.TerShrinkTableToPageWidth=function(t,e){return TerShrinkTableToPageWidth2(t,true,e)};_i.TerShrinkTableToPageWidth2=function(t,e,r){var i,f,l;var a=false;if(!lv||!QD())_i.TerCreateControl();for(l=e?0:1;l<2;l++){a=false;if(!t){i=ui[br].cid;if(i==0)return false;for(f=eR[i].row;f>1;f=$E[f].PrevRow)if(s6(f))break;for(;f>1;f=$E[f].NextRow){if(D8(f)){M8(f,l>0);a=true}if(u6(f))break}}else{for(f=1;f<iR;f++){if($E[f].InUse&&D8(f)){M8(f,l>0);a=true}}}if(a){if(l==0)_i.TerAdjustHtmlTable();_i.TerRepaginate(r)}}return true};function D8(t){var e=$E[t].PageNo;var r=po[e].TopSect;var i,f;var l=(eo[r].PgWidth-to[r].LeftMargin-to[r].RightMargin)*1440;if($E[t].indent<0)l-=2*$E[t].indent;i=0;for(f=$E[t].FirstCell;f>0;f=eR[f].NextCell)i+=eR[f].width;return i>=l+tc.RULER_TOLERANCE/2}function M8(t,e){var r=$E[t].PageNo;var i=po[r].TopSect;var f;var l=(eo[i].PgWidth-to[i].LeftMargin-to[i].RightMargin)*1440;if($E[t].indent<0)l-=2*$E[t].indent;if(e){var a=0;for(f=$E[t].FirstCell;f>0;f=eR[f].NextCell)a+=eR[f].width;if(a>=l+tc.RULER_TOLERANCE/2){for(f=$E[t].FirstCell;f>0;f=eR[f].NextCell){eR[f].width=Mj(eR[f].width,l,a);eR[f].flags=_j(eR[f].flags,tc.CFLAG_AUTO_WIDTH);eR[f].FixWidth=0}}a=0;for(f=$E[t].FirstCell;f>0;f=eR[f].NextCell)a+=eR[f].width;$E[t].flags=_j($E[t].flags,tc.ROWFLAG_AUTO_FIT);$E[t].FixWidth=0}else{for(f=$E[t].FirstCell;f>0;f=eR[f].NextCell){eR[f].flags|=tc.CFLAG_AUTO_WIDTH;eR[f].FixWidth=0}$E[t].flags|=tc.ROWFLAG_AUTO_FIT;$E[t].FixWidth=l}return true}_i.TerReformatTable=function(t){if(!lv||!QD())_i.TerCreateControl();FR=true;_i.TerRepaginate(t);return true};_i.TerAdjustHtmlTable=function(){var t,e,r,i;var f,l,a,n,c,s,_,o=0;var u,T,A,E,R;var L,C=false;var I=[tc.MAX_TBL_LEVELS+1];var d=0;if(!lv||!QD())_i.TerCreateControl();if(TE){FR=false;return true}if(Nj(eO&tc.TFLAG7_NO_TABLE_AUTO_WIDTH)){FR=false;return true}for(f=0;f<tc.MAX_TBL_LEVELS;f++)I[f]=false;RR=false;I[0]=true;for(f=0;f<fR;f++)eR[f].flags=cj(eR[f].flags,tc.CFLAG_HAS_NESTED_TABLES);for(f=0;f<fR;f++){if(eR[f].InUse&&eR[f].ParentCell!=0){RR=true;c=eR[f].row;s=eR[f].level;I[s]=true;_=eR[f].ParentCell;if(_>0&&_<fR)eR[_].flags|=tc.CFLAG_HAS_NESTED_TABLES}}if(!GR&&FR&&ui[br].cid==0){FR=false;return true}if(dR>0){FR=false;dR=0}if(!GR&&FR){n=ui[br].cid;c=eR[n].row;if(Dj($E[c].flags&tc.ROWFLAG_AUTO_WIDTH_RTF))return true;s=eR[n].level;if(s>0){for(s--;s>=0;s--){var F=E6(s,-n);var g=eR[F].row;if(Dj($E[g].flags&tc.ROWFLAG_AUTO_WIDTH_RTF))break;n=F}}c=eR[n].row;while(!s6(c))c=$E[c].PrevRow;l=c;C=true}else l=1;m6();a=l;for(s=0;s<tc.MAX_TBL_LEVELS;s++){if(Dj(I[s]))continue;for(l=a;l<iR;l++){var P=true;if(Dj($E[l].flags&(tc.ROWFLAG_AUTO_FIT|tc.ROWFLAG_AUTO_WIDTH_RTF|tc.ROWFLAG_HTML_TABLE)))P=false;if(!P&&s>0){n=$E[l].FirstCell;while(n>0&&eR[n].level>=0&&eR[n].ParentCell>0){d=eR[n].ParentCell;var S=eR[d].row;if(Nj($E[S].flags&(tc.ROWFLAG_AUTO_FIT|tc.ROWFLAG_AUTO_WIDTH_RTF|tc.ROWFLAG_HTML_TABLE))){P=true;break}n=d}}if(P&&$E[l].InUse&&($E[l].PrevRow<=0||s6(l))){n=$E[l].FirstCell;if(eR[n].level!=s)continue;E=0;if(s>0){d=eR[n].ParentCell;E=-(eR[d].width-x6(d)-y6(d))}if(!H8(l,E))continue;u=tP;T=eP;A=rP;R=iP;o=fP;L=Yg;t=Vg;e=jg;r=Jg;i=zg;G8(l,u,T,A,R,L,t,e,r,i,o)}if(C)break}if(C)break}Fo=0;return true};function G8(t,e,r,i,f,l,a,n,c,s,_){var o,u,T,A,E,R,L,C,I,d;var F=0,g,P,S=0,h;var O=null,v=null;var p=null,N=null;var D;var M,G,B,H;var m=0,w=0;var b;var x,y;O=[tc.MAX_TBL_COLS];v=[tc.MAX_TBL_COLS];p=[tc.MAX_TBL_COLS];N=[tc.MAX_TBL_COLS];for(o=0;o<tc.MAX_TBL_COLS;o++)N[o]=true;T=$E[t].FirstCell;C=eR[T].level;I=0;t:while(true){D=false;E=0;u=t;while(u>0){var W=true;L=0;A=0;for(T=$E[u].FirstCell;T>0;T=eR[T].NextCell){var U=a[A]*eR[T].ColSpan;if(eR[T].FixWidth>0&&eR[T].FixWidth>U)L+=eR[T].FixWidth;if(eR[T].FixWidth<=0)W=false;A+=eR[T].ColSpan}if(C==0&&u==t){var k=0;for(o=0;o<A;o++)k+=a[o];if(!W&&k>_)k=_;if(k>i)i=k;if($E[u].FixWidth>0)f=$E[u].FixWidth}F=i-L;S=r-L;h=e-L;if(F<h&&$E[t].FixWidth<0)F=h;if(S==0)S=1;A=0;T=$E[u].FirstCell;R=0;while(T>0){m=0;var X=0;d=A;eR[T].x=R;eR[T].width=0;m=0;for(o=0;o<eR[T].ColSpan;o++){if(false&&eR[T].FixWidth>0){m=eR[T].FixWidth;A++;continue}if(I==1)m+=O[A];else if(h>=F)m+=a[A];else if(S<=F){m+=n[A];D=true}else{w=F-h;var K=S-h;var Y=n[A]-a[A];if(K==0)K=1;if(!l)w=w*9/10;if(w<0)w=0;m+=a[A]+Y*w/K}X+=c[A];A++}if(A>E)E=A;if(X<rR[T].MinTextWidth&&I==0)X=rR[T].MinTextWidth;if(m<X&&I==0)m=X;eR[T].width=Mj(m*10,1,10);if(eR[T].FixWidth>eR[T].width&&I==0)eR[T].width=eR[T].FixWidth;if(I==0){var V=0,j=0,J,z=0,Z,Q,q,$;b=eR[T].ColSpan;var tt,et;$=0;for(o=0;o<b;o++)$+=n[d+o];for(o=0;o<b;o++){if(u==t){if(b==1){p[d+o]=eR[T].FixWidth>0;O[d+o]=eR[T].width}else O[d+o]=Mj(eR[T].width,n[d+o],$)}V+=O[d+o];if(p[d+o]){j=O[d+o];z++}}if(u!=t){if(b==1){if(p[d]){if(eR[T].FixWidth>0&&eR[T].width>O[d]){O[d]=eR[T].width;D=true}else if(eR[T].width<O[d])D=true}else{if(eR[T].FixWidth>0){p[d]=true;if(eR[T].width>c[d]&&N[d])O[d]=eR[T].width;if(eR[T].width<O[d]&&N[d])O[d]=eR[T].width}else if(eR[T].width>O[d])O[d]=eR[T].width;D=true}}else if(eR[T].width>V){Z=b-z;if(Z>0){J=V-j;tt=eR[T].width-V;et=tt;Q=Z;for(o=0;o<b;o++){if(p[d+o])continue;if(Q<=1)q=et;else q=Mj(tt,n[d+o],$);O[d+o]+=q;if(rR[T].MinTextWidth>V)N[d+o]=false;et-=q;Q--}}else{tt=0;if(X>V)tt=X-V;if(eR[T].FixWidth-V>tt)tt=eR[T].FixWidth-V;if(tt>0){et=tt;for(o=0;o<b;o++){if(o+1==b)q=et;else q=Mj(tt,n[d+o],$);O[d+o]+=q;et-=q;if(rR[T].MinTextWidth>V)N[d+o]=false}}}D=true}else if(eR[T].width<V)D=true}}R=eR[T].x+eR[T].width;T=eR[T].NextCell}u=$E[u].NextRow;if(u>0&&s6(u))u=0}I++;if(D){if(l&&S<F){m=0;var rt=0;var it=false;for(o=0;o<E;o++){m+=O[o];if(!p[o]){rt+=O[o];it=true}}if(m<F){x=F-m;var ft=0,lt=0;for(o=0;o<E;o++){if(it){if(!p[o])O[o]+=Mj(x,O[o],rt)}else{O[o]+=Mj(x,O[o],m);if(O[o]>=s[o]&&O[o]>a[o]){var at=s[o];if(a[o]>at)at=a[o];lt+=O[o]-at;O[o]=at;ft++}}}if(!it&&lt>0){if(ft<E){var nt=0;for(o=0;o<E;o++){if(O[o]<s[o])nt+=s[o]-O[o]}x=lt;lt=0;for(o=0;o<E;o++){if(O[o]>=s[o])continue;O[o]+=Mj(x,s[o]-O[o],nt);if(O[o]>=s[o]){lt+=O[o]-s[o];O[o]=s[o]}}}if(lt>0){var ct=0;for(o=0;o<E;o++)ct+=O[o];for(o=0;o<E;o++)O[o]+=Mj(lt,O[o],ct)}}}}continue t}break}I=0;H=f;t:while(true){for(o=0;o<tc.MAX_TBL_COLS;o++)v[o]=0;G=0;for(u=t;u>0;u=$E[u].NextRow){A=0;for(T=$E[u].FirstCell;T>0;T=eR[T].NextCell){b=eR[T].ColSpan;M=rR[T].MinTextWidth;if(b==1){if(v[A]<M)v[A]=M}else{g=0;for(o=0;o<b;o++)g+=v[A+o];if(g<M){x=M-g;for(o=0;o<b;o++)v[A+o]+=x/b}}A+=b}if(A>G)G=A}F=0;P=0;for(o=0;o<G;o++){F+=O[o];if(O[o]>v[o])P+=O[o]-v[o]}if(F>H&&H>0&&P>0){var st;A=0;st=x=F-H;if(x>P)st=x=P;for(o=0;o<G;o++){B=O[o]-v[o];if(B>0){y=Mj(st,B,P);if(x<y)y=x;O[o]-=y;x-=y}}for(u=t;u>0;u=$E[u].NextRow){A=0;for(T=$E[u].FirstCell;T>0;T=eR[T].NextCell){b=eR[T].ColSpan;if(b==1)eR[T].width=O[A];else{eR[T].width=0;for(o=0;o<b;o++)eR[T].width+=O[A+o]}A+=b}}}F=0;for(o=0;o<G;o++)F+=O[o];if(F>H&&H>0){var _t;T=$E[t].FirstCell;if(vr&&I==0&&eR[T].level==0&&!oi.FittedView){H+=to[0].RightMargin*1440/2;I++;continue t}x=F-H;_t=0;for(o=0;o<G;o++){y=Mj(x,O[o],F);if(o+1<G)O[o]-=y;else O[o]=H-_t;_t+=O[o]}for(u=t;u>0;u=$E[u].NextRow){A=0;for(T=$E[u].FirstCell;T>0;T=eR[T].NextCell){b=eR[T].ColSpan;if(b==1)eR[T].width=O[A];else{eR[T].width=0;for(o=0;o<b;o++)eR[T].width+=O[A+o]}A+=b}}}break}if(C>0&&$E[t].FixWidth>0){var ot,ut=f*9/10;T=$E[t].FirstCell;ot=eR[T].ParentCell;_=eR[ot].width-x6(ot)-y6(ot);if(ut>_)ut=_;F=0;for(T=$E[t].FirstCell;T>0;T=eR[T].NextCell)F+=eR[T].width;if(F>0&&F<ut){var Tt=0;w=ut-F;A=0;for(T=$E[t].FirstCell;T>0;T=eR[T].NextCell,A++){if(Nj(eR[T].flags&tc.CFLAG_AUTO_WIDTH)||eR[T].FixWidth==0){if(eR[T].width<s[A])Tt+=s[A]-eR[T].width}}for(u=t;u>0;u=$E[u].NextRow){A=0;for(T=$E[u].FirstCell;T>0;T=eR[T].NextCell,A++){if(Nj(eR[T].flags&tc.CFLAG_AUTO_WIDTH)||eR[T].FixWidth==0){if(eR[T].width<s[A]){var At=s[A]-eR[T].width;eR[T].width+=Mj(w,At,Tt)}}}}}F=0;for(T=$E[t].FirstCell;T>0;T=eR[T].NextCell)F+=eR[T].width;if(F>0&&F<ut){for(u=t;u>0;u=$E[u].NextRow){for(T=$E[u].FirstCell;T>0;T=eR[T].NextCell){eR[T].width=Mj(eR[T].width,ut,F)}}}}return true}function B8(t,e){var r;var i,f,l;var a,n,c=0;var s,_,o,u;var T,A;var E;f=eR[t].level;for(r=eR[t].FirstLine;r<=eR[t].LastLine;r++){i=ui[r].cid;if(eR[i].level>f){l=0;for(;r<eR[t].LastLine;r++){i=ui[r].cid;if(i==t)break;if(Nj(l)&&eR[i].level==f+1&&l!=eR[i].row){var R=eR[i].row;if(R==0||s6(R))break}if(l==0&&eR[i].level==f+1)l=eR[i].row}if(l>0){if(H8(l,e)){a=tP;n=eP;T=rP;A=iP;c=fP;E=Yg;s=Vg;_=jg;o=Jg;u=zg;G8(l,a,n,e,A,E,s,_,o,u,c)}r--;continue}}}return true}function H8(t,e){var r,i,f,l;var a,n;var c,s,_,o,u,T=0;var A,E,R,L,C;var I,d,F;var g,P,S,h=0,O,v,p,N=0;var D,M=false,G=false;var B,H=false,m;var w,b,x,y,W;var U;var k,X,K,Y;var V;w=b=0;tP=eP=0;x=y=0;rP=iP=0;U=false;Yg=false;k=X=K=Y=null;Vg=jg=Jg=zg=null;W=0;fP=0;_=$E[t].FirstCell;if(Dj(eR[_].InUse))return false;r=[];i=[];f=[];l=[];a=[];n=[];u=eR[_].level;if(Eu||!oi.FittedView){var j=0;g=eR[_].FirstLine;if(g>=0&&g<Ri&&ui[g].fid>0){var J=ui[g].fid;x=kl[J].width-kl[J].margin;x-=$E[t].indent}else{if(ro>0&&g>=0&&g<Ri)j=G5(g);x=(eo[j].PgWidth-to[j].LeftMargin-to[j].RightMargin)*1440;if(to[j].columns>1){var z=to[j].columns;var Z=to[j].ColumnSpace*1440;x=(x-(z-1)*Z)/z}if(u==0)x-=$E[t].indent}}else x=gV(je);if(x<0)x=7*1440;if(e>0&&x>e)x=e;W=x;if(e<0)e=x=-e;y=x;U=false;if(Nj($E[t].FixWidth)){if($E[t].FixWidth<0){x=Mj(x,-$E[t].FixWidth,100);M=$E[t].FixWidth==-100;G=true}else{x=$E[t].FixWidth;y=x}U=true}F=x;for(o=0;o<tc.MAX_TBL_COLS;o++){r[o]=i[o]=f[o]=l[o]=0;a[o]=false;n[o]=false}C=0;H=false;t:while(true){h++;s=t;while(s>0){e:{var Q=false;for(_=$E[s].FirstCell;_>0;_=eR[_].NextCell)if(eR[_].ColSpan>1)break;if(_>0)Q=H=true;if(h==1&&Q)break e;if(h==2&&!Q)break e;O=0;v=0;N=0;B=true;p=0;m=true;if(U){B=false;for(_=$E[s].FirstCell;_>0;_=eR[_].NextCell){if(eR[_].FixWidth<0)O+=-eR[_].FixWidth;else v+=eR[_].FixWidth;if(eR[_].FixWidth==0){N+=eR[_].ColSpan;B=true;if(Dj(eR[_].flags&tc.CFLAG_HAS_NESTED_TABLES)){w8(_,y);A=Ug;E=kg;R=Xg;L=Kg;p+=A}}else m=false}}if(p>y)p=y;o=0;_=$E[s].FirstCell;while(_>0){if(eR[_].FirstLine<0){_=eR[_].NextCell;continue}if(eR[_].row!=s)break;D=false;if(eR[_].FixWidth==0)eR[_].flags|=tc.CFLAG_AUTO_WIDTH;if(Nj(eR[_].flags&tc.CFLAG_AUTO_WIDTH)||!U&&eR[_].FixWidth<0){w8(_,y-p);A=Ug;E=kg;R=Xg;L=Kg;A+=x6(_)+y6(_);E+=x6(_)+y6(_);L+=x6(_)+y6(_);rR[_].MinTextWidth=R;if(U&&!m&&x-v>E)E=x-v;if(Nj($E[s].flags&tc.ROWFLAG_LAYOUT_FIXED)&&Nj(eR[_].flags&tc.CFLAG_AUTO_WIDTH)&&U){var q=y-v;q-=y*O/100;if(q>0&&N>0)A=E=Mj(q,eR[_].ColSpan,N)}D=false}else{var $,tt,et;et=x6(_)+y6(_);if(eR[_].FixWidth<0){if(U&&O>0&&Dj($E[s].flags&tc.ROWFLAG_LAYOUT_FIXED)){if(B)A=Mj(F-p,-eR[_].FixWidth,100);else A=Mj(F-v-p,-eR[_].FixWidth,O);if(A<et)A=et}else A=Mj(x,-eR[_].FixWidth,100);if(eR[_].level>0&&e==0)A=2*eR[_].margin}else{A=eR[_].FixWidth;if(A<et)A=et}E=A;D=true;w8(_,y-p);$=Ug;tt=kg;R=Xg;L=Kg;if(Nj($E[s].flags&tc.ROWFLAG_LAYOUT_FIXED)&&eR[_].FixWidth<0){var rt=Mj(x,-eR[_].FixWidth,100);if(R+et>rt||$>rt){R=rt-et;$=tt=R}}rR[_].MinTextWidth=R;if(eR[_].FixWidth<0&&$+et>A)A=E=$+et+tc.RULER_TOLERANCE/2;if(eR[_].FixWidth>0&&eR[_].FixWidth>$)$=tt=A;else if($>A&&Dj(Qh&tc.TFLAG3_EXACT_CELL_WIDTH)){if(U){if(M||!G)$=A;else x+=$-A}A=E=$}else D=true}if(eR[_].FirstLine!=eR[_].LastLine||ui[eR[_].FirstLine].len>1)n[o]=true;if(eR[_].ColSpan<1)eR[_].ColSpan=1;R+=x6(_)+y6(_);if(eR[_].ColSpan==1){if(!a[o]||D){if(A>r[o]||D&&eR[_].FixWidth>0)r[o]=A;if(E>i[o]||D&&eR[_].FixWidth>0)i[o]=E}if(R>f[o])f[o]=R;if(L>l[o])l[o]=L;if(D)a[o]=true;o++}else{I=d=0;S=eR[_].ColSpan;for(P=0;P<S;P++){I+=r[o+P];d+=i[o+P];if(L/S>l[o+P])l[o+P]=L/S}if(!a[o]||D){if(A>I){V=(A-I)/S;for(P=0;P<S;P++)r[o+P]+=V}if(E>I){V=(E-I)/S;for(P=0;P<S;P++)i[o+P]+=V}}if(D)a[o]=true;if(n[o])for(P=1;P<S;P++)n[o+P]=true;o+=S}rR[_].MinTextWidth=R;_=eR[_].NextCell}if(o>C)C=o}c=s;s=$E[s].NextRow;if(s>0&&tR[c].ParaFID!=tR[s].ParaFID){$E[c].NextRow=-1;$E[s].PrevRow=-1;s=-1}if(s>0&&!$E[s].InUse){$E[c].NextRow=-1;s=-1}if(s>0&&s6(s))s=0}if(h==1&&H)continue t;break}w=0;b=0;T=0;for(o=0;o<C;o++){if(r[o]>i[o])i[o]=r[o];if(!n[o]&&!FR&&!a[o])r[o]=i[o]=100;w+=r[o];b+=i[o];T+=f[o]}if(u>0&&U&&!G&&b<x)w=b=T=x;if(y<T)y=T;Vg=r;jg=i;Jg=f;zg=l;rP=x;tP=w;eP=b;iP=y;Yg=U;fP=W;return true}function m8(t){var e;for(e=1;e<fR;e++)if(eR[e].ParentCell==t)return true;return false}function w8(t,e){var r,i,f;var l,a,n,c,s,_,o=0,u=0,T=0,A,E=0;var R=0,L,C,I,d,F,g,P;var S,h=0;var O;var v;var p=false,N,D,M,G;var B=0;var H;var m;var w,b,x,y;n=c=s=_=0;d=eR[t].level;for(S=eR[t].FirstLine;S<=eR[t].LastLine;S++){if(S<0||S>=Ri)break;f=ui[S].pfmt;P=Nc[f].RightIndentTwips>=0?Nc[f].RightIndentTwips:0;g=Nc[f].LeftIndentTwips>=0?Nc[f].LeftIndentTwips:0;i=g+P;if(p9(S))i+=Nc[f].FirstIndentTwips;else i=0;i=DV(i);I=ui[S].cid;if(eR[I].level>d){F=0;for(;S<eR[t].LastLine;S++){I=ui[S].cid;if(I==t)break;if(Nj(F)&&eR[I].level==d+1&&F!=eR[I].row){l=eR[I].row;if(l==0||s6(l))break}if(F==0&&eR[I].level==d+1)F=eR[I].row}if(F>0){var W,U;var k,X=eR[t].FixWidth>0?eR[t].FixWidth:0;var K=null;var Y=0;if(H8(F,X)){W=DV(tP);U=DV(eP);K=Jg;if(W>n)n=W;if(U>c)c=U;if(K!=null){Y=0;k=0;for(I=$E[F].FirstCell;I>0;I=eR[I].NextCell){for(r=0;r<eR[I].ColSpan;r++,k++)Y+=K[k]}Y=DV(Y);if(Y>s)s=Y}}S--;continue}}L=ui[S].len;h+=L;O=ui[S].txt;if(L>0&&O[L-1]==tc.LINE_CHAR)ui[S].flags|=tc.LFLAG_LINE;v=nb(S);N=Nj(Nc[ui[S].pfmt].pflags&tc.PFLAG_NO_WRAP);if(!N)N=Nj(eR[t].flags&tc.CFLAG_NO_WRAP);M=G=false;for(r=0;r<=L;r++){M=G;G=false;if(r<L&&O[r]>=128)G=h9(O[r],v[r]);if(!N&&r<L&&(" =+?=/*".indexOf(String.fromCharCode(B))>=0&&O[r]!=tc.SPACE||Nj(xs[R].style&tc.PICT)||M)||Nj(eR[t].flags&tc.CFLAG_WRAP_ON_CHAR)){if(o-u>n)n=o-u;if(o-u>s)s=o-u;o=u=0}if(r==L&&M){if(o-u>n)n=o-u;if(o-u>s)s=o-u;o=u=0}if(r==L&&Nj(ui[S].flags&(tc.LFLAG_PARA|tc.LFLAG_LINE))){if(T>c)c=T;if(o-u>n)n=o-u;if(o-u>s)s=o-u;T=o=u=0}if(r==L)break;C=v[r];if(Nj(xs[C].style&tc.PICT))p=true;E=0;if(p){var V=xs[C].ParaFID;if(V>0)E=kl[V].PctWidth;else E=xs[C].PctWidth}if(p&&E>0)A=DV(tc.RULER_TOLERANCE);else{if(p&&(xs[C].FrameType==tc.PFRAME_LEFT||xs[C].FrameType==tc.PFRAME_RIGHT)){A=xs[C].PictWidth+720}else{if(O[r]==TR)A=0;else A=Gx(C,false,O[r])}}if(O[r]!=Bn&&O[r]!=tc.LINE_CHAR&&O[r]!=TR){A+=i;o+=A;T+=A}if(O[r]==tc.SPACE&&Dj(xs[v[r]].style&(tc.ULINE|tc.ULINED)))u+=A;i=0;B=O[r];R=v[r]}sb(S)}a=DV(tc.RULER_TOLERANCE);a=a/2;S=eR[t].FirstLine;if(S>=0&&S<Ri&&ui[S].len>0){v=nb(S);if(v!=null&&Dj(xs[v[0]].style&tc.PICT))a=Xs[v[0]].CharWidth[tc.CHAR_a];sb(S)}if(eR[t].FirstLine==eR[t].LastLine){S=eR[t].FirstLine;if(S>=0&&S<Ri&&ui[S].len<=2)a=0}_=c;c+=2*a;n+=a;s+=a;if(!oi.FittedView){var j=eR[t].FirstLine;var J=ui[j].pfmt;if(Dj(Nc[J].pflags&tc.PFLAG_NO_WRAP)){var z=G5(j);var Z=(eo[z].PgWidth-to[z].LeftMargin-to[z].RightMargin)*Ai;if(n>Z)n=Z;if(c>Z)c=Z;if(s>Z)s=Z}}if(c>e)c=e;if(c<n)c=n;w=n*1440/Ai;b=c*1440/Ai;x=s*1440/Ai;y=_*1440/Ai;l=eR[t].row;if(Nj($E[l].flags&tc.ROWFLAG_LAYOUT_FIXED)&&eR[t].FixWidth>0){A=eR[t].FixWidth-x6(t)-y6(t);if(A<0)A=0;if(A<x&&Dj(iO&tc.TFLAG9_WRAP_LONG_HTML_WORD))A=x;w=b=A;if(Nj(iO&tc.TFLAG9_WRAP_LONG_HTML_WORD)&&x>A)x=A}if(FR&&w<tc.MIN_AUTO_CELL_WIDTH){w=tc.MIN_AUTO_CELL_WIDTH;if(b<w)b=w}l=eR[t].row;if(eR[t].TextAngle!=0&&$E[l].MinHeight>=0&&$E[l].MinHeight<x)$E[l].MinHeight=x;if(eR[t].TextAngle!=0)x=w=a;Ug=w;kg=b;Xg=x;Kg=y;return true}function b8(){var t;var e;for(t=1;t<iR;t++){if(!$E[t].InUse){$E[t]=(new tc.ClsTableRow).init();tR[t]=new tc.ClsTableAux;return t}}if(!GR&&Dj(Qh&tc.TFLAG3_HTML_READ)&&Dj(aO&tc.TOFLAG_NO_RECOVE_ID)){W8();U8();for(t=1;t<iR;t++){if(!$E[t].InUse){$E[t]=(new tc.ClsTableRow).init();tR[t]=new tc.ClsTableAux;return t}}}for(t=1;t<iR;t++){if(!$E[t].InUse){$E[t]=(new tc.ClsTableRow).init();tR[t]=new tc.ClsTableAux;return t}}if(iR>=lR){e=lR+lR/2;lR=e}iR++;$E[iR-1]=(new tc.ClsTableRow).init();tR[iR-1]=new tc.ClsTableAux;return iR-1}function x8(t){var e,r;var i;if(Nj(zh&tc.TFLAG_USE_NEXT_ID)){Aj(tc.TFLAG_USE_NEXT_ID);t=false}else{if(!t&&nR>0)r=nR;else r=1;for(e=r;e<fR;e++){if(!eR[e].InUse){y8(e);nR=e;return e}}}if(t){W8();for(e=1;e<fR;e++){if(!eR[e].InUse){y8(e);nR=e;return e}}}if(fR>=aR){i=aR+aR/2;aR=i}fR++;y8(fR-1);nR=fR-1;return fR-1}function y8(t){var e;eR[t]=new tc.ClsCell;rR[t]=new tc.ClsCellAux;eR[t].BackColor=tc.CLR_WHITE;eR[t].RowSpan=eR[t].ColSpan=1;eR[t].BorderWidth=[4];eR[t].BorderColor=[4];for(e=0;e<4;e++)eR[t].BorderColor[e]=tc.CLR_AUTO;eR[t].LeftPad=eR[t].RightPad=-1;eR[t].TopPad=eR[t].BotPad=-1;return true}function W8(){var t;var e;for(e=1;e<fR;e++)eR[e].InUse=false;for(t=0;t<Ri;t++){eR[ui[t].cid].InUse=true}eR[0].InUse=true;return true}function U8(){var t;for(t=1;t<iR;t++)$E[t].InUse=false;for(t=0;t<fR;t++){if(eR[t].InUse)$E[eR[t].row].InUse=true}$E[0].InUse=true;return true}_i.TerSetTableColWidth=function(t,e){var r,i;if(!lv||!QD())_i.TerCreateControl();i=ui[br].cid;if(i==0)return false;if(t<0)return false;uA=tc.HILIGHT_OFF;if(!B6(tc.IDC_TABLE_SEL_COLS))return false;for(r=0;r<fR;r++){if(Dj(eR[r].InUse)||Dj(eR[r].flags&(tc.CFLAG_SEL1|tc.CFLAG_SEL2)))continue;eR[r].width=t}oi.modified++;if(e)cG();return true};_i.TerSelectTable=function(t,e){var r,i,f,l,a,n;var c;if(!lv||!QD())_i.TerCreateControl();i=ui[br].cid;if(i==0)return false;if(t<0)t=eR[i].level;if(t>eR[i].level)return false;for(c=br;c>0;c--){i=ui[c].cid;r=eR[i].row;f=ui[c-1].cid;a=eR[f].row;if(f==0||eR[f].level<t)break;if(a==r)continue;if(eR[f].level==t&&Nj($E[a].flags&tc.ROWFLAG_LAST_ROW))break;if(eR[i].PrevCell<=0){r=eR[i].row;if(eR[i].level==t&&Nj($E[r].flags&tc.ROWFLAG_NEW_TABLE))break}}sA=c;TA=0;for(c=br;c<Ri-1;c++){i=ui[c].cid;r=eR[i].row;l=ui[c+1].cid;n=eR[l].row;if(l==0||eR[l].level<t)break;if(n==r)continue;if(eR[l].level==t&&Nj($E[n].flags&tc.ROWFLAG_NEW_TABLE))break;if(eR[i].NextCell<=0){r=eR[i].row;if(eR[i].level==t&&Nj($E[r].flags&tc.ROWFLAG_LAST_ROW))break}}if(GY(c,tc.INFO_ROW))c--;_A=c;AA=ui[c].len;OA=false;uA=tc.HILIGHT_CHAR;if(e)cG();return true};_i.TerSelectRow=function(t){var e;var r,i,f,l;if(!lv||!QD())_i.TerCreateControl();i=ui[br].cid;if(i==0)return false;l=eR[i].row;r=eR[i].level;for(e=br;e>0;e--){f=E6(r,e-1);if(f==0)break;if(l!=eR[f].row)break}sA=e;TA=0;for(e=br;e+1<Ri;e++){f=E6(r,e+1);if(f==0)break;if(l!=eR[f].row)break}_A=e;AA=ui[_A].len;uA=tc.HILIGHT_CHAR;OA=false;pA=false;if(t)cG();return true};_i.TerIsTableSelected=function(){var t;var e,r,i;var f;if(!lv||!QD())_i.TerCreateControl();if(uA==tc.HILIGHT_OFF)return false;if(!ON())return false;for(t=sA;t<=_A;t++){if(ui[t].cid==0)continue;e=t==sA?TA:0;r=t==_A?AA:ui[t].len;f=ui[t].txt;for(i=e;i<r;i++)if(f[i]==TR||f[i]==tc.ROW_CHAR)return true}return false};function k8(t,e){var r,i;var f,l;if(t>e){t=WY(t,e);e=JC}i=ui[t].cid;if(i==0)return false;f=eR[i].PrevCell<=0;r=eR[i].row;if($E[r].PrevRow>0&&Dj($E[r].flags&tc.ROWFLAG_NEW_TABLE))return false;i=ui[e].cid;if(i==0)return false;l=eR[i].NextCell<=0;r=eR[i].row;if($E[r].NextRow>0&&Dj($E[r].flags&tc.ROWFLAG_LAST_ROW))return false;return true}function X8(){var t,e,r,i;if(uA==tc.HILIGHT_OFF)return false;if(!ON())return false;for(e=sA;e<=_A;e++)if(ui[e].cid==0)return false;i=ui[_A].cid;t=eR[i].level;r=ui[sA].cid;if(eR[r].level<t)return false;r=E6(t,sA);if(r==i){if(TA>0&&AA+1<ui[_A].len)return false;if(sA>0&&E6(t,sA-1)==r)return false;if(!GY(_A,tc.INFO_CELL|tc.INFO_ROW))return false}if(eR[r].PrevCell>0)return false;if(eR[i].NextCell>0)return false;return true}_i.TerHtmlCellWidthFlag=function(t,e,r){var i,f,l;var a=false;if(!lv||!QD())_i.TerCreateControl();if(uA==tc.HILIGHT_CHAR&&(ui[sA].cid>0||ui[_A].cid>0))a=true;f=ui[br].cid;if(!oi.PrintView||f==0&&!a)return true;if(t<=0){Ls=eR[f].flags;if(!FX(new terdlg_cell_width_flag(_i)))return false;t=hs;e=Ls}else{if(t==tc.SEL_CELLS)t=tc.IDC_TABLE_SEL_CELLS;else if(t==tc.SEL_COLS)t=tc.IDC_TABLE_SEL_COLS;else if(t==tc.SEL_ROWS)t=tc.IDC_TABLE_SEL_ROWS;else if(t==tc.SEL_ALL)t=tc.IDC_TABLE_ALL;else t=0}if(t==0)return true;if(e!=0&&e!=tc.CFLAG_FIX_WIDTH&&e!=tc.CFLAG_FIX_WIDTH_PCT&&e!=tc.CFLAG_AUTO_WIDTH)return false;if(!B6(t))return false;for(i=0;i<fR;i++){if(!eR[i].InUse||Dj(eR[i].flags&(tc.CFLAG_SEL1|tc.CFLAG_SEL2)))continue;l=eR[i].row;$E[l].flags=cj($E[l].flags,tc.ROWFLAG_AUTO_FIT|tc.ROWFLAG_AUTO_WIDTH_RTF)}for(i=0;i<fR;i++){if(Dj(eR[i].InUse)||Dj(eR[i].flags&(tc.CFLAG_SEL1|tc.CFLAG_SEL2)))continue;eR[i].flags=cj(eR[i].flags,tc.CFLAG_AUTO_WIDTH|tc.CFLAG_FIX_WIDTH|tc.CFLAG_FIX_WIDTH_PCT);eR[i].flags|=e;if(Nj(e&tc.CFLAG_FIX_WIDTH_PCT))eR[i].flags|=tc.CFLAG_AUTO_WIDTH;if(Nj(eR[i].flags&tc.CFLAG_FIX_WIDTH))eR[i].FixWidth=eR[i].width;else eR[i].FixWidth=0;if(Nj(eR[i].flags&tc.CFLAG_AUTO_WIDTH)){l=eR[i].row;$E[l].flags|=tc.ROWFLAG_AUTO_FIT|tc.ROWFLAG_AUTO_WIDTH_RTF}}bG(true);oi.modified++;if(r)cG();return true};_i.TerGetTablePos=function(){return _i.TerGetTablePos2(0)};_i.TerGetTablePos2=function(t){var e,r,i=0;var f,l,a,n;var c,s;var _=false;var o,u,T;if(!lv||!QD())_i.TerCreateControl();o=u=T=0;xg=yg=Wg=0;if(!oi.PageMode)return false;if(t>0){if(t>fR)return false;if(Dj(eR[t].InUse))return false;c=eR[t].level;r=-1;for(e=0;e<Ri;e++){if(r<0){if(A6(c,e)||E6(c,e)!=t)continue;r=i=e}else if(A6(c,e)||E6(c,e)!=t)break;i=e}if(r<0)return false;s=c+1}else{r=0;i=Ri-1;c=s=0}if(A6(s,br))return false;if(br<r||br>i)return false;e=r;l=-1;while(e<=br){if(!_&&!A6(s,e)){l++;_=true}if(_&&A6(s,e))_=false;e++}o=l;a=0;e=br;while(e>=r){if(A6(s,e))break;if(Nj(ui[e].tabw)&&Nj(ui[e].tabw.type&tc.INFO_ROW)&&L6(e)==s)a++;e--}u=a;n=0;e=br-1;while(e>=0){f=ui[e].cid;if(A6(s,e))break;if(GY(e,tc.INFO_ROW)&&L6(e)==s)break;if(GY(e,tc.INFO_CELL)&&L6(e)==s)n++;e--}T=n;xg=o;yg=u;Wg=T;return true};_i.TerGetTableId=function(t){if(!lv||!QD())_i.TerCreateControl();if(t<0){var e=ui[br].cid;if(e==0)return-1;else t=eR[e].row}if(!$E[t].InUse)return-1;if($E[t].id<0)return $E[t].id;while(!s6(t))t=$E[t].PrevRow;return $E[t].id};_i.TerSetTableId=function(t,e){if(!lv||!QD())_i.TerCreateControl();if(t<0){var r=ui[br].cid;if(r==0)return false;else t=eR[r].row}if(!$E[t].InUse)return false;if(e<0){$E[t].id=e;return true}while(!s6(t))t=$E[t].PrevRow;while(true){$E[t].id=e;if(u6(t))break;t=$E[t].NextRow}return true};_i.TerPosTable=function(t,e,r,i,f){return _i.TerPosTable2(t,e,r,i,0,f)};_i.TerPosTable2=function(t,e,r,i,f,l){return _i.TerPosTable4(0,t,e,r,i,f,l)};_i.TerPosTable3=function(t,e,r,i,f){return _i.TerPosTable4(t,0,e,r,i,0,f)};_i.TerPosTable4=function(t,e,r,i,f,l,a){var n,c,s=0;var _,o,u=0,T,A,E,R=0,L;var C=false;if(!lv||!QD())_i.TerCreateControl();if(!oi.PageMode)return false;if(f!=tc.POS_BEG&&f!=tc.POS_END)return false;if(t!=0){for(n=0;n<Ri;n++){u=ui[n].cid;if(u==0)continue;_=eR[u].row;if($E[_].id==t)break}if(n==Ri)return false;c=n;s=Ri-1;L=eR[u].level}else if(l>0){if(l>fR)return false;if(Dj(eR[l].InUse))return false;R=eR[l].level;c=-1;for(n=0;n<Ri;n++){if(c<0){if(A6(R,n)||E6(R,n)!=l)continue;c=s=n}else if(A6(R,n)||E6(R,n)!=l)break;s=n}if(c<0)return false;L=R+1}else{c=0;s=Ri-1;L=0}if(t!=0)n=c;else if(e>=0){n=c;T=-1;while(n<=s){if(!C&&!A6(L,n)){T++;if(T==e)break;else C=true}if(C&&A6(L,n))C=false;n++}if(n>=s)return false}else{if(ui[br].cid==0)return false;if(l>0&&A6(L,br))return false;u=E6(L,br);_=eR[u].row;while(!s6(_))_=$E[_].PrevRow;u=$E[_].FirstCell;n=br;while(n>=0&&!A6(L,n)&&E6(L,n)!=u)n--;if(n<0||A6(L,n))return false;while(n>=0&&!A6(L,n)&&E6(L,n)==u)n--;n++}if(r>0){A=0;while(n<=s){if(A6(L,n))return false;if(Nj(ui[n].tabw)&&Nj(ui[n].tabw.type&tc.INFO_ROW)&&L6(n)==L){A++;if(A==r){n++;break}}n++}}if(A6(L,n))return false;if(f==tc.POS_END)i++;if(i>0){E=0;while(n<=s){if(Nj(ui[n].tabw)&&Nj(ui[n].tabw.type&tc.INFO_ROW)&&L6(n)==L)return false;if(Nj(ui[n].tabw)&&Nj(ui[n].tabw.type&tc.INFO_CELL)&&L6(n)==L){E++;if(E==i){n++;if(f==tc.POS_BEG&&n<Ri&&GY(n,tc.INFO_ROW)&&L6(n)==L)return false;break}}n++}}if(f==tc.POS_BEG)_i.SetTerCursorPos(n,0,a);else{o=ui[n-1].len-1;if(o<0)o=0;_i.SetTerCursorPos(n-1,o,a)}return true};_i.TerPosAfterTable=function(t,e){var r;var i,f;if(!lv||!QD())_i.TerCreateControl();if(!oi.PageMode)return false;i=ui[br].cid;if(i==0)return false;f=eR[i].level;for(r=br+1;r<Ri;r++){i=ui[r].cid;if(i==0)break;if(!t&&eR[i].level<f)break}_i.SetTerCursorPos(r,0,e);return true};_i.TerGetRowInfo=function(t){if(!lv||!QD())_i.TerCreateControl();JF=zF=ZF=QF=qF=$F=eg=rg=ig=0;if(t<0){var e=-t;if(e>=fR||!eR[e].InUse)return false;t=eR[e].row}if(t>=iR||!$E[t].InUse)return false;JF=$E[t].height;zF=$E[t].MinHeight;ZF=$E[t].FixWidth;QF=$E[t].PrevRow;qF=$E[t].NextRow;$F=$E[t].indent;eg=$E[t].flags;rg=$E[t].border;var r=0;var i=$E[t].FirstCell;while(i>0){r+=eR[i].width;i=eR[i].NextCell}ig=r;return true};_i.TerGetCellInfo=function(t){if(!lv||!QD())_i.TerCreateControl();fg=lg=ag=BF=ng=cg=sg=_g=0;og=0;if(!oi.PageMode)return false;if(t<0||t>=fR)return false;fg=eR[t].row;lg=eR[t].PrevCell;ag=eR[t].NextCell;BF=eR[t].width;ng=eR[t].border;cg=eR[t].shading;sg=eR[t].RowSpan;_g=eR[t].ColSpan;og=eR[t].flags;return true};_i.TerGetCellInfo2=function(t){if(!lv||!QD())_i.TerCreateControl();Ag=tc.CLR_WHITE;ug=0;if(!oi.PageMode)return false;if(t<0||t>=fR||!eR[t].InUse)return false;Ag=eR[t].BackColor;ug=eR[t].margin;return true};_i.TerGetRowParam=function(t,e){if(!lv||!QD())_i.TerCreateControl();if(!oi.PageMode)return-1;if(e<0){var r=ui[br].cid;e=eR[r].row}if(e<=0||e>=iR)return-1;if(t==tc.RP_FIRST_CELL)return $E[e].FirstCell;else if(t==tc.RP_LAST_CELL)return $E[e].LastCell;else if(t==tc.RP_TOP_ROW_HT)return tR[e].TopRowHt;else if(t==tc.RP_BOT_ROW_HT)return tR[e].BotRowHt;else if(t==tc.RP_FLAGS)return $E[e].flags;else if(t==tc.RP_ROW_ID)return e;else if(t==tc.RP_INDENT)return $E[e].indent;else if(t==tc.RP_CELL_MARGIN)return $E[e].CellMargin;else if(t==tc.RP_MIN_HEIGHT)return $E[e].MinHeight;else if(t==tc.RP_FLOW)return $E[e].flow;else if(t==tc.RP_LEFT_PAD)return $E[e].LeftPad;else if(t==tc.RP_RIGHT_PAD)return $E[e].RightPad;else if(t==tc.RP_TOP_PAD)return $E[e].TopPad;else if(t==tc.RP_BOT_PAD)return $E[e].BotPad;else if(t==tc.RP_PREV_ROW)return $E[e].PrevRow;else if(t==tc.RP_NEXT_ROW)return $E[e].NextRow;return-1};_i.TerSetRowParam=function(t,e,r){r=0;if(!lv||!QD())_i.TerCreateControl();if(!oi.PageMode)return false;if(e<0){var i=ui[br].cid;e=eR[i].row}if(e<=0||e>=iR)return false;if(t==tc.RP_FLAGS)$E[e].flags=r;else if(t==tc.RP_INDENT)$E[e].indent=r;else if(t==tc.RP_CELL_MARGIN)$E[e].CellMargin=r;else if(t==tc.RP_MIN_HEIGHT)$E[e].MinHeight=r;else if(t==tc.RP_FLOW)$E[e].flow=r;else if(t==tc.RP_LEFT_PAD)$E[e].LeftPad=r;else if(t==tc.RP_RIGHT_PAD)$E[e].RightPad=r;else if(t==tc.RP_TOP_PAD)$E[e].TopPad=r;else if(t==tc.RP_BOT_PAD)$E[e].BotPad=r;return true};_i.TerGetCellParam2=function(t,e){return _i.TerGetCellParam(t,e)};_i.TerGetCellParam=function(t,e){var r=tc.CP_ERROR;if(!lv||!QD())_i.TerCreateControl();if(!oi.PageMode)return-1;if(e<0)e=ui[br].cid;if(e<=0||e>=fR||!eR[e].InUse)return-1;if(t==tc.CP_FIX_WIDTH)r=eR[e].FixWidth;else if(t==tc.CP_PARENT_CELL)r=eR[e].ParentCell;else if(t==tc.CP_LEVEL)r=eR[e].level;else if(t==tc.CP_TEXT_ROTATION){var i=eR[e].TextAngle;if(i==270)r=tc.TEXT_TOP_TO_BOT;else if(i==90)r=tc.TEXT_BOT_TO_TOP;else r=tc.TEXT_HORZ}else if(t==tc.CP_WIDTH)r=eR[e].width;else if(t==tc.CP_ROW)r=eR[e].row;else if(t==tc.CP_ID)r=e;else if(t==tc.CP_NEXT)r=eR[e].NextCell;else if(t==tc.CP_PREV)r=eR[e].PrevCell;else if(t==tc.CP_TEXT_ANGLE)r=eR[e].TextAngle;else if(t==tc.CP_FLAGS)r=eR[e].flags;else if(t==tc.CP_MARGIN)r=eR[e].margin;else if(t==tc.CP_ROW_SPAN)r=eR[e].RowSpan;else if(t==tc.CP_COL_SPAN)r=eR[e].ColSpan;else if(t==tc.CP_ROW_WIDTH){var f=eR[e].row;var l=$E[f].FirstCell;var a=0;for(;l>0;l=eR[l].NextCell)a+=eR[l].width;r=a}else if(t==tc.CP_PAD_LEFT){r=eR[e].LeftPad;if(r<0)r=eR[e].margin}else if(t==tc.CP_PAD_RIGHT){r=eR[e].RightPad;if(r<0)r=eR[e].margin}else if(t==tc.CP_PAD_TOP){r=eR[e].TopPad;if(r<0)r=0}else if(t==tc.CP_PAD_BOT){r=eR[e].BotPad;if(r<0)r=0}else r=-1;return r};_i.TerSetCellParam=function(t,e,r,i){var f,l,a,n;var c=false;var s;if(!lv||!QD())_i.TerCreateControl();if(t<0){a=n=l=-t;if(l>=fR)return false;eR[l].flags|=tc.CFLAG_SEL1}else{if(uA==tc.HILIGHT_CHAR&&(ui[sA].cid>0||ui[_A].cid>0))c=true;l=ui[br].cid;if(!oi.PrintView||l==0&&!c)return true;if(l==0&&t==tc.SEL_ALL)return true;if(t==tc.SEL_CELLS)t=tc.IDC_TABLE_SEL_CELLS;else if(t==tc.SEL_COLS)t=tc.IDC_TABLE_SEL_COLS;else if(t==tc.SEL_ROWS)t=tc.IDC_TABLE_SEL_ROWS;else if(t==tc.SEL_ALL)t=tc.IDC_TABLE_ALL;else return false;a=0;n=fR-1;if(!B6(t))return false;V8(0,0,0,0,tc.UNDO_TABLE_ATTRIB)}s=true;for(f=a;f<=n;f++){if(!eR[f].InUse||Dj(eR[f].flags&(tc.CFLAG_SEL1|tc.CFLAG_SEL2)))continue;if(e==tc.CP_PAD_LEFT)eR[f].LeftPad=r;else if(e==tc.CP_PAD_RIGHT)eR[f].RightPad=r;else if(e==tc.CP_PAD_TOP)eR[f].TopPad=r;else if(e==tc.CP_PAD_BOT)eR[f].BotPad=r;else if(e==tc.CP_CELL_PICT)eR[f].PictId=r;else if(e==tc.CP_TEXT_ANGLE)eR[f].TextAngle=r;else if(e==tc.CP_FLAGS)eR[f].flags=r;else if(e==tc.CP_MARGIN)eR[f].margin=r;else if(e==tc.CP_WIDTH)eR[f].width=r;else if(e==tc.CP_FIX_WIDTH)eR[f].FixWidth=r;else if(e==tc.CP_TEXT_ROTATION){if(r==tc.TEXT_TOP_TO_BOT)eR[f].TextAngle=270;else if(r==tc.TEXT_BOT_TO_TOP)eR[f].TextAngle=90;else eR[f].TextAngle=0}else if(e==tc.CP_TABLE_PICT){var _=eR[f].row;$E[_].TblPictId=r}else{s=false;break}}oi.modified++;if(i)cG();return s};_i.TerGetCellBorderWidth=function(t){if(!lv||!QD())_i.TerCreateControl();Eg=Rg=Lg=Cg=0;if(!oi.PageMode)return false;if(t<=0)t=ui[br].cid;if(t<=0||t>=fR||!eR[t].InUse)return false;if(Nj(eR[t].border&tc.BORDER_LEFT))Eg=eR[t].BorderWidth[tc.BORDER_INDEX_LEFT];if(Nj(eR[t].border&tc.BORDER_RIGHT))Rg=eR[t].BorderWidth[tc.BORDER_INDEX_RIGHT];if(Nj(eR[t].border&tc.BORDER_TOP))Lg=eR[t].BorderWidth[tc.BORDER_INDEX_TOP];if(Nj(eR[t].border&tc.BORDER_BOT))Cg=eR[t].BorderWidth[tc.BORDER_INDEX_BOT];return true};_i.TerGetCellBorderColor=function(t){if(!lv||!QD())_i.TerCreateControl();Hg=mg=wg=bg=tc.CLR_BLACK;if(!oi.PageMode)return false;if(t<=0)t=ui[br].cid;if(t<=0||t>=fR||!eR[t].InUse)return false;Hg=eR[t].BorderColor[tc.BORDER_INDEX_LEFT];mg=eR[t].BorderColor[tc.BORDER_INDEX_RIGHT];wg=eR[t].BorderColor[tc.BORDER_INDEX_TOP];bg=eR[t].BorderColor[tc.BORDER_INDEX_BOT];return true};_i.TerCreateCellId=function(t,e,r,i,f,l,a,n,c,s,_,o,u,T){if(!lv||!QD())_i.TerCreateControl();var A,E,R;var L;if(!oi.PageMode)return 0;if(t){if(e>0){if(e>=fR||Dj(eR[e].InUse))return 0;R=eR[e].row}else R=0;L=aO;aO|=tc.TOFLAG_NO_RECOVE_ID;if((E=b8())==-1)return 0;aO=L;$E[E].InUse=true;if(R>0){var C=$E[R].NextRow;$E[R].NextRow=E;$E[E].PrevRow=R;if(Nj($E[R].flags&tc.ROWFLAG_RTL))$E[E].flags|=tc.ROWFLAG_RTL;if(Nj($E[R].flags&tc.ROWFLAG_AUTO_FIT))$E[E].flags|=tc.ROWFLAG_AUTO_FIT;if(Nj($E[R].flags&tc.ROWFLAG_AUTO_WIDTH_RTF))$E[E].flags|=tc.ROWFLAG_AUTO_WIDTH_RTF;if(C>0){$E[E].NextRow=C;$E[C].PrevRow=E}}else{$E[E].PrevRow=-1;$E[E].flags|=tc.ROWFLAG_NEW_TABLE}$E[E].NextRow=-1;$E[E].FirstCell=0;$E[E].LastCell=0;$E[E].CellMargin=CR;if(r==tc.CENTER)$E[E].flags|=tc.CENTER;else if(r==tc.RIGHT_JUSTIFY)$E[E].flags|=tc.RIGHT_JUSTIFY;$E[E].MinHeight=f;if(Nj(T&tc.CFLAG_AUTO_WIDTH_RTF))$E[E].flags|=tc.ROWFLAG_AUTO_WIDTH_RTF;if((A=x8(false))==-1)return 0;eR[A].InUse=true;eR[A].row=E;eR[A].margin=CR;eR[A].PrevCell=-1;eR[A].NextCell=-1;eR[A].x=i;$E[E].FirstCell=$E[E].LastCell=A;$E[E].indent=i}else{if(e<=0||e>=fR||Dj(eR[e].InUse))return 0;if(eR[e].NextCell!=-1)return 0;if((A=x8(false))==-1)return 0;Q6(e,A);eR[A].LeftPad=eR[A].RightPad=-1;eR[A].TopPad=eR[A].BotPad=-1;eR[A].PictId=0;eR[A].BackColor=tc.CLR_WHITE;eR[A].x=eR[e].x+eR[e].width;eR[e].NextCell=A;eR[A].PrevCell=e;eR[A].NextCell=-1;E=eR[e].row;$E[E].LastCell=A;if(Nj(f))$E[E].MinHeight=f}if(l>0)eR[A].width=eR[A].FixWidth=l;else{eR[A].width=1e3;eR[A].FixWidth=l}eR[A].shading=a;eR[A].border=0;if(n>0)eR[A].border|=tc.BORDER_LEFT;if(c>0)eR[A].border|=tc.BORDER_RIGHT;if(s>0)eR[A].border|=tc.BORDER_TOP;if(_>0)eR[A].border|=tc.BORDER_BOT;eR[A].BorderWidth[tc.BORDER_INDEX_LEFT]=n;eR[A].BorderWidth[tc.BORDER_INDEX_RIGHT]=c;eR[A].BorderWidth[tc.BORDER_INDEX_TOP]=s;eR[A].BorderWidth[tc.BORDER_INDEX_BOT]=_;eR[A].flags=0;if(o<1)eR[A].flags|=tc.CFLAG_ROW_SPANNED;if(u<1)eR[A].flags|=tc.CFLAG_COL_SPANNED;if(o<1)o=1;if(u<1)u=1;if(l==0)eR[A].flags|=tc.CFLAG_AUTO_WIDTH;if(l<0)eR[A].flags|=tc.CFLAG_FIX_WIDTH_PCT;if(l>0)eR[A].flags|=tc.CFLAG_FIX_WIDTH;eR[A].flags|=T;eR[A].RowSpan=o;eR[A].ColSpan=u;return A};_i.TerSetCellInfo=function(t,e,r){return _i.TerSetCellInfo2(t,e,r,0)};_i.TerSetCellInfo2=function(t,e,r,i){if(!lv||!QD())_i.TerCreateControl();if(!oi.PageMode)return false;if(t<=0||t>=fR||Dj(eR[t].InUse))return false;eR[t].BackColor=e;if(r>=0){eR[t].margin=r}if(i>0){if(i<=0||i>=fR||Dj(eR[i].InUse))return false;eR[t].ParentCell=i;eR[t].level=eR[i].level+1}return true};_i.TerGetRowCellCount=function(t){var e,r,i;if(!lv||!QD())_i.TerCreateControl();if(!oi.PageMode)return 0;e=r=ui[br].cid;if(e<=0)return 0;if(t){var f=eR[e].row;i=1;while(!s6(f)){f=$E[f].PrevRow;i++}f=eR[e].row;while(!u6(f)){f=$E[f].NextRow;i++}return i}else{i=1;while(eR[e].PrevCell>0){e=eR[e].PrevCell;i++}e=r;while(eR[e].NextCell>0){e=eR[e].NextCell;i++}return i}};function K8(t){var e=eR[t].row;var r=eR[t].RowSpan;var i=0;if(r<=1)return t;while(r>1){e=$E[e].NextRow;if(e<=0)break;r--}if(e>0){var f=$E[e].FirstCell;for(;f>0;f=eR[f].NextCell)if(rR[f].SpanningCell==t)break;if(f>0)i=f}if(i>0)return i;else return t}function Y8(t){var e=ui[t].cid,r,i,f;var l=eR[e].row;if(e==0||l==0)return false;for(r=t;r<Ri;r++){if((i=ui[r].cid)==0)break;f=eR[i].row;if(f!=l)break;if(!w$(r))return false}for(r=t-1;r>=0;r--){if((i=ui[r].cid)==0)break;f=eR[i].row;if(f!=l)break;if(!w$(r))return false}return true}_i.TerSaveUndo=function(t,e,r,i,f){if(!lv||!QD())_i.TerCreateControl();Em(r,i);r=PC;i=SC;V8(t,e,r,i,f);return true};function V8(t,e,r,i,f){var l,a,n;var c=true;var s=false;if(TE||uE==CE||Nj(Qh&tc.TFLAG3_NO_SAVE_UNDO)||Nj(nO&tc.TOFLAG2_NO_SAVE_UNDO))return;c9();if(i<0&&r>t&&ui[r].len>0){r--;i=ui[r].len-1;s=true}n=_E-1;var _=cO;cO|=tc.TOFLAG3_NO_CRLF_FLAG;if(n>=0&&sE[n].type==tc.CHAR_I&&f==tc.CHAR_I&&t==r&&e==i&&Dj(qh&tc.TFLAG4_UNDO_WINDOW_OVERFLOW)&&Dj(fO&tc.TFLAG10_DONT_COMBINE_UNDOS)&&Dj(aO&tc.TOFLAG_BREAK_CHAR)){var o=Lq(r,i);if(o==sE[n].end+1&&sE[n].end-sE[n].beg<3){var u=fb(t,e);if(Dj(xs[u].style&tc.PICT)){sE[n].end++;s9(n);cO=_;return}}}if(f==tc.CHAR_O)f=tc.CHAR_I;if(_E==RE){_9();if(CE==uE){oE=_E;cO=_;return}}a=_E;sE[a]=new tc.ClsUndo;sE[a].type=f;sE[a].id=uE;sE[a].TblLevel=-1;sE[a].EmbTable=false;if(f==tc.CHAR_D)sE[a].curs=Lq(br,jt);if(s)sE[a].flags|=tc.UNDO_LAST_LINE_FIRST_COL;if(t>=0&&t<Ri&&ui[t].cid==0&&r>=0&&r<Ri&&ui[r].cid!=0)sE[a].flags|=tc.UNDO_TEXT_TO_TABLE;else if(t>=0&&t<Ri&&r>=0&&r<Ri&&(ui[t].cid>0||ui[r].cid>0)){for(l=t;l<=r;l++){if(ui[l].cid==0){sE[a].flags|=tc.UNDO_TEXT_TO_TABLE;break}}}if(!TE&&!AE&&sE[a].type==tc.CHAR_D&&!oi.WordWrap&&e==0&&i+1==ui[r].len)i++;AE=true;if(sE[a].type==tc.CHAR_R)c=Q8(a,t,e,r,i);else if(sE[a].type==tc.CHAR_F)c=z8(a,t,e,r,i);else if(sE[a].type==tc.CHAR_D)c=J8(a,t,e,r,i);else if(sE[a].type==tc.CHAR_P)c=Z8(a,t,r);else if(sE[a].type==tc.UNDO_ROW_DEL){c=$8(a,t,r);t=rI;r=iI}else if(sE[a].type==tc.UNDO_ROW_INS){c=t9(a,t,r);t=rI;r=iI}else if(sE[a].type==tc.UNDO_FRAME||sE[a].type==tc.UNDO_FRAME_LIMITED){c=r9(a,t,r,sE[a].type);t=rI;r=iI}else if(sE[a].type==tc.UNDO_PICT_SIZE){c=i9(a,t,r);t=rI;r=iI}else if(sE[a].type==tc.UNDO_TABLE_ATTRIB)c=f9(a,t,e,r,i);else if(sE[a].type==tc.UNDO_TAG_INSERT)c=q8(a);else if(sE[a].type==tc.UNDO_TAG_DELETE)c=q8(a);else if(sE[a].type==tc.UNDO_LIST_LEVEL)c=j8(a,t,true);AE=false;if(!c){cO=_;return}FE=t;gE=r;if(f==tc.UNDO_ROW_DEL||f==tc.UNDO_ROW_INS||f==tc.UNDO_CELL_DEL||f==tc.UNDO_CELL_INS||f==tc.CHAR_P){e=0;i=ui[r].len-1;if(i<0)i=0}if(sE[a].type!=tc.UNDO_FRAME&&sE[a].type!=tc.UNDO_FRAME_LIMITED&&sE[a].type!=tc.UNDO_TABLE_ATTRIB){sE[a].beg=Lq(t,e);sE[a].end=Lq(r,i)}_E++;oE=_E;cO=_}function j8(t,e,r){var i=ui[e].pfmt;var f=Nc[i].BltId;if(f>0){var l=xc[f].ls;var a=Jc[l].ListIdx;var n=xc[f].lvl;var c=null;if(Kc[a].LevelCount>n)c=Kc[a].level;if(Jc[l].LevelCount>n)c=Jc[l].level;if(c!=null){var s;if(r)sE[t].ListLevel=c[n].copy();else{var _=sE[t].ListLevel;sE[t].ListLevel=c[n];c[n]=_}}}return true}function J8(t,e,r,i,f){var l,a,n,c;var s=0,_,o;var u=false,T=false;var A;var E;var R;var L;var C;var I=null;if(e!=i||Nj(ui[i].flags&tc.LFLAG_PARA)&&f+1>=ui[i].len)u=true;if(!u&&wx(e,r,i,f))u=true;if(!oi.WordWrap&&r==0&&f==ui[i].len)u=true;if(u){a=uA;_=sA;n=TA;o=_A;c=AA;uA=tc.HILIGHT_CHAR;sA=e;TA=r;_A=i;AA=f+1;if(AA>ui[_A].len){if(!oi.WordWrap&&_A+1<Ri&&r==0){_A++;AA=0}else AA=ui[_A].len}var d;C=Z_;Z_=false;l3(tc.RTF_FRAME_BUF,"");d=HP;sE[t].TblLevel=Te;sE[t].EmbTable=gi;Z_=C;sE[t].txt=Uk(d);d=null;sE[t].fmt=null;if(yN()){sE[t].flags|=tc.UNDO_DEL_ALL;if(yR)sE[t].flags|=tc.UNDO_SHOW_HDR_FTR}Te=1;gi=true;uA=a;sA=_;TA=n;_A=o;AA=c}else{if(f>=ui[i].len)T=true;if(!a9(tc.CHAR_D,t,e,r,i,f))return false;R=Jd;L=zd;I=null;l=f-r+1;if(l>ui[e].len)l=ui[e].len;A=ui[e].txt;E=nb(e);qY(A,r,R,s,l);qY(E,r,L,s,l);s=s+l;sb(e);if(T)s=xk(s,R,L);R[s]=0;L[s]=0}if(i+1<Ri&&ui[i].cid==0&&ui[i+1].cid>0)sE[t].flags|=tc.UNDO_DEL_PARA_BEF_TABLE;return true}function z8(t,e,r,i,f){var l,a=0;var n;var c;var s,_,o;var u;var T=null;if(!a9(tc.CHAR_F,t,e,r,i,f))return false;n=Jd;c=zd;T=null;for(l=e;l<=i;l++){if(ui[l].len==0)continue;if(l==e)_=r;else _=0;if(l==i)o=f;else o=ui[l].len-1;u=nb(l);for(s=_;s<=o;s++,a++)c[a]=u[s];sb(l)}c[a]=0;return true}function Z8(t,e,r){var i,f=0;var l;if(!a9(tc.CHAR_P,t,e,0,r,0))return false;l=Zd;f++;for(i=e;i<=r;i++){if(Nj(ui[i].flags&tc.LFLAG_PARA_FIRST)||i==e){l[f]=ui[i].pfmt;f++}}l[0]=f-1;return true}function Q8(t,e,r,i,f){var l;var a;var n;var c;var s=null;if(!a9(tc.CHAR_R,t,e,r,i,f))return false;l=Jd;a=zd;s=null;n=ui[e].txt;c=nb(e);if(r<ui[e].len){l[0]=n[r];a[0]=c[r]}else{l[0]=tc.SPACE;a[0]=tc.DEFAULT_CFMT}l[1]=0;a[1]=0;return true}function q8(t){sE[t].TagType=SE;sE[t].TagName=hE;hE=null;sE[t].TagText=OE;OE=null;sE[t].TagInt=vE;return true}function $8(t,e,r){rI=e;iI=r;if(!e9(e,r))return false;e=rI;r=iI;if(!J8(t,e,0,r,0))return false;sE[t].TblLevel=0;sE[t].EmbTable=false;return true}function t9(t,e,r){rI=e;iI=r;if(!e9(e,r))return false;return true}function e9(t,e){var r,i,f,l;var a,n=false;rI=t;iI=e;t:{if(ui[t].cid==0){for(;t+1<Ri;t++)if(ui[t].cid>0)break}if(ui[e].cid==0){for(;e>0;e--)if(ui[e].cid>0)break}e:{r=ui[t].cid;if(r==0)break t;if(t==0||ui[t-1].cid==0)break e;for(t--;t>=0;t--){r=ui[t].cid;if(r==0)break;if(eR[r].level>0)continue;if(GY(t,tc.INFO_ROW))break}t++;r=ui[t].cid;i=eR[r].row;a=false;while(i>0){r=$E[i].FirstCell;for(;r>0;r=eR[r].NextCell)if(Nj(eR[r].flags&tc.CFLAG_ROW_SPANNED))break;if(r<=0)break;a=true;if($E[i].PrevRow<=0)break;i=$E[i].PrevRow}if(a){f=$E[i].PrevRow;if(f<0)f=0;if(f>0)l=$E[f].LastCell;else l=0;for(;t>=0;t--)if(ui[t].cid==l)break;t++}}e:{r=ui[e].cid;if(r==0)break t;if(eR[r].level==0&&GY(e,tc.INFO_ROW))break e;for(;e+1<Ri;e++){r=ui[e].cid;if(r==0)break t;if(eR[r].level>0)continue;if(GY(e,tc.INFO_ROW))break}}r=ui[e].cid;i=eR[r].row;a=false;f=0;while(i>0){r=$E[i].FirstCell;for(;r>0;r=eR[r].NextCell)if(Nj(eR[r].flags&tc.CFLAG_ROW_SPANNED)||eR[r].RowSpan>1)break;if(r<=0)break;a=true;f=i;if($E[i].NextRow<=0)break;i=$E[i].NextRow}if(a&&f>0){for(;e+1<Ri;e++){r=ui[e].cid;i=eR[r].row;if(i==f&&GY(e,tc.INFO_ROW))break}}n=true}rI=t;iI=e;return n}function r9(t,e,r,i){var f=e;rI=e=iI=r=0;if(f<0||f>=Kl)return false;sE[t].pFrame=new tc.ClsParaFrame;if(Nj(nO&tc.TOFLAG2_USE_UNDO_FRAME))sE[t].pFrame=PE;else sE[t].pFrame=kl[f].copy();sE[t].ObjId=f;if(i==tc.UNDO_FRAME){sE[t].LinePtrU=Rp();sE[t].TotalLinesU=Ri;sE[t].MaxLinesU=xe;sE[t].CursPos=Lq(br,jt)}rI=e;iI=r;return true}function i9(t,e,r){var i=e;rI=e=iI=r=0;if(i<0||i>=Ys)return false;sE[t].ObjId=i;sE[t].width=IE;sE[t].height=dE;rI=e;iI=r;return true}function f9(t,e,r,i,f){var l=0;var a=0;var n,c=0;var s=0;var _;sE[t].RowCount=0;sE[t].RowId=null;sE[t].CellId=null;sE[t].pRow=null;sE[t].pCell=null;if(e==0&&i==0&&r==0&&f==0)return l9(t);if(e<0){for(_=0;_<Ri;_++)if(ui[_].cid==r)break;if(_==Ri)return false;e=_}if(i<0){if(f<=0){for(i=e;i<Ri&&ui[i].cid>0;i++);i--}else{for(_=0;_<Ri;_++)if(ui[_].cid==f)break;if(_==Ri)return false;i=_}}if(i<e){_=e;e=i;i=_}l=a=0;c=0;for(_=e;_<=i;_++){s=ui[_].cid;if(s==0)continue;n=eR[s].row;if(n!=c){l++;for(s=$E[n].FirstCell;s>=0;s=eR[s].NextCell)a++;c=n}}if(l==0||a==0)return false;sE[t].RowId=[l+1];sE[t].pRow=[l+1];sE[t].CellId=[a+1];sE[t].pCell=[a+1];l=a=0;c=0;for(_=e;_<=i;_++){s=ui[_].cid;if(s==0)continue;n=eR[s].row;if(n!=c){sE[t].RowId[l]=n;sE[t].pRow[l]=$E[n].copy();l++;for(s=$E[n].FirstCell;s>=0;s=eR[s].NextCell){sE[t].CellId[a]=s;sE[t].pCell[a]=eR[s].copy();a++}c=n}}sE[t].RowCount=l;sE[t].CellCount=a;return true}function l9(t){var e,r=0;var i=0;var f;var l=0;i=0;for(l=0;l<fR;l++){if(!eR[l].InUse||Dj(eR[l].flags&(tc.CFLAG_SEL1|tc.CFLAG_SEL2)))continue;i++}if(i==0)return false;sE[t].RowId=[1];sE[t].pRow=[1];sE[t].CellId=[i+1];sE[t].pCell=[i+1];i=0;r=0;for(l=0;l<fR;l++){if(!eR[l].InUse||Dj(eR[l].flags&(tc.CFLAG_SEL1|tc.CFLAG_SEL2)))continue;sE[t].CellId[i]=l;sE[t].pCell[i]=eR[l].copy();i++;f=eR[l].row;for(e=0;e<r;e++)if(sE[t].RowId[e]==f)break;if(e==r){sE[t].RowId=fV(sE[t].RowId,r+2);sE[t].pRow=fV(sE[t].pRow,r+2);sE[t].RowId[r]=f;sE[t].pRow[r]=$E[f].copy();r++}}sE[t].RowCount=r;sE[t].CellCount=i;return true}function a9(t,e,r,i,f,l){var a;var n=0;var c;var s;var _;s9(e);c=null;s=null;_=null;if(t==tc.CHAR_D||t==tc.CHAR_F){if(l>=ui[f].len){n=n+2;l=ui[f].len-1;if(l<0)l=0}for(a=r;a<=f;a++){if(r==f)n=n+l-i+1;else n=n+ui[a].len;n=n+2}n++}else if(t==tc.CHAR_P){n=2;for(a=r+1;a<=f;a++)if(Nj(ui[a].flags&tc.LFLAG_PARA_FIRST))n++}else if(t==tc.CHAR_R)n=2;if(t==tc.CHAR_F){sE[e].fmt=s=[n]}else if(t==tc.CHAR_D||t==tc.CHAR_R){sE[e].txt=c=[n];sE[e].fmt=s=[n]}else if(t==tc.CHAR_P){sE[e].pfmt=_=[n]}Jd=c;zd=s;Zd=_;return true}_i.TerSetUndoRef=function(t){var e;if(!lv||!QD())_i.TerCreateControl();e=uE;if(t>=0)uE=t;return e};_i.TerFlushUndo=function(){if(!lv||!QD())_i.TerCreateControl();return n9()};_i.TerSetMaxUndo=function(t){if(!lv||!QD())_i.TerCreateControl();if(t>=RE)LE=t;return true};function n9(){var t;for(t=0;t<oE;t++)s9(t);_E=oE=0;return true}function c9(){var t;for(t=_E;t<oE;t++)s9(t);oE=_E;return true}function s9(t){sE[t].txt=null;sE[t].fmt=null;sE[t].pfmt=null;sE[t].pFrame=null;if(sE[t].LinePtrU!=null)Lp(sE[t].LinePtrU,sE[t].TotalLinesU);sE[t].LinePtrU=null;sE[t].RowId=null;sE[t].pRow=null;sE[t].CellId=null;sE[t].pCell=null;sE[t].RowCount=0;sE[t].CellCount=0;sE[t].TagName="";sE[t].TagText="";return true}function _9(){var t,e;if(_E<=0)return true;if(RE<LE){RE+=50;if(RE>LE)RE=LE;sE=fV(sE,RE+1);return true}e=LE/4;if(e<1)e=1;if(e>1e3)e=1e3;if(sE[e-1].id==sE[e].id){for(t=e;t<_E;t++)if(sE[t].id!=sE[e-1].id)break;e=t}CE=sE[e-1].id;for(t=0;t<e;t++)s9(t);for(t=e;t<_E;t++)sE[t-e]=sE[t];_E-=e;if(_E<0)_E=0;return true}function o9(t){var e;var r;var i;var f;var l;var a;var n;var c;var s=-1,_;var o;var u=0,T=0;var A,E=0,R=0,L,C,I,d;var F,g,P,S,h;var O,v=false,p=si;var N;var D;if(_E<=0&&t){return true}if(oE==_E&&!t){return true}TE=true;if(oE<_E)oE=_E;var M=cO;cO|=tc.TOFLAG3_NO_CRLF_FLAG;si=false;while(true){if(t)_=_E-1;else _=_E;if(s<0)s=sE[_].id;if(t)D=_E-2;else D=_E+1;if(D<0||D>=oE||sE[D].id!=s)si=p;if(_<0||_>=oE||sE[_].id!=s)break;if(sE[_].type!=tc.UNDO_FRAME&&sE[_].type!=tc.UNDO_FRAME_LIMITED&&sE[_].type!=tc.UNDO_PICT_SIZE&&sE[_].type!=tc.UNDO_TABLE_ATTRIB){Cq(sE[_].beg);u=PC;E=SC;v=Nj(nO&tc.TOFLAG2_ABS_POS_BEYOND);Cq(sE[_].end);T=PC;R=SC;br=u;jt=E;if(!oi.WordWrap&&T==u+1&&R==0&&E==ui[u].len)R--}o=EE=sE[_].type;switch(sE[_].type){case tc.CHAR_I:if(t){J8(_,u,E,T,R);sE[_].curs=Lq(T,R+1)}uA=tc.HILIGHT_CHAR;sA=u;_A=T;TA=E;AA=R+1;if(AA>=ui[_A].len&&_A+1<Ri&&ui[_A].cid==ui[_A+1].cid){_A++;AA=0}else if(AA==ui[_A].len&&Nj(sE[_].flags&tc.UNDO_LAST_LINE_FIRST_COL)&&_A+1<Ri){_A++;AA=0}if(sA==_A&&E==R)nO|=tc.TOFLAG2_NO_NORMALIZE_FNOTE;O=Z_;Z_=false;N=tO;Ij(tc.TFLAG6_DEL_CELL_TEXT);GN(false,false);tO=N;Z_=O;uj(tc.TOFLAG2_NO_NORMALIZE_FNOTE);uA=tc.HILIGHT_OFF;o=tc.CHAR_D;break;case tc.CHAR_R:e=sE[_].txt;r=sE[_].fmt;n=e[0];c=r[0];Q8(_,u,E,T,R);f=ui[br].txt;f[jt]=n;l=nb(br);l[jt]=c;sb(br);break;case tc.CHAR_D:e=sE[_].txt;r=sE[_].fmt;O=Z_;Z_=false;if(sE[_].fmt!=null){qN(e,r,null,true);_i.SetTerCursorPos(sE[_].curs,-1,false);for(A=0;A<e.length;A++){var G=r[A];if(Nj(xs[G].style&tc.ENOTETEXT)){_i.TerRewrap();_i.TerRepaginate(true);break}}}else{var B=Qh;Te=sE[_].TblLevel;gi=sE[_].EmbTable;if(Nj(sE[_].flags&tc.UNDO_TEXT_TO_TABLE))nO|=tc.TOFLAG2_TEXT_TO_TABLE;if(Nj(sE[_].flags&tc.UNDO_DEL_ALL))Qh|=tc.TFLAG3_GET_BUF_HDR_FTR;_i.InsertRtfBuf(Wk(e),v?-2:br,jt,false);Qh=B;nO=_j(nO,tc.TOFLAG2_TEXT_TO_TABLE);Te=1;gi=true;_i.SetTerCursorPos(sE[_].curs,-1,false);if(Nj(sE[_].flags&tc.UNDO_SHOW_HDR_FTR)&&!yR)_i.TerCommand(tc.ID_VIEW_HDR_FTR)}Z_=O;if(Nj(sE[_].flags&tc.UNDO_DEL_PARA_BEF_TABLE)){if(br==0||ui[br-1].cid!=ui[br].cid)ui[br].cid=0;Fo=br;_z(false);cG()}o=tc.CHAR_I;break;case tc.CHAR_F:a=sE[_].fmt;sE[_].fmt=null;z8(_,u,E,T,R);P=0;for(F=u;F<=T;F++){if(ui[F].len==0)continue;if(F==u)L=E;else L=0;if(F==T)C=R;else C=ui[F].len-1;l=nb(F);for(A=L;A<=C;A++,P++)l[A]=a[P];sb(F)}a=null;break;case tc.CHAR_P:i=sE[_].pfmt;d=i[0];S=1;I=0;for(F=u;F<=T;F++){if(Nj(ui[F].flags&tc.LFLAG_PARA_FIRST)||F==u){I=i[S];i[S]=ui[F].pfmt;if(S<d)S++}ui[F].pfmt=I}if(u-1>=0&&u-1<Fo){Fo=u-1;_z(false)}break;case tc.UNDO_ROW_DEL:Te=sE[_].TblLevel;gi=sE[_].EmbTable;e=sE[_].txt;_i.InsertRtfBuf(Wk(e),br,jt,false);Te=1;gi=true;o=tc.UNDO_ROW_INS;_i.TerRepaginate(true);break;case tc.UNDO_ROW_INS:if(t){$8(_,u,T);u=rI;T=iI}uA=tc.HILIGHT_CHAR;sA=u;_A=T;TA=E;AA=R+1;if(AA>=ui[_A].len&&_A+1<Ri&&ui[_A].cid==ui[_A+1].cid){_A++;AA=0}if(sA==_A&&E==R)nO|=tc.TOFLAG2_NO_NORMALIZE_FNOTE;N=tO;Ij(tc.TFLAG6_DEL_CELL_TEXT);GN(false,false);tO=N;nO=_j(nO,tc.TOFLAG2_NO_NORMALIZE_FNOTE);uA=tc.HILIGHT_OFF;o=tc.UNDO_ROW_DEL;_i.TerRepaginate(true);break;case tc.UNDO_FRAME:case tc.UNDO_FRAME_LIMITED:g=sE[_].ObjId;if(g>=0&&g<Kl){var H;var m;var w,b,x;if(sE[_].type==tc.UNDO_FRAME){m=ui;w=Ri;b=xe;x=Lq(br,jt);ui=sE[_].LinePtrU;Ri=sE[_].TotalLinesU;xe=sE[_].MaxLinesU;Cq(sE[_].CursPos,gk("C"));sE[_].LinePtrU=m;sE[_].TotalLinesU=w;sE[_].MaxLinesU=b;sE[_].CursPos=x}H=kl[g].copy();kl[g]=sE[_].pFrame.copy();sE[_].pFrame=H.copy();if(kl[g].pict>0){h=kl[g].pict;if(h>=0&&h<Ys){xs[h].PictWidth=kl[g].width;xs[h].PictHeight=kl[g].height;HN(h,hV(xs[h].PictHeight),dV(xs[h].PictWidth),xs[h].FrameType==tc.PFRAME_NONE?false:true);mN(h)}}_i.TerRepaginate(true)}break;case tc.UNDO_PICT_SIZE:h=sE[_].ObjId;xs[h].PictWidth=WY(xs[h].PictWidth,sE[_].width);sE[_].width=JC;xs[h].PictHeight=WY(xs[h].PictHeight,sE[_].height);sE[_].height=JC;HN(h,hV(xs[h].PictHeight),dV(xs[h].PictWidth),xs[h].FrameType==tc.PFRAME_NONE?false:true);mN(h);_i.TerRepaint(true);_z(true);break;case tc.UNDO_TABLE_ATTRIB:u9(_);break;case tc.UNDO_TAG_INSERT:_i.TerDeleteTag(u,E,sE[_].TagType,sE[_].TagName);o=tc.UNDO_TAG_DELETE;break;case tc.UNDO_TAG_DELETE:Bx(u,E,sE[_].TagType,sE[_].TagName,sE[_].TagText,sE[_].TagInt);o=tc.UNDO_TAG_INSERT;break;case tc.UNDO_LIST_LEVEL:j8(_,u,false);break}sE[_].type=o;if(t)_E--;else _E++}TE=false;if(br>=Ri)br--;if(br-fr>=Dt||br-fr<0)fr=br-Dt/2;if(fr<0)fr=0;we=br-fr;ui[br].flags2=cj(ui[br].flags2,tc.LFLAG2_SPELL_CHECKED);oi.modified++;cO=M;Br=tc.PAINT_WIN;cG();return true}function u9(t){var e,r,i;var f;var l;var a;var n;var c;var s;if(sE[t].RowCount==0||sE[t].CellCount==0)return false;for(e=0;e<sE[t].RowCount;e++){r=sE[t].RowId[e];if($E[r].PrevRow!=sE[t].pRow[e].PrevRow)return false;if($E[r].NextRow!=sE[t].pRow[e].NextRow)return false;if($E[r].FirstCell!=sE[t].pRow[e].FirstCell)return false}for(e=0;e<sE[t].CellCount;e++){i=sE[t].CellId[e];if(eR[i].PrevCell!=sE[t].pCell[e].PrevCell)return false;if(eR[i].NextCell!=sE[t].pCell[e].NextCell)return false}f=sE[t].RowCount;l=sE[t].CellCount;a=[f+1];c=[f+1];n=[l+1];s=[l+1];for(e=0;e<f;e++){r=a[e]=sE[t].RowId[e];c[e]=$E[r].copy()}for(e=0;e<l;e++){i=n[e]=sE[t].CellId[e];s[e]=eR[i].copy()}for(e=0;e<sE[t].RowCount;e++){r=sE[t].RowId[e];$E[r]=sE[t].pRow[e].copy()}for(e=0;e<sE[t].CellCount;e++){i=sE[t].CellId[e];eR[i]=sE[t].pCell[e].copy()}sE[t].RowId=a;sE[t].CellId=n;sE[t].pRow=c;sE[t].pCell=s;_z(true);my(true);return true}function T9(t,e){var r,i,f,l;var a;var n;var c=0;var s;var _=false;var o,u=0;var T,A,E,R,L=br;var C,I,d;var F=false;var g=false,P=false,S=false,h=false;var O;var v=t==0&&e==Ri;var p=false;ZU("WordWrap");if(!oi.WordWrap||Nj(eO&tc.TFLAG7_SKIP_WORD_WRAP))return true;if(t>br)t=br;if(t<0)t=0;if(br>t+e)e=br-t+Dt;if(di&&yn==tc.WRAP_PARA)yn=tc.WRAP_WIN;if(di&&yn==tc.WRAP_MIN)yn=tc.WRAP_PARA;if(yn==tc.WRAP_PAGE)yn=tc.WRAP_WIN;t:{if(yn==tc.WRAP_MIN){if(Br==tc.PAINT_LINE&&jq(br)){Br=tc.PAINT_WIN;p=true}if(Nj(ui[br].tabw)&&Nj(ui[br].tabw.type&(tc.INFO_TAB|tc.INFO_SECT|tc.INFO_PAGE|tc.INFO_ROW|tc.INFO_COL|tc.INFO_FRAME)))break t;if(Nj(ui[br].tabw)&&Nj(ui[br].tabw.CharFlags))break t;if(Nj(ui[br].flags&tc.LFLAG_HDRS_FTRS))break t;if(Nj(ui[br].fid)&&kl[ui[br].fid].TextAngle>0){Br=tc.PAINT_WIN;break t}if(Nj(ui[br].cid)&&eR[ui[br].cid].TextAngle>0){Br=tc.PAINT_WIN;break t}if(Nj(Nc[ui[br].pfmt].flags&tc.PAGE_HDR_FTR)&&ui[br].len>1&&ui[br].height==0)break t;if(kn>0&&ui[br].len>kn)break t;if(oi.PrintView&&ui[br].height==0&&ui[br].len>0)break t;I=M9(br,-1)-Nc[ui[br].pfmt].LeftIndent-Nc[ui[br].pfmt].RightIndent;if(Nj(ui[br].flags&tc.LFLAG_PARA_FIRST))I-=Nc[ui[br].pfmt].FirstIndent;if(Nl>=0&&Nl<Dl)I+=pl[Nl].x;else I+=pl[0].x;if(br==0||Nj(ui[br-1].flags&(tc.LFLAG_PARA|tc.LFLAG_BREAK)))I+=Nc[ui[br].pfmt].FirstIndent;if(ui[br].len>0){if(Nj(ui[br].tabw)&&Nj(ui[br].tabw.type&tc.INFO_JUST)&&oi.PrintView&&cK())F=true;if(F)ui[br].tabw.type=cj(ui[br].tabw.type,tc.INFO_JUST);d=Fq(ui[br].len,br,tc.LEFT);if(F)ui[br].tabw.type|=tc.INFO_JUST;if(d>=I){if(Nj(aO&tc.TOFLAG_INSERT_CHAR)&&Fo>br)Fo=br;break t}}a=ui[br].txt;C=ui[br].len;if(C>0&&xY(qS,a[C-1]))_=true;if(_)break t;if(uA==tc.HILIGHT_OFF&&!p&&(Br==tc.PAINT_WIN||Br==tc.PAINT_PARTIAL_WIN))Br=tc.PAINT_LINE;if(!ho)Fo=Ri;return true}}t:while(true){if(NS)PY("  wrapping..");if(yn==tc.WRAP_MIN)yn=tc.WRAP_PARA;s=oi.modified;f=Ri;O=be==br&&Q==jt;E9();T=jI;A=JI;g=fF;P=lF;S=qg;h=$g;if(yn==tc.WRAP_PARA){t=br;if(br>0&&ui[br-1].len>0){a=ui[br-1].txt;if(a[ui[br-1].len-1]!=Bn)t--}}E=0;if(br>Ri)br=Ri-1;if(Ri>0){for(r=t;r<br;r++){C=ui[r].len;if(Nj(ui[r].flags2&tc.LFLAG2_TEMP_HYPH)&&C>0&&ui[r].txt[C-1]==tc.HYPH_CHAR)C--;E+=C}a=ui[br].txt;if(ui[br].len>0)c=a[ui[br].len-1];if(ui[br].len>0&&jt>=ui[br].len&&c==Bn){E+=ui[br].len+1}else E+=jt+1}if(Ri>0)o=ui[Ri-1].pfmt;else o=tc.DEFAULT_PFMT;e:{if(Nj(po[Lo].flags&tc.PAGE_LINKED_FRAMES)&&Ro!=oi.modified){yJ(false,false,Lo+1,false);break e}i=0;l=Un;while(i<=e||v){if(t+i>=Ri)break;R=Un;C9(t+i,e-i+1);I9(t+i);if(Wn>Un+25||bn==0||Wn+1>=Ri){L9(Wn+1,Un-Wn);Wn=Un}else if(Wn>Un){for(r=Un+1;r<=Wn;r++){dp(r);Ip(r);ui[r].pfmt=0}}if(Un<0)Un=0;l=Un;if(Dj(ui[Un].flags&(tc.LFLAG_PARA|tc.LFLAG_BREAK|tc.LFLAG_LINE))&&Un>t&&Un+1<=Ri&&Un<t+e-1&&Un>R+1)Un--;i=Un-t+1;if(yn==tc.WRAP_PARA&&Un>=br)break}L9(Wn+1,l-Wn)}uo=-1;if(Ri==0){Ri++;br=Ri-1;Ip(br)}br=t;while(br<Ri){C=ui[br].len;if(Nj(ui[br].flags2&tc.LFLAG2_TEMP_HYPH)&&C>0&&ui[br].txt[C-1]==tc.HYPH_CHAR)C--;if(E<=C)break;E-=C;br++}jt=E-1;if(br>=Ri){br=Ri-1;jt+=ui[br].len}a=ui[br].txt;if(ui[br].len>0)c=a[ui[br].len-1];if(ui[br].len>0&&jt>=ui[br].len&&c==Bn){if(br+1>=Ri){jt=ui[br].len-1;if(jt<0)jt=0}else{jt-=ui[br].len;br++}}if(br>=Ri){Ri++;br=Ri-1;Ip(br);ui[br].pfmt=sZ()}if(br==Ri-1){var N=ui[br].pfmt;if(Nj(Nc[N].flags&tc.PAGE_HDR_FTR)||ui[br].fid>0||ui[br].cid>0){Ri++;br=Ri-1;Ip(br);ui[br].fid=0;ui[br].cid=0;ui[br].pfmt=sZ()}}if(ui[br].len==0){Tm(br,0,1);a=ui[br].txt;a[0]=Bn;n=nb(br);n[0]=tc.DEFAULT_CFMT;sb(br);ui[br].pfmt=o;if(br==Ri-1&&(Nj(Nc[o].flags&tc.PAGE_HDR_FTR)||ui[br].fid>0))ui[br].pfmt=sZ()}if(jt>ui[br].len)jt=ui[br].len;if(jt<0)jt=0;we=br-fr;if(we>=Dt&&!oi.PageMode){var D=true;if(Nj(zh&tc.TFLAG_AUTO_VSCROLL_BAR)&&!oi.ShowVerBar&&fr==0){if(D$())D=false}if(D){we=Dt-1;fr=br-we}}oi.modified=s;R9(T,A,g,P,S,h);if(uA!=tc.HILIGHT_OFF&&P&&br==_A+1&&jt==0&&(Nj(ui[br].flags&tc.LFLAG_HDRS_FTRS)||GY(br,tc.INFO_ROW))){Em()}u++;if(!oi.PageMode&&br>0&&OQ(br)&&OQ(br-1)&&u==1){var M="",G="";if(Nj(ui[br].tabw))M=ui[br].tabw.ListText;if(Nj(ui[br-1].tabw))G=ui[br-1].tabw.ListText;if(M==null||M==G)continue t}if(O){be=br;Q=jt}di=false;if(Fo<t)Fo=t;if(Ri!=f&&Br!=tc.PAINT_WIN&&Br!=tc.PAINT_WIN_RESET)Br=tc.PAINT_WIN;if(GY(br,tc.INFO_FRAME)&&Br!=tc.PAINT_WIN&&Br!=tc.PAINT_WIN_RESET)Br=tc.PAINT_WIN;if(Ri!=f&&Nj(aO&tc.TOFLAG_INSERT_CHAR)&&Fo>br-1)Fo=br>0?br-1:br;break}return true}function A9(t){if(!oi.WordWrap||!oi.PrintView||oi.FittedView)return 0;if(t<0||t>=Ri)return 0;if(Nj(Nc[ui[t].pfmt].flags&tc.PAGE_HDR_FTR)){if(t==0)return 0;if(Nj(ui[t-1].flags&(tc.LFLAG_BREAK|tc.LFLAG_PARA)))return 0;if(!Po||go<0)return 0}if(false&&Po&&go>=0){if(Nj(ui[t].tabw)&&Nj(ui[t].tabw.type&tc.INFO_COL)&&go>0)return go-1;else return go}else return ui[t].col}function E9(){var t=0,e=0;var r=false,i=false,f=false,l=false;if(sA>=Ri||_A>=Ri)uA=tc.HILIGHT_OFF;if(uA==tc.HILIGHT_CHAR){f=sA==0&&TA==0&&_A==Ri-1&&AA==ui[_A].len;l=_A==Ri-1&&AA==ui[_A].len;t=Lq(sA,TA);e=Lq(_A,AA);r=oi.WordWrap&&t>e&&TA==ui[sA].len&&nK(sA);i=oi.WordWrap&&e>t&&AA==ui[_A].len&&nK(_A)}jI=t;JI=e;fF=r;lF=i;qg=f;$g=l;return true}function R9(t,e,r,i,f,l){var a,n;if(uA==tc.HILIGHT_CHAR){Cq(t);sA=PC;TA=SC;if(r&&sA>0&&TA==0){sA--;TA=ui[sA].len}Cq(e);_A=PC;AA=SC;if(i){a=AA==0?_A-1:_A;var c=a<Ri&&a>=0?ui[a].cid:0;if(false&&_A==Ri-1&&AA==ui[_A].len-1&&c==0)AA++;else if(_A>0&&AA==0){_A--;AA=ui[_A].len}}if(f){sA=0;TA=0;_A=Ri-1;AA=ui[_A].len}else if(l){_A=Ri-1;AA=ui[_A].len}}return true}function L9(t,e){var r;var i;if(e>0){aO|=tc.TOFLAG_WRAPPING;i=MY(Ri+e);oj(tc.TOFLAG_WRAPPING);if(!i)return false;if(oi.LineLimit>0&&Ri+e>oi.LineLimit)QY(tc.MSG_MAX_LINES_EXCEEDED,"WrapParseBuffer")}if(e==0)return false;Wn=Wn+e;if(e<0){r=-e;while(r>0){if(t<Ri&&Nj(ui[t-r].flags&tc.LFLAG_SOFT_COL))ui[t].flags|=tc.LFLAG_SOFT_COL;if(t<Ri&&Nj(ui[t-r].flags2&tc.LFLAG2_FRAME_TOP))ui[t].flags2|=tc.LFLAG2_FRAME_TOP;dp(t-r);r--}}if(e>0){var f=ui.slice(0,t);var l=ui.slice(t);var a=[];tc.FillArray(a,e,new tc.ClsLinePtr);ui=f.concat(a);ui=ui.concat(l)}else ui.splice(t+e,-e);Ri=Ri+e;if(e>0){for(r=0;r<e;r++)Ip(t+r);if(e==1&&t+1<Ri)ui[t].y=ui[t+1].y}if(Ri<=0){Ri=1;Ip(0)}if(e>0)m5(t-1,e);else m5(t+e,e);return true}function C9(t,e){var r;var i;var f,l;var a=false;var n=0;var c=0,s;wn=[];dc=[];io=0;Lc=Cc=vc=false;uo=-1;wr=tc.FLOW_DEF;Fi=_4();xn=Gn-ft;bn=0;Wn=t;Bc=LR=Vl=Hc=0;if(ui[Wn].len+2e3>=xn)lp(ui[Wn].len+2e3);while(Wn<Ri&&bn+ui[Wn].len<=xn){if(ui[Wn].len>0){r=ui[Wn].txt;if(bn>0&&hj(r[0]))break;if(bn>0&&r[0]==tc.SECT_CHAR&&Wn>0&&Nj(ui[Wn-1].flags&tc.LFLAG_TOC))break;if(!Po&&bn>0&&ui[Wn].fid>0){var _=ui[Wn].fid;if(Vl>0&&_>0&&Vl!=_&&kl[Vl].NextId==_)break}if(ui[Wn].cid>0){if(Wn==0||ui[Wn].cid!=ui[Wn-1].cid)rR[ui[Wn].cid].flags=cj(rR[ui[Wn].cid].flags,tc.CAUX_HAS_LARGE_PICTURE)}i=nb(Wn);l=ui[Wn].len;if(r[l-1]==Bn){c=i[l-1];var o=false;if(xs[c].FieldId==tc.FIELD_DATA&&xs[c].CharWidth[Bn]==0)o=true;if(xs[c].FieldId==tc.FIELD_NAME&&xs[c].CharWidth[Bn]==0)o=true;if(!DE&&!ME&&Nj(xs[c].style&tc.FNOTETEXT)&&xs[c].CharWidth[Bn]==0)o=true;if(!o){var u=false;if(Wn+1<Ri&&ui[Wn+1].cid>0){if(ui[Wn].cid==0)u=true;else if(eR[ui[Wn].cid].level<eR[ui[Wn+1].cid].level)u=true}if(!u){if(Q_&&xs[c].DelRev>0)o=true;else if(xs[c].CharWidth[Bn]==0&&!pE)o=true}}if(Wn+1==Ri)o=false;if(Nj(fO&tc.TFLAG10_SHOW_HIDDEN_PARA)){if(Dj(xs[c].style&tc.FNOTETEXT))o=false}if(o&&!a){var T=ui[Wn].pfmt;var A=Wn+1<Ri?ui[Wn+1].pfmt:T;if(T!=A){var E=Nc[T].StyId;var R=Nc[A].StyId;if(E!=R){if(W_[E].OutlineLevel!=W_[R].OutlineLevel)o=false}if(!a&&Nc[T].BltId>0&&Nc[A].BltId==0)a=true;if(a&&Xb(t,Wn))a=false;if(a)n=T}}if(o){r[l-1]=tc.HPARA_CHAR;Bx(Wn,l-1,tc.TERTAG_HPARA2,"HPARA2","",ui[Wn].pfmt);r=ui[Wn].txt;i=nb(Wn);l=ui[Wn].len}}if(Nj(ui[Wn].flags2&tc.LFLAG2_TEMP_HYPH)&&l>0&&r[l-1]==tc.HYPH_CHAR)l--;if(!vc&&l>0){for(f=0;f<l;f++)if(r[f]>127)break;if(f<l)vc=true}if(false&&bn+l>=wn.length){}wn=wn.concat(r.slice(0,l));dc=dc.concat(i.slice(0,l));if(Dj(ui[Wn].flags2&tc.LFLAG2_SPELL_CHECKED))Fi=false;if(oo){var L=A9(Wn);iV(_o,L,bn,l)}if(Nj(ui[Wn].tag)||Lc){if(!Lc&&bn>0)iV(nc,0,0,bn);Lc=true;if(Nj(ui[Wn].tag))qY(ui[Wn].tag,0,nc,bn,l);else iV(nc,0,bn,l)}bn+=l;if(bn>0&&(wn[bn-1]==TR||wn[bn-1]==tc.ROW_CHAR)){c=dc[bn-1];if(Nj(xs[c].style&tc.HIDDEN)){if(!Y8(Wn))dc[bn-1]=Db(c,tc.HIDDEN,false)}}if(l>1||r[0]!=tc.SECT_CHAR)Bc=ui[Wn].pfmt;LR=ui[Wn].cid;Vl=ui[Wn].fid}Wn++;if(bn>0&&(wn[bn-1]==Bn||wn[bn-1]==TR||wn[bn-1]==tc.PAGE_CHAR||wn[bn-1]==tc.SECT_CHAR))Hc=dc[bn-1];if(bn>1&&wn[bn-1]==tc.SECT_CHAR&&wn[bn-2]==Bn)Hc=dc[bn-2];if(bn>0){if(wn[bn-1]==Bn||wn[bn-1]==TR){if(Wn<Ri&&ui[Wn].len>0){if(e-1<=0)break;r=ui[Wn].txt;if(r[0]!=tc.SECT_CHAR)break;if(r[0]==tc.SECT_CHAR&&Nj(Nc[Bc].pflags&tc.PFLAG_ENDNOTE))break;if(Vl>0||LR>0)break}else break}}if(bn>0){var C=wn[bn-1];if(C==tc.ROW_CHAR||C==tc.PAGE_CHAR||C==tc.COL_CHAR||hj(C))break}if(bn>0&&wn[bn-1]==tc.SECT_CHAR){if(Nj(ui[Wn-1].tabw)&&Nj(ui[Wn-1].tabw.type&tc.INFO_SECT)){io=ui[Wn-1].tabw.section}break}e--;if(e<=0){for(s=Wn;s<Ri;s++){var I=ui[s].txt;var d=ui[s].len;if(Nj(ui[s].flags&tc.LFLAG_SECT))break;for(f=0;f<d;f++){var F=I[f];if(F==Bn||F==TR||F==tc.ROW_CHAR||F==tc.PAGE_CHAR||F==tc.COL_CHAR||hj(F)){Bc=ui[s].pfmt;Hc=ib(s,f);break}}if(f<d)break}break}if(bn>tc.MAX_WIDTH&&wn[bn-1]==tc.SPACE){for(f=bn-1;f>0;f--)if(wn[f]!=tc.SPACE)break;if(bn>f+1e3)bn=f+2}}if(Wn==Ri){if(bn==0||wn[bn-1]!=Bn){if(bn>0&&wn[bn-1]==tc.LINE_CHAR)wn[bn-1]=Bn;else{wn[bn]=Bn;if(Lc)nc[bn]=0;var g=bn>0?dc[bn-1]:0;if(bn==0||Nj(xs[g].style&tc.PICT)||xs[g].FieldId>0)dc[bn]=tc.DEFAULT_CFMT;else dc[bn]=dc[bn-1];bn++}}if(Nj(qh&tc.TFLAG4_MOD_END_MARK_FONT)&&bn>1&&wn[bn-1]==Bn){var P=dc[bn-2];if(Nj(xs[P].style&tc.PICT)||xs[P].FieldId>0)P=dc[bn-1];dc[bn-1]=P}}if(a)Bc=n;Wn--;N9();for(s=t;s<=Wn;s++)ui[s].pfmt=Bc;return true}function I9(t){var e,r,i=0,f,l,a;var n,c;var s,_,o,u,T,A,E;var R=tc.TAB_LEFT,L=0,C,I=0,d=0;var F,g,P,S,h,O=0,v;var p;var N;var D,M=tc.SPACE,G,B;var H=null;var m=new tc.TejTabw;var w;var b=tc.PERIOD,x;var y=0,W=0;var U,k,X,K;var Y=0;var V,j,J,z=0,Z;var Q,q,$,tt;var et,rt;var it,ft,lt;var at;var nt,ct,st;var _t,ot,ut,Tt,At;var Et,Rt,Lt,Ct,It=false;var dt=Nj(Qh&tc.TFLAG3_WRAP_SPACES)?true:false;var Ft,gt,Pt,St,ht,Ot,vt,pt=false,Nt=false,Dt=false;var Mt=null;var Gt,Bt,Ht=0,mt,wt;var bt,xt=0;var yt,Wt,Ut,kt,Xt;var Kt;var Yt=true;var Vt=0,jt=-1;var Jt=[tc.MAX_WIDTH];var zt=false;var Zt;var Qt=new tc.RECT;var qt="";var $t,te=0,ee=0;var re=0,ie=0,fe,le,ae,ne,ce;var se;var _e;var oe=false;var ue,Te=0,Ae=0;var Ee=0;var Re=0,Le=0;if(Nj(zh&tc.TFLAG_SWAP_DECIMAL))b=",";if(Po){$t=iU(Vl);if(kl[$t].NextId!=0&&kl[$t].NextId!=$t)zt=true;if(zt){Vl=B9(Vl,Un);te=xd}}st=Vl>0?kl[Vl].TextAngle:0;if(st==0&&LR>0&&eR[LR].TextAngle!=0)st=eR[LR].TextAngle;wt=eR[LR].row;Wt=Ut=uZ(Nc[Bc].flow,$E[wt].flow,to[io].flow,mr);if(!Wt&&wr==tc.FLOW_RTL&&Nj(eO&tc.TFLAG7_AUTO_SET_RTL)){if(Nj(eO&tc.TFLAG7_AUTO_PARA_RTL)&&Nj(aO&tc.TOFLAG_INSERT_CHAR)&&Nc[Bc].flow==tc.FLOW_DEF){if(cc!=null&&Nj(cc[0]&tc.CWIDTH_RTL))Bc=_Z(Bc,tc.FLOW_RTL)}Wt=true;Br=tc.PAINT_WIN}else if(false&&Wt&&wr!=tc.FLOW_RTL&&Nj(aO&tc.TOFLAG_INSERT_CHAR)){if(Nc[Bc].flow==tc.FLOW_RTL){if(cc==null||Dj(cc[0]&tc.CWIDTH_RTL))Bc=_Z(Bc,tc.FLOW_DEF)}Wt=false;Br=tc.PAINT_WIN}if(oi.PrintView&&!oi.FittedView)it=true;else it=false;if(!oi.PrintView&&kn>0)Y=kn;r=i=0;Un=t-1;uo=oo?_o[0]:0;var Ce=0;for(Ce=t;Ce<Wn;Ce++)if(ui[Ce].len>0)break;if(it)l=G9(Ce,-1,false,LR);else l=G9(Wn,-1,true,LR);a=l;n=Bc;if(n>=Dc)n=Dc-1;if(n<0)n=0;K=Nj(Nc[n].pflags&tc.PFLAG_NO_WRAP);if(Nj(zh&tc.TFLAG_NO_WRAP)&&Dj(oi.PageMode))K=true;var Ie=K;t:while(true){i=r;if(r>=bn)return true;if(jt>=0)n=jt;at=Un;if(at<0)at=0;if(Un+1<Ri&&p9(Un+1))ui[Un+1].flags|=tc.LFLAG_PARA_FIRST;Gt=0;if(OQ(Un+1)){aQ(n,Un+1,Hc,-1,it);Mt=CP;Gt=gI;xt=PI;Ht=FI}if(it&&oo){if(uo!=_o[r]){uo=_o[r];l=a=G9(Un+1,-1,false,LR)}}T=Nc[n].RightIndent;if(Nc[n].flow==tc.FLOW_RTL)T=Nc[n].LeftIndent;if(T<0&&(!oi.PageMode||oi.FittedView))T=0;ot=Nc[n].RightIndentTwips;if(Nc[n].flow==tc.FLOW_RTL)ot=Nc[n].LeftIndentTwips;if(ot<0&&(!oi.PageMode||oi.FittedView))ot=0;_t=Nc[n].LeftIndentTwips;if(Nc[n].flow==tc.FLOW_RTL)_t=Nc[n].RightIndentTwips;ut=Nc[n].FirstIndentTwips;if(Gt>0)ut+=it?MV(Gt):gV(Gt);else if(Nj(Nc[n].flags&tc.BULLET)){var de=Nc[n].BltId;if(Dj(xc[de].flags&tc.BLTFLAG_HIDDEN)){if(ut<0)ut=0;else if(Nj(ui[Un+1].flags&tc.LFLAG_PARA_FIRST)){CB(Ti,Un+1,n,0,0,0,false);ut+=zI}}}if(Un+1==0)_t+=ut;else{if(Nj(ui[at].flags&(tc.LFLAG_PARA|tc.LFLAG_BREAK)))_t+=ut}u=dV(_t);if(it){u=DV(_t);T=DV(ot)}T+=Ee;H=B_[Nc[n].TabId];m=new tc.TejTabw;m.type=tc.INFO_TAB;m.FrameCharPos=-1;Ot=false;Bt=Nc[n].TabId;if(Nj(Bt)&&oi.PageMode&&(Dj(oi.FittedView)||LR>0)&&Vl==0){var Fe;for(Fe=0;Fe<H.count;Fe++){if(DV(H.pos[Fe])>=l-T){Ot=true;break}}}e=r;f=0;ue=-1;A=0;h=0;O=0;o=0;S=0;w=0;et=0;rt=0;U=false;$=-1;tt=-1;q=e;X=false;k=false;D=G=0;ft=false;v=0;Tt=0;At=0;Ft=gt=false;Pt=St=false;ht=false;yt=false;bt=0;Lt=false;Ct=false;pt=false;Dt=false;ee=0;Et=false;Re=0;Le=0;if(Un+1<Ri)v=ui[Un+1].JustAdjX;nt=wW(Un+1,false);p=Q=u;if(Un+1<Ri){if(Wt)ui[Un+1].flags2|=tc.LFLAG2_RTL;else ui[Un+1].flags2=cj(ui[Un+1].flags2,tc.LFLAG2_RTL)}DW(Un+1,Qt);J=HF;z=mF;Z=OF;if(z>0&&wF>0){l=z+wF;if(!it)l=bV(l)}else l=a;if(it){V=J;j=z;m.FrameX=V;m.FrameWidth=j;m.FrameScrWidth=dV(V+j)}else{V=dV(J);j=dV(z);m.FrameX=J;m.FrameWidth=z;m.FrameScrWidth=V+j}if(Nj(Bt)&&oi.PageMode&&LR>0&&H.count==1&&H.type[0]==tc.TAB_DECIMAL){yt=true;O$(n,H,p,!it);s=aI;_=cI;o=s-p;m.width[m.count]=o;m.count++;L=s;R=_;I=0;d=0;U=false;if(Ot&&s>=l-T)K=true}kt=true;while(true){bt=p;Dt=pt;if(false&&Dt){f=0;ue=-1}if(dc[r]!=W||kt){W=dc[r];if(xs[W].ParaStyId==Nc[n].StyId)y=W;else y=xZ(W,Nc[n].StyId);if(xs[y].TextAngle!=st)y=mb(y,st);kt=false}Kt=xs[y].style;if(Nj(Kt&tc.SCAPS)){if(sk(wn[r])&&Dj(xs[y].flags&tc.FFLAG_SCAPS))y=wb(y,true);if(!sk(wn[r])&&Nj(xs[y].flags&tc.FFLAG_SCAPS))y=wb(y,false);Kt=xs[y].style}dc[r]=y;if(xs[y].StoryIds!=null&&xs[y].StoryIds.length>0)ty(xs[y].StoryIds,Un+1,bt);if(Nj(xs[y].InsRev))rt|=tc.LFLAG2_INS_REV;if(Nj(xs[y].DelRev))rt|=tc.LFLAG2_DEL_REV;if(Nj(xs[y].style&tc.LEFT_LINE))rt|=tc.LFLAG2_LEFT_LINE;if(Cc&&Nj(cc[r]&tc.CWIDTH_USED)){mt=(cc[r]&tc.CWIDTH_WIDTH)/tc.CWIDTH_FACTOR}else mt=-1;if(mt!=-1){if(Dj(xs[y].flags&tc.FFLAG_HIDDEN_INFO)){if(!DE&&Nj(xs[y].style&tc.FNOTETEXT))mt=0;if(!ME&&Nj(xs[y].style&tc.ENOTETEXT))mt=0}if(xs[y].CharWidth[tc.CHAR_A]==0)mt=0}gt=Ft;Ft=false;G=D;D=B=wn[r];if(Nj(Kt&(tc.SCAPS|tc.CAPS))&&sk(B))B=ok(B);if(D==tc.HPARA_CHAR){var ge=Yt&&pE&&Nj(xs[y].style&tc.HIDDEN);var Pe=(xs[y].FieldId==tc.FIELD_DATA||xs[y].FieldId==tc.FIELD_NAME)&&xs[y].CharWidth[Bn]!=0;var Se=Nj(xs[y].style&tc.FNOTETEXT)&&xs[y].CharWidth[Bn]!=0;var he=!Q_&&xs[y].DelRev>0&&xs[y].CharWidth[Bn]!=0;var Oe,ve=-1;if(Lc&&nc[r]>0){var pe=nc[r];if(ge&&Vx(pe,-1,tc.TERTAG_HPARA)>0)ve=WC;if(ge&&ve<0&&Vx(pe,-1,tc.TERTAG_HPARA2)>0)ve=WC;if(Pe&&Vx(pe,-1,tc.TERTAG_HPARA2)>0)ve=WC;if(Se&&Vx(pe,-1,tc.TERTAG_HPARA2)>0)ve=WC;if(he&&Vx(pe,-1,tc.TERTAG_HPARA2)>0)ve=WC;if(ve>=0){wn[r]=D=Bn;jt=n;n=ve}}}if(G!=tc.SPACE&&!gt&&D==tc.SPACE)Tt=0;else if(Dt&&!gt)Tt=0;if(r+1<bn&&wn[r+1]==tc.SECT_CHAR)lt=true;else lt=false;ct=xs[y].FieldId;if($<0&&ct>0&&Iw(ct))$=r;if(ct==tc.FIELD_TOC)Pt=true;else if(ct==tc.FIELD_LISTNUM)St=true;else if(ct==tc.FIELD_AUTONUMLGL)ht=true;else if(ct==tc.FIELD_TC)rt|=tc.LFLAG2_TC;else if(ct==tc.FIELD_SEQ)rt|=tc.LFLAG2_SEQ;if(Nj(xs[y].style&tc.PICT)){xs[y].InCellId=LR;xs[y].InParaFID=Vl;if(xs[y].PctWidth>0&&(LR>0||Vl>0)){re=LR>0?eR[LR].width-x6(LR)-y6(LR):kl[Vl].width-2*kl[Vl].margin;re=Mj(re,xs[y].PctWidth,100);if(re!=xs[y].PictWidth){xs[y].PictWidth=re;HN(y,hV(xs[y].PictHeight),dV(xs[y].PictWidth),true);mN(y)}}if(LR>0){var Ne=eR[LR].width-x6(LR)-y6(LR);if(xs[y].PictWidth>Ne)rR[LR].flags|=tc.CAUX_HAS_LARGE_PICTURE}}if(Nj(xs[y].style&tc.PICT)&&(xs[y].PictType==tc.PICT_CONTROL||xs[y].PictType==tc.PICT_FORM||xs[y].ObjectType==tc.OBJ_OCX))tt=r;It=Et;Et=Nj(xs[y].style&tc.PICT)&&xs[y].ParaFID>0;if(Et)et|=tc.LFLAG_PICT;if(Et){ae=xs[y].ParaFID;if(kl[ae].pict>0)rt|=tc.LFLAG2_PICT_TEXT;Rt=Nj(kl[ae].flags2&tc.PF2_INLINE)}else Rt=false;Ct=Lt;Lt=Et&&fW(xs[y].ParaFID);if(Ct)rt|=tc.LFLAG2_SPACE_TAKING_FRAME;if(Nj(xs[y].style&(tc.FNOTE|tc.FNOTETEXT|tc.FNOTEREST)))et|=tc.LFLAG_FNOTE;if(Nj(xs[y].style&tc.ENOTETEXT))rt|=tc.LFLAG2_ENOTETEXT;else if(Nj(xs[y].style&tc.FNOTETEXT))et|=tc.LFLAG_FNOTETEXT;if(xs[y].CharStyId>0){var De=xs[y].CharStyId;if(De>1&&De<X_&&W_[De].link>0)rt|=tc.LFLAG2_HAS_LINKED_STYLE}if(oo&&r+1<bn&&uo!=_o[r+1]){r++;break}if(D==Bn&&r+1<bn&&!lt){r++;break}if(D==TR||D==tc.LINE_CHAR){r++;w=D;break}if(D==tc.SECT_CHAR){r++;w=D;break}if(D<=tc.LAST_CTRL_CHAR&&(D==tc.ROW_CHAR||hj(D)||D==tc.PAGE_CHAR||D==tc.COL_CHAR)){if(e==r){r++;w=D}break}if(D==tc.TAB&&!um(y)){var Me=p;if(m.count>0&&R!=tc.TAB_LEFT){if(R!=tc.TAB_RIGHT)At=0;C=L-(p-At);if(R==tc.TAB_CENTER)C+=I/2;else if(R==tc.TAB_DECIMAL)C+=I;if(C<0)C=0;p+=C;m.width[m.count-1]=C}if(Q+v<V+j&&p+v>=V&&j>0){ie=p-Q;fe=0;m.FrameCharPos=q-e;if(Q+v>V)fe=Q+v-V;if(it){m.FrameX=V+fe;m.FrameWidth=j-fe;m.FrameScrWidth=bV(V+j-Q);m.FrameSpaceWidth=V+j-Q-fe}else{m.FrameX=J+wV(fe);m.FrameWidth=z-wV(fe);m.FrameScrWidth=V+j-Q;m.FrameSpaceWidth=V+j-Q-fe}Q=V+j;p=Q+ie;if(p>l-T){r=q;p=Q;continue}}O$(n,H,p,!it);s=aI;_=cI;if(Vl>0&&s>l){s=l-1;if(s<p)s=p}o=s-p;if(o<0)o=0;m.width[m.count]=o;if(m.count<tc.TE_MAX_TAB_STOPS)m.count++;if(_==tc.TAB_LEFT)p=s;L=s;R=_;I=0;d=0;At=0;U=false;if(Ot&&s>=l-T){var Ge=s-(l-T);var Be=it?DV(900):dV(900);if(Ge>Be)K=true;else if(l>s)Ee=-(l-s)}if(!K&&(p>l-T+Vt&&Dj(Y))){f=r;S=Me;if(r>0)M=wn[r-1]}}else{if(D!=Bn&&(!Et||Rt)){re=mt;if(re==-1)re=Gx(y,!it,B);if(B==tc.HYPH_CHAR)re=0;if(D==tc.SPACE&&Qi&&Nq(y)&&re!=0){if(it)re=DV(xs[y].TwipsSize-1)/2;else re=dV(xs[y].TwipsSize-1)/2}else if(D==tc.SPACE&&(G==tc.SPACE||r==e)&&Qi&&re!=0&&!Nq(y)){if(it)re=DV(xs[y].TwipsSize)/2;else re=dV(xs[y].TwipsSize)/2}p=p+re;if(D==tc.SPACE){Tt+=re;At+=re}else At=0;if(re==0)Ft=true}if(!Ft&&F9(D,y))Le++;if(!k&&Nj(xs[y].style&tc.CHAR_BOX)||k&&Dj(xs[y].style&tc.CHAR_BOX)){k=!k;if(k)X=true;if(it)p+=xh;else p+=yh}if(Q+v<V+j&&p+v>=V&&j>0){ie=p-Q;fe=0;if(q==e){var He=l-(V+j);var me=V;if(me>He){q=r;Q=V-v}}m.FrameCharPos=q-e;if(Q+v>V)fe=Q+v-V;if(it){m.FrameX=V+fe;m.FrameWidth=j-fe;m.FrameScrWidth=bV(V+j-Q);m.FrameSpaceWidth=V+j-Q-fe}else{m.FrameX=J+wV(fe);m.FrameWidth=z-wV(fe);m.FrameScrWidth=V+j-Q;m.FrameSpaceWidth=V+j-Q-fe}Q=V+j;p=Q+ie;if(p>l-T){r=q;p=Q;continue}}if(D==b&&!Ft)U=true;if(R==tc.TAB_CENTER||R==tc.TAB_DECIMAL&&U){if(D!=Bn){re=mt;if(re==-1)re=Gx(y,!it,B);I=I+re;d=d+Gx(y,true,D)}}}if(D==tc.NBSPACE_CHAR)et|=tc.LFLAG_NBSPACE;if(D==tc.NBDASH_CHAR)et|=tc.LFLAG_NBDASH;if(D==tc.HYPH_CHAR)et|=tc.LFLAG_HYPH;if(D==tc.HPARA_CHAR)et|=tc.LFLAG_HPARA;if(D==tc.HIDDEN_CHAR)rt|=tc.LFLAG2_HIDDEN_CHAR;Xt=dt;if(Wt&&Dj(xs[y].rtl))Xt=true;if(Vl>0&&it&&r+2==bn&&wn[r+1]==Bn)Vt=Ai/30;if(r>=f&&r-f<tc.MAX_WIDTH)Jt[r-f]=p-bt;oe=false;if(p>l-T+Vt&&LR==0&&Vl>0){if(D!=Bn&&D!=TR&&D!=tc.PICT_CHAR&&r+1<bn){if(wn[r+1]==Bn||wn[r+1]==TR)oe=true}}if(!oe&&LR>0&&p>=l-T+Vt&&Le>10){var we=DV(tc.RULER_TOLERANCE);var be=y6(LR);be=DV(be);if(we>be)we=be;we+=wV(2);if(p<=l-T+Vt+we||D==tc.SPACE){if(D!=Bn&&D!=TR&&D!=tc.PICT_CHAR&&r+1<bn){if(wn[r+1]==Bn||wn[r+1]==TR||wn[r+1]==tc.SPACE)oe=true}}}if(oe&&Re==0)Re=p-(l-T+Vt);if((K||Ft||It||oe||Dt&&D==tc.SPACE||p<=l-T+Vt&&Dj(Y)||oi.PrintView&&(D==tc.SPACE||D==tc.NBSPACE_CHAR||D==tc.TAB&&Ot)&&!Xt||oi.PrintView&&D==Bn&&(G==tc.SPACE||G==tc.TAB||gt)||Nj(Y)&&r-e<Y)&&(!Lt&&!Ct)){r++;if(D==Bn){ft=lt;if(ft)r++;break}if(r>=bn)break;vt=D==tc.HYPH&&xs[y].CharSet!=2&&(Mi||Nj(rO&tc.TFLAG8_WRAP_ON_HYPHEN));pt=false;Nt=false;if(D>11776){var xe=D;pt=xe>=11776&&xe<=40879||xe>=63744&&xe<64255||xe>=65072&&xe<65103||xe>=65280&&xe<65519;if(!pt){pt=xe>=19968&&xe<=43007}if(pt)rt|=tc.LFLAG2_HAS_ASIAN;Nt=xe>=12593&&xe<=12643||xe>=44032&&xe<=55215}var ye=false;if(pt){if(r<bn){var We=wn[r];ye=We==tc.COMMA||We==65292||We==12290||We==65307||We==12289||We==65306||We==65311||We==65281}}var Ue=true;if(D==tc.SPACE){for(F=r;F<bn;F++){le=dc[F];if(xs[le].FieldId==tc.FIELD_NAME)continue;if(wn[F]==tc.SPACE)continue;if(wn[F]==tc.NBSPACE_CHAR)Ue=false;break}if(Ue){for(F=r-1;F>=0;F--){le=dc[F];if(xs[le].FieldId==tc.FIELD_NAME)continue;if(wn[F]==tc.SPACE)continue;if(wn[F]==tc.NBSPACE_CHAR)Ue=false;break}}}if(D==tc.SPACE&&Ue||D==tc.TAB||vt||D==tc.HYPH_CHAR||D==tc.HIDDEN_CHAR||pt&&!ye&&!Nt){var ke=(pE||Dj(xs[y].style&tc.HIDDEN))&&(NE||xs[y].FieldId!=tc.FIELD_NAME)&&(!NE||xs[y].FieldId!=tc.FIELD_DATA);if(ke){if(G!=tc.SPACE){ue=f;Te=p;Ae=A}f=r;S=p;if(D==tc.TAB&&Nj(Nc[n].flags&tc.JUSTIFY)&&!um(y)){O=h;h=A}if((D==tc.SPACE||pt)&&Nj(Nc[n].flags&tc.JUSTIFY)&&!um(y))A++;M=D;Q=p;q=r}}}else{if(f==0&&r==e||f==0&&D==Bn&&r>e&&wn[r-1]!=Bn){r++;if(r>=bn)break}else{if(f!=0){if(G==tc.SPACE&&ue>0&&D==tc.COMMA){f=ue;S=Te;A=Ae}if(false&&KL){var Xe=0,Ke=0;if(Xe>0){f+=Xe;S+=Ke;M=wn[f-1];Tt=0;rt|=tc.LFLAG2_TEMP_HYPH;et|=tc.LFLAG_HYPH}}r=f;if(r>e+1&&M==tc.TAB&&R==tc.TAB_LEFT&&m.count>0){f--;r--;m.count--;M=wn[r-1];S-=o;h=O}p=S;if(M==tc.SPACE||Dt)A--;D=M}if(r==e)r=e+1;break}}}if((true||D==Bn||D==TR||w!=0)&&m.count>0&&R!=tc.TAB_LEFT){if(R!=tc.TAB_RIGHT)At=0;C=L-(p-At);if(I<0)I=0;if(R==tc.TAB_CENTER)C+=I/2;else if(R==tc.TAB_DECIMAL)C+=I;if(C<0)C=0;p+=C;if(LR>0){var Ye=p;var Ve=eR[LR].width-x6(LR);if(it)Ve=DV(Ve);else Ve=dV(Ve);if(p>Ve&&C>0){C-=p-Ve;if(C<0)C=0;p=Ye+C}}m.width[m.count-1]=C}if(D==Bn||w!=0){ee=Gx(y,!it,D);p+=ee;if(ft)p+=Gx(y,!it,tc.SECT_CHAR)}if(D==tc.HYPH_CHAR){p+=Gx(y,!it,tc.HYPH)}Un++;if(Un>Wn){if(!L9(Wn+1,Mn)){Un--;return true}}d9(e,r,D,rt);ui[Un].pfmt=n;ui[Un].cid=LR;ui[Un].fid=Vl;ui[Un].col=uo;xx(Un);if(Un==Ri-1&&r==bn)ui[Un].cid=0;if(LR>0&&w==TR){var je;var Je=um(y);for(je=Un;je>=0;je--){if(ui[je].cid==0||eR[ui[je].cid].level==eR[LR].level&&ui[je].cid!=LR)break;if(ui[je].height>0){Je=false;break}}if(Je)rR[LR].flags|=tc.CAUX_HIDDEN;else rR[LR].flags=cj(rR[LR].flags,tc.CAUX_HIDDEN);rR[LR].flags=cj(rR[LR].flags,tc.CAUX_EMPTY_CELL);if(ui[Un].len==1&&(Un==0||ui[Un-1].cid!=LR)){ce=0;if(Un>0)ce=ui[Un-1].cid;if(ce==0||eR[ce].ParentCell!=LR){var ze=c8(LR)>0;if(ze)rR[LR].flags|=tc.CAUX_EMPTY_CELL}}}at=Un-1;if(at<0)at=0;ui[Un].flags=et|ui[Un].flags&tc.LFLAG_SOFT_COL;ui[Un].flags2=rt|ui[Un].flags2&tc.LFLAG2_FRAME_TOP;if(D==Bn||D==TR)ui[Un].flags|=tc.LFLAG_PARA;if(w==tc.LINE_CHAR)ui[Un].flags|=tc.LFLAG_LINE;else if(w!=0)ui[Un].flags|=tc.LFLAG_BREAK;if(Nj(w))X5(Un,w);if(ft||w==tc.SECT_CHAR)ui[Un].flags|=tc.LFLAG_SECT;if(Pt)ui[Un].flags|=tc.LFLAG_TOC;if(St)ui[Un].flags|=tc.LFLAG_LISTNUM;if(ht)ui[Un].flags|=tc.LFLAG_AUTONUMLGL;if(p9(Un))ui[Un].flags|=tc.LFLAG_PARA_FIRST;if(Gt>0)ui[Un].flags|=tc.LFLAG_LIST;if(tt>=0&&tt<r)ui[Un].flags|=tc.LFLAG_CONTROL;if(Li&&Nc[n].AuxId>0&&BK(n))ui[Un].flags|=tc.LFLAG_HTML_RULE;if(yt)ui[Un].flags|=tc.LFLAG_ASSUMED_TAB;if(Nj(Nc[n].flags&tc.PARA_BOX_TOP)&&Nj(ui[Un].flags&tc.LFLAG_PARA_FIRST)){ae=ui[Un].fid;se=ae==0||Nj(kl[ae].flags&tc.PARA_FRAME_TEXT_BOX);if(se){if(Un==0||!IZ(Un-1,Un))ui[Un].flags|=tc.LFLAG_BOX_TOP}}if(Nj(Nc[n].flags&tc.PARA_BOX_BOT)&&Nj(ui[Un].flags&(tc.LFLAG_PARA|tc.LFLAG_BREAK))){ae=ui[Un].fid;se=ae==0||Nj(kl[ae].flags&tc.PARA_FRAME_TEXT_BOX);if(se){if(Un>=Ri-1||!IZ(Un+1,Un))ui[Un].flags|=tc.LFLAG_BOX_BOT}}if(Nj(Nc[n].flags&tc.PARA_BOX_BETWEEN)&&Nj(ui[Un].flags&(tc.LFLAG_PARA|tc.LFLAG_BREAK))&&ui[Un].fid==0){if(Un<Ri-1&&IZ(Un+1,Un)){if(Dj(ui[Un].flags&tc.LFLAG_BOX_BOT))ui[Un].flags2|=tc.LFLAG2_BOX_BETWEEN}}if((Nc[n].shading>0||!MJ(Nc[n].BkColor,tc.CLR_WHITE))&&Nj(ui[Un].flags&tc.LFLAG_PARA_FIRST)){if(Un==0||!dZ(Un-1,Un))ui[Un].flags2|=tc.LFLAG2_SHADE_BEGIN}if((Nc[n].shading>0||!MJ(Nc[n].BkColor,tc.CLR_WHITE))&&Nj(ui[Un].flags&(tc.LFLAG_PARA|tc.LFLAG_BREAK))){if(Un>=Ri-1||!dZ(Un+1,Un))ui[Un].flags2|=tc.LFLAG2_SHADE_END}if(Fi)ui[Un].flags2|=tc.LFLAG2_SPELL_CHECKED;if(Wt)ui[Un].flags2|=tc.LFLAG2_RTL;if(Ut)ui[Un].flags2|=tc.LFLAG2_PARA_RTL;E=l-T-p;if(!Wt&&D==tc.SPACE)E+=Tt;if(m.count>0||j>0||X||w!=0||ft||Nj(Nc[n].flags&tc.JUSTIFY)||E>0||Gt>0||Re>0||$>=0&&$<r||nt>0){var Ze;ui[Un].tabw=m;ui[Un].tabw.type=ui[Un].tabw.type&~(tc.INFO_SECT|tc.INFO_PAGE|tc.INFO_CELL|tc.INFO_ROW|tc.INFO_COL|tc.INFO_JUST|tc.INFO_ALT_JUST|tc.INFO_FRAME|tc.INFO_DYN_FIELD|tc.INFO_FRM_SPC_BEF);if(ui[Un].tabw.count==0)ui[Un].tabw.type=cj(ui[Un].tabw.type,tc.INFO_TAB);ui[Un].tabw.JustCount=ui[Un].tabw.JustAdj=0;Ze=ui[Un].tabw.type;if(w!=0||ft){if(w==tc.SECT_CHAR||ft)ui[Un].tabw.type=Ze|tc.INFO_SECT;if(w==tc.PAGE_CHAR)ui[Un].tabw.type=Ze|tc.INFO_PAGE;if(w==tc.COL_CHAR)ui[Un].tabw.type=Ze|tc.INFO_COL;if((w==tc.PAGE_CHAR||w==tc.COL_CHAR)&&Un>0&&ui[Un-1].tabw!=null&&Nj(ui[Un-1].tabw.type&tc.INFO_JUST)){ui[Un-1].tabw.type=cj(ui[Un-1].tabw.type,tc.INFO_JUST);ui[Un-1].tabw.JustCount=0}if(w==TR)ui[Un].tabw.type=Ze|tc.INFO_CELL;if(w==tc.ROW_CHAR)ui[Un].tabw.type=Ze|tc.INFO_ROW;if(w!=TR&&w!=tc.LINE_CHAR&&w!=tc.SECT_CHAR&&!ft)ui[Un].tabw.count=0;ui[Un].tabw.section=io}if(j>0&&oi.PrintView){ui[Un].tabw.type|=tc.INFO_FRAME;if(ui[Un].tabw.FrameCharPos==-1&&(w!=0||D==Bn||D==tc.LINE_CHAR))ui[Un].tabw.FrameCharPos=ui[Un].len}if($>=0&&$<r)ui[Un].tabw.type|=tc.INFO_DYN_FIELD;if(nt>0){ui[Un].tabw.type|=tc.INFO_FRM_SPC_BEF;ui[Un].tabw.height=nt}if(Gt>0){ui[Un].tabw.ListText=Mt;ui[Un].tabw.ListTextWidth=Gt;ui[Un].tabw.ListFontId=Ht;ui[Un].tabw.ListNbr=xt}if(Nj(Nc[n].flags&tc.JUSTIFY)||E<0||Re>0){var Qe=Dj(ui[Un].tabw.type&tc.INFO_FRAME);if(!Qe&&ui[Un].tabw.FrameX==0)Qe=true;if(!Qe&&(ui[Un].tabw.FrameCharPos>=ui[Un].len||ui[Un].tabw.FrameX>l-T)){var qe=l-T<ui[Un].tabw.FrameX?l-T:ui[Un].tabw.FrameX;E=qe-p;Qe=true}if(Qe||Re>0){var $e=A-h;if(w==tc.LINE_CHAR&&$i){c=ui[Un].len;_e=ui[Un].txt;if(c-2>=0&&_e[c-2]==tc.SPACE)E+=Tt;for(ne=c-2;ne>=0&&_e[ne]==tc.SPACE;ne--)A--;$e=A-h;E+=ee*3/4}var tr=false,er=false;if(Nj(Nc[n].flags&tc.JUSTIFY)&&Nj(Nc[n].flags&tc.JUSTIFY_DIST))er=true;if(Nj(ui[Un].flags2&tc.LFLAG2_HAS_ASIAN)&&D!=Bn&&(w!=tc.LINE_CHAR||$i))tr=true;if(Re>0){_e=ui[Un].txt;N=nb(Un);c=ui[Un].len;A=h=0;var rr=[];for(ne=0;ne<c;ne++)rr[ne]=false;for(;c>0;c--)if(_e[c-1]!=Bn&&_e[c-1]!=tc.LINE_CHAR&&_e[c-1]!=" "&&_e[c-1]!=tc.TAB)break;for(ne=1;ne<c;ne++){x=_e[ne];if(um(N[ne]))continue;if(!F9(x,N[ne]))continue;A++;rr[ne-1]=true}E=Re;if(E>0&&A>0){ui[Un].tabw.type|=tc.INFO_ALT_JUST|tc.INFO_NEG_JUST;ui[Un].tabw.JustAdj=E/A;ui[Un].tabw.JustCount=0;ui[Un].tabw.JustSpaceCount=A;ui[Un].tabw.JustSpaceIgnore=0;if(ui[Un].tabw.CharFlags==null)bX(Un);for(ne=0;ne<c;ne++)if(rr[ne])ui[Un].tabw.CharFlags[ne]|=tc.BFLAG_JUST_SPACE}}else if(tr||er){_e=ui[Un].txt;N=nb(Un);var ir=false,fr=false;c=ui[Un].len;A=h=0;var lr=[];for(ne=0;ne<c;ne++)lr[ne]=false;for(;c>0;c--)if(_e[c-1]!=Bn&&_e[c-1]!=tc.LINE_CHAR&&_e[c-1]!=tc.SPACE&&_e[c-1]!=tc.TAB)break;for(ne=0;ne<c;ne++){x=_e[ne];if(um(N[ne]))continue;fr=h9(x,N[ne]);if(ne==0){ir=fr;continue}if(ir&&_e[ne]!=tc.SPACE||_e[ne-1]==tc.SPACE||fr&&_e[ne-1]!=tc.SPACE||er){A++;lr[ne-1]=true}else if(_e[ne-1]==tc.SPACE){A++;lr[ne-1]=true}ir=fr}if(E>0&&A>0&&D!=Bn&&(w!=tc.LINE_CHAR||$i||Qi)&&(w==0||w==tc.LINE_CHAR&&!Li)){ui[Un].tabw.type|=tc.INFO_ALT_JUST;ui[Un].tabw.JustAdj=E/A;ui[Un].tabw.JustCount=0;ui[Un].tabw.JustSpaceCount=A;ui[Un].tabw.JustSpaceIgnore=0;if(ui[Un].tabw.CharFlags==null)bX(Un);for(ne=0;ne<c;ne++)if(lr[ne])ui[Un].tabw.CharFlags[ne]|=tc.BFLAG_JUST_SPACE}}else{if(E>0&&$e>0&&D!=Bn&&(w!=tc.LINE_CHAR||$i)&&(w==0||w==tc.LINE_CHAR&&!Li)){ui[Un].tabw.type|=tc.INFO_JUST;ui[Un].tabw.JustAdj=E/$e;ui[Un].tabw.JustCount=0;ui[Un].tabw.JustSpaceCount=A;ui[Un].tabw.JustSpaceIgnore=h}}}}if(X){var ar;bX(Un);k=false;N=ui[Un].fmt;_e=ui[Un].txt;ar=ui[Un].len;if(Nj(ui[Un].flags&(tc.LFLAG_PARA|tc.LFLAG_BREAK)))ar--;for(ne=ar-1;ne>=0;ne--)if(_e[ne]!=tc.SPACE||xs[N[ne]].FieldId==tc.FIELD_TEXTBOX)break;ar=ne+1;for(ne=0;ne<ar;ne++){if(!k&&Nj(xs[N[ne]].style&tc.CHAR_BOX)){ui[Un].tabw.CharFlags[ne]|=tc.BFLAG_BOX_FIRST;k=true}else if(k&&Dj(xs[N[ne]].style&tc.CHAR_BOX)){ui[Un].tabw.CharFlags[ne-1]|=tc.BFLAG_BOX_LAST;k=false}}if(k)ui[Un].tabw.CharFlags[ne-1]|=tc.BFLAG_BOX_LAST}}else if(Nj(ui[Un].tabw))yX(Un);if(St||Nj(ui[Un].flags&tc.LFLAG_HPARA))AQ(Un,it);if(ht)TQ(Un,it);if(Nj(ui[Un].tabw)&&Nj(ui[Un].tabw.type&(tc.INFO_ROW|tc.INFO_PAGE|tc.INFO_COL))){ui[Un].flags=cj(ui[Un].flags,tc.LFLAG_BOX_TOP|tc.LFLAG_BOX_BOT);ui[Un].flags2=cj(ui[Un].flags2,tc.LFLAG2_BOX_BETWEEN)}if(Vl>0&&!Eu&&Dj(kl[Vl].flags&(tc.PARA_FRAME_LINE|tc.PARA_FRAME_RECT))){ae=Vl;var nr=ui[Un].len;var cr=ib(Un,0);if(xs[cr].ParaFID==0){c=xs[cr].PictWidth;if(nr==1||nr==2&&Nj(ui[Un].flags&(tc.LFLAG_PARA|tc.LFLAG_BREAK))){if(Nj(xs[cr].style&tc.PICT)&&c>kl[ae].width-2*kl[ae].margin)kl[ae].width=c+2*kl[ae].margin}}}_b(Un);if(oi.PrintView){var sr,_r,or,ur,Tr=0;var Ar=0,Er=0,Rr=0,Lr,Cr=0,Ir=0,dr;var Fr=false,gr=false;var Pr=false;var Sr=false;g=P=ur=0;if(ui[Un].len==1&&w==TR){if(Nj(Qh&tc.TFLAG3_ZERO_CELL_HEIGHT))Pr=true;else if(Un>0){var hr=ui[Un].cid;var Or=eR[hr].level;ce=ui[Un-1].cid;if(hr!=ce&&hr==E6(Or,-ce))Pr=true;if(Nj(eR[hr].flags&tc.CFLAG_ADDED_CELL))Pr=true}}if(ui[Un].len==1&&w==tc.LINE_CHAR){if(ui[Un].fmt==null)_r=ui[Un].UniFmt;else{N=ui[Un].fmt;_r=N[0]}if(xs[_r].CharId>0)Pr=true}if(ui[Un].fmt==null){_r=ui[Un].UniFmt;g=Xs[_r].BaseHeight;Tr=P=Xs[_r].height-Xs[_r].BaseHeight-Xs[_r].ExtLead;if(Xs[_r].OffsetVal>0)P-=Xs[_r].OffsetVal;Lr=Math.abs(Xs[_r].OffsetVal);ur=Xs[_r].ExtLead;if(Xs[_r].OffsetVal==0)Sr=true;else if(Xs[_r].OffsetVal>0)Ir=Xs[_r].OffsetVal;else if(Xs[_r].OffsetVal<0)Cr=-Xs[_r].OffsetVal;if(Nj(Qh&tc.TFLAG3_ZERO_CELL_HEIGHT)&&ui[Un].cid>0&&Nj(xs[_r].style&tc.HIDDEN))Pr=true}else{var vr=false;N=ui[Un].fmt;_e=ui[Un].txt;c=ui[Un].len;if(Pr){c=0;gr=true}if(c>1&&Nj(ui[Un].flags&(tc.LFLAG_PARA|tc.LFLAG_LINE))){Rr=N[c-1];c--;gr=true;if(c>0&&Nj(ui[Un].flags&tc.LFLAG_PICT)){for(F=0;F<c;F++)if(Dj(xs[N[F]].style&tc.PICT)||xs[N[F]].ParaFID==0)break;if(F==c)c++}}else if(c==1&&Nj(ui[Un].flags&(tc.LFLAG_PARA|tc.LFLAG_LINE)))Rr=N[0];for(F=0;F<c;F++){_r=N[F];if(!Fr&&(_e[F]==tc.SPACE||_e[F]==tc.TAB)&&Xs[_r].height>0&&xs[_r].FieldId==0)Fr=true;if((_e[F]==tc.SPACE||_e[F]==tc.TAB)&&(F<c||vr)&&xs[_r].FieldId==0)continue;if((_e[F]==Bn||_e[F]==TR||_e[F]==tc.SECT_CHAR)&&(F<c-1||vr)&&xs[_r].FieldId==0)continue;if(Nj(Qh&tc.TFLAG3_ZERO_CELL_HEIGHT)&&ui[Un].cid>0&&Nj(xs[_r].style&tc.HIDDEN))continue;if(Nj(xs[_r].style&tc.PICT)&&xs[_r].ParaFID>0){ae=xs[_r].ParaFID;if(F==0&&Nj(ui[Un].flags2&tc.LFLAG2_SPACE_TAKING_FRAME)){g=it?mV(kl[ae].height):hV(kl[ae].height);or=dr=ur=P=Lr=0;continue}else{Rt=ae<Kl&&Nj(kl[ae].flags2&tc.PF2_INLINE);if(!Rt)continue}}var pr=Xs[_r].BaseHeight;if(pr>g)g=pr;or=Xs[_r].height-pr;if(or>P)P=or;if(Xs[_r].OffsetVal==0&&Dj(xs[_r].style&(tc.SUBSCR|tc.SUPSCR)))Sr=true;else if(Xs[_r].OffsetVal>0&&Xs[_r].OffsetVal>Ir)Ir=Xs[_r].OffsetVal;else if(Xs[_r].OffsetVal<0){if(Cr==0)Cr=-Xs[_r].OffsetVal;else if(-Xs[_r].OffsetVal<Cr)Cr=-Xs[_r].OffsetVal}vr=true}if(Nj(Qh&tc.TFLAG3_ZERO_CELL_HEIGHT)&&ui[Un].cid>0&&!vr)Pr=true}if(P<0)P=0;sr=g+P+ur;if(sr<Xs[Rr].height){var Nr=ui[Un].len;N=nb(Un);if(Nj(ui[Un].flags&(tc.LFLAG_PARA|tc.LFLAG_LINE)))Nr--;for(F=0;F<Nr;F++){if(Dj(xs[N[F]].style&tc.PICT))break}if(F==Nr){sr=Xs[Rr].height;g=Xs[Rr].BaseHeight;P=sr-g}}if(sr==0&&(Fr||gr)){sr=Xs[Rr].height+Xs[Rr].ExtLead;g=Xs[Rr].BaseHeight;P=sr-g}if(false&&ui[Un].len==1&&w==TR&&LR>0){wt=eR[LR].row;if($E[wt].MinHeight>0&&mV($E[wt].MinHeight)<sr)sr=mV($E[wt].MinHeight)}ui[Un].TextHt=sr;Er=0;if(Pr){sr=mV(20);if(!dS)sr=0}else{aO|=tc.TOFLAG_WRAPPING;s$(Un,sr,false);Ar=Sd;Er=hd;oj(tc.TOFLAG_WRAPPING);sr+=Ar+Er;g+=Ar}if(Nc[n].DivId>0&&T$(Un))sr=0;if(ui[Un].len==1&&Nj(Nc[n].flags&tc.PAGE_HDR_FTR)&&!WR&&(Un+1<Ri&&Nj(ui[Un+1].flags&tc.LFLAG_HDRS_FTRS))&&(Un-1>=0&&Nj(ui[Un-1].flags&tc.LFLAG_HDRS_FTRS))){sr=0}if(sr>0){if(Sr)ui[Un].BaseHeightAdj=0;else if(Ir>0)ui[Un].BaseHeightAdj=-Ir;else if(Cr>0)ui[Un].BaseHeightAdj=Cr}if(Nj(Nc[n].flags&tc.PAGE_HDR_FTR)&&sr!=ui[Un].height&&(sr==0&&ui[Un].height==0)&&Fo>Un&&!Po)Fo=Un;if(w!=0&&w!=tc.LINE_CHAR&&w!=TR&&w!=tc.PAGE_CHAR&&w!=tc.SECT_CHAR)sr=0;if(Nj(iO&tc.TFLAG9_WORD2007_PAGE_BREAK)&&ui[Un].len==1&&Nj(ui[Un].flags&tc.LFLAG_PARA)&&w!=TR&&Un>0&&ui[Un-1].len==1&&GY(Un-1,tc.INFO_PAGE))sr=0;if(oi.PageMode&&(w==tc.ROW_CHAR||hj(w)))sr=0;if(oi.PageMode&&w==tc.PAGE_CHAR)sr=xV(Hr);if(oi.PageMode&&w==tc.SECT_CHAR&&ui[Un].len==1){if(Un+1<Ri){var Dr=G5(Un);var Mr=eo[Dr].NextSect;if(Mr<0||Mr>=ro)Mr=0;if(!wz(Mr))sr=0}}if(sr==0)ui[Un].flags=cj(ui[Un].flags,tc.LFLAG_BOX_TOP|tc.LFLAG_BOX_BOT);if(ui[Un].height!=sr&&Br<tc.PAINT_WIN)Br=tc.PAINT_WIN;ui[Un].height=sr;if(Er>sr)Er=0;ui[Un].HeightAfter=Er;if(!oi.PageMode)ui[Un].ScrHt=yV(sr);if(Nj(aO&tc.TOFLAG_INSERT_CHAR)&&Un==br&&hV(sr)>ui[Un].ScrHt)ui[Un].ScrHt=yV(sr);ui[Un].BaseHt=g;if(ui[Un].BaseHt>ui[Un].height)ui[Un].BaseHt=ui[Un].height}if(zt){if(ui[Un].height>te&&Un>0&&ui[Un-1].fid==ui[Un].fid){var Gr=lU(Vl);if(Gr==0)zt=false;else{Vl=Gr;kl[Vl].flags2=cj(kl[Vl].flags2,tc.PF2_EMPTY_TEXT_BOX);kl[Vl].flags=cj(kl[Vl].flags,tc.PARA_FRAME_RECT);kl[Vl].flags|=tc.PARA_FRAME_TEXT_BOX;kl[Vl].ShapeType=tc.SHPTYPE_TEXT_BOX;ui[Un].fid=Vl;te=mV(nU(Vl));if(it)l=G9(Un,-1,false,-1);else l=M9(Un,-1);Un--;r=i;continue t}}te-=ui[Un].height}continue t}}function d9(t,e,r,i){var f;var l;if(ui[Un].len!=e-t){if(e-t>0){ui[Un].txt=[e-t+1];ui[Un].fmt=[e-t+1];if(Lc)ui[Un].tag=[e-t+1];if(Cc)ui[Un].cwidth=[e-t+1]}else{ui[Un].fmt=null;ui[Un].UniFmt=dc[t];ui[Un].tag=null;ui[Un].cwidth=null}ui[Un].len=e-t;if(Br!=tc.PAINT_WIN&&r!=Bn&&r!=TR)Br=tc.PAINT_WIN}if(ui[Un].len>0){f=ui[Un].txt;l=ui[Un].fmt;if(l==null)l=nb(Un);f=ui[Un].txt=wn.slice(t,t+ui[Un].len);l=ui[Un].fmt=dc.slice(t,t+ui[Un].len);if(Lc){if(Dj(ui[Un].tag))ui[Un].tag=[ui[Un].len];qY(nc,t,ui[Un].tag,0,ui[Un].len);Ab(Un)}else{ui[Un].tag=null}if(Cc){if(Dj(ui[Un].cwidth))ui[Un].cwidth=[ui[Un].len];ui[Un].cwidth=cc.slice(t,t+ui[Un].len)}else{ui[Un].cwidth=null}}if(Nj(i&tc.LFLAG2_TEMP_HYPH)){var a=ui[Un].len;if(a>0){fw(Un,a-1,1,tc.CHAR_A);f=ui[Un].txt;l=nb(Un);f[a]=tc.HYPH_CHAR;l[a]=l[a-1];sb(Un)}}return true}function F9(t,e){if(t>=256)return false;if(xs[e].TwipsSize<180)return false;if(xs[e].TwipsSize<400){var r=".,'\"ijl";if(r.indexOf(t)>=0)return false}return true}function g9(t,e){var r=ui[t].txt;if(r==null)return false;if(e<0||e>=ui[t].len)return false;return P9(r[e])}function P9(t){if(t>=2304&&t<=2431)return true;if(t>=2944&&t<=3071)return true;if(t>=3202&&t<=3311)return true;if(t>=3073&&t<=3183)return true;if(t>=3330&&t<=3459)return true;if(t>=3458&&t<=3572)return true;if(t>=2433&&t<=2555)return true;if(t>=2689&&t<=2801)return true;if(t>=2561&&t<=2677)return true;if(t>=2817&&t<=2935)return true;if(t>=3585&&t<=3642)return true;if(t>=3647&&t<=3675)return true;return false}function S9(t){if(t>=3585&&t<=3642)return true;if(t>=3647&&t<=3675)return true;if(t>=6016&&t<=6109)return true;if(t>=6112&&t<=6121)return true;if(t>=6128&&t<=6137)return true;return false}function h9(t,e){if(t>=128&&(xs[e].CharSet==tc.CHINESEBIG5_CHARSET||xs[e].CharSet==tc.GB2312_CHARSET||xs[e].CharSet==tc.HANGUL_CHARSET||xs[e].CharSet==tc.SHIFTJIS_CHARSET))return true;if(t>=11776&&t<=40879||t>=63744&&t<64255||t>=65072&&t<65103||t>=65280&&t<65519)return true;if(t>=19968&&t<=43007)return true;if(t>=44032&&t<=55215)return true;return false}function O9(t,e){var r=ui[t].txt;if(r==null)return false;if(e<0||e>=ui[t].len)return false;return v9(r[e])}function v9(t){if(t>=768&&t<=879)return true;return false}function p9(t){var e;if(t==0)return true;else{if(GY(t-1,tc.INFO_PAGE|tc.INFO_COL|tc.INFO_SECT))return true;if(Nj(ui[t-1].flags&(tc.LFLAG_PARA|tc.LFLAG_BREAK)))return true}return false}function N9(){var t=0,e,r,i=-1,f,l;var a,n;var c,s=false,_=false;var o=false,u,T=false,A,E=false,R,L,C=false;var I=false,d;var F;var g;var P;var S,h=true;var O=Nj(fO&tc.TFLAG10_DST)||Nj(lO&tc.TFLAG11_CONTEXTUAL_FONT_WIDTH);Cc=false;if(!e_&&!vc&&!O)return false;if(bn==0)return false;if(oi.PrintView&&!oi.FittedView)c=true;else c=false;for(e=0;e<=bn;e++){_=false;u=false;A=false;R=false;L=false;d=false;if(e<bn){if(wn[e]>127)_=true;if(_){u=h9(wn[e],dc[e]);R=P9(wn[e]);L=v9(wn[e]);d=wn[e]>=65281&&wn[e]<=65374;if(!u&&!R&&!L)A=Yq(wn[e]);if(wn[e]==tc.OVR_RTLCH_CHAR||wn[e]==tc.OVR_LTRCH_CHAR||wn[e]==tc.LRE_CHAR||wn[e]==tc.RLE_CHAR||wn[e]==tc.LRM_CHAR||wn[e]==tc.RLM_CHAR)tf=true}}if(i==-1){if(wn[e]<32)continue;t=dc[e];i=e;s=_;o=u;T=A;E=R;C=L;I=d;continue}if(e==bn||t!=dc[e]||wn[e]<32||wn[e]==tc.LEFT_PARAN_CHAR||s!=_||o!=u||T!=A||E!=R||C!=L||I!=d){t:{if(e>i&&(xs[t].VarWidth||xs[t].rtl||s||wr==tc.FLOW_RTL||C||O)){var v;var p,N;if(Nj(xs[t].style&(tc.SCAPS|tc.CAPS))&&!s){if(wn[i]!=tc.SPACE)break t}if(xs[t].rtl)wr=tc.FLOW_RTL;if(Dj(cc))cc=[];if(Dj(_c))_c=[];if(Dj(oc))oc=[];if(Dj(uc))uc=[];if(!Cc)for(r=0;r<bn;r++)cc[r]=0;if(C){for(r=i;r<e;r++)cc[r]=tc.CWIDTH_USED;Cc=true;break t}if(I){for(r=i;r<e;r++){if(c)cc[r]=DV(xs[t].TwipsSize);else cc[r]=dV(xs[t].TwipsSize);if(xs[t].expand!=0){if(c)cc[r]+=mV(xs[t].expand);else cc[r]+=hV(xs[t].expand);if(cc[r]<0)cc[r]=0}if(xs[t].ScaleX!=0){cc[r]=Mj(cc[r],xs[t].ScaleX+100,100)}cc[r]*=tc.CWIDTH_FACTOR;cc[r]|=tc.CWIDTH_USED}Cc=true;break t}if(h&&o&&!xs[t].rtl){for(r=i;r<e;r++){var D=wn[r];var M=true;var G=1;if(D>=65152)G=2;else if(D==12539)M=false;if(c)cc[r]=DV(xs[t].TwipsSize/G);else cc[r]=dV(xs[t].TwipsSize/G);if(xs[t].expand!=0){if(c)cc[r]+=mV(xs[t].expand);else cc[r]+=hV(xs[t].expand);if(cc[r]<0)cc[r]=0}if(xs[t].ScaleX!=0){cc[r]=Mj(cc[r],xs[t].ScaleX+100,100)}cc[r]*=tc.CWIDTH_FACTOR;if(M)cc[r]|=tc.CWIDTH_USED}Cc=true;break t}f=e-i;F=c?Xs[t].gr:xs[t].gr;P=c?Xs[t].font:xs[t].font;var B=c?Xs[t].font.FontString:xs[t].font.FontString;var H=c?Xs[t].CharWidth:xs[t].CharWidth;var m=[f];for(r=0;r<f;r++){m[r]=wn[i+r];if(Nj(xs[t].style&(tc.CAPS|tc.SCAPS)))m[r]=ok(m[r])}var w=D9(F,m,f,B,H,O);if(E){for(r=0;r<f;r++){l=w[r];if(Nj(xs[t].expand)){if(c)l+=mV(xs[t].expand);else l+=hV(xs[t].expand);if(l<0)l=0}if(w[r]>0){cc[i+r]=l;cc[i+r]*=tc.CWIDTH_FACTOR;cc[i+r]|=tc.CWIDTH_USED}else cc[i+r]=tc.CWIDTH_USED}}else{for(r=0;r<f;r++){l=w[r];if(Nj(xs[t].expand)){if(c)l+=mV(xs[t].expand);else l+=hV(xs[t].expand);if(l<0||w[r]==0)l=0}cc[i+r]=Math.round(l*tc.CWIDTH_FACTOR);cc[i+r]|=tc.CWIDTH_USED;if(Yq(wn[i+r])){cc[i+r]|=tc.CWIDTH_RTL;wr=tc.FLOW_RTL}else if(wr==tc.FLOW_RTL){if(wn[i+r]==tc.SPACE||wn[i+r]==gk("[")||wn[i+r]==gk("]")||wn[i+r]==gk("(")||wn[i+r]==tc.RIGHT_PAREN){var b=false;if(i+r==0){if(wn[i+r+1]<128)b=true}else b=wn[i+r-1]<128&&wn[i+r-1]!=tc.SPACE||wn[i+r+1]<128&&wn[i+r+1]!=tc.SPACE;if(!b)cc[i+r]|=tc.CWIDTH_RTL}}}}Cc=true}}if(e==bn)break;t=dc[e];i=e;if(wn[e]<32)i++;s=_;o=u;T=A;E=R;C=L;I=d}}return Cc}function D9(t,e,r,i,f,l){var a=[];var n,c,s=0,_=0;var o="",u="",T="";var A=t.font;t.font=i;for(n=0;n<r;n++){var E=e[n];if(E<256&&!l){a[n]=f[E];u="";s=0;continue}T=String.fromCharCode(E);if(E<256)c=f[E];else c=EH(t,T,i).width;a[n]=c;o=u+T;_=EH(t,o,i).width;if(_!=s+c&&n>0){var R=s+c-_;a[n-1]-=R;if(a[n-1]<0){a[n]+=a[n-1];a[n-1]=0}}u=o;s=_}t.font=A;return a}_i.TerRewrap=function(){if(!lv||!QD())_i.TerCreateControl();if(!oi.WordWrap)return false;T9(0,999999);return true};function M9(t,e){return G9(t,e,true,-1)}function G9(t,e,r,i){var f,l,a;var n,c;var s=Nj(tO&tc.TFLAG6_WRAP_AT_WINDOW_WIDTH);var _=Nj(fO&tc.TFLAG10_EXTEND_AUTO_VSCROLL);var o=0;if(!_&&oi.FittedView&&Nj(zh&tc.TFLAG_AUTO_VSCROLL_BAR)&&Nj(fO&tc.TFLAG10_AUTO_HSCROLL_BAR))_=true;if(e<0&&t<0)return r?je:gV(je);if(t>=Ri&&Ri>0)t=Ri-1;if(oi.WordWrap&&oi.PrintView){if(t>=0){if(i>0)n=i;else n=ui[t].cid;if(n>0){var u=eR[n].TextAngle;if(u>0&&ui[t].fid>0&&kl[ui[t].fid].TextAngle>0)u=0;if(u==0)f=eR[n].width-x6(n)-y6(n);else{var T=eR[n].row;if(Po&&tR[T].height!=0)f=MV(tR[T].height);else f=MV($E[T].height);if($E[T].MinHeight<0){f=-$E[T].MinHeight;if(Dj(fO&tc.TFLAG10_DONT_PAD_TABLE_HEIGHT)){f+=U6(n)}}else if($E[T].MinHeight>f)f=$E[T].MinHeight;f-=W6(n)+U6(n);if(eR[n].RowSpan>1){var A=eR[n].RowSpan,E=$E[T].PageNo;var R,L;for(R=0;R<A-1;R++){T=$E[T].NextRow;if(T<=0||$E[T].PageNo!=E)break;if(Po&&tR[T].height!=0)L=MV(tR[T].height);else L=MV($E[T].height);if($E[T].MinHeight<0)L=-$E[T].MinHeight;else if($E[T].MinHeight>L)L=$E[T].MinHeight;f+=L}}}if(r)f=dV(f);else f=DV(f)}else if(ui[t].fid>0){var C;c=ui[t].fid;C=kl[c].margin;if(Nj(kl[c].flags&tc.PARA_FRAME_TEXT_BOX)&&kl[c].LineWdth>C)C=kl[c].LineWdth;if(kl[c].TextAngle>0)f=kl[c].height-2*C;else f=kl[c].width-2*C;zW(c);f-=hI+OI;if(kl[c].height<HV(ui[t].height*2))f+=40;if(r)f=dV(f);else f=DV(f)}else if(Nj(Nc[ui[t].pfmt].flags&tc.PAGE_HDR_FTR)){if(e<0)e=G5(t);if(r)f=Nt*(eo[e].PgWidth-to[e].LeftMargin-to[e].RightMargin);else f=Ai*(eo[e].PgWidth-to[e].LeftMargin-to[e].RightMargin)}else{if(e<0)e=G5(t);if((oi.FittedView||s)&&je>0){f=r?je:gV(je);if(oi.FittedView&&_&&!oi.ShowVerBar){if(je>o){f-=r?o:wV(o)}}}else{if(r)f=Nt*(eo[e].PgWidth-to[e].LeftMargin-to[e].RightMargin);else f=Ai*(eo[e].PgWidth-to[e].LeftMargin-to[e].RightMargin)}if(Nj(to[e].flags&tc.SECT_VAR_COL_WIDTH)){var I=uo>=0?uo:A9(t);if(r)f=dV(to[e].ColWidth[I]);else f=DV(to[e].ColWidth[I])}else{if(r){f=f-Nt*(to[e].ColumnSpace*(to[e].columns-1))}else{f=f-Ai*(to[e].ColumnSpace*(to[e].columns-1))}f=f/to[e].columns}}l=ui[t].pfmt;a=Nc[l].width;if(a>0){a=r?dV(a):DV(a);if(a<f)f=a}}else{if(e<0)e=0;if(oi.FittedView&&je>0){f=r?je:gV(je);if(_&&!oi.ShowVerBar){if(je>o){f-=r?o:wV(o)}}}else{if(r)f=Nt*(eo[e].PgWidth-to[e].LeftMargin-to[e].RightMargin);else f=Ai*(eo[e].PgWidth-to[e].LeftMargin-to[e].RightMargin)}}return f}else{if(e<0&&t<0)return r?je:wV(je);if(Xn>0){if(e<0)e=G5(t);if(r){f=dV(Xn)-Nt*(to[e].LeftMargin+to[e].RightMargin);if(f<Nt)f=Nt}else{f=DV(Xn)-Ai*(to[e].LeftMargin+to[e].RightMargin);if(f<wV(Ai))f=Ai}return f}if(kn>0){return Gx(0,r,tc.CHAR_M)*kn}else{if(je<Nt)f=Nt;else f=je;if(!r)f=wV(f);return f}}}_i.TerSetWrapWidth=function(t,e,r){if(!lv||!QD())_i.TerCreateControl();if(!oi.WordWrap)return false;if(oi.PrintView)return false;if(t>0&&e>0)return false;kn=t;Xn=e;_i.TerRewrap();if(r)cG();return true};function B9(t,e){var r,i=0,f,l=t;xd=0;if(e<0){i=mV(nU(t));return t}else f=ui[e].fid;if(f==0){t=iU(t);i=mV(nU(t))}else{i=mV(nU(f));for(r=e;r>=0;r--){if(ui[r].fid!=f)break;i-=ui[r].height}if(i>0)t=f;else{t=lU(f);if(t==0){t=l;i=9999999}else i=mV(nU(t))}}xd=i;return t}function H9(t,e,r){return false}function m9(t,e,r){return false}function w9(){return true}};